{"remainingRequest":"C:\\Users\\何小龙\\Desktop\\platformweb-fb\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\何小龙\\Desktop\\platformweb-fb\\node_modules\\eslint-loader\\index.js??ref--13-0!C:\\Users\\何小龙\\Desktop\\platformweb-fb\\src\\utils\\readLocalFile.js","dependencies":[{"path":"C:\\Users\\何小龙\\Desktop\\platformweb-fb\\src\\utils\\readLocalFile.js","mtime":1694505522181},{"path":"C:\\Users\\何小龙\\Desktop\\platformweb-fb\\babel.config.js","mtime":1694505520209},{"path":"C:\\Users\\何小龙\\Desktop\\platformweb-fb\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\何小龙\\Desktop\\platformweb-fb\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"C:\\Users\\何小龙\\Desktop\\platformweb-fb\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9NZXNzYWdlMiBmcm9tICJlbGVtZW50LXVpL2xpYi90aGVtZS1jaGFsay9tZXNzYWdlLmNzcyI7CmltcG9ydCAiZWxlbWVudC11aS9saWIvdGhlbWUtY2hhbGsvYmFzZS5jc3MiOwppbXBvcnQgX01lc3NhZ2UgZnJvbSAiZWxlbWVudC11aS9saWIvbWVzc2FnZSI7CmltcG9ydCBYRVV0aWxzIGZyb20gJ3hlLXV0aWxzJzsKdmFyIGZpbGVGb3JtOwp2YXIgZmlsZUlucHV0OwpleHBvcnQgZnVuY3Rpb24gcGFyc2VGaWxlKGZpbGUpIHsKICB2YXIgbmFtZSA9IGZpbGUubmFtZTsKICB2YXIgdEluZGV4ID0gWEVVdGlscy5sYXN0SW5kZXhPZihuYW1lLCAnLicpOwogIHZhciB0eXBlID0gbmFtZS5zdWJzdHJpbmcodEluZGV4ICsgMSwgbmFtZS5sZW5ndGgpOwogIHZhciBmaWxlbmFtZSA9IG5hbWUuc3Vic3RyaW5nKDAsIHRJbmRleCk7CiAgcmV0dXJuIHsKICAgIGZpbGVuYW1lOiBmaWxlbmFtZSwKICAgIHR5cGU6IHR5cGUKICB9Owp9Ci8qKg0KICog6K+75Y+W5pys5Zyw5paH5Lu2DQogKiBAcGFyYW0geyp9IG9wdGlvbnMg5Y+C5pWwDQogKi8KZXhwb3J0IGZ1bmN0aW9uIHJlYWRMb2NhbEZpbGUob3B0aW9ucykgewogIHZhciBvcHRzID0gT2JqZWN0LmFzc2lnbih7fSwgb3B0aW9ucyk7CiAgaWYgKCFmaWxlRm9ybSkgewogICAgZmlsZUZvcm0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdmb3JtJyk7CiAgICBmaWxlSW5wdXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpOwogICAgZmlsZUZvcm0uY2xhc3NOYW1lID0gJ3Z4ZS10YWJsZS0tZmlsZS1mb3JtJzsKICAgIGZpbGVJbnB1dC5uYW1lID0gJ2ZpbGUnOwogICAgZmlsZUlucHV0LnR5cGUgPSAnZmlsZSc7CiAgICBmaWxlRm9ybS5hcHBlbmRDaGlsZChmaWxlSW5wdXQpOwogICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChmaWxlRm9ybSk7CiAgfQogIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICB2YXIgdHlwZXMgPSBvcHRzLnR5cGVzIHx8IFtdOwogICAgdmFyIGlzQWxsVHlwZSA9ICF0eXBlcy5sZW5ndGggfHwgdHlwZXMuc29tZShmdW5jdGlvbiAodHlwZSkgewogICAgICByZXR1cm4gdHlwZSA9PT0gJyonOwogICAgfSk7CiAgICBmaWxlSW5wdXQubXVsdGlwbGUgPSAhIW9wdHMubXVsdGlwbGU7CiAgICBmaWxlSW5wdXQuYWNjZXB0ID0gaXNBbGxUeXBlID8gJycgOiAiLiIuY29uY2F0KHR5cGVzLmpvaW4oJywgLicpKTsKICAgIGZpbGVJbnB1dC5vbmNoYW5nZSA9IGZ1bmN0aW9uIChldm50KSB7CiAgICAgIHZhciBmaWxlcyA9IGV2bnQudGFyZ2V0LmZpbGVzOwogICAgICB2YXIgZmlsZSA9IGZpbGVzWzBdOwogICAgICB2YXIgZXJyVHlwZSA9ICcnOwogICAgICAvLyDmoKHpqoznsbvlnosKICAgICAgaWYgKCFpc0FsbFR5cGUpIHsKICAgICAgICBmb3IgKHZhciBmSW5kZXggPSAwOyBmSW5kZXggPCBmaWxlcy5sZW5ndGg7IGZJbmRleCsrKSB7CiAgICAgICAgICB2YXIgX3BhcnNlRmlsZSA9IHBhcnNlRmlsZShmaWxlc1tmSW5kZXhdKSwKICAgICAgICAgICAgdHlwZSA9IF9wYXJzZUZpbGUudHlwZTsKICAgICAgICAgIGlmICghWEVVdGlscy5pbmNsdWRlcyh0eXBlcywgdHlwZSkpIHsKICAgICAgICAgICAgZXJyVHlwZSA9IHR5cGU7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgICBpZiAoIWVyclR5cGUpIHsKICAgICAgICByZXNvbHZlKHsKICAgICAgICAgIHN0YXR1czogdHJ1ZSwKICAgICAgICAgIGZpbGVzOiBmaWxlcywKICAgICAgICAgIGZpbGU6IGZpbGUKICAgICAgICB9KTsKICAgICAgfSBlbHNlIHsKICAgICAgICBpZiAob3B0cy5tZXNzYWdlICE9PSBmYWxzZSkgewogICAgICAgICAgX01lc3NhZ2UuZXJyb3IoIlx1NEUwRFx1NjUyRlx1NjMwMVx1NzY4NFx1NjU4N1x1NEVGNlx1N0M3Qlx1NTc4QiIuY29uY2F0KGVyclR5cGUpKTsKICAgICAgICB9CiAgICAgICAgdmFyIHBhcmFtcyA9IHsKICAgICAgICAgIHN0YXR1czogZmFsc2UsCiAgICAgICAgICBmaWxlczogZmlsZXMsCiAgICAgICAgICBmaWxlOiBmaWxlCiAgICAgICAgfTsKICAgICAgICByZWplY3QocGFyYW1zKTsKICAgICAgfQogICAgfTsKICAgIGZpbGVGb3JtLnJlc2V0KCk7CiAgICBmaWxlSW5wdXQuY2xpY2soKTsKICB9KTsKfQ=="},{"version":3,"names":["XEUtils","fileForm","fileInput","parseFile","file","name","tIndex","lastIndexOf","type","substring","length","filename","readLocalFile","options","opts","Object","assign","document","createElement","className","appendChild","body","Promise","resolve","reject","types","isAllType","some","multiple","accept","concat","join","onchange","evnt","files","target","errType","fIndex","_parseFile","includes","status","message","_Message","error","params","reset","click"],"sources":["C:/Users/何小龙/Desktop/platformweb-fb/src/utils/readLocalFile.js"],"sourcesContent":["import XEUtils from 'xe-utils'\r\nimport { Message } from 'element-ui'\r\n\r\nlet fileForm\r\nlet fileInput\r\n\r\nexport function parseFile (file) {\r\n  const name = file.name\r\n  const tIndex = XEUtils.lastIndexOf(name, '.')\r\n  const type = name.substring(tIndex + 1, name.length)\r\n  const filename = name.substring(0, tIndex)\r\n  return { filename, type }\r\n}\r\n/**\r\n * 读取本地文件\r\n * @param {*} options 参数\r\n */\r\nexport function readLocalFile(options) {\r\n  const opts = Object.assign({}, options)\r\n  if (!fileForm) {\r\n    fileForm = document.createElement('form')\r\n    fileInput = document.createElement('input')\r\n    fileForm.className = 'vxe-table--file-form'\r\n    fileInput.name = 'file'\r\n    fileInput.type = 'file'\r\n    fileForm.appendChild(fileInput)\r\n    document.body.appendChild(fileForm)\r\n  }\r\n  return new Promise((resolve, reject) => {\r\n    const types = opts.types || []\r\n    const isAllType = !types.length || types.some((type) => type === '*')\r\n    fileInput.multiple = !!opts.multiple\r\n    fileInput.accept = isAllType ? '' : `.${types.join(', .')}`\r\n    fileInput.onchange = (evnt) => {\r\n      const { files } = evnt.target\r\n      const file = files[0]\r\n      let errType = ''\r\n      // 校验类型\r\n      if (!isAllType) {\r\n        for (let fIndex = 0; fIndex < files.length; fIndex++) {\r\n          const { type } = parseFile(files[fIndex])\r\n          if (!XEUtils.includes(types, type)) {\r\n            errType = type\r\n            break\r\n          }\r\n        }\r\n      }\r\n      if (!errType) {\r\n        resolve({ status: true, files, file })\r\n      } else {\r\n        if (opts.message !== false) {\r\n          Message.error(`不支持的文件类型${errType}`)\r\n        }\r\n        const params = { status: false, files, file }\r\n        reject(params)\r\n      }\r\n    }\r\n    fileForm.reset()\r\n    fileInput.click()\r\n  })\r\n}\r\n"],"mappings":"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"}]}