{"remainingRequest":"C:\\Users\\何小龙\\Desktop\\platformweb-fb\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\何小龙\\Desktop\\platformweb-fb\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Users\\何小龙\\Desktop\\platformweb-fb\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\何小龙\\Desktop\\platformweb-fb\\src\\views\\test\\FineReportTemplate\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\何小龙\\Desktop\\platformweb-fb\\src\\views\\test\\FineReportTemplate\\index.vue","mtime":1694505522951},{"path":"C:\\Users\\何小龙\\Desktop\\platformweb-fb\\babel.config.js","mtime":1694505520209},{"path":"C:\\Users\\何小龙\\Desktop\\platformweb-fb\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\何小龙\\Desktop\\platformweb-fb\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"C:\\Users\\何小龙\\Desktop\\platformweb-fb\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\何小龙\\Desktop\\platformweb-fb\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:ZnVuY3Rpb24gX3R5cGVvZihvKSB7ICJAYmFiZWwvaGVscGVycyAtIHR5cGVvZiI7IHJldHVybiBfdHlwZW9mID0gImZ1bmN0aW9uIiA9PSB0eXBlb2YgU3ltYm9sICYmICJzeW1ib2wiID09IHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPyBmdW5jdGlvbiAobykgeyByZXR1cm4gdHlwZW9mIG87IH0gOiBmdW5jdGlvbiAobykgeyByZXR1cm4gbyAmJiAiZnVuY3Rpb24iID09IHR5cGVvZiBTeW1ib2wgJiYgby5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG8gIT09IFN5bWJvbC5wcm90b3R5cGUgPyAic3ltYm9sIiA6IHR5cGVvZiBvOyB9LCBfdHlwZW9mKG8pOyB9CmZ1bmN0aW9uIG93bktleXMoZSwgcikgeyB2YXIgdCA9IE9iamVjdC5rZXlzKGUpOyBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scykgeyB2YXIgbyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMoZSk7IHIgJiYgKG8gPSBvLmZpbHRlcihmdW5jdGlvbiAocikgeyByZXR1cm4gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihlLCByKS5lbnVtZXJhYmxlOyB9KSksIHQucHVzaC5hcHBseSh0LCBvKTsgfSByZXR1cm4gdDsgfQpmdW5jdGlvbiBfb2JqZWN0U3ByZWFkKGUpIHsgZm9yICh2YXIgciA9IDE7IHIgPCBhcmd1bWVudHMubGVuZ3RoOyByKyspIHsgdmFyIHQgPSBudWxsICE9IGFyZ3VtZW50c1tyXSA/IGFyZ3VtZW50c1tyXSA6IHt9OyByICUgMiA/IG93bktleXMoT2JqZWN0KHQpLCAhMCkuZm9yRWFjaChmdW5jdGlvbiAocikgeyBfZGVmaW5lUHJvcGVydHkoZSwgciwgdFtyXSk7IH0pIDogT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMgPyBPYmplY3QuZGVmaW5lUHJvcGVydGllcyhlLCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyh0KSkgOiBvd25LZXlzKE9iamVjdCh0KSkuZm9yRWFjaChmdW5jdGlvbiAocikgeyBPYmplY3QuZGVmaW5lUHJvcGVydHkoZSwgciwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcih0LCByKSk7IH0pOyB9IHJldHVybiBlOyB9CmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgdmFsdWUpIHsga2V5ID0gX3RvUHJvcGVydHlLZXkoa2V5KTsgaWYgKGtleSBpbiBvYmopIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaiwga2V5LCB7IHZhbHVlOiB2YWx1ZSwgZW51bWVyYWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlLCB3cml0YWJsZTogdHJ1ZSB9KTsgfSBlbHNlIHsgb2JqW2tleV0gPSB2YWx1ZTsgfSByZXR1cm4gb2JqOyB9CmZ1bmN0aW9uIF90b1Byb3BlcnR5S2V5KGFyZykgeyB2YXIga2V5ID0gX3RvUHJpbWl0aXZlKGFyZywgInN0cmluZyIpOyByZXR1cm4gX3R5cGVvZihrZXkpID09PSAic3ltYm9sIiA/IGtleSA6IFN0cmluZyhrZXkpOyB9CmZ1bmN0aW9uIF90b1ByaW1pdGl2ZShpbnB1dCwgaGludCkgeyBpZiAoX3R5cGVvZihpbnB1dCkgIT09ICJvYmplY3QiIHx8IGlucHV0ID09PSBudWxsKSByZXR1cm4gaW5wdXQ7IHZhciBwcmltID0gaW5wdXRbU3ltYm9sLnRvUHJpbWl0aXZlXTsgaWYgKHByaW0gIT09IHVuZGVmaW5lZCkgeyB2YXIgcmVzID0gcHJpbS5jYWxsKGlucHV0LCBoaW50IHx8ICJkZWZhdWx0Iik7IGlmIChfdHlwZW9mKHJlcykgIT09ICJvYmplY3QiKSByZXR1cm4gcmVzOyB0aHJvdyBuZXcgVHlwZUVycm9yKCJAQHRvUHJpbWl0aXZlIG11c3QgcmV0dXJuIGEgcHJpbWl0aXZlIHZhbHVlLiIpOyB9IHJldHVybiAoaGludCA9PT0gInN0cmluZyIgPyBTdHJpbmcgOiBOdW1iZXIpKGlucHV0KTsgfQovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwoKaW1wb3J0IHsgbXlNZXRob2RzIH0gZnJvbSAnQC92aWV3cy90ZXN0L2JsYW5rVGVtcGxhdGUvanMvbWV0aG9kcy5qcyc7CmltcG9ydCBtaXggZnJvbSAnQC9taXhpbi9jb21tb25NaXhpbi5qcyc7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnRmluZVJlcG9ydFRlbXBsYXRlJywKICBjb21wb25lbnRzOiB7fSwKICBtaXhpbnM6IFttaXhdLAogIHByb3BzOiB7CiAgICBhbGxQcm9wRGF0YTogewogICAgICB0eXBlOiBPYmplY3QsCiAgICAgIGRlZmF1bHQ6IGZ1bmN0aW9uIF9kZWZhdWx0KCkgewogICAgICAgIHJldHVybiB7fTsKICAgICAgfQogICAgfQogIH0sCiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIHRhYlN0YXR1c0J0bkNvbmZpZzoge30sCiAgICAgIHRyZWVDb25maWc6IHt9LAogICAgICBsZWZ0VmlzaWJsZTogdHJ1ZSwKICAgICAgbGV0ZnRUcmVlRmlsdGVyVGV4dDogJycsCiAgICAgIGxlZnRUcmVlQ29uZmlnOiB7fSwKICAgICAgdHJlZURhdGE6IFtdLAogICAgICB0cmVlUXVlcnlwYXJhbXM6IHt9CiAgICB9OwogIH0sCiAgY29tcHV0ZWQ6IHt9LAogIHdhdGNoOiB7CiAgICBxdWVyeUZvcm1EYXRhOiB7CiAgICAgIGhhbmRsZXI6IGZ1bmN0aW9uIGhhbmRsZXIobmV3dmFsKSB7CiAgICAgICAgY29uc29sZS5sb2cobmV3dmFsKTsKICAgICAgfSwKICAgICAgZGVlcDogdHJ1ZSwKICAgICAgaW1tZWRpYXRlOiB0cnVlCiAgICB9CiAgfSwKICBjcmVhdGVkOiBmdW5jdGlvbiBjcmVhdGVkKCkgewogICAgdGhpcy5pbml0Q3JlYXRlZCgpOwogICAgdGhpcy5pbml0RmluZVJlcG9ydCgpOwogIH0sCiAgbW91bnRlZDogZnVuY3Rpb24gbW91bnRlZCgpIHsKICAgIHRoaXMuaW5pdE1vdW50ZWQoKTsKICB9LAogIG1ldGhvZHM6IF9vYmplY3RTcHJlYWQoX29iamVjdFNwcmVhZCh7fSwgbXlNZXRob2RzKSwge30sIHsKICAgIC8vIOWIneWni+WMluW4hui9r+aKpeihqOagt+W8jwogICAgaW5pdEZpbmVSZXBvcnQ6IGZ1bmN0aW9uIGluaXRGaW5lUmVwb3J0KCkgewogICAgICB2YXIgaWZyYW1lID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3JlcG9ydEZyYW1lJyk7CiAgICAgIC8vIOiOt+WPlmlmcmFtZeWGheeahOmhtemdouaWh+aho+WvueixoQogICAgICB2YXIgcmVwb3J0ID0ge307CiAgICAgIHRyeSB7CiAgICAgICAgcmVwb3J0ID0gaWZyYW1lLmNvbnRlbnRXaW5kb3cuZG9jdW1lbnQ7CiAgICAgIH0gY2F0Y2ggKF91bnVzZWQpIHsKICAgICAgICB0aGlzLiRYTW9kYWwubWVzc2FnZSh7CiAgICAgICAgICBpZDogJ2ZpbmVyZXBvcnRFcnJvcicsCiAgICAgICAgICBzdGF0dXM6ICdlcnJvcicsCiAgICAgICAgICBtZXNzYWdlOiAn6I635Y+W5biG6L2v5oql6KGo5aSx6LSlOiDmnoHmnInlj6/og73mmK/ot6jmupDpl67popgnLAogICAgICAgICAgZHVyYXRpb246IDUwMDAKICAgICAgICB9KTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgLy8g6I635Y+W5biG6L2v5YaF572u55qE5bel5YW35qCP5a+56LGhCiAgICAgIHZhciB0b29sYmFyID0gcmVwb3J0LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ3gtdG9vbGJhcicpWzBdOwogICAgICB0b29sYmFyLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7IC8vIOWwhum7mOiupOW3peWFt+agj+makOiXj+aOiQoKICAgICAgLy8g6I635Y+W5oql6KGo5a655Zmo5a+56LGhCiAgICAgIHZhciBjb250YWluZXIgPSByZXBvcnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgncmVwb3J0UGFuZScpWzBdOwogICAgICBjb250YWluZXIuc3R5bGUudG9wID0gJzBweCc7IC8vIOWOu+mZpOm7mOiupOeahGZpbmVyZXBvcnTlhoXnva7lt6XlhbfmoI/lkI7vvIzpnIDopoHlsIbmlbTkuKrmiqXooajkuIrnp7vvvIzloavlhYXlt6XlhbfmoI/nqbrnmb3lpIQKCiAgICAgIC8vIOiOt+WPluWNleWFg+agvOWvueixoQogICAgICB2YXIgdGQgPSByZXBvcnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ3RkJyk7CiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGQubGVuZ3RoOyBpKyspIHsKICAgICAgICB0ZFtpXS5zdHlsZS5iYWNrZ3JvdW5kID0gJ25vbmUnOyAvLyDljrvpmaTmr4/kuKrljZXlhYPmoLznmoTpu5jorqTog4zmma8KICAgICAgICB0ZFtpXS5zdHlsZS5jb2xvciA9ICdibGFjayc7IC8vIOe7n+S4gOWtl+S9k+minOiJsgogICAgICB9CgogICAgICAvLyDojrflj5booajmoLznmoTooajlpLTooYzlpLTlg48KICAgICAgdmFyIHRyID0gcmVwb3J0LmdldEVsZW1lbnRzQnlUYWdOYW1lKCd0cicpOwogICAgICB0clswXS5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSAncmdiKDIyNywgMjQyLCAyNTQpJzsgLy8g5bCG6KGo5aS06IOM5pmv6Imy6YWN5oiQ5ZKM5aSW6aG16Z2i55u45ZCM6aOO5qC8CiAgICAgIC8vIOihqOagvOaWkemprOe6uQogICAgICBmb3IgKHZhciBfaSA9IDI7IF9pIDwgdHIubGVuZ3RoOyBfaSA9IF9pICsgMikgewogICAgICAgIHRyW19pXS5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSAncmdiKDI0NCwgMjQ2LCAyNTMpJzsKICAgICAgfQogICAgfSwKICAgIC8vIOWIt+aWsAogICAgb25SZWZyZXNoQ2xpY2s6IGZ1bmN0aW9uIG9uUmVmcmVzaENsaWNrKCkge30sCiAgICAvLyDlr7zlh7oKICAgIG9uRXhwb3J0Q2xpY2s6IGZ1bmN0aW9uIG9uRXhwb3J0Q2xpY2soX3JlZikgewogICAgICB2YXIgbmFtZSA9IF9yZWYubmFtZSwKICAgICAgICAkZXZlbnQgPSBfcmVmLiRldmVudDsKICAgICAgdmFyIGlmcmFtZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXBvcnRGcmFtZScpOwogICAgICB2YXIgcmVwb3J0ID0ge307CiAgICAgIHRyeSB7CiAgICAgICAgcmVwb3J0ID0gaWZyYW1lLmNvbnRlbnRXaW5kb3cuY29udGVudFBhbmU7CiAgICAgIH0gY2F0Y2ggKF91bnVzZWQyKSB7CiAgICAgICAgdGhpcy4kWE1vZGFsLm1lc3NhZ2UoewogICAgICAgICAgaWQ6ICdmaW5lcmVwb3J0RXJyb3InLAogICAgICAgICAgc3RhdHVzOiAnZXJyb3InLAogICAgICAgICAgbWVzc2FnZTogJ+iOt+WPluW4hui9r+aKpeihqOWksei0pTog5p6B5pyJ5Y+v6IO95piv6Leo5rqQ6Zeu6aKYJywKICAgICAgICAgIGR1cmF0aW9uOiA1MDAwCiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIHN3aXRjaCAobmFtZSkgewogICAgICAgIGNhc2UgJ2V4Y2VsJzoKICAgICAgICAgIC8vIOWvvOWHuuS4ukV4Y2Vs77yI5qC85byP5Li65Y6f5qC36L6T5Ye677yJ77yMRmluZVJlcG9ydOWGhee9ruaWueazlQogICAgICAgICAgcmVwb3J0LmV4cG9ydFJlcG9ydFRvRXhjZWwoJ3NpbXBsZScpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAncGRmJzoKICAgICAgICAgIC8vIOWvvOWHuuS4ulBERu+8jEZpbmVSZXBvcnTlhoXnva7mlrnms5UKICAgICAgICAgIHJlcG9ydC5leHBvcnRSZXBvcnRUb1BERigpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAnd29yZCc6CiAgICAgICAgICAvLyDlr7zlh7rkuLpXb3Jk77yMRmluZVJlcG9ydOWGhee9ruaWueazlQogICAgICAgICAgcmVwb3J0LmV4cG9ydFJlcG9ydFRvV29yZCgpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAncG5nJzoKICAgICAgICAgIC8vIOWvvOWHuuS4uuWbvueJh++8jEZpbmVSZXBvcnTlhoXnva7mlrnms5UKICAgICAgICAgIHJlcG9ydC5leHBvcnRSZXBvcnRUb0ltYWdlKCk7CiAgICAgICAgICBicmVhazsKICAgICAgfQogICAgfQogIH0pCn07"},{"version":3,"names":["myMethods","mix","name","components","mixins","props","allPropData","type","Object","default","_default","data","tabStatusBtnConfig","treeConfig","leftVisible","letftTreeFilterText","leftTreeConfig","treeData","treeQueryparams","computed","watch","queryFormData","handler","newval","console","log","deep","immediate","created","initCreated","initFineReport","mounted","initMounted","methods","_objectSpread","iframe","document","getElementById","report","contentWindow","_unused","$XModal","message","id","status","duration","toolbar","getElementsByClassName","style","display","container","top","td","getElementsByTagName","i","length","background","color","tr","backgroundColor","onRefreshClick","onExportClick","_ref","$event","contentPane","_unused2","exportReportToExcel","exportReportToPDF","exportReportToWord","exportReportToImage"],"sources":["src/views/test/FineReportTemplate/index.vue"],"sourcesContent":["/**\r\n * @author: chen_huanjie\r\n * @date: 2021.9.16\r\n * @description: 项目嵌套进帆软报表的模板\r\n *              使用帆软报表需要更改iframe标签的src路径\r\n *              报表页面显示和脚本插入能够正常，需要报表解析服务器与本组件同域同源\r\n *              非同源情况下，需要跨域处理，目前这个问题未解决\r\n *              但测试时候，是在finereport设计器内置服务器下测得页面，能够更改原有报表样式\r\n * @version: 1.0.0\r\n **/\r\n<template>\r\n  <div class=\"height-all\">\r\n    <BsMainFormListLayout :left-visible.sync=\"leftVisible\">\r\n      <template v-slot:topTabPane>\r\n        <BsTabPanel\r\n          :show-zero=\"false\"\r\n          is-open\r\n          :tab-status-btn-config=\"tabStatusBtnConfig\"\r\n          :is-hide-query=\"true\"\r\n          @tabClick=\"onTabPaneltabClick\"\r\n          @btnClick=\"onTabPanelBtnClick\"\r\n        />\r\n      </template>\r\n      <!-- leftVisible不为undefined为渲染mainTree和mainForm插槽 ，否则渲染mainCon插槽-->\r\n      <template v-slot:mainTree>\r\n        <div class=\"mmc-left-tree height-all\">\r\n          <div class=\"mmc-left-tree-title\">\r\n            <BsTreeSet\r\n              :tree-config=\"treeConfig\"\r\n              @onAsideChange=\"leftVisible = false\"\r\n              @onChangeInput=\"changeInput\"\r\n            />\r\n          </div>\r\n          <div class=\"mmc-left-tree-body\">\r\n            <BsTree\r\n              ref=\"testTree\"\r\n              open-loading\r\n              :filter-text=\"letftTreeFilterText\"\r\n              :config=\"leftTreeConfig\"\r\n              :tree-data=\"treeData\"\r\n              :queryparams=\"treeQueryparams\"\r\n              @onNodeCheckClick=\"onNodeCheckClick\"\r\n              @onNodeClick=\"onNodeClick\"\r\n            />\r\n          </div>\r\n        </div>\r\n      </template>\r\n      <template v-slot:mainForm>\r\n        <div class=\"finereport finereport__toolbar\">\r\n          <vxe-button type=\"text\" class=\"finereport finereport__title\" content=\"帆软报表\" />\r\n          <vxe-button status=\"primary\" size=\"mini\" icon=\"vxe-icon--refresh\" content=\"刷新\" @click=\"onRefreshClick\" />\r\n          <vxe-button status=\"primary\" size=\"mini\" icon=\"vxe-icon--download\" content=\"导出\" @dropdown-click=\"onExportClick\">\r\n            <template #dropdowns>\r\n              <vxe-button type=\"text\" status=\"success\" icon=\"vxe-icon--menu\" name=\"excel\" content=\"导出为Excel\" />\r\n              <vxe-button type=\"text\" status=\"danger\" icon=\"vxe-icon--menu\" name=\"pdf\" content=\"导出为PDF\" />\r\n              <vxe-button type=\"text\" status=\"primary\" icon=\"vxe-icon--menu\" name=\"word\" content=\"导出为Word\" />\r\n              <vxe-button type=\"text\" status=\"custom-rainbow\" icon=\"vxe-icon--menu\" name=\"png\" content=\"导出为图片\" />\r\n            </template>\r\n          </vxe-button>\r\n        </div>\r\n        <iframe\r\n          id=\"reportFrame\"\r\n          height=\"100%\"\r\n          src=\"http://localhost:8075/webroot/decision/view/report?viewlet=demo%252Fanalytics%252F%25E6%25A8%25AA%25E5%2590%2591%25E6%2589%25A9%25E5%25B1%2595%25E5%2590%258E%25E6%259F%2590%25E5%2588%2597%25E6%2595%25B0%25E6%258D%25AE%25E5%258D%25A0%25E6%25AF%2594.cpt&op=write\"\r\n        ></iframe>\r\n      </template>\r\n    </BsMainFormListLayout>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { myMethods } from '@/views/test/blankTemplate/js/methods.js'\r\nimport mix from '@/mixin/commonMixin.js'\r\n\r\nexport default {\r\n  name: 'FineReportTemplate',\r\n  components: {},\r\n  mixins: [mix],\r\n  props: {\r\n    allPropData: {\r\n      type: Object,\r\n      default() {\r\n        return {}\r\n      }\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      tabStatusBtnConfig: {},\r\n      treeConfig: {},\r\n      leftVisible: true,\r\n      letftTreeFilterText: '',\r\n      leftTreeConfig: {},\r\n      treeData: [],\r\n      treeQueryparams: {}\r\n    }\r\n  },\r\n  computed: {},\r\n  watch: {\r\n    queryFormData: {\r\n      handler(newval) {\r\n        console.log(newval)\r\n      },\r\n      deep: true,\r\n      immediate: true\r\n    }\r\n  },\r\n  created() {\r\n    this.initCreated()\r\n    this.initFineReport()\r\n  },\r\n  mounted() {\r\n    this.initMounted()\r\n  },\r\n  methods: {\r\n    ...myMethods,\r\n    // 初始化帆软报表样式\r\n    initFineReport() {\r\n      const iframe = document.getElementById('reportFrame')\r\n      // 获取iframe内的页面文档对象\r\n      let report = {}\r\n      try {\r\n        report = iframe.contentWindow.document\r\n      } catch {\r\n        this.$XModal.message({ id: 'finereportError', status: 'error', message: '获取帆软报表失败: 极有可能是跨源问题', duration: 5000 })\r\n        return\r\n      }\r\n      // 获取帆软内置的工具栏对象\r\n      const toolbar = report.getElementsByClassName('x-toolbar')[0]\r\n      toolbar.style.display = 'none' // 将默认工具栏隐藏掉\r\n\r\n      // 获取报表容器对象\r\n      const container = report.getElementsByClassName('reportPane')[0]\r\n      container.style.top = '0px' // 去除默认的finereport内置工具栏后，需要将整个报表上移，填充工具栏空白处\r\n\r\n      // 获取单元格对象\r\n      const td = report.getElementsByTagName('td')\r\n      for (let i = 0; i < td.length; i++) {\r\n        td[i].style.background = 'none' // 去除每个单元格的默认背景\r\n        td[i].style.color = 'black' // 统一字体颜色\r\n      }\r\n\r\n      // 获取表格的表头行头像\r\n      const tr = report.getElementsByTagName('tr')\r\n      tr[0].style.backgroundColor = 'rgb(227, 242, 254)' // 将表头背景色配成和外页面相同风格\r\n      // 表格斑马纹\r\n      for (let i = 2; i < tr.length; i = i + 2) {\r\n        tr[i].style.backgroundColor = 'rgb(244, 246, 253)'\r\n      }\r\n    },\r\n    // 刷新\r\n    onRefreshClick() {\r\n\r\n    },\r\n    // 导出\r\n    onExportClick({ name, $event }) {\r\n      const iframe = document.getElementById('reportFrame')\r\n      let report = {}\r\n      try {\r\n        report = iframe.contentWindow.contentPane\r\n      } catch {\r\n        this.$XModal.message({ id: 'finereportError', status: 'error', message: '获取帆软报表失败: 极有可能是跨源问题', duration: 5000 })\r\n        return\r\n      }\r\n      switch (name) {\r\n        case 'excel':\r\n          // 导出为Excel（格式为原样输出），FineReport内置方法\r\n          report.exportReportToExcel('simple')\r\n          break\r\n        case 'pdf':\r\n          // 导出为PDF，FineReport内置方法\r\n          report.exportReportToPDF()\r\n          break\r\n        case 'word':\r\n          // 导出为Word，FineReport内置方法\r\n          report.exportReportToWord()\r\n          break\r\n        case 'png':\r\n          // 导出为图片，FineReport内置方法\r\n          report.exportReportToImage()\r\n          break\r\n      }\r\n    }\r\n  }\r\n\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scope>\r\n  .vxe-button.type--text.theme--custom-rainbow {\r\n    background: linear-gradient(to right, orange,yellow,violet);\r\n    background-clip: text;\r\n    -webkit-text-fill-color: transparent;\r\n    &:hover{\r\n      opacity: 0.75;\r\n    }\r\n  }\r\n  .finereport.finereport__toolbar {\r\n    text-align: center;\r\n  }\r\n  .finereport.finereport__title {\r\n    width: 200px;\r\n    height: 50px;\r\n    background-color: rgb(227, 242, 254);\r\n  }\r\n  #reportFrame {\r\n    border: 1px #eee solid;\r\n  }\r\n</style>\r\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAuEA,SAAAA,SAAA;AACA,OAAAC,GAAA;AAEA;EACAC,IAAA;EACAC,UAAA;EACAC,MAAA,GAAAH,GAAA;EACAI,KAAA;IACAC,WAAA;MACAC,IAAA,EAAAC,MAAA;MACAC,OAAA,WAAAC,SAAA;QACA;MACA;IACA;EACA;EACAC,IAAA,WAAAA,KAAA;IACA;MACAC,kBAAA;MACAC,UAAA;MACAC,WAAA;MACAC,mBAAA;MACAC,cAAA;MACAC,QAAA;MACAC,eAAA;IACA;EACA;EACAC,QAAA;EACAC,KAAA;IACAC,aAAA;MACAC,OAAA,WAAAA,QAAAC,MAAA;QACAC,OAAA,CAAAC,GAAA,CAAAF,MAAA;MACA;MACAG,IAAA;MACAC,SAAA;IACA;EACA;EACAC,OAAA,WAAAA,QAAA;IACA,KAAAC,WAAA;IACA,KAAAC,cAAA;EACA;EACAC,OAAA,WAAAA,QAAA;IACA,KAAAC,WAAA;EACA;EACAC,OAAA,EAAAC,aAAA,CAAAA,aAAA,KACAlC,SAAA;IACA;IACA8B,cAAA,WAAAA,eAAA;MACA,IAAAK,MAAA,GAAAC,QAAA,CAAAC,cAAA;MACA;MACA,IAAAC,MAAA;MACA;QACAA,MAAA,GAAAH,MAAA,CAAAI,aAAA,CAAAH,QAAA;MACA,SAAAI,OAAA;QACA,KAAAC,OAAA,CAAAC,OAAA;UAAAC,EAAA;UAAAC,MAAA;UAAAF,OAAA;UAAAG,QAAA;QAAA;QACA;MACA;MACA;MACA,IAAAC,OAAA,GAAAR,MAAA,CAAAS,sBAAA;MACAD,OAAA,CAAAE,KAAA,CAAAC,OAAA;;MAEA;MACA,IAAAC,SAAA,GAAAZ,MAAA,CAAAS,sBAAA;MACAG,SAAA,CAAAF,KAAA,CAAAG,GAAA;;MAEA;MACA,IAAAC,EAAA,GAAAd,MAAA,CAAAe,oBAAA;MACA,SAAAC,CAAA,MAAAA,CAAA,GAAAF,EAAA,CAAAG,MAAA,EAAAD,CAAA;QACAF,EAAA,CAAAE,CAAA,EAAAN,KAAA,CAAAQ,UAAA;QACAJ,EAAA,CAAAE,CAAA,EAAAN,KAAA,CAAAS,KAAA;MACA;;MAEA;MACA,IAAAC,EAAA,GAAApB,MAAA,CAAAe,oBAAA;MACAK,EAAA,IAAAV,KAAA,CAAAW,eAAA;MACA;MACA,SAAAL,EAAA,MAAAA,EAAA,GAAAI,EAAA,CAAAH,MAAA,EAAAD,EAAA,GAAAA,EAAA;QACAI,EAAA,CAAAJ,EAAA,EAAAN,KAAA,CAAAW,eAAA;MACA;IACA;IACA;IACAC,cAAA,WAAAA,eAAA,GAEA;IACA;IACAC,aAAA,WAAAA,cAAAC,IAAA;MAAA,IAAA5D,IAAA,GAAA4D,IAAA,CAAA5D,IAAA;QAAA6D,MAAA,GAAAD,IAAA,CAAAC,MAAA;MACA,IAAA5B,MAAA,GAAAC,QAAA,CAAAC,cAAA;MACA,IAAAC,MAAA;MACA;QACAA,MAAA,GAAAH,MAAA,CAAAI,aAAA,CAAAyB,WAAA;MACA,SAAAC,QAAA;QACA,KAAAxB,OAAA,CAAAC,OAAA;UAAAC,EAAA;UAAAC,MAAA;UAAAF,OAAA;UAAAG,QAAA;QAAA;QACA;MACA;MACA,QAAA3C,IAAA;QACA;UACA;UACAoC,MAAA,CAAA4B,mBAAA;UACA;QACA;UACA;UACA5B,MAAA,CAAA6B,iBAAA;UACA;QACA;UACA;UACA7B,MAAA,CAAA8B,kBAAA;UACA;QACA;UACA;UACA9B,MAAA,CAAA+B,mBAAA;UACA;MACA;IACA;EAAA;AAGA"}]}