{"remainingRequest":"C:\\Users\\何小龙\\Desktop\\platformweb-fb\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\何小龙\\Desktop\\platformweb-fb\\src\\views\\loginModule\\Login.vue?vue&type=style&index=0&lang=scss&","dependencies":[{"path":"C:\\Users\\何小龙\\Desktop\\platformweb-fb\\src\\views\\loginModule\\Login.vue","mtime":1694505522198},{"path":"C:\\Users\\何小龙\\Desktop\\platformweb-fb\\node_modules\\css-loader\\dist\\cjs.js","mtime":1696752946978},{"path":"C:\\Users\\何小龙\\Desktop\\platformweb-fb\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"C:\\Users\\何小龙\\Desktop\\platformweb-fb\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"C:\\Users\\何小龙\\Desktop\\platformweb-fb\\node_modules\\sass-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\何小龙\\Desktop\\platformweb-fb\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\何小龙\\Desktop\\platformweb-fb\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKDQouZWwtc2Nyb2xsYmFyIHsNCiAgcGFkZGluZzogNXB4IDA7DQogIC8vIC5lbC1zY3JvbGxiYXJfX3ZpZXcgLmVsLXNlbGVjdC1kcm9wZG93bl9faXRlbSB7DQogIC8vICAgcGFkZGluZy1sZWZ0OiAzMHB4Ow0KICAvLyB9DQogIC5lbC1zZWxlY3QtZHJvcGRvd25fX2xpc3R7DQogICAgcGFkZGluZzogMDsNCiAgfQ0KfQ0KDQoubG9naW4gew0KICB3aWR0aDogMTAwdnc7DQogIGhlaWdodDogMTAwdmg7DQogIGJhY2tncm91bmQtaW1hZ2U6IHVybCgnLi9pbWcvYmcucG5nJyk7DQogIGJhY2tncm91bmQtc2l6ZTogYXV0byAxMDAlOw0KICBiYWNrZ3JvdW5kLXBvc2l0aW9uOiBjZW50ZXI7DQogIGp1c3RpZnktY29udGVudDogY2VudGVyOw0KICBhbGlnbi1pdGVtczogY2VudGVyOw0KDQogIC5sb2dpbkhlYWRlciB7DQogICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7DQogICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsNCiAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgIC50aXRsZSB7DQogICAgICBmb250LXNpemU6IDQycHg7DQogICAgICBjb2xvcjogI2ZmZjsNCiAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAgfQ0KICB9DQogIC5jb250ZW50IHsNCiAgICBtYXJnaW46IDgwcHggYXV0byAwcHg7DQogICAgd2lkdGg6IDQzMHB4Ow0KICAgIGhlaWdodDogNDIwcHg7DQogICAgYm9yZGVyOiAxcHggc29saWQgIzFhN2RiNjsNCiAgICBiYWNrZ3JvdW5kOiByZ2JhKDAsIDAsIDAsIDAuNCk7DQogICAgYm9yZGVyLXJhZGl1czogMjRweDsNCiAgICBwYWRkaW5nOiA0MnB4Ow0KICAgIGJveC1zaGFkb3c6IDAgMCAxNXB4ICMzOGJiZmY7DQogICAgaW5wdXQgew0KICAgICAgYm9yZGVyOiBub25lOw0KICAgICAgb3V0bGluZTogbm9uZTsNCiAgICAgIHBhZGRpbmctbGVmdDogMzBweDsNCiAgICAgIGZvbnQtc2l6ZTogMTZweDsNCiAgICB9DQogICAgLmVsLWlucHV0X19pbm5lcjpmb2N1cyB7DQogICAgICAgICAgY29sb3I6ICMzMzM7DQogICAgIH0NCiAgICAudXNlci1zZWxlY3Qgew0KICAgICAgd2lkdGg6IDEwMCU7DQogICAgICBoZWlnaHQ6IDQycHg7DQogICAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgICAgYmFja2dyb3VuZDogI2ZmZjsNCiAgICAgIGJvcmRlci1yYWRpdXM6IDIxcHg7DQogICAgfQ0KICB9DQogIC5jb250ZW50VGl0bGUgew0KICAgIGZvbnQtc2l6ZTogMjJweDsNCiAgICBmb250LWZhbWlseTog5b6u6L2v6ZuF6buROw0KICAgIG1hcmdpbi1ib3R0b206IDIycHg7DQogICAgdGV4dC1hbGlnbjogY2VudGVyOw0KICAgIGNvbG9yOiB3aGl0ZTsNCiAgICBwYWRkaW5nLXRvcDogMTVweDsNCiAgfQ0KICAudXNlck5hbWUgew0KICAgIHdpZHRoOiAxMDAlOw0KICAgIGhlaWdodDogNDJweDsNCiAgICBiYWNrZ3JvdW5kOiAjZmZmOw0KICAgIGJvcmRlci1yYWRpdXM6IDIxcHg7DQogICAgbWFyZ2luLWJvdHRvbTogMThweDsNCiAgICBsaW5lLWhlaWdodDogNDJweDsNCiAgICBvdmVyZmxvdzogaGlkZGVuOw0KICAgIC51c2VyTmFtZS1sZWZ0IHsNCiAgICB9DQogIH0NCiAgLnBhc3NXb3JkIHsNCiAgICB3aWR0aDogMTAwJTsNCiAgICBoZWlnaHQ6IDQycHg7DQogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgICBiYWNrZ3JvdW5kOiAjZmZmOw0KICAgIGJvcmRlci1yYWRpdXM6IDIxcHg7DQogICAgbWFyZ2luLWJvdHRvbTogMThweDsNCiAgICBsaW5lLWhlaWdodDogNDJweDsNCiAgICBvdmVyZmxvdzogaGlkZGVuOw0KICB9DQogIC51c2VyTnVtIHsNCiAgICBwYWRkaW5nLWxlZnQ6IDEwcHg7DQogICAgaGVpZ2h0OiA0MnB4Ow0KICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAgYmFja2dyb3VuZDogI2ZmZjsNCiAgICBib3JkZXItcmFkaXVzOiAyMXB4Ow0KICAgIG1hcmdpbi1ib3R0b206IDE4cHg7DQogICAgbGluZS1oZWlnaHQ6IDQycHg7DQogICAgb3ZlcmZsb3c6IGhpZGRlbjsNCiAgICAubWF0ZSB7DQogICAgICBwYWRkaW5nLWxlZnQ6IDQwcHg7DQogICAgfQ0KICB9DQogIC5sb2dpbi1idG5zIHsNCiAgICB3aWR0aDogMTAwJTsNCiAgICBoZWlnaHQ6IDQycHg7DQogICAgYm9yZGVyLXJhZGl1czogMjFweDsNCiAgICBtYXJnaW4tYm90dG9tOiAxOHB4Ow0KICAgIGxpbmUtaGVpZ2h0OiA0MnB4Ow0KICAgIG92ZXJmbG93OiBoaWRkZW47DQogICAgLmJ0biB7DQogICAgICB3aWR0aDogMTAwJTsNCiAgICAgIGhlaWdodDogNDJweDsNCiAgICAgIGJvcmRlcjogbm9uZTsNCiAgICAgIG91dGxpbmU6IG5vbmU7DQogICAgICBmb250LXNpemU6IDIwcHg7DQogICAgICBmb250LXdlaWdodDogNzAwOw0KICAgICAgYmFja2dyb3VuZDogdmFyKC0tcHJpbWFyeS1jb2xvcik7DQogICAgICBtYXJnaW4tdG9wOiAwOw0KICAgICAgY29sb3I6ICNmZmY7DQogICAgICB0ZXh0LWFsaWduOiBjZW50ZXI7DQogICAgfQ0KICB9DQogIC5pY29uIHsNCiAgICBmb250LXNpemU6IDI0cHg7DQogICAgcGFkZGluZy1sZWZ0OiAxMHB4Ow0KICB9DQogIC50aXBzIHsNCiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7DQogICAgZm9udC1zaXplOiAxMnB4Ow0KICAgIC50aXBzLXRleHQgew0KICAgICAgbGV0dGVyLXNwYWNpbmc6IDJweDsNCiAgICB9DQogICAgcCB7DQogICAgICBjb2xvcjogI2ZmZjsNCiAgICB9DQogICAgc3BhbiB7DQogICAgICBjb2xvcjogc2t5Ymx1ZTsNCiAgICB9DQogIH0NCn0NCg=="},{"version":3,"sources":["Login.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2OA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Login.vue","sourceRoot":"src/views/loginModule","sourcesContent":["<!--  组件模版   Author:Titans -->\r\n<template>\r\n  <div class=\"login flex\">\r\n    <!-- <czy-header /> -->\r\n    <div class=\"loginHeader flex\">\r\n      <div class=\"title flex\">预算管理一体化系统</div>\r\n      <div class=\"content\">\r\n        <p class=\"contentTitle\">用户登录</p>\r\n        <div class=\"user-select flex\">\r\n          <i class=\"base-font baseyonghu icon\"></i>\r\n          <el-select\r\n            v-model=\"value\"\r\n            placeholder=\"平台配置\"\r\n            filterable\r\n            style=\"width:350px;border:none;\"\r\n            @visible-change=\"getSelect\"\r\n          >\r\n            <el-option\r\n              v-for=\"item in options\"\r\n              :key=\"item.value\"\r\n              :label=\"item.label\"\r\n              :value=\"item.value\"\r\n              :disabled=\"item.disabled\"\r\n            />\r\n          </el-select>\r\n        </div>\r\n\r\n        <div class=\"userName flex\" style=\"margin-top:20px\">\r\n          <div class=\"userName-left flex\">\r\n            <i class=\"base-font baseyonghu icon\"></i>\r\n            <input v-model=\"username\" type=\"text\" placeholder=\"用户名\">\r\n          </div>\r\n          <span v-if=\"isErrors\" style=\"color:red\">*用户名格式不对</span>\r\n        </div>\r\n        <div class=\"passWord flex\">\r\n          <i class=\"base-font basemima icon\"></i>\r\n          <input v-model=\"password\" type=\"password\" placeholder=\"密码\">\r\n        </div>\r\n        <div class=\"userNum flex\">\r\n          <i class=\"base-font baseyanzhengma1 icon\"></i>\r\n          <input v-model=\"usernum\" type=\"text\" placeholder=\"验证码\" class=\"mate\">\r\n        </div>\r\n        <div class=\"login-btns\">\r\n          <button class=\"btn pointer\" @click=\"userLogin\">登&nbsp;录</button>\r\n        </div>\r\n        <div class=\"tips\">\r\n          <p class=\"tips-text\">\r\n            如果您还没有账号，请在这里\r\n            <span class=\"tips-text\">注册账号</span>\r\n          </p>\r\n          <p class=\"tips-text\">\r\n            如果您是新成立单位，请在这里\r\n            <span class=\"tips-text\">用户进度</span>\r\n          </p>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script>\r\nimport LoginModule from '@/api/frame/login/login'\r\nexport default {\r\n  name: 'String',\r\n  components: {\r\n  },\r\n  data() {\r\n    return {\r\n      isErrors: false, // 用户名格式信息\r\n      username: '',\r\n      password: '',\r\n      usernum: '',\r\n      optionsRes: [],\r\n      options: [\r\n\r\n      ],\r\n      value: ''\r\n    }\r\n  }, // 组件数据源\r\n  created() {\r\n    this.loadPlatForm()\r\n  },\r\n  beforeRouteEnter(to, from, next) {\r\n    // 进入路由前\r\n    // console.log(this, 'beforeRouteUpdate')\r\n    next((vm) => {\r\n      // 因为当钩子执行前，组件实例还没被创建\r\n      // vm 就是当前组件的实例相当于上面的 this，所以在 next 方法里你就可以把 vm 当 this 来用了。\r\n      // 当前组件的实例\r\n      // console.log(vm)\r\n    })\r\n  },\r\n  methods: {\r\n    getSelect(flag) {\r\n      if (flag === false) {\r\n      }\r\n    },\r\n    objToQueryUrlString(obj) {\r\n      /* @description   对象序列化(对象转成url参数) @param  {Object} obj  @return {String} */\r\n      let pairs = []\r\n      for (let key in obj) {\r\n        pairs.push('' + key + '=' + obj[key])\r\n      }\r\n      return pairs.join('&')\r\n    },\r\n    getUrlAllParams(url) { /* 获取全部url参数,并转换成json对象 */\r\n      url = url || window.location.href\r\n      let search = url.substring(url.indexOf('?') + 1, url.indexOf('#/') >= 0 ? url.indexOf('#/') : url.length)\r\n      let searchArr = search.split('&')\r\n      let result = {}\r\n      for (let i = 0, _len = searchArr.length; i < _len; i++) {\r\n        let pos = searchArr[i].indexOf('=')\r\n        if (pos === -1) {\r\n          continue\r\n        }\r\n        let name = searchArr[i].substring(0, pos)\r\n        let value = window.decodeURIComponent(searchArr[i].substring(pos + 1))\r\n        result[name] = value\r\n      }\r\n      return result\r\n    },\r\n    userLogin() {\r\n      // this.$store.commit('setLoginAuthentication', { appguid: this.optionsRes[this.value].guid || 'fiscal', tokenid: undefined })\r\n      var formData = new FormData()\r\n      formData.append('username', this.username)\r\n      // formData.append('password', this.$AESEAD.CryptoJS.SHA256(this.password).toString())\r\n      formData.append('password', this.password)\r\n      formData.append('captcha', this.usernum)\r\n      let self = this\r\n      // var formData = this.$http.smSecretUtils.encryptLogin({ isSecret: true, params: { username: self.username, password: self.password, usernum: self.usernum } })\r\n      this.$http\r\n        .post(\r\n          'mp-b-sso-service/v2/userlogin',\r\n          formData,\r\n          false,\r\n          'application/x-www-form-urlencoded'\r\n        )\r\n        .then((res) => {\r\n          // data.tokenid = '22c0bab04c9b4b34fc7a0f6f754b9c97'\r\n          if (res.rscode === '100000') {\r\n            let obj = self.getUrlAllParams()\r\n            window.location.href = window.location.origin + window.location.pathname + '?' + self.objToQueryUrlString(Object.assign(obj, {\r\n              tokenid: res.data.tokenid,\r\n              appguid: self.optionsRes[self.value].guid || 'fiscal'\r\n            }))\r\n            // this.$store.commit('setAppData', {\r\n            //   tokenid: data.tokenid,\r\n            //   appguid: self.optionsRes[self.value].guid || 'fiscal'\r\n            // })\r\n            // this.$store.commit('setUserInfo', data.user)\r\n            // this.authentication()\r\n          } else if (res.rscode === '113999') {\r\n            self.$message({\r\n              message: '用户名或密码错误！',\r\n              type: 'warning'\r\n            })\r\n          } else {\r\n            self.$message({\r\n              message: '登录失败，请核查用户信息或联系管理员！',\r\n              type: 'warning'\r\n            })\r\n          }\r\n        })\r\n        .catch()\r\n    },\r\n    async authentication() {\r\n      const { tokenid, appguid } = this.$store.getters.getLoginAuthentication\r\n      if (!tokenid) {\r\n        this.ifrouteractive = true\r\n        this.$router.push({\r\n          name: 'Login'\r\n        })\r\n      } else {\r\n        await this.$http.get('mp-b-user-service/v1/user/app/message', { appguid: appguid }).then((res) => {\r\n          this.ifrouteractive = true\r\n          res = JSON.parse(res)\r\n          if (res.rscode === '118000') {\r\n            this.$router.push({\r\n              name: 'Login'\r\n            })\r\n          } else {\r\n            this.$store.commit('setUserInfo', res.data)\r\n            this.$store.dispatch('getUserRoles')\r\n            this.$router.push({\r\n              name: 'Main',\r\n              params: {\r\n                userInfo: res.data\r\n              }\r\n            })\r\n            this.$message({\r\n              message: '登录成功',\r\n              type: 'success'\r\n            })\r\n          }\r\n        }).catch(e => {\r\n          console.log(e)\r\n          this.ifrouteractive = true\r\n          this.$router.push({\r\n            name: 'Login'\r\n          })\r\n        })\r\n      }\r\n    },\r\n    loadPlatForm() {\r\n      // 获取平台数据\r\n      LoginModule.getPlatform()\r\n        .then((res) => {\r\n          this.optionsRes = res\r\n          const guidList = []\r\n          const nameList = []\r\n          for (let i = 0; i < res.length; i++) {\r\n            guidList.push(res[i].guid)\r\n            nameList.push(res[i].name)\r\n            this.options.push({ value: i, label: nameList[i] })\r\n          }\r\n        })\r\n        .catch()\r\n    }\r\n  },\r\n  mounted () {\r\n    console.log(666, this.username)\r\n  },\r\n  watch: {\r\n    dataobj: {\r\n      handler() {\r\n      },\r\n      deep: true, // 是否深度监听，意为对象dataobj内部任何属性发生变化则全局重新渲染\r\n      immediate: true // 代表在watch里声明了dataobj这个方法之后立即先去执行handler方法\r\n    },\r\n    username(val) {\r\n      console.log(5555, val)\r\n    }\r\n  }\r\n}\r\n</script>\r\n<style lang=\"scss\">\r\n.el-scrollbar {\r\n  padding: 5px 0;\r\n  // .el-scrollbar__view .el-select-dropdown__item {\r\n  //   padding-left: 30px;\r\n  // }\r\n  .el-select-dropdown__list{\r\n    padding: 0;\r\n  }\r\n}\r\n\r\n.login {\r\n  width: 100vw;\r\n  height: 100vh;\r\n  background-image: url('./img/bg.png');\r\n  background-size: auto 100%;\r\n  background-position: center;\r\n  justify-content: center;\r\n  align-items: center;\r\n\r\n  .loginHeader {\r\n    justify-content: center;\r\n    flex-direction: column;\r\n    align-items: center;\r\n    .title {\r\n      font-size: 42px;\r\n      color: #fff;\r\n      align-items: center;\r\n    }\r\n  }\r\n  .content {\r\n    margin: 80px auto 0px;\r\n    width: 430px;\r\n    height: 420px;\r\n    border: 1px solid #1a7db6;\r\n    background: rgba(0, 0, 0, 0.4);\r\n    border-radius: 24px;\r\n    padding: 42px;\r\n    box-shadow: 0 0 15px #38bbff;\r\n    input {\r\n      border: none;\r\n      outline: none;\r\n      padding-left: 30px;\r\n      font-size: 16px;\r\n    }\r\n    .el-input__inner:focus {\r\n          color: #333;\r\n     }\r\n    .user-select {\r\n      width: 100%;\r\n      height: 42px;\r\n      align-items: center;\r\n      background: #fff;\r\n      border-radius: 21px;\r\n    }\r\n  }\r\n  .contentTitle {\r\n    font-size: 22px;\r\n    font-family: 微软雅黑;\r\n    margin-bottom: 22px;\r\n    text-align: center;\r\n    color: white;\r\n    padding-top: 15px;\r\n  }\r\n  .userName {\r\n    width: 100%;\r\n    height: 42px;\r\n    background: #fff;\r\n    border-radius: 21px;\r\n    margin-bottom: 18px;\r\n    line-height: 42px;\r\n    overflow: hidden;\r\n    .userName-left {\r\n    }\r\n  }\r\n  .passWord {\r\n    width: 100%;\r\n    height: 42px;\r\n    align-items: center;\r\n    background: #fff;\r\n    border-radius: 21px;\r\n    margin-bottom: 18px;\r\n    line-height: 42px;\r\n    overflow: hidden;\r\n  }\r\n  .userNum {\r\n    padding-left: 10px;\r\n    height: 42px;\r\n    align-items: center;\r\n    background: #fff;\r\n    border-radius: 21px;\r\n    margin-bottom: 18px;\r\n    line-height: 42px;\r\n    overflow: hidden;\r\n    .mate {\r\n      padding-left: 40px;\r\n    }\r\n  }\r\n  .login-btns {\r\n    width: 100%;\r\n    height: 42px;\r\n    border-radius: 21px;\r\n    margin-bottom: 18px;\r\n    line-height: 42px;\r\n    overflow: hidden;\r\n    .btn {\r\n      width: 100%;\r\n      height: 42px;\r\n      border: none;\r\n      outline: none;\r\n      font-size: 20px;\r\n      font-weight: 700;\r\n      background: var(--primary-color);\r\n      margin-top: 0;\r\n      color: #fff;\r\n      text-align: center;\r\n    }\r\n  }\r\n  .icon {\r\n    font-size: 24px;\r\n    padding-left: 10px;\r\n  }\r\n  .tips {\r\n    text-align: center;\r\n    font-size: 12px;\r\n    .tips-text {\r\n      letter-spacing: 2px;\r\n    }\r\n    p {\r\n      color: #fff;\r\n    }\r\n    span {\r\n      color: skyblue;\r\n    }\r\n  }\r\n}\r\n</style>\r\n"]}]}