{"remainingRequest":"C:\\Users\\何小龙\\Desktop\\platformweb-fb\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\何小龙\\Desktop\\platformweb-fb\\src\\views\\px-to-vw-page\\threePublicExpenses\\components\\RuleScroll.vue?vue&type=style&index=0&id=d316422c&lang=scss&scoped=true&","dependencies":[{"path":"C:\\Users\\何小龙\\Desktop\\platformweb-fb\\src\\views\\px-to-vw-page\\threePublicExpenses\\components\\RuleScroll.vue","mtime":1694505522904},{"path":"C:\\Users\\何小龙\\Desktop\\platformweb-fb\\node_modules\\css-loader\\dist\\cjs.js","mtime":1696752946978},{"path":"C:\\Users\\何小龙\\Desktop\\platformweb-fb\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"C:\\Users\\何小龙\\Desktop\\platformweb-fb\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"C:\\Users\\何小龙\\Desktop\\platformweb-fb\\node_modules\\sass-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\何小龙\\Desktop\\platformweb-fb\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\何小龙\\Desktop\\platformweb-fb\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoNCkBpbXBvcnQgIi4uLy4uL2NvbW1vbi9zdHlsZS9tb2R1bGUtd3JhcHBlciI7DQoubW9kdWxlLXdyYXBwZXIgew0KICBib3gtc2hhZG93OiBub25lICFpbXBvcnRhbnQ7DQp9DQoucnVsZS1zd2lwZXItdGl0bGUgew0KICBwYWRkaW5nOiAxNnB4IDIycHg7DQogIGZvbnQtc2l6ZTogMTZweDsNCiAgY29sb3I6ICM1OTU5NTk7DQogIGxpbmUtaGVpZ2h0OiAyNnB4Ow0KICBmb250LXdlaWdodDogYm9sZDsNCiAgYm94LXNpemluZzogYm9yZGVyLWJveDsNCn0NCi5ydWxlLXN3aXBlci1jb250YWluZXIgew0KICB3aWR0aDogMTAwJTsNCiAgaGVpZ2h0OiAzMjBweDsNCiAgcGFkZGluZzogMCAyNHB4Ow0KICBib3gtc2l6aW5nOiBib3JkZXItYm94Ow0KDQogIC5ydWxlLXN3aXBlci1zbGlkZSB7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47DQogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgICBoZWlnaHQ6IDQ2cHggIWltcG9ydGFudDsNCiAgICBib3JkZXItdG9wOiAxcHggc29saWQgI2UwZTBlMDsNCiAgICBib3gtc2l6aW5nOiBib3JkZXItYm94Ow0KDQogICAgJjpsYXN0LWNoaWxkIHsNCiAgICAgIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCAjZTBlMGUwOw0KICAgIH0NCg0KICAgIC5ydWxlLWNvbnRlbnQgew0KICAgICAgd2lkdGg6IDMyMHB4Ow0KICAgICAgb3ZlcmZsb3c6IGhpZGRlbjsNCiAgICAgIHdoaXRlLXNwYWNlOiBub3dyYXA7DQogICAgICB0ZXh0LW92ZXJmbG93OiBlbGxpcHNpczsNCiAgICAgIGZvbnQtc2l6ZTogMTRweDsNCiAgICAgIGNvbG9yOiAjMkUzMTMzOw0KICAgIH0NCg0KICAgIC5yaWdodC10aW1lIHsNCiAgICAgIGZvbnQtc2l6ZTogMTJweDsNCiAgICAgIGNvbG9yOiAjOEE5Mjk5Ow0KICAgIH0NCiAgfQ0KfQ0KDQoucnVsZS1oYW5kbGUtY29udGFpbmVyIHsNCiAgcG9zaXRpb246IHJlbGF0aXZlOw0KDQogIC5ydWxlLWN1cnJlbnQtc3ltYm9sIHsNCiAgICBwb3NpdGlvbjogYWJzb2x1dGU7DQogICAgdG9wOiAwOw0KICAgIGxlZnQ6IDA7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgIGhlaWdodDogNDZweDsNCiAgICBib3JkZXItbGVmdDogNHB4IHNvbGlkICMyQThCRkQ7DQoNCiAgICAmOjphZnRlciB7DQogICAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7DQogICAgICB3aWR0aDogMDsNCiAgICAgIGhlaWdodDogMDsNCiAgICAgIG1hcmdpbi1sZWZ0OiAycHg7DQogICAgICBib3JkZXI6IDZweCBzb2xpZCB0cmFuc3BhcmVudDsNCiAgICAgIGJvcmRlci1sZWZ0LWNvbG9yOiAjMkE4QkZEOw0KICAgICAgY29udGVudDogJyc7DQogICAgfQ0KICB9DQp9DQoNCi5ydWxlU3ltYm9sU2hvdy1sZWF2ZSwgLnJ1bGVTeW1ib2xTaG93LWVudGVyLXRvIHsNCiAgb3BhY2l0eTogMTsNCiAgdHJhbnNmb3JtOiBzY2FsZSgxKTsNCiAgdHJhbnNpdGlvbjogYWxsIDAuMXM7DQp9DQoucnVsZVN5bWJvbFNob3ctbGVhdmUtdG8sIC5ydWxlU3ltYm9sU2hvdy1lbnRlciB7DQogIG9wYWNpdHk6IDA7DQogIHRyYW5zZm9ybTogc2NhbGUoMCk7DQogIHRyYW5zaXRpb246IGFsbCAwLjJzOw0KfQ0K"},{"version":3,"sources":["RuleScroll.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiOA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"RuleScroll.vue","sourceRoot":"src/views/px-to-vw-page/threePublicExpenses/components","sourcesContent":["<template>\r\n  <div class=\"module-wrapper\">\r\n    <div class=\"rule-swiper-title\">{{ title }}</div>\r\n    <div v-if=\"!news.length\">\r\n      <BsEmpty />\r\n    </div>\r\n    <div\r\n      v-else\r\n      class=\"rule-handle-container\"\r\n      @mouseenter=\"swiperEnterHandle\"\r\n      @mouseleave=\"swiperLeaveHandle\"\r\n    >\r\n      <transition name=\"ruleSymbolShow\">\r\n        <div\r\n          v-show=\"showRuleCurrentSymbol\"\r\n          class=\"rule-current-symbol\"\r\n        >\r\n        </div>\r\n      </transition>\r\n      <div class=\"swiper-container swiper-no-swiping rule-swiper-container\">\r\n        <div class=\"swiper-wrapper\">\r\n          <div\r\n            v-for=\"(item, index) in news\"\r\n            :key=\"index\"\r\n            class=\"swiper-slide rule-swiper-slide\"\r\n          >\r\n            <el-tooltip class=\"item\" effect=\"light\" :content=\"`${item[codeField]}-${item[nameField]}`\" placement=\"top-start\">\r\n              <div class=\"rule-content\">{{ item[codeField] }}-{{ item[nameField] }}</div>\r\n            </el-tooltip>\r\n            <div class=\"right-time\">\r\n              <span>{{ item.createTime }}</span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { defineComponent, ref, unref, onMounted, onBeforeUnmount, watch, nextTick } from '@vue/composition-api'\r\nimport Swiper from 'swiper'\r\n\r\nimport computedPx from '@/utils/computedPx'\r\nimport { getLatestData } from '@/api/frame/main/warningOverview'\r\n\r\nexport default defineComponent({\r\n  props: {\r\n    // 模块标题\r\n    title: {\r\n      type: String,\r\n      default: '实时触发规则滚动显示图'\r\n    },\r\n    // 请求方法\r\n    fetch: {\r\n      type: Function,\r\n      default: getLatestData\r\n    },\r\n    // code映射字段\r\n    codeField: {\r\n      type: String,\r\n      default: 'firulecode'\r\n    },\r\n    // 名称映射字段\r\n    nameField: {\r\n      type: String,\r\n      default: 'firulename'\r\n    },\r\n    // 请求负载\r\n    payload: {\r\n      type: Object,\r\n      default: () => ({})\r\n    }\r\n  },\r\n  setup(props) {\r\n    // 规则列表数据\r\n    const news = ref([])\r\n\r\n    // 定时器\r\n    let timer = null\r\n    // 间隔\r\n    const interval = 60000 * 5\r\n\r\n    const getLatestDataHandle = async () => {\r\n      const params = props.payload || {}\r\n      const { data } = await props.fetch(params)\r\n      news.value = data || []\r\n      timer = setInterval(async () => {\r\n        const { data } = await props.fetch(params)\r\n        news.value = data || []\r\n      }, interval)\r\n    }\r\n\r\n    // 是否显示当前规则的图标\r\n    const showRuleCurrentSymbol = ref(true)\r\n\r\n    // swiper实例\r\n    let swiperInstance = null\r\n\r\n    // swiper参数配置\r\n    const swiperOption = {\r\n      direction: 'vertical',\r\n      height: computedPx(320),\r\n      slidesPerView: 7,\r\n      // 循环切换\r\n      loop: {\r\n        loop: true,\r\n        loopedSlides: 7\r\n      },\r\n      // 自动切换\r\n      autoplay: {\r\n        delay: 2000,\r\n        disableOnInteraction: false\r\n      },\r\n      effects: {\r\n        effect: 'fade'\r\n      },\r\n      // 切换速度\r\n      speed: 400,\r\n      touches: {\r\n        simulateTouch: false\r\n      },\r\n      observer: true,\r\n      observeParents: true,\r\n      // 监听时间\r\n      on: {\r\n        slideChangeTransitionStart() {\r\n          showRuleCurrentSymbol.value = false\r\n        },\r\n        slideChangeTransitionEnd() {\r\n          showRuleCurrentSymbol.value = true\r\n        }\r\n      }\r\n    }\r\n    /**\r\n     * 初始化swiper\r\n     */\r\n    const initSwiper = () => {\r\n      destroySwiper()\r\n      nextTick(() => {\r\n        swiperInstance = new Swiper('.rule-swiper-container', swiperOption)\r\n      })\r\n    }\r\n\r\n    /**\r\n     * 销毁swiper\r\n     * */\r\n    const destroySwiper = () => {\r\n      swiperInstance && swiperInstance?.destroy?.()\r\n      swiperInstance = null\r\n    }\r\n\r\n    /**\r\n     * 鼠标移入 => 暂停swiper\r\n     */\r\n    const swiperEnterHandle = () => {\r\n      swiperInstance?.autoplay?.stop()\r\n    }\r\n    /**\r\n     * 鼠标移出 => 开启swiper\r\n     */\r\n    const swiperLeaveHandle = () => {\r\n      swiperInstance?.autoplay?.start()\r\n    }\r\n\r\n    /**\r\n     * 禁止swiper\r\n     */\r\n    const disableSwiper = () => {\r\n      swiperOption.loop = false\r\n      swiperOption.autoplay = false\r\n      swiperOption.enabled = false\r\n      initSwiper()\r\n    }\r\n\r\n    /**\r\n     * 启用swiper\r\n     */\r\n    const enableSwiper = () => {\r\n      swiperOption.loop = { loop: true, loopedSlides: 7 }\r\n      swiperOption.autoplay = { delay: 2000, disableOnInteraction: false }\r\n      swiperOption.enabled = true\r\n      initSwiper()\r\n    }\r\n\r\n    /**\r\n     * 更像swiper\r\n     */\r\n    const updateSwiper = () => {\r\n      unref(news)?.length <= 5 ? disableSwiper() : enableSwiper()\r\n    }\r\n\r\n    watch(news, () => {\r\n      updateSwiper()\r\n    }, { deep: true })\r\n\r\n    /**\r\n     * 动态计算高度，重新初始化\r\n     */\r\n    const resizeHandle = () => {\r\n      swiperOption.height = computedPx(320)\r\n      initSwiper()\r\n    }\r\n\r\n    onMounted(() => {\r\n      getLatestDataHandle()\r\n      window.addEventListener('resize', resizeHandle)\r\n    })\r\n\r\n    onBeforeUnmount(() => {\r\n      timer && clearInterval(timer)\r\n      window.removeEventListener('resize', resizeHandle)\r\n    })\r\n\r\n    return {\r\n      news,\r\n      showRuleCurrentSymbol,\r\n      swiperEnterHandle,\r\n      swiperLeaveHandle\r\n    }\r\n  }\r\n})\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n@import \"../../common/style/module-wrapper\";\r\n.module-wrapper {\r\n  box-shadow: none !important;\r\n}\r\n.rule-swiper-title {\r\n  padding: 16px 22px;\r\n  font-size: 16px;\r\n  color: #595959;\r\n  line-height: 26px;\r\n  font-weight: bold;\r\n  box-sizing: border-box;\r\n}\r\n.rule-swiper-container {\r\n  width: 100%;\r\n  height: 320px;\r\n  padding: 0 24px;\r\n  box-sizing: border-box;\r\n\r\n  .rule-swiper-slide {\r\n    display: flex;\r\n    justify-content: space-between;\r\n    align-items: center;\r\n    height: 46px !important;\r\n    border-top: 1px solid #e0e0e0;\r\n    box-sizing: border-box;\r\n\r\n    &:last-child {\r\n      border-bottom: 1px solid #e0e0e0;\r\n    }\r\n\r\n    .rule-content {\r\n      width: 320px;\r\n      overflow: hidden;\r\n      white-space: nowrap;\r\n      text-overflow: ellipsis;\r\n      font-size: 14px;\r\n      color: #2E3133;\r\n    }\r\n\r\n    .right-time {\r\n      font-size: 12px;\r\n      color: #8A9299;\r\n    }\r\n  }\r\n}\r\n\r\n.rule-handle-container {\r\n  position: relative;\r\n\r\n  .rule-current-symbol {\r\n    position: absolute;\r\n    top: 0;\r\n    left: 0;\r\n    display: flex;\r\n    align-items: center;\r\n    height: 46px;\r\n    border-left: 4px solid #2A8BFD;\r\n\r\n    &::after {\r\n      display: inline-block;\r\n      width: 0;\r\n      height: 0;\r\n      margin-left: 2px;\r\n      border: 6px solid transparent;\r\n      border-left-color: #2A8BFD;\r\n      content: '';\r\n    }\r\n  }\r\n}\r\n\r\n.ruleSymbolShow-leave, .ruleSymbolShow-enter-to {\r\n  opacity: 1;\r\n  transform: scale(1);\r\n  transition: all 0.1s;\r\n}\r\n.ruleSymbolShow-leave-to, .ruleSymbolShow-enter {\r\n  opacity: 0;\r\n  transform: scale(0);\r\n  transition: all 0.2s;\r\n}\r\n</style>\r\n"]}]}