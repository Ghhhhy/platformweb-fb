{"remainingRequest":"C:\\Users\\何小龙\\Desktop\\platformweb-fb\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\何小龙\\Desktop\\platformweb-fb\\src\\views\\main\\fundMonitoring\\manageMofAgencyProRelation\\manageMofAgencyProRelation.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\何小龙\\Desktop\\platformweb-fb\\src\\views\\main\\fundMonitoring\\manageMofAgencyProRelation\\manageMofAgencyProRelation.vue","mtime":1694505522669},{"path":"C:\\Users\\何小龙\\Desktop\\platformweb-fb\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\何小龙\\Desktop\\platformweb-fb\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"C:\\Users\\何小龙\\Desktop\\platformweb-fb\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\何小龙\\Desktop\\platformweb-fb\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgSHR0cE1vZHVsZSBmcm9tICdAL2FwaS9mcmFtZS9tYWluL2Z1bmRNb25pdG9yaW5nL01hbmFnZU1vZkRlcFByb1JlbGF0aW9uLmpzJw0KZXhwb3J0IGRlZmF1bHQgew0KICBuYW1lOiAnVXNlclByb1JlbGF0aW9uJywNCiAgZGF0YSgpIHsNCiAgICByZXR1cm4gew0KICAgICAgc2hvd0xvYWRpbmdMZWZ0OiBmYWxzZSwNCiAgICAgIHNob3dMb2FkaW5nUmlnaHQ6IGZhbHNlLA0KICAgICAgdXNlclRyZWVEYXRhOiBbXSwNCiAgICAgIHN0YW1wVHJlZURhdGE6IFtdLA0KICAgICAgcHJvQXJyYXk6IFtdLA0KICAgICAgdXNlclNlbGVjdDoge30NCiAgICB9DQogIH0sDQogIG1ldGhvZHM6IHsNCiAgICBhYWEob2JqLCBjaGVja3NPYmopIHsNCiAgICAgIGNvbnNvbGUubG9nKG9iaiwgY2hlY2tzT2JqKQ0KICAgIH0sDQogICAgaW5pdCgpIHsNCiAgICB9LA0KICAgIG9uVXNlclRyZWVMb2FkRmluaXNoKGRhdGEpIHsNCiAgICAgIC8vIHRoaXMudXNlclRyZWVEYXRhID0gZGF0YQ0KICAgICAgSHR0cE1vZHVsZS5xdWVyeVRhYmxlRGF0YXMoKS50aGVuKHJlcyA9PiB7DQogICAgICAgIHRoaXMuc3RhbXBUcmVlRGF0YSA9IHJlcy5kYXRhDQogICAgICAgIC8vIHRoaXMuJG5leHRUaWNrKCgpID0+IHsNCiAgICAgICAgLy8gICAvLyDph43mlrDotYvlgLwNCiAgICAgICAgLy8gICB0aGlzLnVzZXJUcmVlRGF0YSA9IFtdDQogICAgICAgIC8vICAgdGhpcy51c2VyVHJlZURhdGEgPSB0aGlzLnN0YW1wVHJlZURhdGENCiAgICAgICAgLy8gfSkNCiAgICAgICAgdGhpcy5zaG93TG9hZGluZ1JpZ2h0ID0gZmFsc2UNCiAgICAgIH0pLmNhdGNoKCgpID0+IHsNCiAgICAgICAgdGhpcy5zaG93TG9hZGluZ1JpZ2h0ID0gZmFsc2UNCiAgICAgIH0pDQogICAgfSwNCiAgICB0cmVlTm9kZUNsaWNrKG9iaikgew0KICAgICAgdGhpcy51c2VyU2VsZWN0ID0gb2JqDQogICAgICBjb25zdCBwYXJhbSA9IHsNCiAgICAgICAgbW9mRGVwSWQ6IG9iai5pZA0KICAgICAgfQ0KICAgICAgSHR0cE1vZHVsZS5xdWVyeUJ5TW9mRGVwSWQocGFyYW0pLnRoZW4ocmVzID0+IHsNCiAgICAgICAgbGV0IGFycmF5ID0gW10NCiAgICAgICAgaWYgKHJlcy5jb2RlID09PSAnMDAwMDAwJykgew0KICAgICAgICAgIHJlcy5kYXRhLmZvckVhY2goaXRlbSA9PiB7DQogICAgICAgICAgICBhcnJheS5wdXNoKGl0ZW0uY29kZSkNCiAgICAgICAgICB9KQ0KICAgICAgICAgIHRoaXMucHJvQXJyYXkgPSBhcnJheQ0KICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCdhcnJheScsIGFycmF5KQ0KICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCdhcnJheScsIHRoaXMuJHJlZnMuc3RhbXBUcmVlKQ0KICAgICAgICAgIHRoaXMuJHJlZnMuc3RhbXBUcmVlLnNldENoZWNrZWRLZXlzKGFycmF5KQ0KICAgICAgICAgIC8vIGlmIChhcnJheS5sZW5ndGggPiAwKSB7DQogICAgICAgICAgLy8gICB0aGlzLiRuZXh0VGljaygoKSA9PiB7DQogICAgICAgICAgLy8gICAgIHRoaXMuJHJlZnMuc3RhbXBUcmVlLnRyZWVPcHRpb25GbigpLnNldENoZWNrZWRLZXlzKGFycmF5KQ0KICAgICAgICAgIC8vICAgfSkNCiAgICAgICAgICAvLyB9DQogICAgICAgICAgY29uc29sZS5sb2coJ2FycmF5MScsIHRoaXMuJHJlZnMuc3RhbXBUcmVlKQ0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IocmVzLm1lc3NhZ2UpDQogICAgICAgIH0NCiAgICAgIH0pDQogICAgfSwNCiAgICBub2RlY2hlY2ttZXRob2Qob2JqLCBzdGF0ZSkgew0KICAgICAgLy8gaWYgKG9iai5yZWd1bGF0aW9uQ29kZSA9PT0gJzAnIHx8IG9iai5yZWd1bGF0aW9uQ29kZSA9PT0gJzAxJyB8fCBvYmoucmVndWxhdGlvbkNvZGUgPT09ICcwMicpIHsNCiAgICAgIC8vICAgdGhpcy4kbWVzc2FnZS53YXJuaW5nKCfmoLnoioLngrnkuI3og73ooqvpgInkuK3vvIEnKQ0KICAgICAgLy8gICB0aGlzLiRyZWZzLnN0YW1wVHJlZS5zZXRDaGVja2VkS2V5cyh0aGlzLnByb0FycmF5KQ0KICAgICAgLy8gICByZXR1cm4NCiAgICAgIC8vIH0NCiAgICAgIGlmICh0aGlzLnVzZXJTZWxlY3QuaWQpIHsNCiAgICAgICAgbGV0IGlzQ2hlY2tlZCA9IHN0YXRlLmNoZWNrZWRLZXlzLmluY2x1ZGVzKG9iai5jb2RlKQ0KICAgICAgICB2YXIgcGFyYW0gPSB7DQogICAgICAgICAgbW9mRGVwSWQ6IHRoaXMudXNlclNlbGVjdC5pZCwNCiAgICAgICAgICBtYW5hZ2VNb2ZEZXBQcm9SZWxhdGlvbjogc3RhdGUuY2hlY2tlZE5vZGVzDQogICAgICAgICAgICAubWFwKGl0ZW0gPT4gew0KICAgICAgICAgICAgICByZXR1cm4geyBwcm9Db2RlOiBpdGVtLmNvZGUsIHByb05hbWU6IGl0ZW0ubmFtZSB9DQogICAgICAgICAgICB9KQ0KICAgICAgICB9DQogICAgICAgIEh0dHBNb2R1bGUudXBkYXRlKHBhcmFtKS50aGVuKHJlcyA9PiB7DQogICAgICAgICAgaWYgKHJlcy5jb2RlID09PSAnMDAwMDAwJykgew0KICAgICAgICAgICAgdGhpcy4kbWVzc2FnZS5zdWNjZXNzKGlzQ2hlY2tlZCA/ICfmjojmnYPmiJDlip8nIDogJ+WPlua2iOaOiOadg+aIkOWKnycpDQogICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIHRoaXMudHJlZU5vZGVDbGljayh0aGlzLnVzZXJTZWxlY3QpDQogICAgICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKHJlcy5yZXN1bHQpDQogICAgICAgICAgfQ0KICAgICAgICB9KQ0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgdGhpcy4kbWVzc2FnZS53YXJuaW5nKCfor7fpgInmi6nlpITlrqTvvIEnKQ0KICAgICAgfQ0KICAgIH0sDQogICAgLy8g6I635Y+W5aSE5a6k5qCRDQogICAgZ2V0RGVwKCkgew0KICAgICAgY29uc3QgcGFyYW0gPSB7DQogICAgICAgIGRhdGE6IHRoaXMuJHN0b3JlLnN0YXRlLnVzZXJJbmZvLnllYXINCiAgICAgIH0NCiAgICAgIEh0dHBNb2R1bGUuZ2V0VHJlZUFnZW5jeShwYXJhbSkudGhlbihyZXMgPT4gew0KICAgICAgICBsZXQgcmVzdWx0ID0gcmVzDQogICAgICAgIGlmIChyZXN1bHQuZGF0YS5sZW5ndGgpIHsNCiAgICAgICAgICB0aGlzLnVzZXJUcmVlRGF0YSA9IHRoaXMudHJlZUZvcm1hdChyZXN1bHQuZGF0YSkNCiAgICAgICAgICB0aGlzLm9uVXNlclRyZWVMb2FkRmluaXNoKHRoaXMuZGF0YSkNCiAgICAgICAgfQ0KICAgICAgfSkNCiAgICB9LA0KICAgIC8vIOagvOW8j+WMluagkeW9oue7k+aehA0KICAgIHRyZWVGb3JtYXQodHJlZUFycmF5KSB7DQogICAgICB0cmVlQXJyYXkuZm9yRWFjaChpdGVtID0+IHsNCiAgICAgICAgdGhpcy4kc2V0KGl0ZW0sICdjaGlsZHJlbicsIFtdKQ0KICAgICAgICB0aGlzLiRzZXQoaXRlbSwgJ2lkJywgaXRlbS5ndWlkKQ0KICAgICAgICB0aGlzLiRzZXQoaXRlbSwgJ2xhYmVsJywgaXRlbS5jb2RlICsgJy0nICsgaXRlbS5uYW1lKQ0KICAgICAgfSkNCiAgICAgIHJldHVybiB0cmVlQXJyYXkNCiAgICB9LA0KICAgIGFjY29yZGlvbjogeyAvLyDmmK/lkKbmr4/mrKHlj6rmiZPlvIDkuIDkuKrlkIznuqfmoJHoioLngrnlsZXlvIANCiAgICAgIHR5cGU6IHRydWUNCiAgICB9DQogIH0sDQogIG1vdW50ZWQoKSB7DQogICAgdGhpcy5pbml0KCkNCiAgfSwNCiAgY3JlYXRlZCgpIHsNCiAgICB0aGlzLmdldERlcCgpDQogIH0NCn0NCg=="},{"version":3,"sources":["manageMofAgencyProRelation.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"manageMofAgencyProRelation.vue","sourceRoot":"src/views/main/fundMonitoring/manageMofAgencyProRelation","sourcesContent":["<!--用户印章授权 gyl-->\r\n<template>\r\n  <div style=\"height:100%\">\r\n    <!-- <TreeScollLoad /> -->\r\n    <BsMainFormListLayout>\r\n      <template v-slot:topTap> topTap </template>\r\n      <template v-slot:topTabPane></template>\r\n      <template v-slot:query></template>\r\n      <template v-slot:mainTree>\r\n      </template>\r\n      <template v-slot:mainForm>\r\n        <div style=\"height:100%\">\r\n          <div class=\"tree\">\r\n            <div class=\"title\">\r\n              <span style=\"font-size: 14px;font-weight: bold;margin-top: 7px;\">处室列表</span>\r\n            </div>\r\n            <!--            <TreeScollLoad />-->\r\n            <BsBossTree\r\n              ref=\"userTree\"\r\n              v-loading=\"showLoadingLeft\"\r\n              :visible=\"true\"\r\n              :datas=\"userTreeData\"\r\n              empty-text=\"暂无数据\"\r\n              :is-need-root=\"false\"\r\n              :is-show-input=\"true\"\r\n              :clickmethod=\"treeNodeClick\"\r\n              :open-loading=\"true\"\r\n              :defaultexpandedkeys=\"['0']\"\r\n            />\r\n          </div>\r\n          <div class=\"tree\">\r\n            <div class=\"title\">\r\n              <span style=\"font-size: 14px;font-weight: bold;margin-top: 7px;\">资金列表</span>\r\n            </div>\r\n            <BsBossTree\r\n              ref=\"stampTree\"\r\n              v-loading=\"showLoadingRight\"\r\n              :visible=\"true\"\r\n              :datas=\"stampTreeData\"\r\n              empty-text=\"暂无数据\"\r\n              :is-need-root=\"false\"\r\n              :is-checkbox=\"true\"\r\n              :defaultexpandedkeys=\"['0']\"\r\n              :is-show-input=\"true\"\r\n              :open-loading=\"true\"\r\n              :accordion=\"accordion\"\r\n              treeid=\"code\"\r\n              :nodecheckmethod=\"nodecheckmethod\"\r\n            />\r\n          </div>\r\n        </div>\r\n      </template>\r\n    </BsMainFormListLayout>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport HttpModule from '@/api/frame/main/fundMonitoring/ManageMofDepProRelation.js'\r\nexport default {\r\n  name: 'UserProRelation',\r\n  data() {\r\n    return {\r\n      showLoadingLeft: false,\r\n      showLoadingRight: false,\r\n      userTreeData: [],\r\n      stampTreeData: [],\r\n      proArray: [],\r\n      userSelect: {}\r\n    }\r\n  },\r\n  methods: {\r\n    aaa(obj, checksObj) {\r\n      console.log(obj, checksObj)\r\n    },\r\n    init() {\r\n    },\r\n    onUserTreeLoadFinish(data) {\r\n      // this.userTreeData = data\r\n      HttpModule.queryTableDatas().then(res => {\r\n        this.stampTreeData = res.data\r\n        // this.$nextTick(() => {\r\n        //   // 重新赋值\r\n        //   this.userTreeData = []\r\n        //   this.userTreeData = this.stampTreeData\r\n        // })\r\n        this.showLoadingRight = false\r\n      }).catch(() => {\r\n        this.showLoadingRight = false\r\n      })\r\n    },\r\n    treeNodeClick(obj) {\r\n      this.userSelect = obj\r\n      const param = {\r\n        mofDepId: obj.id\r\n      }\r\n      HttpModule.queryByMofDepId(param).then(res => {\r\n        let array = []\r\n        if (res.code === '000000') {\r\n          res.data.forEach(item => {\r\n            array.push(item.code)\r\n          })\r\n          this.proArray = array\r\n          // console.log('array', array)\r\n          // console.log('array', this.$refs.stampTree)\r\n          this.$refs.stampTree.setCheckedKeys(array)\r\n          // if (array.length > 0) {\r\n          //   this.$nextTick(() => {\r\n          //     this.$refs.stampTree.treeOptionFn().setCheckedKeys(array)\r\n          //   })\r\n          // }\r\n          console.log('array1', this.$refs.stampTree)\r\n        } else {\r\n          this.$message.error(res.message)\r\n        }\r\n      })\r\n    },\r\n    nodecheckmethod(obj, state) {\r\n      // if (obj.regulationCode === '0' || obj.regulationCode === '01' || obj.regulationCode === '02') {\r\n      //   this.$message.warning('根节点不能被选中！')\r\n      //   this.$refs.stampTree.setCheckedKeys(this.proArray)\r\n      //   return\r\n      // }\r\n      if (this.userSelect.id) {\r\n        let isChecked = state.checkedKeys.includes(obj.code)\r\n        var param = {\r\n          mofDepId: this.userSelect.id,\r\n          manageMofDepProRelation: state.checkedNodes\r\n            .map(item => {\r\n              return { proCode: item.code, proName: item.name }\r\n            })\r\n        }\r\n        HttpModule.update(param).then(res => {\r\n          if (res.code === '000000') {\r\n            this.$message.success(isChecked ? '授权成功' : '取消授权成功')\r\n          } else {\r\n            this.treeNodeClick(this.userSelect)\r\n            this.$message.error(res.result)\r\n          }\r\n        })\r\n      } else {\r\n        this.$message.warning('请选择处室！')\r\n      }\r\n    },\r\n    // 获取处室树\r\n    getDep() {\r\n      const param = {\r\n        data: this.$store.state.userInfo.year\r\n      }\r\n      HttpModule.getTreeAgency(param).then(res => {\r\n        let result = res\r\n        if (result.data.length) {\r\n          this.userTreeData = this.treeFormat(result.data)\r\n          this.onUserTreeLoadFinish(this.data)\r\n        }\r\n      })\r\n    },\r\n    // 格式化树形结构\r\n    treeFormat(treeArray) {\r\n      treeArray.forEach(item => {\r\n        this.$set(item, 'children', [])\r\n        this.$set(item, 'id', item.guid)\r\n        this.$set(item, 'label', item.code + '-' + item.name)\r\n      })\r\n      return treeArray\r\n    },\r\n    accordion: { // 是否每次只打开一个同级树节点展开\r\n      type: true\r\n    }\r\n  },\r\n  mounted() {\r\n    this.init()\r\n  },\r\n  created() {\r\n    this.getDep()\r\n  }\r\n}\r\n</script>\r\n<style scoped>\r\n.tree{\r\n  float:left;\r\n  height:100%;\r\n  width:50%\r\n}\r\n</style>\r\n"]}]}