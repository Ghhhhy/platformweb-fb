{"remainingRequest":"C:\\Users\\何小龙\\Desktop\\platformweb-fb\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\何小龙\\Desktop\\platformweb-fb\\src\\views\\main\\fundMonitoring\\capitalAccount\\specialSupervisionRegion\\specialSupervisionRegion.vue?vue&type=style&index=0&id=cbd697aa&scoped=true&lang=css&","dependencies":[{"path":"C:\\Users\\何小龙\\Desktop\\platformweb-fb\\src\\views\\main\\fundMonitoring\\capitalAccount\\specialSupervisionRegion\\specialSupervisionRegion.vue","mtime":1695716045540},{"path":"C:\\Users\\何小龙\\Desktop\\platformweb-fb\\node_modules\\css-loader\\dist\\cjs.js","mtime":1696752946978},{"path":"C:\\Users\\何小龙\\Desktop\\platformweb-fb\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"C:\\Users\\何小龙\\Desktop\\platformweb-fb\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"C:\\Users\\何小龙\\Desktop\\platformweb-fb\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\何小龙\\Desktop\\platformweb-fb\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKDQoucmFkaW8tcmlnaHQgew0KICBmbG9hdDogcmlnaHQ7DQp9DQouVGl0YW5zLXRhYmxlIDo6di1kZWVwIC52eGUtYm9keS0tcm93LnJvdy15ZWxsb3cgew0KICBiYWNrZ3JvdW5kLWNvbG9yOiB5ZWxsb3c7DQogIGNvbG9yOiAjZmZmOw0KfQ0KLlRpdGFucy10YWJsZSA6OnYtZGVlcCAudnhlLWJvZHktLXJvdy5yb3ctYmx1ZSB7DQogIGJhY2tncm91bmQtY29sb3I6IGJsdWU7DQogIGNvbG9yOiAjZmZmOw0KfQ0KLlRpdGFucy10YWJsZSA6OnYtZGVlcCAudnhlLWJvZHktLXJvdy5yb3ctcmVkIHsNCiAgYmFja2dyb3VuZC1jb2xvcjogcmVkOw0KICBjb2xvcjogI2ZmZjsNCn0NCg=="},{"version":3,"sources":["specialSupervisionRegion.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+vCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"specialSupervisionRegion.vue","sourceRoot":"src/views/main/fundMonitoring/capitalAccount/specialSupervisionRegion","sourcesContent":["<!-- 直达资金预算下达_分地区 -->\r\n<template>\r\n  <div v-loading=\"tableLoading\" style=\"height: 100%\">\r\n    <BsMainFormListLayout :left-visible.sync=\"leftTreeVisible\">\r\n      <template v-slot:topTap></template>\r\n      <!-- <template v-slot:topTabPane>\r\n        <BsTabPanel\r\n          ref='tabPanel'\r\n          :is-open='isShowQueryConditions'\r\n          :tab-status-btn-config='toolBarStatusBtnConfig'\r\n          :tab-status-num-config='tabStatusNumConfig'\r\n          @onQueryConditionsClick='onQueryConditionsClick'\r\n        />\r\n      </template> -->\r\n      <template v-slot:query>\r\n        <div v-show=\"isShowQueryConditions\" class=\"main-query\">\r\n          <BsQuery\r\n            ref=\"queryFrom\"\r\n            :query-form-item-config=\"queryConfig\"\r\n            :query-form-data=\"searchDataList\"\r\n            @itemChange=\"itemChange\"\r\n            @onSearchClick=\"(e1,e2) => search(e1,e2,false)\"\r\n          />\r\n        </div>\r\n      </template>\r\n      <template v-slot:mainForm>\r\n        <BsTable\r\n          v-if=\"isSx\"\r\n          id=\"1001\"\r\n          ref=\"bsTableRef\"\r\n          row-id=\"id\"\r\n          :table-config=\"tableConfig\"\r\n          :table-columns-config=\"tableColumnsConfig\"\r\n          :table-data=\"tableData\"\r\n          :calculate-constraint-config=\"calculateConstraintConfig\"\r\n          :tree-config=\"{ dblExpandAll: true, dblExpand: true, accordion: false, iconClose: 'el-icon-circle-plus', iconOpen: 'el-icon-remove' }\"\r\n          :toolbar-config=\"tableToolbarConfig\"\r\n          :pager-config=\"pagerConfig\"\r\n          :export-modal-config=\"{ fileName: menuName }\"\r\n          :default-money-unit=\"10000\"\r\n          :cell-style=\"cellStyle\"\r\n          :show-zero=\"false\"\r\n          @editClosed=\"onEditClosed\"\r\n          @cellDblclick=\"cellDblclick\"\r\n          @onToolbarBtnClick=\"onToolbarBtnClick\"\r\n          @cellClick=\"cellClick\"\r\n        >\r\n          <!--口径说明插槽-->\r\n          <template v-if=\"caliberDeclareContent\" v-slot:caliberDeclare>\r\n            <p v-html=\"caliberDeclareContent\"></p>\r\n          </template>\r\n          <template v-slot:toolbarSlots>\r\n            <div class=\"table-toolbar-left\">\r\n              <div class=\"table-toolbar-left-title\">\r\n                <span class=\"fn-inline\">{{ menuName }}</span>\r\n                <i class=\"fn-inline\"></i>\r\n              </div>\r\n            </div>\r\n          </template>\r\n          <template v-slot:toolbar-custom-slot>\r\n            <vxe-button\r\n              v-if=\"transJson($store.state.curNavModule.param5).incrementUpdateBtnVisible !== false\"\r\n              :loading=\"dataSourceAddLoading\"\r\n              style=\"margin-right: 8px;\"\r\n              @click=\"incrementHandle\"\r\n            >\r\n              数据增量同步\r\n            </vxe-button>\r\n            <vxe-button\r\n              v-if=\"transJson($store.state.curNavModule.param5).otherSysImportBtnVisible !== false\"\r\n              style=\"margin-right: 8px;\"\r\n              @click=\"otherSysImportModal = true\"\r\n            >\r\n              华青数据导入\r\n            </vxe-button>\r\n          </template>\r\n          <template v-slot:toolbar-custom-slot>\r\n            <div class=\"dfr-report-time-wrapper\">\r\n              <el-tooltip effect=\"light\" :content=\"`报表最近取数时间：${reportTime}`\" placement=\"top\">\r\n                <div class=\"dfr-report-time-content\">\r\n                  <i class=\"ri-history-fill\"></i>\r\n                  <span class=\"dfr-report-time\">{{ reportTime }}</span>\r\n                </div>\r\n              </el-tooltip>\r\n            </div>\r\n          </template>\r\n        </BsTable>\r\n        <BsTable\r\n          v-else\r\n          id=\"1001\"\r\n          ref=\"bsTableRef\"\r\n          row-id=\"id\"\r\n          :table-config=\"tableConfig\"\r\n          :table-columns-config=\"tableColumnsConfig\"\r\n          :table-global-config=\"tableGlobalConfigCop\"\r\n          :table-data=\"tableData\"\r\n          :scroll-y=\"scrollConfig\"\r\n          :virtual-scroll=\"true\"\r\n          :calculate-constraint-config=\"calculateConstraintConfig\"\r\n          :tree-config=\"{ dblExpandAll: true, dblExpand: true, accordion: false, iconClose: 'el-icon-circle-plus', iconOpen: 'el-icon-remove' }\"\r\n          :toolbar-config=\"tableToolbarConfig\"\r\n          :pager-config=\"pagerConfig\"\r\n          :export-modal-config=\"{ fileName: menuName, addReportTitleColumn: true, addUnitColumn: true }\"\r\n          :default-money-unit=\"10000\"\r\n          :cell-style=\"cellStyle\"\r\n          :title=\"menuName\"\r\n          :show-zero=\"showZero\"\r\n          @editClosed=\"onEditClosed\"\r\n          @cellDblclick=\"cellDblclick\"\r\n          @onToolbarBtnClick=\"onToolbarBtnClick\"\r\n          @cellClick=\"cellClick\"\r\n          @switchMoneyUnit=\"switchMoneyUnit\"\r\n        >\r\n          <!--口径说明插槽-->\r\n          <template v-if=\"caliberDeclareContent\" v-slot:caliberDeclare>\r\n            <p v-html=\"caliberDeclareContent\"></p>\r\n          </template>\r\n          <template v-slot:toolbarSlots>\r\n            <div class=\"table-toolbar-left\">\r\n              <div class=\"table-toolbar-left-title\">\r\n                <span class=\"fn-inline\">{{ menuName }}</span>\r\n                <i class=\"fn-inline\"></i>\r\n              </div>\r\n            </div>\r\n          </template>\r\n          <template v-slot:toolbar-custom-slot>\r\n            <vxe-button\r\n              v-if=\"transJson($store.state.curNavModule.param5).incrementUpdateBtnVisible !== false\"\r\n              :loading=\"dataSourceAddLoading\"\r\n              style=\"margin-right: 8px;\"\r\n              @click=\"incrementHandle\"\r\n            >\r\n              数据增量同步\r\n            </vxe-button>\r\n            <vxe-button\r\n              v-if=\"transJson($store.state.curNavModule.param5).otherSysImportBtnVisible !== false\"\r\n              style=\"margin-right: 8px;\"\r\n              @click=\"otherSysImportModal = true\"\r\n            >\r\n              华青数据导入\r\n            </vxe-button>\r\n          </template>\r\n          <template v-slot:toolbar-custom-slot>\r\n            <div class=\"dfr-report-time-wrapper\">\r\n              <el-tooltip effect=\"light\" :content=\"`报表最近取数时间：${reportTime}`\" placement=\"top\">\r\n                <div class=\"dfr-report-time-content\">\r\n                  <i class=\"ri-history-fill\"></i>\r\n                  <span class=\"dfr-report-time\">{{ reportTime }}</span>\r\n                </div>\r\n              </el-tooltip>\r\n            </div>\r\n          </template>\r\n        </BsTable>\r\n      </template>\r\n    </BsMainFormListLayout>\r\n    <BsOperationLog :logs-data=\"logData\" :show-log-view=\"showLogView\" />\r\n    <DetailDialog\r\n      v-if=\"detailVisible\"\r\n      :title=\"detailTitle\"\r\n      :detail-type=\"detailType\"\r\n      :drilling-param=\"drillingParam\"\r\n      :detail-data=\"detailData\"\r\n      :detail-query-param=\"detailQueryParam\"\r\n    />\r\n    <SDetailDialog\r\n      v-if=\"sDetailVisible\"\r\n      :title=\"sDetailTitle\"\r\n      :s-detail-data=\"sDetailData\"\r\n      :drilling-param=\"drillingParam\"\r\n      :s-detail-query-param=\"sDetailQueryParam\"\r\n      :s-detail-type=\"sDetailType\"\r\n    />\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport getFormData from './specialSupervisionRegion.js'\r\nimport DetailDialog from '../children/zxdetailDialog.vue'\r\nimport SDetailDialog from '../children/sDetailDialog.vue'\r\nimport HttpModule from '@/api/frame/main/fundMonitoring/specialSupervisionRegion.js'\r\nimport regionMixin from '../mixins/regionMixin'\r\nimport XEUtils from 'xe-utils/ctor'\r\nconst dictionary = {\r\n  '中央下达': 'amountZyxd',\r\n  '支出-金额': 'amountPayAll',\r\n  '省级分配本级': 'amountSnjbjfp',\r\n  '省级分配下级': 'amountSnjxjfp',\r\n  '市级分配本级': 'amountSbjfp',\r\n  '市级分配下级': 'amountSxjfp',\r\n  '县级已分配': 'amountXjfp'\r\n}\r\nexport default {\r\n  mixins: [regionMixin],\r\n  components: {\r\n    DetailDialog,\r\n    SDetailDialog\r\n  },\r\n  computed: {\r\n    menuSettingConfig() { // 路由菜单配置信息\r\n      return this.transJson2(this.$store.state.curNavModule.param5 || '')\r\n    },\r\n    isSx() {\r\n      return this.$store.getters.isSx\r\n    },\r\n    tableGlobalConfigCop() {\r\n      let dataType = this.transJson(this.$store.state.curNavModule.param5 || '').exportModalDefaultSelect || 'fullData'\r\n      return {\r\n        customExportConfig: {\r\n          ...this.tableGlobalConfig.customExportConfig,\r\n          dataType,\r\n          fileName: this.menuName\r\n        }\r\n      }\r\n    }\r\n  },\r\n  watch: {\r\n    $refs: {\r\n      handler(newval) {\r\n      },\r\n      deep: true,\r\n      immediate: true\r\n    },\r\n    queryConfig() {\r\n      this.getSearchDataList()\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      projectCode: '',\r\n      drillingParam: {},\r\n      caliberDeclareContent: '', // 口径说明\r\n      reportTime: '', // 拉取支付报表的最新时间\r\n      leftTreeVisible: false,\r\n      sDetailVisible: false,\r\n      sDetailTitle: '',\r\n      sDetailData: [],\r\n      isShowQueryConditions: true,\r\n      radioShow: true,\r\n      breakRuleVisible: false,\r\n      // // 头部工具栏 BsTabPanel config\r\n      // toolBarStatusBtnConfig: {\r\n      //   changeBtns: true,\r\n      //   // buttons: getFormData('toolBarStatusButtons'),\r\n      //   curButton: {\r\n      //     type: 'button',\r\n      //     iconName: 'base-all.png',\r\n      //     iconNameActive: 'base-all-active.png',\r\n      //     iconUrl: '',\r\n      //     label: '全部',\r\n      //     code: '1',\r\n      //     curValue: '1'\r\n      //   },\r\n      //   buttonsInfo: getFormData('statusRightToolBarButton'),\r\n      //   methods: {\r\n      //     bsToolbarClickEvent: this.onStatusTabClick\r\n      //   }\r\n      // },\r\n      buttonsInfo: getFormData('statusRightToolBarButtonByBusDept'),\r\n      tabStatusNumConfig: {\r\n        1: 0\r\n      },\r\n      scrollConfig: {\r\n        gt: 0,\r\n        enabled: true\r\n      },\r\n      // table 相关配置\r\n      tableGlobalConfig: {\r\n        customExportConfig: {\r\n          addUnitColumn: true,\r\n          addReportTitleColumn: true,\r\n          unit: '万元'\r\n        }\r\n      },\r\n      showZero: this.transJson3(this.$store.state.curNavModule.param5).projectCode === 'SH',\r\n      tableLoading: false,\r\n      tableConfig: getFormData('basicInfo', 'tableConfig'),\r\n      tableColumnsConfig: !this.isSx ? getFormData('basicInfo', `tableColumnsConfig${this.transJson(this.$store?.state?.curNavModule?.param5)?.isCity ? 'City' : ''}`) : [],\r\n      tableData: [],\r\n      obj: {},\r\n      calculateConstraintConfig: {\r\n        enabled: true,\r\n        extendMapInfoField: true, // 是否扩展mapInfo字段\r\n        // gradedSummaryFields: ['bonus', 'income'],\r\n        calcAndConstraintItemCodeField: 'itemCode',\r\n        // 示例中1001为tableId\r\n        // rowCodeFormulaConfig: {\r\n        //   // 单元格交叉计算\r\n        //   // rowFormulaMap= { 'colField:itemcode':'{tableId:colField:itemcode}[运算符]' }\r\n        //   '00:jOut': '{00:amountSbpayApp}+{00:amountSpayApp}+{00:amountXpayApp}'\r\n        //   // '10:bonus': '{1001:income:10}+{1001:bonus:10}',\r\n        //   // '20:bonus': '{1001:income:30}*{1001:age:30}+{1001:bonus:40}'\r\n        // },\r\n        // cellDataConfig: [// 提取和计算\r\n        //\r\n        // ],\r\n        // colFormulaConfig: {\r\n        //   jOut: '{amountSbpayApp}+{amountSpayApp}+{amountXpayApp}',\r\n        //   jLoad: '{jOut}/{jAmount}*100',\r\n        //   sUnassigned: '{jAmount}-{sbbjfpAmount}-{sbxjfpAmount}',\r\n        //   sLoad: '({sbbjfpAmount}+{sbxjfpAmount})/{jAmount}*100',\r\n        //   aUnassigned: '{jAmount}-{sbbjfpAmount}-{sbjfpAmount}-{sxjfpAmount}',\r\n        //   aLoad: '({sbjfpAmount}+{sxjfpAmount})*100',\r\n        //   xUnassigned: '{jAmount}-{sbbjfpAmount}-{sbjfpAmount}-{xbjfpAmount}',\r\n        //   xLoad: '{xbjfpAmount}/{jAmount}*100'\r\n        // },\r\n        getDataAxiosConfig: { // 跨表提取请求配置\r\n          dataField: 'data', // 数据字段\r\n          successCode: '100000', // 成功code\r\n          statusField: 'rscode',\r\n          method: 'get', // 请求方式\r\n          url: '' // 'queryTreeAssistData', //\r\n          //  [{ itemCode: '002', colField: 'f005', value: '1500.0' }, { itemCode: '002001', colField: 'f005', value: '500.0' }]\r\n        },\r\n        getDataParams: { // 提取公共参数\r\n\r\n        },\r\n        colConstraintConfig: {\r\n          // 'age': 'income::value::{age}>=18?Math.pow({age},4)/2:0--&&--name::style::{age}>18&&{age}<=60--??--color=#F00&fontSize=20px--+--{age}>60--??--color=#ff0&fontSize=20px'\r\n        },\r\n        rowCodeConstraintConfig: { // 表间约束配置\r\n          // '20:age': '10:income::value::{1001:age:20}>=18?Math.pow({1001:age:20},4)/2:0--&&--10:bonus::editable::{1001:age:20}>=18?true:false--&&--30:bonus::clear::{1001:age:20}<=18?true:false--&&--10:name::style::{1001:age:20}>18&&{1001:age:20}<=60--??--color=#F00&fontSize=20px--+--{1001:age:1001}>60--??--color=#ff0&fontSize=20px'\r\n        }\r\n      },\r\n      toolbarConfig: {\r\n        disabledMoneyConversion: false,\r\n        ...getFormData('basicInfo', 'toolbarConfig')\r\n      },\r\n      // editRules: getFormData('basicInfo', 'editRules'),\r\n      ifRenderExpandContentTable: true,\r\n      pagerConfig: {\r\n        autoHidden: true,\r\n        total: 1,\r\n        currentPage: 1,\r\n        pageSize: 999999\r\n      },\r\n      tableToolbarConfig: {\r\n        // table工具栏配置\r\n        disabledMoneyConversion: false,\r\n        moneyConversion: true, // 是否有金额转换\r\n        search: false, // 是否有search\r\n        import: false, // 导入\r\n        export: true, // 导出\r\n        print: false, // 打印\r\n        expandAll: true, // 展开所有\r\n        caliberDeclare: true, //\r\n        zoom: true, // 缩放\r\n        custom: true, // 选配展示列\r\n        slots: {\r\n          tools: 'toolbarTools',\r\n          buttons: 'toolbarSlots'\r\n        }\r\n      },\r\n      // mainPagerConfig: {\r\n      //   total: 0,\r\n      //   currentPage: 1,\r\n      //   pageSize: 20\r\n      // },\r\n      tableFooterConfig: {\r\n        showFooter: false\r\n      },\r\n      expandConfig: {\r\n        showIcon: false,\r\n        lazy: true,\r\n        expandAll: true\r\n      },\r\n      // 操作日志\r\n      logData: [],\r\n      showLogView: false,\r\n      // 新增弹窗\r\n      dialogVisible: false,\r\n      dialogTitle: '新增',\r\n      addTableData: [],\r\n      modifyData: {},\r\n      // 请求 & 角色权限相关配置\r\n      menuName: '',\r\n      params5: '',\r\n      menuId: '',\r\n      tokenid: '',\r\n      userInfo: {},\r\n      roleguid: this.$store.state.curNavModule.roleguid,\r\n      appId: 'pay_voucher',\r\n      isHaveZero: '0',\r\n      billguid: '',\r\n      condition: {},\r\n      selectData: '',\r\n      queryConfig: getFormData('highQueryConfig'),\r\n      searchDataList: getFormData('highQueryData'),\r\n      detailVisible: false,\r\n      detailType: '',\r\n      sDetailType: '',\r\n      detailTitle: '',\r\n      detailData: [],\r\n      detailQueryParam: {},\r\n      sDetailQueryParam: {}\r\n    }\r\n  },\r\n  mounted() {\r\n    this.getNewData()\r\n  },\r\n  methods: {\r\n    // 载入表头\r\n    async loadConfig(Type, id) {\r\n      let params = {\r\n        tableId: {\r\n          id: id,\r\n          fiscalyear: this.$store.state.userInfo.year,\r\n          mof_div_code: this.$store.state.userInfo.province,\r\n          menuguid: this.$store.state.curNavModule.guid\r\n        }\r\n      }\r\n      if (Type === 'BsTable') {\r\n        let configData = await this.loadBsConfig(params)\r\n        this.tableColumnsConfig = configData.itemsConfig\r\n      }\r\n      if (Type === 'BsQuery') {\r\n        let configData = await this.loadBsConfig(params)\r\n        this.queryConfig = configData.itemsConfig || getFormData('highQueryConfig')\r\n        this.getPro()\r\n      }\r\n    },\r\n    switchMoneyUnit(level) {\r\n      this.tableGlobalConfig.customExportConfig.unit = level === 1 ? '元' : '万元'\r\n    },\r\n    // 展开折叠查询框\r\n    onQueryConditionsClick(isOpen) {\r\n      this.isShowQueryConditions = isOpen\r\n    },\r\n    // 初始化高级查询data\r\n    getSearchDataList() {\r\n      // 下拉树\r\n      let searchDataObj = {}\r\n      this.queryConfig.forEach((item) => {\r\n        if (\r\n          item.itemRender.name === '$formTreeInput' ||\r\n          item.itemRender.name === '$vxeTree'\r\n        ) {\r\n          if (item.field) {\r\n            searchDataObj[item.field + 'code'] = ''\r\n          }\r\n        } else {\r\n          if (item.field) {\r\n            searchDataObj[item.field] = ''\r\n          }\r\n        }\r\n      })\r\n      this.searchDataList = searchDataObj\r\n    },\r\n    // 初始化高级查询参数condition\r\n    getConditionList() {\r\n      let condition = {}\r\n      this.queryConfig.forEach((item) => {\r\n        if (\r\n          item.itemRender.name === '$formTreeInput' ||\r\n          item.itemRender.name === '$vxeTree'\r\n        ) {\r\n          if (item.field) {\r\n            if (item.field === 'cor_bgt_doc_no_') {\r\n              condition[item.field + 'name'] = []\r\n            } else {\r\n              condition[item.field + 'code'] = []\r\n            }\r\n          }\r\n        } else {\r\n          if (item.field) {\r\n            condition[item.field] = []\r\n          }\r\n        }\r\n      })\r\n      return condition\r\n    },\r\n    // 切换状态栏\r\n    onStatusTabClick(obj) {\r\n      if (!obj.type) {\r\n        this.operationToolbarButtonClickEvent(obj)\r\n        return\r\n      }\r\n      this.toolBarStatusSelect = obj\r\n      switch (obj.curValue) {\r\n        // 全部\r\n        case '1':\r\n          this.menuName = '直达资金预算下达_分地区(单位:万元)'\r\n          this.radioShow = true\r\n          break\r\n      }\r\n      this.condition = {}\r\n      this.mainPagerConfig.currentPage = 1\r\n      this.queryTableDatas()\r\n      this.queryTableDatasCount()\r\n      this.$refs.mainTableRef.$refs.xGrid.clearScroll()\r\n    },\r\n    // 搜索\r\n    search(val, multipleValue = {}, isFlush = false) {\r\n      this.searchDataList = val\r\n      let condition = this.getConditionList()\r\n      for (let key in condition) {\r\n        if (\r\n          (this.searchDataList[key] !== undefined) &\r\n          (this.searchDataList[key] !== null)\r\n        ) {\r\n          if (Array.isArray(this.searchDataList[key])) {\r\n            condition[key] = this.searchDataList[key]\r\n          } else if (typeof this.searchDataList[key] === 'string') {\r\n            if (this.searchDataList[key].trim() !== '') {\r\n              this.searchDataList[key].split(',').forEach((item) => {\r\n                condition[key].push(item)\r\n              })\r\n            }\r\n          }\r\n        }\r\n      }\r\n      this.condition = condition\r\n      this.queryTableDatas(isFlush)\r\n    },\r\n    // 切换操作按钮\r\n    // operationToolbarButtonClickEvent(obj, context, e) {\r\n    //   switch (obj.code) {\r\n    //     // 导出\r\n    //     case 'export':\r\n    //       this.exportPolicies(obj, context, e)\r\n    //       break\r\n    //     default:\r\n    //       break\r\n    //   }\r\n    // },\r\n    onToolbarBtnClick({ context, table, code }) {\r\n      switch (code) {\r\n        // 刷新\r\n        case 'refresh':\r\n          this.$confirm('重新加载数据可能需要等待较长时间，确认继续？', '操作确认提示', {\r\n            type: 'warning'\r\n          }).then(() => {\r\n            this.refresh(true)\r\n          })\r\n          break\r\n      }\r\n    },\r\n    changeVisible(val) {\r\n      this.breakRuleVisible = val\r\n    },\r\n    onClickmethod(node) {\r\n      if (node.id !== '0') {\r\n        let key =\r\n          this.$refs.treeSet.treeConfigIn.curRadio.toLowerCase() + '_code'\r\n        this.condition[key] = node.id\r\n      } else {\r\n        this.condition = {}\r\n      }\r\n\r\n      this.queryTableDatas(node.guid)\r\n    },\r\n    handleDetail(reportCode, mofDivCode, column, row) {\r\n      if (this.isSx) {\r\n        let condition = ''\r\n        if (this.transJson(this.$store?.state?.curNavModule?.param5)?.isCity) {\r\n          switch (column) {\r\n            case 'amountSnjwfp':\r\n            case 'amountSnjxd':\r\n            case 'amountSnjpay':\r\n            case 'amountSnjbjfp':\r\n            case 'amountSnjxjfp':\r\n              condition = 'substr(mof_div_code,3,7) = \\'0000000\\'  '\r\n              break\r\n            case 'amountSjxd':\r\n            case 'amountSjpay':\r\n            case 'amountSjwfp':\r\n            case 'amountSbjfp':\r\n            case 'amountSxjfp':\r\n              condition = ' substr(mof_div_code,5,5) <> \\'00000\\' and substr(mof_div_code,7,3)=\\'000\\' '\r\n              break\r\n            case 'amountXjxd':\r\n            case 'amountXjpay':\r\n            case 'amountXjwfp':\r\n            case 'amountXjfp':\r\n              condition = ' substr(mof_div_code,7,3) <> \\'000\\' '\r\n              break\r\n          }\r\n        } else {\r\n          switch (column) {\r\n            case 'amountSnjwfp':\r\n            case 'amountSnjxd':\r\n            case 'amountSnjpay':\r\n            case 'amountSnjbjfp':\r\n            case 'amountSnjxjfp':\r\n              condition = 'substr(mof_div_code,3,7) = \\'0000000\\'  '\r\n              break\r\n            case 'amountSjxd':\r\n            case 'amountSjpay':\r\n            case 'amountSjwfp':\r\n            case 'amountSbjfp':\r\n            case 'amountSxjfp':\r\n              condition = ' substr(mof_div_code,3,7) <> \\'0000000\\' and substr(mof_div_code,5,5)=\\'00000\\' '\r\n              break\r\n            case 'amountXjxd':\r\n            case 'amountXjpay':\r\n            case 'amountXjwfp':\r\n            case 'amountXjfp':\r\n              condition = ' substr(mof_div_code,5,5) <> \\'00000\\' and substr(mof_div_code,7,3)=\\'000\\' '\r\n              break\r\n          }\r\n        }\r\n        let isBj = ''\r\n        switch (column) {\r\n          case 'amountSnjbjfp':\r\n          case 'amountSbjfp':\r\n            isBj = '1'\r\n            break\r\n          case 'amountSnjxjfp':\r\n          case 'amountSxjfp':\r\n            isBj = '2'\r\n            break\r\n          case 'amountXjfp':\r\n            isBj = '3'\r\n            break\r\n        }\r\n        let isCz = ''\r\n        if (this.transJson(this.params5 || '')?.reportCode !== '' && this.transJson(this.params5 || '')?.reportCode.includes('cz')) {\r\n          isCz = '2'\r\n        } else {\r\n          isCz = '1'\r\n        }\r\n        let params = {\r\n          reportCode: reportCode,\r\n          mofDivCode: mofDivCode,\r\n          speTypeCode: '',\r\n          isBj: isBj,\r\n          isCz: isCz,\r\n          fiscalYear: this.searchDataList.fiscalYear,\r\n          condition: condition,\r\n          endTime: this.condition.endTime ? this.condition.endTime[0] : '',\r\n          proCodes: this.searchDataList.proCodes === '' ? [] : this.getTrees(this.searchDataList.proCodes)\r\n        }\r\n        this.detailQueryParam = params\r\n        this.detailType = reportCode\r\n        this.detailVisible = true\r\n      // this.tableLoading = true\r\n      // HttpModule.queryTableDatas(params).then((res) => {\r\n      //   this.tableLoading = false\r\n      //   if (res.code === '000000') {\r\n      //     this.detailData = res.data\r\n      //     this.detailType = type\r\n      //   } else {\r\n      //     this.$message.error(res.message)\r\n      //   }\r\n      // })\r\n      } else {\r\n        let that = this\r\n        // 拿到那些可以进行超链接的表格行\r\n        const hideColumnLinkStr = that.transJson3(this.$store.state.curNavModule.param5)\r\n        if (hideColumnLinkStr.projectCode === 'SH') {\r\n          if (row.children !== undefined) return\r\n        }\r\n        let rowCodeHide = hideColumnLinkStr.rowCodeHide ? hideColumnLinkStr.rowCodeHide.split('#') : []\r\n        let Arraya = hideColumnLinkStr.hideColumn_link ? hideColumnLinkStr.hideColumn_link.split('#') : []\r\n        if (Arraya.length > 0 && rowCodeHide.length === 0) { // 只配置了隐藏行\r\n          if (Arraya.includes(column)) {\r\n            return\r\n          }\r\n        } else if (Arraya.length === 0 && rowCodeHide.length > 0) { // 只配置了隐藏列\r\n          if (rowCodeHide.includes(row.code)) {\r\n            return\r\n          }\r\n        } else if (Arraya.length > 0 && rowCodeHide.length > 0) { // 都配置了隐藏行 都配置了隐藏列 那就只隐藏交叉单元格\r\n          if ((rowCodeHide.includes(row.code) && Arraya.includes(column))) {\r\n            return\r\n          }\r\n        }\r\n        let condition = ''\r\n        if (this.transJson(this.$store?.state?.curNavModule?.param5)?.isCity || this.transJson(this.params5 || '')?.projectCode === 'SH') {\r\n          switch (column) {\r\n            case 'amountSnjwfp':\r\n            case 'amountSnjxd':\r\n            case 'amountSnjpay':\r\n            case 'amountSnjbjfp':\r\n            case 'amountSnjxjfp':\r\n              condition = 'substr(mof_div_code,3,7) = \\'0000000\\'  '\r\n              break\r\n            case 'amountSjxd':\r\n            case 'amountSjpay':\r\n            case 'amountSjwfp':\r\n            case 'amountSbjfp':\r\n            case 'amountSxjfp':\r\n              condition = ' substr(mof_div_code,5,5) <> \\'00000\\' and substr(mof_div_code,7,3)=\\'000\\' '\r\n              break\r\n            case 'amountXjxd':\r\n            case 'amountXjpay':\r\n            case 'amountXjwfp':\r\n            case 'amountXjfp':\r\n              condition = ' substr(mof_div_code,7,3) <> \\'000\\' '\r\n              break\r\n          }\r\n        } else if (this.$store.state.userInfo.province?.slice(0, 4) === '3502') {\r\n          switch (column) {\r\n            case 'amountSnjwfp':\r\n            case 'amountSnjxd':\r\n            case 'amountSnjpay':\r\n            case 'amountSnjbjfp':\r\n            case 'amountSnjxjfp':\r\n              condition = ' substr(mof_div_code,5,5) = \\'00000\\' and mof_div_code not like \\'%35\\''\r\n              break\r\n            case 'amountSjxd':\r\n            case 'amountSjpay':\r\n            case 'amountSjwfp':\r\n            case 'amountSbjfp':\r\n            case 'amountSxjfp':\r\n              condition = ' substr(mof_div_code,5,5) = \\'00000\\' and mof_div_code  like \\'%35\\' '\r\n              break\r\n            case 'amountXjxd':\r\n            case 'amountXjpay':\r\n            case 'amountXjwfp':\r\n            case 'amountXjfp':\r\n              condition = ' substr(mof_div_code,5,5) <> \\'00000\\' and substr(mof_div_code,7,3)=\\'000\\' '\r\n              break\r\n          }\r\n        } else if (this.$store.state.userInfo.province?.slice(0, 2) === '22') {\r\n          switch (column) {\r\n            case 'amountSnjwfp':\r\n            case 'amountSnjxd':\r\n            case 'amountSnjpay':\r\n            case 'amountSnjbjfp':\r\n            case 'amountSnjxjfp':\r\n              condition = 'substr(mof_div_code,3,7) = \\'0000000\\'  '\r\n              break\r\n            case 'amountSjxd':\r\n            case 'amountSjpay':\r\n            case 'amountSjwfp':\r\n            case 'amountSbjfp':\r\n            case 'amountSxjfp':\r\n              condition = ' substr(mof_div_code,3,7) <> \\'0000000\\' and substr(mof_div_code,5,5)=\\'00000\\' '\r\n              break\r\n            case 'amountXjxd':\r\n            case 'amountXjpay':\r\n            case 'amountXjwfp':\r\n            case 'amountXjfp':\r\n              condition = ' substr(mof_div_code,5,5) <> \\'00000\\''\r\n              break\r\n          }\r\n        } else {\r\n          switch (column) {\r\n            case 'amountSnjwfp':\r\n            case 'amountSnjxd':\r\n            case 'amountSnjpay':\r\n            case 'amountSnjbjfp':\r\n            case 'amountSnjxjfp':\r\n              condition = 'substr(mof_div_code,3,7) = \\'0000000\\'  '\r\n              break\r\n            case 'amountSjxd':\r\n            case 'amountSjpay':\r\n            case 'amountSjwfp':\r\n            case 'amountSbjfp':\r\n            case 'amountSxjfp':\r\n              condition = ' substr(mof_div_code,3,7) <> \\'0000000\\' and substr(mof_div_code,5,5)=\\'00000\\' '\r\n              break\r\n            case 'amountXjxd':\r\n            case 'amountXjpay':\r\n            case 'amountXjwfp':\r\n            case 'amountXjfp':\r\n              condition = ' substr(mof_div_code,5,5) <> \\'00000\\' and substr(mof_div_code,7,3)=\\'000\\' '\r\n              break\r\n          }\r\n        }\r\n        let isBj = ''\r\n        switch (column) {\r\n          case 'amountSnjbjfp':\r\n          case 'amountSbjfp':\r\n            isBj = '1'\r\n            break\r\n          case 'amountSnjxjfp':\r\n          case 'amountSxjfp':\r\n            isBj = '2'\r\n            break\r\n          case 'amountXjfp':\r\n            isBj = '3'\r\n            break\r\n        }\r\n        let isCz = ''\r\n        if (this.transJson(this.params5 || '')?.reportCode !== '' && this.transJson(this.params5 || '')?.reportCode.includes('cz')) {\r\n          isCz = '2'\r\n        } else {\r\n          isCz = '1'\r\n        }\r\n        reportCode = reportCode === 'zxjdxmmx_fdq_xj' ? 'zxjdxmmx_fdq' : reportCode\r\n        reportCode = reportCode === 'zdzjxmmx_xj' ? 'zdzjxmmx' : reportCode\r\n        let params = {\r\n          reportCode: reportCode,\r\n          mofDivCode: mofDivCode,\r\n          speTypeCode: '',\r\n          isBj: isBj,\r\n          isCz: isCz,\r\n          column: column,\r\n          fiscalYear: this.searchDataList.fiscalYear,\r\n          condition: condition,\r\n          endTime: this.condition.endTime ? this.condition.endTime[0] : '',\r\n          proCodes: this.searchDataList.proCodes === '' ? [] : this.getTrees(this.searchDataList.proCodes),\r\n          isZd: this.searchDataList.isZd || ''\r\n        }\r\n        if (hideColumnLinkStr.projectCode === 'SH') {\r\n          params = { ...this.drillingParam, ...params }\r\n        }\r\n        // 上海需求  监管局需要加 isCentral 字段\r\n        if (hideColumnLinkStr.reportCode === 'zxjd_fdq_central' && hideColumnLinkStr.projectCode === 'SH') {\r\n          params.isCentral = '1'\r\n        }\r\n        this.detailQueryParam = params\r\n        this.detailType = reportCode\r\n        this.detailVisible = true\r\n      // this.tableLoading = true\r\n      // HttpModule.queryTableDatas(params).then((res) => {\r\n      //   this.tableLoading = false\r\n      //   if (res.code === '000000') {\r\n      //     this.detailData = res.data\r\n      //     this.detailType = type\r\n      //   } else {\r\n      //     this.$message.error(res.message)\r\n      //   }\r\n      // })\r\n      }\r\n    },\r\n    // 表格单元行单击\r\n    cellClick(obj, context, e) {\r\n      if (this.isSx) {\r\n        // const rowIndex = obj?.rowIndex\r\n        // if (!rowIndex) return\r\n        let key = obj.column.property\r\n\r\n        // 无效的cellValue\r\n        const isInvalidCellValue = !(obj.row[obj.column.property] * 1)\r\n        if (isInvalidCellValue) return\r\n        // let xmSource = 'zdzjxmmx'\r\n        let zcSource = 'zdzjzcmx_fdq'\r\n        if (this.transJson(this.params5 || '')?.reportCode === 'zxjd_fdq') {\r\n          // xmSource = 'zxjdxmmx_fdq'\r\n          zcSource = 'zxjdzcmx_fdq'\r\n        }\r\n        let bjxmSource = 'zyzfzdjd_fdq_bjmx'\r\n        let xjxmSource = 'zyzfzdjd_fdq_xjmx'\r\n        switch (key) {\r\n          // 省本级分配走直达资金项目明细\r\n          case 'amountSnjbjfp':\r\n          case 'amountSbjfp':\r\n          case 'amountXbjfp':\r\n            this.handleDetail(bjxmSource, obj.row.code, key)\r\n            this.detailTitle = '分配本级项目明细'\r\n            break\r\n          case 'amountSnjxjfp':\r\n          case 'amountSxjfp':\r\n            this.handleDetail(xjxmSource, obj.row.code, key)\r\n            this.detailTitle = '分配下级项目明细'\r\n            break\r\n          // 支出走地区支付明细\r\n          case 'amountPayAll':\r\n            this.handleDetail(zcSource, obj.row.code, key)\r\n            this.detailTitle = obj.row.name + '支出明细'\r\n        }\r\n        // switch (key) {\r\n        //   // 省本级分配走直达资金项目明细\r\n        //   case 'amountSnjbjfp':\r\n        //   case 'amountSbjfp':\r\n        //   case 'amountXbjfp':\r\n        //     this.handleDetail(xmSource, obj.row.code, key)\r\n        //     this.detailTitle = '项目明细'\r\n        //     break\r\n        //   // 支出走地区支付明细\r\n        //   case 'amountPayAll':\r\n        //     this.handleDetail(zcSource, obj.row.code, key)\r\n        //     this.detailTitle = obj.row.name + '支出明细'\r\n        // }\r\n      } else {\r\n        const rowIndex = obj?.rowIndex\r\n        if (!rowIndex) return\r\n        let key = obj.column.property\r\n        // 无效的cellValue\r\n        const hideColumnLinkStr = this.transJson3(this.$store.state.curNavModule.param5)\r\n        if (hideColumnLinkStr.projectCode !== 'SH') {\r\n          const isInvalidCellValue = !(obj.row[obj.column.property] * 1)\r\n          if (isInvalidCellValue) return\r\n        }\r\n        if (hideColumnLinkStr.hideCell && this.cellHide(hideColumnLinkStr.hideCell, obj.column, obj.row)) {\r\n          return\r\n        }\r\n        let xmSource = 'zdzjxmmx'\r\n        let zcSource = 'zdzjzcmx_fdq'\r\n        let reportCode = this.transJson(this.params5 || '')?.reportCode\r\n        if (reportCode === 'zxjd_fdq' || reportCode === 'zxjd_fdq_central') {\r\n          xmSource = 'zxjdxmmx_fdq'\r\n          zcSource = 'zxjdzcmx_fdq'\r\n        }\r\n        const fpbjShow = this.menuSettingConfig['fpbjShow'] === 'false' // 省，市，县分配本级是否显示\r\n        const fpxjShow = this.menuSettingConfig['fpxjShow'] === 'false'// 省，市分配下级是否显示\r\n        const zcjeShow = this.menuSettingConfig['zcjeShow'] === 'false'// 支出-金额是否显示\r\n        const isSH = this.menuSettingConfig['projectCode'] === 'SH'// 判断上海项目\r\n        console.info(zcjeShow)\r\n        if (!zcjeShow && key === dictionary['支出-金额']) {\r\n          this.handleDetail(zcSource, obj.row.code, key, obj.row)\r\n          this.detailTitle = '支出明细'\r\n          return\r\n        }\r\n        if (!fpbjShow && [dictionary['省级分配本级'], dictionary['市级分配本级'], dictionary['县级已分配']].includes(key)) {\r\n          this.handleDetail(xmSource, obj.row.code, key, obj.row)\r\n          this.detailTitle = '项目明细'\r\n        } else if (!fpxjShow && [dictionary['省级分配下级'], dictionary['市级分配下级']].includes(key) && !isSH) {\r\n          this.handleDetail(xmSource, obj.row.code, key, obj.row)\r\n          this.detailTitle = '项目明细'\r\n        } else if (!fpxjShow && [dictionary['省级分配下级'], dictionary['市级分配下级']].includes(key) && isSH) {\r\n          this.handleDetail(xmSource + '_xj', obj.row.code, key, obj.row)\r\n          this.detailTitle = '项目明细'\r\n        }\r\n      }\r\n    },\r\n    // 刷新按钮 刷新查询栏，提示刷新 table 数据\r\n    refresh(isFlush = true) {\r\n      this.search(this.$refs.queryFrom.getFormData(), null, isFlush)\r\n      // this.queryTableDatasCount()\r\n    },\r\n    getPro(fiscalYear = this.$store.state.userInfo?.year) {\r\n      if (this.isSx) {\r\n        HttpModule.getCapitalTreeData({ fiscalYear }).then(res => {\r\n          if (res.code === '000000') {\r\n            let treeResdata = this.getChildrenNewData1(res.data)\r\n            this.queryConfig[1].itemRender.options = treeResdata\r\n          } else {\r\n            this.$message.error(res.message)\r\n          }\r\n        })\r\n      } else {\r\n        HttpModule.getProSpeTreeData({ fiscalYear }).then(res => {\r\n          if (res.code === '000000') {\r\n            let treeResdata = this.getChildrenNewData1(res.data)\r\n            let modeIndex = this.queryConfig.findIndex(e => e.field === 'proCodes')\r\n            if (modeIndex !== -1) {\r\n              this.queryConfig[modeIndex].itemRender.options = treeResdata\r\n            }\r\n          } else {\r\n            this.$message.error(res.message)\r\n          }\r\n        })\r\n      }\r\n    },\r\n    getChildrenNewData1(datas) {\r\n      let that = this\r\n      datas.forEach(item => {\r\n        item.label = item.name\r\n        if (item.children) {\r\n          that.getChildrenNewData1(item.children)\r\n        }\r\n      })\r\n      return datas\r\n    },\r\n    getTrees(val) {\r\n      if (val === undefined) {\r\n        return\r\n      }\r\n      let proCodes = []\r\n      if (val.trim() !== '') {\r\n        val.split(',').forEach((item) => {\r\n          proCodes.push(item.split('##')[0])\r\n        })\r\n      }\r\n      return proCodes\r\n    },\r\n    // 对表头进行处理\r\n    convertTableHead(head) {\r\n      const formulaMap = new Map()\r\n      formulaMap.set('amountSnfpjd', '({amountZyxd}-0==0)?0:(({amountSnjbjfp}+{amountSnjxjfp})/{amountZyxd}*100)')// 省级分配进度\r\n      // formulaMap.set('amountSnjwfp', '{amountZyxd}-{amountSnjbjfp}-{amountSnjxjfp}')// 省级未分配\r\n      formulaMap.set('amountSjfpjd', '({amountSjxd}-0==0)?0:(({amountSbjfp}+{amountSxjfp})/{amountSjxd}*100)')// 市级分配进度\r\n      // formulaMap.set('amountSjwfp', '{amountSjxd}-{amountSbjfp}-{amountSxjfp}')// 市级未分配\r\n      formulaMap.set('amountXjfpjd', '({amountXjxd}-0==0)?0:(({amountXbjfp}+{amountXxjfp})/{amountXjxd}*100)')// 县级分配进度\r\n      // formulaMap.set('amountXjwfp', '{amountXjxd}-{amountXbjfp}-{amountXxjfp}')// 市级未分配\r\n      XEUtils.eachTree(head, (item) => {\r\n        item.minWidth = 150\r\n        if (item.field === 'name') {\r\n          item.treeNode = true\r\n        }\r\n        if (item.field?.startsWith?.('amount')) {\r\n          item['cellRender'] = { name: '$vxeMoney' }\r\n          item.align = 'right'\r\n        }\r\n        if ((item.field?.endsWith?.('jd'))) {\r\n          item['cellRender'] = { name: '$vxeRatio' }\r\n          item.align = 'right'\r\n        }\r\n        if (formulaMap.has(item.field)) {\r\n          item.formula = formulaMap.get(item.field)\r\n        }\r\n      })\r\n      console.log(head, 'ddddhead')\r\n      return head\r\n    },\r\n    // 查询 table 数据\r\n    queryTableDatas(isFlush = true) {\r\n      if (this.isSx) {\r\n        console.log(this.transJson(this.params5 || ''), this.transJson(this.params5 || '')?.reportCode)\r\n        const param = {\r\n          isFlush,\r\n          reportCode: this.transJson(this.params5 || '')?.reportCode,\r\n          fiscalYear: this.searchDataList.fiscalYear || '',\r\n          endTime: this.condition.endTime ? this.condition.endTime[0] : '',\r\n          proCodes: this.searchDataList.proCodes === '' ? [] : this.getTrees(this.searchDataList.proCodes)\r\n        }\r\n        this.tableLoading = true\r\n        HttpModule.queryTableData(param).then((res) => {\r\n          this.tableLoading = false\r\n          if (res.code === '000000') {\r\n            if (res) {\r\n              this.tableColumnsConfig = this.convertTableHead(res.data.head)\r\n              this.$nextTick(vm => {\r\n                this.tableData = res.data.records\r\n              })\r\n              // this.tableData = res.data.records\r\n              this.reportTime = res.data.reportTime || ''\r\n              this.caliberDeclareContent = res.data.description || ''\r\n            }\r\n          } else {\r\n            this.$message.error(res.message)\r\n          }\r\n        }).finally(() => {\r\n          this.tableLoading = false\r\n        })\r\n      } else {\r\n        console.log(this.transJson(this.params5 || ''), this.transJson(this.params5 || '')?.reportCode)\r\n        const param = {\r\n          isFlush,\r\n          reportCode: this.transJson(this.params5 || '')?.reportCode,\r\n          fiscalYear: this.searchDataList.fiscalYear || '',\r\n          clear_date: this.condition.clear_date ? this.condition.clear_date[0] : '',\r\n          endTime: this.condition.endTime ? this.condition.endTime[0] : '',\r\n          proCodes: this.searchDataList.proCodes === '' ? [] : this.getTrees(this.searchDataList.proCodes),\r\n          isZd: this.searchDataList.isZd || ''\r\n        }\r\n        this.tableLoading = true\r\n        HttpModule.queryTableDatas(param).then((res) => {\r\n          if (res.code === '000000') {\r\n            if (res.data) {\r\n              this.tableData = res.data.data\r\n              this.reportTime = res.data.reportTime || ''\r\n              this.caliberDeclareContent = res.data.description || ''\r\n            }\r\n            // 保留高级查询内容需要传入钻取第二层第三层\r\n            this.drillingParam = { ...this.searchDataList }\r\n            // 删除无用属性名\r\n            for (let x in this.drillingParam) {\r\n              if (x.indexOf('__') !== -1) {\r\n                delete this.drillingParam[x]\r\n              }\r\n            }\r\n          } else {\r\n            this.$message.error(res.message)\r\n          }\r\n        }).finally(() => {\r\n          this.tableLoading = false\r\n        })\r\n      }\r\n    },\r\n    initTableData(tableDataTest) {\r\n      let arr = JSON.parse(JSON.stringify(tableDataTest))\r\n      arr.map(v => {\r\n        if ((parseFloat(v.recDivCode) / 10000000).toString().length === 2) {\r\n          v.type = 1\r\n        } else if ((parseFloat(v.recDivCode) / 10000000).toString().length === 5) {\r\n          v.type = 2\r\n        } else if ((parseFloat(v.recDivCode) / 10000000).toString().length === 7) {\r\n          v.type = 3\r\n        }\r\n      })\r\n      this.obj = {}\r\n      arr.forEach(item => {\r\n        if (item.type === 1) {\r\n          this.obj[item.recDivCode.substring(0, 2)] = item\r\n          item.children = []\r\n          this.tableData.push(item)\r\n        } else if (item.type === 2) {\r\n          this.obj[item.recDivCode.substring(0, 5)] = item\r\n          item.children = []\r\n          this.tableData[0].children.push(item)\r\n        } else if (item.type === 3) {\r\n          this.obj[item.recDivCode.substring(0, 7)] = item\r\n        }\r\n      })\r\n      for (const key in this.obj) {\r\n        // const i = key.length - 2\r\n        // const pkey = key.substring(0, i)\r\n        for (var a = 0; a < this.tableData[0].children.length; a++) {\r\n          if (this.tableData[0].children[a] !== this.obj[key] && this.tableData[0].children[a].recDivCode.substring(0, 4) === this.obj[key].recDivCode.substring(0, 4) && this.tableData[0].children[a].type < this.obj[key].type) {\r\n            this.tableData[0].children[a].children.push(this.obj[key])\r\n          }\r\n        }\r\n      }\r\n      return this.tableData\r\n    },\r\n    getNewData() {\r\n      // this.tableLoading = true\r\n      // setTimeout(() => {\r\n      //   this.tableLoading = false\r\n      //   // this.tableData = getFormData('basicInfo', 'tableData')\r\n      //   this.initTableData(getFormData('basicInfo', 'tableData'))\r\n      // }, 2000)\r\n      // this.initTableData(getFormData('basicInfo', 'tableData'))\r\n    },\r\n    cellDblclick(obj) {\r\n      // console.log('双击', obj)\r\n    },\r\n    transJson2(str) {\r\n      if (!str) return\r\n      let params = str.split(',')\r\n      let result = {}\r\n      if (params && params.length > 0) {\r\n        for (let i = 0; i < params.length; i++) {\r\n          let map = params[i].split('=')\r\n          result[map[0]] = map[1]\r\n        }\r\n      }\r\n      return result\r\n    },\r\n    onEditClosed(obj, bsTable, xGrid) {\r\n      bsTable.performTableDataCalculate(obj)\r\n    },\r\n    transJson3 (str) {\r\n      let strTwo = ''\r\n      str.split(',').reduce((acc, curr) => {\r\n        const [key, value] = curr.split('=')\r\n        acc[key] = value\r\n        strTwo = acc\r\n        return acc\r\n      }, {})\r\n      return strTwo\r\n    },\r\n    cellHide(hideStr, column, row) {\r\n      /**\r\n       * hideCellCell=col:amountZyxd;row:10000013Z135050009055&10000013Z135060000035;amountSnjbjfp:10000013Z135080000029&10000013Z135110079006;10000013Z135080000005:amountSnjxjfp&amountSnjbjfp;\r\n       * 以对象的形式配置  col:所需隐藏的列的filed  row:所需隐藏行的code  列filed:某x行code&某y行code  行code:某列field&某列field\r\n       */\r\n      let hideSetting = hideStr.split(';')\r\n      hideSetting.length && (hideSetting = hideSetting.filter(item => item !== ''))\r\n      let settingItemList = hideSetting.map((item, index) => {\r\n        let itemArr = item.split(':')\r\n        if (!itemArr[0] || !itemArr[1] || itemArr.length !== 2) {\r\n          let str = ''\r\n          if (index === 0) {\r\n            str = '第1个\\';\\'前面'\r\n          } else if (index === hideSetting.length - 1) {\r\n            str = '最后一个\\';\\'后面'\r\n          } else {\r\n            str = `第${index}个';'后面${index + 1}个';'前面`\r\n          }\r\n          this.$message({\r\n            duration: 0,\r\n            showClose: true,\r\n            message: `${str}的隐藏列配置项语法错误 请检查菜单配置的隐藏参数 错误配置参数为  ${item}`,\r\n            type: 'error'\r\n          })\r\n          throw new Error(`${str}的隐藏列配置项语法错误 请检查菜单配置的隐藏参数 错误配置参数为  ${item}`)\r\n        }\r\n        let obj = {}\r\n        obj[itemArr[0]] = itemArr[1]\r\n        return obj\r\n      })\r\n      let cellCol = column.property\r\n      let cellRow = row.code\r\n      for (let i = 0; i < settingItemList.length; i++) {\r\n        const item = settingItemList[i]\r\n        // 隐藏整列判断\r\n        if ('col' in item && item['col'].split('&').includes(cellCol)) {\r\n          return true\r\n        }\r\n        // 隐藏整行判断\r\n        if ('row' in item && item['row'].split('&').includes(cellRow)) {\r\n          return true\r\n        }\r\n        // 隐藏某列下的 每行对应的code\r\n        if ('cellCol' in item && item[cellCol].split('&').includes(cellRow)) {\r\n          return true\r\n        }\r\n        // 隐藏某行下 对应每列的点\r\n        if ('cellRow' in item && item[cellRow].split('&').includes(cellCol)) {\r\n          return true\r\n        }\r\n      }\r\n    },\r\n    cellStyle({ row, rowIndex, column }) {\r\n      if (this.isSx) {\r\n        // if (!rowIndex) return\r\n        // 有效的cellValue\r\n        const validCellValue = (row[column.property] * 1)\r\n        if (validCellValue && ['amountSnjbjfp', 'amountSbjfp', 'amountXbjfp', 'amountSnjxjfp', 'amountSxjfp', 'amountXxjfp', 'amountPayAll'].includes(column.property)) {\r\n          return {\r\n            color: '#4293F4',\r\n            textDecoration: 'underline'\r\n          }\r\n        }\r\n      } else {\r\n        // if (this.transJson(this.params5 || '')?.isShow === 'false') return\r\n        if (!rowIndex) return\r\n        // 有效的cellValue\r\n        // 拿到那些可以进行超链接的表格行\r\n        const hideColumnLinkStr = this.transJson3(this.$store.state.curNavModule.param5)\r\n        if (hideColumnLinkStr.projectCode === 'SH') {\r\n          // 判断只有最底层有超链接\r\n          if (row.children !== undefined) return\r\n        } else {\r\n          const validCellValue = (row[column.property] * 1)\r\n          if (!validCellValue) return\r\n        }\r\n        if (hideColumnLinkStr.hideCell && this.cellHide(hideColumnLinkStr.hideCell, column, row)) {\r\n          return\r\n        }\r\n        if (this.linkStyle(row, rowIndex, column)) {\r\n          return {\r\n            color: '#4293F4',\r\n            textDecoration: 'underline'\r\n          }\r\n        }\r\n      }\r\n    },\r\n    linkStyle(row, rowIndex, column) { // 判断是否可以跳转\r\n      const hideColumnLinkStr = this.transJson3(this.$store.state.curNavModule.param5)\r\n      let Arraya = hideColumnLinkStr.hideColumn_link ? hideColumnLinkStr.hideColumn_link.split('#') : []\r\n      // 根据code隐藏对应行\r\n      let rowCodeHide = hideColumnLinkStr.rowCodeHide ? hideColumnLinkStr.rowCodeHide.split('#') : []\r\n      // 这儿与分资金的区别是 中央下达没有样式 也不跳转\r\n      if (Arraya.length > 0 && rowCodeHide.length === 0) { // 只配置了隐藏行\r\n        if (['amountSnjbjfp', 'amountSbjfp', 'amountXjfp', 'amountPayAll', 'amountSnjxjfp', 'amountSxjfp'].includes(column.property) && !Arraya.includes(column.property)) {\r\n          return true\r\n        }\r\n      } else if (Arraya.length === 0 && rowCodeHide.length > 0) { // 只配置了隐藏列\r\n        if (['amountSnjbjfp', 'amountSbjfp', 'amountXjfp', 'amountPayAll', 'amountSnjxjfp', 'amountSxjfp'].includes(column.property) && !rowCodeHide.includes(row.code)) {\r\n          return true\r\n        }\r\n      } else if (Arraya.length > 0 && rowCodeHide.length > 0) { // 都配置了隐藏行 都配置了隐藏列 那就只隐藏交叉单元格\r\n        if (['amountSnjbjfp', 'amountSbjfp', 'amountXjfp', 'amountPayAll', 'amountSnjxjfp', 'amountSxjfp'].includes(column.property) && (!rowCodeHide.includes(row.code) || !Arraya.includes(column.property))) {\r\n          return true\r\n        }\r\n      } else {\r\n        if (['amountSnjbjfp', 'amountSbjfp', 'amountXjfp', 'amountPayAll', 'amountSnjxjfp', 'amountSxjfp'].includes(column.property)) {\r\n          return true\r\n        }\r\n      }\r\n      return false\r\n    },\r\n    transJson(str) {\r\n      if (!str) return\r\n      var params = str.split(',')\r\n      var result = {}\r\n      if (params && params.length > 0) {\r\n        for (var i = 0; i < params.length; i++) {\r\n          var map = params[i].split('=')\r\n          result[map[0]] = map[1]\r\n        }\r\n      }\r\n      return result\r\n    }\r\n  },\r\n  created() {\r\n    console.log(this.$store.state.curNavModule.param5, this.$store.state.curMenuObj)\r\n    this.params5 = this.$store.state.curNavModule.param5\r\n    this.menuId = this.$store.state.curNavModule.guid\r\n    this.menuName = this.$store.state.curNavModule.name\r\n    this.roleguid = this.$store.state.curNavModule.roleguid\r\n    this.tokenid = this.$store.getters.getLoginAuthentication.tokenid\r\n    this.userInfo = this.$store.state.userInfo\r\n    this.projectCode = this.transJson(this.params5 || '')?.projectCode\r\n    if (!this.isSx) {\r\n      // 判断是否开放动态表格配置\r\n      const hideColumnLinkStr = this.transJson3(this.$store.state.curNavModule.param5)\r\n      if (hideColumnLinkStr && hideColumnLinkStr.projectCode === 'SH') {\r\n        this.$nextTick(() => {\r\n          this.refresh(true)\r\n        })\r\n      }\r\n      if (hideColumnLinkStr && hideColumnLinkStr.isConfigTable === '1') {\r\n        this.loadConfig('BsTable', 'Table101')\r\n        this.loadConfig('BsQuery', 'Query101')\r\n      }\r\n    }\r\n    this.getPro()\r\n    this.queryTableDatas(false)\r\n  }\r\n}\r\n</script>\r\n<style scoped>\r\n.radio-right {\r\n  float: right;\r\n}\r\n.Titans-table ::v-deep .vxe-body--row.row-yellow {\r\n  background-color: yellow;\r\n  color: #fff;\r\n}\r\n.Titans-table ::v-deep .vxe-body--row.row-blue {\r\n  background-color: blue;\r\n  color: #fff;\r\n}\r\n.Titans-table ::v-deep .vxe-body--row.row-red {\r\n  background-color: red;\r\n  color: #fff;\r\n}\r\n</style>\r\n"]}]}