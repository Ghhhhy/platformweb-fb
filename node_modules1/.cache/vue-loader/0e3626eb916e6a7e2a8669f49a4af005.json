{"remainingRequest":"C:\\Users\\何小龙\\Desktop\\platformweb-fb\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\何小龙\\Desktop\\platformweb-fb\\src\\views\\main\\directFund\\indexFindNew\\components\\SearchModal.vue?vue&type=style&index=0&id=c9dd405e&lang=scss&scoped=true&","dependencies":[{"path":"C:\\Users\\何小龙\\Desktop\\platformweb-fb\\src\\views\\main\\directFund\\indexFindNew\\components\\SearchModal.vue","mtime":1695716045280},{"path":"C:\\Users\\何小龙\\Desktop\\platformweb-fb\\node_modules\\css-loader\\dist\\cjs.js","mtime":1696752946978},{"path":"C:\\Users\\何小龙\\Desktop\\platformweb-fb\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"C:\\Users\\何小龙\\Desktop\\platformweb-fb\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"C:\\Users\\何小龙\\Desktop\\platformweb-fb\\node_modules\\sass-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\何小龙\\Desktop\\platformweb-fb\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\何小龙\\Desktop\\platformweb-fb\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoNCi5idXR0b25DbGFzc3sNCiAgdGV4dC1hbGlnbjogcmlnaHQ7DQogIG1hcmdpbi1ib3R0b206IDEycHg7DQogIC5idXR0b25DbGFzczF7DQogICAgZmxvYXQ6bGVmdDsNCiAgICBwYWRkaW5nLXRvcDogMTBweDsNCiAgfQ0KfQ0KDQouZm9ybUNsYXNzew0KICBoZWlnaHQ6NTIlOw0KfQ0KLmZvcm1DbGFzczF7DQogIGhlaWdodDo0OCU7DQogIC5mb3JtVGl0bGV7DQogICAgY29sb3I6IHZhcigtLXNlY29uZGFyeS1jb2xvcik7DQogICAgYm9yZGVyLWxlZnQ6IDRweCBzb2xpZCB2YXIoLS1zZWNvbmRhcnktY29sb3IpOw0KICAgIHBhZGRpbmctbGVmdDogMTVweDsNCiAgICBtYXJnaW46IDEwcHggMDsNCiAgfQ0KfQ0K"},{"version":3,"sources":["SearchModal.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAipBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"SearchModal.vue","sourceRoot":"src/views/main/directFund/indexFindNew/components","sourcesContent":["<!-- 来源去向查看弹框 -->\r\n<template>\r\n  <div>\r\n    <vxe-modal\r\n      ref=\"projectDialog\"\r\n      v-model=\"dialogVisible\"\r\n      width=\"96%\"\r\n      height=\"96%\"\r\n      title=\"来源去向查看\"\r\n      @close=\"closeDialog\"\r\n    >\r\n      <div class=\"formClass\">\r\n        <BsQuery\r\n          ref=\"queryForm\"\r\n          :query-form-item-config=\"queryFormItemConfig\"\r\n          :query-form-data=\"queryFormData\"\r\n          @onSearchClick=\"onSearchClick\"\r\n          @onSearchResetClick=\"onSearchResetClick\"\r\n        />\r\n        <BsTable\r\n          ref=\"detailTable\"\r\n          style=\"height:calc(100% - 56px)\"\r\n          :loading=\"tableLoading\"\r\n          :table-data=\"tableData\"\r\n          :edit-rules=\"editRules\"\r\n          :edit-config=\"editConfig\"\r\n          :table-config=\"tableConfig\"\r\n          :pager-config=\"pagerConfig\"\r\n          :footer-config=\"footerConfig\"\r\n          :default-money-unit=\"defaultMoneyUnit\"\r\n          :table-columns-config=\"tableColumnsConfig\"\r\n          :cell-style=\"cellStyle\"\r\n          @radioChange=\"checkboxChange\"\r\n          @ajaxData=\"pageChangeHandle\"\r\n          @cellClick=\"cellClick\"\r\n          @onToolbarBtnClick=\"onToolbarOperrateClick\"\r\n        />\r\n      </div>\r\n      <div v-show=\"selectRow.length > 0\" class=\"formClass1\">\r\n        <BsTable\r\n          ref=\"hxTable\"\r\n          :loading=\"BtableLoading\"\r\n          :table-data=\"BtableData\"\r\n          :cell-style=\"BcellStyle\"\r\n          :table-config=\"tableConfig\"\r\n          :pager-config=\"BpagerConfig\"\r\n          :footer-config=\"footerConfig\"\r\n          :default-money-unit=\"defaultMoneyUnit\"\r\n          :table-columns-config=\"BtableColumnsConfig\"\r\n          @cellClick=\"BcellClick\"\r\n          @ajaxData=\"pageDownChangeHandle\"\r\n          @onToolbarBtnClick=\"onToolbarOperrateClick1\"\r\n        />\r\n      </div>\r\n    </vxe-modal>\r\n    <DetailDialog\r\n      v-if=\"detailVisible\"\r\n      :dialog-visible.sync=\"detailVisible\"\r\n      :detail-row=\"detailRow\"\r\n    />\r\n    <BottomTargetDialog\r\n      v-if=\"detailVisible1\"\r\n      :dialog-visible.sync=\"detailVisible1\"\r\n      :detail-row=\"detailRow1\"\r\n    />\r\n    <BottomPayDialog\r\n      v-if=\"detailVisible2\"\r\n      :dialog-visible.sync=\"detailVisible2\"\r\n      :detail-row=\"detailRow2\"\r\n    />\r\n  </div>\r\n\r\n</template>\r\n\r\n<script>\r\nimport commonMixin from '@//mixin/commonMixin'\r\nimport DetailDialog from './detailDialog.vue'\r\nimport BottomTargetDialog from './bottomTargetDialog.vue'\r\nimport BottomPayDialog from './bottomPayDialog.vue'\r\n// import { post } from '@/api/http'\r\nexport default {\r\n  name: 'SearchModal',\r\n  mixins: [commonMixin],\r\n  components: {\r\n    DetailDialog,\r\n    BottomTargetDialog,\r\n    BottomPayDialog\r\n  },\r\n  props: {\r\n    dialogVisible: {\r\n      type: Boolean,\r\n      default() {\r\n        return false\r\n      }\r\n    },\r\n    closeDialogCall: {\r\n      type: Function,\r\n      default: () => { }\r\n    },\r\n    currentValue: {\r\n      type: Object,\r\n      default: () => {}\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      queryFormItemConfig: [\r\n        // {\r\n        //   title: '处室',\r\n        //   field: 'manageMofDep',\r\n        //   align: 'left',\r\n        //   span: 6,\r\n        //   itemRender: {\r\n        //     name: '$vxeTree',\r\n        //     options: [],\r\n        //     'props': {\r\n        //       'config': {\r\n        //         'treeProps': {\r\n        //           'nodeKey': 'id',\r\n        //           'label': 'label',\r\n        //           'children': 'children'\r\n        //         },\r\n        //         'placeholder': '请选择处室',\r\n        //         'multiple': false,\r\n        //         'readonly': true,\r\n        //         'isleaf': true\r\n        //       }\r\n        //     }\r\n        //   }\r\n        // },\r\n        {\r\n          title: '指标文号',\r\n          field: 'corBgtDocNo',\r\n          align: 'left',\r\n          span: 6,\r\n          itemRender: {\r\n            name: '$vxeInput',\r\n            defaultValue: '',\r\n            props: {\r\n              placeholder: '请输入指标文号',\r\n              size: 'small'\r\n            }\r\n          }\r\n        }\r\n        // {\r\n        //   title: '区划名称',\r\n        //   field: 'mofDiv',\r\n        //   align: 'left',\r\n        //   span: 6,\r\n        //   itemRender: {\r\n        //     name: '$vxeTree',\r\n        //     options: [],\r\n        //     'props': {\r\n        //       'config': {\r\n        //         'treeProps': {\r\n        //           'nodeKey': 'id',\r\n        //           'label': 'label',\r\n        //           'children': 'children'\r\n        //         },\r\n        //         'placeholder': '请选择区划名称',\r\n        //         'multiple': false,\r\n        //         'readonly': true,\r\n        //         'isleaf': true\r\n        //       }\r\n        //     }\r\n        //   }\r\n        // },\r\n        // {\r\n        //   title: '专项资金',\r\n        //   field: 'trackPro',\r\n        //   span: 6,\r\n        //   itemRender: {\r\n        //     name: '$vxeTree',\r\n        //     options: [],\r\n        //     'props': {\r\n        //       'config': {\r\n        //         'treeProps': {\r\n        //           'nodeKey': 'id',\r\n        //           'label': 'label',\r\n        //           'children': 'children'\r\n        //         },\r\n        //         'placeholder': '请选择专项资金',\r\n        //         'multiple': false,\r\n        //         'readonly': true,\r\n        //         'isleaf': true\r\n        //       }\r\n        //     }\r\n        //   }\r\n        // }\r\n      ],\r\n      queryFormData: {},\r\n      selectRow: [],\r\n      tableLoading: false,\r\n      editRules: {},\r\n      editConfig: {},\r\n      footerConfig: {\r\n        showFooter: true,\r\n        combinedType: ['subTotal', 'total', 'totalAll', 'switchTotal']\r\n      },\r\n      pagerConfig: {\r\n        total: 0,\r\n        pageSize: 20,\r\n        currentPage: 1\r\n      },\r\n      tableQuery: {},\r\n      BpagerConfig: {\r\n        total: 0,\r\n        pageSize: 20,\r\n        currentPage: 1\r\n      },\r\n      defaultMoneyUnit: 10000,\r\n      tableColumnsConfig: [],\r\n      tableConfig: {\r\n        globalConfig: { // 全局配置\r\n          checkType: 'radio', // 'checkbox'复选框\r\n          seq: true // 序号列\r\n        }\r\n      },\r\n      tableData: [],\r\n      BtableLoading: false,\r\n      BtableColumnsConfig: [],\r\n      BtableData: [],\r\n      detailVisible: false,\r\n      detailRow: {},\r\n      detailVisible1: false,\r\n      detailRow1: {},\r\n      detailVisible2: false,\r\n      detailRow2: {},\r\n      downParams: {\r\n        corBgtDocNo: '',\r\n        recDivCode: '',\r\n        trackProCode: ''\r\n      }\r\n\r\n    }\r\n  },\r\n  methods: {\r\n    cellClick(obj, context, from) {\r\n      console.log(obj.column.property)\r\n      if (obj.column.property === 'payAppAmt') {\r\n        this.detailRow = obj.row\r\n        this.detailVisible = true\r\n      } else if (obj.column.property === 'proName') {\r\n        if (!obj.row.proGuid) {\r\n          this.$message.warning('未返proGuid,无法查看项目信息')\r\n          return\r\n        }\r\n        this.proGuid = obj.row?.proGuid || ''\r\n        this.mofDivCode = obj.row?.mofDivCode || ''\r\n        this.fiscalYear = obj.row?.fiscalYear || ''\r\n        let groupUrl = ''\r\n        let groups = window.gloableToolFn.serverGatewayMap.getGroups || {}\r\n        Object.keys(groups).forEach(key => {\r\n          console.log(key, '-------------')\r\n          if (groups[key].indexOf(this.mofDivCode?.slice(0, 4)) !== -1) {\r\n            groupUrl = window.gloableToolFn.serverGatewayMap.getProjectUrl[key]\r\n            let url = `${groupUrl}/ProjectDetailIframe?isShowHead=0&tokenid=${this.$store.getters.getLoginAuthentication.tokenid}&appguid=ystztj&proGuid=${this.proGuid}&mofDivCode=${this.mofDivCode}&fiscalYear=${this.fiscalYear}`\r\n            console.log('访问地址：', url)\r\n            window.open(url)\r\n          }\r\n        })\r\n      }\r\n    },\r\n    cellStyle({ row, rowIndex, column }) {\r\n      if (column.property === 'payAppAmt' || column.property === 'proName') {\r\n        return {\r\n          color: '#4293F4',\r\n          textDecoration: 'underline'\r\n        }\r\n      }\r\n    },\r\n    BcellStyle({ row, rowIndex, column }) {\r\n      if (column.property === 'payAppAmt' || column.property === 'fpAmount' || column.property === 'proName') {\r\n        return {\r\n          color: '#4293F4',\r\n          textDecoration: 'underline'\r\n        }\r\n      }\r\n    },\r\n    pageChangeHandle({ currentPage, pageSize }) { // 表格分页点击\r\n      this.pagerConfig.currentPage = currentPage\r\n      this.pagerConfig.pageSize = pageSize\r\n      this.getTopTableData()\r\n    },\r\n    pageDownChangeHandle({ currentPage, pageSize }) { // 表格分页点击\r\n      this.BpagerConfig.currentPage = currentPage\r\n      this.BpagerConfig.pageSize = pageSize\r\n      this.getBottomTableData()\r\n    },\r\n    onToolbarOperrateClick({ code }) {\r\n      console.log(123, code)\r\n      switch (code) {\r\n        case 'refresh':\r\n          this.onSearchClick()\r\n          // this.reloadTableConlums(this.tableColumnsConfig)\r\n          // this.refreshTable()\r\n          break\r\n      }\r\n    },\r\n    onToolbarOperrateClick1({ code }) {\r\n      console.log(123, code)\r\n      switch (code) {\r\n        case 'refresh':\r\n          this.getBottomTableData(this.selectRow[0])\r\n          // this.reloadTableConlums(this.tableColumnsConfig)\r\n          // this.refreshTable()\r\n          break\r\n      }\r\n    },\r\n    BcellClick(obj, context, from) {\r\n      if (obj.column.property === 'payAppAmt') { // 指标明细\r\n        this.detailRow2 = obj.row\r\n        this.detailVisible2 = true\r\n      } else if (obj.column.property === 'fpAmount') { // 支付明细\r\n        this.detailRow1 = obj.row\r\n        this.detailVisible1 = true\r\n      } else if (obj.column.property === 'proName') {\r\n        if (!obj.row.proGuid) {\r\n          this.$message.warning('未返proGuid,无法查看项目信息')\r\n          return\r\n        }\r\n        this.proGuid = obj.row?.proGuid || ''\r\n        this.mofDivCode = obj.row?.mofDivCode || ''\r\n        this.fiscalYear = obj.row?.fiscalYear || ''\r\n        let groupUrl = ''\r\n        let groups = window.gloableToolFn.serverGatewayMap.getGroups || {}\r\n        Object.keys(groups).forEach(key => {\r\n          console.log(key, '-------------')\r\n          if (groups[key].indexOf(this.mofDivCode?.slice(0, 4)) !== -1) {\r\n            groupUrl = window.gloableToolFn.serverGatewayMap.getProjectUrl[key]\r\n            let url = `${groupUrl}/ProjectDetailIframe?isShowHead=0&tokenid=${this.$store.getters.getLoginAuthentication.tokenid}&appguid=ystztj&proGuid=${this.proGuid}&mofDivCode=${this.mofDivCode}&fiscalYear=${this.fiscalYear}`\r\n            console.log('访问地址：', url)\r\n            window.open(url)\r\n          }\r\n        })\r\n      }\r\n    },\r\n    onSearchClick () {\r\n      let data = this.$refs.queryForm.getFormData()\r\n      let parentRow = this.currentValue\r\n      this.queryFormData = {\r\n        bgtId: parentRow.bgtId,\r\n        corBgtDocNo: data.corBgtDocNo,\r\n        trackProCode: parentRow.trackProCode\r\n      }\r\n      this.getTopTableData()\r\n    },\r\n    async onSearchResetClick () {\r\n      this.queryFormData = {}\r\n      await this.$refs.queryForm.reset()\r\n      await this.getTopTableData()\r\n    },\r\n    async checkboxChange(obj, e) {\r\n      this.selectRow = [obj.row]\r\n      this.downParams.corBgtDocNo = obj.row.corBgtDocNo || ''\r\n      this.downParams.recDivCode = obj.row.recDivCode || ''\r\n      this.downParams.trackProCode = obj.row.trackProCode || ''\r\n      await this.getBottomTableData(obj.row)\r\n    },\r\n    closeDialog(type) {\r\n      this.closeDialogCall(type)\r\n    },\r\n    getTableConfig() {\r\n      this.tableColumnsConfig = [\r\n        {\r\n          field: 'mofDivName',\r\n          title: '区划名称',\r\n          treeNode: true,\r\n          fixed: 'left'\r\n        },\r\n        {\r\n          field: 'mofDepName',\r\n          title: '处室',\r\n          treeNode: true,\r\n          fixed: 'left'\r\n        },\r\n        {\r\n          field: 'corBgtDocNo',\r\n          title: '指标文号',\r\n          treeNode: true,\r\n          fixed: 'left'\r\n        },\r\n        {\r\n          field: 'agencyName',\r\n          title: '单位'\r\n        },\r\n        {\r\n          field: 'trackProName',\r\n          title: '专项资金'\r\n        },\r\n        {\r\n          field: 'proName',\r\n          title: '项目名称'\r\n        },\r\n        {\r\n          field: 'supBgtDocNo',\r\n          title: '上级文号'\r\n        },\r\n        // {\r\n        //   field: 'sjzxzj',\r\n        //   title: '上级专项资金'\r\n        // },\r\n        {\r\n          field: 'ysAmount',\r\n          title: '预算金额',\r\n          align: 'right',\r\n          cellRender: {\r\n            name: '$vxeMoney'\r\n          },\r\n          combinedType: ['subTotal', 'total', 'treeTotal'],\r\n          sort: true\r\n        },\r\n        {\r\n          field: 'fpAmount',\r\n          title: '分配下级金额',\r\n          align: 'right',\r\n          cellRender: {\r\n            name: '$vxeMoney'\r\n          },\r\n          combinedType: ['subTotal', 'total', 'treeTotal'],\r\n          sort: true\r\n        },\r\n        {\r\n          field: 'fpjd',\r\n          title: '分配下级进度',\r\n          align: 'right',\r\n          formula: '({ysAmount}-0==0)?0:(({fpAmount})/{ysAmount}*100)',\r\n          cellRender: {\r\n            name: '$vxeRatio'\r\n          },\r\n          sort: true\r\n        },\r\n        {\r\n          field: 'payAppAmt',\r\n          title: '支付金额',\r\n          align: 'right',\r\n          cellRender: {\r\n            name: '$vxeMoney'\r\n          },\r\n          combinedType: ['subTotal', 'total', 'treeTotal'],\r\n          sort: true\r\n        },\r\n        {\r\n          field: 'zfjd',\r\n          title: '支付进度',\r\n          align: 'right',\r\n          formula: '({ysAmount}-0==0)?0:(({payAppAmt})/{ysAmount}*100)',\r\n          cellRender: {\r\n            name: '$vxeRatio'\r\n          },\r\n          sort: true\r\n        }\r\n\r\n      ]\r\n      this.tableColumnsConfig.forEach((v) => {\r\n        v.width = 220\r\n      })\r\n      this.BtableColumnsConfig = [\r\n        {\r\n          field: 'mofDivName',\r\n          title: '区划名称',\r\n          treeNode: true,\r\n          fixed: 'left'\r\n        },\r\n        {\r\n          field: 'mofDepName',\r\n          title: '处室',\r\n          treeNode: true,\r\n          fixed: 'left'\r\n        },\r\n        {\r\n          field: 'corBgtDocNo',\r\n          title: '指标文号',\r\n          treeNode: true,\r\n          fixed: 'left'\r\n        },\r\n        {\r\n          field: 'agencyName',\r\n          title: '单位'\r\n        },\r\n        {\r\n          field: 'trackProName',\r\n          title: '专项资金'\r\n        },\r\n        {\r\n          field: 'proName',\r\n          title: '项目名称'\r\n        },\r\n        {\r\n          field: 'supBgtDocNo',\r\n          title: '上级文号'\r\n        },\r\n        // {\r\n        //   field: 'sjzxzj',\r\n        //   title: '上级专项资金'\r\n        // },\r\n        {\r\n          field: 'ysAmount',\r\n          title: '预算金额',\r\n          align: 'right',\r\n          cellRender: {\r\n            name: '$vxeMoney'\r\n          },\r\n          combinedType: ['subTotal', 'total', 'treeTotal'],\r\n          sort: true\r\n        },\r\n        {\r\n          field: 'fpAmount',\r\n          title: '分配下级金额',\r\n          align: 'right',\r\n          cellRender: {\r\n            name: '$vxeMoney'\r\n          },\r\n          combinedType: ['subTotal', 'total', 'treeTotal'],\r\n          sort: true\r\n        },\r\n        {\r\n          field: 'fpjd',\r\n          title: '分配下级进度',\r\n          align: 'right',\r\n          formula: '({ysAmount}-0==0)?0:(({fpAmount})/{ysAmount}*100)',\r\n          cellRender: {\r\n            name: '$vxeRatio'\r\n          },\r\n          sort: true\r\n        },\r\n        {\r\n          field: 'payAppAmt',\r\n          title: '支付金额',\r\n          align: 'right',\r\n          cellRender: {\r\n            name: '$vxeMoney'\r\n          },\r\n          combinedType: ['subTotal', 'total', 'treeTotal'],\r\n          sort: true\r\n        },\r\n        {\r\n          field: 'zfjd',\r\n          title: '支付进度',\r\n          align: 'right',\r\n          formula: '({ysAmount}-0==0)?0:(({payAppAmt})/{ysAmount}*100)',\r\n          cellRender: {\r\n            name: '$vxeRatio'\r\n          },\r\n          sort: true\r\n        }\r\n      ]\r\n      this.BtableColumnsConfig.forEach((v) => {\r\n        v.width = 220\r\n      })\r\n    },\r\n    // post('', params)\r\n    async getTopTableData() {\r\n      this.tableLoading = true // 加载显示\r\n      const { currentPage, pageSize } = this.pagerConfig\r\n      const params = {\r\n        current: currentPage, // 分页-当前页号\r\n        size: pageSize, // 分页-规模\r\n        ...this.tableQuery,\r\n        ...this.queryFormData,\r\n        reportCode: 'queryTop'\r\n      }\r\n      await this.$http.post('dfr-monitor-service/dfr/bgtInfoQuery/queryDetailPage', params).then((res) => {\r\n        if (res.code === '000000' && res.data) {\r\n          this.tableData = res.data.results\r\n          this.pagerConfig.total = res.data.totalCount\r\n        }\r\n        this.tableLoading = false\r\n      })\r\n    },\r\n    async getBottomTableData(row) {\r\n      this.BtableLoading = true // 加载显示\r\n      const { currentPage, pageSize } = this.BpagerConfig\r\n      const params = {\r\n        current: currentPage, // 分页-当前页号\r\n        size: pageSize, // 分页-规模\r\n        ...this.downParams,\r\n        reportCode: 'queryDown'\r\n      }\r\n      await this.$http.post('dfr-monitor-service/dfr/bgtInfoQuery/queryDetailXjPage', params).then((res) => {\r\n        if (res.code === '000000' && res.data) {\r\n          this.BtableData = res.data.results\r\n          this.BpagerConfig.total = res.data.totalCount\r\n        } else {\r\n          this.$message(res.message)\r\n        }\r\n        this.BtableLoading = false\r\n      })\r\n    },\r\n    getRegulationChildrenData1(datas) {\r\n      let that = this\r\n      datas.forEach(item => {\r\n        // item.code = item.code\r\n        item.label = item.code + '-' + item.name\r\n        if (item.children && item.children.length > 0) {\r\n          that.getRegulationChildrenData1(item.children)\r\n          item.leaf = false\r\n        } else {\r\n          item.leaf = true\r\n        }\r\n      })\r\n\r\n      return datas\r\n    }\r\n    // async getTreeConfig() {\r\n    //   await this.$http.get('large-monitor-platform/lmp/manageMofDep', {}).then((res) => { // 处室\r\n    //     if (res.code === '000000' && res.data) {\r\n    //       let treeResdata = this.getRegulationChildrenData1(res.data)\r\n    //       this.queryFormItemConfig[0].itemRender.options = treeResdata\r\n    //     } else {\r\n    //       this.$message.error('下拉树加载失败')\r\n    //     }\r\n    //   })\r\n    //   await this.$http.post('dfr-monitor-service/dfr/mofDivList/query', {}).then((res) => { // 区划\r\n    //     if (res.code === '000000' && res.data) {\r\n    //       let treeResdata = this.getRegulationChildrenData1(res.data)\r\n    //       this.queryFormItemConfig[2].itemRender.options = treeResdata\r\n    //     } else {\r\n    //       this.$message.error('下拉树加载失败')\r\n    //     }\r\n    //   })\r\n    //   await this.$http.post('dfr-monitor-service/dfr/mofDivList/querySpePro', {}).then((res) => { // 专项资金\r\n    //     if (res.code === '000000' && res.data) {\r\n    //       let treeResdata = this.getRegulationChildrenData1(res.data)\r\n    //       this.queryFormItemConfig[3].itemRender.options = treeResdata\r\n    //     } else {\r\n    //       this.$message.error('下拉树加载失败')\r\n    //     }\r\n    //   })\r\n    // }\r\n  },\r\n  mounted() {\r\n    this.getTopTableData()\r\n  },\r\n  created() {\r\n    this.getTableConfig()\r\n    // this.getTreeConfig()\r\n  },\r\n  watch: {\r\n    dialogVisible: {\r\n      handler(newval) {\r\n        this.$emit('update:dialogVisible', newval)\r\n        if (newval) {\r\n          this.tableQuery = {\r\n            bgtId: this.currentValue.bgtId,\r\n            trackProCode: this.currentValue.trackProCode\r\n          }\r\n        }\r\n      },\r\n      deep: true,\r\n      immediate: true\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style  lang=\"scss\" scoped>\r\n.buttonClass{\r\n  text-align: right;\r\n  margin-bottom: 12px;\r\n  .buttonClass1{\r\n    float:left;\r\n    padding-top: 10px;\r\n  }\r\n}\r\n\r\n.formClass{\r\n  height:52%;\r\n}\r\n.formClass1{\r\n  height:48%;\r\n  .formTitle{\r\n    color: var(--secondary-color);\r\n    border-left: 4px solid var(--secondary-color);\r\n    padding-left: 15px;\r\n    margin: 10px 0;\r\n  }\r\n}\r\n</style>\r\n"]}]}