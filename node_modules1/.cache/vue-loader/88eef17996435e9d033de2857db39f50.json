{"remainingRequest":"C:\\Users\\何小龙\\Desktop\\platformweb-fb\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\何小龙\\Desktop\\platformweb-fb\\src\\views\\test\\FineReportTemplate\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\何小龙\\Desktop\\platformweb-fb\\src\\views\\test\\FineReportTemplate\\index.vue","mtime":1694505522951},{"path":"C:\\Users\\何小龙\\Desktop\\platformweb-fb\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\何小龙\\Desktop\\platformweb-fb\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"C:\\Users\\何小龙\\Desktop\\platformweb-fb\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\何小龙\\Desktop\\platformweb-fb\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgeyBteU1ldGhvZHMgfSBmcm9tICdAL3ZpZXdzL3Rlc3QvYmxhbmtUZW1wbGF0ZS9qcy9tZXRob2RzLmpzJw0KaW1wb3J0IG1peCBmcm9tICdAL21peGluL2NvbW1vbk1peGluLmpzJw0KDQpleHBvcnQgZGVmYXVsdCB7DQogIG5hbWU6ICdGaW5lUmVwb3J0VGVtcGxhdGUnLA0KICBjb21wb25lbnRzOiB7fSwNCiAgbWl4aW5zOiBbbWl4XSwNCiAgcHJvcHM6IHsNCiAgICBhbGxQcm9wRGF0YTogew0KICAgICAgdHlwZTogT2JqZWN0LA0KICAgICAgZGVmYXVsdCgpIHsNCiAgICAgICAgcmV0dXJuIHt9DQogICAgICB9DQogICAgfQ0KICB9LA0KICBkYXRhKCkgew0KICAgIHJldHVybiB7DQogICAgICB0YWJTdGF0dXNCdG5Db25maWc6IHt9LA0KICAgICAgdHJlZUNvbmZpZzoge30sDQogICAgICBsZWZ0VmlzaWJsZTogdHJ1ZSwNCiAgICAgIGxldGZ0VHJlZUZpbHRlclRleHQ6ICcnLA0KICAgICAgbGVmdFRyZWVDb25maWc6IHt9LA0KICAgICAgdHJlZURhdGE6IFtdLA0KICAgICAgdHJlZVF1ZXJ5cGFyYW1zOiB7fQ0KICAgIH0NCiAgfSwNCiAgY29tcHV0ZWQ6IHt9LA0KICB3YXRjaDogew0KICAgIHF1ZXJ5Rm9ybURhdGE6IHsNCiAgICAgIGhhbmRsZXIobmV3dmFsKSB7DQogICAgICAgIGNvbnNvbGUubG9nKG5ld3ZhbCkNCiAgICAgIH0sDQogICAgICBkZWVwOiB0cnVlLA0KICAgICAgaW1tZWRpYXRlOiB0cnVlDQogICAgfQ0KICB9LA0KICBjcmVhdGVkKCkgew0KICAgIHRoaXMuaW5pdENyZWF0ZWQoKQ0KICAgIHRoaXMuaW5pdEZpbmVSZXBvcnQoKQ0KICB9LA0KICBtb3VudGVkKCkgew0KICAgIHRoaXMuaW5pdE1vdW50ZWQoKQ0KICB9LA0KICBtZXRob2RzOiB7DQogICAgLi4ubXlNZXRob2RzLA0KICAgIC8vIOWIneWni+WMluW4hui9r+aKpeihqOagt+W8jw0KICAgIGluaXRGaW5lUmVwb3J0KCkgew0KICAgICAgY29uc3QgaWZyYW1lID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3JlcG9ydEZyYW1lJykNCiAgICAgIC8vIOiOt+WPlmlmcmFtZeWGheeahOmhtemdouaWh+aho+WvueixoQ0KICAgICAgbGV0IHJlcG9ydCA9IHt9DQogICAgICB0cnkgew0KICAgICAgICByZXBvcnQgPSBpZnJhbWUuY29udGVudFdpbmRvdy5kb2N1bWVudA0KICAgICAgfSBjYXRjaCB7DQogICAgICAgIHRoaXMuJFhNb2RhbC5tZXNzYWdlKHsgaWQ6ICdmaW5lcmVwb3J0RXJyb3InLCBzdGF0dXM6ICdlcnJvcicsIG1lc3NhZ2U6ICfojrflj5bluIbova/miqXooajlpLHotKU6IOaegeacieWPr+iDveaYr+i3qOa6kOmXrumimCcsIGR1cmF0aW9uOiA1MDAwIH0pDQogICAgICAgIHJldHVybg0KICAgICAgfQ0KICAgICAgLy8g6I635Y+W5biG6L2v5YaF572u55qE5bel5YW35qCP5a+56LGhDQogICAgICBjb25zdCB0b29sYmFyID0gcmVwb3J0LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ3gtdG9vbGJhcicpWzBdDQogICAgICB0b29sYmFyLnN0eWxlLmRpc3BsYXkgPSAnbm9uZScgLy8g5bCG6buY6K6k5bel5YW35qCP6ZqQ6JeP5o6JDQoNCiAgICAgIC8vIOiOt+WPluaKpeihqOWuueWZqOWvueixoQ0KICAgICAgY29uc3QgY29udGFpbmVyID0gcmVwb3J0LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ3JlcG9ydFBhbmUnKVswXQ0KICAgICAgY29udGFpbmVyLnN0eWxlLnRvcCA9ICcwcHgnIC8vIOWOu+mZpOm7mOiupOeahGZpbmVyZXBvcnTlhoXnva7lt6XlhbfmoI/lkI7vvIzpnIDopoHlsIbmlbTkuKrmiqXooajkuIrnp7vvvIzloavlhYXlt6XlhbfmoI/nqbrnmb3lpIQNCg0KICAgICAgLy8g6I635Y+W5Y2V5YWD5qC85a+56LGhDQogICAgICBjb25zdCB0ZCA9IHJlcG9ydC5nZXRFbGVtZW50c0J5VGFnTmFtZSgndGQnKQ0KICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0ZC5sZW5ndGg7IGkrKykgew0KICAgICAgICB0ZFtpXS5zdHlsZS5iYWNrZ3JvdW5kID0gJ25vbmUnIC8vIOWOu+mZpOavj+S4quWNleWFg+agvOeahOm7mOiupOiDjOaZrw0KICAgICAgICB0ZFtpXS5zdHlsZS5jb2xvciA9ICdibGFjaycgLy8g57uf5LiA5a2X5L2T6aKc6ImyDQogICAgICB9DQoNCiAgICAgIC8vIOiOt+WPluihqOagvOeahOihqOWktOihjOWktOWDjw0KICAgICAgY29uc3QgdHIgPSByZXBvcnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ3RyJykNCiAgICAgIHRyWzBdLnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICdyZ2IoMjI3LCAyNDIsIDI1NCknIC8vIOWwhuihqOWktOiDjOaZr+iJsumFjeaIkOWSjOWklumhtemdouebuOWQjOmjjuagvA0KICAgICAgLy8g6KGo5qC85paR6ams57q5DQogICAgICBmb3IgKGxldCBpID0gMjsgaSA8IHRyLmxlbmd0aDsgaSA9IGkgKyAyKSB7DQogICAgICAgIHRyW2ldLnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICdyZ2IoMjQ0LCAyNDYsIDI1MyknDQogICAgICB9DQogICAgfSwNCiAgICAvLyDliLfmlrANCiAgICBvblJlZnJlc2hDbGljaygpIHsNCg0KICAgIH0sDQogICAgLy8g5a+85Ye6DQogICAgb25FeHBvcnRDbGljayh7IG5hbWUsICRldmVudCB9KSB7DQogICAgICBjb25zdCBpZnJhbWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVwb3J0RnJhbWUnKQ0KICAgICAgbGV0IHJlcG9ydCA9IHt9DQogICAgICB0cnkgew0KICAgICAgICByZXBvcnQgPSBpZnJhbWUuY29udGVudFdpbmRvdy5jb250ZW50UGFuZQ0KICAgICAgfSBjYXRjaCB7DQogICAgICAgIHRoaXMuJFhNb2RhbC5tZXNzYWdlKHsgaWQ6ICdmaW5lcmVwb3J0RXJyb3InLCBzdGF0dXM6ICdlcnJvcicsIG1lc3NhZ2U6ICfojrflj5bluIbova/miqXooajlpLHotKU6IOaegeacieWPr+iDveaYr+i3qOa6kOmXrumimCcsIGR1cmF0aW9uOiA1MDAwIH0pDQogICAgICAgIHJldHVybg0KICAgICAgfQ0KICAgICAgc3dpdGNoIChuYW1lKSB7DQogICAgICAgIGNhc2UgJ2V4Y2VsJzoNCiAgICAgICAgICAvLyDlr7zlh7rkuLpFeGNlbO+8iOagvOW8j+S4uuWOn+agt+i+k+WHuu+8ie+8jEZpbmVSZXBvcnTlhoXnva7mlrnms5UNCiAgICAgICAgICByZXBvcnQuZXhwb3J0UmVwb3J0VG9FeGNlbCgnc2ltcGxlJykNCiAgICAgICAgICBicmVhaw0KICAgICAgICBjYXNlICdwZGYnOg0KICAgICAgICAgIC8vIOWvvOWHuuS4ulBERu+8jEZpbmVSZXBvcnTlhoXnva7mlrnms5UNCiAgICAgICAgICByZXBvcnQuZXhwb3J0UmVwb3J0VG9QREYoKQ0KICAgICAgICAgIGJyZWFrDQogICAgICAgIGNhc2UgJ3dvcmQnOg0KICAgICAgICAgIC8vIOWvvOWHuuS4uldvcmTvvIxGaW5lUmVwb3J05YaF572u5pa55rOVDQogICAgICAgICAgcmVwb3J0LmV4cG9ydFJlcG9ydFRvV29yZCgpDQogICAgICAgICAgYnJlYWsNCiAgICAgICAgY2FzZSAncG5nJzoNCiAgICAgICAgICAvLyDlr7zlh7rkuLrlm77niYfvvIxGaW5lUmVwb3J05YaF572u5pa55rOVDQogICAgICAgICAgcmVwb3J0LmV4cG9ydFJlcG9ydFRvSW1hZ2UoKQ0KICAgICAgICAgIGJyZWFrDQogICAgICB9DQogICAgfQ0KICB9DQoNCn0NCg=="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAuEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA","file":"index.vue","sourceRoot":"src/views/test/FineReportTemplate","sourcesContent":["/**\r\n * @author: chen_huanjie\r\n * @date: 2021.9.16\r\n * @description: 项目嵌套进帆软报表的模板\r\n *              使用帆软报表需要更改iframe标签的src路径\r\n *              报表页面显示和脚本插入能够正常，需要报表解析服务器与本组件同域同源\r\n *              非同源情况下，需要跨域处理，目前这个问题未解决\r\n *              但测试时候，是在finereport设计器内置服务器下测得页面，能够更改原有报表样式\r\n * @version: 1.0.0\r\n **/\r\n<template>\r\n  <div class=\"height-all\">\r\n    <BsMainFormListLayout :left-visible.sync=\"leftVisible\">\r\n      <template v-slot:topTabPane>\r\n        <BsTabPanel\r\n          :show-zero=\"false\"\r\n          is-open\r\n          :tab-status-btn-config=\"tabStatusBtnConfig\"\r\n          :is-hide-query=\"true\"\r\n          @tabClick=\"onTabPaneltabClick\"\r\n          @btnClick=\"onTabPanelBtnClick\"\r\n        />\r\n      </template>\r\n      <!-- leftVisible不为undefined为渲染mainTree和mainForm插槽 ，否则渲染mainCon插槽-->\r\n      <template v-slot:mainTree>\r\n        <div class=\"mmc-left-tree height-all\">\r\n          <div class=\"mmc-left-tree-title\">\r\n            <BsTreeSet\r\n              :tree-config=\"treeConfig\"\r\n              @onAsideChange=\"leftVisible = false\"\r\n              @onChangeInput=\"changeInput\"\r\n            />\r\n          </div>\r\n          <div class=\"mmc-left-tree-body\">\r\n            <BsTree\r\n              ref=\"testTree\"\r\n              open-loading\r\n              :filter-text=\"letftTreeFilterText\"\r\n              :config=\"leftTreeConfig\"\r\n              :tree-data=\"treeData\"\r\n              :queryparams=\"treeQueryparams\"\r\n              @onNodeCheckClick=\"onNodeCheckClick\"\r\n              @onNodeClick=\"onNodeClick\"\r\n            />\r\n          </div>\r\n        </div>\r\n      </template>\r\n      <template v-slot:mainForm>\r\n        <div class=\"finereport finereport__toolbar\">\r\n          <vxe-button type=\"text\" class=\"finereport finereport__title\" content=\"帆软报表\" />\r\n          <vxe-button status=\"primary\" size=\"mini\" icon=\"vxe-icon--refresh\" content=\"刷新\" @click=\"onRefreshClick\" />\r\n          <vxe-button status=\"primary\" size=\"mini\" icon=\"vxe-icon--download\" content=\"导出\" @dropdown-click=\"onExportClick\">\r\n            <template #dropdowns>\r\n              <vxe-button type=\"text\" status=\"success\" icon=\"vxe-icon--menu\" name=\"excel\" content=\"导出为Excel\" />\r\n              <vxe-button type=\"text\" status=\"danger\" icon=\"vxe-icon--menu\" name=\"pdf\" content=\"导出为PDF\" />\r\n              <vxe-button type=\"text\" status=\"primary\" icon=\"vxe-icon--menu\" name=\"word\" content=\"导出为Word\" />\r\n              <vxe-button type=\"text\" status=\"custom-rainbow\" icon=\"vxe-icon--menu\" name=\"png\" content=\"导出为图片\" />\r\n            </template>\r\n          </vxe-button>\r\n        </div>\r\n        <iframe\r\n          id=\"reportFrame\"\r\n          height=\"100%\"\r\n          src=\"http://localhost:8075/webroot/decision/view/report?viewlet=demo%252Fanalytics%252F%25E6%25A8%25AA%25E5%2590%2591%25E6%2589%25A9%25E5%25B1%2595%25E5%2590%258E%25E6%259F%2590%25E5%2588%2597%25E6%2595%25B0%25E6%258D%25AE%25E5%258D%25A0%25E6%25AF%2594.cpt&op=write\"\r\n        ></iframe>\r\n      </template>\r\n    </BsMainFormListLayout>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { myMethods } from '@/views/test/blankTemplate/js/methods.js'\r\nimport mix from '@/mixin/commonMixin.js'\r\n\r\nexport default {\r\n  name: 'FineReportTemplate',\r\n  components: {},\r\n  mixins: [mix],\r\n  props: {\r\n    allPropData: {\r\n      type: Object,\r\n      default() {\r\n        return {}\r\n      }\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      tabStatusBtnConfig: {},\r\n      treeConfig: {},\r\n      leftVisible: true,\r\n      letftTreeFilterText: '',\r\n      leftTreeConfig: {},\r\n      treeData: [],\r\n      treeQueryparams: {}\r\n    }\r\n  },\r\n  computed: {},\r\n  watch: {\r\n    queryFormData: {\r\n      handler(newval) {\r\n        console.log(newval)\r\n      },\r\n      deep: true,\r\n      immediate: true\r\n    }\r\n  },\r\n  created() {\r\n    this.initCreated()\r\n    this.initFineReport()\r\n  },\r\n  mounted() {\r\n    this.initMounted()\r\n  },\r\n  methods: {\r\n    ...myMethods,\r\n    // 初始化帆软报表样式\r\n    initFineReport() {\r\n      const iframe = document.getElementById('reportFrame')\r\n      // 获取iframe内的页面文档对象\r\n      let report = {}\r\n      try {\r\n        report = iframe.contentWindow.document\r\n      } catch {\r\n        this.$XModal.message({ id: 'finereportError', status: 'error', message: '获取帆软报表失败: 极有可能是跨源问题', duration: 5000 })\r\n        return\r\n      }\r\n      // 获取帆软内置的工具栏对象\r\n      const toolbar = report.getElementsByClassName('x-toolbar')[0]\r\n      toolbar.style.display = 'none' // 将默认工具栏隐藏掉\r\n\r\n      // 获取报表容器对象\r\n      const container = report.getElementsByClassName('reportPane')[0]\r\n      container.style.top = '0px' // 去除默认的finereport内置工具栏后，需要将整个报表上移，填充工具栏空白处\r\n\r\n      // 获取单元格对象\r\n      const td = report.getElementsByTagName('td')\r\n      for (let i = 0; i < td.length; i++) {\r\n        td[i].style.background = 'none' // 去除每个单元格的默认背景\r\n        td[i].style.color = 'black' // 统一字体颜色\r\n      }\r\n\r\n      // 获取表格的表头行头像\r\n      const tr = report.getElementsByTagName('tr')\r\n      tr[0].style.backgroundColor = 'rgb(227, 242, 254)' // 将表头背景色配成和外页面相同风格\r\n      // 表格斑马纹\r\n      for (let i = 2; i < tr.length; i = i + 2) {\r\n        tr[i].style.backgroundColor = 'rgb(244, 246, 253)'\r\n      }\r\n    },\r\n    // 刷新\r\n    onRefreshClick() {\r\n\r\n    },\r\n    // 导出\r\n    onExportClick({ name, $event }) {\r\n      const iframe = document.getElementById('reportFrame')\r\n      let report = {}\r\n      try {\r\n        report = iframe.contentWindow.contentPane\r\n      } catch {\r\n        this.$XModal.message({ id: 'finereportError', status: 'error', message: '获取帆软报表失败: 极有可能是跨源问题', duration: 5000 })\r\n        return\r\n      }\r\n      switch (name) {\r\n        case 'excel':\r\n          // 导出为Excel（格式为原样输出），FineReport内置方法\r\n          report.exportReportToExcel('simple')\r\n          break\r\n        case 'pdf':\r\n          // 导出为PDF，FineReport内置方法\r\n          report.exportReportToPDF()\r\n          break\r\n        case 'word':\r\n          // 导出为Word，FineReport内置方法\r\n          report.exportReportToWord()\r\n          break\r\n        case 'png':\r\n          // 导出为图片，FineReport内置方法\r\n          report.exportReportToImage()\r\n          break\r\n      }\r\n    }\r\n  }\r\n\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scope>\r\n  .vxe-button.type--text.theme--custom-rainbow {\r\n    background: linear-gradient(to right, orange,yellow,violet);\r\n    background-clip: text;\r\n    -webkit-text-fill-color: transparent;\r\n    &:hover{\r\n      opacity: 0.75;\r\n    }\r\n  }\r\n  .finereport.finereport__toolbar {\r\n    text-align: center;\r\n  }\r\n  .finereport.finereport__title {\r\n    width: 200px;\r\n    height: 50px;\r\n    background-color: rgb(227, 242, 254);\r\n  }\r\n  #reportFrame {\r\n    border: 1px #eee solid;\r\n  }\r\n</style>\r\n"]}]}