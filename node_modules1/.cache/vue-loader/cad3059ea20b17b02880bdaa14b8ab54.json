{"remainingRequest":"C:\\Users\\何小龙\\Desktop\\platformweb-fb\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\何小龙\\Desktop\\platformweb-fb\\src\\views\\main\\fundMonitoring\\violationHandle\\receSupeMoniInquForm\\receSupeMoniInquFormModal.vue?vue&type=style&index=0&id=5e5aaf46&lang=scss&scoped=true&","dependencies":[{"path":"C:\\Users\\何小龙\\Desktop\\platformweb-fb\\src\\views\\main\\fundMonitoring\\violationHandle\\receSupeMoniInquForm\\receSupeMoniInquFormModal.vue","mtime":1694576524706},{"path":"C:\\Users\\何小龙\\Desktop\\platformweb-fb\\node_modules\\css-loader\\dist\\cjs.js","mtime":1696752946978},{"path":"C:\\Users\\何小龙\\Desktop\\platformweb-fb\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"C:\\Users\\何小龙\\Desktop\\platformweb-fb\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"C:\\Users\\何小龙\\Desktop\\platformweb-fb\\node_modules\\sass-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\何小龙\\Desktop\\platformweb-fb\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\何小龙\\Desktop\\platformweb-fb\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKDQoNCi5UaXRhbnMtZm9ybXsNCiAgL2RlZXAvIC52eGUtdGV4dGFyZWEtLWlubmVyW2Rpc2FibGVkXSB7DQogICAgICBjb2xvcjogIzMzMzsNCiAgICAgIGJhY2tncm91bmQ6ICNmN2ZhZmQ7DQogICAgICBjdXJzb3I6IG5vdC1hbGxvd2VkOw0KICB9DQogIC5mb3JtSXRlbVRpdGxlIHsNCiAgZGlzcGxheTogaW5saW5lLWJsb2NrOw0KICBjb2xvcjogIzQwYWFmZjsNCiAgbWFyZ2luLWJvdHRvbTogNXB4Ow0KICBmb250LXNpemU6IDE2cHg7DQogIGZvbnQtd2VpZ2h0OiBib2xkOw0KfQ0KICAub25lLXJvd3sNCiAgICB3aWR0aDogMTAwJSAhaW1wb3J0YW50Ow0KICAgIC52eGUtZm9ybS0taXRlbS1pbm5lcnsNCiAgICB9DQogIH0NCiAgLnZhbGlkU2hvd1JpZ2h0ew0KICAgIC9kZWVwLyAudnhlLWZvcm0tLWl0ZW0tdmFsaWR7DQogICAgICB0ZXh0LWFsaWduOiByaWdodDsNCiAgICAgIGZvbnQtc2l6ZTogMTZweDsNCiAgICB9DQogIH0NCn0NCg=="},{"version":3,"sources":["receSupeMoniInquFormModal.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0QA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"receSupeMoniInquFormModal.vue","sourceRoot":"src/views/main/fundMonitoring/violationHandle/receSupeMoniInquForm","sourcesContent":["<!--政策法规管理新增页面弹框-->\r\n<template>\r\n  <vxe-modal\r\n    v-model=\"dialogVisible\"\r\n    v-bind=\"modalStaticProperty\"\r\n    @close=\"dialogClose\"\r\n  >\r\n    <vxe-form\r\n      ref=\"businessMsgRef1\"\r\n      class=\"Titans-form\"\r\n      v-bind=\"formStaticProperty\"\r\n      :data=\"createDataList\"\r\n      :rules=\"createValidate\"\r\n    >\r\n      <div class=\"formItemTitle one-row\">疑似违规信息</div>\r\n      <vxe-form-item v-for=\"(item) in createConfig\" :key=\"item.field\" v-bind=\"item\" />\r\n      <div class=\"formItemTitle one-row\">监控部门指导意见</div>\r\n      <vxe-form-item v-for=\"(item) in createConfig2\" :key=\"item.field\" v-bind=\"item\" />\r\n      <vxe-form-item field=\"fileList\" class=\"one-row validShowRight\">\r\n        <BsUploadBak\r\n          ref=\"myUpload\"\r\n          v-bind=\"uploadStaticProperty\"\r\n          :attachment-id=\"createDataList[`attachmentid${budgetlevelFieldNum + 1}`]\"\r\n          :file-data.sync=\"createDataList.fileList\"\r\n        />\r\n      </vxe-form-item>\r\n    </vxe-form>\r\n    <template #footer>\r\n      <el-button v-if=\"showType === 'edit'\" type=\"primary\" @click=\"handleClick\">确定</el-button>\r\n      <el-button @click=\"dialogClose\">取消</el-button>\r\n    </template>\r\n  </vxe-modal>\r\n</template>\r\n<script>\r\nimport { suspectedViolationFormItem, departmentalGuidanceFormItem } from './columns.js'\r\nimport HttpModules from '@/api/frame/main/fundMonitoring/createProcessing.js'\r\nimport moment from 'moment'\r\nimport store from '@/store/index'\r\nimport { mapGetters } from 'vuex'\r\nconst statusMap = {\r\n  '2': 2,\r\n  '5': 7,\r\n  '8': 1,\r\n  '9': 1\r\n}\r\nexport default {\r\n  props: {\r\n    detailData: {\r\n      type: Array,\r\n      default: () => {\r\n        return []\r\n      }\r\n    }\r\n  },\r\n  components: {\r\n  },\r\n  computed: {\r\n    ...mapGetters(['getuserInfo']),\r\n    budgetlevelFieldNum() {\r\n      const LevelFieldMap = { // 2  省级  4 市级   5 县级\r\n        '4': 4,\r\n        '2': 4,\r\n        '5': 5\r\n      }\r\n      return LevelFieldMap[this.getuserInfo.budgetlevelcode]\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      dialogVisible: false,\r\n      showType: '',\r\n      modalStaticProperty: {\r\n        title: '监控问询单信息',\r\n        width: '96%',\r\n        height: '80%',\r\n        position: 'center',\r\n        minWidth: '900',\r\n        showFooter: true\r\n      },\r\n      formStaticProperty: {\r\n        titleWidth: '180',\r\n        titleAlign: 'right',\r\n        class: 'orderAddClass'// 这儿可以额外添加class\r\n      },\r\n      uploadStaticProperty: {\r\n        disabled: false,\r\n        allowDelete: true,\r\n        allowDownload: true,\r\n        allowPreview: true,\r\n        isUpload: true\r\n      },\r\n      fileList: [],\r\n      fileData: [],\r\n      fileDataBakDel: [],\r\n      createConfig: suspectedViolationFormItem(this),\r\n      createConfig2: [],\r\n      createDataList: {\r\n        violateType: '',\r\n        fiRuleName: '',\r\n        warnLevel: '',\r\n        handleType: '',\r\n        mofDivCode: '',\r\n        doubtViolateExplain: '',\r\n        commentDept: '',\r\n        // ---市/省 级-- start\r\n        phone4: '',\r\n        handler4: '',\r\n        updateTime4: '',\r\n        information4: '',\r\n        attachmentid5: '',\r\n        // ---end\r\n        // 县级--start\r\n        phone5: '',\r\n        handler5: '',\r\n        updateTime5: '',\r\n        information5: '',\r\n        attachmentid6: '',\r\n        // ---end\r\n        fileList: []\r\n      },\r\n      createValidate: {\r\n        commentDept: [\r\n          { required: true, message: '请选择指导意见', trigger: 'change' }\r\n        ]\r\n        // fileList: [\r\n        //   { required: true, message: '请上传附件', type: 'array', min: 1, trigger: 'change' }\r\n        // ]\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    pickObjectField (obj = {}, field) {\r\n      let newObj = {}\r\n      Object.keys(obj).map(item => {\r\n        if (field.includes(item)) {\r\n          newObj[item] = obj[item]\r\n        }\r\n      })\r\n      return newObj\r\n    },\r\n    logSlot() {\r\n      console.log(777, ...arguments)\r\n    },\r\n    init() {\r\n      this.createConfig = suspectedViolationFormItem(this)\r\n      this.createConfig2 = departmentalGuidanceFormItem(this)\r\n      if (this.showType === 'edit') {\r\n        let pickField = Object.keys(this.createDataList).filter(item => { return item.field !== 'commentDept' })\r\n        this.createDataList = this.pickObjectField(this.detailData[0], pickField)\r\n        this.createDataList[`attachmentid${this.budgetlevelFieldNum + 1}`] = this.$ToolFn.utilFn.getUuid()// 初始化赋予uuid\r\n        this.createDataList[`updateTime${this.budgetlevelFieldNum}`] = moment().format('YYYY-MM-DD HH:mm:ss')\r\n        this.createDataList[`phone${this.budgetlevelFieldNum}`] = store.getters.getuserInfo.phonenumber\r\n        this.createDataList[`handler${this.budgetlevelFieldNum}`] = store.getters.getuserInfo.name\r\n        this.uploadStaticProperty.disabled = false\r\n        this.uploadStaticProperty.allowDelete = true\r\n      } else if (this.showType === 'detail') {\r\n        let pickField = Object.keys(this.createDataList)\r\n        this.createDataList = this.pickObjectField(this.detailData[0], pickField)\r\n        this.uploadStaticProperty.disabled = true\r\n        this.uploadStaticProperty.allowDelete = false\r\n        if (this.createDataList[`attachmentid${this.budgetlevelFieldNum + 1}`]) {\r\n          this.getFileList()\r\n        }\r\n      }\r\n      this.getViolationType()\r\n    },\r\n    getFileList() {\r\n      const param = {\r\n        billguid: this.createDataList[`attachmentid${this.budgetlevelFieldNum + 1}`],\r\n        year: this.$store.state.userInfo.year,\r\n        province: this.$store.state.userInfo.province\r\n      }\r\n      HttpModules.getFile(param).then(res => {\r\n        if (res.rscode === '100000') {\r\n          // 获取附件信息\r\n          this.$set(this.createDataList, 'fileList', JSON.parse(res.data))\r\n          // this.createDataList.fileList = JSON.parse(res.data)\r\n        } else {\r\n          this.$message.error(res.result)\r\n        }\r\n      })\r\n    },\r\n    getViolationType() { // 初始化疑似整改信息option\r\n      let params = {\r\n        page: 1,\r\n        size: 99999\r\n      }\r\n      HttpModules.queryViolationType(params).then(res => {\r\n        if (res.code === '000000') {\r\n          res.data.results.map(v => {\r\n            v.value = v.name\r\n            v.label = v.name\r\n          })\r\n          let config = this.createConfig\r\n          for (let i = 0; i < config.length; i++) {\r\n            const element = config[i]\r\n            if (element.field === 'violateType') {\r\n              config[i].itemRender.options = res.data.results\r\n            }\r\n          }\r\n        }\r\n      })\r\n    },\r\n    dialogClose() {\r\n      this.dialogVisible = false\r\n      this.$emit('closeModal')\r\n    },\r\n    async handleClick() {\r\n      try {\r\n        let valid = await this.$refs.businessMsgRef1?.validate()\r\n        if (valid !== undefined) return undefined\r\n        let param = {\r\n          ...this.createDataList,\r\n          dealNo: this.detailData[0].dealNo\r\n          // regulationClass: transJson(this.$store.state.curNavModule.param5)?.regulationClass\r\n        }\r\n        param.status = statusMap[param.commentDept]\r\n        HttpModules.handleFeedbackForDeal(param).then(res => {\r\n          if (res.code === '000000') {\r\n            this.$message.success('操作成功')\r\n            // this.dialogVisible = false\r\n            this.dialogClose()\r\n          } else {\r\n            this.$message.error(res.message)\r\n          }\r\n        })\r\n      } catch (error) {\r\n        console.log('校验错误信息list', error)\r\n      }\r\n    }\r\n  },\r\n  watch: {\r\n    dialogVisible() {\r\n      this.$refs.businessMsgRef1?.clearValidate()\r\n      this.createDataList = {\r\n        violateType: '',\r\n        fiRuleName: '',\r\n        warnLevel: '',\r\n        handleType: '',\r\n        mofDivCode: '',\r\n        doubtViolateExplain: '',\r\n        commentDept: '',\r\n        // ---市/省 级-- start\r\n        phone4: '',\r\n        handler4: '',\r\n        updateTime4: '',\r\n        information4: '',\r\n        attachmentid5: '',\r\n        // ---end\r\n        // 县级--start\r\n        phone5: '',\r\n        handler5: '',\r\n        updateTime5: '',\r\n        information5: '',\r\n        attachmentid6: '',\r\n        // ---end\r\n        fileList: []\r\n      }\r\n      this.init()\r\n    }\r\n  },\r\n  created() {}\r\n}\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n\r\n.Titans-form{\r\n  /deep/ .vxe-textarea--inner[disabled] {\r\n      color: #333;\r\n      background: #f7fafd;\r\n      cursor: not-allowed;\r\n  }\r\n  .formItemTitle {\r\n  display: inline-block;\r\n  color: #40aaff;\r\n  margin-bottom: 5px;\r\n  font-size: 16px;\r\n  font-weight: bold;\r\n}\r\n  .one-row{\r\n    width: 100% !important;\r\n    .vxe-form--item-inner{\r\n    }\r\n  }\r\n  .validShowRight{\r\n    /deep/ .vxe-form--item-valid{\r\n      text-align: right;\r\n      font-size: 16px;\r\n    }\r\n  }\r\n}\r\n</style>\r\n"]}]}