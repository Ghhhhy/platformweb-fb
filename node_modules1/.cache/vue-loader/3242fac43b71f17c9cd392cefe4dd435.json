{"remainingRequest":"C:\\Users\\何小龙\\Desktop\\platformweb-fb\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\何小龙\\Desktop\\platformweb-fb\\src\\views\\main\\statisticAnalysis\\common\\components\\PreviewDetail.vue?vue&type=style&index=0&id=25ca7f05&lang=scss&scoped=true&","dependencies":[{"path":"C:\\Users\\何小龙\\Desktop\\platformweb-fb\\src\\views\\main\\statisticAnalysis\\common\\components\\PreviewDetail.vue","mtime":1695716045791},{"path":"C:\\Users\\何小龙\\Desktop\\platformweb-fb\\node_modules\\css-loader\\dist\\cjs.js","mtime":1696752946978},{"path":"C:\\Users\\何小龙\\Desktop\\platformweb-fb\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"C:\\Users\\何小龙\\Desktop\\platformweb-fb\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"C:\\Users\\何小龙\\Desktop\\platformweb-fb\\node_modules\\sass-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\何小龙\\Desktop\\platformweb-fb\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\何小龙\\Desktop\\platformweb-fb\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCg0KLlByZXZpZXdEZXRhaWx7DQogIC9kZWVwLyAudnhlLXBhZ2VyLS10b3RhbHsNCiAgICBkaXNwbGF5OiBub25lOw0KICB9DQp9DQo="},{"version":3,"sources":["PreviewDetail.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwPA;AACA;AACA;AACA;AACA","file":"PreviewDetail.vue","sourceRoot":"src/views/main/statisticAnalysis/common/components","sourcesContent":["<template>\r\n  <vxe-modal\r\n    v-model=\"visible\"\r\n    :destroy-on-close=\"true\"\r\n    title=\"查看详情\"\r\n    class=\"PreviewDetail\"\r\n    width=\"90%\"\r\n    height=\"90%\"\r\n    resize\r\n    show-footer\r\n  >\r\n    <template #footer>\r\n      <!--查看-->\r\n      <el-button size=\"small\" @click=\"visible = false\">关闭</el-button>\r\n    </template>\r\n    <div style=\"height: calc(100% - 4px)\">\r\n      <div style=\"height: 100%\">\r\n        <BsTable\r\n          :loading=\"tableLoadingState\"\r\n          :table-config=\"tableConfig\"\r\n          :table-columns-config=\"columns\"\r\n          :table-data=\"tableData\"\r\n          :footer-config=\"footerConfig\"\r\n          :toolbar-config=\"tableToolbarConfig\"\r\n          :pager-config=\"pagerConfig\"\r\n          size=\"medium\"\r\n          :cell-class-name=\"cellCursorUnderlineClassName\"\r\n          @register=\"registerTable\"\r\n          @ajaxData=\"pagerChange\"\r\n          @onToolbarBtnClick=\"onToolbarBtnClick\"\r\n          @cellDblclick=\"cellDblclick\"\r\n          @cellClick=\"cellClick\"\r\n        >\r\n          <template v-slot:toolbarSlots>\r\n            <bs-table-title title=\"按规则查看\" />\r\n          </template>\r\n        </BsTable>\r\n      </div>\r\n    </div>\r\n    <HandlingOfViolationsModal\r\n      v-if=\"handlingOfViolationsModel\"\r\n      v-model=\"handlingOfViolationsModel\"\r\n      :current-row=\"detailCurrentRow\"\r\n      v-on=\"$listeners\"\r\n    />\r\n  </vxe-modal>\r\n</template>\r\n\r\n<script>\r\nimport { defineComponent, ref, unref, provide, inject } from '@vue/composition-api'\r\nimport HandlingOfViolationsModal from '../components/HandlingOfViolationsModal'\r\nimport useTable from '@/hooks/useTable'\r\nimport { useModal, useModalInner } from '@/hooks/useModal/index'\r\nimport { getWarnCountColumns, cellCursorUnderlineClassName } from '@/views/main/statisticAnalysis/common/model/data.js'\r\nimport {\r\n  getRuleNameColumn,\r\n  getIsDirColumn,\r\n  getAgencyNameColumn,\r\n  getWarnLevelColumn,\r\n  getControlTypeColumn,\r\n  getWarnTypeColumn,\r\n  getMofDivCodeColumn\r\n} from '@/views/main/handlingOfViolations/model/data.js'\r\nimport { queryRuleData } from '@/api/frame/main/statisticAnalysis/rulesStatistic.js'\r\nimport { queryDepData } from '@/api/frame/main/statisticAnalysis/unitStatistic.js'\r\nimport { RouterPathEnum } from '../model/enum'\r\nimport { useFooter } from '../hooks/useFooter'\r\nimport { transJson1, transJson3 } from '@/utils/params.js'\r\nimport store from '@/store'\r\n\r\nconst model = {\r\n  prop: 'value',\r\n  event: 'changePreviewDetailVisible'\r\n}\r\nexport default defineComponent({\r\n  components: {\r\n    HandlingOfViolationsModal\r\n  },\r\n  props: {\r\n    // 显隐\r\n    [model.prop]: {\r\n      type: Boolean,\r\n      default: false\r\n    },\r\n    queryData: {\r\n      type: Object,\r\n      default: () => {\r\n        return {}\r\n      }\r\n    },\r\n    // 勾选行\r\n    currentRow: {\r\n      type: Object,\r\n      default: () => ({})\r\n    }\r\n  },\r\n  model,\r\n  setup(props, { emit }) {\r\n    let type = ''\r\n    /**\r\n     * 弹窗内部状态\r\n     * */\r\n    const { queryData } = props\r\n    const { visible } = useModalInner(props, emit, model)\r\n\r\n    // 处理单查看弹窗\r\n    const [handlingOfViolationsModel, changeHOVModelVisible] = useModal()\r\n\r\n    // 页面路由\r\n    const pagePath = inject('pagePath')\r\n    // 根组件方法 loadBsConfig(动态表格配置请求方法)\r\n    const loadBsConfig = inject('loadBsConfig')\r\n    provide('loadBsConfig', loadBsConfig)\r\n    // 详情双击行\r\n    const detailCurrentRow = ref(null)\r\n\r\n    const differentColumns = [\r\n      getAgencyNameColumn(),\r\n      getMofDivCodeColumn(),\r\n      getRuleNameColumn({\r\n        title: '规则名称',\r\n        width: 140\r\n      })\r\n    ]\r\n\r\n    const { footerConfig } = useFooter()\r\n    /**\r\n     * 动态表格配置\r\n     * */\r\n    let columnsSS = ref([])\r\n    async function loadConfig(id) {\r\n      let params = {\r\n        tableId: {\r\n          id: id,\r\n          fiscalyear: store.state.userInfo.year,\r\n          mof_div_code: store.state.userInfo.province,\r\n          menuguid: store.state.curNavModule.guid\r\n        }\r\n      }\r\n      let configData = await loadBsConfig(params)\r\n      return configData.itemsConfig\r\n    }\r\n    /**\r\n     *判断使用本地配置||动态配置\r\n     * */\r\n    if (transJson3(store.state.curNavModule.param5) && transJson3(store.state.curNavModule.param5).isConfigTable === '1') {\r\n      loadConfig('Table201').then(res => {\r\n        columnsSS.value = res\r\n      })\r\n    } else {\r\n      columnsSS.value = [\r\n        ...(unref(pagePath) === RouterPathEnum.RULE_STATISTIC ? differentColumns : differentColumns.reverse()),\r\n        getWarnLevelColumn(),\r\n        getControlTypeColumn(),\r\n        getWarnTypeColumn(),\r\n        ...getWarnCountColumns(),\r\n        getIsDirColumn()\r\n      ]\r\n    }\r\n    /**\r\n     * 表格\r\n     * */\r\n    const [\r\n      {\r\n        columns,\r\n        tableToolbarConfig,\r\n        tableConfig,\r\n        tableData,\r\n        resetFetchTableData,\r\n        tableLoadingState,\r\n        pagerChange,\r\n        pagerConfig,\r\n        onToolbarBtnClick\r\n      },\r\n      registerTable\r\n    ] = useTable({\r\n      fetch: unref(pagePath) === RouterPathEnum.UNIT_STATISTIC ? queryDepData : queryRuleData,\r\n      beforeFetch: params => {\r\n        const { fiRuleCodes, agencyCode } = props.currentRow\r\n        const property = unref(pagePath) === RouterPathEnum.UNIT_STATISTIC ? 'agencyCode' : 'fiRuleCodes'\r\n        const value = unref(pagePath) === RouterPathEnum.UNIT_STATISTIC ? agencyCode : fiRuleCodes\r\n        return {\r\n          ...params,\r\n          paramCode: transJson1(store.state.curNavModule.param5 || '')?.paramCode,\r\n          isFilterByPerm: transJson1(store.state.curNavModule.param5 || '')?.isFilterByPerm,\r\n          fiRuleName: props.currentRow.ruleName,\r\n          ...queryData,\r\n          [property]: value\r\n        }\r\n      },\r\n      finallyFetch: data => {\r\n        footerConfig.value.totalObj = data?.warnHJVO || {}\r\n      },\r\n      columns: columnsSS,\r\n      dataKey: 'data.results'\r\n    })\r\n    /**\r\n     * 双击单元格\r\n     * */\r\n    // function cellDblclick(a, b, e) {\r\n    function cellDblclick({ row }) {\r\n      // detailCurrentRow.value = row\r\n      // // console.log('log-------', a, b, e)\r\n      // changeHOVModelVisible(true)\r\n    }\r\n    function cellClick(obj, context, e) {\r\n      let key = obj.column.property\r\n      if (key === 'onWay') {\r\n        this.type = '3'\r\n      } else if (key === 'prohibit') {\r\n        this.type = '2'\r\n      } else if (key === 'release') {\r\n        this.type = '1'\r\n      } else {\r\n        this.type = ''\r\n      }\r\n      obj.row.type = this.type\r\n      detailCurrentRow.value = obj.row\r\n      console.log('---------------', obj.row.type)\r\n      console.log('---------------', obj.row)\r\n      changeHOVModelVisible(true)\r\n    }\r\n\r\n    return {\r\n      visible,\r\n      handlingOfViolationsModel,\r\n      detailCurrentRow,\r\n      type,\r\n      cellCursorUnderlineClassName,\r\n      cellDblclick,\r\n      cellClick,\r\n      footerConfig,\r\n      columns,\r\n      registerTable,\r\n      tableConfig,\r\n      tableData,\r\n      tableLoadingState,\r\n      pagerConfig,\r\n      tableToolbarConfig,\r\n      onToolbarBtnClick,\r\n      pagerChange,\r\n      resetFetchTableData\r\n    }\r\n  }\r\n})\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.PreviewDetail{\r\n  /deep/ .vxe-pager--total{\r\n    display: none;\r\n  }\r\n}\r\n</style>\r\n"]}]}