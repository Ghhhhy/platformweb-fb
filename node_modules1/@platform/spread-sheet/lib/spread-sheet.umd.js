(function webpackUniversalModuleDefinition(root, factory) {
	if(typeof exports === 'object' && typeof module === 'object')
		module.exports = factory();
	else if(typeof define === 'function' && define.amd)
		define([], factory);
	else if(typeof exports === 'object')
		exports["spread-sheet"] = factory();
	else
		root["spread-sheet"] = factory();
})((typeof self !== 'undefined' ? self : this), function() {
return /******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, { enumerable: true, get: getter });
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = function(exports) {
/******/ 		if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 			Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 		}
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/
/******/ 	// create a fake namespace object
/******/ 	// mode & 1: value is a module id, require it
/******/ 	// mode & 2: merge all properties of value into the ns
/******/ 	// mode & 4: return value when already ns object
/******/ 	// mode & 8|1: behave like require
/******/ 	__webpack_require__.t = function(value, mode) {
/******/ 		if(mode & 1) value = __webpack_require__(value);
/******/ 		if(mode & 8) return value;
/******/ 		if((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;
/******/ 		var ns = Object.create(null);
/******/ 		__webpack_require__.r(ns);
/******/ 		Object.defineProperty(ns, 'default', { enumerable: true, value: value });
/******/ 		if(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));
/******/ 		return ns;
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = "fb15");
/******/ })
/************************************************************************/
/******/ ({

/***/ "00b4":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

// TODO: Remove from `core-js@4` since it's moved to entry points
__webpack_require__("ac1f");
var $ = __webpack_require__("23e7");
var global = __webpack_require__("da84");
var call = __webpack_require__("c65b");
var uncurryThis = __webpack_require__("e330");
var isCallable = __webpack_require__("1626");
var isObject = __webpack_require__("861d");

var DELEGATES_TO_EXEC = function () {
  var execCalled = false;
  var re = /[ac]/;
  re.exec = function () {
    execCalled = true;
    return /./.exec.apply(this, arguments);
  };
  return re.test('abc') === true && execCalled;
}();

var Error = global.Error;
var un$Test = uncurryThis(/./.test);

// `RegExp.prototype.test` method
// https://tc39.es/ecma262/#sec-regexp.prototype.test
$({ target: 'RegExp', proto: true, forced: !DELEGATES_TO_EXEC }, {
  test: function (str) {
    var exec = this.exec;
    if (!isCallable(exec)) return un$Test(this, str);
    var result = call(exec, this, str);
    if (result !== null && !isObject(result)) {
      throw new Error('RegExp exec method returned something other than an Object or null');
    }
    return !!result;
  }
});


/***/ }),

/***/ "00ee":
/***/ (function(module, exports, __webpack_require__) {

var wellKnownSymbol = __webpack_require__("b622");

var TO_STRING_TAG = wellKnownSymbol('toStringTag');
var test = {};

test[TO_STRING_TAG] = 'z';

module.exports = String(test) === '[object z]';


/***/ }),

/***/ "0195":
/***/ (function(module, exports, __webpack_require__) {

// Imports
var ___CSS_LOADER_API_IMPORT___ = __webpack_require__("24fb");
var ___CSS_LOADER_GET_URL_IMPORT___ = __webpack_require__("1de5");
var ___CSS_LOADER_URL_IMPORT_0___ = __webpack_require__("9b33");
var ___CSS_LOADER_URL_IMPORT_1___ = __webpack_require__("43d7");
var ___CSS_LOADER_URL_IMPORT_2___ = __webpack_require__("ca40");
exports = ___CSS_LOADER_API_IMPORT___(false);
var ___CSS_LOADER_URL_REPLACEMENT_0___ = ___CSS_LOADER_GET_URL_IMPORT___(___CSS_LOADER_URL_IMPORT_0___);
var ___CSS_LOADER_URL_REPLACEMENT_1___ = ___CSS_LOADER_GET_URL_IMPORT___(___CSS_LOADER_URL_IMPORT_1___);
var ___CSS_LOADER_URL_REPLACEMENT_2___ = ___CSS_LOADER_GET_URL_IMPORT___(___CSS_LOADER_URL_IMPORT_2___);
// Module
exports.push([module.i, "@font-face{font-family:spread-sheet;src:url(" + ___CSS_LOADER_URL_REPLACEMENT_0___ + ") format(\"woff2\"),url(" + ___CSS_LOADER_URL_REPLACEMENT_1___ + ") format(\"woff\"),url(" + ___CSS_LOADER_URL_REPLACEMENT_2___ + ") format(\"truetype\")}.spread-sheet{font-family:spread-sheet!important;font-size:16px;font-style:normal;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.icon-open-tree:before{content:\"\\e60b\"}.icon-close-tree:before{content:\"\\e60c\"}.icon-dongtaishujuqu:before{content:\"\\e610\"}.icon-shujuqu:before{content:\"\\e60e\"}.icon-baobiaowei:before{content:\"\\e60f\"}.icon-baobiaotou:before{content:\"\\e611\"}.icon-bold:before{content:\"\\e61e\"}.icon-underline:before{content:\"\\e628\"}.icon-strike:before{content:\"\\e655\"}.icon-italic:before{content:\"\\e627\"}.icon-slash:before{content:\"\\e7fd\"}.icon-lookUp:before{content:\"\\e6ac\"}.icon-error:before{content:\"\\e602\"}.icon-info:before{content:\"\\e675\"}.icon-select:before{content:\"\\e63c\"}.icon-function:before{content:\"\\e90e\"}.icon-confirm:before{content:\"\\e619\"}.icon-cancel:before{content:\"\\e61a\"}", ""]);
// Exports
module.exports = exports;


/***/ }),

/***/ "0366":
/***/ (function(module, exports, __webpack_require__) {

var uncurryThis = __webpack_require__("e330");
var aCallable = __webpack_require__("59ed");

var bind = uncurryThis(uncurryThis.bind);

// optional / simple context binding
module.exports = function (fn, that) {
  aCallable(fn);
  return that === undefined ? fn : bind ? bind(fn, that) : function (/* ...args */) {
    return fn.apply(that, arguments);
  };
};


/***/ }),

/***/ "04d1":
/***/ (function(module, exports, __webpack_require__) {

var userAgent = __webpack_require__("342f");

var firefox = userAgent.match(/firefox\/(\d+)/i);

module.exports = !!firefox && +firefox[1];


/***/ }),

/***/ "0538":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var global = __webpack_require__("da84");
var uncurryThis = __webpack_require__("e330");
var aCallable = __webpack_require__("59ed");
var isObject = __webpack_require__("861d");
var hasOwn = __webpack_require__("1a2d");
var arraySlice = __webpack_require__("f36a");

var Function = global.Function;
var concat = uncurryThis([].concat);
var join = uncurryThis([].join);
var factories = {};

var construct = function (C, argsLength, args) {
  if (!hasOwn(factories, argsLength)) {
    for (var list = [], i = 0; i < argsLength; i++) list[i] = 'a[' + i + ']';
    factories[argsLength] = Function('C,a', 'return new C(' + join(list, ',') + ')');
  } return factories[argsLength](C, args);
};

// `Function.prototype.bind` method implementation
// https://tc39.es/ecma262/#sec-function.prototype.bind
module.exports = Function.bind || function bind(that /* , ...args */) {
  var F = aCallable(this);
  var Prototype = F.prototype;
  var partArgs = arraySlice(arguments, 1);
  var boundFunction = function bound(/* args... */) {
    var args = concat(partArgs, arraySlice(arguments));
    return this instanceof boundFunction ? construct(F, args.length, args) : F.apply(that, args);
  };
  if (isObject(Prototype)) boundFunction.prototype = Prototype;
  return boundFunction;
};


/***/ }),

/***/ "057f":
/***/ (function(module, exports, __webpack_require__) {

/* eslint-disable es/no-object-getownpropertynames -- safe */
var classof = __webpack_require__("c6b6");
var toIndexedObject = __webpack_require__("fc6a");
var $getOwnPropertyNames = __webpack_require__("241c").f;
var arraySlice = __webpack_require__("f36a");

var windowNames = typeof window == 'object' && window && Object.getOwnPropertyNames
  ? Object.getOwnPropertyNames(window) : [];

var getWindowNames = function (it) {
  try {
    return $getOwnPropertyNames(it);
  } catch (error) {
    return arraySlice(windowNames);
  }
};

// fallback for IE11 buggy Object.getOwnPropertyNames with iframe and window
module.exports.f = function getOwnPropertyNames(it) {
  return windowNames && classof(it) == 'Window'
    ? getWindowNames(it)
    : $getOwnPropertyNames(toIndexedObject(it));
};


/***/ }),

/***/ "06cf":
/***/ (function(module, exports, __webpack_require__) {

var DESCRIPTORS = __webpack_require__("83ab");
var call = __webpack_require__("c65b");
var propertyIsEnumerableModule = __webpack_require__("d1e7");
var createPropertyDescriptor = __webpack_require__("5c6c");
var toIndexedObject = __webpack_require__("fc6a");
var toPropertyKey = __webpack_require__("a04b");
var hasOwn = __webpack_require__("1a2d");
var IE8_DOM_DEFINE = __webpack_require__("0cfb");

// eslint-disable-next-line es/no-object-getownpropertydescriptor -- safe
var $getOwnPropertyDescriptor = Object.getOwnPropertyDescriptor;

// `Object.getOwnPropertyDescriptor` method
// https://tc39.es/ecma262/#sec-object.getownpropertydescriptor
exports.f = DESCRIPTORS ? $getOwnPropertyDescriptor : function getOwnPropertyDescriptor(O, P) {
  O = toIndexedObject(O);
  P = toPropertyKey(P);
  if (IE8_DOM_DEFINE) try {
    return $getOwnPropertyDescriptor(O, P);
  } catch (error) { /* empty */ }
  if (hasOwn(O, P)) return createPropertyDescriptor(!call(propertyIsEnumerableModule.f, O, P), O[P]);
};


/***/ }),

/***/ "07ac":
/***/ (function(module, exports, __webpack_require__) {

var $ = __webpack_require__("23e7");
var $values = __webpack_require__("6f53").values;

// `Object.values` method
// https://tc39.es/ecma262/#sec-object.values
$({ target: 'Object', stat: true }, {
  values: function values(O) {
    return $values(O);
  }
});


/***/ }),

/***/ "07fa":
/***/ (function(module, exports, __webpack_require__) {

var toLength = __webpack_require__("50c4");

// `LengthOfArrayLike` abstract operation
// https://tc39.es/ecma262/#sec-lengthofarraylike
module.exports = function (obj) {
  return toLength(obj.length);
};


/***/ }),

/***/ "0b25":
/***/ (function(module, exports, __webpack_require__) {

var global = __webpack_require__("da84");
var toIntegerOrInfinity = __webpack_require__("5926");
var toLength = __webpack_require__("50c4");

var RangeError = global.RangeError;

// `ToIndex` abstract operation
// https://tc39.es/ecma262/#sec-toindex
module.exports = function (it) {
  if (it === undefined) return 0;
  var number = toIntegerOrInfinity(it);
  var length = toLength(number);
  if (number !== length) throw RangeError('Wrong length or index');
  return length;
};


/***/ }),

/***/ "0b42":
/***/ (function(module, exports, __webpack_require__) {

var global = __webpack_require__("da84");
var isArray = __webpack_require__("e8b5");
var isConstructor = __webpack_require__("68ee");
var isObject = __webpack_require__("861d");
var wellKnownSymbol = __webpack_require__("b622");

var SPECIES = wellKnownSymbol('species');
var Array = global.Array;

// a part of `ArraySpeciesCreate` abstract operation
// https://tc39.es/ecma262/#sec-arrayspeciescreate
module.exports = function (originalArray) {
  var C;
  if (isArray(originalArray)) {
    C = originalArray.constructor;
    // cross-realm fallback
    if (isConstructor(C) && (C === Array || isArray(C.prototype))) C = undefined;
    else if (isObject(C)) {
      C = C[SPECIES];
      if (C === null) C = undefined;
    }
  } return C === undefined ? Array : C;
};


/***/ }),

/***/ "0cb2":
/***/ (function(module, exports, __webpack_require__) {

var uncurryThis = __webpack_require__("e330");
var toObject = __webpack_require__("7b0b");

var floor = Math.floor;
var charAt = uncurryThis(''.charAt);
var replace = uncurryThis(''.replace);
var stringSlice = uncurryThis(''.slice);
var SUBSTITUTION_SYMBOLS = /\$([$&'`]|\d{1,2}|<[^>]*>)/g;
var SUBSTITUTION_SYMBOLS_NO_NAMED = /\$([$&'`]|\d{1,2})/g;

// `GetSubstitution` abstract operation
// https://tc39.es/ecma262/#sec-getsubstitution
module.exports = function (matched, str, position, captures, namedCaptures, replacement) {
  var tailPos = position + matched.length;
  var m = captures.length;
  var symbols = SUBSTITUTION_SYMBOLS_NO_NAMED;
  if (namedCaptures !== undefined) {
    namedCaptures = toObject(namedCaptures);
    symbols = SUBSTITUTION_SYMBOLS;
  }
  return replace(replacement, symbols, function (match, ch) {
    var capture;
    switch (charAt(ch, 0)) {
      case '$': return '$';
      case '&': return matched;
      case '`': return stringSlice(str, 0, position);
      case "'": return stringSlice(str, tailPos);
      case '<':
        capture = namedCaptures[stringSlice(ch, 1, -1)];
        break;
      default: // \d\d?
        var n = +ch;
        if (n === 0) return match;
        if (n > m) {
          var f = floor(n / 10);
          if (f === 0) return match;
          if (f <= m) return captures[f - 1] === undefined ? charAt(ch, 1) : captures[f - 1] + charAt(ch, 1);
          return match;
        }
        capture = captures[n - 1];
    }
    return capture === undefined ? '' : capture;
  });
};


/***/ }),

/***/ "0cfb":
/***/ (function(module, exports, __webpack_require__) {

var DESCRIPTORS = __webpack_require__("83ab");
var fails = __webpack_require__("d039");
var createElement = __webpack_require__("cc12");

// Thank's IE8 for his funny defineProperty
module.exports = !DESCRIPTORS && !fails(function () {
  // eslint-disable-next-line es/no-object-defineproperty -- requied for testing
  return Object.defineProperty(createElement('div'), 'a', {
    get: function () { return 7; }
  }).a != 7;
});


/***/ }),

/***/ "0d51":
/***/ (function(module, exports, __webpack_require__) {

var global = __webpack_require__("da84");

var String = global.String;

module.exports = function (argument) {
  try {
    return String(argument);
  } catch (error) {
    return 'Object';
  }
};


/***/ }),

/***/ "0e39":
/***/ (function(module, exports, __webpack_require__) {

// Imports
var ___CSS_LOADER_API_IMPORT___ = __webpack_require__("24fb");
exports = ___CSS_LOADER_API_IMPORT___(false);
// Module
exports.push([module.i, ".table-content[data-v-03bc0e3c]{pointer-events:none;overflow:hidden}.table-content[data-v-03bc0e3c],.table-content .table-item[data-v-03bc0e3c]{position:absolute}.table-content .table-item img[data-v-03bc0e3c]{height:100%;width:100%}", ""]);
// Exports
module.exports = exports;


/***/ }),

/***/ "107c":
/***/ (function(module, exports, __webpack_require__) {

var fails = __webpack_require__("d039");
var global = __webpack_require__("da84");

// babel-minify and Closure Compiler transpiles RegExp('(?<a>b)', 'g') -> /(?<a>b)/g and it causes SyntaxError
var $RegExp = global.RegExp;

module.exports = fails(function () {
  var re = $RegExp('(?<a>b)', 'g');
  return re.exec('b').groups.a !== 'b' ||
    'b'.replace(re, '$<a>c') !== 'bc';
});


/***/ }),

/***/ "10dc":
/***/ (function(module, exports, __webpack_require__) {

// style-loader: Adds some css to the DOM by adding a <style> tag

// load the styles
var content = __webpack_require__("6184");
if(content.__esModule) content = content.default;
if(typeof content === 'string') content = [[module.i, content, '']];
if(content.locals) module.exports = content.locals;
// add the styles to the DOM
var add = __webpack_require__("499e").default
var update = add("c1d7e296", content, true, {"sourceMap":false,"shadowMode":false});

/***/ }),

/***/ "1148":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var global = __webpack_require__("da84");
var toIntegerOrInfinity = __webpack_require__("5926");
var toString = __webpack_require__("577e");
var requireObjectCoercible = __webpack_require__("1d80");

var RangeError = global.RangeError;

// `String.prototype.repeat` method implementation
// https://tc39.es/ecma262/#sec-string.prototype.repeat
module.exports = function repeat(count) {
  var str = toString(requireObjectCoercible(this));
  var result = '';
  var n = toIntegerOrInfinity(count);
  if (n < 0 || n == Infinity) throw RangeError('Wrong number of repetitions');
  for (;n > 0; (n >>>= 1) && (str += str)) if (n & 1) result += str;
  return result;
};


/***/ }),

/***/ "1276":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var apply = __webpack_require__("2ba4");
var call = __webpack_require__("c65b");
var uncurryThis = __webpack_require__("e330");
var fixRegExpWellKnownSymbolLogic = __webpack_require__("d784");
var isRegExp = __webpack_require__("44e7");
var anObject = __webpack_require__("825a");
var requireObjectCoercible = __webpack_require__("1d80");
var speciesConstructor = __webpack_require__("4840");
var advanceStringIndex = __webpack_require__("8aa5");
var toLength = __webpack_require__("50c4");
var toString = __webpack_require__("577e");
var getMethod = __webpack_require__("dc4a");
var arraySlice = __webpack_require__("f36a");
var callRegExpExec = __webpack_require__("14c3");
var regexpExec = __webpack_require__("9263");
var stickyHelpers = __webpack_require__("9f7f");
var fails = __webpack_require__("d039");

var UNSUPPORTED_Y = stickyHelpers.UNSUPPORTED_Y;
var MAX_UINT32 = 0xFFFFFFFF;
var min = Math.min;
var $push = [].push;
var exec = uncurryThis(/./.exec);
var push = uncurryThis($push);
var stringSlice = uncurryThis(''.slice);

// Chrome 51 has a buggy "split" implementation when RegExp#exec !== nativeExec
// Weex JS has frozen built-in prototypes, so use try / catch wrapper
var SPLIT_WORKS_WITH_OVERWRITTEN_EXEC = !fails(function () {
  // eslint-disable-next-line regexp/no-empty-group -- required for testing
  var re = /(?:)/;
  var originalExec = re.exec;
  re.exec = function () { return originalExec.apply(this, arguments); };
  var result = 'ab'.split(re);
  return result.length !== 2 || result[0] !== 'a' || result[1] !== 'b';
});

// @@split logic
fixRegExpWellKnownSymbolLogic('split', function (SPLIT, nativeSplit, maybeCallNative) {
  var internalSplit;
  if (
    'abbc'.split(/(b)*/)[1] == 'c' ||
    // eslint-disable-next-line regexp/no-empty-group -- required for testing
    'test'.split(/(?:)/, -1).length != 4 ||
    'ab'.split(/(?:ab)*/).length != 2 ||
    '.'.split(/(.?)(.?)/).length != 4 ||
    // eslint-disable-next-line regexp/no-empty-capturing-group, regexp/no-empty-group -- required for testing
    '.'.split(/()()/).length > 1 ||
    ''.split(/.?/).length
  ) {
    // based on es5-shim implementation, need to rework it
    internalSplit = function (separator, limit) {
      var string = toString(requireObjectCoercible(this));
      var lim = limit === undefined ? MAX_UINT32 : limit >>> 0;
      if (lim === 0) return [];
      if (separator === undefined) return [string];
      // If `separator` is not a regex, use native split
      if (!isRegExp(separator)) {
        return call(nativeSplit, string, separator, lim);
      }
      var output = [];
      var flags = (separator.ignoreCase ? 'i' : '') +
                  (separator.multiline ? 'm' : '') +
                  (separator.unicode ? 'u' : '') +
                  (separator.sticky ? 'y' : '');
      var lastLastIndex = 0;
      // Make `global` and avoid `lastIndex` issues by working with a copy
      var separatorCopy = new RegExp(separator.source, flags + 'g');
      var match, lastIndex, lastLength;
      while (match = call(regexpExec, separatorCopy, string)) {
        lastIndex = separatorCopy.lastIndex;
        if (lastIndex > lastLastIndex) {
          push(output, stringSlice(string, lastLastIndex, match.index));
          if (match.length > 1 && match.index < string.length) apply($push, output, arraySlice(match, 1));
          lastLength = match[0].length;
          lastLastIndex = lastIndex;
          if (output.length >= lim) break;
        }
        if (separatorCopy.lastIndex === match.index) separatorCopy.lastIndex++; // Avoid an infinite loop
      }
      if (lastLastIndex === string.length) {
        if (lastLength || !exec(separatorCopy, '')) push(output, '');
      } else push(output, stringSlice(string, lastLastIndex));
      return output.length > lim ? arraySlice(output, 0, lim) : output;
    };
  // Chakra, V8
  } else if ('0'.split(undefined, 0).length) {
    internalSplit = function (separator, limit) {
      return separator === undefined && limit === 0 ? [] : call(nativeSplit, this, separator, limit);
    };
  } else internalSplit = nativeSplit;

  return [
    // `String.prototype.split` method
    // https://tc39.es/ecma262/#sec-string.prototype.split
    function split(separator, limit) {
      var O = requireObjectCoercible(this);
      var splitter = separator == undefined ? undefined : getMethod(separator, SPLIT);
      return splitter
        ? call(splitter, separator, O, limit)
        : call(internalSplit, toString(O), separator, limit);
    },
    // `RegExp.prototype[@@split]` method
    // https://tc39.es/ecma262/#sec-regexp.prototype-@@split
    //
    // NOTE: This cannot be properly polyfilled in engines that don't support
    // the 'y' flag.
    function (string, limit) {
      var rx = anObject(this);
      var S = toString(string);
      var res = maybeCallNative(internalSplit, rx, S, limit, internalSplit !== nativeSplit);

      if (res.done) return res.value;

      var C = speciesConstructor(rx, RegExp);

      var unicodeMatching = rx.unicode;
      var flags = (rx.ignoreCase ? 'i' : '') +
                  (rx.multiline ? 'm' : '') +
                  (rx.unicode ? 'u' : '') +
                  (UNSUPPORTED_Y ? 'g' : 'y');

      // ^(? + rx + ) is needed, in combination with some S slicing, to
      // simulate the 'y' flag.
      var splitter = new C(UNSUPPORTED_Y ? '^(?:' + rx.source + ')' : rx, flags);
      var lim = limit === undefined ? MAX_UINT32 : limit >>> 0;
      if (lim === 0) return [];
      if (S.length === 0) return callRegExpExec(splitter, S) === null ? [S] : [];
      var p = 0;
      var q = 0;
      var A = [];
      while (q < S.length) {
        splitter.lastIndex = UNSUPPORTED_Y ? 0 : q;
        var z = callRegExpExec(splitter, UNSUPPORTED_Y ? stringSlice(S, q) : S);
        var e;
        if (
          z === null ||
          (e = min(toLength(splitter.lastIndex + (UNSUPPORTED_Y ? q : 0)), S.length)) === p
        ) {
          q = advanceStringIndex(S, q, unicodeMatching);
        } else {
          push(A, stringSlice(S, p, q));
          if (A.length === lim) return A;
          for (var i = 1; i <= z.length - 1; i++) {
            push(A, z[i]);
            if (A.length === lim) return A;
          }
          q = p = e;
        }
      }
      push(A, stringSlice(S, p));
      return A;
    }
  ];
}, !SPLIT_WORKS_WITH_OVERWRITTEN_EXEC, UNSUPPORTED_Y);


/***/ }),

/***/ "128c":
/***/ (function(module, exports, __webpack_require__) {

// style-loader: Adds some css to the DOM by adding a <style> tag

// load the styles
var content = __webpack_require__("3f4c");
if(content.__esModule) content = content.default;
if(typeof content === 'string') content = [[module.i, content, '']];
if(content.locals) module.exports = content.locals;
// add the styles to the DOM
var add = __webpack_require__("499e").default
var update = add("15ab249e", content, true, {"sourceMap":false,"shadowMode":false});

/***/ }),

/***/ "129f":
/***/ (function(module, exports) {

// `SameValue` abstract operation
// https://tc39.es/ecma262/#sec-samevalue
// eslint-disable-next-line es/no-object-is -- safe
module.exports = Object.is || function is(x, y) {
  // eslint-disable-next-line no-self-compare -- NaN check
  return x === y ? x !== 0 || 1 / x === 1 / y : x != x && y != y;
};


/***/ }),

/***/ "131a":
/***/ (function(module, exports, __webpack_require__) {

var $ = __webpack_require__("23e7");
var setPrototypeOf = __webpack_require__("d2bb");

// `Object.setPrototypeOf` method
// https://tc39.es/ecma262/#sec-object.setprototypeof
$({ target: 'Object', stat: true }, {
  setPrototypeOf: setPrototypeOf
});


/***/ }),

/***/ "143c":
/***/ (function(module, exports, __webpack_require__) {

var createTypedArrayConstructor = __webpack_require__("74e8");

// `Int32Array` constructor
// https://tc39.es/ecma262/#sec-typedarray-objects
createTypedArrayConstructor('Int32', function (init) {
  return function Int32Array(data, byteOffset, length) {
    return init(this, data, byteOffset, length);
  };
});


/***/ }),

/***/ "1448":
/***/ (function(module, exports, __webpack_require__) {

var arrayFromConstructorAndList = __webpack_require__("dfb9");
var typedArraySpeciesConstructor = __webpack_require__("b6b7");

module.exports = function (instance, list) {
  return arrayFromConstructorAndList(typedArraySpeciesConstructor(instance), list);
};


/***/ }),

/***/ "145e":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var toObject = __webpack_require__("7b0b");
var toAbsoluteIndex = __webpack_require__("23cb");
var lengthOfArrayLike = __webpack_require__("07fa");

var min = Math.min;

// `Array.prototype.copyWithin` method implementation
// https://tc39.es/ecma262/#sec-array.prototype.copywithin
// eslint-disable-next-line es/no-array-prototype-copywithin -- safe
module.exports = [].copyWithin || function copyWithin(target /* = 0 */, start /* = 0, end = @length */) {
  var O = toObject(this);
  var len = lengthOfArrayLike(O);
  var to = toAbsoluteIndex(target, len);
  var from = toAbsoluteIndex(start, len);
  var end = arguments.length > 2 ? arguments[2] : undefined;
  var count = min((end === undefined ? len : toAbsoluteIndex(end, len)) - from, len - to);
  var inc = 1;
  if (from < to && to < from + count) {
    inc = -1;
    from += count - 1;
    to += count - 1;
  }
  while (count-- > 0) {
    if (from in O) O[to] = O[from];
    else delete O[to];
    to += inc;
    from += inc;
  } return O;
};


/***/ }),

/***/ "14c3":
/***/ (function(module, exports, __webpack_require__) {

var global = __webpack_require__("da84");
var call = __webpack_require__("c65b");
var anObject = __webpack_require__("825a");
var isCallable = __webpack_require__("1626");
var classof = __webpack_require__("c6b6");
var regexpExec = __webpack_require__("9263");

var TypeError = global.TypeError;

// `RegExpExec` abstract operation
// https://tc39.es/ecma262/#sec-regexpexec
module.exports = function (R, S) {
  var exec = R.exec;
  if (isCallable(exec)) {
    var result = call(exec, R, S);
    if (result !== null) anObject(result);
    return result;
  }
  if (classof(R) === 'RegExp') return call(regexpExec, R, S);
  throw TypeError('RegExp#exec called on incompatible receiver');
};


/***/ }),

/***/ "159b":
/***/ (function(module, exports, __webpack_require__) {

var global = __webpack_require__("da84");
var DOMIterables = __webpack_require__("fdbc");
var DOMTokenListPrototype = __webpack_require__("785a");
var forEach = __webpack_require__("17c2");
var createNonEnumerableProperty = __webpack_require__("9112");

var handlePrototype = function (CollectionPrototype) {
  // some Chrome versions have non-configurable methods on DOMTokenList
  if (CollectionPrototype && CollectionPrototype.forEach !== forEach) try {
    createNonEnumerableProperty(CollectionPrototype, 'forEach', forEach);
  } catch (error) {
    CollectionPrototype.forEach = forEach;
  }
};

for (var COLLECTION_NAME in DOMIterables) {
  if (DOMIterables[COLLECTION_NAME]) {
    handlePrototype(global[COLLECTION_NAME] && global[COLLECTION_NAME].prototype);
  }
}

handlePrototype(DOMTokenListPrototype);


/***/ }),

/***/ "1626":
/***/ (function(module, exports) {

// `IsCallable` abstract operation
// https://tc39.es/ecma262/#sec-iscallable
module.exports = function (argument) {
  return typeof argument == 'function';
};


/***/ }),

/***/ "170b":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var ArrayBufferViewCore = __webpack_require__("ebb5");
var toLength = __webpack_require__("50c4");
var toAbsoluteIndex = __webpack_require__("23cb");
var typedArraySpeciesConstructor = __webpack_require__("b6b7");

var aTypedArray = ArrayBufferViewCore.aTypedArray;
var exportTypedArrayMethod = ArrayBufferViewCore.exportTypedArrayMethod;

// `%TypedArray%.prototype.subarray` method
// https://tc39.es/ecma262/#sec-%typedarray%.prototype.subarray
exportTypedArrayMethod('subarray', function subarray(begin, end) {
  var O = aTypedArray(this);
  var length = O.length;
  var beginIndex = toAbsoluteIndex(begin, length);
  var C = typedArraySpeciesConstructor(O);
  return new C(
    O.buffer,
    O.byteOffset + beginIndex * O.BYTES_PER_ELEMENT,
    toLength((end === undefined ? length : toAbsoluteIndex(end, length)) - beginIndex)
  );
});


/***/ }),

/***/ "17c2":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var $forEach = __webpack_require__("b727").forEach;
var arrayMethodIsStrict = __webpack_require__("a640");

var STRICT_METHOD = arrayMethodIsStrict('forEach');

// `Array.prototype.forEach` method implementation
// https://tc39.es/ecma262/#sec-array.prototype.foreach
module.exports = !STRICT_METHOD ? function forEach(callbackfn /* , thisArg */) {
  return $forEach(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);
// eslint-disable-next-line es/no-array-prototype-foreach -- safe
} : [].forEach;


/***/ }),

/***/ "182d":
/***/ (function(module, exports, __webpack_require__) {

var global = __webpack_require__("da84");
var toPositiveInteger = __webpack_require__("f8cd");

var RangeError = global.RangeError;

module.exports = function (it, BYTES) {
  var offset = toPositiveInteger(it);
  if (offset % BYTES) throw RangeError('Wrong offset');
  return offset;
};


/***/ }),

/***/ "19aa":
/***/ (function(module, exports, __webpack_require__) {

var global = __webpack_require__("da84");
var isPrototypeOf = __webpack_require__("3a9b");

var TypeError = global.TypeError;

module.exports = function (it, Prototype) {
  if (isPrototypeOf(Prototype, it)) return it;
  throw TypeError('Incorrect invocation');
};


/***/ }),

/***/ "1a2d":
/***/ (function(module, exports, __webpack_require__) {

var uncurryThis = __webpack_require__("e330");
var toObject = __webpack_require__("7b0b");

var hasOwnProperty = uncurryThis({}.hasOwnProperty);

// `HasOwnProperty` abstract operation
// https://tc39.es/ecma262/#sec-hasownproperty
module.exports = Object.hasOwn || function hasOwn(it, key) {
  return hasOwnProperty(toObject(it), key);
};


/***/ }),

/***/ "1be4":
/***/ (function(module, exports, __webpack_require__) {

var getBuiltIn = __webpack_require__("d066");

module.exports = getBuiltIn('document', 'documentElement');


/***/ }),

/***/ "1c7e":
/***/ (function(module, exports, __webpack_require__) {

var wellKnownSymbol = __webpack_require__("b622");

var ITERATOR = wellKnownSymbol('iterator');
var SAFE_CLOSING = false;

try {
  var called = 0;
  var iteratorWithReturn = {
    next: function () {
      return { done: !!called++ };
    },
    'return': function () {
      SAFE_CLOSING = true;
    }
  };
  iteratorWithReturn[ITERATOR] = function () {
    return this;
  };
  // eslint-disable-next-line es/no-array-from, no-throw-literal -- required for testing
  Array.from(iteratorWithReturn, function () { throw 2; });
} catch (error) { /* empty */ }

module.exports = function (exec, SKIP_CLOSING) {
  if (!SKIP_CLOSING && !SAFE_CLOSING) return false;
  var ITERATION_SUPPORT = false;
  try {
    var object = {};
    object[ITERATOR] = function () {
      return {
        next: function () {
          return { done: ITERATION_SUPPORT = true };
        }
      };
    };
    exec(object);
  } catch (error) { /* empty */ }
  return ITERATION_SUPPORT;
};


/***/ }),

/***/ "1cdc":
/***/ (function(module, exports, __webpack_require__) {

var userAgent = __webpack_require__("342f");

module.exports = /(?:ipad|iphone|ipod).*applewebkit/i.test(userAgent);


/***/ }),

/***/ "1d80":
/***/ (function(module, exports, __webpack_require__) {

var global = __webpack_require__("da84");

var TypeError = global.TypeError;

// `RequireObjectCoercible` abstract operation
// https://tc39.es/ecma262/#sec-requireobjectcoercible
module.exports = function (it) {
  if (it == undefined) throw TypeError("Can't call method on " + it);
  return it;
};


/***/ }),

/***/ "1dde":
/***/ (function(module, exports, __webpack_require__) {

var fails = __webpack_require__("d039");
var wellKnownSymbol = __webpack_require__("b622");
var V8_VERSION = __webpack_require__("2d00");

var SPECIES = wellKnownSymbol('species');

module.exports = function (METHOD_NAME) {
  // We can't use this feature detection in V8 since it causes
  // deoptimization and serious performance degradation
  // https://github.com/zloirock/core-js/issues/677
  return V8_VERSION >= 51 || !fails(function () {
    var array = [];
    var constructor = array.constructor = {};
    constructor[SPECIES] = function () {
      return { foo: 1 };
    };
    return array[METHOD_NAME](Boolean).foo !== 1;
  });
};


/***/ }),

/***/ "1de5":
/***/ (function(module, exports, __webpack_require__) {

"use strict";


module.exports = function (url, options) {
  if (!options) {
    // eslint-disable-next-line no-param-reassign
    options = {};
  } // eslint-disable-next-line no-underscore-dangle, no-param-reassign


  url = url && url.__esModule ? url.default : url;

  if (typeof url !== 'string') {
    return url;
  } // If url is already wrapped in quotes, remove them


  if (/^['"].*['"]$/.test(url)) {
    // eslint-disable-next-line no-param-reassign
    url = url.slice(1, -1);
  }

  if (options.hash) {
    // eslint-disable-next-line no-param-reassign
    url += options.hash;
  } // Should url be wrapped?
  // See https://drafts.csswg.org/css-values-3/#urls


  if (/["'() \t\n]/.test(url) || options.needQuotes) {
    return "\"".concat(url.replace(/"/g, '\\"').replace(/\n/g, '\\n'), "\"");
  }

  return url;
};

/***/ }),

/***/ "1fb5":
/***/ (function(module, exports, __webpack_require__) {

"use strict";


exports.byteLength = byteLength
exports.toByteArray = toByteArray
exports.fromByteArray = fromByteArray

var lookup = []
var revLookup = []
var Arr = typeof Uint8Array !== 'undefined' ? Uint8Array : Array

var code = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'
for (var i = 0, len = code.length; i < len; ++i) {
  lookup[i] = code[i]
  revLookup[code.charCodeAt(i)] = i
}

// Support decoding URL-safe base64 strings, as Node.js does.
// See: https://en.wikipedia.org/wiki/Base64#URL_applications
revLookup['-'.charCodeAt(0)] = 62
revLookup['_'.charCodeAt(0)] = 63

function getLens (b64) {
  var len = b64.length

  if (len % 4 > 0) {
    throw new Error('Invalid string. Length must be a multiple of 4')
  }

  // Trim off extra bytes after placeholder bytes are found
  // See: https://github.com/beatgammit/base64-js/issues/42
  var validLen = b64.indexOf('=')
  if (validLen === -1) validLen = len

  var placeHoldersLen = validLen === len
    ? 0
    : 4 - (validLen % 4)

  return [validLen, placeHoldersLen]
}

// base64 is 4/3 + up to two characters of the original data
function byteLength (b64) {
  var lens = getLens(b64)
  var validLen = lens[0]
  var placeHoldersLen = lens[1]
  return ((validLen + placeHoldersLen) * 3 / 4) - placeHoldersLen
}

function _byteLength (b64, validLen, placeHoldersLen) {
  return ((validLen + placeHoldersLen) * 3 / 4) - placeHoldersLen
}

function toByteArray (b64) {
  var tmp
  var lens = getLens(b64)
  var validLen = lens[0]
  var placeHoldersLen = lens[1]

  var arr = new Arr(_byteLength(b64, validLen, placeHoldersLen))

  var curByte = 0

  // if there are placeholders, only get up to the last complete 4 chars
  var len = placeHoldersLen > 0
    ? validLen - 4
    : validLen

  var i
  for (i = 0; i < len; i += 4) {
    tmp =
      (revLookup[b64.charCodeAt(i)] << 18) |
      (revLookup[b64.charCodeAt(i + 1)] << 12) |
      (revLookup[b64.charCodeAt(i + 2)] << 6) |
      revLookup[b64.charCodeAt(i + 3)]
    arr[curByte++] = (tmp >> 16) & 0xFF
    arr[curByte++] = (tmp >> 8) & 0xFF
    arr[curByte++] = tmp & 0xFF
  }

  if (placeHoldersLen === 2) {
    tmp =
      (revLookup[b64.charCodeAt(i)] << 2) |
      (revLookup[b64.charCodeAt(i + 1)] >> 4)
    arr[curByte++] = tmp & 0xFF
  }

  if (placeHoldersLen === 1) {
    tmp =
      (revLookup[b64.charCodeAt(i)] << 10) |
      (revLookup[b64.charCodeAt(i + 1)] << 4) |
      (revLookup[b64.charCodeAt(i + 2)] >> 2)
    arr[curByte++] = (tmp >> 8) & 0xFF
    arr[curByte++] = tmp & 0xFF
  }

  return arr
}

function tripletToBase64 (num) {
  return lookup[num >> 18 & 0x3F] +
    lookup[num >> 12 & 0x3F] +
    lookup[num >> 6 & 0x3F] +
    lookup[num & 0x3F]
}

function encodeChunk (uint8, start, end) {
  var tmp
  var output = []
  for (var i = start; i < end; i += 3) {
    tmp =
      ((uint8[i] << 16) & 0xFF0000) +
      ((uint8[i + 1] << 8) & 0xFF00) +
      (uint8[i + 2] & 0xFF)
    output.push(tripletToBase64(tmp))
  }
  return output.join('')
}

function fromByteArray (uint8) {
  var tmp
  var len = uint8.length
  var extraBytes = len % 3 // if we have 1 byte left, pad 2 bytes
  var parts = []
  var maxChunkLength = 16383 // must be multiple of 3

  // go through the array every three bytes, we'll deal with trailing stuff later
  for (var i = 0, len2 = len - extraBytes; i < len2; i += maxChunkLength) {
    parts.push(encodeChunk(uint8, i, (i + maxChunkLength) > len2 ? len2 : (i + maxChunkLength)))
  }

  // pad the end with zeros, but make sure to not forget the extra bytes
  if (extraBytes === 1) {
    tmp = uint8[len - 1]
    parts.push(
      lookup[tmp >> 2] +
      lookup[(tmp << 4) & 0x3F] +
      '=='
    )
  } else if (extraBytes === 2) {
    tmp = (uint8[len - 2] << 8) + uint8[len - 1]
    parts.push(
      lookup[tmp >> 10] +
      lookup[(tmp >> 4) & 0x3F] +
      lookup[(tmp << 2) & 0x3F] +
      '='
    )
  }

  return parts.join('')
}


/***/ }),

/***/ "2188":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var _node_modules_vue_style_loader_index_js_ref_9_oneOf_1_0_node_modules_css_loader_dist_cjs_js_ref_9_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_9_oneOf_1_2_node_modules_postcss_loader_src_index_js_ref_9_oneOf_1_3_node_modules_sass_loader_dist_cjs_js_ref_9_oneOf_1_4_node_modules_cache_loader_dist_cjs_js_ref_1_0_node_modules_vue_loader_lib_index_js_vue_loader_options_fieldName_vue_vue_type_style_index_0_id_be6ea5a4_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("4316");
/* harmony import */ var _node_modules_vue_style_loader_index_js_ref_9_oneOf_1_0_node_modules_css_loader_dist_cjs_js_ref_9_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_9_oneOf_1_2_node_modules_postcss_loader_src_index_js_ref_9_oneOf_1_3_node_modules_sass_loader_dist_cjs_js_ref_9_oneOf_1_4_node_modules_cache_loader_dist_cjs_js_ref_1_0_node_modules_vue_loader_lib_index_js_vue_loader_options_fieldName_vue_vue_type_style_index_0_id_be6ea5a4_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_node_modules_vue_style_loader_index_js_ref_9_oneOf_1_0_node_modules_css_loader_dist_cjs_js_ref_9_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_9_oneOf_1_2_node_modules_postcss_loader_src_index_js_ref_9_oneOf_1_3_node_modules_sass_loader_dist_cjs_js_ref_9_oneOf_1_4_node_modules_cache_loader_dist_cjs_js_ref_1_0_node_modules_vue_loader_lib_index_js_vue_loader_options_fieldName_vue_vue_type_style_index_0_id_be6ea5a4_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0__);
/* unused harmony reexport * */


/***/ }),

/***/ "219c":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var global = __webpack_require__("da84");
var uncurryThis = __webpack_require__("e330");
var fails = __webpack_require__("d039");
var aCallable = __webpack_require__("59ed");
var internalSort = __webpack_require__("addb");
var ArrayBufferViewCore = __webpack_require__("ebb5");
var FF = __webpack_require__("04d1");
var IE_OR_EDGE = __webpack_require__("d998");
var V8 = __webpack_require__("2d00");
var WEBKIT = __webpack_require__("512c");

var Array = global.Array;
var aTypedArray = ArrayBufferViewCore.aTypedArray;
var exportTypedArrayMethod = ArrayBufferViewCore.exportTypedArrayMethod;
var Uint16Array = global.Uint16Array;
var un$Sort = Uint16Array && uncurryThis(Uint16Array.prototype.sort);

// WebKit
var ACCEPT_INCORRECT_ARGUMENTS = !!un$Sort && !(fails(function () {
  un$Sort(new Uint16Array(2), null);
}) && fails(function () {
  un$Sort(new Uint16Array(2), {});
}));

var STABLE_SORT = !!un$Sort && !fails(function () {
  // feature detection can be too slow, so check engines versions
  if (V8) return V8 < 74;
  if (FF) return FF < 67;
  if (IE_OR_EDGE) return true;
  if (WEBKIT) return WEBKIT < 602;

  var array = new Uint16Array(516);
  var expected = Array(516);
  var index, mod;

  for (index = 0; index < 516; index++) {
    mod = index % 4;
    array[index] = 515 - index;
    expected[index] = index - 2 * mod + 3;
  }

  un$Sort(array, function (a, b) {
    return (a / 4 | 0) - (b / 4 | 0);
  });

  for (index = 0; index < 516; index++) {
    if (array[index] !== expected[index]) return true;
  }
});

var getSortCompare = function (comparefn) {
  return function (x, y) {
    if (comparefn !== undefined) return +comparefn(x, y) || 0;
    // eslint-disable-next-line no-self-compare -- NaN check
    if (y !== y) return -1;
    // eslint-disable-next-line no-self-compare -- NaN check
    if (x !== x) return 1;
    if (x === 0 && y === 0) return 1 / x > 0 && 1 / y < 0 ? 1 : -1;
    return x > y;
  };
};

// `%TypedArray%.prototype.sort` method
// https://tc39.es/ecma262/#sec-%typedarray%.prototype.sort
exportTypedArrayMethod('sort', function sort(comparefn) {
  if (comparefn !== undefined) aCallable(comparefn);
  if (STABLE_SORT) return un$Sort(this, comparefn);

  return internalSort(aTypedArray(this), getSortCompare(comparefn));
}, !STABLE_SORT || ACCEPT_INCORRECT_ARGUMENTS);


/***/ }),

/***/ "2266":
/***/ (function(module, exports, __webpack_require__) {

var global = __webpack_require__("da84");
var bind = __webpack_require__("0366");
var call = __webpack_require__("c65b");
var anObject = __webpack_require__("825a");
var tryToString = __webpack_require__("0d51");
var isArrayIteratorMethod = __webpack_require__("e95a");
var lengthOfArrayLike = __webpack_require__("07fa");
var isPrototypeOf = __webpack_require__("3a9b");
var getIterator = __webpack_require__("9a1f");
var getIteratorMethod = __webpack_require__("35a1");
var iteratorClose = __webpack_require__("2a62");

var TypeError = global.TypeError;

var Result = function (stopped, result) {
  this.stopped = stopped;
  this.result = result;
};

var ResultPrototype = Result.prototype;

module.exports = function (iterable, unboundFunction, options) {
  var that = options && options.that;
  var AS_ENTRIES = !!(options && options.AS_ENTRIES);
  var IS_ITERATOR = !!(options && options.IS_ITERATOR);
  var INTERRUPTED = !!(options && options.INTERRUPTED);
  var fn = bind(unboundFunction, that);
  var iterator, iterFn, index, length, result, next, step;

  var stop = function (condition) {
    if (iterator) iteratorClose(iterator, 'normal', condition);
    return new Result(true, condition);
  };

  var callFn = function (value) {
    if (AS_ENTRIES) {
      anObject(value);
      return INTERRUPTED ? fn(value[0], value[1], stop) : fn(value[0], value[1]);
    } return INTERRUPTED ? fn(value, stop) : fn(value);
  };

  if (IS_ITERATOR) {
    iterator = iterable;
  } else {
    iterFn = getIteratorMethod(iterable);
    if (!iterFn) throw TypeError(tryToString(iterable) + ' is not iterable');
    // optimisation for array iterators
    if (isArrayIteratorMethod(iterFn)) {
      for (index = 0, length = lengthOfArrayLike(iterable); length > index; index++) {
        result = callFn(iterable[index]);
        if (result && isPrototypeOf(ResultPrototype, result)) return result;
      } return new Result(false);
    }
    iterator = getIterator(iterable, iterFn);
  }

  next = iterator.next;
  while (!(step = call(next, iterator)).done) {
    try {
      result = callFn(step.value);
    } catch (error) {
      iteratorClose(iterator, 'throw', error);
    }
    if (typeof result == 'object' && result && isPrototypeOf(ResultPrototype, result)) return result;
  } return new Result(false);
};


/***/ }),

/***/ "2315":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var $ = __webpack_require__("23e7");
var createHTML = __webpack_require__("857a");
var forcedStringHTMLMethod = __webpack_require__("af03");

// `String.prototype.strike` method
// https://tc39.es/ecma262/#sec-string.prototype.strike
$({ target: 'String', proto: true, forced: forcedStringHTMLMethod('strike') }, {
  strike: function strike() {
    return createHTML(this, 'strike', '', '');
  }
});


/***/ }),

/***/ "23cb":
/***/ (function(module, exports, __webpack_require__) {

var toIntegerOrInfinity = __webpack_require__("5926");

var max = Math.max;
var min = Math.min;

// Helper for a popular repeating case of the spec:
// Let integer be ? ToInteger(index).
// If integer < 0, let result be max((length + integer), 0); else let result be min(integer, length).
module.exports = function (index, length) {
  var integer = toIntegerOrInfinity(index);
  return integer < 0 ? max(integer + length, 0) : min(integer, length);
};


/***/ }),

/***/ "23e7":
/***/ (function(module, exports, __webpack_require__) {

var global = __webpack_require__("da84");
var getOwnPropertyDescriptor = __webpack_require__("06cf").f;
var createNonEnumerableProperty = __webpack_require__("9112");
var redefine = __webpack_require__("6eeb");
var setGlobal = __webpack_require__("ce4e");
var copyConstructorProperties = __webpack_require__("e893");
var isForced = __webpack_require__("94ca");

/*
  options.target      - name of the target object
  options.global      - target is the global object
  options.stat        - export as static methods of target
  options.proto       - export as prototype methods of target
  options.real        - real prototype method for the `pure` version
  options.forced      - export even if the native feature is available
  options.bind        - bind methods to the target, required for the `pure` version
  options.wrap        - wrap constructors to preventing global pollution, required for the `pure` version
  options.unsafe      - use the simple assignment of property instead of delete + defineProperty
  options.sham        - add a flag to not completely full polyfills
  options.enumerable  - export as enumerable property
  options.noTargetGet - prevent calling a getter on target
  options.name        - the .name of the function if it does not match the key
*/
module.exports = function (options, source) {
  var TARGET = options.target;
  var GLOBAL = options.global;
  var STATIC = options.stat;
  var FORCED, target, key, targetProperty, sourceProperty, descriptor;
  if (GLOBAL) {
    target = global;
  } else if (STATIC) {
    target = global[TARGET] || setGlobal(TARGET, {});
  } else {
    target = (global[TARGET] || {}).prototype;
  }
  if (target) for (key in source) {
    sourceProperty = source[key];
    if (options.noTargetGet) {
      descriptor = getOwnPropertyDescriptor(target, key);
      targetProperty = descriptor && descriptor.value;
    } else targetProperty = target[key];
    FORCED = isForced(GLOBAL ? key : TARGET + (STATIC ? '.' : '#') + key, options.forced);
    // contained in target
    if (!FORCED && targetProperty !== undefined) {
      if (typeof sourceProperty == typeof targetProperty) continue;
      copyConstructorProperties(sourceProperty, targetProperty);
    }
    // add a flag to not completely full polyfills
    if (options.sham || (targetProperty && targetProperty.sham)) {
      createNonEnumerableProperty(sourceProperty, 'sham', true);
    }
    // extend global
    redefine(target, key, sourceProperty, options);
  }
};


/***/ }),

/***/ "241c":
/***/ (function(module, exports, __webpack_require__) {

var internalObjectKeys = __webpack_require__("ca84");
var enumBugKeys = __webpack_require__("7839");

var hiddenKeys = enumBugKeys.concat('length', 'prototype');

// `Object.getOwnPropertyNames` method
// https://tc39.es/ecma262/#sec-object.getownpropertynames
// eslint-disable-next-line es/no-object-getownpropertynames -- safe
exports.f = Object.getOwnPropertyNames || function getOwnPropertyNames(O) {
  return internalObjectKeys(O, hiddenKeys);
};


/***/ }),

/***/ "24fb":
/***/ (function(module, exports, __webpack_require__) {

"use strict";


/*
  MIT License http://www.opensource.org/licenses/mit-license.php
  Author Tobias Koppers @sokra
*/
// css base code, injected by the css-loader
// eslint-disable-next-line func-names
module.exports = function (useSourceMap) {
  var list = []; // return the list of modules as css string

  list.toString = function toString() {
    return this.map(function (item) {
      var content = cssWithMappingToString(item, useSourceMap);

      if (item[2]) {
        return "@media ".concat(item[2], " {").concat(content, "}");
      }

      return content;
    }).join('');
  }; // import a list of modules into the list
  // eslint-disable-next-line func-names


  list.i = function (modules, mediaQuery, dedupe) {
    if (typeof modules === 'string') {
      // eslint-disable-next-line no-param-reassign
      modules = [[null, modules, '']];
    }

    var alreadyImportedModules = {};

    if (dedupe) {
      for (var i = 0; i < this.length; i++) {
        // eslint-disable-next-line prefer-destructuring
        var id = this[i][0];

        if (id != null) {
          alreadyImportedModules[id] = true;
        }
      }
    }

    for (var _i = 0; _i < modules.length; _i++) {
      var item = [].concat(modules[_i]);

      if (dedupe && alreadyImportedModules[item[0]]) {
        // eslint-disable-next-line no-continue
        continue;
      }

      if (mediaQuery) {
        if (!item[2]) {
          item[2] = mediaQuery;
        } else {
          item[2] = "".concat(mediaQuery, " and ").concat(item[2]);
        }
      }

      list.push(item);
    }
  };

  return list;
};

function cssWithMappingToString(item, useSourceMap) {
  var content = item[1] || ''; // eslint-disable-next-line prefer-destructuring

  var cssMapping = item[3];

  if (!cssMapping) {
    return content;
  }

  if (useSourceMap && typeof btoa === 'function') {
    var sourceMapping = toComment(cssMapping);
    var sourceURLs = cssMapping.sources.map(function (source) {
      return "/*# sourceURL=".concat(cssMapping.sourceRoot || '').concat(source, " */");
    });
    return [content].concat(sourceURLs).concat([sourceMapping]).join('\n');
  }

  return [content].join('\n');
} // Adapted from convert-source-map (MIT)


function toComment(sourceMap) {
  // eslint-disable-next-line no-undef
  var base64 = btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))));
  var data = "sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(base64);
  return "/*# ".concat(data, " */");
}

/***/ }),

/***/ "2532":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var $ = __webpack_require__("23e7");
var uncurryThis = __webpack_require__("e330");
var notARegExp = __webpack_require__("5a34");
var requireObjectCoercible = __webpack_require__("1d80");
var toString = __webpack_require__("577e");
var correctIsRegExpLogic = __webpack_require__("ab13");

var stringIndexOf = uncurryThis(''.indexOf);

// `String.prototype.includes` method
// https://tc39.es/ecma262/#sec-string.prototype.includes
$({ target: 'String', proto: true, forced: !correctIsRegExpLogic('includes') }, {
  includes: function includes(searchString /* , position = 0 */) {
    return !!~stringIndexOf(
      toString(requireObjectCoercible(this)),
      toString(notARegExp(searchString)),
      arguments.length > 1 ? arguments[1] : undefined
    );
  }
});


/***/ }),

/***/ "25a1":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var ArrayBufferViewCore = __webpack_require__("ebb5");
var $reduceRight = __webpack_require__("d58f").right;

var aTypedArray = ArrayBufferViewCore.aTypedArray;
var exportTypedArrayMethod = ArrayBufferViewCore.exportTypedArrayMethod;

// `%TypedArray%.prototype.reduceRicht` method
// https://tc39.es/ecma262/#sec-%typedarray%.prototype.reduceright
exportTypedArrayMethod('reduceRight', function reduceRight(callbackfn /* , initialValue */) {
  var length = arguments.length;
  return $reduceRight(aTypedArray(this), callbackfn, length, length > 1 ? arguments[1] : undefined);
});


/***/ }),

/***/ "25f0":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var uncurryThis = __webpack_require__("e330");
var PROPER_FUNCTION_NAME = __webpack_require__("5e77").PROPER;
var redefine = __webpack_require__("6eeb");
var anObject = __webpack_require__("825a");
var isPrototypeOf = __webpack_require__("3a9b");
var $toString = __webpack_require__("577e");
var fails = __webpack_require__("d039");
var regExpFlags = __webpack_require__("ad6d");

var TO_STRING = 'toString';
var RegExpPrototype = RegExp.prototype;
var n$ToString = RegExpPrototype[TO_STRING];
var getFlags = uncurryThis(regExpFlags);

var NOT_GENERIC = fails(function () { return n$ToString.call({ source: 'a', flags: 'b' }) != '/a/b'; });
// FF44- RegExp#toString has a wrong name
var INCORRECT_NAME = PROPER_FUNCTION_NAME && n$ToString.name != TO_STRING;

// `RegExp.prototype.toString` method
// https://tc39.es/ecma262/#sec-regexp.prototype.tostring
if (NOT_GENERIC || INCORRECT_NAME) {
  redefine(RegExp.prototype, TO_STRING, function toString() {
    var R = anObject(this);
    var p = $toString(R.source);
    var rf = R.flags;
    var f = $toString(rf === undefined && isPrototypeOf(RegExpPrototype, R) && !('flags' in RegExpPrototype) ? getFlags(R) : rf);
    return '/' + p + '/' + f;
  }, { unsafe: true });
}


/***/ }),

/***/ "2626":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var getBuiltIn = __webpack_require__("d066");
var definePropertyModule = __webpack_require__("9bf2");
var wellKnownSymbol = __webpack_require__("b622");
var DESCRIPTORS = __webpack_require__("83ab");

var SPECIES = wellKnownSymbol('species');

module.exports = function (CONSTRUCTOR_NAME) {
  var Constructor = getBuiltIn(CONSTRUCTOR_NAME);
  var defineProperty = definePropertyModule.f;

  if (DESCRIPTORS && Constructor && !Constructor[SPECIES]) {
    defineProperty(Constructor, SPECIES, {
      configurable: true,
      get: function () { return this; }
    });
  }
};


/***/ }),

/***/ "278f":
/***/ (function(module, exports, __webpack_require__) {

// style-loader: Adds some css to the DOM by adding a <style> tag

// load the styles
var content = __webpack_require__("33ba");
if(content.__esModule) content = content.default;
if(typeof content === 'string') content = [[module.i, content, '']];
if(content.locals) module.exports = content.locals;
// add the styles to the DOM
var add = __webpack_require__("499e").default
var update = add("05b74d6c", content, true, {"sourceMap":false,"shadowMode":false});

/***/ }),

/***/ "2884":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var _node_modules_vue_style_loader_index_js_ref_9_oneOf_1_0_node_modules_css_loader_dist_cjs_js_ref_9_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_9_oneOf_1_2_node_modules_postcss_loader_src_index_js_ref_9_oneOf_1_3_node_modules_sass_loader_dist_cjs_js_ref_9_oneOf_1_4_node_modules_cache_loader_dist_cjs_js_ref_1_0_node_modules_vue_loader_lib_index_js_vue_loader_options_index_vue_vue_type_style_index_0_id_448a11a0_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("d1c2");
/* harmony import */ var _node_modules_vue_style_loader_index_js_ref_9_oneOf_1_0_node_modules_css_loader_dist_cjs_js_ref_9_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_9_oneOf_1_2_node_modules_postcss_loader_src_index_js_ref_9_oneOf_1_3_node_modules_sass_loader_dist_cjs_js_ref_9_oneOf_1_4_node_modules_cache_loader_dist_cjs_js_ref_1_0_node_modules_vue_loader_lib_index_js_vue_loader_options_index_vue_vue_type_style_index_0_id_448a11a0_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_node_modules_vue_style_loader_index_js_ref_9_oneOf_1_0_node_modules_css_loader_dist_cjs_js_ref_9_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_9_oneOf_1_2_node_modules_postcss_loader_src_index_js_ref_9_oneOf_1_3_node_modules_sass_loader_dist_cjs_js_ref_9_oneOf_1_4_node_modules_cache_loader_dist_cjs_js_ref_1_0_node_modules_vue_loader_lib_index_js_vue_loader_options_index_vue_vue_type_style_index_0_id_448a11a0_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0__);
/* unused harmony reexport * */


/***/ }),

/***/ "2954":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var ArrayBufferViewCore = __webpack_require__("ebb5");
var typedArraySpeciesConstructor = __webpack_require__("b6b7");
var fails = __webpack_require__("d039");
var arraySlice = __webpack_require__("f36a");

var aTypedArray = ArrayBufferViewCore.aTypedArray;
var exportTypedArrayMethod = ArrayBufferViewCore.exportTypedArrayMethod;

var FORCED = fails(function () {
  // eslint-disable-next-line es/no-typed-arrays -- required for testing
  new Int8Array(1).slice();
});

// `%TypedArray%.prototype.slice` method
// https://tc39.es/ecma262/#sec-%typedarray%.prototype.slice
exportTypedArrayMethod('slice', function slice(start, end) {
  var list = arraySlice(aTypedArray(this), start, end);
  var C = typedArraySpeciesConstructor(this);
  var index = 0;
  var length = list.length;
  var result = new C(length);
  while (length > index) result[index] = list[index++];
  return result;
}, FORCED);


/***/ }),

/***/ "2a62":
/***/ (function(module, exports, __webpack_require__) {

var call = __webpack_require__("c65b");
var anObject = __webpack_require__("825a");
var getMethod = __webpack_require__("dc4a");

module.exports = function (iterator, kind, value) {
  var innerResult, innerError;
  anObject(iterator);
  try {
    innerResult = getMethod(iterator, 'return');
    if (!innerResult) {
      if (kind === 'throw') throw value;
      return value;
    }
    innerResult = call(innerResult, iterator);
  } catch (error) {
    innerError = true;
    innerResult = error;
  }
  if (kind === 'throw') throw value;
  if (innerError) throw innerResult;
  anObject(innerResult);
  return value;
};


/***/ }),

/***/ "2ba4":
/***/ (function(module, exports) {

var FunctionPrototype = Function.prototype;
var apply = FunctionPrototype.apply;
var bind = FunctionPrototype.bind;
var call = FunctionPrototype.call;

// eslint-disable-next-line es/no-reflect -- safe
module.exports = typeof Reflect == 'object' && Reflect.apply || (bind ? call.bind(apply) : function () {
  return call.apply(apply, arguments);
});


/***/ }),

/***/ "2c3e":
/***/ (function(module, exports, __webpack_require__) {

var global = __webpack_require__("da84");
var DESCRIPTORS = __webpack_require__("83ab");
var UNSUPPORTED_Y = __webpack_require__("9f7f").UNSUPPORTED_Y;
var classof = __webpack_require__("c6b6");
var defineProperty = __webpack_require__("9bf2").f;
var getInternalState = __webpack_require__("69f3").get;

var RegExpPrototype = RegExp.prototype;
var TypeError = global.TypeError;

// `RegExp.prototype.sticky` getter
// https://tc39.es/ecma262/#sec-get-regexp.prototype.sticky
if (DESCRIPTORS && UNSUPPORTED_Y) {
  defineProperty(RegExpPrototype, 'sticky', {
    configurable: true,
    get: function () {
      if (this === RegExpPrototype) return undefined;
      // We can't use InternalStateModule.getterFor because
      // we don't add metadata for regexps created by a literal.
      if (classof(this) === 'RegExp') {
        return !!getInternalState(this).sticky;
      }
      throw TypeError('Incompatible receiver, RegExp required');
    }
  });
}


/***/ }),

/***/ "2ca0":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var $ = __webpack_require__("23e7");
var uncurryThis = __webpack_require__("e330");
var getOwnPropertyDescriptor = __webpack_require__("06cf").f;
var toLength = __webpack_require__("50c4");
var toString = __webpack_require__("577e");
var notARegExp = __webpack_require__("5a34");
var requireObjectCoercible = __webpack_require__("1d80");
var correctIsRegExpLogic = __webpack_require__("ab13");
var IS_PURE = __webpack_require__("c430");

// eslint-disable-next-line es/no-string-prototype-startswith -- safe
var un$StartsWith = uncurryThis(''.startsWith);
var stringSlice = uncurryThis(''.slice);
var min = Math.min;

var CORRECT_IS_REGEXP_LOGIC = correctIsRegExpLogic('startsWith');
// https://github.com/zloirock/core-js/pull/702
var MDN_POLYFILL_BUG = !IS_PURE && !CORRECT_IS_REGEXP_LOGIC && !!function () {
  var descriptor = getOwnPropertyDescriptor(String.prototype, 'startsWith');
  return descriptor && !descriptor.writable;
}();

// `String.prototype.startsWith` method
// https://tc39.es/ecma262/#sec-string.prototype.startswith
$({ target: 'String', proto: true, forced: !MDN_POLYFILL_BUG && !CORRECT_IS_REGEXP_LOGIC }, {
  startsWith: function startsWith(searchString /* , position = 0 */) {
    var that = toString(requireObjectCoercible(this));
    notARegExp(searchString);
    var index = toLength(min(arguments.length > 1 ? arguments[1] : undefined, that.length));
    var search = toString(searchString);
    return un$StartsWith
      ? un$StartsWith(that, search, index)
      : stringSlice(that, index, index + search.length) === search;
  }
});


/***/ }),

/***/ "2cf4":
/***/ (function(module, exports, __webpack_require__) {

var global = __webpack_require__("da84");
var apply = __webpack_require__("2ba4");
var bind = __webpack_require__("0366");
var isCallable = __webpack_require__("1626");
var hasOwn = __webpack_require__("1a2d");
var fails = __webpack_require__("d039");
var html = __webpack_require__("1be4");
var arraySlice = __webpack_require__("f36a");
var createElement = __webpack_require__("cc12");
var IS_IOS = __webpack_require__("1cdc");
var IS_NODE = __webpack_require__("605d");

var set = global.setImmediate;
var clear = global.clearImmediate;
var process = global.process;
var Dispatch = global.Dispatch;
var Function = global.Function;
var MessageChannel = global.MessageChannel;
var String = global.String;
var counter = 0;
var queue = {};
var ONREADYSTATECHANGE = 'onreadystatechange';
var location, defer, channel, port;

try {
  // Deno throws a ReferenceError on `location` access without `--location` flag
  location = global.location;
} catch (error) { /* empty */ }

var run = function (id) {
  if (hasOwn(queue, id)) {
    var fn = queue[id];
    delete queue[id];
    fn();
  }
};

var runner = function (id) {
  return function () {
    run(id);
  };
};

var listener = function (event) {
  run(event.data);
};

var post = function (id) {
  // old engines have not location.origin
  global.postMessage(String(id), location.protocol + '//' + location.host);
};

// Node.js 0.9+ & IE10+ has setImmediate, otherwise:
if (!set || !clear) {
  set = function setImmediate(fn) {
    var args = arraySlice(arguments, 1);
    queue[++counter] = function () {
      apply(isCallable(fn) ? fn : Function(fn), undefined, args);
    };
    defer(counter);
    return counter;
  };
  clear = function clearImmediate(id) {
    delete queue[id];
  };
  // Node.js 0.8-
  if (IS_NODE) {
    defer = function (id) {
      process.nextTick(runner(id));
    };
  // Sphere (JS game engine) Dispatch API
  } else if (Dispatch && Dispatch.now) {
    defer = function (id) {
      Dispatch.now(runner(id));
    };
  // Browsers with MessageChannel, includes WebWorkers
  // except iOS - https://github.com/zloirock/core-js/issues/624
  } else if (MessageChannel && !IS_IOS) {
    channel = new MessageChannel();
    port = channel.port2;
    channel.port1.onmessage = listener;
    defer = bind(port.postMessage, port);
  // Browsers with postMessage, skip WebWorkers
  // IE8 has postMessage, but it's sync & typeof its postMessage is 'object'
  } else if (
    global.addEventListener &&
    isCallable(global.postMessage) &&
    !global.importScripts &&
    location && location.protocol !== 'file:' &&
    !fails(post)
  ) {
    defer = post;
    global.addEventListener('message', listener, false);
  // IE8-
  } else if (ONREADYSTATECHANGE in createElement('script')) {
    defer = function (id) {
      html.appendChild(createElement('script'))[ONREADYSTATECHANGE] = function () {
        html.removeChild(this);
        run(id);
      };
    };
  // Rest old browsers
  } else {
    defer = function (id) {
      setTimeout(runner(id), 0);
    };
  }
}

module.exports = {
  set: set,
  clear: clear
};


/***/ }),

/***/ "2d00":
/***/ (function(module, exports, __webpack_require__) {

var global = __webpack_require__("da84");
var userAgent = __webpack_require__("342f");

var process = global.process;
var Deno = global.Deno;
var versions = process && process.versions || Deno && Deno.version;
var v8 = versions && versions.v8;
var match, version;

if (v8) {
  match = v8.split('.');
  // in old Chrome, versions of V8 isn't V8 = Chrome / 10
  // but their correct versions are not interesting for us
  version = match[0] > 0 && match[0] < 4 ? 1 : +(match[0] + match[1]);
}

// BrowserFS NodeJS `process` polyfill incorrectly set `.v8` to `0.0`
// so check `userAgent` even if `.v8` exists, but 0
if (!version && userAgent) {
  match = userAgent.match(/Edge\/(\d+)/);
  if (!match || match[1] >= 74) {
    match = userAgent.match(/Chrome\/(\d+)/);
    if (match) version = +match[1];
  }
}

module.exports = version;


/***/ }),

/***/ "2d0d":
/***/ (function(module, exports, __webpack_require__) {

// Imports
var ___CSS_LOADER_API_IMPORT___ = __webpack_require__("24fb");
exports = ___CSS_LOADER_API_IMPORT___(false);
// Module
exports.push([module.i, ".placeholder-item[data-v-be6ea5a4]{position:absolute;background-image:linear-gradient(45deg,hsla(0,0%,90.2%,.3) 25%,transparent 0,transparent 50%,hsla(0,0%,90.2%,.3) 0,hsla(0,0%,90.2%,.3) 75%,transparent 0);background-size:9px 9px;z-index:0;color:#000;overflow:hidden}.placeholder-item.level span.label[data-v-be6ea5a4]:after{background-color:green}.placeholder-item.aggregate[data-v-be6ea5a4]{font-family:spread-sheet!important}.placeholder-item.aggregate[data-v-be6ea5a4]:after{content:\"\\e90e\";position:absolute;top:-1px;left:-1px;pointer-events:none;font-size:12px}.placeholder-item.aggregate[data-v-be6ea5a4] .level_label{background:orange}.placeholder-item span.label[data-v-be6ea5a4]{overflow:hidden;text-overflow:ellipsis;font-size:10px;white-space:nowrap;background:#fff;padding:2px 2px 2px 10px;width:calc(100% - 1px);display:inline-block;height:calc(100% - 1px)}.placeholder-item span.label[data-v-be6ea5a4]:after{content:\"\";position:absolute;background-color:red;width:4px;height:4px;border-radius:50%;top:12px;left:2px;pointer-events:none}.placeholder-item[data-v-be6ea5a4] .level_label{border-radius:100%;color:#fff;display:inline-block;font-size:12px;height:16px;line-height:16px;width:16px;text-align:center;white-space:nowrap;background:green;margin-right:2px;-webkit-transform:scale(.8);transform:scale(.8)}.placeholder-item.vertical[data-v-be6ea5a4]:after{content:\"→\";position:absolute;top:-7px;left:-4px;pointer-events:none;-webkit-transform:rotate(90deg);transform:rotate(90deg)}.placeholder-item.horizontal[data-v-be6ea5a4]:after{content:\"→\";position:absolute;top:-3px;left:-6px;pointer-events:none}.placeholder-item.slash[data-v-be6ea5a4]:after{content:\"→\";position:absolute;-webkit-transform:rotate(45deg);transform:rotate(45deg);top:-7px;left:-7px;pointer-events:none}.placeholder-item.local[data-v-be6ea5a4]:after{content:\"•\";position:absolute;top:-6px;left:1px;pointer-events:none}", ""]);
// Exports
module.exports = exports;


/***/ }),

/***/ "2e3e":
/***/ (function(module, exports, __webpack_require__) {

// Imports
var ___CSS_LOADER_API_IMPORT___ = __webpack_require__("24fb");
exports = ___CSS_LOADER_API_IMPORT___(false);
// Module
exports.push([module.i, "._spreadsheet-sort-filter-wraper[data-v-4adca92e]{position:absolute;top:81px;width:100%;height:calc(100% - 122px)}._spreadsheet-sort-filter-wraper ._spreadsheet-sort-filter[data-v-4adca92e]{position:absolute;background:#fff;z-index:100;width:260px;pointer-events:auto;overflow:auto}._spreadsheet-sort-filter-wraper ._spreadsheet-sort-filter ._x-spreadsheet-header[data-v-4adca92e]{padding:.5em .75em;background:#f8f8f9;border-bottom:1px solid #e9e9e9;border-left:1px solid transparent}._spreadsheet-sort-filter-wraper ._spreadsheet-sort-filter ._x-spreadsheet-filter[data-v-4adca92e]{border:1px solid #e9e9e9;font-size:12px;margin:10px}._spreadsheet-sort-filter-wraper ._spreadsheet-sort-filter ._x-spreadsheet-body[data-v-4adca92e]{height:200px;overflow-y:auto}._spreadsheet-sort-filter-wraper ._spreadsheet-sort-filter ._x-spreadsheet-body .el-checkbox[data-v-4adca92e]{display:block}._spreadsheet-sort-filter-wraper ._spreadsheet-sort-filter[data-v-4adca92e]  .el-divider--horizontal{margin:14px 0}._spreadsheet-sort-filter-wraper ._spreadsheet-sort-filter[data-v-4adca92e]  .el-card__body{padding:15px}._spreadsheet-sort-filter-wraper ._spreadsheet-sort-filter[data-v-4adca92e]  .el-checkbox-group{padding-left:10px;padding-right:10px}", ""]);
// Exports
module.exports = exports;


/***/ }),

/***/ "3280":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var ArrayBufferViewCore = __webpack_require__("ebb5");
var apply = __webpack_require__("2ba4");
var $lastIndexOf = __webpack_require__("e58c");

var aTypedArray = ArrayBufferViewCore.aTypedArray;
var exportTypedArrayMethod = ArrayBufferViewCore.exportTypedArrayMethod;

// `%TypedArray%.prototype.lastIndexOf` method
// https://tc39.es/ecma262/#sec-%typedarray%.prototype.lastindexof
exportTypedArrayMethod('lastIndexOf', function lastIndexOf(searchElement /* , fromIndex */) {
  var length = arguments.length;
  return apply($lastIndexOf, aTypedArray(this), length > 1 ? [searchElement, arguments[1]] : [searchElement]);
});


/***/ }),

/***/ "33ba":
/***/ (function(module, exports, __webpack_require__) {

// Imports
var ___CSS_LOADER_API_IMPORT___ = __webpack_require__("24fb");
exports = ___CSS_LOADER_API_IMPORT___(false);
// Module
exports.push([module.i, ".vdr{-ms-touch-action:none;touch-action:none;border:1px dashed #000}.handle,.vdr{position:absolute;-webkit-box-sizing:border-box;box-sizing:border-box}.handle{width:10px;height:10px;background:#eee;border:1px solid #333}.handle-tl{top:-10px;left:-10px;cursor:nw-resize}.handle-tm{top:-10px;left:50%;margin-left:-5px;cursor:n-resize}.handle-tr{top:-10px;right:-10px;cursor:ne-resize}.handle-ml{left:-10px;cursor:w-resize}.handle-ml,.handle-mr{top:50%;margin-top:-5px}.handle-mr{right:-10px;cursor:e-resize}.handle-bl{bottom:-10px;left:-10px;cursor:sw-resize}.handle-bm{bottom:-10px;left:50%;margin-left:-5px;cursor:s-resize}.handle-br{bottom:-10px;right:-10px;cursor:se-resize}@media only screen and (max-width:768px){[class*=handle-]:before{content:\"\";left:-10px;right:-10px;bottom:-10px;top:-10px;position:absolute}}", ""]);
// Exports
module.exports = exports;


/***/ }),

/***/ "3410":
/***/ (function(module, exports, __webpack_require__) {

var $ = __webpack_require__("23e7");
var fails = __webpack_require__("d039");
var toObject = __webpack_require__("7b0b");
var nativeGetPrototypeOf = __webpack_require__("e163");
var CORRECT_PROTOTYPE_GETTER = __webpack_require__("e177");

var FAILS_ON_PRIMITIVES = fails(function () { nativeGetPrototypeOf(1); });

// `Object.getPrototypeOf` method
// https://tc39.es/ecma262/#sec-object.getprototypeof
$({ target: 'Object', stat: true, forced: FAILS_ON_PRIMITIVES, sham: !CORRECT_PROTOTYPE_GETTER }, {
  getPrototypeOf: function getPrototypeOf(it) {
    return nativeGetPrototypeOf(toObject(it));
  }
});



/***/ }),

/***/ "342f":
/***/ (function(module, exports, __webpack_require__) {

var getBuiltIn = __webpack_require__("d066");

module.exports = getBuiltIn('navigator', 'userAgent') || '';


/***/ }),

/***/ "35a1":
/***/ (function(module, exports, __webpack_require__) {

var classof = __webpack_require__("f5df");
var getMethod = __webpack_require__("dc4a");
var Iterators = __webpack_require__("3f8c");
var wellKnownSymbol = __webpack_require__("b622");

var ITERATOR = wellKnownSymbol('iterator');

module.exports = function (it) {
  if (it != undefined) return getMethod(it, ITERATOR)
    || getMethod(it, '@@iterator')
    || Iterators[classof(it)];
};


/***/ }),

/***/ "37e8":
/***/ (function(module, exports, __webpack_require__) {

var DESCRIPTORS = __webpack_require__("83ab");
var definePropertyModule = __webpack_require__("9bf2");
var anObject = __webpack_require__("825a");
var toIndexedObject = __webpack_require__("fc6a");
var objectKeys = __webpack_require__("df75");

// `Object.defineProperties` method
// https://tc39.es/ecma262/#sec-object.defineproperties
// eslint-disable-next-line es/no-object-defineproperties -- safe
module.exports = DESCRIPTORS ? Object.defineProperties : function defineProperties(O, Properties) {
  anObject(O);
  var props = toIndexedObject(Properties);
  var keys = objectKeys(Properties);
  var length = keys.length;
  var index = 0;
  var key;
  while (length > index) definePropertyModule.f(O, key = keys[index++], props[key]);
  return O;
};


/***/ }),

/***/ "3a7b":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var ArrayBufferViewCore = __webpack_require__("ebb5");
var $findIndex = __webpack_require__("b727").findIndex;

var aTypedArray = ArrayBufferViewCore.aTypedArray;
var exportTypedArrayMethod = ArrayBufferViewCore.exportTypedArrayMethod;

// `%TypedArray%.prototype.findIndex` method
// https://tc39.es/ecma262/#sec-%typedarray%.prototype.findindex
exportTypedArrayMethod('findIndex', function findIndex(predicate /* , thisArg */) {
  return $findIndex(aTypedArray(this), predicate, arguments.length > 1 ? arguments[1] : undefined);
});


/***/ }),

/***/ "3a9b":
/***/ (function(module, exports, __webpack_require__) {

var uncurryThis = __webpack_require__("e330");

module.exports = uncurryThis({}.isPrototypeOf);


/***/ }),

/***/ "3bbe":
/***/ (function(module, exports, __webpack_require__) {

var global = __webpack_require__("da84");
var isCallable = __webpack_require__("1626");

var String = global.String;
var TypeError = global.TypeError;

module.exports = function (argument) {
  if (typeof argument == 'object' || isCallable(argument)) return argument;
  throw TypeError("Can't set " + String(argument) + ' as a prototype');
};


/***/ }),

/***/ "3be5":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var _node_modules_vue_style_loader_index_js_ref_9_oneOf_1_0_node_modules_css_loader_dist_cjs_js_ref_9_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_9_oneOf_1_2_node_modules_postcss_loader_src_index_js_ref_9_oneOf_1_3_node_modules_sass_loader_dist_cjs_js_ref_9_oneOf_1_4_node_modules_cache_loader_dist_cjs_js_ref_1_0_node_modules_vue_loader_lib_index_js_vue_loader_options_index_vue_vue_type_style_index_0_id_d7e4c994_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("128c");
/* harmony import */ var _node_modules_vue_style_loader_index_js_ref_9_oneOf_1_0_node_modules_css_loader_dist_cjs_js_ref_9_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_9_oneOf_1_2_node_modules_postcss_loader_src_index_js_ref_9_oneOf_1_3_node_modules_sass_loader_dist_cjs_js_ref_9_oneOf_1_4_node_modules_cache_loader_dist_cjs_js_ref_1_0_node_modules_vue_loader_lib_index_js_vue_loader_options_index_vue_vue_type_style_index_0_id_d7e4c994_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_node_modules_vue_style_loader_index_js_ref_9_oneOf_1_0_node_modules_css_loader_dist_cjs_js_ref_9_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_9_oneOf_1_2_node_modules_postcss_loader_src_index_js_ref_9_oneOf_1_3_node_modules_sass_loader_dist_cjs_js_ref_9_oneOf_1_4_node_modules_cache_loader_dist_cjs_js_ref_1_0_node_modules_vue_loader_lib_index_js_vue_loader_options_index_vue_vue_type_style_index_0_id_d7e4c994_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0__);
/* unused harmony reexport * */


/***/ }),

/***/ "3c35":
/***/ (function(module, exports) {

/* WEBPACK VAR INJECTION */(function(__webpack_amd_options__) {/* globals __webpack_amd_options__ */
module.exports = __webpack_amd_options__;

/* WEBPACK VAR INJECTION */}.call(this, {}))

/***/ }),

/***/ "3c5d":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var global = __webpack_require__("da84");
var ArrayBufferViewCore = __webpack_require__("ebb5");
var lengthOfArrayLike = __webpack_require__("07fa");
var toOffset = __webpack_require__("182d");
var toObject = __webpack_require__("7b0b");
var fails = __webpack_require__("d039");

var RangeError = global.RangeError;
var aTypedArray = ArrayBufferViewCore.aTypedArray;
var exportTypedArrayMethod = ArrayBufferViewCore.exportTypedArrayMethod;

var FORCED = fails(function () {
  // eslint-disable-next-line es/no-typed-arrays -- required for testing
  new Int8Array(1).set({});
});

// `%TypedArray%.prototype.set` method
// https://tc39.es/ecma262/#sec-%typedarray%.prototype.set
exportTypedArrayMethod('set', function set(arrayLike /* , offset */) {
  aTypedArray(this);
  var offset = toOffset(arguments.length > 1 ? arguments[1] : undefined, 1);
  var length = this.length;
  var src = toObject(arrayLike);
  var len = lengthOfArrayLike(src);
  var index = 0;
  if (len + offset > length) throw RangeError('Wrong length');
  while (index < len) this[offset + index] = src[index++];
}, FORCED);


/***/ }),

/***/ "3ca3":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var charAt = __webpack_require__("6547").charAt;
var toString = __webpack_require__("577e");
var InternalStateModule = __webpack_require__("69f3");
var defineIterator = __webpack_require__("7dd0");

var STRING_ITERATOR = 'String Iterator';
var setInternalState = InternalStateModule.set;
var getInternalState = InternalStateModule.getterFor(STRING_ITERATOR);

// `String.prototype[@@iterator]` method
// https://tc39.es/ecma262/#sec-string.prototype-@@iterator
defineIterator(String, 'String', function (iterated) {
  setInternalState(this, {
    type: STRING_ITERATOR,
    string: toString(iterated),
    index: 0
  });
// `%StringIteratorPrototype%.next` method
// https://tc39.es/ecma262/#sec-%stringiteratorprototype%.next
}, function next() {
  var state = getInternalState(this);
  var string = state.string;
  var index = state.index;
  var point;
  if (index >= string.length) return { value: undefined, done: true };
  point = charAt(string, index);
  state.index += point.length;
  return { value: point, done: false };
});


/***/ }),

/***/ "3f4c":
/***/ (function(module, exports, __webpack_require__) {

// Imports
var ___CSS_LOADER_API_IMPORT___ = __webpack_require__("24fb");
exports = ___CSS_LOADER_API_IMPORT___(false);
// Module
exports.push([module.i, ".rect-content[data-v-d7e4c994]{position:absolute;pointer-events:none;overflow:hidden}.rect-content .rect-item[data-v-d7e4c994]{position:absolute;display:inline-block;border:2px dashed red}.rect-content .rect-item span[data-v-d7e4c994]{font-size:12px;top:-2px;left:-2px;color:#fff}.rect-content .rect-item span[data-v-d7e4c994],.rect-content .rect-row-item[data-v-d7e4c994]{display:inline-block;position:absolute}.rect-content .rect-row-item span[data-v-d7e4c994]{display:inline-block;font-size:12px;vertical-align:middle;text-align:right}.rect-content .row-io[data-v-d7e4c994]{left:3px;width:16px}", ""]);
// Exports
module.exports = exports;


/***/ }),

/***/ "3f8c":
/***/ (function(module, exports) {

module.exports = {};


/***/ }),

/***/ "3fcc":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var ArrayBufferViewCore = __webpack_require__("ebb5");
var $map = __webpack_require__("b727").map;
var typedArraySpeciesConstructor = __webpack_require__("b6b7");

var aTypedArray = ArrayBufferViewCore.aTypedArray;
var exportTypedArrayMethod = ArrayBufferViewCore.exportTypedArrayMethod;

// `%TypedArray%.prototype.map` method
// https://tc39.es/ecma262/#sec-%typedarray%.prototype.map
exportTypedArrayMethod('map', function map(mapfn /* , thisArg */) {
  return $map(aTypedArray(this), mapfn, arguments.length > 1 ? arguments[1] : undefined, function (O, length) {
    return new (typedArraySpeciesConstructor(O))(length);
  });
});


/***/ }),

/***/ "4064":
/***/ (function(module, exports, __webpack_require__) {

// Imports
var ___CSS_LOADER_API_IMPORT___ = __webpack_require__("24fb");
exports = ___CSS_LOADER_API_IMPORT___(false);
// Module
exports.push([module.i, ".el-dialog__lookUp{pointer-events:none}.el-dialog__lookUp .el-dialog{pointer-events:auto}.el-dialog__lookUp .el-dialog .el-input__inner:focus~.el-input-group__append{border-color:#015cbf}.el-dialog__lookUp .el-dialog .el-input-group__append{padding:0 10px;background-color:#fff;left:-1px;color:#909399;font-size:12px}", ""]);
// Exports
module.exports = exports;


/***/ }),

/***/ "408a":
/***/ (function(module, exports, __webpack_require__) {

var uncurryThis = __webpack_require__("e330");

// `thisNumberValue` abstract operation
// https://tc39.es/ecma262/#sec-thisnumbervalue
module.exports = uncurryThis(1.0.valueOf);


/***/ }),

/***/ "428f":
/***/ (function(module, exports, __webpack_require__) {

var global = __webpack_require__("da84");

module.exports = global;


/***/ }),

/***/ "4316":
/***/ (function(module, exports, __webpack_require__) {

// style-loader: Adds some css to the DOM by adding a <style> tag

// load the styles
var content = __webpack_require__("2d0d");
if(content.__esModule) content = content.default;
if(typeof content === 'string') content = [[module.i, content, '']];
if(content.locals) module.exports = content.locals;
// add the styles to the DOM
var add = __webpack_require__("499e").default
var update = add("341f305e", content, true, {"sourceMap":false,"shadowMode":false});

/***/ }),

/***/ "4362":
/***/ (function(module, exports, __webpack_require__) {

exports.nextTick = function nextTick(fn) {
    var args = Array.prototype.slice.call(arguments);
    args.shift();
    setTimeout(function () {
        fn.apply(null, args);
    }, 0);
};

exports.platform = exports.arch = 
exports.execPath = exports.title = 'browser';
exports.pid = 1;
exports.browser = true;
exports.env = {};
exports.argv = [];

exports.binding = function (name) {
	throw new Error('No such module. (Possibly not yet loaded)')
};

(function () {
    var cwd = '/';
    var path;
    exports.cwd = function () { return cwd };
    exports.chdir = function (dir) {
        if (!path) path = __webpack_require__("df7c");
        cwd = path.resolve(dir, cwd);
    };
})();

exports.exit = exports.kill = 
exports.umask = exports.dlopen = 
exports.uptime = exports.memoryUsage = 
exports.uvCounters = function() {};
exports.features = {};


/***/ }),

/***/ "43d7":
/***/ (function(module, exports) {

module.exports = "data:font/woff;base64,d09GRgABAAAAAAtoAAsAAAAAEXwAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAABHU1VCAAABCAAAADsAAABUIIslek9TLzIAAAFEAAAARAAAAGA8F0veY21hcAAAAYgAAADiAAACtjsm1XBnbHlmAAACbAAABmAAAAjogQu/r2hlYWQAAAjMAAAALwAAADYjiwa7aGhlYQAACPwAAAAcAAAAJAfeA5RobXR4AAAJGAAAAA8AAABMTAAAAGxvY2EAAAkoAAAAKAAAACgUthaobWF4cAAACVAAAAAfAAAAIAEoAHBuYW1lAAAJcAAAAVEAAAKXiHEnSHBvc3QAAArEAAAAogAAAOFCTK1TeJxjYGRgYOBiMGCwY2BycfMJYeDLSSzJY5BiYGGAAJA8MpsxJzM9kYEDxgPKsYBpDiBmg4gCACY7BUgAeJxjYGFhYJzAwMrAwNTJdIaBgaEfQjO+ZjBi5ACKMrAyM2AFAWmuKQwHnjG95GNu+N/AwMB8hwFIMjCiKGICAGRvDHN4nOWSy20CQRBE3/LzZ9fDLjdWFgfLMhwcAmkQCtkQAoH45DAKEwTC1ds+WJaIwD16I02XNN0z1cAUGJt3M4Hqk4qID2erIT/mcchPOPjc00ZGIzXq1Guljbbaaa/j6XIu1ytYq1W0tLb+q92Iyvf2PPPCq9fbrwVPVkeuPnXdGR0L7tzRPXMeKDTU7ohqdvPu/xPNsH/9nBbhROI/RHUSrqpJCL0k4b7mSUyF2iSmQ13i/0fLhMj1yVBrldgdtE5icrRJ7BjaJkSdXWIX0T4hejkm8ZrTJbHHnEtC+w0ntU+EAAB4nI1Wa2wc1RW+59557SY76/G87MWPzI53N911vPbM7o6ToPWGpFEi8Yhjz6QYUJyA8J8SAvlRCqh1WtFWpemDNK7oQ6pUqVTrX0T8BJFUqEFCov3RJC0NtIK2KqrEQ4KKSp4x587aCQh+sJp77r3nnnPudx733iUCIet/YBdYmzAiky0kT4joaA5g0x3T0X3NZS+ufYt9Y+3P9G9x6Q66M770wezsLva1tdfo5eSFw7A/vkQIan/azqesfMbCDXVUJQrqvsgushoxyAApEZ8EpEOOknsJAc+2RsE0pDy4xXIdmo1W4DPTaZYA+b7XmkFWRfasnsQEIAM0VwNNBXkYXE2XeFdUU3HTGOECTd9rQ2qsrKMsO1EcMBhURzPXRusMaqPKU0nIOsnVXL98zdhGoc+RFFEUjooZkEQh6XSh69ZZuCbSoqhQZBXlbAbAkTJUlkrqM13oDBjDPWvc6rYJIflvGL6d/EWlMGTI1yztlUxWAZC3oBo8maxCCFFye+7mcnaZrsaXmSg46RpuzLfcmCgKPL5OgIeM8LxdZqsYs+t5K2FYer67msj9Wl3rAkGw/KtFEXR7G8UhXV1NCE3tbPmMHZ3Y5CYySlxSITXMgOZoIq8E02062Eqf6N2N8WbjOzISR7QbRXEUsZRS0o1CSkIgfAa1pAtRhJBC/K2mJLr++wJ4dMRTcpoOa/ror2+Kn+j9jfFmC1kUE9rFbTmktS6nCYeTkHCd8BlcxsB3o24SfT6ctK5fY1P0A0Rik22E2JrjWViQsjnC69JlJlZhs7HZl923oXD6zJG9c/c//cTyoV17nzhwX+fggVtKbPDeI51jOs3ef/tXv0l/8VLg3ZU8/9fdTS/gmVh/nW2lH+JuGu6AsWV9bnEQfM3wvabmf0itwY/emfvNL+eLTbEJP03eAQW+lzz+++fh+z2MSE7T/5MimSRzWAmyKxXrUK6U22DZCNT2LW8G2hQ5Fd+SZEn3RsBQwXWK5UbL56fMtlRUaE4A6hXzoFLk2G65FeCBaXn0x4ze/PQ+4dEc1UdsKtTHofVYXRibVI2b1P4HS9Qt/SDbl8UvPpA3zTz8B+jXt4I+jLI7qqz5yA5hbEI1Cqp2YowWx2bE3T8bo4Uh6DySt1l/HrbP2JYB6uTO6YGcPPVwfQqWsn1GX9YcMWEapVSUUmF726YmitV37bR7YoO0sOE/vUCvbN49YLMKYAXo2GitulwFc50srxP6khIvK/Qn1Wq8XK1uxG2Z7cEaG8QKI7qDYTG1XmAmoKk12iA6oDXKgNSwfk2XC+MF/OJeT38en6Fn9fgUPRU/oLPOjZVCKtmJH6CncnrcoWfjMzk9hYm5voB3XQf3G8dM1aHNbzBMTFHGvBg8EVhIAV5XltdqlBAGguhli3WvKEPDk/VDcxcPz9YnJ+uzh481jtcEetVsj8dv3XJyz56T3+Zk5qpUO944til0ce5QfXJ4SGRXrPH2xQ0ZJGSjvt9kv2IW3r1fIvsxdjdweAFmP8XGipw2+DwtFYPL6LxOELdkjAJq8AqzOeY6oBYVTh69pzU93brn6N83Bw/eF81N+f7UXPRyOD/leVPzYSibyrkV2cor584peVNZOaeY6ZiZXOONxbuD6eng7sU3uI21/6W6aAR1ewOf1mR5ZUXOb5pZWVHylszN9HxbZ6cZkD68OZr8NUnjeMMZPajkwcbzjK8HeoSeBRXsJyBo6OgJ983yKVk6v7R0/o8LR/xGwz+yEN7ad5eYVTKgNCSgurZjUjFyoizCvv5CwR0c7Geo8Or5JS77J64UX/2IblUhp+QGnjFyxhAIC4qzVQRZkKE96HKl3q3O9tGdvEJK4FCSvEC/cwkeRnZv7Vb6D3IQJwirBvyE8icMh0Eb30E7KLvF9AlERyzfZuiL7wW6b1vIMKzdwM8/fwT5sNVoVsoBO0hFdkBgjzJJgBkm/i4j19whUx0u3DafzxyTYQsIbPFOJPtkWPjul6nwXE/hMSoLsIeJHUFYpAJVcUqfoiDAD4V6dbu4V9p/myc1mATJYSaCBM8+KQqvoBA7y4V+JIoivSSy1C+8W/9J/01E/L8AgQg2LCa/vQMobXylBP7Cv+jx2ev+P4RyeLZLGahkQM6AnQF2InkftPnk3eS9EPLJuyFokD/BSZS8B/0hLryfLpCPAXPPz654nGNgZGBgAOKa/ifX4/ltvjJwszCAwAPTh/EI+v9+FgZmRyCXg4EJJAoAT+ALMQB4nGNgZGBgbvjfwBDDwgACQJKRARUIAwBHGQJ8eJxjYWBgYKESBgAMLABNAAAAAAAAJABCANwBAAFIAZABwgHiAmICfgK4AwADbgPEA9IEPgRSBHR4nGNgZGBgEGZIYeBmAAEmIOYCQgaG/2A+AwAVDAGZAHicdZDNasJAFIVP/CvV0kILxV1nUzfF+LMU2o2gdCvUvSYTjcRMmIyCu76DT9PH6Au0j9Ftj/EWpGDCHL575t6TSwDc4gsejs8dz5E9XLE6cgkXeBAu028JV8h94SoaeBGu0X8VruMJb8INJr4zwatcsmphL+yhiQ/hEq7xKVym/y1cIf8IV3Hv3QjX0PQeheuYes/CDbS8/dDqmdOhmu9UHJg0MqnLM3phO19q7SZ6sUlm9tQ65am2eWxS1fO7p/ZYp9r+xebbRd+5SEXWrNWI+TpJjMqsWenA+UvnskGnE4nvB2aNISw0ZnDUEApz7KgxAhikiAp1yJFJX4g2qyVZ059QF9gg4Y0923XOn1IPU3HxFYUefHTPdo+paTHxf9scW27Rp+u4seKxTFyTRrK/5oYJWRXZBis6AX2f6YepDAN0+Eb/+v3iP6x/AYaJehkAAAB4nG3GWVLDMBBFUT3HlgfAJHG2wXJYgCy3cROl29FQ2T5VDH+cn3tNZX4M5n8TKhxQo4FFiw49BjzhGS8Y8YojTjhjwsX0upO85Ug0+KCJvndcVD6y47SVz3Iv7W+H2enMTh/Ef5u11LOGpS+yUAwsZFOOfCXL2QX2TQoubTaoXt/3hmLUWLOsahMF8rlbi/jMKq1XWTnerHfiKRjzBYGnOGUAAA=="

/***/ }),

/***/ "44ad":
/***/ (function(module, exports, __webpack_require__) {

var global = __webpack_require__("da84");
var uncurryThis = __webpack_require__("e330");
var fails = __webpack_require__("d039");
var classof = __webpack_require__("c6b6");

var Object = global.Object;
var split = uncurryThis(''.split);

// fallback for non-array-like ES3 and non-enumerable old V8 strings
module.exports = fails(function () {
  // throws an error in rhino, see https://github.com/mozilla/rhino/issues/346
  // eslint-disable-next-line no-prototype-builtins -- safe
  return !Object('z').propertyIsEnumerable(0);
}) ? function (it) {
  return classof(it) == 'String' ? split(it, '') : Object(it);
} : Object;


/***/ }),

/***/ "44d2":
/***/ (function(module, exports, __webpack_require__) {

var wellKnownSymbol = __webpack_require__("b622");
var create = __webpack_require__("7c73");
var definePropertyModule = __webpack_require__("9bf2");

var UNSCOPABLES = wellKnownSymbol('unscopables');
var ArrayPrototype = Array.prototype;

// Array.prototype[@@unscopables]
// https://tc39.es/ecma262/#sec-array.prototype-@@unscopables
if (ArrayPrototype[UNSCOPABLES] == undefined) {
  definePropertyModule.f(ArrayPrototype, UNSCOPABLES, {
    configurable: true,
    value: create(null)
  });
}

// add a key to Array.prototype[@@unscopables]
module.exports = function (key) {
  ArrayPrototype[UNSCOPABLES][key] = true;
};


/***/ }),

/***/ "44de":
/***/ (function(module, exports, __webpack_require__) {

var global = __webpack_require__("da84");

module.exports = function (a, b) {
  var console = global.console;
  if (console && console.error) {
    arguments.length == 1 ? console.error(a) : console.error(a, b);
  }
};


/***/ }),

/***/ "44e7":
/***/ (function(module, exports, __webpack_require__) {

var isObject = __webpack_require__("861d");
var classof = __webpack_require__("c6b6");
var wellKnownSymbol = __webpack_require__("b622");

var MATCH = wellKnownSymbol('match');

// `IsRegExp` abstract operation
// https://tc39.es/ecma262/#sec-isregexp
module.exports = function (it) {
  var isRegExp;
  return isObject(it) && ((isRegExp = it[MATCH]) !== undefined ? !!isRegExp : classof(it) == 'RegExp');
};


/***/ }),

/***/ "466d":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var call = __webpack_require__("c65b");
var fixRegExpWellKnownSymbolLogic = __webpack_require__("d784");
var anObject = __webpack_require__("825a");
var toLength = __webpack_require__("50c4");
var toString = __webpack_require__("577e");
var requireObjectCoercible = __webpack_require__("1d80");
var getMethod = __webpack_require__("dc4a");
var advanceStringIndex = __webpack_require__("8aa5");
var regExpExec = __webpack_require__("14c3");

// @@match logic
fixRegExpWellKnownSymbolLogic('match', function (MATCH, nativeMatch, maybeCallNative) {
  return [
    // `String.prototype.match` method
    // https://tc39.es/ecma262/#sec-string.prototype.match
    function match(regexp) {
      var O = requireObjectCoercible(this);
      var matcher = regexp == undefined ? undefined : getMethod(regexp, MATCH);
      return matcher ? call(matcher, regexp, O) : new RegExp(regexp)[MATCH](toString(O));
    },
    // `RegExp.prototype[@@match]` method
    // https://tc39.es/ecma262/#sec-regexp.prototype-@@match
    function (string) {
      var rx = anObject(this);
      var S = toString(string);
      var res = maybeCallNative(nativeMatch, rx, S);

      if (res.done) return res.value;

      if (!rx.global) return regExpExec(rx, S);

      var fullUnicode = rx.unicode;
      rx.lastIndex = 0;
      var A = [];
      var n = 0;
      var result;
      while ((result = regExpExec(rx, S)) !== null) {
        var matchStr = toString(result[0]);
        A[n] = matchStr;
        if (matchStr === '') rx.lastIndex = advanceStringIndex(S, toLength(rx.lastIndex), fullUnicode);
        n++;
      }
      return n === 0 ? null : A;
    }
  ];
});


/***/ }),

/***/ "4840":
/***/ (function(module, exports, __webpack_require__) {

var anObject = __webpack_require__("825a");
var aConstructor = __webpack_require__("5087");
var wellKnownSymbol = __webpack_require__("b622");

var SPECIES = wellKnownSymbol('species');

// `SpeciesConstructor` abstract operation
// https://tc39.es/ecma262/#sec-speciesconstructor
module.exports = function (O, defaultConstructor) {
  var C = anObject(O).constructor;
  var S;
  return C === undefined || (S = anObject(C)[SPECIES]) == undefined ? defaultConstructor : aConstructor(S);
};


/***/ }),

/***/ "485a":
/***/ (function(module, exports, __webpack_require__) {

var global = __webpack_require__("da84");
var call = __webpack_require__("c65b");
var isCallable = __webpack_require__("1626");
var isObject = __webpack_require__("861d");

var TypeError = global.TypeError;

// `OrdinaryToPrimitive` abstract operation
// https://tc39.es/ecma262/#sec-ordinarytoprimitive
module.exports = function (input, pref) {
  var fn, val;
  if (pref === 'string' && isCallable(fn = input.toString) && !isObject(val = call(fn, input))) return val;
  if (isCallable(fn = input.valueOf) && !isObject(val = call(fn, input))) return val;
  if (pref !== 'string' && isCallable(fn = input.toString) && !isObject(val = call(fn, input))) return val;
  throw TypeError("Can't convert object to primitive value");
};


/***/ }),

/***/ "4930":
/***/ (function(module, exports, __webpack_require__) {

/* eslint-disable es/no-symbol -- required for testing */
var V8_VERSION = __webpack_require__("2d00");
var fails = __webpack_require__("d039");

// eslint-disable-next-line es/no-object-getownpropertysymbols -- required for testing
module.exports = !!Object.getOwnPropertySymbols && !fails(function () {
  var symbol = Symbol();
  // Chrome 38 Symbol has incorrect toString conversion
  // `get-own-property-symbols` polyfill symbols converted to object are not Symbol instances
  return !String(symbol) || !(Object(symbol) instanceof Symbol) ||
    // Chrome 38-40 symbols are not inherited from DOM collections prototypes to instances
    !Symbol.sham && V8_VERSION && V8_VERSION < 41;
});


/***/ }),

/***/ "498a":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var $ = __webpack_require__("23e7");
var $trim = __webpack_require__("58a8").trim;
var forcedStringTrimMethod = __webpack_require__("c8d2");

// `String.prototype.trim` method
// https://tc39.es/ecma262/#sec-string.prototype.trim
$({ target: 'String', proto: true, forced: forcedStringTrimMethod('trim') }, {
  trim: function trim() {
    return $trim(this);
  }
});


/***/ }),

/***/ "499e":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__);

// EXPORTS
__webpack_require__.d(__webpack_exports__, "default", function() { return /* binding */ addStylesClient; });

// CONCATENATED MODULE: ./node_modules/vue-style-loader/lib/listToStyles.js
/**
 * Translates the list format produced by css-loader into something
 * easier to manipulate.
 */
function listToStyles (parentId, list) {
  var styles = []
  var newStyles = {}
  for (var i = 0; i < list.length; i++) {
    var item = list[i]
    var id = item[0]
    var css = item[1]
    var media = item[2]
    var sourceMap = item[3]
    var part = {
      id: parentId + ':' + i,
      css: css,
      media: media,
      sourceMap: sourceMap
    }
    if (!newStyles[id]) {
      styles.push(newStyles[id] = { id: id, parts: [part] })
    } else {
      newStyles[id].parts.push(part)
    }
  }
  return styles
}

// CONCATENATED MODULE: ./node_modules/vue-style-loader/lib/addStylesClient.js
/*
  MIT License http://www.opensource.org/licenses/mit-license.php
  Author Tobias Koppers @sokra
  Modified by Evan You @yyx990803
*/



var hasDocument = typeof document !== 'undefined'

if (typeof DEBUG !== 'undefined' && DEBUG) {
  if (!hasDocument) {
    throw new Error(
    'vue-style-loader cannot be used in a non-browser environment. ' +
    "Use { target: 'node' } in your Webpack config to indicate a server-rendering environment."
  ) }
}

/*
type StyleObject = {
  id: number;
  parts: Array<StyleObjectPart>
}

type StyleObjectPart = {
  css: string;
  media: string;
  sourceMap: ?string
}
*/

var stylesInDom = {/*
  [id: number]: {
    id: number,
    refs: number,
    parts: Array<(obj?: StyleObjectPart) => void>
  }
*/}

var head = hasDocument && (document.head || document.getElementsByTagName('head')[0])
var singletonElement = null
var singletonCounter = 0
var isProduction = false
var noop = function () {}
var options = null
var ssrIdKey = 'data-vue-ssr-id'

// Force single-tag solution on IE6-9, which has a hard limit on the # of <style>
// tags it will allow on a page
var isOldIE = typeof navigator !== 'undefined' && /msie [6-9]\b/.test(navigator.userAgent.toLowerCase())

function addStylesClient (parentId, list, _isProduction, _options) {
  isProduction = _isProduction

  options = _options || {}

  var styles = listToStyles(parentId, list)
  addStylesToDom(styles)

  return function update (newList) {
    var mayRemove = []
    for (var i = 0; i < styles.length; i++) {
      var item = styles[i]
      var domStyle = stylesInDom[item.id]
      domStyle.refs--
      mayRemove.push(domStyle)
    }
    if (newList) {
      styles = listToStyles(parentId, newList)
      addStylesToDom(styles)
    } else {
      styles = []
    }
    for (var i = 0; i < mayRemove.length; i++) {
      var domStyle = mayRemove[i]
      if (domStyle.refs === 0) {
        for (var j = 0; j < domStyle.parts.length; j++) {
          domStyle.parts[j]()
        }
        delete stylesInDom[domStyle.id]
      }
    }
  }
}

function addStylesToDom (styles /* Array<StyleObject> */) {
  for (var i = 0; i < styles.length; i++) {
    var item = styles[i]
    var domStyle = stylesInDom[item.id]
    if (domStyle) {
      domStyle.refs++
      for (var j = 0; j < domStyle.parts.length; j++) {
        domStyle.parts[j](item.parts[j])
      }
      for (; j < item.parts.length; j++) {
        domStyle.parts.push(addStyle(item.parts[j]))
      }
      if (domStyle.parts.length > item.parts.length) {
        domStyle.parts.length = item.parts.length
      }
    } else {
      var parts = []
      for (var j = 0; j < item.parts.length; j++) {
        parts.push(addStyle(item.parts[j]))
      }
      stylesInDom[item.id] = { id: item.id, refs: 1, parts: parts }
    }
  }
}

function createStyleElement () {
  var styleElement = document.createElement('style')
  styleElement.type = 'text/css'
  head.appendChild(styleElement)
  return styleElement
}

function addStyle (obj /* StyleObjectPart */) {
  var update, remove
  var styleElement = document.querySelector('style[' + ssrIdKey + '~="' + obj.id + '"]')

  if (styleElement) {
    if (isProduction) {
      // has SSR styles and in production mode.
      // simply do nothing.
      return noop
    } else {
      // has SSR styles but in dev mode.
      // for some reason Chrome can't handle source map in server-rendered
      // style tags - source maps in <style> only works if the style tag is
      // created and inserted dynamically. So we remove the server rendered
      // styles and inject new ones.
      styleElement.parentNode.removeChild(styleElement)
    }
  }

  if (isOldIE) {
    // use singleton mode for IE9.
    var styleIndex = singletonCounter++
    styleElement = singletonElement || (singletonElement = createStyleElement())
    update = applyToSingletonTag.bind(null, styleElement, styleIndex, false)
    remove = applyToSingletonTag.bind(null, styleElement, styleIndex, true)
  } else {
    // use multi-style-tag mode in all other cases
    styleElement = createStyleElement()
    update = applyToTag.bind(null, styleElement)
    remove = function () {
      styleElement.parentNode.removeChild(styleElement)
    }
  }

  update(obj)

  return function updateStyle (newObj /* StyleObjectPart */) {
    if (newObj) {
      if (newObj.css === obj.css &&
          newObj.media === obj.media &&
          newObj.sourceMap === obj.sourceMap) {
        return
      }
      update(obj = newObj)
    } else {
      remove()
    }
  }
}

var replaceText = (function () {
  var textStore = []

  return function (index, replacement) {
    textStore[index] = replacement
    return textStore.filter(Boolean).join('\n')
  }
})()

function applyToSingletonTag (styleElement, index, remove, obj) {
  var css = remove ? '' : obj.css

  if (styleElement.styleSheet) {
    styleElement.styleSheet.cssText = replaceText(index, css)
  } else {
    var cssNode = document.createTextNode(css)
    var childNodes = styleElement.childNodes
    if (childNodes[index]) styleElement.removeChild(childNodes[index])
    if (childNodes.length) {
      styleElement.insertBefore(cssNode, childNodes[index])
    } else {
      styleElement.appendChild(cssNode)
    }
  }
}

function applyToTag (styleElement, obj) {
  var css = obj.css
  var media = obj.media
  var sourceMap = obj.sourceMap

  if (media) {
    styleElement.setAttribute('media', media)
  }
  if (options.ssrId) {
    styleElement.setAttribute(ssrIdKey, obj.id)
  }

  if (sourceMap) {
    // https://developer.chrome.com/devtools/docs/javascript-debugging
    // this makes source maps inside style tags work properly in Chrome
    css += '\n/*# sourceURL=' + sourceMap.sources[0] + ' */'
    // http://stackoverflow.com/a/26603875
    css += '\n/*# sourceMappingURL=data:application/json;base64,' + btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))) + ' */'
  }

  if (styleElement.styleSheet) {
    styleElement.styleSheet.cssText = css
  } else {
    while (styleElement.firstChild) {
      styleElement.removeChild(styleElement.firstChild)
    }
    styleElement.appendChild(document.createTextNode(css))
  }
}


/***/ }),

/***/ "4ad2":
/***/ (function(module, exports, __webpack_require__) {

// style-loader: Adds some css to the DOM by adding a <style> tag

// load the styles
var content = __webpack_require__("0e39");
if(content.__esModule) content = content.default;
if(typeof content === 'string') content = [[module.i, content, '']];
if(content.locals) module.exports = content.locals;
// add the styles to the DOM
var add = __webpack_require__("499e").default
var update = add("b55f8566", content, true, {"sourceMap":false,"shadowMode":false});

/***/ }),

/***/ "4ae1":
/***/ (function(module, exports, __webpack_require__) {

var $ = __webpack_require__("23e7");
var getBuiltIn = __webpack_require__("d066");
var apply = __webpack_require__("2ba4");
var bind = __webpack_require__("0538");
var aConstructor = __webpack_require__("5087");
var anObject = __webpack_require__("825a");
var isObject = __webpack_require__("861d");
var create = __webpack_require__("7c73");
var fails = __webpack_require__("d039");

var nativeConstruct = getBuiltIn('Reflect', 'construct');
var ObjectPrototype = Object.prototype;
var push = [].push;

// `Reflect.construct` method
// https://tc39.es/ecma262/#sec-reflect.construct
// MS Edge supports only 2 arguments and argumentsList argument is optional
// FF Nightly sets third argument as `new.target`, but does not create `this` from it
var NEW_TARGET_BUG = fails(function () {
  function F() { /* empty */ }
  return !(nativeConstruct(function () { /* empty */ }, [], F) instanceof F);
});

var ARGS_BUG = !fails(function () {
  nativeConstruct(function () { /* empty */ });
});

var FORCED = NEW_TARGET_BUG || ARGS_BUG;

$({ target: 'Reflect', stat: true, forced: FORCED, sham: FORCED }, {
  construct: function construct(Target, args /* , newTarget */) {
    aConstructor(Target);
    anObject(args);
    var newTarget = arguments.length < 3 ? Target : aConstructor(arguments[2]);
    if (ARGS_BUG && !NEW_TARGET_BUG) return nativeConstruct(Target, args, newTarget);
    if (Target == newTarget) {
      // w/o altered newTarget, optimization for 0-4 arguments
      switch (args.length) {
        case 0: return new Target();
        case 1: return new Target(args[0]);
        case 2: return new Target(args[0], args[1]);
        case 3: return new Target(args[0], args[1], args[2]);
        case 4: return new Target(args[0], args[1], args[2], args[3]);
      }
      // w/o altered newTarget, lot of arguments case
      var $args = [null];
      apply(push, $args, args);
      return new (apply(bind, Target, $args))();
    }
    // with altered newTarget, not support built-in constructors
    var proto = newTarget.prototype;
    var instance = create(isObject(proto) ? proto : ObjectPrototype);
    var result = apply(Target, instance, args);
    return isObject(result) ? result : instance;
  }
});


/***/ }),

/***/ "4c53":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var $ = __webpack_require__("23e7");
var createHTML = __webpack_require__("857a");
var forcedStringHTMLMethod = __webpack_require__("af03");

// `String.prototype.sub` method
// https://tc39.es/ecma262/#sec-string.prototype.sub
$({ target: 'String', proto: true, forced: forcedStringHTMLMethod('sub') }, {
  sub: function sub() {
    return createHTML(this, 'sub', '', '');
  }
});


/***/ }),

/***/ "4cd2":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var _node_modules_vue_style_loader_index_js_ref_9_oneOf_1_0_node_modules_css_loader_dist_cjs_js_ref_9_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_9_oneOf_1_2_node_modules_postcss_loader_src_index_js_ref_9_oneOf_1_3_node_modules_sass_loader_dist_cjs_js_ref_9_oneOf_1_4_node_modules_cache_loader_dist_cjs_js_ref_1_0_node_modules_vue_loader_lib_index_js_vue_loader_options_index_vue_vue_type_style_index_0_id_03bc0e3c_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("4ad2");
/* harmony import */ var _node_modules_vue_style_loader_index_js_ref_9_oneOf_1_0_node_modules_css_loader_dist_cjs_js_ref_9_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_9_oneOf_1_2_node_modules_postcss_loader_src_index_js_ref_9_oneOf_1_3_node_modules_sass_loader_dist_cjs_js_ref_9_oneOf_1_4_node_modules_cache_loader_dist_cjs_js_ref_1_0_node_modules_vue_loader_lib_index_js_vue_loader_options_index_vue_vue_type_style_index_0_id_03bc0e3c_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_node_modules_vue_style_loader_index_js_ref_9_oneOf_1_0_node_modules_css_loader_dist_cjs_js_ref_9_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_9_oneOf_1_2_node_modules_postcss_loader_src_index_js_ref_9_oneOf_1_3_node_modules_sass_loader_dist_cjs_js_ref_9_oneOf_1_4_node_modules_cache_loader_dist_cjs_js_ref_1_0_node_modules_vue_loader_lib_index_js_vue_loader_options_index_vue_vue_type_style_index_0_id_03bc0e3c_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0__);
/* unused harmony reexport * */


/***/ }),

/***/ "4d63":
/***/ (function(module, exports, __webpack_require__) {

var DESCRIPTORS = __webpack_require__("83ab");
var global = __webpack_require__("da84");
var uncurryThis = __webpack_require__("e330");
var isForced = __webpack_require__("94ca");
var inheritIfRequired = __webpack_require__("7156");
var createNonEnumerableProperty = __webpack_require__("9112");
var defineProperty = __webpack_require__("9bf2").f;
var getOwnPropertyNames = __webpack_require__("241c").f;
var isPrototypeOf = __webpack_require__("3a9b");
var isRegExp = __webpack_require__("44e7");
var toString = __webpack_require__("577e");
var regExpFlags = __webpack_require__("ad6d");
var stickyHelpers = __webpack_require__("9f7f");
var redefine = __webpack_require__("6eeb");
var fails = __webpack_require__("d039");
var hasOwn = __webpack_require__("1a2d");
var enforceInternalState = __webpack_require__("69f3").enforce;
var setSpecies = __webpack_require__("2626");
var wellKnownSymbol = __webpack_require__("b622");
var UNSUPPORTED_DOT_ALL = __webpack_require__("fce3");
var UNSUPPORTED_NCG = __webpack_require__("107c");

var MATCH = wellKnownSymbol('match');
var NativeRegExp = global.RegExp;
var RegExpPrototype = NativeRegExp.prototype;
var SyntaxError = global.SyntaxError;
var getFlags = uncurryThis(regExpFlags);
var exec = uncurryThis(RegExpPrototype.exec);
var charAt = uncurryThis(''.charAt);
var replace = uncurryThis(''.replace);
var stringIndexOf = uncurryThis(''.indexOf);
var stringSlice = uncurryThis(''.slice);
// TODO: Use only propper RegExpIdentifierName
var IS_NCG = /^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/;
var re1 = /a/g;
var re2 = /a/g;

// "new" should create a new object, old webkit bug
var CORRECT_NEW = new NativeRegExp(re1) !== re1;

var UNSUPPORTED_Y = stickyHelpers.UNSUPPORTED_Y;

var BASE_FORCED = DESCRIPTORS &&
  (!CORRECT_NEW || UNSUPPORTED_Y || UNSUPPORTED_DOT_ALL || UNSUPPORTED_NCG || fails(function () {
    re2[MATCH] = false;
    // RegExp constructor can alter flags and IsRegExp works correct with @@match
    return NativeRegExp(re1) != re1 || NativeRegExp(re2) == re2 || NativeRegExp(re1, 'i') != '/a/i';
  }));

var handleDotAll = function (string) {
  var length = string.length;
  var index = 0;
  var result = '';
  var brackets = false;
  var chr;
  for (; index <= length; index++) {
    chr = charAt(string, index);
    if (chr === '\\') {
      result += chr + charAt(string, ++index);
      continue;
    }
    if (!brackets && chr === '.') {
      result += '[\\s\\S]';
    } else {
      if (chr === '[') {
        brackets = true;
      } else if (chr === ']') {
        brackets = false;
      } result += chr;
    }
  } return result;
};

var handleNCG = function (string) {
  var length = string.length;
  var index = 0;
  var result = '';
  var named = [];
  var names = {};
  var brackets = false;
  var ncg = false;
  var groupid = 0;
  var groupname = '';
  var chr;
  for (; index <= length; index++) {
    chr = charAt(string, index);
    if (chr === '\\') {
      chr = chr + charAt(string, ++index);
    } else if (chr === ']') {
      brackets = false;
    } else if (!brackets) switch (true) {
      case chr === '[':
        brackets = true;
        break;
      case chr === '(':
        if (exec(IS_NCG, stringSlice(string, index + 1))) {
          index += 2;
          ncg = true;
        }
        result += chr;
        groupid++;
        continue;
      case chr === '>' && ncg:
        if (groupname === '' || hasOwn(names, groupname)) {
          throw new SyntaxError('Invalid capture group name');
        }
        names[groupname] = true;
        named[named.length] = [groupname, groupid];
        ncg = false;
        groupname = '';
        continue;
    }
    if (ncg) groupname += chr;
    else result += chr;
  } return [result, named];
};

// `RegExp` constructor
// https://tc39.es/ecma262/#sec-regexp-constructor
if (isForced('RegExp', BASE_FORCED)) {
  var RegExpWrapper = function RegExp(pattern, flags) {
    var thisIsRegExp = isPrototypeOf(RegExpPrototype, this);
    var patternIsRegExp = isRegExp(pattern);
    var flagsAreUndefined = flags === undefined;
    var groups = [];
    var rawPattern = pattern;
    var rawFlags, dotAll, sticky, handled, result, state;

    if (!thisIsRegExp && patternIsRegExp && flagsAreUndefined && pattern.constructor === RegExpWrapper) {
      return pattern;
    }

    if (patternIsRegExp || isPrototypeOf(RegExpPrototype, pattern)) {
      pattern = pattern.source;
      if (flagsAreUndefined) flags = 'flags' in rawPattern ? rawPattern.flags : getFlags(rawPattern);
    }

    pattern = pattern === undefined ? '' : toString(pattern);
    flags = flags === undefined ? '' : toString(flags);
    rawPattern = pattern;

    if (UNSUPPORTED_DOT_ALL && 'dotAll' in re1) {
      dotAll = !!flags && stringIndexOf(flags, 's') > -1;
      if (dotAll) flags = replace(flags, /s/g, '');
    }

    rawFlags = flags;

    if (UNSUPPORTED_Y && 'sticky' in re1) {
      sticky = !!flags && stringIndexOf(flags, 'y') > -1;
      if (sticky) flags = replace(flags, /y/g, '');
    }

    if (UNSUPPORTED_NCG) {
      handled = handleNCG(pattern);
      pattern = handled[0];
      groups = handled[1];
    }

    result = inheritIfRequired(NativeRegExp(pattern, flags), thisIsRegExp ? this : RegExpPrototype, RegExpWrapper);

    if (dotAll || sticky || groups.length) {
      state = enforceInternalState(result);
      if (dotAll) {
        state.dotAll = true;
        state.raw = RegExpWrapper(handleDotAll(pattern), rawFlags);
      }
      if (sticky) state.sticky = true;
      if (groups.length) state.groups = groups;
    }

    if (pattern !== rawPattern) try {
      // fails in old engines, but we have no alternatives for unsupported regex syntax
      createNonEnumerableProperty(result, 'source', rawPattern === '' ? '(?:)' : rawPattern);
    } catch (error) { /* empty */ }

    return result;
  };

  var proxy = function (key) {
    key in RegExpWrapper || defineProperty(RegExpWrapper, key, {
      configurable: true,
      get: function () { return NativeRegExp[key]; },
      set: function (it) { NativeRegExp[key] = it; }
    });
  };

  for (var keys = getOwnPropertyNames(NativeRegExp), index = 0; keys.length > index;) {
    proxy(keys[index++]);
  }

  RegExpPrototype.constructor = RegExpWrapper;
  RegExpWrapper.prototype = RegExpPrototype;
  redefine(global, 'RegExp', RegExpWrapper);
}

// https://tc39.es/ecma262/#sec-get-regexp-@@species
setSpecies('RegExp');


/***/ }),

/***/ "4d64":
/***/ (function(module, exports, __webpack_require__) {

var toIndexedObject = __webpack_require__("fc6a");
var toAbsoluteIndex = __webpack_require__("23cb");
var lengthOfArrayLike = __webpack_require__("07fa");

// `Array.prototype.{ indexOf, includes }` methods implementation
var createMethod = function (IS_INCLUDES) {
  return function ($this, el, fromIndex) {
    var O = toIndexedObject($this);
    var length = lengthOfArrayLike(O);
    var index = toAbsoluteIndex(fromIndex, length);
    var value;
    // Array#includes uses SameValueZero equality algorithm
    // eslint-disable-next-line no-self-compare -- NaN check
    if (IS_INCLUDES && el != el) while (length > index) {
      value = O[index++];
      // eslint-disable-next-line no-self-compare -- NaN check
      if (value != value) return true;
    // Array#indexOf ignores holes, Array#includes - not
    } else for (;length > index; index++) {
      if ((IS_INCLUDES || index in O) && O[index] === el) return IS_INCLUDES || index || 0;
    } return !IS_INCLUDES && -1;
  };
};

module.exports = {
  // `Array.prototype.includes` method
  // https://tc39.es/ecma262/#sec-array.prototype.includes
  includes: createMethod(true),
  // `Array.prototype.indexOf` method
  // https://tc39.es/ecma262/#sec-array.prototype.indexof
  indexOf: createMethod(false)
};


/***/ }),

/***/ "4de4":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var $ = __webpack_require__("23e7");
var $filter = __webpack_require__("b727").filter;
var arrayMethodHasSpeciesSupport = __webpack_require__("1dde");

var HAS_SPECIES_SUPPORT = arrayMethodHasSpeciesSupport('filter');

// `Array.prototype.filter` method
// https://tc39.es/ecma262/#sec-array.prototype.filter
// with adding support of @@species
$({ target: 'Array', proto: true, forced: !HAS_SPECIES_SUPPORT }, {
  filter: function filter(callbackfn /* , thisArg */) {
    return $filter(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);
  }
});


/***/ }),

/***/ "4df4":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var global = __webpack_require__("da84");
var bind = __webpack_require__("0366");
var call = __webpack_require__("c65b");
var toObject = __webpack_require__("7b0b");
var callWithSafeIterationClosing = __webpack_require__("9bdd");
var isArrayIteratorMethod = __webpack_require__("e95a");
var isConstructor = __webpack_require__("68ee");
var lengthOfArrayLike = __webpack_require__("07fa");
var createProperty = __webpack_require__("8418");
var getIterator = __webpack_require__("9a1f");
var getIteratorMethod = __webpack_require__("35a1");

var Array = global.Array;

// `Array.from` method implementation
// https://tc39.es/ecma262/#sec-array.from
module.exports = function from(arrayLike /* , mapfn = undefined, thisArg = undefined */) {
  var O = toObject(arrayLike);
  var IS_CONSTRUCTOR = isConstructor(this);
  var argumentsLength = arguments.length;
  var mapfn = argumentsLength > 1 ? arguments[1] : undefined;
  var mapping = mapfn !== undefined;
  if (mapping) mapfn = bind(mapfn, argumentsLength > 2 ? arguments[2] : undefined);
  var iteratorMethod = getIteratorMethod(O);
  var index = 0;
  var length, result, step, iterator, next, value;
  // if the target is not iterable or it's an array with the default iterator - use a simple case
  if (iteratorMethod && !(this == Array && isArrayIteratorMethod(iteratorMethod))) {
    iterator = getIterator(O, iteratorMethod);
    next = iterator.next;
    result = IS_CONSTRUCTOR ? new this() : [];
    for (;!(step = call(next, iterator)).done; index++) {
      value = mapping ? callWithSafeIterationClosing(iterator, mapfn, [step.value, index], true) : step.value;
      createProperty(result, index, value);
    }
  } else {
    length = lengthOfArrayLike(O);
    result = IS_CONSTRUCTOR ? new this(length) : Array(length);
    for (;length > index; index++) {
      value = mapping ? mapfn(O[index], index) : O[index];
      createProperty(result, index, value);
    }
  }
  result.length = index;
  return result;
};


/***/ }),

/***/ "4e82":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var $ = __webpack_require__("23e7");
var uncurryThis = __webpack_require__("e330");
var aCallable = __webpack_require__("59ed");
var toObject = __webpack_require__("7b0b");
var lengthOfArrayLike = __webpack_require__("07fa");
var toString = __webpack_require__("577e");
var fails = __webpack_require__("d039");
var internalSort = __webpack_require__("addb");
var arrayMethodIsStrict = __webpack_require__("a640");
var FF = __webpack_require__("04d1");
var IE_OR_EDGE = __webpack_require__("d998");
var V8 = __webpack_require__("2d00");
var WEBKIT = __webpack_require__("512c");

var test = [];
var un$Sort = uncurryThis(test.sort);
var push = uncurryThis(test.push);

// IE8-
var FAILS_ON_UNDEFINED = fails(function () {
  test.sort(undefined);
});
// V8 bug
var FAILS_ON_NULL = fails(function () {
  test.sort(null);
});
// Old WebKit
var STRICT_METHOD = arrayMethodIsStrict('sort');

var STABLE_SORT = !fails(function () {
  // feature detection can be too slow, so check engines versions
  if (V8) return V8 < 70;
  if (FF && FF > 3) return;
  if (IE_OR_EDGE) return true;
  if (WEBKIT) return WEBKIT < 603;

  var result = '';
  var code, chr, value, index;

  // generate an array with more 512 elements (Chakra and old V8 fails only in this case)
  for (code = 65; code < 76; code++) {
    chr = String.fromCharCode(code);

    switch (code) {
      case 66: case 69: case 70: case 72: value = 3; break;
      case 68: case 71: value = 4; break;
      default: value = 2;
    }

    for (index = 0; index < 47; index++) {
      test.push({ k: chr + index, v: value });
    }
  }

  test.sort(function (a, b) { return b.v - a.v; });

  for (index = 0; index < test.length; index++) {
    chr = test[index].k.charAt(0);
    if (result.charAt(result.length - 1) !== chr) result += chr;
  }

  return result !== 'DGBEFHACIJK';
});

var FORCED = FAILS_ON_UNDEFINED || !FAILS_ON_NULL || !STRICT_METHOD || !STABLE_SORT;

var getSortCompare = function (comparefn) {
  return function (x, y) {
    if (y === undefined) return -1;
    if (x === undefined) return 1;
    if (comparefn !== undefined) return +comparefn(x, y) || 0;
    return toString(x) > toString(y) ? 1 : -1;
  };
};

// `Array.prototype.sort` method
// https://tc39.es/ecma262/#sec-array.prototype.sort
$({ target: 'Array', proto: true, forced: FORCED }, {
  sort: function sort(comparefn) {
    if (comparefn !== undefined) aCallable(comparefn);

    var array = toObject(this);

    if (STABLE_SORT) return comparefn === undefined ? un$Sort(array) : un$Sort(array, comparefn);

    var items = [];
    var arrayLength = lengthOfArrayLike(array);
    var itemsLength, index;

    for (index = 0; index < arrayLength; index++) {
      if (index in array) push(items, array[index]);
    }

    internalSort(items, getSortCompare(comparefn));

    itemsLength = items.length;
    index = 0;

    while (index < itemsLength) array[index] = items[index++];
    while (index < arrayLength) delete array[index++];

    return array;
  }
});


/***/ }),

/***/ "4ec9":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var collection = __webpack_require__("6d61");
var collectionStrong = __webpack_require__("6566");

// `Map` constructor
// https://tc39.es/ecma262/#sec-map-objects
collection('Map', function (init) {
  return function Map() { return init(this, arguments.length ? arguments[0] : undefined); };
}, collectionStrong);


/***/ }),

/***/ "4f27":
/***/ (function(module, exports, __webpack_require__) {

// style-loader: Adds some css to the DOM by adding a <style> tag

// load the styles
var content = __webpack_require__("bd00");
if(content.__esModule) content = content.default;
if(typeof content === 'string') content = [[module.i, content, '']];
if(content.locals) module.exports = content.locals;
// add the styles to the DOM
var add = __webpack_require__("499e").default
var update = add("c429f428", content, true, {"sourceMap":false,"shadowMode":false});

/***/ }),

/***/ "4f2f":
/***/ (function(module, exports, __webpack_require__) {

// style-loader: Adds some css to the DOM by adding a <style> tag

// load the styles
var content = __webpack_require__("2e3e");
if(content.__esModule) content = content.default;
if(typeof content === 'string') content = [[module.i, content, '']];
if(content.locals) module.exports = content.locals;
// add the styles to the DOM
var add = __webpack_require__("499e").default
var update = add("80b2974c", content, true, {"sourceMap":false,"shadowMode":false});

/***/ }),

/***/ "4fad":
/***/ (function(module, exports, __webpack_require__) {

var $ = __webpack_require__("23e7");
var $entries = __webpack_require__("6f53").entries;

// `Object.entries` method
// https://tc39.es/ecma262/#sec-object.entries
$({ target: 'Object', stat: true }, {
  entries: function entries(O) {
    return $entries(O);
  }
});


/***/ }),

/***/ "4fadd":
/***/ (function(module, exports, __webpack_require__) {

var fails = __webpack_require__("d039");
var isObject = __webpack_require__("861d");
var classof = __webpack_require__("c6b6");
var ARRAY_BUFFER_NON_EXTENSIBLE = __webpack_require__("d86b");

// eslint-disable-next-line es/no-object-isextensible -- safe
var $isExtensible = Object.isExtensible;
var FAILS_ON_PRIMITIVES = fails(function () { $isExtensible(1); });

// `Object.isExtensible` method
// https://tc39.es/ecma262/#sec-object.isextensible
module.exports = (FAILS_ON_PRIMITIVES || ARRAY_BUFFER_NON_EXTENSIBLE) ? function isExtensible(it) {
  if (!isObject(it)) return false;
  if (ARRAY_BUFFER_NON_EXTENSIBLE && classof(it) == 'ArrayBuffer') return false;
  return $isExtensible ? $isExtensible(it) : true;
} : $isExtensible;


/***/ }),

/***/ "5087":
/***/ (function(module, exports, __webpack_require__) {

var global = __webpack_require__("da84");
var isConstructor = __webpack_require__("68ee");
var tryToString = __webpack_require__("0d51");

var TypeError = global.TypeError;

// `Assert: IsConstructor(argument) is true`
module.exports = function (argument) {
  if (isConstructor(argument)) return argument;
  throw TypeError(tryToString(argument) + ' is not a constructor');
};


/***/ }),

/***/ "50c4":
/***/ (function(module, exports, __webpack_require__) {

var toIntegerOrInfinity = __webpack_require__("5926");

var min = Math.min;

// `ToLength` abstract operation
// https://tc39.es/ecma262/#sec-tolength
module.exports = function (argument) {
  return argument > 0 ? min(toIntegerOrInfinity(argument), 0x1FFFFFFFFFFFFF) : 0; // 2 ** 53 - 1 == 9007199254740991
};


/***/ }),

/***/ "512c":
/***/ (function(module, exports, __webpack_require__) {

var userAgent = __webpack_require__("342f");

var webkit = userAgent.match(/AppleWebKit\/(\d+)\./);

module.exports = !!webkit && +webkit[1];


/***/ }),

/***/ "5319":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var apply = __webpack_require__("2ba4");
var call = __webpack_require__("c65b");
var uncurryThis = __webpack_require__("e330");
var fixRegExpWellKnownSymbolLogic = __webpack_require__("d784");
var fails = __webpack_require__("d039");
var anObject = __webpack_require__("825a");
var isCallable = __webpack_require__("1626");
var toIntegerOrInfinity = __webpack_require__("5926");
var toLength = __webpack_require__("50c4");
var toString = __webpack_require__("577e");
var requireObjectCoercible = __webpack_require__("1d80");
var advanceStringIndex = __webpack_require__("8aa5");
var getMethod = __webpack_require__("dc4a");
var getSubstitution = __webpack_require__("0cb2");
var regExpExec = __webpack_require__("14c3");
var wellKnownSymbol = __webpack_require__("b622");

var REPLACE = wellKnownSymbol('replace');
var max = Math.max;
var min = Math.min;
var concat = uncurryThis([].concat);
var push = uncurryThis([].push);
var stringIndexOf = uncurryThis(''.indexOf);
var stringSlice = uncurryThis(''.slice);

var maybeToString = function (it) {
  return it === undefined ? it : String(it);
};

// IE <= 11 replaces $0 with the whole match, as if it was $&
// https://stackoverflow.com/questions/6024666/getting-ie-to-replace-a-regex-with-the-literal-string-0
var REPLACE_KEEPS_$0 = (function () {
  // eslint-disable-next-line regexp/prefer-escape-replacement-dollar-char -- required for testing
  return 'a'.replace(/./, '$0') === '$0';
})();

// Safari <= 13.0.3(?) substitutes nth capture where n>m with an empty string
var REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE = (function () {
  if (/./[REPLACE]) {
    return /./[REPLACE]('a', '$0') === '';
  }
  return false;
})();

var REPLACE_SUPPORTS_NAMED_GROUPS = !fails(function () {
  var re = /./;
  re.exec = function () {
    var result = [];
    result.groups = { a: '7' };
    return result;
  };
  // eslint-disable-next-line regexp/no-useless-dollar-replacements -- false positive
  return ''.replace(re, '$<a>') !== '7';
});

// @@replace logic
fixRegExpWellKnownSymbolLogic('replace', function (_, nativeReplace, maybeCallNative) {
  var UNSAFE_SUBSTITUTE = REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE ? '$' : '$0';

  return [
    // `String.prototype.replace` method
    // https://tc39.es/ecma262/#sec-string.prototype.replace
    function replace(searchValue, replaceValue) {
      var O = requireObjectCoercible(this);
      var replacer = searchValue == undefined ? undefined : getMethod(searchValue, REPLACE);
      return replacer
        ? call(replacer, searchValue, O, replaceValue)
        : call(nativeReplace, toString(O), searchValue, replaceValue);
    },
    // `RegExp.prototype[@@replace]` method
    // https://tc39.es/ecma262/#sec-regexp.prototype-@@replace
    function (string, replaceValue) {
      var rx = anObject(this);
      var S = toString(string);

      if (
        typeof replaceValue == 'string' &&
        stringIndexOf(replaceValue, UNSAFE_SUBSTITUTE) === -1 &&
        stringIndexOf(replaceValue, '$<') === -1
      ) {
        var res = maybeCallNative(nativeReplace, rx, S, replaceValue);
        if (res.done) return res.value;
      }

      var functionalReplace = isCallable(replaceValue);
      if (!functionalReplace) replaceValue = toString(replaceValue);

      var global = rx.global;
      if (global) {
        var fullUnicode = rx.unicode;
        rx.lastIndex = 0;
      }
      var results = [];
      while (true) {
        var result = regExpExec(rx, S);
        if (result === null) break;

        push(results, result);
        if (!global) break;

        var matchStr = toString(result[0]);
        if (matchStr === '') rx.lastIndex = advanceStringIndex(S, toLength(rx.lastIndex), fullUnicode);
      }

      var accumulatedResult = '';
      var nextSourcePosition = 0;
      for (var i = 0; i < results.length; i++) {
        result = results[i];

        var matched = toString(result[0]);
        var position = max(min(toIntegerOrInfinity(result.index), S.length), 0);
        var captures = [];
        // NOTE: This is equivalent to
        //   captures = result.slice(1).map(maybeToString)
        // but for some reason `nativeSlice.call(result, 1, result.length)` (called in
        // the slice polyfill when slicing native arrays) "doesn't work" in safari 9 and
        // causes a crash (https://pastebin.com/N21QzeQA) when trying to debug it.
        for (var j = 1; j < result.length; j++) push(captures, maybeToString(result[j]));
        var namedCaptures = result.groups;
        if (functionalReplace) {
          var replacerArgs = concat([matched], captures, position, S);
          if (namedCaptures !== undefined) push(replacerArgs, namedCaptures);
          var replacement = toString(apply(replaceValue, undefined, replacerArgs));
        } else {
          replacement = getSubstitution(matched, S, position, captures, namedCaptures, replaceValue);
        }
        if (position >= nextSourcePosition) {
          accumulatedResult += stringSlice(S, nextSourcePosition, position) + replacement;
          nextSourcePosition = position + matched.length;
        }
      }
      return accumulatedResult + stringSlice(S, nextSourcePosition);
    }
  ];
}, !REPLACE_SUPPORTS_NAMED_GROUPS || !REPLACE_KEEPS_$0 || REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE);


/***/ }),

/***/ "5692":
/***/ (function(module, exports, __webpack_require__) {

var IS_PURE = __webpack_require__("c430");
var store = __webpack_require__("c6cd");

(module.exports = function (key, value) {
  return store[key] || (store[key] = value !== undefined ? value : {});
})('versions', []).push({
  version: '3.19.1',
  mode: IS_PURE ? 'pure' : 'global',
  copyright: '© 2021 Denis Pushkarev (zloirock.ru)'
});


/***/ }),

/***/ "56ef":
/***/ (function(module, exports, __webpack_require__) {

var getBuiltIn = __webpack_require__("d066");
var uncurryThis = __webpack_require__("e330");
var getOwnPropertyNamesModule = __webpack_require__("241c");
var getOwnPropertySymbolsModule = __webpack_require__("7418");
var anObject = __webpack_require__("825a");

var concat = uncurryThis([].concat);

// all object keys, includes non-enumerable and symbols
module.exports = getBuiltIn('Reflect', 'ownKeys') || function ownKeys(it) {
  var keys = getOwnPropertyNamesModule.f(anObject(it));
  var getOwnPropertySymbols = getOwnPropertySymbolsModule.f;
  return getOwnPropertySymbols ? concat(keys, getOwnPropertySymbols(it)) : keys;
};


/***/ }),

/***/ "577e":
/***/ (function(module, exports, __webpack_require__) {

var global = __webpack_require__("da84");
var classof = __webpack_require__("f5df");

var String = global.String;

module.exports = function (argument) {
  if (classof(argument) === 'Symbol') throw TypeError('Cannot convert a Symbol value to a string');
  return String(argument);
};


/***/ }),

/***/ "5899":
/***/ (function(module, exports) {

// a string of all valid unicode whitespaces
module.exports = '\u0009\u000A\u000B\u000C\u000D\u0020\u00A0\u1680\u2000\u2001\u2002' +
  '\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF';


/***/ }),

/***/ "58a8":
/***/ (function(module, exports, __webpack_require__) {

var uncurryThis = __webpack_require__("e330");
var requireObjectCoercible = __webpack_require__("1d80");
var toString = __webpack_require__("577e");
var whitespaces = __webpack_require__("5899");

var replace = uncurryThis(''.replace);
var whitespace = '[' + whitespaces + ']';
var ltrim = RegExp('^' + whitespace + whitespace + '*');
var rtrim = RegExp(whitespace + whitespace + '*$');

// `String.prototype.{ trim, trimStart, trimEnd, trimLeft, trimRight }` methods implementation
var createMethod = function (TYPE) {
  return function ($this) {
    var string = toString(requireObjectCoercible($this));
    if (TYPE & 1) string = replace(string, ltrim, '');
    if (TYPE & 2) string = replace(string, rtrim, '');
    return string;
  };
};

module.exports = {
  // `String.prototype.{ trimLeft, trimStart }` methods
  // https://tc39.es/ecma262/#sec-string.prototype.trimstart
  start: createMethod(1),
  // `String.prototype.{ trimRight, trimEnd }` methods
  // https://tc39.es/ecma262/#sec-string.prototype.trimend
  end: createMethod(2),
  // `String.prototype.trim` method
  // https://tc39.es/ecma262/#sec-string.prototype.trim
  trim: createMethod(3)
};


/***/ }),

/***/ "5926":
/***/ (function(module, exports) {

var ceil = Math.ceil;
var floor = Math.floor;

// `ToIntegerOrInfinity` abstract operation
// https://tc39.es/ecma262/#sec-tointegerorinfinity
module.exports = function (argument) {
  var number = +argument;
  // eslint-disable-next-line no-self-compare -- safe
  return number !== number || number === 0 ? 0 : (number > 0 ? floor : ceil)(number);
};


/***/ }),

/***/ "5960":
/***/ (function(module, exports, __webpack_require__) {

// Imports
var ___CSS_LOADER_API_IMPORT___ = __webpack_require__("24fb");
exports = ___CSS_LOADER_API_IMPORT___(false);
// Module
exports.push([module.i, ".inform-content[data-v-04b2b68d]{position:absolute;pointer-events:none;overflow:hidden}.inform-content .inform-item[data-v-04b2b68d]{overflow:hidden;position:absolute;z-index:20;pointer-events:auto;margin:0;display:none}.inform-content .inform-item.ExcelCheckboxGroup[data-v-04b2b68d],.inform-content .inform-item.ExcelRadioGroup[data-v-04b2b68d],.inform-content .inform-item.ExcelRate[data-v-04b2b68d],.inform-content .inform-item.ExcelUpload[data-v-04b2b68d],.inform-content .inform-item.focusItem[data-v-04b2b68d]{display:inline-block!important}.inform-content .inform-item.ExcelCheckboxGroup .el-rate[data-v-04b2b68d],.inform-content .inform-item.ExcelRadioGroup .el-rate[data-v-04b2b68d],.inform-content .inform-item.ExcelRate .el-rate[data-v-04b2b68d],.inform-content .inform-item.ExcelUpload .el-rate[data-v-04b2b68d],.inform-content .inform-item.focusItem .el-rate[data-v-04b2b68d]{line-height:20px}.inform-content .inform-item[data-v-04b2b68d] .el-form-item__content{height:100%;width:100%;line-height:1;display:inline-block}.inform-content .inform-item[data-v-04b2b68d] .el-input{height:100%;width:100%}.inform-content .inform-item[data-v-04b2b68d] .el-select{display:inline-block;height:100%;width:100%}.inform-content .inform-item[data-v-04b2b68d] .el-select .el-input{height:100%;width:100%;min-width:100%}.inform-content .inform-item[data-v-04b2b68d] .el-select .el-input .el-input__inner{border-color:transparent;height:100%;opacity:0}.inform-content .inform-item[data-v-04b2b68d] .el-select .el-input .el-input__icon{line-height:1}.inform-content .inform-item[data-v-04b2b68d] .el-select .el-input .el-input__suffix-inner{display:inline-block;top:50%;position:absolute;-webkit-transform:translateY(-50%);transform:translateY(-50%);right:0}.inform-content .inform-item[data-v-04b2b68d] .el-date-editor{min-width:unset}.inform-content .inform-item[data-v-04b2b68d] .el-date-editor .el-input__inner{border-color:transparent;height:100%;opacity:0}.inform-content .inform-item[data-v-04b2b68d] .el-date-editor .el-input__prefix{width:100%;left:unset;right:5px}.inform-content .inform-item[data-v-04b2b68d] .el-date-editor .el-input__prefix i:before{display:inline-block;top:50%;position:absolute;-webkit-transform:translateY(-50%);transform:translateY(-50%);right:0}.inform-content .inform-item[data-v-04b2b68d] .el-date-editor .el-input__suffix-inner{display:none}", ""]);
// Exports
module.exports = exports;


/***/ }),

/***/ "59b1":
/***/ (function(module, exports, __webpack_require__) {

// style-loader: Adds some css to the DOM by adding a <style> tag

// load the styles
var content = __webpack_require__("93e1");
if(content.__esModule) content = content.default;
if(typeof content === 'string') content = [[module.i, content, '']];
if(content.locals) module.exports = content.locals;
// add the styles to the DOM
var add = __webpack_require__("499e").default
var update = add("d1942520", content, true, {"sourceMap":false,"shadowMode":false});

/***/ }),

/***/ "59ed":
/***/ (function(module, exports, __webpack_require__) {

var global = __webpack_require__("da84");
var isCallable = __webpack_require__("1626");
var tryToString = __webpack_require__("0d51");

var TypeError = global.TypeError;

// `Assert: IsCallable(argument) is true`
module.exports = function (argument) {
  if (isCallable(argument)) return argument;
  throw TypeError(tryToString(argument) + ' is not a function');
};


/***/ }),

/***/ "5a34":
/***/ (function(module, exports, __webpack_require__) {

var global = __webpack_require__("da84");
var isRegExp = __webpack_require__("44e7");

var TypeError = global.TypeError;

module.exports = function (it) {
  if (isRegExp(it)) {
    throw TypeError("The method doesn't accept regular expressions");
  } return it;
};


/***/ }),

/***/ "5c6c":
/***/ (function(module, exports) {

module.exports = function (bitmap, value) {
  return {
    enumerable: !(bitmap & 1),
    configurable: !(bitmap & 2),
    writable: !(bitmap & 4),
    value: value
  };
};


/***/ }),

/***/ "5cc6":
/***/ (function(module, exports, __webpack_require__) {

var createTypedArrayConstructor = __webpack_require__("74e8");

// `Uint8Array` constructor
// https://tc39.es/ecma262/#sec-typedarray-objects
createTypedArrayConstructor('Uint8', function (init) {
  return function Uint8Array(data, byteOffset, length) {
    return init(this, data, byteOffset, length);
  };
});


/***/ }),

/***/ "5d41":
/***/ (function(module, exports, __webpack_require__) {

var $ = __webpack_require__("23e7");
var call = __webpack_require__("c65b");
var isObject = __webpack_require__("861d");
var anObject = __webpack_require__("825a");
var isDataDescriptor = __webpack_require__("c60d");
var getOwnPropertyDescriptorModule = __webpack_require__("06cf");
var getPrototypeOf = __webpack_require__("e163");

// `Reflect.get` method
// https://tc39.es/ecma262/#sec-reflect.get
function get(target, propertyKey /* , receiver */) {
  var receiver = arguments.length < 3 ? target : arguments[2];
  var descriptor, prototype;
  if (anObject(target) === receiver) return target[propertyKey];
  descriptor = getOwnPropertyDescriptorModule.f(target, propertyKey);
  if (descriptor) return isDataDescriptor(descriptor)
    ? descriptor.value
    : descriptor.get === undefined ? undefined : call(descriptor.get, receiver);
  if (isObject(prototype = getPrototypeOf(target))) return get(prototype, propertyKey, receiver);
}

$({ target: 'Reflect', stat: true }, {
  get: get
});


/***/ }),

/***/ "5e77":
/***/ (function(module, exports, __webpack_require__) {

var DESCRIPTORS = __webpack_require__("83ab");
var hasOwn = __webpack_require__("1a2d");

var FunctionPrototype = Function.prototype;
// eslint-disable-next-line es/no-object-getownpropertydescriptor -- safe
var getDescriptor = DESCRIPTORS && Object.getOwnPropertyDescriptor;

var EXISTS = hasOwn(FunctionPrototype, 'name');
// additional protection from minified / mangled / dropped function names
var PROPER = EXISTS && (function something() { /* empty */ }).name === 'something';
var CONFIGURABLE = EXISTS && (!DESCRIPTORS || (DESCRIPTORS && getDescriptor(FunctionPrototype, 'name').configurable));

module.exports = {
  EXISTS: EXISTS,
  PROPER: PROPER,
  CONFIGURABLE: CONFIGURABLE
};


/***/ }),

/***/ "5ea3":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function(global) {/** Detect free variable `global` from Node.js. */
var freeGlobal = typeof global == 'object' && global && global.Object === Object && global;

/* harmony default export */ __webpack_exports__["a"] = (freeGlobal);

/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("c8ba")))

/***/ }),

/***/ "5f96":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var ArrayBufferViewCore = __webpack_require__("ebb5");
var uncurryThis = __webpack_require__("e330");

var aTypedArray = ArrayBufferViewCore.aTypedArray;
var exportTypedArrayMethod = ArrayBufferViewCore.exportTypedArrayMethod;
var $join = uncurryThis([].join);

// `%TypedArray%.prototype.join` method
// https://tc39.es/ecma262/#sec-%typedarray%.prototype.join
exportTypedArrayMethod('join', function join(separator) {
  return $join(aTypedArray(this), separator);
});


/***/ }),

/***/ "605d":
/***/ (function(module, exports, __webpack_require__) {

var classof = __webpack_require__("c6b6");
var global = __webpack_require__("da84");

module.exports = classof(global.process) == 'process';


/***/ }),

/***/ "6062":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var collection = __webpack_require__("6d61");
var collectionStrong = __webpack_require__("6566");

// `Set` constructor
// https://tc39.es/ecma262/#sec-set-objects
collection('Set', function (init) {
  return function Set() { return init(this, arguments.length ? arguments[0] : undefined); };
}, collectionStrong);


/***/ }),

/***/ "6069":
/***/ (function(module, exports) {

module.exports = typeof window == 'object';


/***/ }),

/***/ "60bd":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var global = __webpack_require__("da84");
var uncurryThis = __webpack_require__("e330");
var PROPER_FUNCTION_NAME = __webpack_require__("5e77").PROPER;
var ArrayBufferViewCore = __webpack_require__("ebb5");
var ArrayIterators = __webpack_require__("e260");
var wellKnownSymbol = __webpack_require__("b622");

var ITERATOR = wellKnownSymbol('iterator');
var Uint8Array = global.Uint8Array;
var arrayValues = uncurryThis(ArrayIterators.values);
var arrayKeys = uncurryThis(ArrayIterators.keys);
var arrayEntries = uncurryThis(ArrayIterators.entries);
var aTypedArray = ArrayBufferViewCore.aTypedArray;
var exportTypedArrayMethod = ArrayBufferViewCore.exportTypedArrayMethod;
var nativeTypedArrayIterator = Uint8Array && Uint8Array.prototype[ITERATOR];

var PROPER_ARRAY_VALUES_NAME = !!nativeTypedArrayIterator && nativeTypedArrayIterator.name === 'values';

var typedArrayValues = function values() {
  return arrayValues(aTypedArray(this));
};

// `%TypedArray%.prototype.entries` method
// https://tc39.es/ecma262/#sec-%typedarray%.prototype.entries
exportTypedArrayMethod('entries', function entries() {
  return arrayEntries(aTypedArray(this));
});
// `%TypedArray%.prototype.keys` method
// https://tc39.es/ecma262/#sec-%typedarray%.prototype.keys
exportTypedArrayMethod('keys', function keys() {
  return arrayKeys(aTypedArray(this));
});
// `%TypedArray%.prototype.values` method
// https://tc39.es/ecma262/#sec-%typedarray%.prototype.values
exportTypedArrayMethod('values', typedArrayValues, PROPER_FUNCTION_NAME && !PROPER_ARRAY_VALUES_NAME);
// `%TypedArray%.prototype[@@iterator]` method
// https://tc39.es/ecma262/#sec-%typedarray%.prototype-@@iterator
exportTypedArrayMethod(ITERATOR, typedArrayValues, PROPER_FUNCTION_NAME && !PROPER_ARRAY_VALUES_NAME);


/***/ }),

/***/ "60da":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var DESCRIPTORS = __webpack_require__("83ab");
var uncurryThis = __webpack_require__("e330");
var call = __webpack_require__("c65b");
var fails = __webpack_require__("d039");
var objectKeys = __webpack_require__("df75");
var getOwnPropertySymbolsModule = __webpack_require__("7418");
var propertyIsEnumerableModule = __webpack_require__("d1e7");
var toObject = __webpack_require__("7b0b");
var IndexedObject = __webpack_require__("44ad");

// eslint-disable-next-line es/no-object-assign -- safe
var $assign = Object.assign;
// eslint-disable-next-line es/no-object-defineproperty -- required for testing
var defineProperty = Object.defineProperty;
var concat = uncurryThis([].concat);

// `Object.assign` method
// https://tc39.es/ecma262/#sec-object.assign
module.exports = !$assign || fails(function () {
  // should have correct order of operations (Edge bug)
  if (DESCRIPTORS && $assign({ b: 1 }, $assign(defineProperty({}, 'a', {
    enumerable: true,
    get: function () {
      defineProperty(this, 'b', {
        value: 3,
        enumerable: false
      });
    }
  }), { b: 2 })).b !== 1) return true;
  // should work with symbols and should have deterministic property order (V8 bug)
  var A = {};
  var B = {};
  // eslint-disable-next-line es/no-symbol -- safe
  var symbol = Symbol();
  var alphabet = 'abcdefghijklmnopqrst';
  A[symbol] = 7;
  alphabet.split('').forEach(function (chr) { B[chr] = chr; });
  return $assign({}, A)[symbol] != 7 || objectKeys($assign({}, B)).join('') != alphabet;
}) ? function assign(target, source) { // eslint-disable-line no-unused-vars -- required for `.length`
  var T = toObject(target);
  var argumentsLength = arguments.length;
  var index = 1;
  var getOwnPropertySymbols = getOwnPropertySymbolsModule.f;
  var propertyIsEnumerable = propertyIsEnumerableModule.f;
  while (argumentsLength > index) {
    var S = IndexedObject(arguments[index++]);
    var keys = getOwnPropertySymbols ? concat(objectKeys(S), getOwnPropertySymbols(S)) : objectKeys(S);
    var length = keys.length;
    var j = 0;
    var key;
    while (length > j) {
      key = keys[j++];
      if (!DESCRIPTORS || call(propertyIsEnumerable, S, key)) T[key] = S[key];
    }
  } return T;
} : $assign;


/***/ }),

/***/ "6184":
/***/ (function(module, exports, __webpack_require__) {

// Imports
var ___CSS_LOADER_API_IMPORT___ = __webpack_require__("24fb");
exports = ___CSS_LOADER_API_IMPORT___(false);
// Module
exports.push([module.i, "[data-v-544d9ff4].el-dialog__wrapper .el-dialog .el-dialog__body,[data-v-544d9ff4].el-dialog__wrapper .el-dialog .el-dialog__body .el-tabs--border-card>.el-tabs__content{padding:5px}[data-v-544d9ff4].el-dialog__wrapper .el-dialog .el-dialog__body .el-tabs__item{height:35px;line-height:35px}[data-v-544d9ff4].el-dialog__wrapper .el-dialog .el-dialog__body .label{font-size:15px;padding:10px}[data-v-544d9ff4].el-dialog__wrapper .el-dialog .el-dialog__body .label .label-tip{background:#f2f7fe;border-radius:5px;padding:20px}[data-v-544d9ff4].el-dialog__wrapper .el-dialog .el-dialog__body .el-checkbox.is-bordered.is-checked{border-color:#bbc1cb}", ""]);
// Exports
module.exports = exports;


/***/ }),

/***/ "621a":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var global = __webpack_require__("da84");
var uncurryThis = __webpack_require__("e330");
var DESCRIPTORS = __webpack_require__("83ab");
var NATIVE_ARRAY_BUFFER = __webpack_require__("a981");
var FunctionName = __webpack_require__("5e77");
var createNonEnumerableProperty = __webpack_require__("9112");
var redefineAll = __webpack_require__("e2cc");
var fails = __webpack_require__("d039");
var anInstance = __webpack_require__("19aa");
var toIntegerOrInfinity = __webpack_require__("5926");
var toLength = __webpack_require__("50c4");
var toIndex = __webpack_require__("0b25");
var IEEE754 = __webpack_require__("77a7");
var getPrototypeOf = __webpack_require__("e163");
var setPrototypeOf = __webpack_require__("d2bb");
var getOwnPropertyNames = __webpack_require__("241c").f;
var defineProperty = __webpack_require__("9bf2").f;
var arrayFill = __webpack_require__("81d5");
var arraySlice = __webpack_require__("f36a");
var setToStringTag = __webpack_require__("d44e");
var InternalStateModule = __webpack_require__("69f3");

var PROPER_FUNCTION_NAME = FunctionName.PROPER;
var CONFIGURABLE_FUNCTION_NAME = FunctionName.CONFIGURABLE;
var getInternalState = InternalStateModule.get;
var setInternalState = InternalStateModule.set;
var ARRAY_BUFFER = 'ArrayBuffer';
var DATA_VIEW = 'DataView';
var PROTOTYPE = 'prototype';
var WRONG_LENGTH = 'Wrong length';
var WRONG_INDEX = 'Wrong index';
var NativeArrayBuffer = global[ARRAY_BUFFER];
var $ArrayBuffer = NativeArrayBuffer;
var ArrayBufferPrototype = $ArrayBuffer && $ArrayBuffer[PROTOTYPE];
var $DataView = global[DATA_VIEW];
var DataViewPrototype = $DataView && $DataView[PROTOTYPE];
var ObjectPrototype = Object.prototype;
var Array = global.Array;
var RangeError = global.RangeError;
var fill = uncurryThis(arrayFill);
var reverse = uncurryThis([].reverse);

var packIEEE754 = IEEE754.pack;
var unpackIEEE754 = IEEE754.unpack;

var packInt8 = function (number) {
  return [number & 0xFF];
};

var packInt16 = function (number) {
  return [number & 0xFF, number >> 8 & 0xFF];
};

var packInt32 = function (number) {
  return [number & 0xFF, number >> 8 & 0xFF, number >> 16 & 0xFF, number >> 24 & 0xFF];
};

var unpackInt32 = function (buffer) {
  return buffer[3] << 24 | buffer[2] << 16 | buffer[1] << 8 | buffer[0];
};

var packFloat32 = function (number) {
  return packIEEE754(number, 23, 4);
};

var packFloat64 = function (number) {
  return packIEEE754(number, 52, 8);
};

var addGetter = function (Constructor, key) {
  defineProperty(Constructor[PROTOTYPE], key, { get: function () { return getInternalState(this)[key]; } });
};

var get = function (view, count, index, isLittleEndian) {
  var intIndex = toIndex(index);
  var store = getInternalState(view);
  if (intIndex + count > store.byteLength) throw RangeError(WRONG_INDEX);
  var bytes = getInternalState(store.buffer).bytes;
  var start = intIndex + store.byteOffset;
  var pack = arraySlice(bytes, start, start + count);
  return isLittleEndian ? pack : reverse(pack);
};

var set = function (view, count, index, conversion, value, isLittleEndian) {
  var intIndex = toIndex(index);
  var store = getInternalState(view);
  if (intIndex + count > store.byteLength) throw RangeError(WRONG_INDEX);
  var bytes = getInternalState(store.buffer).bytes;
  var start = intIndex + store.byteOffset;
  var pack = conversion(+value);
  for (var i = 0; i < count; i++) bytes[start + i] = pack[isLittleEndian ? i : count - i - 1];
};

if (!NATIVE_ARRAY_BUFFER) {
  $ArrayBuffer = function ArrayBuffer(length) {
    anInstance(this, ArrayBufferPrototype);
    var byteLength = toIndex(length);
    setInternalState(this, {
      bytes: fill(Array(byteLength), 0),
      byteLength: byteLength
    });
    if (!DESCRIPTORS) this.byteLength = byteLength;
  };

  ArrayBufferPrototype = $ArrayBuffer[PROTOTYPE];

  $DataView = function DataView(buffer, byteOffset, byteLength) {
    anInstance(this, DataViewPrototype);
    anInstance(buffer, ArrayBufferPrototype);
    var bufferLength = getInternalState(buffer).byteLength;
    var offset = toIntegerOrInfinity(byteOffset);
    if (offset < 0 || offset > bufferLength) throw RangeError('Wrong offset');
    byteLength = byteLength === undefined ? bufferLength - offset : toLength(byteLength);
    if (offset + byteLength > bufferLength) throw RangeError(WRONG_LENGTH);
    setInternalState(this, {
      buffer: buffer,
      byteLength: byteLength,
      byteOffset: offset
    });
    if (!DESCRIPTORS) {
      this.buffer = buffer;
      this.byteLength = byteLength;
      this.byteOffset = offset;
    }
  };

  DataViewPrototype = $DataView[PROTOTYPE];

  if (DESCRIPTORS) {
    addGetter($ArrayBuffer, 'byteLength');
    addGetter($DataView, 'buffer');
    addGetter($DataView, 'byteLength');
    addGetter($DataView, 'byteOffset');
  }

  redefineAll(DataViewPrototype, {
    getInt8: function getInt8(byteOffset) {
      return get(this, 1, byteOffset)[0] << 24 >> 24;
    },
    getUint8: function getUint8(byteOffset) {
      return get(this, 1, byteOffset)[0];
    },
    getInt16: function getInt16(byteOffset /* , littleEndian */) {
      var bytes = get(this, 2, byteOffset, arguments.length > 1 ? arguments[1] : undefined);
      return (bytes[1] << 8 | bytes[0]) << 16 >> 16;
    },
    getUint16: function getUint16(byteOffset /* , littleEndian */) {
      var bytes = get(this, 2, byteOffset, arguments.length > 1 ? arguments[1] : undefined);
      return bytes[1] << 8 | bytes[0];
    },
    getInt32: function getInt32(byteOffset /* , littleEndian */) {
      return unpackInt32(get(this, 4, byteOffset, arguments.length > 1 ? arguments[1] : undefined));
    },
    getUint32: function getUint32(byteOffset /* , littleEndian */) {
      return unpackInt32(get(this, 4, byteOffset, arguments.length > 1 ? arguments[1] : undefined)) >>> 0;
    },
    getFloat32: function getFloat32(byteOffset /* , littleEndian */) {
      return unpackIEEE754(get(this, 4, byteOffset, arguments.length > 1 ? arguments[1] : undefined), 23);
    },
    getFloat64: function getFloat64(byteOffset /* , littleEndian */) {
      return unpackIEEE754(get(this, 8, byteOffset, arguments.length > 1 ? arguments[1] : undefined), 52);
    },
    setInt8: function setInt8(byteOffset, value) {
      set(this, 1, byteOffset, packInt8, value);
    },
    setUint8: function setUint8(byteOffset, value) {
      set(this, 1, byteOffset, packInt8, value);
    },
    setInt16: function setInt16(byteOffset, value /* , littleEndian */) {
      set(this, 2, byteOffset, packInt16, value, arguments.length > 2 ? arguments[2] : undefined);
    },
    setUint16: function setUint16(byteOffset, value /* , littleEndian */) {
      set(this, 2, byteOffset, packInt16, value, arguments.length > 2 ? arguments[2] : undefined);
    },
    setInt32: function setInt32(byteOffset, value /* , littleEndian */) {
      set(this, 4, byteOffset, packInt32, value, arguments.length > 2 ? arguments[2] : undefined);
    },
    setUint32: function setUint32(byteOffset, value /* , littleEndian */) {
      set(this, 4, byteOffset, packInt32, value, arguments.length > 2 ? arguments[2] : undefined);
    },
    setFloat32: function setFloat32(byteOffset, value /* , littleEndian */) {
      set(this, 4, byteOffset, packFloat32, value, arguments.length > 2 ? arguments[2] : undefined);
    },
    setFloat64: function setFloat64(byteOffset, value /* , littleEndian */) {
      set(this, 8, byteOffset, packFloat64, value, arguments.length > 2 ? arguments[2] : undefined);
    }
  });
} else {
  var INCORRECT_ARRAY_BUFFER_NAME = PROPER_FUNCTION_NAME && NativeArrayBuffer.name !== ARRAY_BUFFER;
  /* eslint-disable no-new -- required for testing */
  if (!fails(function () {
    NativeArrayBuffer(1);
  }) || !fails(function () {
    new NativeArrayBuffer(-1);
  }) || fails(function () {
    new NativeArrayBuffer();
    new NativeArrayBuffer(1.5);
    new NativeArrayBuffer(NaN);
    return INCORRECT_ARRAY_BUFFER_NAME && !CONFIGURABLE_FUNCTION_NAME;
  })) {
  /* eslint-enable no-new -- required for testing */
    $ArrayBuffer = function ArrayBuffer(length) {
      anInstance(this, ArrayBufferPrototype);
      return new NativeArrayBuffer(toIndex(length));
    };

    $ArrayBuffer[PROTOTYPE] = ArrayBufferPrototype;

    for (var keys = getOwnPropertyNames(NativeArrayBuffer), j = 0, key; keys.length > j;) {
      if (!((key = keys[j++]) in $ArrayBuffer)) {
        createNonEnumerableProperty($ArrayBuffer, key, NativeArrayBuffer[key]);
      }
    }

    ArrayBufferPrototype.constructor = $ArrayBuffer;
  } else if (INCORRECT_ARRAY_BUFFER_NAME && CONFIGURABLE_FUNCTION_NAME) {
    createNonEnumerableProperty(NativeArrayBuffer, 'name', ARRAY_BUFFER);
  }

  // WebKit bug - the same parent prototype for typed arrays and data view
  if (setPrototypeOf && getPrototypeOf(DataViewPrototype) !== ObjectPrototype) {
    setPrototypeOf(DataViewPrototype, ObjectPrototype);
  }

  // iOS Safari 7.x bug
  var testView = new $DataView(new $ArrayBuffer(2));
  var $setInt8 = uncurryThis(DataViewPrototype.setInt8);
  testView.setInt8(0, 2147483648);
  testView.setInt8(1, 2147483649);
  if (testView.getInt8(0) || !testView.getInt8(1)) redefineAll(DataViewPrototype, {
    setInt8: function setInt8(byteOffset, value) {
      $setInt8(this, byteOffset, value << 24 >> 24);
    },
    setUint8: function setUint8(byteOffset, value) {
      $setInt8(this, byteOffset, value << 24 >> 24);
    }
  }, { unsafe: true });
}

setToStringTag($ArrayBuffer, ARRAY_BUFFER);
setToStringTag($DataView, DATA_VIEW);

module.exports = {
  ArrayBuffer: $ArrayBuffer,
  DataView: $DataView
};


/***/ }),

/***/ "622e":
/***/ (function(module, exports, __webpack_require__) {

// style-loader: Adds some css to the DOM by adding a <style> tag

// load the styles
var content = __webpack_require__("7943");
if(content.__esModule) content = content.default;
if(typeof content === 'string') content = [[module.i, content, '']];
if(content.locals) module.exports = content.locals;
// add the styles to the DOM
var add = __webpack_require__("499e").default
var update = add("6eff42ac", content, true, {"sourceMap":false,"shadowMode":false});

/***/ }),

/***/ "6483":
/***/ (function(module, exports) {

// font.js

/**
 * @typedef {number} fontsizePX px for fontSize
 */

/**
 * @typedef {number} fontsizePT pt for fontSize
 */

/**
 * @typedef {object} BaseFont
 * @property {string} key inner key
 * @property {string} title title for display
 */

/**
 * @typedef {object} FontSize
 * @property {fontsizePT} pt
 * @property {fontsizePX} px
 */
// alphabet.js

/**
 * @typedef {string} tagA1 A1 tag for XY-tag (0, 0)
 * @example "A1"
 */

/**
 * @typedef {[number, number]} tagXY
 * @example [0, 0]
 */

/***/ }),

/***/ "649e":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var ArrayBufferViewCore = __webpack_require__("ebb5");
var $some = __webpack_require__("b727").some;

var aTypedArray = ArrayBufferViewCore.aTypedArray;
var exportTypedArrayMethod = ArrayBufferViewCore.exportTypedArrayMethod;

// `%TypedArray%.prototype.some` method
// https://tc39.es/ecma262/#sec-%typedarray%.prototype.some
exportTypedArrayMethod('some', function some(callbackfn /* , thisArg */) {
  return $some(aTypedArray(this), callbackfn, arguments.length > 1 ? arguments[1] : undefined);
});


/***/ }),

/***/ "6547":
/***/ (function(module, exports, __webpack_require__) {

var uncurryThis = __webpack_require__("e330");
var toIntegerOrInfinity = __webpack_require__("5926");
var toString = __webpack_require__("577e");
var requireObjectCoercible = __webpack_require__("1d80");

var charAt = uncurryThis(''.charAt);
var charCodeAt = uncurryThis(''.charCodeAt);
var stringSlice = uncurryThis(''.slice);

var createMethod = function (CONVERT_TO_STRING) {
  return function ($this, pos) {
    var S = toString(requireObjectCoercible($this));
    var position = toIntegerOrInfinity(pos);
    var size = S.length;
    var first, second;
    if (position < 0 || position >= size) return CONVERT_TO_STRING ? '' : undefined;
    first = charCodeAt(S, position);
    return first < 0xD800 || first > 0xDBFF || position + 1 === size
      || (second = charCodeAt(S, position + 1)) < 0xDC00 || second > 0xDFFF
        ? CONVERT_TO_STRING
          ? charAt(S, position)
          : first
        : CONVERT_TO_STRING
          ? stringSlice(S, position, position + 2)
          : (first - 0xD800 << 10) + (second - 0xDC00) + 0x10000;
  };
};

module.exports = {
  // `String.prototype.codePointAt` method
  // https://tc39.es/ecma262/#sec-string.prototype.codepointat
  codeAt: createMethod(false),
  // `String.prototype.at` method
  // https://github.com/mathiasbynens/String.prototype.at
  charAt: createMethod(true)
};


/***/ }),

/***/ "6566":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var defineProperty = __webpack_require__("9bf2").f;
var create = __webpack_require__("7c73");
var redefineAll = __webpack_require__("e2cc");
var bind = __webpack_require__("0366");
var anInstance = __webpack_require__("19aa");
var iterate = __webpack_require__("2266");
var defineIterator = __webpack_require__("7dd0");
var setSpecies = __webpack_require__("2626");
var DESCRIPTORS = __webpack_require__("83ab");
var fastKey = __webpack_require__("f183").fastKey;
var InternalStateModule = __webpack_require__("69f3");

var setInternalState = InternalStateModule.set;
var internalStateGetterFor = InternalStateModule.getterFor;

module.exports = {
  getConstructor: function (wrapper, CONSTRUCTOR_NAME, IS_MAP, ADDER) {
    var Constructor = wrapper(function (that, iterable) {
      anInstance(that, Prototype);
      setInternalState(that, {
        type: CONSTRUCTOR_NAME,
        index: create(null),
        first: undefined,
        last: undefined,
        size: 0
      });
      if (!DESCRIPTORS) that.size = 0;
      if (iterable != undefined) iterate(iterable, that[ADDER], { that: that, AS_ENTRIES: IS_MAP });
    });

    var Prototype = Constructor.prototype;

    var getInternalState = internalStateGetterFor(CONSTRUCTOR_NAME);

    var define = function (that, key, value) {
      var state = getInternalState(that);
      var entry = getEntry(that, key);
      var previous, index;
      // change existing entry
      if (entry) {
        entry.value = value;
      // create new entry
      } else {
        state.last = entry = {
          index: index = fastKey(key, true),
          key: key,
          value: value,
          previous: previous = state.last,
          next: undefined,
          removed: false
        };
        if (!state.first) state.first = entry;
        if (previous) previous.next = entry;
        if (DESCRIPTORS) state.size++;
        else that.size++;
        // add to index
        if (index !== 'F') state.index[index] = entry;
      } return that;
    };

    var getEntry = function (that, key) {
      var state = getInternalState(that);
      // fast case
      var index = fastKey(key);
      var entry;
      if (index !== 'F') return state.index[index];
      // frozen object case
      for (entry = state.first; entry; entry = entry.next) {
        if (entry.key == key) return entry;
      }
    };

    redefineAll(Prototype, {
      // `{ Map, Set }.prototype.clear()` methods
      // https://tc39.es/ecma262/#sec-map.prototype.clear
      // https://tc39.es/ecma262/#sec-set.prototype.clear
      clear: function clear() {
        var that = this;
        var state = getInternalState(that);
        var data = state.index;
        var entry = state.first;
        while (entry) {
          entry.removed = true;
          if (entry.previous) entry.previous = entry.previous.next = undefined;
          delete data[entry.index];
          entry = entry.next;
        }
        state.first = state.last = undefined;
        if (DESCRIPTORS) state.size = 0;
        else that.size = 0;
      },
      // `{ Map, Set }.prototype.delete(key)` methods
      // https://tc39.es/ecma262/#sec-map.prototype.delete
      // https://tc39.es/ecma262/#sec-set.prototype.delete
      'delete': function (key) {
        var that = this;
        var state = getInternalState(that);
        var entry = getEntry(that, key);
        if (entry) {
          var next = entry.next;
          var prev = entry.previous;
          delete state.index[entry.index];
          entry.removed = true;
          if (prev) prev.next = next;
          if (next) next.previous = prev;
          if (state.first == entry) state.first = next;
          if (state.last == entry) state.last = prev;
          if (DESCRIPTORS) state.size--;
          else that.size--;
        } return !!entry;
      },
      // `{ Map, Set }.prototype.forEach(callbackfn, thisArg = undefined)` methods
      // https://tc39.es/ecma262/#sec-map.prototype.foreach
      // https://tc39.es/ecma262/#sec-set.prototype.foreach
      forEach: function forEach(callbackfn /* , that = undefined */) {
        var state = getInternalState(this);
        var boundFunction = bind(callbackfn, arguments.length > 1 ? arguments[1] : undefined);
        var entry;
        while (entry = entry ? entry.next : state.first) {
          boundFunction(entry.value, entry.key, this);
          // revert to the last existing entry
          while (entry && entry.removed) entry = entry.previous;
        }
      },
      // `{ Map, Set}.prototype.has(key)` methods
      // https://tc39.es/ecma262/#sec-map.prototype.has
      // https://tc39.es/ecma262/#sec-set.prototype.has
      has: function has(key) {
        return !!getEntry(this, key);
      }
    });

    redefineAll(Prototype, IS_MAP ? {
      // `Map.prototype.get(key)` method
      // https://tc39.es/ecma262/#sec-map.prototype.get
      get: function get(key) {
        var entry = getEntry(this, key);
        return entry && entry.value;
      },
      // `Map.prototype.set(key, value)` method
      // https://tc39.es/ecma262/#sec-map.prototype.set
      set: function set(key, value) {
        return define(this, key === 0 ? 0 : key, value);
      }
    } : {
      // `Set.prototype.add(value)` method
      // https://tc39.es/ecma262/#sec-set.prototype.add
      add: function add(value) {
        return define(this, value = value === 0 ? 0 : value, value);
      }
    });
    if (DESCRIPTORS) defineProperty(Prototype, 'size', {
      get: function () {
        return getInternalState(this).size;
      }
    });
    return Constructor;
  },
  setStrong: function (Constructor, CONSTRUCTOR_NAME, IS_MAP) {
    var ITERATOR_NAME = CONSTRUCTOR_NAME + ' Iterator';
    var getInternalCollectionState = internalStateGetterFor(CONSTRUCTOR_NAME);
    var getInternalIteratorState = internalStateGetterFor(ITERATOR_NAME);
    // `{ Map, Set }.prototype.{ keys, values, entries, @@iterator }()` methods
    // https://tc39.es/ecma262/#sec-map.prototype.entries
    // https://tc39.es/ecma262/#sec-map.prototype.keys
    // https://tc39.es/ecma262/#sec-map.prototype.values
    // https://tc39.es/ecma262/#sec-map.prototype-@@iterator
    // https://tc39.es/ecma262/#sec-set.prototype.entries
    // https://tc39.es/ecma262/#sec-set.prototype.keys
    // https://tc39.es/ecma262/#sec-set.prototype.values
    // https://tc39.es/ecma262/#sec-set.prototype-@@iterator
    defineIterator(Constructor, CONSTRUCTOR_NAME, function (iterated, kind) {
      setInternalState(this, {
        type: ITERATOR_NAME,
        target: iterated,
        state: getInternalCollectionState(iterated),
        kind: kind,
        last: undefined
      });
    }, function () {
      var state = getInternalIteratorState(this);
      var kind = state.kind;
      var entry = state.last;
      // revert to the last existing entry
      while (entry && entry.removed) entry = entry.previous;
      // get next entry
      if (!state.target || !(state.last = entry = entry ? entry.next : state.state.first)) {
        // or finish the iteration
        state.target = undefined;
        return { value: undefined, done: true };
      }
      // return step by kind
      if (kind == 'keys') return { value: entry.key, done: false };
      if (kind == 'values') return { value: entry.value, done: false };
      return { value: [entry.key, entry.value], done: false };
    }, IS_MAP ? 'entries' : 'values', !IS_MAP, true);

    // `{ Map, Set }.prototype[@@species]` accessors
    // https://tc39.es/ecma262/#sec-get-map-@@species
    // https://tc39.es/ecma262/#sec-get-set-@@species
    setSpecies(CONSTRUCTOR_NAME);
  }
};


/***/ }),

/***/ "65f0":
/***/ (function(module, exports, __webpack_require__) {

var arraySpeciesConstructor = __webpack_require__("0b42");

// `ArraySpeciesCreate` abstract operation
// https://tc39.es/ecma262/#sec-arrayspeciescreate
module.exports = function (originalArray, length) {
  return new (arraySpeciesConstructor(originalArray))(length === 0 ? 0 : length);
};


/***/ }),

/***/ "68ee":
/***/ (function(module, exports, __webpack_require__) {

var uncurryThis = __webpack_require__("e330");
var fails = __webpack_require__("d039");
var isCallable = __webpack_require__("1626");
var classof = __webpack_require__("f5df");
var getBuiltIn = __webpack_require__("d066");
var inspectSource = __webpack_require__("8925");

var noop = function () { /* empty */ };
var empty = [];
var construct = getBuiltIn('Reflect', 'construct');
var constructorRegExp = /^\s*(?:class|function)\b/;
var exec = uncurryThis(constructorRegExp.exec);
var INCORRECT_TO_STRING = !constructorRegExp.exec(noop);

var isConstructorModern = function (argument) {
  if (!isCallable(argument)) return false;
  try {
    construct(noop, empty, argument);
    return true;
  } catch (error) {
    return false;
  }
};

var isConstructorLegacy = function (argument) {
  if (!isCallable(argument)) return false;
  switch (classof(argument)) {
    case 'AsyncFunction':
    case 'GeneratorFunction':
    case 'AsyncGeneratorFunction': return false;
    // we can't check .prototype since constructors produced by .bind haven't it
  } return INCORRECT_TO_STRING || !!exec(constructorRegExp, inspectSource(argument));
};

// `IsConstructor` abstract operation
// https://tc39.es/ecma262/#sec-isconstructor
module.exports = !construct || fails(function () {
  var called;
  return isConstructorModern(isConstructorModern.call)
    || !isConstructorModern(Object)
    || !isConstructorModern(function () { called = true; })
    || called;
}) ? isConstructorLegacy : isConstructorModern;


/***/ }),

/***/ "69f3":
/***/ (function(module, exports, __webpack_require__) {

var NATIVE_WEAK_MAP = __webpack_require__("7f9a");
var global = __webpack_require__("da84");
var uncurryThis = __webpack_require__("e330");
var isObject = __webpack_require__("861d");
var createNonEnumerableProperty = __webpack_require__("9112");
var hasOwn = __webpack_require__("1a2d");
var shared = __webpack_require__("c6cd");
var sharedKey = __webpack_require__("f772");
var hiddenKeys = __webpack_require__("d012");

var OBJECT_ALREADY_INITIALIZED = 'Object already initialized';
var TypeError = global.TypeError;
var WeakMap = global.WeakMap;
var set, get, has;

var enforce = function (it) {
  return has(it) ? get(it) : set(it, {});
};

var getterFor = function (TYPE) {
  return function (it) {
    var state;
    if (!isObject(it) || (state = get(it)).type !== TYPE) {
      throw TypeError('Incompatible receiver, ' + TYPE + ' required');
    } return state;
  };
};

if (NATIVE_WEAK_MAP || shared.state) {
  var store = shared.state || (shared.state = new WeakMap());
  var wmget = uncurryThis(store.get);
  var wmhas = uncurryThis(store.has);
  var wmset = uncurryThis(store.set);
  set = function (it, metadata) {
    if (wmhas(store, it)) throw new TypeError(OBJECT_ALREADY_INITIALIZED);
    metadata.facade = it;
    wmset(store, it, metadata);
    return metadata;
  };
  get = function (it) {
    return wmget(store, it) || {};
  };
  has = function (it) {
    return wmhas(store, it);
  };
} else {
  var STATE = sharedKey('state');
  hiddenKeys[STATE] = true;
  set = function (it, metadata) {
    if (hasOwn(it, STATE)) throw new TypeError(OBJECT_ALREADY_INITIALIZED);
    metadata.facade = it;
    createNonEnumerableProperty(it, STATE, metadata);
    return metadata;
  };
  get = function (it) {
    return hasOwn(it, STATE) ? it[STATE] : {};
  };
  has = function (it) {
    return hasOwn(it, STATE);
  };
}

module.exports = {
  set: set,
  get: get,
  has: has,
  enforce: enforce,
  getterFor: getterFor
};


/***/ }),

/***/ "6c29":
/***/ (function(module, exports, __webpack_require__) {

// Imports
var ___CSS_LOADER_API_IMPORT___ = __webpack_require__("24fb");
exports = ___CSS_LOADER_API_IMPORT___(false);
// Module
exports.push([module.i, ".contentStyle[data-v-448a11a0]{overflow:hidden}.contentStyle[data-v-448a11a0],.contentStyle .tree-map[data-v-448a11a0]{position:absolute}.contentStyle .tree-map[data-v-448a11a0] ul{padding-left:10px;padding-left:1em;line-height:1;list-style-type:none;font-size:12px;margin:0}.contentStyle .tree-map[data-v-448a11a0] ul .item{cursor:pointer}.contentStyle .tree-map[data-v-448a11a0] ul .bold{font-size:12px;height:18px}.contentStyle .tree-map[data-v-448a11a0] ul .item-span{height:18px}.contentStyle .tree-map[data-v-448a11a0] ul .item-span span{font-size:13px}.contentStyle .tree-map[data-v-448a11a0] ul .isColes{-webkit-transform:rotate(-90deg);transform:rotate(-90deg);display:inline-block}", ""]);
// Exports
module.exports = exports;


/***/ }),

/***/ "6d61":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var $ = __webpack_require__("23e7");
var global = __webpack_require__("da84");
var uncurryThis = __webpack_require__("e330");
var isForced = __webpack_require__("94ca");
var redefine = __webpack_require__("6eeb");
var InternalMetadataModule = __webpack_require__("f183");
var iterate = __webpack_require__("2266");
var anInstance = __webpack_require__("19aa");
var isCallable = __webpack_require__("1626");
var isObject = __webpack_require__("861d");
var fails = __webpack_require__("d039");
var checkCorrectnessOfIteration = __webpack_require__("1c7e");
var setToStringTag = __webpack_require__("d44e");
var inheritIfRequired = __webpack_require__("7156");

module.exports = function (CONSTRUCTOR_NAME, wrapper, common) {
  var IS_MAP = CONSTRUCTOR_NAME.indexOf('Map') !== -1;
  var IS_WEAK = CONSTRUCTOR_NAME.indexOf('Weak') !== -1;
  var ADDER = IS_MAP ? 'set' : 'add';
  var NativeConstructor = global[CONSTRUCTOR_NAME];
  var NativePrototype = NativeConstructor && NativeConstructor.prototype;
  var Constructor = NativeConstructor;
  var exported = {};

  var fixMethod = function (KEY) {
    var uncurriedNativeMethod = uncurryThis(NativePrototype[KEY]);
    redefine(NativePrototype, KEY,
      KEY == 'add' ? function add(value) {
        uncurriedNativeMethod(this, value === 0 ? 0 : value);
        return this;
      } : KEY == 'delete' ? function (key) {
        return IS_WEAK && !isObject(key) ? false : uncurriedNativeMethod(this, key === 0 ? 0 : key);
      } : KEY == 'get' ? function get(key) {
        return IS_WEAK && !isObject(key) ? undefined : uncurriedNativeMethod(this, key === 0 ? 0 : key);
      } : KEY == 'has' ? function has(key) {
        return IS_WEAK && !isObject(key) ? false : uncurriedNativeMethod(this, key === 0 ? 0 : key);
      } : function set(key, value) {
        uncurriedNativeMethod(this, key === 0 ? 0 : key, value);
        return this;
      }
    );
  };

  var REPLACE = isForced(
    CONSTRUCTOR_NAME,
    !isCallable(NativeConstructor) || !(IS_WEAK || NativePrototype.forEach && !fails(function () {
      new NativeConstructor().entries().next();
    }))
  );

  if (REPLACE) {
    // create collection constructor
    Constructor = common.getConstructor(wrapper, CONSTRUCTOR_NAME, IS_MAP, ADDER);
    InternalMetadataModule.enable();
  } else if (isForced(CONSTRUCTOR_NAME, true)) {
    var instance = new Constructor();
    // early implementations not supports chaining
    var HASNT_CHAINING = instance[ADDER](IS_WEAK ? {} : -0, 1) != instance;
    // V8 ~ Chromium 40- weak-collections throws on primitives, but should return false
    var THROWS_ON_PRIMITIVES = fails(function () { instance.has(1); });
    // most early implementations doesn't supports iterables, most modern - not close it correctly
    // eslint-disable-next-line no-new -- required for testing
    var ACCEPT_ITERABLES = checkCorrectnessOfIteration(function (iterable) { new NativeConstructor(iterable); });
    // for early implementations -0 and +0 not the same
    var BUGGY_ZERO = !IS_WEAK && fails(function () {
      // V8 ~ Chromium 42- fails only with 5+ elements
      var $instance = new NativeConstructor();
      var index = 5;
      while (index--) $instance[ADDER](index, index);
      return !$instance.has(-0);
    });

    if (!ACCEPT_ITERABLES) {
      Constructor = wrapper(function (dummy, iterable) {
        anInstance(dummy, NativePrototype);
        var that = inheritIfRequired(new NativeConstructor(), dummy, Constructor);
        if (iterable != undefined) iterate(iterable, that[ADDER], { that: that, AS_ENTRIES: IS_MAP });
        return that;
      });
      Constructor.prototype = NativePrototype;
      NativePrototype.constructor = Constructor;
    }

    if (THROWS_ON_PRIMITIVES || BUGGY_ZERO) {
      fixMethod('delete');
      fixMethod('has');
      IS_MAP && fixMethod('get');
    }

    if (BUGGY_ZERO || HASNT_CHAINING) fixMethod(ADDER);

    // weak collections should not contains .clear method
    if (IS_WEAK && NativePrototype.clear) delete NativePrototype.clear;
  }

  exported[CONSTRUCTOR_NAME] = Constructor;
  $({ global: true, forced: Constructor != NativeConstructor }, exported);

  setToStringTag(Constructor, CONSTRUCTOR_NAME);

  if (!IS_WEAK) common.setStrong(Constructor, CONSTRUCTOR_NAME, IS_MAP);

  return Constructor;
};


/***/ }),

/***/ "6eeb":
/***/ (function(module, exports, __webpack_require__) {

var global = __webpack_require__("da84");
var isCallable = __webpack_require__("1626");
var hasOwn = __webpack_require__("1a2d");
var createNonEnumerableProperty = __webpack_require__("9112");
var setGlobal = __webpack_require__("ce4e");
var inspectSource = __webpack_require__("8925");
var InternalStateModule = __webpack_require__("69f3");
var CONFIGURABLE_FUNCTION_NAME = __webpack_require__("5e77").CONFIGURABLE;

var getInternalState = InternalStateModule.get;
var enforceInternalState = InternalStateModule.enforce;
var TEMPLATE = String(String).split('String');

(module.exports = function (O, key, value, options) {
  var unsafe = options ? !!options.unsafe : false;
  var simple = options ? !!options.enumerable : false;
  var noTargetGet = options ? !!options.noTargetGet : false;
  var name = options && options.name !== undefined ? options.name : key;
  var state;
  if (isCallable(value)) {
    if (String(name).slice(0, 7) === 'Symbol(') {
      name = '[' + String(name).replace(/^Symbol\(([^)]*)\)/, '$1') + ']';
    }
    if (!hasOwn(value, 'name') || (CONFIGURABLE_FUNCTION_NAME && value.name !== name)) {
      createNonEnumerableProperty(value, 'name', name);
    }
    state = enforceInternalState(value);
    if (!state.source) {
      state.source = TEMPLATE.join(typeof name == 'string' ? name : '');
    }
  }
  if (O === global) {
    if (simple) O[key] = value;
    else setGlobal(key, value);
    return;
  } else if (!unsafe) {
    delete O[key];
  } else if (!noTargetGet && O[key]) {
    simple = true;
  }
  if (simple) O[key] = value;
  else createNonEnumerableProperty(O, key, value);
// add fake Function#toString for correct work wrapped methods / constructors with methods like LoDash isNative
})(Function.prototype, 'toString', function toString() {
  return isCallable(this) && getInternalState(this).source || inspectSource(this);
});


/***/ }),

/***/ "6f53":
/***/ (function(module, exports, __webpack_require__) {

var DESCRIPTORS = __webpack_require__("83ab");
var uncurryThis = __webpack_require__("e330");
var objectKeys = __webpack_require__("df75");
var toIndexedObject = __webpack_require__("fc6a");
var $propertyIsEnumerable = __webpack_require__("d1e7").f;

var propertyIsEnumerable = uncurryThis($propertyIsEnumerable);
var push = uncurryThis([].push);

// `Object.{ entries, values }` methods implementation
var createMethod = function (TO_ENTRIES) {
  return function (it) {
    var O = toIndexedObject(it);
    var keys = objectKeys(O);
    var length = keys.length;
    var i = 0;
    var result = [];
    var key;
    while (length > i) {
      key = keys[i++];
      if (!DESCRIPTORS || propertyIsEnumerable(O, key)) {
        push(result, TO_ENTRIES ? [key, O[key]] : O[key]);
      }
    }
    return result;
  };
};

module.exports = {
  // `Object.entries` method
  // https://tc39.es/ecma262/#sec-object.entries
  entries: createMethod(true),
  // `Object.values` method
  // https://tc39.es/ecma262/#sec-object.values
  values: createMethod(false)
};


/***/ }),

/***/ "7037":
/***/ (function(module, exports, __webpack_require__) {

__webpack_require__("a4d3");

__webpack_require__("e01a");

__webpack_require__("d3b7");

__webpack_require__("d28b");

__webpack_require__("e260");

__webpack_require__("3ca3");

__webpack_require__("ddb0");

function _typeof(obj) {
  "@babel/helpers - typeof";

  if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") {
    module.exports = _typeof = function _typeof(obj) {
      return typeof obj;
    };

    module.exports["default"] = module.exports, module.exports.__esModule = true;
  } else {
    module.exports = _typeof = function _typeof(obj) {
      return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj;
    };

    module.exports["default"] = module.exports, module.exports.__esModule = true;
  }

  return _typeof(obj);
}

module.exports = _typeof;
module.exports["default"] = module.exports, module.exports.__esModule = true;

/***/ }),

/***/ "70de":
/***/ (function(module, exports, __webpack_require__) {

// style-loader: Adds some css to the DOM by adding a <style> tag

// load the styles
var content = __webpack_require__("c631");
if(content.__esModule) content = content.default;
if(typeof content === 'string') content = [[module.i, content, '']];
if(content.locals) module.exports = content.locals;
// add the styles to the DOM
var add = __webpack_require__("499e").default
var update = add("0f7f47f8", content, true, {"sourceMap":false,"shadowMode":false});

/***/ }),

/***/ "7156":
/***/ (function(module, exports, __webpack_require__) {

var isCallable = __webpack_require__("1626");
var isObject = __webpack_require__("861d");
var setPrototypeOf = __webpack_require__("d2bb");

// makes subclassing work correct for wrapped built-ins
module.exports = function ($this, dummy, Wrapper) {
  var NewTarget, NewTargetPrototype;
  if (
    // it can work only with native `setPrototypeOf`
    setPrototypeOf &&
    // we haven't completely correct pre-ES6 way for getting `new.target`, so use this
    isCallable(NewTarget = dummy.constructor) &&
    NewTarget !== Wrapper &&
    isObject(NewTargetPrototype = NewTarget.prototype) &&
    NewTargetPrototype !== Wrapper.prototype
  ) setPrototypeOf($this, NewTargetPrototype);
  return $this;
};


/***/ }),

/***/ "72f7":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var exportTypedArrayMethod = __webpack_require__("ebb5").exportTypedArrayMethod;
var fails = __webpack_require__("d039");
var global = __webpack_require__("da84");
var uncurryThis = __webpack_require__("e330");

var Uint8Array = global.Uint8Array;
var Uint8ArrayPrototype = Uint8Array && Uint8Array.prototype || {};
var arrayToString = [].toString;
var join = uncurryThis([].join);

if (fails(function () { arrayToString.call({}); })) {
  arrayToString = function toString() {
    return join(this);
  };
}

var IS_NOT_ARRAY_METHOD = Uint8ArrayPrototype.toString != arrayToString;

// `%TypedArray%.prototype.toString` method
// https://tc39.es/ecma262/#sec-%typedarray%.prototype.tostring
exportTypedArrayMethod('toString', arrayToString, IS_NOT_ARRAY_METHOD);


/***/ }),

/***/ "735e":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var ArrayBufferViewCore = __webpack_require__("ebb5");
var call = __webpack_require__("c65b");
var $fill = __webpack_require__("81d5");

var aTypedArray = ArrayBufferViewCore.aTypedArray;
var exportTypedArrayMethod = ArrayBufferViewCore.exportTypedArrayMethod;

// `%TypedArray%.prototype.fill` method
// https://tc39.es/ecma262/#sec-%typedarray%.prototype.fill
exportTypedArrayMethod('fill', function fill(value /* , start, end */) {
  var length = arguments.length;
  return call(
    $fill,
    aTypedArray(this),
    value,
    length > 1 ? arguments[1] : undefined,
    length > 2 ? arguments[2] : undefined
  );
});


/***/ }),

/***/ "7418":
/***/ (function(module, exports) {

// eslint-disable-next-line es/no-object-getownpropertysymbols -- safe
exports.f = Object.getOwnPropertySymbols;


/***/ }),

/***/ "746f":
/***/ (function(module, exports, __webpack_require__) {

var path = __webpack_require__("428f");
var hasOwn = __webpack_require__("1a2d");
var wrappedWellKnownSymbolModule = __webpack_require__("e538");
var defineProperty = __webpack_require__("9bf2").f;

module.exports = function (NAME) {
  var Symbol = path.Symbol || (path.Symbol = {});
  if (!hasOwn(Symbol, NAME)) defineProperty(Symbol, NAME, {
    value: wrappedWellKnownSymbolModule.f(NAME)
  });
};


/***/ }),

/***/ "74e8":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var $ = __webpack_require__("23e7");
var global = __webpack_require__("da84");
var call = __webpack_require__("c65b");
var DESCRIPTORS = __webpack_require__("83ab");
var TYPED_ARRAYS_CONSTRUCTORS_REQUIRES_WRAPPERS = __webpack_require__("8aa7");
var ArrayBufferViewCore = __webpack_require__("ebb5");
var ArrayBufferModule = __webpack_require__("621a");
var anInstance = __webpack_require__("19aa");
var createPropertyDescriptor = __webpack_require__("5c6c");
var createNonEnumerableProperty = __webpack_require__("9112");
var isIntegralNumber = __webpack_require__("eac5");
var toLength = __webpack_require__("50c4");
var toIndex = __webpack_require__("0b25");
var toOffset = __webpack_require__("182d");
var toPropertyKey = __webpack_require__("a04b");
var hasOwn = __webpack_require__("1a2d");
var classof = __webpack_require__("f5df");
var isObject = __webpack_require__("861d");
var isSymbol = __webpack_require__("d9b5");
var create = __webpack_require__("7c73");
var isPrototypeOf = __webpack_require__("3a9b");
var setPrototypeOf = __webpack_require__("d2bb");
var getOwnPropertyNames = __webpack_require__("241c").f;
var typedArrayFrom = __webpack_require__("a078");
var forEach = __webpack_require__("b727").forEach;
var setSpecies = __webpack_require__("2626");
var definePropertyModule = __webpack_require__("9bf2");
var getOwnPropertyDescriptorModule = __webpack_require__("06cf");
var InternalStateModule = __webpack_require__("69f3");
var inheritIfRequired = __webpack_require__("7156");

var getInternalState = InternalStateModule.get;
var setInternalState = InternalStateModule.set;
var nativeDefineProperty = definePropertyModule.f;
var nativeGetOwnPropertyDescriptor = getOwnPropertyDescriptorModule.f;
var round = Math.round;
var RangeError = global.RangeError;
var ArrayBuffer = ArrayBufferModule.ArrayBuffer;
var ArrayBufferPrototype = ArrayBuffer.prototype;
var DataView = ArrayBufferModule.DataView;
var NATIVE_ARRAY_BUFFER_VIEWS = ArrayBufferViewCore.NATIVE_ARRAY_BUFFER_VIEWS;
var TYPED_ARRAY_CONSTRUCTOR = ArrayBufferViewCore.TYPED_ARRAY_CONSTRUCTOR;
var TYPED_ARRAY_TAG = ArrayBufferViewCore.TYPED_ARRAY_TAG;
var TypedArray = ArrayBufferViewCore.TypedArray;
var TypedArrayPrototype = ArrayBufferViewCore.TypedArrayPrototype;
var aTypedArrayConstructor = ArrayBufferViewCore.aTypedArrayConstructor;
var isTypedArray = ArrayBufferViewCore.isTypedArray;
var BYTES_PER_ELEMENT = 'BYTES_PER_ELEMENT';
var WRONG_LENGTH = 'Wrong length';

var fromList = function (C, list) {
  aTypedArrayConstructor(C);
  var index = 0;
  var length = list.length;
  var result = new C(length);
  while (length > index) result[index] = list[index++];
  return result;
};

var addGetter = function (it, key) {
  nativeDefineProperty(it, key, { get: function () {
    return getInternalState(this)[key];
  } });
};

var isArrayBuffer = function (it) {
  var klass;
  return isPrototypeOf(ArrayBufferPrototype, it) || (klass = classof(it)) == 'ArrayBuffer' || klass == 'SharedArrayBuffer';
};

var isTypedArrayIndex = function (target, key) {
  return isTypedArray(target)
    && !isSymbol(key)
    && key in target
    && isIntegralNumber(+key)
    && key >= 0;
};

var wrappedGetOwnPropertyDescriptor = function getOwnPropertyDescriptor(target, key) {
  key = toPropertyKey(key);
  return isTypedArrayIndex(target, key)
    ? createPropertyDescriptor(2, target[key])
    : nativeGetOwnPropertyDescriptor(target, key);
};

var wrappedDefineProperty = function defineProperty(target, key, descriptor) {
  key = toPropertyKey(key);
  if (isTypedArrayIndex(target, key)
    && isObject(descriptor)
    && hasOwn(descriptor, 'value')
    && !hasOwn(descriptor, 'get')
    && !hasOwn(descriptor, 'set')
    // TODO: add validation descriptor w/o calling accessors
    && !descriptor.configurable
    && (!hasOwn(descriptor, 'writable') || descriptor.writable)
    && (!hasOwn(descriptor, 'enumerable') || descriptor.enumerable)
  ) {
    target[key] = descriptor.value;
    return target;
  } return nativeDefineProperty(target, key, descriptor);
};

if (DESCRIPTORS) {
  if (!NATIVE_ARRAY_BUFFER_VIEWS) {
    getOwnPropertyDescriptorModule.f = wrappedGetOwnPropertyDescriptor;
    definePropertyModule.f = wrappedDefineProperty;
    addGetter(TypedArrayPrototype, 'buffer');
    addGetter(TypedArrayPrototype, 'byteOffset');
    addGetter(TypedArrayPrototype, 'byteLength');
    addGetter(TypedArrayPrototype, 'length');
  }

  $({ target: 'Object', stat: true, forced: !NATIVE_ARRAY_BUFFER_VIEWS }, {
    getOwnPropertyDescriptor: wrappedGetOwnPropertyDescriptor,
    defineProperty: wrappedDefineProperty
  });

  module.exports = function (TYPE, wrapper, CLAMPED) {
    var BYTES = TYPE.match(/\d+$/)[0] / 8;
    var CONSTRUCTOR_NAME = TYPE + (CLAMPED ? 'Clamped' : '') + 'Array';
    var GETTER = 'get' + TYPE;
    var SETTER = 'set' + TYPE;
    var NativeTypedArrayConstructor = global[CONSTRUCTOR_NAME];
    var TypedArrayConstructor = NativeTypedArrayConstructor;
    var TypedArrayConstructorPrototype = TypedArrayConstructor && TypedArrayConstructor.prototype;
    var exported = {};

    var getter = function (that, index) {
      var data = getInternalState(that);
      return data.view[GETTER](index * BYTES + data.byteOffset, true);
    };

    var setter = function (that, index, value) {
      var data = getInternalState(that);
      if (CLAMPED) value = (value = round(value)) < 0 ? 0 : value > 0xFF ? 0xFF : value & 0xFF;
      data.view[SETTER](index * BYTES + data.byteOffset, value, true);
    };

    var addElement = function (that, index) {
      nativeDefineProperty(that, index, {
        get: function () {
          return getter(this, index);
        },
        set: function (value) {
          return setter(this, index, value);
        },
        enumerable: true
      });
    };

    if (!NATIVE_ARRAY_BUFFER_VIEWS) {
      TypedArrayConstructor = wrapper(function (that, data, offset, $length) {
        anInstance(that, TypedArrayConstructorPrototype);
        var index = 0;
        var byteOffset = 0;
        var buffer, byteLength, length;
        if (!isObject(data)) {
          length = toIndex(data);
          byteLength = length * BYTES;
          buffer = new ArrayBuffer(byteLength);
        } else if (isArrayBuffer(data)) {
          buffer = data;
          byteOffset = toOffset(offset, BYTES);
          var $len = data.byteLength;
          if ($length === undefined) {
            if ($len % BYTES) throw RangeError(WRONG_LENGTH);
            byteLength = $len - byteOffset;
            if (byteLength < 0) throw RangeError(WRONG_LENGTH);
          } else {
            byteLength = toLength($length) * BYTES;
            if (byteLength + byteOffset > $len) throw RangeError(WRONG_LENGTH);
          }
          length = byteLength / BYTES;
        } else if (isTypedArray(data)) {
          return fromList(TypedArrayConstructor, data);
        } else {
          return call(typedArrayFrom, TypedArrayConstructor, data);
        }
        setInternalState(that, {
          buffer: buffer,
          byteOffset: byteOffset,
          byteLength: byteLength,
          length: length,
          view: new DataView(buffer)
        });
        while (index < length) addElement(that, index++);
      });

      if (setPrototypeOf) setPrototypeOf(TypedArrayConstructor, TypedArray);
      TypedArrayConstructorPrototype = TypedArrayConstructor.prototype = create(TypedArrayPrototype);
    } else if (TYPED_ARRAYS_CONSTRUCTORS_REQUIRES_WRAPPERS) {
      TypedArrayConstructor = wrapper(function (dummy, data, typedArrayOffset, $length) {
        anInstance(dummy, TypedArrayConstructorPrototype);
        return inheritIfRequired(function () {
          if (!isObject(data)) return new NativeTypedArrayConstructor(toIndex(data));
          if (isArrayBuffer(data)) return $length !== undefined
            ? new NativeTypedArrayConstructor(data, toOffset(typedArrayOffset, BYTES), $length)
            : typedArrayOffset !== undefined
              ? new NativeTypedArrayConstructor(data, toOffset(typedArrayOffset, BYTES))
              : new NativeTypedArrayConstructor(data);
          if (isTypedArray(data)) return fromList(TypedArrayConstructor, data);
          return call(typedArrayFrom, TypedArrayConstructor, data);
        }(), dummy, TypedArrayConstructor);
      });

      if (setPrototypeOf) setPrototypeOf(TypedArrayConstructor, TypedArray);
      forEach(getOwnPropertyNames(NativeTypedArrayConstructor), function (key) {
        if (!(key in TypedArrayConstructor)) {
          createNonEnumerableProperty(TypedArrayConstructor, key, NativeTypedArrayConstructor[key]);
        }
      });
      TypedArrayConstructor.prototype = TypedArrayConstructorPrototype;
    }

    if (TypedArrayConstructorPrototype.constructor !== TypedArrayConstructor) {
      createNonEnumerableProperty(TypedArrayConstructorPrototype, 'constructor', TypedArrayConstructor);
    }

    createNonEnumerableProperty(TypedArrayConstructorPrototype, TYPED_ARRAY_CONSTRUCTOR, TypedArrayConstructor);

    if (TYPED_ARRAY_TAG) {
      createNonEnumerableProperty(TypedArrayConstructorPrototype, TYPED_ARRAY_TAG, CONSTRUCTOR_NAME);
    }

    exported[CONSTRUCTOR_NAME] = TypedArrayConstructor;

    $({
      global: true, forced: TypedArrayConstructor != NativeTypedArrayConstructor, sham: !NATIVE_ARRAY_BUFFER_VIEWS
    }, exported);

    if (!(BYTES_PER_ELEMENT in TypedArrayConstructor)) {
      createNonEnumerableProperty(TypedArrayConstructor, BYTES_PER_ELEMENT, BYTES);
    }

    if (!(BYTES_PER_ELEMENT in TypedArrayConstructorPrototype)) {
      createNonEnumerableProperty(TypedArrayConstructorPrototype, BYTES_PER_ELEMENT, BYTES);
    }

    setSpecies(CONSTRUCTOR_NAME);
  };
} else module.exports = function () { /* empty */ };


/***/ }),

/***/ "756d":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var _node_modules_vue_style_loader_index_js_ref_9_oneOf_1_0_node_modules_css_loader_dist_cjs_js_ref_9_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_9_oneOf_1_2_node_modules_postcss_loader_src_index_js_ref_9_oneOf_1_3_node_modules_sass_loader_dist_cjs_js_ref_9_oneOf_1_4_node_modules_cache_loader_dist_cjs_js_ref_1_0_node_modules_vue_loader_lib_index_js_vue_loader_options_index_vue_vue_type_style_index_0_lang_scss___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("c29c");
/* harmony import */ var _node_modules_vue_style_loader_index_js_ref_9_oneOf_1_0_node_modules_css_loader_dist_cjs_js_ref_9_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_9_oneOf_1_2_node_modules_postcss_loader_src_index_js_ref_9_oneOf_1_3_node_modules_sass_loader_dist_cjs_js_ref_9_oneOf_1_4_node_modules_cache_loader_dist_cjs_js_ref_1_0_node_modules_vue_loader_lib_index_js_vue_loader_options_index_vue_vue_type_style_index_0_lang_scss___WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_node_modules_vue_style_loader_index_js_ref_9_oneOf_1_0_node_modules_css_loader_dist_cjs_js_ref_9_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_9_oneOf_1_2_node_modules_postcss_loader_src_index_js_ref_9_oneOf_1_3_node_modules_sass_loader_dist_cjs_js_ref_9_oneOf_1_4_node_modules_cache_loader_dist_cjs_js_ref_1_0_node_modules_vue_loader_lib_index_js_vue_loader_options_index_vue_vue_type_style_index_0_lang_scss___WEBPACK_IMPORTED_MODULE_0__);
/* unused harmony reexport * */


/***/ }),

/***/ "76d7":
/***/ (function(module, exports, __webpack_require__) {

// Imports
var ___CSS_LOADER_API_IMPORT___ = __webpack_require__("24fb");
var ___CSS_LOADER_GET_URL_IMPORT___ = __webpack_require__("1de5");
var ___CSS_LOADER_URL_IMPORT_0___ = __webpack_require__("ddd4");
exports = ___CSS_LOADER_API_IMPORT___(false);
var ___CSS_LOADER_URL_REPLACEMENT_0___ = ___CSS_LOADER_GET_URL_IMPORT___(___CSS_LOADER_URL_IMPORT_0___);
// Module
exports.push([module.i, "body{margin:0}.x-spreadsheet{font-size:13px;line-height:normal;-webkit-user-select:none;-ms-user-select:none;user-select:none;-moz-user-select:none;font-family:Lato,Source Sans Pro,Roboto,Helvetica,Arial,sans-serif;-webkit-box-sizing:content-box;box-sizing:content-box;background:#fff;-webkit-font-smoothing:antialiased}.x-spreadsheet textarea{font:400 13px Arial,Lato,Source Sans Pro,Roboto,Helvetica,sans-serif}.x-spreadsheet-sheet{position:relative;overflow:hidden}.x-spreadsheet-table{vertical-align:bottom}.x-spreadsheet-tooltip{font-family:inherit;position:absolute;padding:5px 10px;color:#fff;border-radius:1px;background:#000;font-size:12px;z-index:201}.x-spreadsheet-tooltip:before{pointer-events:none;position:absolute;left:calc(50% - 4px);top:-4px;content:\"\";width:8px;height:8px;background:inherit;-webkit-transform:rotate(45deg);transform:rotate(45deg);z-index:1;-webkit-box-shadow:1px 1px 3px -1px rgba(0,0,0,.3);box-shadow:1px 1px 3px -1px rgba(0,0,0,.3)}.x-spreadsheet-color-palette{padding:5px;background:#fff}.x-spreadsheet-color-palette table{margin:0;padding:0;border-collapse:separate;border-spacing:2}.x-spreadsheet-color-palette table td{margin:0;cursor:pointer;border:1px solid transparent}.x-spreadsheet-color-palette table td:hover{border-color:#555}.x-spreadsheet-color-palette table td .x-spreadsheet-color-palette-cell{width:16px;height:16px}.x-spreadsheet-color-palette_input{background-color:#fff;height:21px;line-height:21px;border:1px solid #ddd;text-align:center;width:95%;font-size:14px}.x-spreadsheet-border-palette{width:150px}.x-spreadsheet-dropdown{position:relative}.x-spreadsheet-dropdown .x-spreadsheet-dropdown-content{position:absolute;z-index:200;background:#fff;-webkit-box-shadow:1px 2px 5px 2px rgba(51,51,51,.15);box-shadow:1px 2px 5px 2px rgba(51,51,51,.15)}.x-spreadsheet-dropdown.bottom-left .x-spreadsheet-dropdown-content{top:calc(100% + 5px);left:0}.x-spreadsheet-dropdown.bottom-right .x-spreadsheet-dropdown-content{top:calc(100% + 5px);right:0}.x-spreadsheet-dropdown.top-left .x-spreadsheet-dropdown-content{bottom:calc(100% + 5px);left:0}.x-spreadsheet-dropdown.top-right .x-spreadsheet-dropdown-content{bottom:calc(100% + 5px);right:0}.x-spreadsheet-dropdown .x-spreadsheet-dropdown-title{padding:0 5px;display:inline-block}.x-spreadsheet-dropdown .x-spreadsheet-dropdown-header .x-spreadsheet-icon.arrow-left{margin-left:4px}.x-spreadsheet-dropdown .x-spreadsheet-dropdown-header .x-spreadsheet-icon.arrow-right{width:10px;margin-right:4px}.x-spreadsheet-dropdown .x-spreadsheet-dropdown-header .x-spreadsheet-icon.arrow-right .arrow-down{left:-130px}.x-spreadsheet-resizer{position:absolute;z-index:11}.x-spreadsheet-resizer .x-spreadsheet-resizer-hover{background-color:rgba(75,137,255,.25)}.x-spreadsheet-resizer .x-spreadsheet-resizer-line{position:absolute}.x-spreadsheet-resizer.horizontal{cursor:row-resize}.x-spreadsheet-resizer.horizontal .x-spreadsheet-resizer-line{border-bottom:2px dashed #4b89ff;left:0;bottom:0}.x-spreadsheet-resizer.vertical{cursor:col-resize}.x-spreadsheet-resizer.vertical .x-spreadsheet-resizer-line{border-right:2px dashed #4b89ff;top:0;right:0}.x-spreadsheet-scrollbar{position:absolute;bottom:0;right:0;background-color:#f4f5f8;opacity:.9;z-index:12}.x-spreadsheet-scrollbar.horizontal{right:15px;overflow-x:scroll;overflow-y:hidden}.x-spreadsheet-scrollbar.horizontal>div{height:1px;background:#ddd}.x-spreadsheet-scrollbar.vertical{bottom:15px;overflow-x:hidden;overflow-y:scroll}.x-spreadsheet-scrollbar.vertical>div{width:1px;background:#ddd}.x-spreadsheet-overlayer{position:absolute;left:0;top:0;z-index:10}.x-spreadsheet-editor,.x-spreadsheet-overlayer .x-spreadsheet-overlayer-content,.x-spreadsheet-selector{position:absolute;overflow:hidden;pointer-events:none;width:100%;height:100%}.x-spreadsheet-editor,.x-spreadsheet-selector{-webkit-box-sizing:content-box;box-sizing:content-box;top:0;left:0}.x-spreadsheet-selector .hide-input{position:absolute;z-index:0}.x-spreadsheet-selector .hide-input input{padding:0;width:0;border:none!important;outline:none}.x-spreadsheet-selector .x-spreadsheet-selector-area{position:absolute;border:2px solid #4b89ff;background:rgba(75,137,255,.1);z-index:5;-webkit-box-sizing:content-box;box-sizing:content-box}.x-spreadsheet-selector .x-spreadsheet-selector-autofill,.x-spreadsheet-selector .x-spreadsheet-selector-clipboard,.x-spreadsheet-selector .x-spreadsheet-selector-dropdown,.x-spreadsheet-selector .x-spreadsheet-selector-message,.x-spreadsheet-selector .x-spreadsheet-selector-tips{position:absolute;background:transparent;z-index:100}.x-spreadsheet-selector .x-spreadsheet-selector-dropdown{pointer-events:auto;-webkit-transform:translate(125%);transform:translate(125%);width:32px;background-color:#ccc;margin-right:2px;cursor:pointer;border:1px solid #bbb}.x-spreadsheet-selector .x-spreadsheet-selector-dropdown:hover{background-color:#eee}.x-spreadsheet-selector .x-spreadsheet-selector-message,.x-spreadsheet-selector .x-spreadsheet-selector-tips{white-space:nowrap;background-color:#fff;border:1px solid #ccc;-webkit-box-shadow:1px 1px 3px -1px rgba(0,0,0,.3);box-shadow:1px 1px 3px -1px rgba(0,0,0,.3);-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;padding:8px;cursor:default}.x-spreadsheet-selector .x-spreadsheet-selector-message .icon,.x-spreadsheet-selector .x-spreadsheet-selector-tips .icon{padding-right:3px}.x-spreadsheet-selector .x-spreadsheet-selector-message:after,.x-spreadsheet-selector .x-spreadsheet-selector-message:before,.x-spreadsheet-selector .x-spreadsheet-selector-tips:after,.x-spreadsheet-selector .x-spreadsheet-selector-tips:before{content:\"\";position:absolute;display:block;width:0;height:0;border-color:transparent;border-style:solid;border-width:6px;-webkit-filter:drop-shadow(0 2px 12px rgba(0,0,0,.03));filter:drop-shadow(0 2px 12px rgba(0,0,0,.03));top:-6px;left:5px;margin-right:3px;border-top-width:0;border-bottom-color:#ccc}.x-spreadsheet-selector .x-spreadsheet-selector-message:before,.x-spreadsheet-selector .x-spreadsheet-selector-tips:before{top:-5px;border-bottom-color:#fff;z-index:1}.x-spreadsheet-selector .x-spreadsheet-selector-message{z-index:101}.x-spreadsheet-selector .x-spreadsheet-selector-message .icon{color:#d81e06}.x-spreadsheet-selector .x-spreadsheet-selector-clipboard{border:2px dashed #4b89ff}.x-spreadsheet-selector .x-spreadsheet-selector-autofill{border:1px dashed rgba(0,0,0,.45)}.x-spreadsheet-selector .x-spreadsheet-selector-corner{pointer-events:auto;position:absolute;cursor:crosshair;font-size:0;height:5px;width:5px;right:-5px;bottom:-5px;border:2px solid #fff;background:#4b89ff}.x-spreadsheet-editor{z-index:20}.x-spreadsheet-editor .x-spreadsheet-editor-area{position:absolute;text-align:left;border:2px solid #4b89ff;line-height:0;z-index:100;pointer-events:auto}.x-spreadsheet-editor .x-spreadsheet-editor-area .dropdown{position:absolute;right:0;top:6px;-webkit-transform:rotate(180deg);transform:rotate(180deg)}.x-spreadsheet-editor .x-spreadsheet-editor-area textarea{-webkit-box-sizing:content-box;box-sizing:content-box;border:none;padding:0 3px;outline:none;resize:none;text-align:start;overflow-y:hidden;font:400 13px Arial,Lato,Source Sans Pro,Roboto,Helvetica,sans-serif;color:inherit;white-space:normal;word-wrap:break-word;line-height:22px;margin:0}.x-spreadsheet-editor .x-spreadsheet-editor-area .textline{overflow:hidden;visibility:hidden;position:fixed;top:0;left:0}.x-spreadsheet-item-input{border:1px solid #ddd;width:44px;height:18px;border-radius:2px;text-align:center;margin:0 10px;font-size:12px;font-weight:400;float:right}.x-spreadsheet-item-input:focus{border-color:#0188fb;outline:none}.x-spreadsheet-item{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;background:0;border:1px solid transparent;outline:none;height:20px;color:rgba(0,0,0,.9);line-height:20px;list-style:none;padding:2px 10px;cursor:default;text-align:left;overflow:hidden;white-space:nowrap}.x-spreadsheet-item.disabled{pointer-events:none;opacity:.5}.x-spreadsheet-item.active,.x-spreadsheet-item:hover{background:rgba(0,0,0,.1)}.x-spreadsheet-item.divider{height:0;padding:0;margin:3px 0;border:none;border-bottom:1px solid rgba(0,0,0,.1)}.x-spreadsheet-item.auto{overflow:initial}.x-spreadsheet-item .label{float:right;opacity:.65;font-size:1em}.x-spreadsheet-header.state,.x-spreadsheet-item.state{padding-left:35px!important;position:relative}.x-spreadsheet-header.state:before,.x-spreadsheet-item.state:before{content:\"\";position:absolute;width:10px;height:10px;left:12px;top:calc(50% - 5px);background:rgba(0,0,0,.08);border-radius:2px}.x-spreadsheet-header.state.checked:before,.x-spreadsheet-item.state.checked:before{background:#4b89ff}.x-spreadsheet-checkbox{position:relative;display:inline-block;-webkit-backface-visibility:hidden;backface-visibility:hidden;outline:0;vertical-align:baseline;font-style:normal;font-size:1rem;line-height:1em}.x-spreadsheet-checkbox>input{position:absolute;top:0;left:0;opacity:0!important;outline:0;z-index:-1}.x-spreadsheet-contextmenu,.x-spreadsheet-sort-filter,.x-spreadsheet-suggest{position:absolute;-webkit-box-shadow:1px 2px 5px 2px rgba(51,51,51,.15);box-shadow:1px 2px 5px 2px rgba(51,51,51,.15);background:#fff;z-index:100;width:260px;pointer-events:auto;overflow:auto}.x-spreadsheet-suggest{width:200px}.x-spreadsheet-filter{border:1px solid #e9e9e9;font-size:12px;margin:10px}.x-spreadsheet-filter .x-spreadsheet-header{padding:.5em .75em;background:#f8f8f9;border-bottom:1px solid #e9e9e9;border-left:1px solid transparent}.x-spreadsheet-filter .x-spreadsheet-body{height:200px;overflow-y:auto}.x-spreadsheet-filter .x-spreadsheet-body .x-spreadsheet-item{height:20px;line-height:20px}.x-spreadsheet-sort-filter .x-spreadsheet-buttons{margin:10px}.x-spreadsheet-bottombar,.x-spreadsheet-toolbar{height:40px;padding:0 30px;text-align:left;background:#f5f6f7;display:-webkit-box;display:-ms-flexbox;display:flex}.x-spreadsheet-bottombar{position:relative;border-top:1px solid #e0e2e4;padding:0 15px}.x-spreadsheet-bottombar .x-spreadsheet-menu>li{vertical-align:middle;border-right:1px solid #e8eaed;-webkit-box-sizing:border-box;box-sizing:border-box}.x-spreadsheet-menu{list-style:none;margin:0;padding:0;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;overflow-x:auto;overflow-y:hidden;white-space:nowrap}.x-spreadsheet-menu-oper{display:-webkit-box;display:-ms-flexbox;display:flex;width:inherit;-webkit-box-align:center;-ms-flex-align:center;align-items:center;cursor:pointer;padding:0 18px 0 6px}.x-spreadsheet-menu-oper .x-spreadsheet-dropdown-content{padding:8px 5px}.x-spreadsheet-menu>li{display:inline-block;line-height:1.25em;padding:.785em 1em;margin:0;vertical-align:middle;text-align:left;font-weight:400;color:#80868b;white-space:nowrap;cursor:pointer;-webkit-transition:all .3s;transition:all .3s;font-weight:700}.x-spreadsheet-menu>li.active{background-color:#fff;color:rgba(0,0,0,.65)}.x-spreadsheet-menu>li .x-spreadsheet-icon{margin:0 6px}.x-spreadsheet-menu>li .x-spreadsheet-icon .x-spreadsheet-icon-img:hover{opacity:.85}.x-spreadsheet-menu>li .x-spreadsheet-dropdown{display:inline-block}.x-spreadsheet-toolbar{border-bottom:1px solid #e0e2e4;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;height:80px}.x-spreadsheet-toolbar .x-spreadsheet-toolbar-btns,.x-spreadsheet-toolbar .x-spreadsheet-toolbar-fn{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex}.x-spreadsheet-toolbar .x-spreadsheet-toolbar-fn{-webkit-box-sizing:border-box;box-sizing:border-box;width:100%;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row}.x-spreadsheet-toolbar .x-spreadsheet-toolbar-fn .formula-bar-item{margin-top:8px;margin-right:2px;height:28px;-webkit-box-sizing:border-box;box-sizing:border-box;background-color:#fff;border:1px solid #c6c6c6;line-height:28px}.x-spreadsheet-toolbar .x-spreadsheet-toolbar-fn .x-spreadsheet-toolbar-selector{text-align:center;width:150px}.x-spreadsheet-toolbar .x-spreadsheet-toolbar-fn .x-spreadsheet-toolbar-formula{-webkit-box-flex:1;-ms-flex:auto;flex:auto;padding:0 5px}.x-spreadsheet-toolbar .x-spreadsheet-toolbar-fn .x-spreadsheet-toolbar-formula:focus{outline:none}.x-spreadsheet-toolbar .x-spreadsheet-toolbar-fn .x-spreadsheet-toolbar-fn-btns span{margin:0 5px}.x-spreadsheet-toolbar .x-spreadsheet-toolbar-fn .x-spreadsheet-toolbar-fn-btns span.disabled{pointer-events:none;opacity:.5}.x-spreadsheet-toolbar .x-spreadsheet-toolbar-more{padding:0 6px 6px;text-align:left}.x-spreadsheet-toolbar .x-spreadsheet-toolbar-more .x-spreadsheet-toolbar-divider{margin-top:0}.x-spreadsheet-toolbar .x-spreadsheet-toolbar-btn{-webkit-box-flex:0;-ms-flex:0 0 auto;flex:0 0 auto;display:inline-block;border:1px solid transparent;height:26px;line-height:26px;min-width:26px;margin:6px 1px 0;padding:0;text-align:center;border-radius:2px}.x-spreadsheet-toolbar .x-spreadsheet-toolbar-btn.disabled{pointer-events:none;opacity:.5}.x-spreadsheet-toolbar .x-spreadsheet-toolbar-btn.active,.x-spreadsheet-toolbar .x-spreadsheet-toolbar-btn.holdActive,.x-spreadsheet-toolbar .x-spreadsheet-toolbar-btn:hover{background:rgba(0,0,0,.08)}.x-spreadsheet-toolbar-divider{display:inline-block;border-right:1px solid #e0e2e4;width:0;vertical-align:middle;height:18px;margin:12px 3px 0}.x-spreadsheet-print{position:absolute;left:0;top:0;z-index:100;width:100%;height:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.x-spreadsheet-print-bar{background:#424242;height:60px;line-height:60px;padding:0 30px}.x-spreadsheet-print-bar .-title{color:#fff;font-weight:700;font-size:1.2em;float:left}.x-spreadsheet-print-bar .-right{float:right;margin-top:12px}.x-spreadsheet-print-content{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-flex:1;-ms-flex:auto;flex:auto;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;background:#d0d0d0;height:calc(100% - 60px)}.x-spreadsheet-print-content .-sider{-webkit-box-flex:0;-ms-flex:0 0 300px;flex:0 0 300px;width:300px;border-left:2px solid #ccc;background:#fff}.x-spreadsheet-print-content .-content{-webkit-box-flex:1;-ms-flex:auto;flex:auto;overflow-x:auto;overflow-y:scroll;height:100%;padding:40px 20px}.x-spreadsheet-canvas-card{background:#fff;margin:20px auto;page-break-before:auto;page-break-after:always;-webkit-box-shadow:0 8px 10px 1px rgba(0,0,0,.14),0 3px 14px 3px rgba(0,0,0,.12),0 4px 5px 0 rgba(0,0,0,.2);box-shadow:0 8px 10px 1px rgba(0,0,0,.14),0 3px 14px 3px rgba(0,0,0,.12),0 4px 5px 0 rgba(0,0,0,.2)}.x-spreadsheet-calendar{color:rgba(0,0,0,.65);background:#fff;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.x-spreadsheet-calendar .calendar-header{font-weight:700;line-height:30px;text-align:center;width:100%;float:left;background:#f9fafb}.x-spreadsheet-calendar .calendar-header .calendar-header-left{padding-left:5px;float:left}.x-spreadsheet-calendar .calendar-header .calendar-header-right{float:right}.x-spreadsheet-calendar .calendar-header .calendar-header-right a{padding:3px 0;margin-right:2px;border-radius:2px}.x-spreadsheet-calendar .calendar-header .calendar-header-right a:hover{background:rgba(0,0,0,.08)}.x-spreadsheet-calendar .calendar-body{border-collapse:collapse;border-spacing:0}.x-spreadsheet-calendar .calendar-body td,.x-spreadsheet-calendar .calendar-body th{width:100%/7;min-width:32px;text-align:center;font-weight:700;line-height:30px;padding:0}.x-spreadsheet-calendar .calendar-body td>.cell:hover{background:#ecf6fd}.x-spreadsheet-calendar .calendar-body td>.cell.active,.x-spreadsheet-calendar .calendar-body td>.cell.active:hover{background:#ecf6fd;color:#2185d0}.x-spreadsheet-calendar .calendar-body td>.cell.disabled{pointer-events:none;opacity:.5}.x-spreadsheet-datepicker{-webkit-box-shadow:2px 2px 5px rgba(0,0,0,.2);box-shadow:2px 2px 5px rgba(0,0,0,.2);position:absolute;left:0;top:calc(100% + 5px);z-index:10;width:auto}.x-spreadsheet-buttons{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end}.x-spreadsheet-buttons .x-spreadsheet-button{margin-left:8px}.x-spreadsheet-button{display:inline-block;border-radius:3px;line-height:1em;min-height:1em;white-space:nowrap;text-align:center;cursor:pointer;font-size:1em;font-weight:700;padding:.75em 1em;color:rgba(0,0,0,.6);background:#e0e1e2;text-decoration:none;font-family:Lato,proxima-nova,Helvetica Neue,Arial,sans-serif;outline:none;vertical-align:baseline;zoom:1;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-transition:all .1s linear;transition:all .1s linear}.x-spreadsheet-button.active,.x-spreadsheet-button:hover{background-color:#c0c1c2;color:rgba(0,0,0,.8)}.x-spreadsheet-button.primary{color:#fff;background-color:#2185d0}.x-spreadsheet-button.primary.active,.x-spreadsheet-button.primary:hover{color:#fff;background-color:#1678c2}.x-spreadsheet-form-input{font-size:1em;position:relative;font-weight:400;display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;color:rgba(0,0,0,.87)}.x-spreadsheet-form-input input{z-index:1;margin:0;max-width:100%;-webkit-box-flex:1;-ms-flex:1 0 auto;flex:1 0 auto;outline:0;-webkit-tap-highlight-color:rgba(255,255,255,0);text-align:left;line-height:30px;height:30px;padding:0 8px;background:#fff;border:1px solid #e9e9e9;border-radius:3px;-webkit-transition:border-color .1s ease,-webkit-box-shadow .1s ease;transition:border-color .1s ease,-webkit-box-shadow .1s ease;transition:box-shadow .1s ease,border-color .1s ease;transition:box-shadow .1s ease,border-color .1s ease,-webkit-box-shadow .1s ease;-webkit-box-shadow:inset 0 1px 2px rgba(10,10,10,.06);box-shadow:inset 0 1px 2px rgba(10,10,10,.06)}.x-spreadsheet-form-input input:focus{border-color:#4b89ff;-webkit-box-shadow:inset 0 1px 2px rgba(75,137,255,.2);box-shadow:inset 0 1px 2px rgba(75,137,255,.2)}.x-spreadsheet-form-select{position:relative;display:inline-block;background:#fff;border:1px solid #e9e9e9;border-radius:2px;cursor:pointer;color:rgba(0,0,0,.87);-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-box-shadow:inset 0 1px 2px rgba(10,10,10,.06);box-shadow:inset 0 1px 2px rgba(10,10,10,.06)}.x-spreadsheet-form-select .input-text{text-overflow:ellipsis;white-space:nowrap;min-width:60px;width:auto;height:30px;line-height:30px;padding:0 8px}.x-spreadsheet-form-fields{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-ms-flex-wrap:wrap;flex-wrap:wrap}.x-spreadsheet-form-fields .x-spreadsheet-form-field{-webkit-box-flex:0;-ms-flex:0 1 auto;flex:0 1 auto}.x-spreadsheet-form-fields .x-spreadsheet-form-field .label{display:inline-block;margin:0 10px 0 0}.x-spreadsheet-form-field{display:block;vertical-align:middle;margin-left:10px;margin-bottom:10px}.x-spreadsheet-form-field:first-child{margin-left:0}.x-spreadsheet-form-field.error .x-spreadsheet-form-select,.x-spreadsheet-form-field.error input{border-color:#f04134}.x-spreadsheet-form-field .tip{color:#f04134;font-size:.9em}.x-spreadsheet-dimmer{display:none;position:fixed;top:0!important;left:0!important;width:100%;height:100%;text-align:center;vertical-align:middle;background-color:rgba(0,0,0,.6);opacity:0;-webkit-animation-fill-mode:both;animation-fill-mode:both;-webkit-animation-duration:.5s;animation-duration:.5s;-webkit-transition:background-color .5s linear;transition:background-color .5s linear;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;z-index:1001}.x-spreadsheet-dimmer.active{display:block;opacity:1}form fieldset{border:none}form fieldset label{display:block;margin-bottom:.5em;font-size:1em;color:#666}form fieldset select{font-size:1.1em;width:100%;background-color:#fff;border:none;border-bottom:2px solid #ddd;padding:.5em .85em;border-radius:2px}.x-spreadsheet-modal,.x-spreadsheet-toast{font-size:13px;position:fixed;z-index:1002;text-align:left;line-height:1.25em;min-width:360px;color:rgba(0,0,0,.87);font-family:Lato,Source Sans Pro,Roboto,Helvetica,Arial,sans-serif;border-radius:4px;border:1px solid rgba(0,0,0,.1);background-color:#fff;background-clip:padding-box;-webkit-box-shadow:rgba(0,0,0,.2) 0 2px 8px;box-shadow:0 2px 8px rgba(0,0,0,.2)}.x-spreadsheet-toast{background-color:hsla(0,0%,100%,.85)}.x-spreadsheet-modal-header,.x-spreadsheet-toast-header{font-weight:600;background-clip:padding-box;background-color:hsla(0,0%,100%,.85);border-bottom:1px solid rgba(0,0,0,.05);border-radius:4px 4px 0 0}.x-spreadsheet-modal-header .x-spreadsheet-icon,.x-spreadsheet-toast-header .x-spreadsheet-icon{position:absolute;right:.8em;top:.65em;border-radius:18px}.x-spreadsheet-modal-header .x-spreadsheet-icon:hover,.x-spreadsheet-toast-header .x-spreadsheet-icon:hover{opacity:1;background:rgba(0,0,0,.08)}.x-spreadsheet-toast-header{color:#f2711c}.x-spreadsheet-modal-header{border-bottom:1px solid #e0e2e4;background:rgba(0,0,0,.08);font-size:1.0785em}.x-spreadsheet-modal-content,.x-spreadsheet-modal-header,.x-spreadsheet-toast-content,.x-spreadsheet-toast-header{padding:.75em 1em}@media screen and (min-width:320px) and (max-width:480px){.x-spreadsheet-toolbar{display:none}}.x-spreadsheet-icon{width:18px;height:18px;margin:1px 1px 2px 1px;text-align:center;vertical-align:middle;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;overflow:hidden;position:relative;display:inline-block;line-height:0}.x-spreadsheet-icon.iconfont{line-height:18px;color:#666}.x-spreadsheet-icon .x-spreadsheet-icon-img{background-image:url(" + ___CSS_LOADER_URL_REPLACEMENT_0___ + ");position:absolute;width:262px;height:444px;opacity:.56}.x-spreadsheet-icon .x-spreadsheet-icon-img.undo{left:0;top:0}.x-spreadsheet-icon .x-spreadsheet-icon-img.redo{left:-18px;top:0}.x-spreadsheet-icon .x-spreadsheet-icon-img.print{left:-36px;top:0}.x-spreadsheet-icon .x-spreadsheet-icon-img.paintformat{left:-54px;top:0}.x-spreadsheet-icon .x-spreadsheet-icon-img.clearformat{left:-72px;top:0}.x-spreadsheet-icon .x-spreadsheet-icon-img.font-bold{left:-90px;top:0}.x-spreadsheet-icon .x-spreadsheet-icon-img.font-italic{left:-108px;top:0}.x-spreadsheet-icon .x-spreadsheet-icon-img.underline{left:-126px;top:0}.x-spreadsheet-icon .x-spreadsheet-icon-img.strike{left:-144px;top:0}.x-spreadsheet-icon .x-spreadsheet-icon-img.color{left:-162px;top:0}.x-spreadsheet-icon .x-spreadsheet-icon-img.bgcolor{left:-180px;top:0}.x-spreadsheet-icon .x-spreadsheet-icon-img.merge{left:-198px;top:0}.x-spreadsheet-icon .x-spreadsheet-icon-img.indent-dec{left:-126px;top:-54px}.x-spreadsheet-icon .x-spreadsheet-icon-img.indent-add{left:-144px;top:-54px}.x-spreadsheet-icon .x-spreadsheet-icon-img.align-left{left:-216px;top:0}.x-spreadsheet-icon .x-spreadsheet-icon-img.align-center{left:-234px;top:0}.x-spreadsheet-icon .x-spreadsheet-icon-img.align-dist{left:-108px;top:-54px}.x-spreadsheet-icon .x-spreadsheet-icon-img.align-right{left:0;top:-18px}.x-spreadsheet-icon .x-spreadsheet-icon-img.align-top{left:-18px;top:-18px}.x-spreadsheet-icon .x-spreadsheet-icon-img.align-middle{left:-36px;top:-18px}.x-spreadsheet-icon .x-spreadsheet-icon-img.align-bottom{left:-54px;top:-18px}.x-spreadsheet-icon .x-spreadsheet-icon-img.textwrap{left:-72px;top:-18px}.x-spreadsheet-icon .x-spreadsheet-icon-img.autofilter{left:-90px;top:-18px}.x-spreadsheet-icon .x-spreadsheet-icon-img.formula{left:-108px;top:-18px}.x-spreadsheet-icon .x-spreadsheet-icon-img.arrow-down{left:-126px;top:-18px}.x-spreadsheet-icon .x-spreadsheet-icon-img.arrow-right{left:-144px;top:-18px}.x-spreadsheet-icon .x-spreadsheet-icon-img.link{left:-162px;top:-18px}.x-spreadsheet-icon .x-spreadsheet-icon-img.chart{left:-180px;top:-18px}.x-spreadsheet-icon .x-spreadsheet-icon-img.freeze{left:-198px;top:-18px}.x-spreadsheet-icon .x-spreadsheet-icon-img.ellipsis{left:-216px;top:-18px}.x-spreadsheet-icon .x-spreadsheet-icon-img.add{left:-234px;top:-18px}.x-spreadsheet-icon .x-spreadsheet-icon-img.border-all{left:0;top:-36px}.x-spreadsheet-icon .x-spreadsheet-icon-img.border-inside{left:-18px;top:-36px}.x-spreadsheet-icon .x-spreadsheet-icon-img.border-horizontal{left:-36px;top:-36px}.x-spreadsheet-icon .x-spreadsheet-icon-img.border-vertical{left:-54px;top:-36px}.x-spreadsheet-icon .x-spreadsheet-icon-img.border-outside{left:-72px;top:-36px}.x-spreadsheet-icon .x-spreadsheet-icon-img.border-left{left:-90px;top:-36px}.x-spreadsheet-icon .x-spreadsheet-icon-img.border-top{left:-108px;top:-36px}.x-spreadsheet-icon .x-spreadsheet-icon-img.border-right{left:-126px;top:-36px}.x-spreadsheet-icon .x-spreadsheet-icon-img.border-bottom{left:-144px;top:-36px}.x-spreadsheet-icon .x-spreadsheet-icon-img.border-none{left:-162px;top:-36px}.x-spreadsheet-icon .x-spreadsheet-icon-img.line-color{left:-180px;top:-36px}.x-spreadsheet-icon .x-spreadsheet-icon-img.line-type{left:-198px;top:-36px}.x-spreadsheet-icon .x-spreadsheet-icon-img.close{left:-234px;top:-36px}.x-spreadsheet-icon .x-spreadsheet-icon-img.chevron-down{left:0;top:-54px}.x-spreadsheet-icon .x-spreadsheet-icon-img.chevron-up{left:-18px;top:-54px}.x-spreadsheet-icon .x-spreadsheet-icon-img.chevron-left{left:-36px;top:-54px}.x-spreadsheet-icon .x-spreadsheet-icon-img.chevron-right{left:-54px;top:-54px}.x-spreadsheet-icon .x-spreadsheet-icon-img.import{left:0;top:0}.x-spreadsheet-icon .x-spreadsheet-icon-img.export{left:-18px;top:0}.x-spreadsheet-input-file{position:absolute;opacity:0;width:25px;height:25px;margin-left:-24px}.x-spreadsheet-comment-container{border:1px solid rgba(0,0,0,.3);position:absolute;border-radius:4px;min-height:120px;padding:8px;width:150px;z-index:999;background:#fff1d6}.x-spreadsheet-comment-container .x-spreadsheet-comment-text{line-height:1.5;height:100%;white-space:normal;word-break:break-all;word-wrap:break-word}.x-spreadsheet-comment-container .x-spreadsheet-comment-container__arrow{height:6px;width:6px;background-color:#fff;position:absolute}.x-spreadsheet-comment-container .x-spreadsheet-comment-container__arrow--lc{left:0;top:8px;border-bottom:1px solid rgba(0,0,0,.3);border-left:1px solid rgba(0,0,0,.3);-webkit-transform:translate(-50%,-50%) rotate(45deg);transform:translate(-50%,-50%) rotate(45deg);background:#fff1d6}", ""]);
// Exports
module.exports = exports;


/***/ }),

/***/ "77a7":
/***/ (function(module, exports, __webpack_require__) {

// IEEE754 conversions based on https://github.com/feross/ieee754
var global = __webpack_require__("da84");

var Array = global.Array;
var abs = Math.abs;
var pow = Math.pow;
var floor = Math.floor;
var log = Math.log;
var LN2 = Math.LN2;

var pack = function (number, mantissaLength, bytes) {
  var buffer = Array(bytes);
  var exponentLength = bytes * 8 - mantissaLength - 1;
  var eMax = (1 << exponentLength) - 1;
  var eBias = eMax >> 1;
  var rt = mantissaLength === 23 ? pow(2, -24) - pow(2, -77) : 0;
  var sign = number < 0 || number === 0 && 1 / number < 0 ? 1 : 0;
  var index = 0;
  var exponent, mantissa, c;
  number = abs(number);
  // eslint-disable-next-line no-self-compare -- NaN check
  if (number != number || number === Infinity) {
    // eslint-disable-next-line no-self-compare -- NaN check
    mantissa = number != number ? 1 : 0;
    exponent = eMax;
  } else {
    exponent = floor(log(number) / LN2);
    if (number * (c = pow(2, -exponent)) < 1) {
      exponent--;
      c *= 2;
    }
    if (exponent + eBias >= 1) {
      number += rt / c;
    } else {
      number += rt * pow(2, 1 - eBias);
    }
    if (number * c >= 2) {
      exponent++;
      c /= 2;
    }
    if (exponent + eBias >= eMax) {
      mantissa = 0;
      exponent = eMax;
    } else if (exponent + eBias >= 1) {
      mantissa = (number * c - 1) * pow(2, mantissaLength);
      exponent = exponent + eBias;
    } else {
      mantissa = number * pow(2, eBias - 1) * pow(2, mantissaLength);
      exponent = 0;
    }
  }
  for (; mantissaLength >= 8; buffer[index++] = mantissa & 255, mantissa /= 256, mantissaLength -= 8);
  exponent = exponent << mantissaLength | mantissa;
  exponentLength += mantissaLength;
  for (; exponentLength > 0; buffer[index++] = exponent & 255, exponent /= 256, exponentLength -= 8);
  buffer[--index] |= sign * 128;
  return buffer;
};

var unpack = function (buffer, mantissaLength) {
  var bytes = buffer.length;
  var exponentLength = bytes * 8 - mantissaLength - 1;
  var eMax = (1 << exponentLength) - 1;
  var eBias = eMax >> 1;
  var nBits = exponentLength - 7;
  var index = bytes - 1;
  var sign = buffer[index--];
  var exponent = sign & 127;
  var mantissa;
  sign >>= 7;
  for (; nBits > 0; exponent = exponent * 256 + buffer[index], index--, nBits -= 8);
  mantissa = exponent & (1 << -nBits) - 1;
  exponent >>= -nBits;
  nBits += mantissaLength;
  for (; nBits > 0; mantissa = mantissa * 256 + buffer[index], index--, nBits -= 8);
  if (exponent === 0) {
    exponent = 1 - eBias;
  } else if (exponent === eMax) {
    return mantissa ? NaN : sign ? -Infinity : Infinity;
  } else {
    mantissa = mantissa + pow(2, mantissaLength);
    exponent = exponent - eBias;
  } return (sign ? -1 : 1) * mantissa * pow(2, exponent - mantissaLength);
};

module.exports = {
  pack: pack,
  unpack: unpack
};


/***/ }),

/***/ "7839":
/***/ (function(module, exports) {

// IE8- don't enum bug keys
module.exports = [
  'constructor',
  'hasOwnProperty',
  'isPrototypeOf',
  'propertyIsEnumerable',
  'toLocaleString',
  'toString',
  'valueOf'
];


/***/ }),

/***/ "785a":
/***/ (function(module, exports, __webpack_require__) {

// in old WebKit versions, `element.classList` is not an instance of global `DOMTokenList`
var documentCreateElement = __webpack_require__("cc12");

var classList = documentCreateElement('span').classList;
var DOMTokenListPrototype = classList && classList.constructor && classList.constructor.prototype;

module.exports = DOMTokenListPrototype === Object.prototype ? undefined : DOMTokenListPrototype;


/***/ }),

/***/ "7936":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var _node_modules_vue_style_loader_index_js_ref_9_oneOf_1_0_node_modules_css_loader_dist_cjs_js_ref_9_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_9_oneOf_1_2_node_modules_postcss_loader_src_index_js_ref_9_oneOf_1_3_node_modules_sass_loader_dist_cjs_js_ref_9_oneOf_1_4_node_modules_cache_loader_dist_cjs_js_ref_1_0_node_modules_vue_loader_lib_index_js_vue_loader_options_index_vue_vue_type_style_index_0_lang_scss___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("622e");
/* harmony import */ var _node_modules_vue_style_loader_index_js_ref_9_oneOf_1_0_node_modules_css_loader_dist_cjs_js_ref_9_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_9_oneOf_1_2_node_modules_postcss_loader_src_index_js_ref_9_oneOf_1_3_node_modules_sass_loader_dist_cjs_js_ref_9_oneOf_1_4_node_modules_cache_loader_dist_cjs_js_ref_1_0_node_modules_vue_loader_lib_index_js_vue_loader_options_index_vue_vue_type_style_index_0_lang_scss___WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_node_modules_vue_style_loader_index_js_ref_9_oneOf_1_0_node_modules_css_loader_dist_cjs_js_ref_9_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_9_oneOf_1_2_node_modules_postcss_loader_src_index_js_ref_9_oneOf_1_3_node_modules_sass_loader_dist_cjs_js_ref_9_oneOf_1_4_node_modules_cache_loader_dist_cjs_js_ref_1_0_node_modules_vue_loader_lib_index_js_vue_loader_options_index_vue_vue_type_style_index_0_lang_scss___WEBPACK_IMPORTED_MODULE_0__);
/* unused harmony reexport * */


/***/ }),

/***/ "7943":
/***/ (function(module, exports, __webpack_require__) {

// Imports
var ___CSS_LOADER_API_IMPORT___ = __webpack_require__("24fb");
exports = ___CSS_LOADER_API_IMPORT___(false);
// Module
exports.push([module.i, ".el-dialog__setCellSize{pointer-events:none}.el-dialog__setCellSize .el-dialog{pointer-events:auto}.el-dialog__setCellSize .el-dialog .el-form .el-input{width:100%;min-width:100%}", ""]);
// Exports
module.exports = exports;


/***/ }),

/***/ "7b0b":
/***/ (function(module, exports, __webpack_require__) {

var global = __webpack_require__("da84");
var requireObjectCoercible = __webpack_require__("1d80");

var Object = global.Object;

// `ToObject` abstract operation
// https://tc39.es/ecma262/#sec-toobject
module.exports = function (argument) {
  return Object(requireObjectCoercible(argument));
};


/***/ }),

/***/ "7c73":
/***/ (function(module, exports, __webpack_require__) {

/* global ActiveXObject -- old IE, WSH */
var anObject = __webpack_require__("825a");
var defineProperties = __webpack_require__("37e8");
var enumBugKeys = __webpack_require__("7839");
var hiddenKeys = __webpack_require__("d012");
var html = __webpack_require__("1be4");
var documentCreateElement = __webpack_require__("cc12");
var sharedKey = __webpack_require__("f772");

var GT = '>';
var LT = '<';
var PROTOTYPE = 'prototype';
var SCRIPT = 'script';
var IE_PROTO = sharedKey('IE_PROTO');

var EmptyConstructor = function () { /* empty */ };

var scriptTag = function (content) {
  return LT + SCRIPT + GT + content + LT + '/' + SCRIPT + GT;
};

// Create object with fake `null` prototype: use ActiveX Object with cleared prototype
var NullProtoObjectViaActiveX = function (activeXDocument) {
  activeXDocument.write(scriptTag(''));
  activeXDocument.close();
  var temp = activeXDocument.parentWindow.Object;
  activeXDocument = null; // avoid memory leak
  return temp;
};

// Create object with fake `null` prototype: use iframe Object with cleared prototype
var NullProtoObjectViaIFrame = function () {
  // Thrash, waste and sodomy: IE GC bug
  var iframe = documentCreateElement('iframe');
  var JS = 'java' + SCRIPT + ':';
  var iframeDocument;
  iframe.style.display = 'none';
  html.appendChild(iframe);
  // https://github.com/zloirock/core-js/issues/475
  iframe.src = String(JS);
  iframeDocument = iframe.contentWindow.document;
  iframeDocument.open();
  iframeDocument.write(scriptTag('document.F=Object'));
  iframeDocument.close();
  return iframeDocument.F;
};

// Check for document.domain and active x support
// No need to use active x approach when document.domain is not set
// see https://github.com/es-shims/es5-shim/issues/150
// variation of https://github.com/kitcambridge/es5-shim/commit/4f738ac066346
// avoid IE GC bug
var activeXDocument;
var NullProtoObject = function () {
  try {
    activeXDocument = new ActiveXObject('htmlfile');
  } catch (error) { /* ignore */ }
  NullProtoObject = typeof document != 'undefined'
    ? document.domain && activeXDocument
      ? NullProtoObjectViaActiveX(activeXDocument) // old IE
      : NullProtoObjectViaIFrame()
    : NullProtoObjectViaActiveX(activeXDocument); // WSH
  var length = enumBugKeys.length;
  while (length--) delete NullProtoObject[PROTOTYPE][enumBugKeys[length]];
  return NullProtoObject();
};

hiddenKeys[IE_PROTO] = true;

// `Object.create` method
// https://tc39.es/ecma262/#sec-object.create
module.exports = Object.create || function create(O, Properties) {
  var result;
  if (O !== null) {
    EmptyConstructor[PROTOTYPE] = anObject(O);
    result = new EmptyConstructor();
    EmptyConstructor[PROTOTYPE] = null;
    // add "__proto__" for Object.getPrototypeOf polyfill
    result[IE_PROTO] = O;
  } else result = NullProtoObject();
  return Properties === undefined ? result : defineProperties(result, Properties);
};


/***/ }),

/***/ "7db0":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var $ = __webpack_require__("23e7");
var $find = __webpack_require__("b727").find;
var addToUnscopables = __webpack_require__("44d2");

var FIND = 'find';
var SKIPS_HOLES = true;

// Shouldn't skip holes
if (FIND in []) Array(1)[FIND](function () { SKIPS_HOLES = false; });

// `Array.prototype.find` method
// https://tc39.es/ecma262/#sec-array.prototype.find
$({ target: 'Array', proto: true, forced: SKIPS_HOLES }, {
  find: function find(callbackfn /* , that = undefined */) {
    return $find(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);
  }
});

// https://tc39.es/ecma262/#sec-array.prototype-@@unscopables
addToUnscopables(FIND);


/***/ }),

/***/ "7dd0":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var $ = __webpack_require__("23e7");
var call = __webpack_require__("c65b");
var IS_PURE = __webpack_require__("c430");
var FunctionName = __webpack_require__("5e77");
var isCallable = __webpack_require__("1626");
var createIteratorConstructor = __webpack_require__("9ed3");
var getPrototypeOf = __webpack_require__("e163");
var setPrototypeOf = __webpack_require__("d2bb");
var setToStringTag = __webpack_require__("d44e");
var createNonEnumerableProperty = __webpack_require__("9112");
var redefine = __webpack_require__("6eeb");
var wellKnownSymbol = __webpack_require__("b622");
var Iterators = __webpack_require__("3f8c");
var IteratorsCore = __webpack_require__("ae93");

var PROPER_FUNCTION_NAME = FunctionName.PROPER;
var CONFIGURABLE_FUNCTION_NAME = FunctionName.CONFIGURABLE;
var IteratorPrototype = IteratorsCore.IteratorPrototype;
var BUGGY_SAFARI_ITERATORS = IteratorsCore.BUGGY_SAFARI_ITERATORS;
var ITERATOR = wellKnownSymbol('iterator');
var KEYS = 'keys';
var VALUES = 'values';
var ENTRIES = 'entries';

var returnThis = function () { return this; };

module.exports = function (Iterable, NAME, IteratorConstructor, next, DEFAULT, IS_SET, FORCED) {
  createIteratorConstructor(IteratorConstructor, NAME, next);

  var getIterationMethod = function (KIND) {
    if (KIND === DEFAULT && defaultIterator) return defaultIterator;
    if (!BUGGY_SAFARI_ITERATORS && KIND in IterablePrototype) return IterablePrototype[KIND];
    switch (KIND) {
      case KEYS: return function keys() { return new IteratorConstructor(this, KIND); };
      case VALUES: return function values() { return new IteratorConstructor(this, KIND); };
      case ENTRIES: return function entries() { return new IteratorConstructor(this, KIND); };
    } return function () { return new IteratorConstructor(this); };
  };

  var TO_STRING_TAG = NAME + ' Iterator';
  var INCORRECT_VALUES_NAME = false;
  var IterablePrototype = Iterable.prototype;
  var nativeIterator = IterablePrototype[ITERATOR]
    || IterablePrototype['@@iterator']
    || DEFAULT && IterablePrototype[DEFAULT];
  var defaultIterator = !BUGGY_SAFARI_ITERATORS && nativeIterator || getIterationMethod(DEFAULT);
  var anyNativeIterator = NAME == 'Array' ? IterablePrototype.entries || nativeIterator : nativeIterator;
  var CurrentIteratorPrototype, methods, KEY;

  // fix native
  if (anyNativeIterator) {
    CurrentIteratorPrototype = getPrototypeOf(anyNativeIterator.call(new Iterable()));
    if (CurrentIteratorPrototype !== Object.prototype && CurrentIteratorPrototype.next) {
      if (!IS_PURE && getPrototypeOf(CurrentIteratorPrototype) !== IteratorPrototype) {
        if (setPrototypeOf) {
          setPrototypeOf(CurrentIteratorPrototype, IteratorPrototype);
        } else if (!isCallable(CurrentIteratorPrototype[ITERATOR])) {
          redefine(CurrentIteratorPrototype, ITERATOR, returnThis);
        }
      }
      // Set @@toStringTag to native iterators
      setToStringTag(CurrentIteratorPrototype, TO_STRING_TAG, true, true);
      if (IS_PURE) Iterators[TO_STRING_TAG] = returnThis;
    }
  }

  // fix Array.prototype.{ values, @@iterator }.name in V8 / FF
  if (PROPER_FUNCTION_NAME && DEFAULT == VALUES && nativeIterator && nativeIterator.name !== VALUES) {
    if (!IS_PURE && CONFIGURABLE_FUNCTION_NAME) {
      createNonEnumerableProperty(IterablePrototype, 'name', VALUES);
    } else {
      INCORRECT_VALUES_NAME = true;
      defaultIterator = function values() { return call(nativeIterator, this); };
    }
  }

  // export additional methods
  if (DEFAULT) {
    methods = {
      values: getIterationMethod(VALUES),
      keys: IS_SET ? defaultIterator : getIterationMethod(KEYS),
      entries: getIterationMethod(ENTRIES)
    };
    if (FORCED) for (KEY in methods) {
      if (BUGGY_SAFARI_ITERATORS || INCORRECT_VALUES_NAME || !(KEY in IterablePrototype)) {
        redefine(IterablePrototype, KEY, methods[KEY]);
      }
    } else $({ target: NAME, proto: true, forced: BUGGY_SAFARI_ITERATORS || INCORRECT_VALUES_NAME }, methods);
  }

  // define iterator
  if ((!IS_PURE || FORCED) && IterablePrototype[ITERATOR] !== defaultIterator) {
    redefine(IterablePrototype, ITERATOR, defaultIterator, { name: DEFAULT });
  }
  Iterators[NAME] = defaultIterator;

  return methods;
};


/***/ }),

/***/ "7f9a":
/***/ (function(module, exports, __webpack_require__) {

var global = __webpack_require__("da84");
var isCallable = __webpack_require__("1626");
var inspectSource = __webpack_require__("8925");

var WeakMap = global.WeakMap;

module.exports = isCallable(WeakMap) && /native code/.test(inspectSource(WeakMap));


/***/ }),

/***/ "81d5":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var toObject = __webpack_require__("7b0b");
var toAbsoluteIndex = __webpack_require__("23cb");
var lengthOfArrayLike = __webpack_require__("07fa");

// `Array.prototype.fill` method implementation
// https://tc39.es/ecma262/#sec-array.prototype.fill
module.exports = function fill(value /* , start = 0, end = @length */) {
  var O = toObject(this);
  var length = lengthOfArrayLike(O);
  var argumentsLength = arguments.length;
  var index = toAbsoluteIndex(argumentsLength > 1 ? arguments[1] : undefined, length);
  var end = argumentsLength > 2 ? arguments[2] : undefined;
  var endPos = end === undefined ? length : toAbsoluteIndex(end, length);
  while (endPos > index) O[index++] = value;
  return O;
};


/***/ }),

/***/ "8237":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(process, global) {var __WEBPACK_AMD_DEFINE_RESULT__;/**
 * [js-md5]{@link https://github.com/emn178/js-md5}
 *
 * @namespace md5
 * @version 0.7.3
 * @author Chen, Yi-Cyuan [emn178@gmail.com]
 * @copyright Chen, Yi-Cyuan 2014-2017
 * @license MIT
 */
(function () {
  'use strict';

  var ERROR = 'input is invalid type';
  var WINDOW = typeof window === 'object';
  var root = WINDOW ? window : {};
  if (root.JS_MD5_NO_WINDOW) {
    WINDOW = false;
  }
  var WEB_WORKER = !WINDOW && typeof self === 'object';
  var NODE_JS = !root.JS_MD5_NO_NODE_JS && typeof process === 'object' && process.versions && process.versions.node;
  if (NODE_JS) {
    root = global;
  } else if (WEB_WORKER) {
    root = self;
  }
  var COMMON_JS = !root.JS_MD5_NO_COMMON_JS && typeof module === 'object' && module.exports;
  var AMD =  true && __webpack_require__("3c35");
  var ARRAY_BUFFER = !root.JS_MD5_NO_ARRAY_BUFFER && typeof ArrayBuffer !== 'undefined';
  var HEX_CHARS = '0123456789abcdef'.split('');
  var EXTRA = [128, 32768, 8388608, -2147483648];
  var SHIFT = [0, 8, 16, 24];
  var OUTPUT_TYPES = ['hex', 'array', 'digest', 'buffer', 'arrayBuffer', 'base64'];
  var BASE64_ENCODE_CHAR = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'.split('');

  var blocks = [], buffer8;
  if (ARRAY_BUFFER) {
    var buffer = new ArrayBuffer(68);
    buffer8 = new Uint8Array(buffer);
    blocks = new Uint32Array(buffer);
  }

  if (root.JS_MD5_NO_NODE_JS || !Array.isArray) {
    Array.isArray = function (obj) {
      return Object.prototype.toString.call(obj) === '[object Array]';
    };
  }

  if (ARRAY_BUFFER && (root.JS_MD5_NO_ARRAY_BUFFER_IS_VIEW || !ArrayBuffer.isView)) {
    ArrayBuffer.isView = function (obj) {
      return typeof obj === 'object' && obj.buffer && obj.buffer.constructor === ArrayBuffer;
    };
  }

  /**
   * @method hex
   * @memberof md5
   * @description Output hash as hex string
   * @param {String|Array|Uint8Array|ArrayBuffer} message message to hash
   * @returns {String} Hex string
   * @example
   * md5.hex('The quick brown fox jumps over the lazy dog');
   * // equal to
   * md5('The quick brown fox jumps over the lazy dog');
   */
  /**
   * @method digest
   * @memberof md5
   * @description Output hash as bytes array
   * @param {String|Array|Uint8Array|ArrayBuffer} message message to hash
   * @returns {Array} Bytes array
   * @example
   * md5.digest('The quick brown fox jumps over the lazy dog');
   */
  /**
   * @method array
   * @memberof md5
   * @description Output hash as bytes array
   * @param {String|Array|Uint8Array|ArrayBuffer} message message to hash
   * @returns {Array} Bytes array
   * @example
   * md5.array('The quick brown fox jumps over the lazy dog');
   */
  /**
   * @method arrayBuffer
   * @memberof md5
   * @description Output hash as ArrayBuffer
   * @param {String|Array|Uint8Array|ArrayBuffer} message message to hash
   * @returns {ArrayBuffer} ArrayBuffer
   * @example
   * md5.arrayBuffer('The quick brown fox jumps over the lazy dog');
   */
  /**
   * @method buffer
   * @deprecated This maybe confuse with Buffer in node.js. Please use arrayBuffer instead.
   * @memberof md5
   * @description Output hash as ArrayBuffer
   * @param {String|Array|Uint8Array|ArrayBuffer} message message to hash
   * @returns {ArrayBuffer} ArrayBuffer
   * @example
   * md5.buffer('The quick brown fox jumps over the lazy dog');
   */
  /**
   * @method base64
   * @memberof md5
   * @description Output hash as base64 string
   * @param {String|Array|Uint8Array|ArrayBuffer} message message to hash
   * @returns {String} base64 string
   * @example
   * md5.base64('The quick brown fox jumps over the lazy dog');
   */
  var createOutputMethod = function (outputType) {
    return function (message) {
      return new Md5(true).update(message)[outputType]();
    };
  };

  /**
   * @method create
   * @memberof md5
   * @description Create Md5 object
   * @returns {Md5} Md5 object.
   * @example
   * var hash = md5.create();
   */
  /**
   * @method update
   * @memberof md5
   * @description Create and update Md5 object
   * @param {String|Array|Uint8Array|ArrayBuffer} message message to hash
   * @returns {Md5} Md5 object.
   * @example
   * var hash = md5.update('The quick brown fox jumps over the lazy dog');
   * // equal to
   * var hash = md5.create();
   * hash.update('The quick brown fox jumps over the lazy dog');
   */
  var createMethod = function () {
    var method = createOutputMethod('hex');
    if (NODE_JS) {
      method = nodeWrap(method);
    }
    method.create = function () {
      return new Md5();
    };
    method.update = function (message) {
      return method.create().update(message);
    };
    for (var i = 0; i < OUTPUT_TYPES.length; ++i) {
      var type = OUTPUT_TYPES[i];
      method[type] = createOutputMethod(type);
    }
    return method;
  };

  var nodeWrap = function (method) {
    var crypto = eval("require('crypto')");
    var Buffer = eval("require('buffer').Buffer");
    var nodeMethod = function (message) {
      if (typeof message === 'string') {
        return crypto.createHash('md5').update(message, 'utf8').digest('hex');
      } else {
        if (message === null || message === undefined) {
          throw ERROR;
        } else if (message.constructor === ArrayBuffer) {
          message = new Uint8Array(message);
        }
      }
      if (Array.isArray(message) || ArrayBuffer.isView(message) ||
        message.constructor === Buffer) {
        return crypto.createHash('md5').update(new Buffer(message)).digest('hex');
      } else {
        return method(message);
      }
    };
    return nodeMethod;
  };

  /**
   * Md5 class
   * @class Md5
   * @description This is internal class.
   * @see {@link md5.create}
   */
  function Md5(sharedMemory) {
    if (sharedMemory) {
      blocks[0] = blocks[16] = blocks[1] = blocks[2] = blocks[3] =
      blocks[4] = blocks[5] = blocks[6] = blocks[7] =
      blocks[8] = blocks[9] = blocks[10] = blocks[11] =
      blocks[12] = blocks[13] = blocks[14] = blocks[15] = 0;
      this.blocks = blocks;
      this.buffer8 = buffer8;
    } else {
      if (ARRAY_BUFFER) {
        var buffer = new ArrayBuffer(68);
        this.buffer8 = new Uint8Array(buffer);
        this.blocks = new Uint32Array(buffer);
      } else {
        this.blocks = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];
      }
    }
    this.h0 = this.h1 = this.h2 = this.h3 = this.start = this.bytes = this.hBytes = 0;
    this.finalized = this.hashed = false;
    this.first = true;
  }

  /**
   * @method update
   * @memberof Md5
   * @instance
   * @description Update hash
   * @param {String|Array|Uint8Array|ArrayBuffer} message message to hash
   * @returns {Md5} Md5 object.
   * @see {@link md5.update}
   */
  Md5.prototype.update = function (message) {
    if (this.finalized) {
      return;
    }

    var notString, type = typeof message;
    if (type !== 'string') {
      if (type === 'object') {
        if (message === null) {
          throw ERROR;
        } else if (ARRAY_BUFFER && message.constructor === ArrayBuffer) {
          message = new Uint8Array(message);
        } else if (!Array.isArray(message)) {
          if (!ARRAY_BUFFER || !ArrayBuffer.isView(message)) {
            throw ERROR;
          }
        }
      } else {
        throw ERROR;
      }
      notString = true;
    }
    var code, index = 0, i, length = message.length, blocks = this.blocks;
    var buffer8 = this.buffer8;

    while (index < length) {
      if (this.hashed) {
        this.hashed = false;
        blocks[0] = blocks[16];
        blocks[16] = blocks[1] = blocks[2] = blocks[3] =
        blocks[4] = blocks[5] = blocks[6] = blocks[7] =
        blocks[8] = blocks[9] = blocks[10] = blocks[11] =
        blocks[12] = blocks[13] = blocks[14] = blocks[15] = 0;
      }

      if (notString) {
        if (ARRAY_BUFFER) {
          for (i = this.start; index < length && i < 64; ++index) {
            buffer8[i++] = message[index];
          }
        } else {
          for (i = this.start; index < length && i < 64; ++index) {
            blocks[i >> 2] |= message[index] << SHIFT[i++ & 3];
          }
        }
      } else {
        if (ARRAY_BUFFER) {
          for (i = this.start; index < length && i < 64; ++index) {
            code = message.charCodeAt(index);
            if (code < 0x80) {
              buffer8[i++] = code;
            } else if (code < 0x800) {
              buffer8[i++] = 0xc0 | (code >> 6);
              buffer8[i++] = 0x80 | (code & 0x3f);
            } else if (code < 0xd800 || code >= 0xe000) {
              buffer8[i++] = 0xe0 | (code >> 12);
              buffer8[i++] = 0x80 | ((code >> 6) & 0x3f);
              buffer8[i++] = 0x80 | (code & 0x3f);
            } else {
              code = 0x10000 + (((code & 0x3ff) << 10) | (message.charCodeAt(++index) & 0x3ff));
              buffer8[i++] = 0xf0 | (code >> 18);
              buffer8[i++] = 0x80 | ((code >> 12) & 0x3f);
              buffer8[i++] = 0x80 | ((code >> 6) & 0x3f);
              buffer8[i++] = 0x80 | (code & 0x3f);
            }
          }
        } else {
          for (i = this.start; index < length && i < 64; ++index) {
            code = message.charCodeAt(index);
            if (code < 0x80) {
              blocks[i >> 2] |= code << SHIFT[i++ & 3];
            } else if (code < 0x800) {
              blocks[i >> 2] |= (0xc0 | (code >> 6)) << SHIFT[i++ & 3];
              blocks[i >> 2] |= (0x80 | (code & 0x3f)) << SHIFT[i++ & 3];
            } else if (code < 0xd800 || code >= 0xe000) {
              blocks[i >> 2] |= (0xe0 | (code >> 12)) << SHIFT[i++ & 3];
              blocks[i >> 2] |= (0x80 | ((code >> 6) & 0x3f)) << SHIFT[i++ & 3];
              blocks[i >> 2] |= (0x80 | (code & 0x3f)) << SHIFT[i++ & 3];
            } else {
              code = 0x10000 + (((code & 0x3ff) << 10) | (message.charCodeAt(++index) & 0x3ff));
              blocks[i >> 2] |= (0xf0 | (code >> 18)) << SHIFT[i++ & 3];
              blocks[i >> 2] |= (0x80 | ((code >> 12) & 0x3f)) << SHIFT[i++ & 3];
              blocks[i >> 2] |= (0x80 | ((code >> 6) & 0x3f)) << SHIFT[i++ & 3];
              blocks[i >> 2] |= (0x80 | (code & 0x3f)) << SHIFT[i++ & 3];
            }
          }
        }
      }
      this.lastByteIndex = i;
      this.bytes += i - this.start;
      if (i >= 64) {
        this.start = i - 64;
        this.hash();
        this.hashed = true;
      } else {
        this.start = i;
      }
    }
    if (this.bytes > 4294967295) {
      this.hBytes += this.bytes / 4294967296 << 0;
      this.bytes = this.bytes % 4294967296;
    }
    return this;
  };

  Md5.prototype.finalize = function () {
    if (this.finalized) {
      return;
    }
    this.finalized = true;
    var blocks = this.blocks, i = this.lastByteIndex;
    blocks[i >> 2] |= EXTRA[i & 3];
    if (i >= 56) {
      if (!this.hashed) {
        this.hash();
      }
      blocks[0] = blocks[16];
      blocks[16] = blocks[1] = blocks[2] = blocks[3] =
      blocks[4] = blocks[5] = blocks[6] = blocks[7] =
      blocks[8] = blocks[9] = blocks[10] = blocks[11] =
      blocks[12] = blocks[13] = blocks[14] = blocks[15] = 0;
    }
    blocks[14] = this.bytes << 3;
    blocks[15] = this.hBytes << 3 | this.bytes >>> 29;
    this.hash();
  };

  Md5.prototype.hash = function () {
    var a, b, c, d, bc, da, blocks = this.blocks;

    if (this.first) {
      a = blocks[0] - 680876937;
      a = (a << 7 | a >>> 25) - 271733879 << 0;
      d = (-1732584194 ^ a & 2004318071) + blocks[1] - 117830708;
      d = (d << 12 | d >>> 20) + a << 0;
      c = (-271733879 ^ (d & (a ^ -271733879))) + blocks[2] - 1126478375;
      c = (c << 17 | c >>> 15) + d << 0;
      b = (a ^ (c & (d ^ a))) + blocks[3] - 1316259209;
      b = (b << 22 | b >>> 10) + c << 0;
    } else {
      a = this.h0;
      b = this.h1;
      c = this.h2;
      d = this.h3;
      a += (d ^ (b & (c ^ d))) + blocks[0] - 680876936;
      a = (a << 7 | a >>> 25) + b << 0;
      d += (c ^ (a & (b ^ c))) + blocks[1] - 389564586;
      d = (d << 12 | d >>> 20) + a << 0;
      c += (b ^ (d & (a ^ b))) + blocks[2] + 606105819;
      c = (c << 17 | c >>> 15) + d << 0;
      b += (a ^ (c & (d ^ a))) + blocks[3] - 1044525330;
      b = (b << 22 | b >>> 10) + c << 0;
    }

    a += (d ^ (b & (c ^ d))) + blocks[4] - 176418897;
    a = (a << 7 | a >>> 25) + b << 0;
    d += (c ^ (a & (b ^ c))) + blocks[5] + 1200080426;
    d = (d << 12 | d >>> 20) + a << 0;
    c += (b ^ (d & (a ^ b))) + blocks[6] - 1473231341;
    c = (c << 17 | c >>> 15) + d << 0;
    b += (a ^ (c & (d ^ a))) + blocks[7] - 45705983;
    b = (b << 22 | b >>> 10) + c << 0;
    a += (d ^ (b & (c ^ d))) + blocks[8] + 1770035416;
    a = (a << 7 | a >>> 25) + b << 0;
    d += (c ^ (a & (b ^ c))) + blocks[9] - 1958414417;
    d = (d << 12 | d >>> 20) + a << 0;
    c += (b ^ (d & (a ^ b))) + blocks[10] - 42063;
    c = (c << 17 | c >>> 15) + d << 0;
    b += (a ^ (c & (d ^ a))) + blocks[11] - 1990404162;
    b = (b << 22 | b >>> 10) + c << 0;
    a += (d ^ (b & (c ^ d))) + blocks[12] + 1804603682;
    a = (a << 7 | a >>> 25) + b << 0;
    d += (c ^ (a & (b ^ c))) + blocks[13] - 40341101;
    d = (d << 12 | d >>> 20) + a << 0;
    c += (b ^ (d & (a ^ b))) + blocks[14] - 1502002290;
    c = (c << 17 | c >>> 15) + d << 0;
    b += (a ^ (c & (d ^ a))) + blocks[15] + 1236535329;
    b = (b << 22 | b >>> 10) + c << 0;
    a += (c ^ (d & (b ^ c))) + blocks[1] - 165796510;
    a = (a << 5 | a >>> 27) + b << 0;
    d += (b ^ (c & (a ^ b))) + blocks[6] - 1069501632;
    d = (d << 9 | d >>> 23) + a << 0;
    c += (a ^ (b & (d ^ a))) + blocks[11] + 643717713;
    c = (c << 14 | c >>> 18) + d << 0;
    b += (d ^ (a & (c ^ d))) + blocks[0] - 373897302;
    b = (b << 20 | b >>> 12) + c << 0;
    a += (c ^ (d & (b ^ c))) + blocks[5] - 701558691;
    a = (a << 5 | a >>> 27) + b << 0;
    d += (b ^ (c & (a ^ b))) + blocks[10] + 38016083;
    d = (d << 9 | d >>> 23) + a << 0;
    c += (a ^ (b & (d ^ a))) + blocks[15] - 660478335;
    c = (c << 14 | c >>> 18) + d << 0;
    b += (d ^ (a & (c ^ d))) + blocks[4] - 405537848;
    b = (b << 20 | b >>> 12) + c << 0;
    a += (c ^ (d & (b ^ c))) + blocks[9] + 568446438;
    a = (a << 5 | a >>> 27) + b << 0;
    d += (b ^ (c & (a ^ b))) + blocks[14] - 1019803690;
    d = (d << 9 | d >>> 23) + a << 0;
    c += (a ^ (b & (d ^ a))) + blocks[3] - 187363961;
    c = (c << 14 | c >>> 18) + d << 0;
    b += (d ^ (a & (c ^ d))) + blocks[8] + 1163531501;
    b = (b << 20 | b >>> 12) + c << 0;
    a += (c ^ (d & (b ^ c))) + blocks[13] - 1444681467;
    a = (a << 5 | a >>> 27) + b << 0;
    d += (b ^ (c & (a ^ b))) + blocks[2] - 51403784;
    d = (d << 9 | d >>> 23) + a << 0;
    c += (a ^ (b & (d ^ a))) + blocks[7] + 1735328473;
    c = (c << 14 | c >>> 18) + d << 0;
    b += (d ^ (a & (c ^ d))) + blocks[12] - 1926607734;
    b = (b << 20 | b >>> 12) + c << 0;
    bc = b ^ c;
    a += (bc ^ d) + blocks[5] - 378558;
    a = (a << 4 | a >>> 28) + b << 0;
    d += (bc ^ a) + blocks[8] - 2022574463;
    d = (d << 11 | d >>> 21) + a << 0;
    da = d ^ a;
    c += (da ^ b) + blocks[11] + 1839030562;
    c = (c << 16 | c >>> 16) + d << 0;
    b += (da ^ c) + blocks[14] - 35309556;
    b = (b << 23 | b >>> 9) + c << 0;
    bc = b ^ c;
    a += (bc ^ d) + blocks[1] - 1530992060;
    a = (a << 4 | a >>> 28) + b << 0;
    d += (bc ^ a) + blocks[4] + 1272893353;
    d = (d << 11 | d >>> 21) + a << 0;
    da = d ^ a;
    c += (da ^ b) + blocks[7] - 155497632;
    c = (c << 16 | c >>> 16) + d << 0;
    b += (da ^ c) + blocks[10] - 1094730640;
    b = (b << 23 | b >>> 9) + c << 0;
    bc = b ^ c;
    a += (bc ^ d) + blocks[13] + 681279174;
    a = (a << 4 | a >>> 28) + b << 0;
    d += (bc ^ a) + blocks[0] - 358537222;
    d = (d << 11 | d >>> 21) + a << 0;
    da = d ^ a;
    c += (da ^ b) + blocks[3] - 722521979;
    c = (c << 16 | c >>> 16) + d << 0;
    b += (da ^ c) + blocks[6] + 76029189;
    b = (b << 23 | b >>> 9) + c << 0;
    bc = b ^ c;
    a += (bc ^ d) + blocks[9] - 640364487;
    a = (a << 4 | a >>> 28) + b << 0;
    d += (bc ^ a) + blocks[12] - 421815835;
    d = (d << 11 | d >>> 21) + a << 0;
    da = d ^ a;
    c += (da ^ b) + blocks[15] + 530742520;
    c = (c << 16 | c >>> 16) + d << 0;
    b += (da ^ c) + blocks[2] - 995338651;
    b = (b << 23 | b >>> 9) + c << 0;
    a += (c ^ (b | ~d)) + blocks[0] - 198630844;
    a = (a << 6 | a >>> 26) + b << 0;
    d += (b ^ (a | ~c)) + blocks[7] + 1126891415;
    d = (d << 10 | d >>> 22) + a << 0;
    c += (a ^ (d | ~b)) + blocks[14] - 1416354905;
    c = (c << 15 | c >>> 17) + d << 0;
    b += (d ^ (c | ~a)) + blocks[5] - 57434055;
    b = (b << 21 | b >>> 11) + c << 0;
    a += (c ^ (b | ~d)) + blocks[12] + 1700485571;
    a = (a << 6 | a >>> 26) + b << 0;
    d += (b ^ (a | ~c)) + blocks[3] - 1894986606;
    d = (d << 10 | d >>> 22) + a << 0;
    c += (a ^ (d | ~b)) + blocks[10] - 1051523;
    c = (c << 15 | c >>> 17) + d << 0;
    b += (d ^ (c | ~a)) + blocks[1] - 2054922799;
    b = (b << 21 | b >>> 11) + c << 0;
    a += (c ^ (b | ~d)) + blocks[8] + 1873313359;
    a = (a << 6 | a >>> 26) + b << 0;
    d += (b ^ (a | ~c)) + blocks[15] - 30611744;
    d = (d << 10 | d >>> 22) + a << 0;
    c += (a ^ (d | ~b)) + blocks[6] - 1560198380;
    c = (c << 15 | c >>> 17) + d << 0;
    b += (d ^ (c | ~a)) + blocks[13] + 1309151649;
    b = (b << 21 | b >>> 11) + c << 0;
    a += (c ^ (b | ~d)) + blocks[4] - 145523070;
    a = (a << 6 | a >>> 26) + b << 0;
    d += (b ^ (a | ~c)) + blocks[11] - 1120210379;
    d = (d << 10 | d >>> 22) + a << 0;
    c += (a ^ (d | ~b)) + blocks[2] + 718787259;
    c = (c << 15 | c >>> 17) + d << 0;
    b += (d ^ (c | ~a)) + blocks[9] - 343485551;
    b = (b << 21 | b >>> 11) + c << 0;

    if (this.first) {
      this.h0 = a + 1732584193 << 0;
      this.h1 = b - 271733879 << 0;
      this.h2 = c - 1732584194 << 0;
      this.h3 = d + 271733878 << 0;
      this.first = false;
    } else {
      this.h0 = this.h0 + a << 0;
      this.h1 = this.h1 + b << 0;
      this.h2 = this.h2 + c << 0;
      this.h3 = this.h3 + d << 0;
    }
  };

  /**
   * @method hex
   * @memberof Md5
   * @instance
   * @description Output hash as hex string
   * @returns {String} Hex string
   * @see {@link md5.hex}
   * @example
   * hash.hex();
   */
  Md5.prototype.hex = function () {
    this.finalize();

    var h0 = this.h0, h1 = this.h1, h2 = this.h2, h3 = this.h3;

    return HEX_CHARS[(h0 >> 4) & 0x0F] + HEX_CHARS[h0 & 0x0F] +
      HEX_CHARS[(h0 >> 12) & 0x0F] + HEX_CHARS[(h0 >> 8) & 0x0F] +
      HEX_CHARS[(h0 >> 20) & 0x0F] + HEX_CHARS[(h0 >> 16) & 0x0F] +
      HEX_CHARS[(h0 >> 28) & 0x0F] + HEX_CHARS[(h0 >> 24) & 0x0F] +
      HEX_CHARS[(h1 >> 4) & 0x0F] + HEX_CHARS[h1 & 0x0F] +
      HEX_CHARS[(h1 >> 12) & 0x0F] + HEX_CHARS[(h1 >> 8) & 0x0F] +
      HEX_CHARS[(h1 >> 20) & 0x0F] + HEX_CHARS[(h1 >> 16) & 0x0F] +
      HEX_CHARS[(h1 >> 28) & 0x0F] + HEX_CHARS[(h1 >> 24) & 0x0F] +
      HEX_CHARS[(h2 >> 4) & 0x0F] + HEX_CHARS[h2 & 0x0F] +
      HEX_CHARS[(h2 >> 12) & 0x0F] + HEX_CHARS[(h2 >> 8) & 0x0F] +
      HEX_CHARS[(h2 >> 20) & 0x0F] + HEX_CHARS[(h2 >> 16) & 0x0F] +
      HEX_CHARS[(h2 >> 28) & 0x0F] + HEX_CHARS[(h2 >> 24) & 0x0F] +
      HEX_CHARS[(h3 >> 4) & 0x0F] + HEX_CHARS[h3 & 0x0F] +
      HEX_CHARS[(h3 >> 12) & 0x0F] + HEX_CHARS[(h3 >> 8) & 0x0F] +
      HEX_CHARS[(h3 >> 20) & 0x0F] + HEX_CHARS[(h3 >> 16) & 0x0F] +
      HEX_CHARS[(h3 >> 28) & 0x0F] + HEX_CHARS[(h3 >> 24) & 0x0F];
  };

  /**
   * @method toString
   * @memberof Md5
   * @instance
   * @description Output hash as hex string
   * @returns {String} Hex string
   * @see {@link md5.hex}
   * @example
   * hash.toString();
   */
  Md5.prototype.toString = Md5.prototype.hex;

  /**
   * @method digest
   * @memberof Md5
   * @instance
   * @description Output hash as bytes array
   * @returns {Array} Bytes array
   * @see {@link md5.digest}
   * @example
   * hash.digest();
   */
  Md5.prototype.digest = function () {
    this.finalize();

    var h0 = this.h0, h1 = this.h1, h2 = this.h2, h3 = this.h3;
    return [
      h0 & 0xFF, (h0 >> 8) & 0xFF, (h0 >> 16) & 0xFF, (h0 >> 24) & 0xFF,
      h1 & 0xFF, (h1 >> 8) & 0xFF, (h1 >> 16) & 0xFF, (h1 >> 24) & 0xFF,
      h2 & 0xFF, (h2 >> 8) & 0xFF, (h2 >> 16) & 0xFF, (h2 >> 24) & 0xFF,
      h3 & 0xFF, (h3 >> 8) & 0xFF, (h3 >> 16) & 0xFF, (h3 >> 24) & 0xFF
    ];
  };

  /**
   * @method array
   * @memberof Md5
   * @instance
   * @description Output hash as bytes array
   * @returns {Array} Bytes array
   * @see {@link md5.array}
   * @example
   * hash.array();
   */
  Md5.prototype.array = Md5.prototype.digest;

  /**
   * @method arrayBuffer
   * @memberof Md5
   * @instance
   * @description Output hash as ArrayBuffer
   * @returns {ArrayBuffer} ArrayBuffer
   * @see {@link md5.arrayBuffer}
   * @example
   * hash.arrayBuffer();
   */
  Md5.prototype.arrayBuffer = function () {
    this.finalize();

    var buffer = new ArrayBuffer(16);
    var blocks = new Uint32Array(buffer);
    blocks[0] = this.h0;
    blocks[1] = this.h1;
    blocks[2] = this.h2;
    blocks[3] = this.h3;
    return buffer;
  };

  /**
   * @method buffer
   * @deprecated This maybe confuse with Buffer in node.js. Please use arrayBuffer instead.
   * @memberof Md5
   * @instance
   * @description Output hash as ArrayBuffer
   * @returns {ArrayBuffer} ArrayBuffer
   * @see {@link md5.buffer}
   * @example
   * hash.buffer();
   */
  Md5.prototype.buffer = Md5.prototype.arrayBuffer;

  /**
   * @method base64
   * @memberof Md5
   * @instance
   * @description Output hash as base64 string
   * @returns {String} base64 string
   * @see {@link md5.base64}
   * @example
   * hash.base64();
   */
  Md5.prototype.base64 = function () {
    var v1, v2, v3, base64Str = '', bytes = this.array();
    for (var i = 0; i < 15;) {
      v1 = bytes[i++];
      v2 = bytes[i++];
      v3 = bytes[i++];
      base64Str += BASE64_ENCODE_CHAR[v1 >>> 2] +
        BASE64_ENCODE_CHAR[(v1 << 4 | v2 >>> 4) & 63] +
        BASE64_ENCODE_CHAR[(v2 << 2 | v3 >>> 6) & 63] +
        BASE64_ENCODE_CHAR[v3 & 63];
    }
    v1 = bytes[i];
    base64Str += BASE64_ENCODE_CHAR[v1 >>> 2] +
      BASE64_ENCODE_CHAR[(v1 << 4) & 63] +
      '==';
    return base64Str;
  };

  var exports = createMethod();

  if (COMMON_JS) {
    module.exports = exports;
  } else {
    /**
     * @method md5
     * @description Md5 hash function, export to global in browsers.
     * @param {String|Array|Uint8Array|ArrayBuffer} message message to hash
     * @returns {String} md5 hashes
     * @example
     * md5(''); // d41d8cd98f00b204e9800998ecf8427e
     * md5('The quick brown fox jumps over the lazy dog'); // 9e107d9d372bb6826bd81d3542a419d6
     * md5('The quick brown fox jumps over the lazy dog.'); // e4d909c290d0fb1ca068ffaddf22cbd0
     *
     * // It also supports UTF-8 encoding
     * md5('中文'); // a7bac2239fcdcb3a067903d8077c4a07
     *
     * // It also supports byte `Array`, `Uint8Array`, `ArrayBuffer`
     * md5([]); // d41d8cd98f00b204e9800998ecf8427e
     * md5(new Uint8Array([])); // d41d8cd98f00b204e9800998ecf8427e
     */
    root.md5 = exports;
    if (AMD) {
      !(__WEBPACK_AMD_DEFINE_RESULT__ = (function () {
        return exports;
      }).call(exports, __webpack_require__, exports, module),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));
    }
  }
})();

/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("4362"), __webpack_require__("c8ba")))

/***/ }),

/***/ "825a":
/***/ (function(module, exports, __webpack_require__) {

var global = __webpack_require__("da84");
var isObject = __webpack_require__("861d");

var String = global.String;
var TypeError = global.TypeError;

// `Assert: Type(argument) is Object`
module.exports = function (argument) {
  if (isObject(argument)) return argument;
  throw TypeError(String(argument) + ' is not an object');
};


/***/ }),

/***/ "82f8":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var ArrayBufferViewCore = __webpack_require__("ebb5");
var $includes = __webpack_require__("4d64").includes;

var aTypedArray = ArrayBufferViewCore.aTypedArray;
var exportTypedArrayMethod = ArrayBufferViewCore.exportTypedArrayMethod;

// `%TypedArray%.prototype.includes` method
// https://tc39.es/ecma262/#sec-%typedarray%.prototype.includes
exportTypedArrayMethod('includes', function includes(searchElement /* , fromIndex */) {
  return $includes(aTypedArray(this), searchElement, arguments.length > 1 ? arguments[1] : undefined);
});


/***/ }),

/***/ "83ab":
/***/ (function(module, exports, __webpack_require__) {

var fails = __webpack_require__("d039");

// Detect IE8's incomplete defineProperty implementation
module.exports = !fails(function () {
  // eslint-disable-next-line es/no-object-defineproperty -- required for testing
  return Object.defineProperty({}, 1, { get: function () { return 7; } })[1] != 7;
});


/***/ }),

/***/ "8418":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var toPropertyKey = __webpack_require__("a04b");
var definePropertyModule = __webpack_require__("9bf2");
var createPropertyDescriptor = __webpack_require__("5c6c");

module.exports = function (object, key, value) {
  var propertyKey = toPropertyKey(key);
  if (propertyKey in object) definePropertyModule.f(object, propertyKey, createPropertyDescriptor(0, value));
  else object[propertyKey] = value;
};


/***/ }),

/***/ "841c":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var call = __webpack_require__("c65b");
var fixRegExpWellKnownSymbolLogic = __webpack_require__("d784");
var anObject = __webpack_require__("825a");
var requireObjectCoercible = __webpack_require__("1d80");
var sameValue = __webpack_require__("129f");
var toString = __webpack_require__("577e");
var getMethod = __webpack_require__("dc4a");
var regExpExec = __webpack_require__("14c3");

// @@search logic
fixRegExpWellKnownSymbolLogic('search', function (SEARCH, nativeSearch, maybeCallNative) {
  return [
    // `String.prototype.search` method
    // https://tc39.es/ecma262/#sec-string.prototype.search
    function search(regexp) {
      var O = requireObjectCoercible(this);
      var searcher = regexp == undefined ? undefined : getMethod(regexp, SEARCH);
      return searcher ? call(searcher, regexp, O) : new RegExp(regexp)[SEARCH](toString(O));
    },
    // `RegExp.prototype[@@search]` method
    // https://tc39.es/ecma262/#sec-regexp.prototype-@@search
    function (string) {
      var rx = anObject(this);
      var S = toString(string);
      var res = maybeCallNative(nativeSearch, rx, S);

      if (res.done) return res.value;

      var previousLastIndex = rx.lastIndex;
      if (!sameValue(previousLastIndex, 0)) rx.lastIndex = 0;
      var result = regExpExec(rx, S);
      if (!sameValue(rx.lastIndex, previousLastIndex)) rx.lastIndex = previousLastIndex;
      return result === null ? -1 : result.index;
    }
  ];
});


/***/ }),

/***/ "84c3":
/***/ (function(module, exports, __webpack_require__) {

var createTypedArrayConstructor = __webpack_require__("74e8");

// `Uint16Array` constructor
// https://tc39.es/ecma262/#sec-typedarray-objects
createTypedArrayConstructor('Uint16', function (init) {
  return function Uint16Array(data, byteOffset, length) {
    return init(this, data, byteOffset, length);
  };
});


/***/ }),

/***/ "857a":
/***/ (function(module, exports, __webpack_require__) {

var uncurryThis = __webpack_require__("e330");
var requireObjectCoercible = __webpack_require__("1d80");
var toString = __webpack_require__("577e");

var quot = /"/g;
var replace = uncurryThis(''.replace);

// `CreateHTML` abstract operation
// https://tc39.es/ecma262/#sec-createhtml
module.exports = function (string, tag, attribute, value) {
  var S = toString(requireObjectCoercible(string));
  var p1 = '<' + tag;
  if (attribute !== '') p1 += ' ' + attribute + '="' + replace(toString(value), quot, '&quot;') + '"';
  return p1 + '>' + S + '</' + tag + '>';
};


/***/ }),

/***/ "861d":
/***/ (function(module, exports, __webpack_require__) {

var isCallable = __webpack_require__("1626");

module.exports = function (it) {
  return typeof it == 'object' ? it !== null : isCallable(it);
};


/***/ }),

/***/ "8875":
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;// addapted from the document.currentScript polyfill by Adam Miller
// MIT license
// source: https://github.com/amiller-gh/currentScript-polyfill

// added support for Firefox https://bugzilla.mozilla.org/show_bug.cgi?id=1620505

(function (root, factory) {
  if (true) {
    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),
				__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?
				(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));
  } else {}
}(typeof self !== 'undefined' ? self : this, function () {
  function getCurrentScript () {
    var descriptor = Object.getOwnPropertyDescriptor(document, 'currentScript')
    // for chrome
    if (!descriptor && 'currentScript' in document && document.currentScript) {
      return document.currentScript
    }

    // for other browsers with native support for currentScript
    if (descriptor && descriptor.get !== getCurrentScript && document.currentScript) {
      return document.currentScript
    }
  
    // IE 8-10 support script readyState
    // IE 11+ & Firefox support stack trace
    try {
      throw new Error();
    }
    catch (err) {
      // Find the second match for the "at" string to get file src url from stack.
      var ieStackRegExp = /.*at [^(]*\((.*):(.+):(.+)\)$/ig,
        ffStackRegExp = /@([^@]*):(\d+):(\d+)\s*$/ig,
        stackDetails = ieStackRegExp.exec(err.stack) || ffStackRegExp.exec(err.stack),
        scriptLocation = (stackDetails && stackDetails[1]) || false,
        line = (stackDetails && stackDetails[2]) || false,
        currentLocation = document.location.href.replace(document.location.hash, ''),
        pageSource,
        inlineScriptSourceRegExp,
        inlineScriptSource,
        scripts = document.getElementsByTagName('script'); // Live NodeList collection
  
      if (scriptLocation === currentLocation) {
        pageSource = document.documentElement.outerHTML;
        inlineScriptSourceRegExp = new RegExp('(?:[^\\n]+?\\n){0,' + (line - 2) + '}[^<]*<script>([\\d\\D]*?)<\\/script>[\\d\\D]*', 'i');
        inlineScriptSource = pageSource.replace(inlineScriptSourceRegExp, '$1').trim();
      }
  
      for (var i = 0; i < scripts.length; i++) {
        // If ready state is interactive, return the script tag
        if (scripts[i].readyState === 'interactive') {
          return scripts[i];
        }
  
        // If src matches, return the script tag
        if (scripts[i].src === scriptLocation) {
          return scripts[i];
        }
  
        // If inline source matches, return the script tag
        if (
          scriptLocation === currentLocation &&
          scripts[i].innerHTML &&
          scripts[i].innerHTML.trim() === inlineScriptSource
        ) {
          return scripts[i];
        }
      }
  
      // If no match, return null
      return null;
    }
  };

  return getCurrentScript
}));


/***/ }),

/***/ "8925":
/***/ (function(module, exports, __webpack_require__) {

var uncurryThis = __webpack_require__("e330");
var isCallable = __webpack_require__("1626");
var store = __webpack_require__("c6cd");

var functionToString = uncurryThis(Function.toString);

// this helper broken in `core-js@3.4.1-3.4.4`, so we can't use `shared` helper
if (!isCallable(store.inspectSource)) {
  store.inspectSource = function (it) {
    return functionToString(it);
  };
}

module.exports = store.inspectSource;


/***/ }),

/***/ "8a79":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var $ = __webpack_require__("23e7");
var uncurryThis = __webpack_require__("e330");
var getOwnPropertyDescriptor = __webpack_require__("06cf").f;
var toLength = __webpack_require__("50c4");
var toString = __webpack_require__("577e");
var notARegExp = __webpack_require__("5a34");
var requireObjectCoercible = __webpack_require__("1d80");
var correctIsRegExpLogic = __webpack_require__("ab13");
var IS_PURE = __webpack_require__("c430");

// eslint-disable-next-line es/no-string-prototype-endswith -- safe
var un$EndsWith = uncurryThis(''.endsWith);
var slice = uncurryThis(''.slice);
var min = Math.min;

var CORRECT_IS_REGEXP_LOGIC = correctIsRegExpLogic('endsWith');
// https://github.com/zloirock/core-js/pull/702
var MDN_POLYFILL_BUG = !IS_PURE && !CORRECT_IS_REGEXP_LOGIC && !!function () {
  var descriptor = getOwnPropertyDescriptor(String.prototype, 'endsWith');
  return descriptor && !descriptor.writable;
}();

// `String.prototype.endsWith` method
// https://tc39.es/ecma262/#sec-string.prototype.endswith
$({ target: 'String', proto: true, forced: !MDN_POLYFILL_BUG && !CORRECT_IS_REGEXP_LOGIC }, {
  endsWith: function endsWith(searchString /* , endPosition = @length */) {
    var that = toString(requireObjectCoercible(this));
    notARegExp(searchString);
    var endPosition = arguments.length > 1 ? arguments[1] : undefined;
    var len = that.length;
    var end = endPosition === undefined ? len : min(toLength(endPosition), len);
    var search = toString(searchString);
    return un$EndsWith
      ? un$EndsWith(that, search, end)
      : slice(that, end - search.length, end) === search;
  }
});


/***/ }),

/***/ "8aa5":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var charAt = __webpack_require__("6547").charAt;

// `AdvanceStringIndex` abstract operation
// https://tc39.es/ecma262/#sec-advancestringindex
module.exports = function (S, index, unicode) {
  return index + (unicode ? charAt(S, index).length : 1);
};


/***/ }),

/***/ "8aa7":
/***/ (function(module, exports, __webpack_require__) {

/* eslint-disable no-new -- required for testing */
var global = __webpack_require__("da84");
var fails = __webpack_require__("d039");
var checkCorrectnessOfIteration = __webpack_require__("1c7e");
var NATIVE_ARRAY_BUFFER_VIEWS = __webpack_require__("ebb5").NATIVE_ARRAY_BUFFER_VIEWS;

var ArrayBuffer = global.ArrayBuffer;
var Int8Array = global.Int8Array;

module.exports = !NATIVE_ARRAY_BUFFER_VIEWS || !fails(function () {
  Int8Array(1);
}) || !fails(function () {
  new Int8Array(-1);
}) || !checkCorrectnessOfIteration(function (iterable) {
  new Int8Array();
  new Int8Array(null);
  new Int8Array(1.5);
  new Int8Array(iterable);
}, true) || fails(function () {
  // Safari (11+) bug - a reason why even Safari 13 should load a typed array polyfill
  return new Int8Array(new ArrayBuffer(2), 1, undefined).length !== 1;
});


/***/ }),

/***/ "8b09":
/***/ (function(module, exports, __webpack_require__) {

var createTypedArrayConstructor = __webpack_require__("74e8");

// `Int16Array` constructor
// https://tc39.es/ecma262/#sec-typedarray-objects
createTypedArrayConstructor('Int16', function (init) {
  return function Int16Array(data, byteOffset, length) {
    return init(this, data, byteOffset, length);
  };
});


/***/ }),

/***/ "8bc7":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var _node_modules_vue_style_loader_index_js_ref_9_oneOf_1_0_node_modules_css_loader_dist_cjs_js_ref_9_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_9_oneOf_1_2_node_modules_postcss_loader_src_index_js_ref_9_oneOf_1_3_node_modules_sass_loader_dist_cjs_js_ref_9_oneOf_1_4_node_modules_cache_loader_dist_cjs_js_ref_1_0_node_modules_vue_loader_lib_index_js_vue_loader_options_index_vue_vue_type_style_index_0_id_4fb99c2a_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("70de");
/* harmony import */ var _node_modules_vue_style_loader_index_js_ref_9_oneOf_1_0_node_modules_css_loader_dist_cjs_js_ref_9_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_9_oneOf_1_2_node_modules_postcss_loader_src_index_js_ref_9_oneOf_1_3_node_modules_sass_loader_dist_cjs_js_ref_9_oneOf_1_4_node_modules_cache_loader_dist_cjs_js_ref_1_0_node_modules_vue_loader_lib_index_js_vue_loader_options_index_vue_vue_type_style_index_0_id_4fb99c2a_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_node_modules_vue_style_loader_index_js_ref_9_oneOf_1_0_node_modules_css_loader_dist_cjs_js_ref_9_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_9_oneOf_1_2_node_modules_postcss_loader_src_index_js_ref_9_oneOf_1_3_node_modules_sass_loader_dist_cjs_js_ref_9_oneOf_1_4_node_modules_cache_loader_dist_cjs_js_ref_1_0_node_modules_vue_loader_lib_index_js_vue_loader_options_index_vue_vue_type_style_index_0_id_4fb99c2a_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0__);
/* unused harmony reexport * */


/***/ }),

/***/ "8d33":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var _node_modules_vue_style_loader_index_js_ref_9_oneOf_1_0_node_modules_css_loader_dist_cjs_js_ref_9_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_9_oneOf_1_2_node_modules_postcss_loader_src_index_js_ref_9_oneOf_1_3_node_modules_sass_loader_dist_cjs_js_ref_9_oneOf_1_4_node_modules_cache_loader_dist_cjs_js_ref_1_0_node_modules_vue_loader_lib_index_js_vue_loader_options_index_vue_vue_type_style_index_0_id_3fd5e29c_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("59b1");
/* harmony import */ var _node_modules_vue_style_loader_index_js_ref_9_oneOf_1_0_node_modules_css_loader_dist_cjs_js_ref_9_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_9_oneOf_1_2_node_modules_postcss_loader_src_index_js_ref_9_oneOf_1_3_node_modules_sass_loader_dist_cjs_js_ref_9_oneOf_1_4_node_modules_cache_loader_dist_cjs_js_ref_1_0_node_modules_vue_loader_lib_index_js_vue_loader_options_index_vue_vue_type_style_index_0_id_3fd5e29c_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_node_modules_vue_style_loader_index_js_ref_9_oneOf_1_0_node_modules_css_loader_dist_cjs_js_ref_9_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_9_oneOf_1_2_node_modules_postcss_loader_src_index_js_ref_9_oneOf_1_3_node_modules_sass_loader_dist_cjs_js_ref_9_oneOf_1_4_node_modules_cache_loader_dist_cjs_js_ref_1_0_node_modules_vue_loader_lib_index_js_vue_loader_options_index_vue_vue_type_style_index_0_id_3fd5e29c_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0__);
/* unused harmony reexport * */


/***/ }),

/***/ "901e":
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_RESULT__;;(function (globalObject) {
  'use strict';

/*
 *      bignumber.js v9.0.2
 *      A JavaScript library for arbitrary-precision arithmetic.
 *      https://github.com/MikeMcl/bignumber.js
 *      Copyright (c) 2021 Michael Mclaughlin <M8ch88l@gmail.com>
 *      MIT Licensed.
 *
 *      BigNumber.prototype methods     |  BigNumber methods
 *                                      |
 *      absoluteValue            abs    |  clone
 *      comparedTo                      |  config               set
 *      decimalPlaces            dp     |      DECIMAL_PLACES
 *      dividedBy                div    |      ROUNDING_MODE
 *      dividedToIntegerBy       idiv   |      EXPONENTIAL_AT
 *      exponentiatedBy          pow    |      RANGE
 *      integerValue                    |      CRYPTO
 *      isEqualTo                eq     |      MODULO_MODE
 *      isFinite                        |      POW_PRECISION
 *      isGreaterThan            gt     |      FORMAT
 *      isGreaterThanOrEqualTo   gte    |      ALPHABET
 *      isInteger                       |  isBigNumber
 *      isLessThan               lt     |  maximum              max
 *      isLessThanOrEqualTo      lte    |  minimum              min
 *      isNaN                           |  random
 *      isNegative                      |  sum
 *      isPositive                      |
 *      isZero                          |
 *      minus                           |
 *      modulo                   mod    |
 *      multipliedBy             times  |
 *      negated                         |
 *      plus                            |
 *      precision                sd     |
 *      shiftedBy                       |
 *      squareRoot               sqrt   |
 *      toExponential                   |
 *      toFixed                         |
 *      toFormat                        |
 *      toFraction                      |
 *      toJSON                          |
 *      toNumber                        |
 *      toPrecision                     |
 *      toString                        |
 *      valueOf                         |
 *
 */


  var BigNumber,
    isNumeric = /^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,
    mathceil = Math.ceil,
    mathfloor = Math.floor,

    bignumberError = '[BigNumber Error] ',
    tooManyDigits = bignumberError + 'Number primitive has more than 15 significant digits: ',

    BASE = 1e14,
    LOG_BASE = 14,
    MAX_SAFE_INTEGER = 0x1fffffffffffff,         // 2^53 - 1
    // MAX_INT32 = 0x7fffffff,                   // 2^31 - 1
    POWS_TEN = [1, 10, 100, 1e3, 1e4, 1e5, 1e6, 1e7, 1e8, 1e9, 1e10, 1e11, 1e12, 1e13],
    SQRT_BASE = 1e7,

    // EDITABLE
    // The limit on the value of DECIMAL_PLACES, TO_EXP_NEG, TO_EXP_POS, MIN_EXP, MAX_EXP, and
    // the arguments to toExponential, toFixed, toFormat, and toPrecision.
    MAX = 1E9;                                   // 0 to MAX_INT32


  /*
   * Create and return a BigNumber constructor.
   */
  function clone(configObject) {
    var div, convertBase, parseNumeric,
      P = BigNumber.prototype = { constructor: BigNumber, toString: null, valueOf: null },
      ONE = new BigNumber(1),


      //----------------------------- EDITABLE CONFIG DEFAULTS -------------------------------


      // The default values below must be integers within the inclusive ranges stated.
      // The values can also be changed at run-time using BigNumber.set.

      // The maximum number of decimal places for operations involving division.
      DECIMAL_PLACES = 20,                     // 0 to MAX

      // The rounding mode used when rounding to the above decimal places, and when using
      // toExponential, toFixed, toFormat and toPrecision, and round (default value).
      // UP         0 Away from zero.
      // DOWN       1 Towards zero.
      // CEIL       2 Towards +Infinity.
      // FLOOR      3 Towards -Infinity.
      // HALF_UP    4 Towards nearest neighbour. If equidistant, up.
      // HALF_DOWN  5 Towards nearest neighbour. If equidistant, down.
      // HALF_EVEN  6 Towards nearest neighbour. If equidistant, towards even neighbour.
      // HALF_CEIL  7 Towards nearest neighbour. If equidistant, towards +Infinity.
      // HALF_FLOOR 8 Towards nearest neighbour. If equidistant, towards -Infinity.
      ROUNDING_MODE = 4,                       // 0 to 8

      // EXPONENTIAL_AT : [TO_EXP_NEG , TO_EXP_POS]

      // The exponent value at and beneath which toString returns exponential notation.
      // Number type: -7
      TO_EXP_NEG = -7,                         // 0 to -MAX

      // The exponent value at and above which toString returns exponential notation.
      // Number type: 21
      TO_EXP_POS = 21,                         // 0 to MAX

      // RANGE : [MIN_EXP, MAX_EXP]

      // The minimum exponent value, beneath which underflow to zero occurs.
      // Number type: -324  (5e-324)
      MIN_EXP = -1e7,                          // -1 to -MAX

      // The maximum exponent value, above which overflow to Infinity occurs.
      // Number type:  308  (1.7976931348623157e+308)
      // For MAX_EXP > 1e7, e.g. new BigNumber('1e100000000').plus(1) may be slow.
      MAX_EXP = 1e7,                           // 1 to MAX

      // Whether to use cryptographically-secure random number generation, if available.
      CRYPTO = false,                          // true or false

      // The modulo mode used when calculating the modulus: a mod n.
      // The quotient (q = a / n) is calculated according to the corresponding rounding mode.
      // The remainder (r) is calculated as: r = a - n * q.
      //
      // UP        0 The remainder is positive if the dividend is negative, else is negative.
      // DOWN      1 The remainder has the same sign as the dividend.
      //             This modulo mode is commonly known as 'truncated division' and is
      //             equivalent to (a % n) in JavaScript.
      // FLOOR     3 The remainder has the same sign as the divisor (Python %).
      // HALF_EVEN 6 This modulo mode implements the IEEE 754 remainder function.
      // EUCLID    9 Euclidian division. q = sign(n) * floor(a / abs(n)).
      //             The remainder is always positive.
      //
      // The truncated division, floored division, Euclidian division and IEEE 754 remainder
      // modes are commonly used for the modulus operation.
      // Although the other rounding modes can also be used, they may not give useful results.
      MODULO_MODE = 1,                         // 0 to 9

      // The maximum number of significant digits of the result of the exponentiatedBy operation.
      // If POW_PRECISION is 0, there will be unlimited significant digits.
      POW_PRECISION = 0,                       // 0 to MAX

      // The format specification used by the BigNumber.prototype.toFormat method.
      FORMAT = {
        prefix: '',
        groupSize: 3,
        secondaryGroupSize: 0,
        groupSeparator: ',',
        decimalSeparator: '.',
        fractionGroupSize: 0,
        fractionGroupSeparator: '\xA0',        // non-breaking space
        suffix: ''
      },

      // The alphabet used for base conversion. It must be at least 2 characters long, with no '+',
      // '-', '.', whitespace, or repeated character.
      // '0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ$_'
      ALPHABET = '0123456789abcdefghijklmnopqrstuvwxyz',
      alphabetHasNormalDecimalDigits = true;


    //------------------------------------------------------------------------------------------


    // CONSTRUCTOR


    /*
     * The BigNumber constructor and exported function.
     * Create and return a new instance of a BigNumber object.
     *
     * v {number|string|BigNumber} A numeric value.
     * [b] {number} The base of v. Integer, 2 to ALPHABET.length inclusive.
     */
    function BigNumber(v, b) {
      var alphabet, c, caseChanged, e, i, isNum, len, str,
        x = this;

      // Enable constructor call without `new`.
      if (!(x instanceof BigNumber)) return new BigNumber(v, b);

      if (b == null) {

        if (v && v._isBigNumber === true) {
          x.s = v.s;

          if (!v.c || v.e > MAX_EXP) {
            x.c = x.e = null;
          } else if (v.e < MIN_EXP) {
            x.c = [x.e = 0];
          } else {
            x.e = v.e;
            x.c = v.c.slice();
          }

          return;
        }

        if ((isNum = typeof v == 'number') && v * 0 == 0) {

          // Use `1 / n` to handle minus zero also.
          x.s = 1 / v < 0 ? (v = -v, -1) : 1;

          // Fast path for integers, where n < 2147483648 (2**31).
          if (v === ~~v) {
            for (e = 0, i = v; i >= 10; i /= 10, e++);

            if (e > MAX_EXP) {
              x.c = x.e = null;
            } else {
              x.e = e;
              x.c = [v];
            }

            return;
          }

          str = String(v);
        } else {

          if (!isNumeric.test(str = String(v))) return parseNumeric(x, str, isNum);

          x.s = str.charCodeAt(0) == 45 ? (str = str.slice(1), -1) : 1;
        }

        // Decimal point?
        if ((e = str.indexOf('.')) > -1) str = str.replace('.', '');

        // Exponential form?
        if ((i = str.search(/e/i)) > 0) {

          // Determine exponent.
          if (e < 0) e = i;
          e += +str.slice(i + 1);
          str = str.substring(0, i);
        } else if (e < 0) {

          // Integer.
          e = str.length;
        }

      } else {

        // '[BigNumber Error] Base {not a primitive number|not an integer|out of range}: {b}'
        intCheck(b, 2, ALPHABET.length, 'Base');

        // Allow exponential notation to be used with base 10 argument, while
        // also rounding to DECIMAL_PLACES as with other bases.
        if (b == 10 && alphabetHasNormalDecimalDigits) {
          x = new BigNumber(v);
          return round(x, DECIMAL_PLACES + x.e + 1, ROUNDING_MODE);
        }

        str = String(v);

        if (isNum = typeof v == 'number') {

          // Avoid potential interpretation of Infinity and NaN as base 44+ values.
          if (v * 0 != 0) return parseNumeric(x, str, isNum, b);

          x.s = 1 / v < 0 ? (str = str.slice(1), -1) : 1;

          // '[BigNumber Error] Number primitive has more than 15 significant digits: {n}'
          if (BigNumber.DEBUG && str.replace(/^0\.0*|\./, '').length > 15) {
            throw Error
             (tooManyDigits + v);
          }
        } else {
          x.s = str.charCodeAt(0) === 45 ? (str = str.slice(1), -1) : 1;
        }

        alphabet = ALPHABET.slice(0, b);
        e = i = 0;

        // Check that str is a valid base b number.
        // Don't use RegExp, so alphabet can contain special characters.
        for (len = str.length; i < len; i++) {
          if (alphabet.indexOf(c = str.charAt(i)) < 0) {
            if (c == '.') {

              // If '.' is not the first character and it has not be found before.
              if (i > e) {
                e = len;
                continue;
              }
            } else if (!caseChanged) {

              // Allow e.g. hexadecimal 'FF' as well as 'ff'.
              if (str == str.toUpperCase() && (str = str.toLowerCase()) ||
                  str == str.toLowerCase() && (str = str.toUpperCase())) {
                caseChanged = true;
                i = -1;
                e = 0;
                continue;
              }
            }

            return parseNumeric(x, String(v), isNum, b);
          }
        }

        // Prevent later check for length on converted number.
        isNum = false;
        str = convertBase(str, b, 10, x.s);

        // Decimal point?
        if ((e = str.indexOf('.')) > -1) str = str.replace('.', '');
        else e = str.length;
      }

      // Determine leading zeros.
      for (i = 0; str.charCodeAt(i) === 48; i++);

      // Determine trailing zeros.
      for (len = str.length; str.charCodeAt(--len) === 48;);

      if (str = str.slice(i, ++len)) {
        len -= i;

        // '[BigNumber Error] Number primitive has more than 15 significant digits: {n}'
        if (isNum && BigNumber.DEBUG &&
          len > 15 && (v > MAX_SAFE_INTEGER || v !== mathfloor(v))) {
            throw Error
             (tooManyDigits + (x.s * v));
        }

         // Overflow?
        if ((e = e - i - 1) > MAX_EXP) {

          // Infinity.
          x.c = x.e = null;

        // Underflow?
        } else if (e < MIN_EXP) {

          // Zero.
          x.c = [x.e = 0];
        } else {
          x.e = e;
          x.c = [];

          // Transform base

          // e is the base 10 exponent.
          // i is where to slice str to get the first element of the coefficient array.
          i = (e + 1) % LOG_BASE;
          if (e < 0) i += LOG_BASE;  // i < 1

          if (i < len) {
            if (i) x.c.push(+str.slice(0, i));

            for (len -= LOG_BASE; i < len;) {
              x.c.push(+str.slice(i, i += LOG_BASE));
            }

            i = LOG_BASE - (str = str.slice(i)).length;
          } else {
            i -= len;
          }

          for (; i--; str += '0');
          x.c.push(+str);
        }
      } else {

        // Zero.
        x.c = [x.e = 0];
      }
    }


    // CONSTRUCTOR PROPERTIES


    BigNumber.clone = clone;

    BigNumber.ROUND_UP = 0;
    BigNumber.ROUND_DOWN = 1;
    BigNumber.ROUND_CEIL = 2;
    BigNumber.ROUND_FLOOR = 3;
    BigNumber.ROUND_HALF_UP = 4;
    BigNumber.ROUND_HALF_DOWN = 5;
    BigNumber.ROUND_HALF_EVEN = 6;
    BigNumber.ROUND_HALF_CEIL = 7;
    BigNumber.ROUND_HALF_FLOOR = 8;
    BigNumber.EUCLID = 9;


    /*
     * Configure infrequently-changing library-wide settings.
     *
     * Accept an object with the following optional properties (if the value of a property is
     * a number, it must be an integer within the inclusive range stated):
     *
     *   DECIMAL_PLACES   {number}           0 to MAX
     *   ROUNDING_MODE    {number}           0 to 8
     *   EXPONENTIAL_AT   {number|number[]}  -MAX to MAX  or  [-MAX to 0, 0 to MAX]
     *   RANGE            {number|number[]}  -MAX to MAX (not zero)  or  [-MAX to -1, 1 to MAX]
     *   CRYPTO           {boolean}          true or false
     *   MODULO_MODE      {number}           0 to 9
     *   POW_PRECISION       {number}           0 to MAX
     *   ALPHABET         {string}           A string of two or more unique characters which does
     *                                       not contain '.'.
     *   FORMAT           {object}           An object with some of the following properties:
     *     prefix                 {string}
     *     groupSize              {number}
     *     secondaryGroupSize     {number}
     *     groupSeparator         {string}
     *     decimalSeparator       {string}
     *     fractionGroupSize      {number}
     *     fractionGroupSeparator {string}
     *     suffix                 {string}
     *
     * (The values assigned to the above FORMAT object properties are not checked for validity.)
     *
     * E.g.
     * BigNumber.config({ DECIMAL_PLACES : 20, ROUNDING_MODE : 4 })
     *
     * Ignore properties/parameters set to null or undefined, except for ALPHABET.
     *
     * Return an object with the properties current values.
     */
    BigNumber.config = BigNumber.set = function (obj) {
      var p, v;

      if (obj != null) {

        if (typeof obj == 'object') {

          // DECIMAL_PLACES {number} Integer, 0 to MAX inclusive.
          // '[BigNumber Error] DECIMAL_PLACES {not a primitive number|not an integer|out of range}: {v}'
          if (obj.hasOwnProperty(p = 'DECIMAL_PLACES')) {
            v = obj[p];
            intCheck(v, 0, MAX, p);
            DECIMAL_PLACES = v;
          }

          // ROUNDING_MODE {number} Integer, 0 to 8 inclusive.
          // '[BigNumber Error] ROUNDING_MODE {not a primitive number|not an integer|out of range}: {v}'
          if (obj.hasOwnProperty(p = 'ROUNDING_MODE')) {
            v = obj[p];
            intCheck(v, 0, 8, p);
            ROUNDING_MODE = v;
          }

          // EXPONENTIAL_AT {number|number[]}
          // Integer, -MAX to MAX inclusive or
          // [integer -MAX to 0 inclusive, 0 to MAX inclusive].
          // '[BigNumber Error] EXPONENTIAL_AT {not a primitive number|not an integer|out of range}: {v}'
          if (obj.hasOwnProperty(p = 'EXPONENTIAL_AT')) {
            v = obj[p];
            if (v && v.pop) {
              intCheck(v[0], -MAX, 0, p);
              intCheck(v[1], 0, MAX, p);
              TO_EXP_NEG = v[0];
              TO_EXP_POS = v[1];
            } else {
              intCheck(v, -MAX, MAX, p);
              TO_EXP_NEG = -(TO_EXP_POS = v < 0 ? -v : v);
            }
          }

          // RANGE {number|number[]} Non-zero integer, -MAX to MAX inclusive or
          // [integer -MAX to -1 inclusive, integer 1 to MAX inclusive].
          // '[BigNumber Error] RANGE {not a primitive number|not an integer|out of range|cannot be zero}: {v}'
          if (obj.hasOwnProperty(p = 'RANGE')) {
            v = obj[p];
            if (v && v.pop) {
              intCheck(v[0], -MAX, -1, p);
              intCheck(v[1], 1, MAX, p);
              MIN_EXP = v[0];
              MAX_EXP = v[1];
            } else {
              intCheck(v, -MAX, MAX, p);
              if (v) {
                MIN_EXP = -(MAX_EXP = v < 0 ? -v : v);
              } else {
                throw Error
                 (bignumberError + p + ' cannot be zero: ' + v);
              }
            }
          }

          // CRYPTO {boolean} true or false.
          // '[BigNumber Error] CRYPTO not true or false: {v}'
          // '[BigNumber Error] crypto unavailable'
          if (obj.hasOwnProperty(p = 'CRYPTO')) {
            v = obj[p];
            if (v === !!v) {
              if (v) {
                if (typeof crypto != 'undefined' && crypto &&
                 (crypto.getRandomValues || crypto.randomBytes)) {
                  CRYPTO = v;
                } else {
                  CRYPTO = !v;
                  throw Error
                   (bignumberError + 'crypto unavailable');
                }
              } else {
                CRYPTO = v;
              }
            } else {
              throw Error
               (bignumberError + p + ' not true or false: ' + v);
            }
          }

          // MODULO_MODE {number} Integer, 0 to 9 inclusive.
          // '[BigNumber Error] MODULO_MODE {not a primitive number|not an integer|out of range}: {v}'
          if (obj.hasOwnProperty(p = 'MODULO_MODE')) {
            v = obj[p];
            intCheck(v, 0, 9, p);
            MODULO_MODE = v;
          }

          // POW_PRECISION {number} Integer, 0 to MAX inclusive.
          // '[BigNumber Error] POW_PRECISION {not a primitive number|not an integer|out of range}: {v}'
          if (obj.hasOwnProperty(p = 'POW_PRECISION')) {
            v = obj[p];
            intCheck(v, 0, MAX, p);
            POW_PRECISION = v;
          }

          // FORMAT {object}
          // '[BigNumber Error] FORMAT not an object: {v}'
          if (obj.hasOwnProperty(p = 'FORMAT')) {
            v = obj[p];
            if (typeof v == 'object') FORMAT = v;
            else throw Error
             (bignumberError + p + ' not an object: ' + v);
          }

          // ALPHABET {string}
          // '[BigNumber Error] ALPHABET invalid: {v}'
          if (obj.hasOwnProperty(p = 'ALPHABET')) {
            v = obj[p];

            // Disallow if less than two characters,
            // or if it contains '+', '-', '.', whitespace, or a repeated character.
            if (typeof v == 'string' && !/^.?$|[+\-.\s]|(.).*\1/.test(v)) {
              alphabetHasNormalDecimalDigits = v.slice(0, 10) == '0123456789';
              ALPHABET = v;
            } else {
              throw Error
               (bignumberError + p + ' invalid: ' + v);
            }
          }

        } else {

          // '[BigNumber Error] Object expected: {v}'
          throw Error
           (bignumberError + 'Object expected: ' + obj);
        }
      }

      return {
        DECIMAL_PLACES: DECIMAL_PLACES,
        ROUNDING_MODE: ROUNDING_MODE,
        EXPONENTIAL_AT: [TO_EXP_NEG, TO_EXP_POS],
        RANGE: [MIN_EXP, MAX_EXP],
        CRYPTO: CRYPTO,
        MODULO_MODE: MODULO_MODE,
        POW_PRECISION: POW_PRECISION,
        FORMAT: FORMAT,
        ALPHABET: ALPHABET
      };
    };


    /*
     * Return true if v is a BigNumber instance, otherwise return false.
     *
     * If BigNumber.DEBUG is true, throw if a BigNumber instance is not well-formed.
     *
     * v {any}
     *
     * '[BigNumber Error] Invalid BigNumber: {v}'
     */
    BigNumber.isBigNumber = function (v) {
      if (!v || v._isBigNumber !== true) return false;
      if (!BigNumber.DEBUG) return true;

      var i, n,
        c = v.c,
        e = v.e,
        s = v.s;

      out: if ({}.toString.call(c) == '[object Array]') {

        if ((s === 1 || s === -1) && e >= -MAX && e <= MAX && e === mathfloor(e)) {

          // If the first element is zero, the BigNumber value must be zero.
          if (c[0] === 0) {
            if (e === 0 && c.length === 1) return true;
            break out;
          }

          // Calculate number of digits that c[0] should have, based on the exponent.
          i = (e + 1) % LOG_BASE;
          if (i < 1) i += LOG_BASE;

          // Calculate number of digits of c[0].
          //if (Math.ceil(Math.log(c[0] + 1) / Math.LN10) == i) {
          if (String(c[0]).length == i) {

            for (i = 0; i < c.length; i++) {
              n = c[i];
              if (n < 0 || n >= BASE || n !== mathfloor(n)) break out;
            }

            // Last element cannot be zero, unless it is the only element.
            if (n !== 0) return true;
          }
        }

      // Infinity/NaN
      } else if (c === null && e === null && (s === null || s === 1 || s === -1)) {
        return true;
      }

      throw Error
        (bignumberError + 'Invalid BigNumber: ' + v);
    };


    /*
     * Return a new BigNumber whose value is the maximum of the arguments.
     *
     * arguments {number|string|BigNumber}
     */
    BigNumber.maximum = BigNumber.max = function () {
      return maxOrMin(arguments, P.lt);
    };


    /*
     * Return a new BigNumber whose value is the minimum of the arguments.
     *
     * arguments {number|string|BigNumber}
     */
    BigNumber.minimum = BigNumber.min = function () {
      return maxOrMin(arguments, P.gt);
    };


    /*
     * Return a new BigNumber with a random value equal to or greater than 0 and less than 1,
     * and with dp, or DECIMAL_PLACES if dp is omitted, decimal places (or less if trailing
     * zeros are produced).
     *
     * [dp] {number} Decimal places. Integer, 0 to MAX inclusive.
     *
     * '[BigNumber Error] Argument {not a primitive number|not an integer|out of range}: {dp}'
     * '[BigNumber Error] crypto unavailable'
     */
    BigNumber.random = (function () {
      var pow2_53 = 0x20000000000000;

      // Return a 53 bit integer n, where 0 <= n < 9007199254740992.
      // Check if Math.random() produces more than 32 bits of randomness.
      // If it does, assume at least 53 bits are produced, otherwise assume at least 30 bits.
      // 0x40000000 is 2^30, 0x800000 is 2^23, 0x1fffff is 2^21 - 1.
      var random53bitInt = (Math.random() * pow2_53) & 0x1fffff
       ? function () { return mathfloor(Math.random() * pow2_53); }
       : function () { return ((Math.random() * 0x40000000 | 0) * 0x800000) +
         (Math.random() * 0x800000 | 0); };

      return function (dp) {
        var a, b, e, k, v,
          i = 0,
          c = [],
          rand = new BigNumber(ONE);

        if (dp == null) dp = DECIMAL_PLACES;
        else intCheck(dp, 0, MAX);

        k = mathceil(dp / LOG_BASE);

        if (CRYPTO) {

          // Browsers supporting crypto.getRandomValues.
          if (crypto.getRandomValues) {

            a = crypto.getRandomValues(new Uint32Array(k *= 2));

            for (; i < k;) {

              // 53 bits:
              // ((Math.pow(2, 32) - 1) * Math.pow(2, 21)).toString(2)
              // 11111 11111111 11111111 11111111 11100000 00000000 00000000
              // ((Math.pow(2, 32) - 1) >>> 11).toString(2)
              //                                     11111 11111111 11111111
              // 0x20000 is 2^21.
              v = a[i] * 0x20000 + (a[i + 1] >>> 11);

              // Rejection sampling:
              // 0 <= v < 9007199254740992
              // Probability that v >= 9e15, is
              // 7199254740992 / 9007199254740992 ~= 0.0008, i.e. 1 in 1251
              if (v >= 9e15) {
                b = crypto.getRandomValues(new Uint32Array(2));
                a[i] = b[0];
                a[i + 1] = b[1];
              } else {

                // 0 <= v <= 8999999999999999
                // 0 <= (v % 1e14) <= 99999999999999
                c.push(v % 1e14);
                i += 2;
              }
            }
            i = k / 2;

          // Node.js supporting crypto.randomBytes.
          } else if (crypto.randomBytes) {

            // buffer
            a = crypto.randomBytes(k *= 7);

            for (; i < k;) {

              // 0x1000000000000 is 2^48, 0x10000000000 is 2^40
              // 0x100000000 is 2^32, 0x1000000 is 2^24
              // 11111 11111111 11111111 11111111 11111111 11111111 11111111
              // 0 <= v < 9007199254740992
              v = ((a[i] & 31) * 0x1000000000000) + (a[i + 1] * 0x10000000000) +
                 (a[i + 2] * 0x100000000) + (a[i + 3] * 0x1000000) +
                 (a[i + 4] << 16) + (a[i + 5] << 8) + a[i + 6];

              if (v >= 9e15) {
                crypto.randomBytes(7).copy(a, i);
              } else {

                // 0 <= (v % 1e14) <= 99999999999999
                c.push(v % 1e14);
                i += 7;
              }
            }
            i = k / 7;
          } else {
            CRYPTO = false;
            throw Error
             (bignumberError + 'crypto unavailable');
          }
        }

        // Use Math.random.
        if (!CRYPTO) {

          for (; i < k;) {
            v = random53bitInt();
            if (v < 9e15) c[i++] = v % 1e14;
          }
        }

        k = c[--i];
        dp %= LOG_BASE;

        // Convert trailing digits to zeros according to dp.
        if (k && dp) {
          v = POWS_TEN[LOG_BASE - dp];
          c[i] = mathfloor(k / v) * v;
        }

        // Remove trailing elements which are zero.
        for (; c[i] === 0; c.pop(), i--);

        // Zero?
        if (i < 0) {
          c = [e = 0];
        } else {

          // Remove leading elements which are zero and adjust exponent accordingly.
          for (e = -1 ; c[0] === 0; c.splice(0, 1), e -= LOG_BASE);

          // Count the digits of the first element of c to determine leading zeros, and...
          for (i = 1, v = c[0]; v >= 10; v /= 10, i++);

          // adjust the exponent accordingly.
          if (i < LOG_BASE) e -= LOG_BASE - i;
        }

        rand.e = e;
        rand.c = c;
        return rand;
      };
    })();


    /*
     * Return a BigNumber whose value is the sum of the arguments.
     *
     * arguments {number|string|BigNumber}
     */
    BigNumber.sum = function () {
      var i = 1,
        args = arguments,
        sum = new BigNumber(args[0]);
      for (; i < args.length;) sum = sum.plus(args[i++]);
      return sum;
    };


    // PRIVATE FUNCTIONS


    // Called by BigNumber and BigNumber.prototype.toString.
    convertBase = (function () {
      var decimal = '0123456789';

      /*
       * Convert string of baseIn to an array of numbers of baseOut.
       * Eg. toBaseOut('255', 10, 16) returns [15, 15].
       * Eg. toBaseOut('ff', 16, 10) returns [2, 5, 5].
       */
      function toBaseOut(str, baseIn, baseOut, alphabet) {
        var j,
          arr = [0],
          arrL,
          i = 0,
          len = str.length;

        for (; i < len;) {
          for (arrL = arr.length; arrL--; arr[arrL] *= baseIn);

          arr[0] += alphabet.indexOf(str.charAt(i++));

          for (j = 0; j < arr.length; j++) {

            if (arr[j] > baseOut - 1) {
              if (arr[j + 1] == null) arr[j + 1] = 0;
              arr[j + 1] += arr[j] / baseOut | 0;
              arr[j] %= baseOut;
            }
          }
        }

        return arr.reverse();
      }

      // Convert a numeric string of baseIn to a numeric string of baseOut.
      // If the caller is toString, we are converting from base 10 to baseOut.
      // If the caller is BigNumber, we are converting from baseIn to base 10.
      return function (str, baseIn, baseOut, sign, callerIsToString) {
        var alphabet, d, e, k, r, x, xc, y,
          i = str.indexOf('.'),
          dp = DECIMAL_PLACES,
          rm = ROUNDING_MODE;

        // Non-integer.
        if (i >= 0) {
          k = POW_PRECISION;

          // Unlimited precision.
          POW_PRECISION = 0;
          str = str.replace('.', '');
          y = new BigNumber(baseIn);
          x = y.pow(str.length - i);
          POW_PRECISION = k;

          // Convert str as if an integer, then restore the fraction part by dividing the
          // result by its base raised to a power.

          y.c = toBaseOut(toFixedPoint(coeffToString(x.c), x.e, '0'),
           10, baseOut, decimal);
          y.e = y.c.length;
        }

        // Convert the number as integer.

        xc = toBaseOut(str, baseIn, baseOut, callerIsToString
         ? (alphabet = ALPHABET, decimal)
         : (alphabet = decimal, ALPHABET));

        // xc now represents str as an integer and converted to baseOut. e is the exponent.
        e = k = xc.length;

        // Remove trailing zeros.
        for (; xc[--k] == 0; xc.pop());

        // Zero?
        if (!xc[0]) return alphabet.charAt(0);

        // Does str represent an integer? If so, no need for the division.
        if (i < 0) {
          --e;
        } else {
          x.c = xc;
          x.e = e;

          // The sign is needed for correct rounding.
          x.s = sign;
          x = div(x, y, dp, rm, baseOut);
          xc = x.c;
          r = x.r;
          e = x.e;
        }

        // xc now represents str converted to baseOut.

        // THe index of the rounding digit.
        d = e + dp + 1;

        // The rounding digit: the digit to the right of the digit that may be rounded up.
        i = xc[d];

        // Look at the rounding digits and mode to determine whether to round up.

        k = baseOut / 2;
        r = r || d < 0 || xc[d + 1] != null;

        r = rm < 4 ? (i != null || r) && (rm == 0 || rm == (x.s < 0 ? 3 : 2))
              : i > k || i == k &&(rm == 4 || r || rm == 6 && xc[d - 1] & 1 ||
               rm == (x.s < 0 ? 8 : 7));

        // If the index of the rounding digit is not greater than zero, or xc represents
        // zero, then the result of the base conversion is zero or, if rounding up, a value
        // such as 0.00001.
        if (d < 1 || !xc[0]) {

          // 1^-dp or 0
          str = r ? toFixedPoint(alphabet.charAt(1), -dp, alphabet.charAt(0)) : alphabet.charAt(0);
        } else {

          // Truncate xc to the required number of decimal places.
          xc.length = d;

          // Round up?
          if (r) {

            // Rounding up may mean the previous digit has to be rounded up and so on.
            for (--baseOut; ++xc[--d] > baseOut;) {
              xc[d] = 0;

              if (!d) {
                ++e;
                xc = [1].concat(xc);
              }
            }
          }

          // Determine trailing zeros.
          for (k = xc.length; !xc[--k];);

          // E.g. [4, 11, 15] becomes 4bf.
          for (i = 0, str = ''; i <= k; str += alphabet.charAt(xc[i++]));

          // Add leading zeros, decimal point and trailing zeros as required.
          str = toFixedPoint(str, e, alphabet.charAt(0));
        }

        // The caller will add the sign.
        return str;
      };
    })();


    // Perform division in the specified base. Called by div and convertBase.
    div = (function () {

      // Assume non-zero x and k.
      function multiply(x, k, base) {
        var m, temp, xlo, xhi,
          carry = 0,
          i = x.length,
          klo = k % SQRT_BASE,
          khi = k / SQRT_BASE | 0;

        for (x = x.slice(); i--;) {
          xlo = x[i] % SQRT_BASE;
          xhi = x[i] / SQRT_BASE | 0;
          m = khi * xlo + xhi * klo;
          temp = klo * xlo + ((m % SQRT_BASE) * SQRT_BASE) + carry;
          carry = (temp / base | 0) + (m / SQRT_BASE | 0) + khi * xhi;
          x[i] = temp % base;
        }

        if (carry) x = [carry].concat(x);

        return x;
      }

      function compare(a, b, aL, bL) {
        var i, cmp;

        if (aL != bL) {
          cmp = aL > bL ? 1 : -1;
        } else {

          for (i = cmp = 0; i < aL; i++) {

            if (a[i] != b[i]) {
              cmp = a[i] > b[i] ? 1 : -1;
              break;
            }
          }
        }

        return cmp;
      }

      function subtract(a, b, aL, base) {
        var i = 0;

        // Subtract b from a.
        for (; aL--;) {
          a[aL] -= i;
          i = a[aL] < b[aL] ? 1 : 0;
          a[aL] = i * base + a[aL] - b[aL];
        }

        // Remove leading zeros.
        for (; !a[0] && a.length > 1; a.splice(0, 1));
      }

      // x: dividend, y: divisor.
      return function (x, y, dp, rm, base) {
        var cmp, e, i, more, n, prod, prodL, q, qc, rem, remL, rem0, xi, xL, yc0,
          yL, yz,
          s = x.s == y.s ? 1 : -1,
          xc = x.c,
          yc = y.c;

        // Either NaN, Infinity or 0?
        if (!xc || !xc[0] || !yc || !yc[0]) {

          return new BigNumber(

           // Return NaN if either NaN, or both Infinity or 0.
           !x.s || !y.s || (xc ? yc && xc[0] == yc[0] : !yc) ? NaN :

            // Return ±0 if x is ±0 or y is ±Infinity, or return ±Infinity as y is ±0.
            xc && xc[0] == 0 || !yc ? s * 0 : s / 0
         );
        }

        q = new BigNumber(s);
        qc = q.c = [];
        e = x.e - y.e;
        s = dp + e + 1;

        if (!base) {
          base = BASE;
          e = bitFloor(x.e / LOG_BASE) - bitFloor(y.e / LOG_BASE);
          s = s / LOG_BASE | 0;
        }

        // Result exponent may be one less then the current value of e.
        // The coefficients of the BigNumbers from convertBase may have trailing zeros.
        for (i = 0; yc[i] == (xc[i] || 0); i++);

        if (yc[i] > (xc[i] || 0)) e--;

        if (s < 0) {
          qc.push(1);
          more = true;
        } else {
          xL = xc.length;
          yL = yc.length;
          i = 0;
          s += 2;

          // Normalise xc and yc so highest order digit of yc is >= base / 2.

          n = mathfloor(base / (yc[0] + 1));

          // Not necessary, but to handle odd bases where yc[0] == (base / 2) - 1.
          // if (n > 1 || n++ == 1 && yc[0] < base / 2) {
          if (n > 1) {
            yc = multiply(yc, n, base);
            xc = multiply(xc, n, base);
            yL = yc.length;
            xL = xc.length;
          }

          xi = yL;
          rem = xc.slice(0, yL);
          remL = rem.length;

          // Add zeros to make remainder as long as divisor.
          for (; remL < yL; rem[remL++] = 0);
          yz = yc.slice();
          yz = [0].concat(yz);
          yc0 = yc[0];
          if (yc[1] >= base / 2) yc0++;
          // Not necessary, but to prevent trial digit n > base, when using base 3.
          // else if (base == 3 && yc0 == 1) yc0 = 1 + 1e-15;

          do {
            n = 0;

            // Compare divisor and remainder.
            cmp = compare(yc, rem, yL, remL);

            // If divisor < remainder.
            if (cmp < 0) {

              // Calculate trial digit, n.

              rem0 = rem[0];
              if (yL != remL) rem0 = rem0 * base + (rem[1] || 0);

              // n is how many times the divisor goes into the current remainder.
              n = mathfloor(rem0 / yc0);

              //  Algorithm:
              //  product = divisor multiplied by trial digit (n).
              //  Compare product and remainder.
              //  If product is greater than remainder:
              //    Subtract divisor from product, decrement trial digit.
              //  Subtract product from remainder.
              //  If product was less than remainder at the last compare:
              //    Compare new remainder and divisor.
              //    If remainder is greater than divisor:
              //      Subtract divisor from remainder, increment trial digit.

              if (n > 1) {

                // n may be > base only when base is 3.
                if (n >= base) n = base - 1;

                // product = divisor * trial digit.
                prod = multiply(yc, n, base);
                prodL = prod.length;
                remL = rem.length;

                // Compare product and remainder.
                // If product > remainder then trial digit n too high.
                // n is 1 too high about 5% of the time, and is not known to have
                // ever been more than 1 too high.
                while (compare(prod, rem, prodL, remL) == 1) {
                  n--;

                  // Subtract divisor from product.
                  subtract(prod, yL < prodL ? yz : yc, prodL, base);
                  prodL = prod.length;
                  cmp = 1;
                }
              } else {

                // n is 0 or 1, cmp is -1.
                // If n is 0, there is no need to compare yc and rem again below,
                // so change cmp to 1 to avoid it.
                // If n is 1, leave cmp as -1, so yc and rem are compared again.
                if (n == 0) {

                  // divisor < remainder, so n must be at least 1.
                  cmp = n = 1;
                }

                // product = divisor
                prod = yc.slice();
                prodL = prod.length;
              }

              if (prodL < remL) prod = [0].concat(prod);

              // Subtract product from remainder.
              subtract(rem, prod, remL, base);
              remL = rem.length;

               // If product was < remainder.
              if (cmp == -1) {

                // Compare divisor and new remainder.
                // If divisor < new remainder, subtract divisor from remainder.
                // Trial digit n too low.
                // n is 1 too low about 5% of the time, and very rarely 2 too low.
                while (compare(yc, rem, yL, remL) < 1) {
                  n++;

                  // Subtract divisor from remainder.
                  subtract(rem, yL < remL ? yz : yc, remL, base);
                  remL = rem.length;
                }
              }
            } else if (cmp === 0) {
              n++;
              rem = [0];
            } // else cmp === 1 and n will be 0

            // Add the next digit, n, to the result array.
            qc[i++] = n;

            // Update the remainder.
            if (rem[0]) {
              rem[remL++] = xc[xi] || 0;
            } else {
              rem = [xc[xi]];
              remL = 1;
            }
          } while ((xi++ < xL || rem[0] != null) && s--);

          more = rem[0] != null;

          // Leading zero?
          if (!qc[0]) qc.splice(0, 1);
        }

        if (base == BASE) {

          // To calculate q.e, first get the number of digits of qc[0].
          for (i = 1, s = qc[0]; s >= 10; s /= 10, i++);

          round(q, dp + (q.e = i + e * LOG_BASE - 1) + 1, rm, more);

        // Caller is convertBase.
        } else {
          q.e = e;
          q.r = +more;
        }

        return q;
      };
    })();


    /*
     * Return a string representing the value of BigNumber n in fixed-point or exponential
     * notation rounded to the specified decimal places or significant digits.
     *
     * n: a BigNumber.
     * i: the index of the last digit required (i.e. the digit that may be rounded up).
     * rm: the rounding mode.
     * id: 1 (toExponential) or 2 (toPrecision).
     */
    function format(n, i, rm, id) {
      var c0, e, ne, len, str;

      if (rm == null) rm = ROUNDING_MODE;
      else intCheck(rm, 0, 8);

      if (!n.c) return n.toString();

      c0 = n.c[0];
      ne = n.e;

      if (i == null) {
        str = coeffToString(n.c);
        str = id == 1 || id == 2 && (ne <= TO_EXP_NEG || ne >= TO_EXP_POS)
         ? toExponential(str, ne)
         : toFixedPoint(str, ne, '0');
      } else {
        n = round(new BigNumber(n), i, rm);

        // n.e may have changed if the value was rounded up.
        e = n.e;

        str = coeffToString(n.c);
        len = str.length;

        // toPrecision returns exponential notation if the number of significant digits
        // specified is less than the number of digits necessary to represent the integer
        // part of the value in fixed-point notation.

        // Exponential notation.
        if (id == 1 || id == 2 && (i <= e || e <= TO_EXP_NEG)) {

          // Append zeros?
          for (; len < i; str += '0', len++);
          str = toExponential(str, e);

        // Fixed-point notation.
        } else {
          i -= ne;
          str = toFixedPoint(str, e, '0');

          // Append zeros?
          if (e + 1 > len) {
            if (--i > 0) for (str += '.'; i--; str += '0');
          } else {
            i += e - len;
            if (i > 0) {
              if (e + 1 == len) str += '.';
              for (; i--; str += '0');
            }
          }
        }
      }

      return n.s < 0 && c0 ? '-' + str : str;
    }


    // Handle BigNumber.max and BigNumber.min.
    function maxOrMin(args, method) {
      var n,
        i = 1,
        m = new BigNumber(args[0]);

      for (; i < args.length; i++) {
        n = new BigNumber(args[i]);

        // If any number is NaN, return NaN.
        if (!n.s) {
          m = n;
          break;
        } else if (method.call(m, n)) {
          m = n;
        }
      }

      return m;
    }


    /*
     * Strip trailing zeros, calculate base 10 exponent and check against MIN_EXP and MAX_EXP.
     * Called by minus, plus and times.
     */
    function normalise(n, c, e) {
      var i = 1,
        j = c.length;

       // Remove trailing zeros.
      for (; !c[--j]; c.pop());

      // Calculate the base 10 exponent. First get the number of digits of c[0].
      for (j = c[0]; j >= 10; j /= 10, i++);

      // Overflow?
      if ((e = i + e * LOG_BASE - 1) > MAX_EXP) {

        // Infinity.
        n.c = n.e = null;

      // Underflow?
      } else if (e < MIN_EXP) {

        // Zero.
        n.c = [n.e = 0];
      } else {
        n.e = e;
        n.c = c;
      }

      return n;
    }


    // Handle values that fail the validity test in BigNumber.
    parseNumeric = (function () {
      var basePrefix = /^(-?)0([xbo])(?=\w[\w.]*$)/i,
        dotAfter = /^([^.]+)\.$/,
        dotBefore = /^\.([^.]+)$/,
        isInfinityOrNaN = /^-?(Infinity|NaN)$/,
        whitespaceOrPlus = /^\s*\+(?=[\w.])|^\s+|\s+$/g;

      return function (x, str, isNum, b) {
        var base,
          s = isNum ? str : str.replace(whitespaceOrPlus, '');

        // No exception on ±Infinity or NaN.
        if (isInfinityOrNaN.test(s)) {
          x.s = isNaN(s) ? null : s < 0 ? -1 : 1;
        } else {
          if (!isNum) {

            // basePrefix = /^(-?)0([xbo])(?=\w[\w.]*$)/i
            s = s.replace(basePrefix, function (m, p1, p2) {
              base = (p2 = p2.toLowerCase()) == 'x' ? 16 : p2 == 'b' ? 2 : 8;
              return !b || b == base ? p1 : m;
            });

            if (b) {
              base = b;

              // E.g. '1.' to '1', '.1' to '0.1'
              s = s.replace(dotAfter, '$1').replace(dotBefore, '0.$1');
            }

            if (str != s) return new BigNumber(s, base);
          }

          // '[BigNumber Error] Not a number: {n}'
          // '[BigNumber Error] Not a base {b} number: {n}'
          if (BigNumber.DEBUG) {
            throw Error
              (bignumberError + 'Not a' + (b ? ' base ' + b : '') + ' number: ' + str);
          }

          // NaN
          x.s = null;
        }

        x.c = x.e = null;
      }
    })();


    /*
     * Round x to sd significant digits using rounding mode rm. Check for over/under-flow.
     * If r is truthy, it is known that there are more digits after the rounding digit.
     */
    function round(x, sd, rm, r) {
      var d, i, j, k, n, ni, rd,
        xc = x.c,
        pows10 = POWS_TEN;

      // if x is not Infinity or NaN...
      if (xc) {

        // rd is the rounding digit, i.e. the digit after the digit that may be rounded up.
        // n is a base 1e14 number, the value of the element of array x.c containing rd.
        // ni is the index of n within x.c.
        // d is the number of digits of n.
        // i is the index of rd within n including leading zeros.
        // j is the actual index of rd within n (if < 0, rd is a leading zero).
        out: {

          // Get the number of digits of the first element of xc.
          for (d = 1, k = xc[0]; k >= 10; k /= 10, d++);
          i = sd - d;

          // If the rounding digit is in the first element of xc...
          if (i < 0) {
            i += LOG_BASE;
            j = sd;
            n = xc[ni = 0];

            // Get the rounding digit at index j of n.
            rd = n / pows10[d - j - 1] % 10 | 0;
          } else {
            ni = mathceil((i + 1) / LOG_BASE);

            if (ni >= xc.length) {

              if (r) {

                // Needed by sqrt.
                for (; xc.length <= ni; xc.push(0));
                n = rd = 0;
                d = 1;
                i %= LOG_BASE;
                j = i - LOG_BASE + 1;
              } else {
                break out;
              }
            } else {
              n = k = xc[ni];

              // Get the number of digits of n.
              for (d = 1; k >= 10; k /= 10, d++);

              // Get the index of rd within n.
              i %= LOG_BASE;

              // Get the index of rd within n, adjusted for leading zeros.
              // The number of leading zeros of n is given by LOG_BASE - d.
              j = i - LOG_BASE + d;

              // Get the rounding digit at index j of n.
              rd = j < 0 ? 0 : n / pows10[d - j - 1] % 10 | 0;
            }
          }

          r = r || sd < 0 ||

          // Are there any non-zero digits after the rounding digit?
          // The expression  n % pows10[d - j - 1]  returns all digits of n to the right
          // of the digit at j, e.g. if n is 908714 and j is 2, the expression gives 714.
           xc[ni + 1] != null || (j < 0 ? n : n % pows10[d - j - 1]);

          r = rm < 4
           ? (rd || r) && (rm == 0 || rm == (x.s < 0 ? 3 : 2))
           : rd > 5 || rd == 5 && (rm == 4 || r || rm == 6 &&

            // Check whether the digit to the left of the rounding digit is odd.
            ((i > 0 ? j > 0 ? n / pows10[d - j] : 0 : xc[ni - 1]) % 10) & 1 ||
             rm == (x.s < 0 ? 8 : 7));

          if (sd < 1 || !xc[0]) {
            xc.length = 0;

            if (r) {

              // Convert sd to decimal places.
              sd -= x.e + 1;

              // 1, 0.1, 0.01, 0.001, 0.0001 etc.
              xc[0] = pows10[(LOG_BASE - sd % LOG_BASE) % LOG_BASE];
              x.e = -sd || 0;
            } else {

              // Zero.
              xc[0] = x.e = 0;
            }

            return x;
          }

          // Remove excess digits.
          if (i == 0) {
            xc.length = ni;
            k = 1;
            ni--;
          } else {
            xc.length = ni + 1;
            k = pows10[LOG_BASE - i];

            // E.g. 56700 becomes 56000 if 7 is the rounding digit.
            // j > 0 means i > number of leading zeros of n.
            xc[ni] = j > 0 ? mathfloor(n / pows10[d - j] % pows10[j]) * k : 0;
          }

          // Round up?
          if (r) {

            for (; ;) {

              // If the digit to be rounded up is in the first element of xc...
              if (ni == 0) {

                // i will be the length of xc[0] before k is added.
                for (i = 1, j = xc[0]; j >= 10; j /= 10, i++);
                j = xc[0] += k;
                for (k = 1; j >= 10; j /= 10, k++);

                // if i != k the length has increased.
                if (i != k) {
                  x.e++;
                  if (xc[0] == BASE) xc[0] = 1;
                }

                break;
              } else {
                xc[ni] += k;
                if (xc[ni] != BASE) break;
                xc[ni--] = 0;
                k = 1;
              }
            }
          }

          // Remove trailing zeros.
          for (i = xc.length; xc[--i] === 0; xc.pop());
        }

        // Overflow? Infinity.
        if (x.e > MAX_EXP) {
          x.c = x.e = null;

        // Underflow? Zero.
        } else if (x.e < MIN_EXP) {
          x.c = [x.e = 0];
        }
      }

      return x;
    }


    function valueOf(n) {
      var str,
        e = n.e;

      if (e === null) return n.toString();

      str = coeffToString(n.c);

      str = e <= TO_EXP_NEG || e >= TO_EXP_POS
        ? toExponential(str, e)
        : toFixedPoint(str, e, '0');

      return n.s < 0 ? '-' + str : str;
    }


    // PROTOTYPE/INSTANCE METHODS


    /*
     * Return a new BigNumber whose value is the absolute value of this BigNumber.
     */
    P.absoluteValue = P.abs = function () {
      var x = new BigNumber(this);
      if (x.s < 0) x.s = 1;
      return x;
    };


    /*
     * Return
     *   1 if the value of this BigNumber is greater than the value of BigNumber(y, b),
     *   -1 if the value of this BigNumber is less than the value of BigNumber(y, b),
     *   0 if they have the same value,
     *   or null if the value of either is NaN.
     */
    P.comparedTo = function (y, b) {
      return compare(this, new BigNumber(y, b));
    };


    /*
     * If dp is undefined or null or true or false, return the number of decimal places of the
     * value of this BigNumber, or null if the value of this BigNumber is ±Infinity or NaN.
     *
     * Otherwise, if dp is a number, return a new BigNumber whose value is the value of this
     * BigNumber rounded to a maximum of dp decimal places using rounding mode rm, or
     * ROUNDING_MODE if rm is omitted.
     *
     * [dp] {number} Decimal places: integer, 0 to MAX inclusive.
     * [rm] {number} Rounding mode. Integer, 0 to 8 inclusive.
     *
     * '[BigNumber Error] Argument {not a primitive number|not an integer|out of range}: {dp|rm}'
     */
    P.decimalPlaces = P.dp = function (dp, rm) {
      var c, n, v,
        x = this;

      if (dp != null) {
        intCheck(dp, 0, MAX);
        if (rm == null) rm = ROUNDING_MODE;
        else intCheck(rm, 0, 8);

        return round(new BigNumber(x), dp + x.e + 1, rm);
      }

      if (!(c = x.c)) return null;
      n = ((v = c.length - 1) - bitFloor(this.e / LOG_BASE)) * LOG_BASE;

      // Subtract the number of trailing zeros of the last number.
      if (v = c[v]) for (; v % 10 == 0; v /= 10, n--);
      if (n < 0) n = 0;

      return n;
    };


    /*
     *  n / 0 = I
     *  n / N = N
     *  n / I = 0
     *  0 / n = 0
     *  0 / 0 = N
     *  0 / N = N
     *  0 / I = 0
     *  N / n = N
     *  N / 0 = N
     *  N / N = N
     *  N / I = N
     *  I / n = I
     *  I / 0 = I
     *  I / N = N
     *  I / I = N
     *
     * Return a new BigNumber whose value is the value of this BigNumber divided by the value of
     * BigNumber(y, b), rounded according to DECIMAL_PLACES and ROUNDING_MODE.
     */
    P.dividedBy = P.div = function (y, b) {
      return div(this, new BigNumber(y, b), DECIMAL_PLACES, ROUNDING_MODE);
    };


    /*
     * Return a new BigNumber whose value is the integer part of dividing the value of this
     * BigNumber by the value of BigNumber(y, b).
     */
    P.dividedToIntegerBy = P.idiv = function (y, b) {
      return div(this, new BigNumber(y, b), 0, 1);
    };


    /*
     * Return a BigNumber whose value is the value of this BigNumber exponentiated by n.
     *
     * If m is present, return the result modulo m.
     * If n is negative round according to DECIMAL_PLACES and ROUNDING_MODE.
     * If POW_PRECISION is non-zero and m is not present, round to POW_PRECISION using ROUNDING_MODE.
     *
     * The modular power operation works efficiently when x, n, and m are integers, otherwise it
     * is equivalent to calculating x.exponentiatedBy(n).modulo(m) with a POW_PRECISION of 0.
     *
     * n {number|string|BigNumber} The exponent. An integer.
     * [m] {number|string|BigNumber} The modulus.
     *
     * '[BigNumber Error] Exponent not an integer: {n}'
     */
    P.exponentiatedBy = P.pow = function (n, m) {
      var half, isModExp, i, k, more, nIsBig, nIsNeg, nIsOdd, y,
        x = this;

      n = new BigNumber(n);

      // Allow NaN and ±Infinity, but not other non-integers.
      if (n.c && !n.isInteger()) {
        throw Error
          (bignumberError + 'Exponent not an integer: ' + valueOf(n));
      }

      if (m != null) m = new BigNumber(m);

      // Exponent of MAX_SAFE_INTEGER is 15.
      nIsBig = n.e > 14;

      // If x is NaN, ±Infinity, ±0 or ±1, or n is ±Infinity, NaN or ±0.
      if (!x.c || !x.c[0] || x.c[0] == 1 && !x.e && x.c.length == 1 || !n.c || !n.c[0]) {

        // The sign of the result of pow when x is negative depends on the evenness of n.
        // If +n overflows to ±Infinity, the evenness of n would be not be known.
        y = new BigNumber(Math.pow(+valueOf(x), nIsBig ? 2 - isOdd(n) : +valueOf(n)));
        return m ? y.mod(m) : y;
      }

      nIsNeg = n.s < 0;

      if (m) {

        // x % m returns NaN if abs(m) is zero, or m is NaN.
        if (m.c ? !m.c[0] : !m.s) return new BigNumber(NaN);

        isModExp = !nIsNeg && x.isInteger() && m.isInteger();

        if (isModExp) x = x.mod(m);

      // Overflow to ±Infinity: >=2**1e10 or >=1.0000024**1e15.
      // Underflow to ±0: <=0.79**1e10 or <=0.9999975**1e15.
      } else if (n.e > 9 && (x.e > 0 || x.e < -1 || (x.e == 0
        // [1, 240000000]
        ? x.c[0] > 1 || nIsBig && x.c[1] >= 24e7
        // [80000000000000]  [99999750000000]
        : x.c[0] < 8e13 || nIsBig && x.c[0] <= 9999975e7))) {

        // If x is negative and n is odd, k = -0, else k = 0.
        k = x.s < 0 && isOdd(n) ? -0 : 0;

        // If x >= 1, k = ±Infinity.
        if (x.e > -1) k = 1 / k;

        // If n is negative return ±0, else return ±Infinity.
        return new BigNumber(nIsNeg ? 1 / k : k);

      } else if (POW_PRECISION) {

        // Truncating each coefficient array to a length of k after each multiplication
        // equates to truncating significant digits to POW_PRECISION + [28, 41],
        // i.e. there will be a minimum of 28 guard digits retained.
        k = mathceil(POW_PRECISION / LOG_BASE + 2);
      }

      if (nIsBig) {
        half = new BigNumber(0.5);
        if (nIsNeg) n.s = 1;
        nIsOdd = isOdd(n);
      } else {
        i = Math.abs(+valueOf(n));
        nIsOdd = i % 2;
      }

      y = new BigNumber(ONE);

      // Performs 54 loop iterations for n of 9007199254740991.
      for (; ;) {

        if (nIsOdd) {
          y = y.times(x);
          if (!y.c) break;

          if (k) {
            if (y.c.length > k) y.c.length = k;
          } else if (isModExp) {
            y = y.mod(m);    //y = y.minus(div(y, m, 0, MODULO_MODE).times(m));
          }
        }

        if (i) {
          i = mathfloor(i / 2);
          if (i === 0) break;
          nIsOdd = i % 2;
        } else {
          n = n.times(half);
          round(n, n.e + 1, 1);

          if (n.e > 14) {
            nIsOdd = isOdd(n);
          } else {
            i = +valueOf(n);
            if (i === 0) break;
            nIsOdd = i % 2;
          }
        }

        x = x.times(x);

        if (k) {
          if (x.c && x.c.length > k) x.c.length = k;
        } else if (isModExp) {
          x = x.mod(m);    //x = x.minus(div(x, m, 0, MODULO_MODE).times(m));
        }
      }

      if (isModExp) return y;
      if (nIsNeg) y = ONE.div(y);

      return m ? y.mod(m) : k ? round(y, POW_PRECISION, ROUNDING_MODE, more) : y;
    };


    /*
     * Return a new BigNumber whose value is the value of this BigNumber rounded to an integer
     * using rounding mode rm, or ROUNDING_MODE if rm is omitted.
     *
     * [rm] {number} Rounding mode. Integer, 0 to 8 inclusive.
     *
     * '[BigNumber Error] Argument {not a primitive number|not an integer|out of range}: {rm}'
     */
    P.integerValue = function (rm) {
      var n = new BigNumber(this);
      if (rm == null) rm = ROUNDING_MODE;
      else intCheck(rm, 0, 8);
      return round(n, n.e + 1, rm);
    };


    /*
     * Return true if the value of this BigNumber is equal to the value of BigNumber(y, b),
     * otherwise return false.
     */
    P.isEqualTo = P.eq = function (y, b) {
      return compare(this, new BigNumber(y, b)) === 0;
    };


    /*
     * Return true if the value of this BigNumber is a finite number, otherwise return false.
     */
    P.isFinite = function () {
      return !!this.c;
    };


    /*
     * Return true if the value of this BigNumber is greater than the value of BigNumber(y, b),
     * otherwise return false.
     */
    P.isGreaterThan = P.gt = function (y, b) {
      return compare(this, new BigNumber(y, b)) > 0;
    };


    /*
     * Return true if the value of this BigNumber is greater than or equal to the value of
     * BigNumber(y, b), otherwise return false.
     */
    P.isGreaterThanOrEqualTo = P.gte = function (y, b) {
      return (b = compare(this, new BigNumber(y, b))) === 1 || b === 0;

    };


    /*
     * Return true if the value of this BigNumber is an integer, otherwise return false.
     */
    P.isInteger = function () {
      return !!this.c && bitFloor(this.e / LOG_BASE) > this.c.length - 2;
    };


    /*
     * Return true if the value of this BigNumber is less than the value of BigNumber(y, b),
     * otherwise return false.
     */
    P.isLessThan = P.lt = function (y, b) {
      return compare(this, new BigNumber(y, b)) < 0;
    };


    /*
     * Return true if the value of this BigNumber is less than or equal to the value of
     * BigNumber(y, b), otherwise return false.
     */
    P.isLessThanOrEqualTo = P.lte = function (y, b) {
      return (b = compare(this, new BigNumber(y, b))) === -1 || b === 0;
    };


    /*
     * Return true if the value of this BigNumber is NaN, otherwise return false.
     */
    P.isNaN = function () {
      return !this.s;
    };


    /*
     * Return true if the value of this BigNumber is negative, otherwise return false.
     */
    P.isNegative = function () {
      return this.s < 0;
    };


    /*
     * Return true if the value of this BigNumber is positive, otherwise return false.
     */
    P.isPositive = function () {
      return this.s > 0;
    };


    /*
     * Return true if the value of this BigNumber is 0 or -0, otherwise return false.
     */
    P.isZero = function () {
      return !!this.c && this.c[0] == 0;
    };


    /*
     *  n - 0 = n
     *  n - N = N
     *  n - I = -I
     *  0 - n = -n
     *  0 - 0 = 0
     *  0 - N = N
     *  0 - I = -I
     *  N - n = N
     *  N - 0 = N
     *  N - N = N
     *  N - I = N
     *  I - n = I
     *  I - 0 = I
     *  I - N = N
     *  I - I = N
     *
     * Return a new BigNumber whose value is the value of this BigNumber minus the value of
     * BigNumber(y, b).
     */
    P.minus = function (y, b) {
      var i, j, t, xLTy,
        x = this,
        a = x.s;

      y = new BigNumber(y, b);
      b = y.s;

      // Either NaN?
      if (!a || !b) return new BigNumber(NaN);

      // Signs differ?
      if (a != b) {
        y.s = -b;
        return x.plus(y);
      }

      var xe = x.e / LOG_BASE,
        ye = y.e / LOG_BASE,
        xc = x.c,
        yc = y.c;

      if (!xe || !ye) {

        // Either Infinity?
        if (!xc || !yc) return xc ? (y.s = -b, y) : new BigNumber(yc ? x : NaN);

        // Either zero?
        if (!xc[0] || !yc[0]) {

          // Return y if y is non-zero, x if x is non-zero, or zero if both are zero.
          return yc[0] ? (y.s = -b, y) : new BigNumber(xc[0] ? x :

           // IEEE 754 (2008) 6.3: n - n = -0 when rounding to -Infinity
           ROUNDING_MODE == 3 ? -0 : 0);
        }
      }

      xe = bitFloor(xe);
      ye = bitFloor(ye);
      xc = xc.slice();

      // Determine which is the bigger number.
      if (a = xe - ye) {

        if (xLTy = a < 0) {
          a = -a;
          t = xc;
        } else {
          ye = xe;
          t = yc;
        }

        t.reverse();

        // Prepend zeros to equalise exponents.
        for (b = a; b--; t.push(0));
        t.reverse();
      } else {

        // Exponents equal. Check digit by digit.
        j = (xLTy = (a = xc.length) < (b = yc.length)) ? a : b;

        for (a = b = 0; b < j; b++) {

          if (xc[b] != yc[b]) {
            xLTy = xc[b] < yc[b];
            break;
          }
        }
      }

      // x < y? Point xc to the array of the bigger number.
      if (xLTy) t = xc, xc = yc, yc = t, y.s = -y.s;

      b = (j = yc.length) - (i = xc.length);

      // Append zeros to xc if shorter.
      // No need to add zeros to yc if shorter as subtract only needs to start at yc.length.
      if (b > 0) for (; b--; xc[i++] = 0);
      b = BASE - 1;

      // Subtract yc from xc.
      for (; j > a;) {

        if (xc[--j] < yc[j]) {
          for (i = j; i && !xc[--i]; xc[i] = b);
          --xc[i];
          xc[j] += BASE;
        }

        xc[j] -= yc[j];
      }

      // Remove leading zeros and adjust exponent accordingly.
      for (; xc[0] == 0; xc.splice(0, 1), --ye);

      // Zero?
      if (!xc[0]) {

        // Following IEEE 754 (2008) 6.3,
        // n - n = +0  but  n - n = -0  when rounding towards -Infinity.
        y.s = ROUNDING_MODE == 3 ? -1 : 1;
        y.c = [y.e = 0];
        return y;
      }

      // No need to check for Infinity as +x - +y != Infinity && -x - -y != Infinity
      // for finite x and y.
      return normalise(y, xc, ye);
    };


    /*
     *   n % 0 =  N
     *   n % N =  N
     *   n % I =  n
     *   0 % n =  0
     *  -0 % n = -0
     *   0 % 0 =  N
     *   0 % N =  N
     *   0 % I =  0
     *   N % n =  N
     *   N % 0 =  N
     *   N % N =  N
     *   N % I =  N
     *   I % n =  N
     *   I % 0 =  N
     *   I % N =  N
     *   I % I =  N
     *
     * Return a new BigNumber whose value is the value of this BigNumber modulo the value of
     * BigNumber(y, b). The result depends on the value of MODULO_MODE.
     */
    P.modulo = P.mod = function (y, b) {
      var q, s,
        x = this;

      y = new BigNumber(y, b);

      // Return NaN if x is Infinity or NaN, or y is NaN or zero.
      if (!x.c || !y.s || y.c && !y.c[0]) {
        return new BigNumber(NaN);

      // Return x if y is Infinity or x is zero.
      } else if (!y.c || x.c && !x.c[0]) {
        return new BigNumber(x);
      }

      if (MODULO_MODE == 9) {

        // Euclidian division: q = sign(y) * floor(x / abs(y))
        // r = x - qy    where  0 <= r < abs(y)
        s = y.s;
        y.s = 1;
        q = div(x, y, 0, 3);
        y.s = s;
        q.s *= s;
      } else {
        q = div(x, y, 0, MODULO_MODE);
      }

      y = x.minus(q.times(y));

      // To match JavaScript %, ensure sign of zero is sign of dividend.
      if (!y.c[0] && MODULO_MODE == 1) y.s = x.s;

      return y;
    };


    /*
     *  n * 0 = 0
     *  n * N = N
     *  n * I = I
     *  0 * n = 0
     *  0 * 0 = 0
     *  0 * N = N
     *  0 * I = N
     *  N * n = N
     *  N * 0 = N
     *  N * N = N
     *  N * I = N
     *  I * n = I
     *  I * 0 = N
     *  I * N = N
     *  I * I = I
     *
     * Return a new BigNumber whose value is the value of this BigNumber multiplied by the value
     * of BigNumber(y, b).
     */
    P.multipliedBy = P.times = function (y, b) {
      var c, e, i, j, k, m, xcL, xlo, xhi, ycL, ylo, yhi, zc,
        base, sqrtBase,
        x = this,
        xc = x.c,
        yc = (y = new BigNumber(y, b)).c;

      // Either NaN, ±Infinity or ±0?
      if (!xc || !yc || !xc[0] || !yc[0]) {

        // Return NaN if either is NaN, or one is 0 and the other is Infinity.
        if (!x.s || !y.s || xc && !xc[0] && !yc || yc && !yc[0] && !xc) {
          y.c = y.e = y.s = null;
        } else {
          y.s *= x.s;

          // Return ±Infinity if either is ±Infinity.
          if (!xc || !yc) {
            y.c = y.e = null;

          // Return ±0 if either is ±0.
          } else {
            y.c = [0];
            y.e = 0;
          }
        }

        return y;
      }

      e = bitFloor(x.e / LOG_BASE) + bitFloor(y.e / LOG_BASE);
      y.s *= x.s;
      xcL = xc.length;
      ycL = yc.length;

      // Ensure xc points to longer array and xcL to its length.
      if (xcL < ycL) zc = xc, xc = yc, yc = zc, i = xcL, xcL = ycL, ycL = i;

      // Initialise the result array with zeros.
      for (i = xcL + ycL, zc = []; i--; zc.push(0));

      base = BASE;
      sqrtBase = SQRT_BASE;

      for (i = ycL; --i >= 0;) {
        c = 0;
        ylo = yc[i] % sqrtBase;
        yhi = yc[i] / sqrtBase | 0;

        for (k = xcL, j = i + k; j > i;) {
          xlo = xc[--k] % sqrtBase;
          xhi = xc[k] / sqrtBase | 0;
          m = yhi * xlo + xhi * ylo;
          xlo = ylo * xlo + ((m % sqrtBase) * sqrtBase) + zc[j] + c;
          c = (xlo / base | 0) + (m / sqrtBase | 0) + yhi * xhi;
          zc[j--] = xlo % base;
        }

        zc[j] = c;
      }

      if (c) {
        ++e;
      } else {
        zc.splice(0, 1);
      }

      return normalise(y, zc, e);
    };


    /*
     * Return a new BigNumber whose value is the value of this BigNumber negated,
     * i.e. multiplied by -1.
     */
    P.negated = function () {
      var x = new BigNumber(this);
      x.s = -x.s || null;
      return x;
    };


    /*
     *  n + 0 = n
     *  n + N = N
     *  n + I = I
     *  0 + n = n
     *  0 + 0 = 0
     *  0 + N = N
     *  0 + I = I
     *  N + n = N
     *  N + 0 = N
     *  N + N = N
     *  N + I = N
     *  I + n = I
     *  I + 0 = I
     *  I + N = N
     *  I + I = I
     *
     * Return a new BigNumber whose value is the value of this BigNumber plus the value of
     * BigNumber(y, b).
     */
    P.plus = function (y, b) {
      var t,
        x = this,
        a = x.s;

      y = new BigNumber(y, b);
      b = y.s;

      // Either NaN?
      if (!a || !b) return new BigNumber(NaN);

      // Signs differ?
       if (a != b) {
        y.s = -b;
        return x.minus(y);
      }

      var xe = x.e / LOG_BASE,
        ye = y.e / LOG_BASE,
        xc = x.c,
        yc = y.c;

      if (!xe || !ye) {

        // Return ±Infinity if either ±Infinity.
        if (!xc || !yc) return new BigNumber(a / 0);

        // Either zero?
        // Return y if y is non-zero, x if x is non-zero, or zero if both are zero.
        if (!xc[0] || !yc[0]) return yc[0] ? y : new BigNumber(xc[0] ? x : a * 0);
      }

      xe = bitFloor(xe);
      ye = bitFloor(ye);
      xc = xc.slice();

      // Prepend zeros to equalise exponents. Faster to use reverse then do unshifts.
      if (a = xe - ye) {
        if (a > 0) {
          ye = xe;
          t = yc;
        } else {
          a = -a;
          t = xc;
        }

        t.reverse();
        for (; a--; t.push(0));
        t.reverse();
      }

      a = xc.length;
      b = yc.length;

      // Point xc to the longer array, and b to the shorter length.
      if (a - b < 0) t = yc, yc = xc, xc = t, b = a;

      // Only start adding at yc.length - 1 as the further digits of xc can be ignored.
      for (a = 0; b;) {
        a = (xc[--b] = xc[b] + yc[b] + a) / BASE | 0;
        xc[b] = BASE === xc[b] ? 0 : xc[b] % BASE;
      }

      if (a) {
        xc = [a].concat(xc);
        ++ye;
      }

      // No need to check for zero, as +x + +y != 0 && -x + -y != 0
      // ye = MAX_EXP + 1 possible
      return normalise(y, xc, ye);
    };


    /*
     * If sd is undefined or null or true or false, return the number of significant digits of
     * the value of this BigNumber, or null if the value of this BigNumber is ±Infinity or NaN.
     * If sd is true include integer-part trailing zeros in the count.
     *
     * Otherwise, if sd is a number, return a new BigNumber whose value is the value of this
     * BigNumber rounded to a maximum of sd significant digits using rounding mode rm, or
     * ROUNDING_MODE if rm is omitted.
     *
     * sd {number|boolean} number: significant digits: integer, 1 to MAX inclusive.
     *                     boolean: whether to count integer-part trailing zeros: true or false.
     * [rm] {number} Rounding mode. Integer, 0 to 8 inclusive.
     *
     * '[BigNumber Error] Argument {not a primitive number|not an integer|out of range}: {sd|rm}'
     */
    P.precision = P.sd = function (sd, rm) {
      var c, n, v,
        x = this;

      if (sd != null && sd !== !!sd) {
        intCheck(sd, 1, MAX);
        if (rm == null) rm = ROUNDING_MODE;
        else intCheck(rm, 0, 8);

        return round(new BigNumber(x), sd, rm);
      }

      if (!(c = x.c)) return null;
      v = c.length - 1;
      n = v * LOG_BASE + 1;

      if (v = c[v]) {

        // Subtract the number of trailing zeros of the last element.
        for (; v % 10 == 0; v /= 10, n--);

        // Add the number of digits of the first element.
        for (v = c[0]; v >= 10; v /= 10, n++);
      }

      if (sd && x.e + 1 > n) n = x.e + 1;

      return n;
    };


    /*
     * Return a new BigNumber whose value is the value of this BigNumber shifted by k places
     * (powers of 10). Shift to the right if n > 0, and to the left if n < 0.
     *
     * k {number} Integer, -MAX_SAFE_INTEGER to MAX_SAFE_INTEGER inclusive.
     *
     * '[BigNumber Error] Argument {not a primitive number|not an integer|out of range}: {k}'
     */
    P.shiftedBy = function (k) {
      intCheck(k, -MAX_SAFE_INTEGER, MAX_SAFE_INTEGER);
      return this.times('1e' + k);
    };


    /*
     *  sqrt(-n) =  N
     *  sqrt(N) =  N
     *  sqrt(-I) =  N
     *  sqrt(I) =  I
     *  sqrt(0) =  0
     *  sqrt(-0) = -0
     *
     * Return a new BigNumber whose value is the square root of the value of this BigNumber,
     * rounded according to DECIMAL_PLACES and ROUNDING_MODE.
     */
    P.squareRoot = P.sqrt = function () {
      var m, n, r, rep, t,
        x = this,
        c = x.c,
        s = x.s,
        e = x.e,
        dp = DECIMAL_PLACES + 4,
        half = new BigNumber('0.5');

      // Negative/NaN/Infinity/zero?
      if (s !== 1 || !c || !c[0]) {
        return new BigNumber(!s || s < 0 && (!c || c[0]) ? NaN : c ? x : 1 / 0);
      }

      // Initial estimate.
      s = Math.sqrt(+valueOf(x));

      // Math.sqrt underflow/overflow?
      // Pass x to Math.sqrt as integer, then adjust the exponent of the result.
      if (s == 0 || s == 1 / 0) {
        n = coeffToString(c);
        if ((n.length + e) % 2 == 0) n += '0';
        s = Math.sqrt(+n);
        e = bitFloor((e + 1) / 2) - (e < 0 || e % 2);

        if (s == 1 / 0) {
          n = '5e' + e;
        } else {
          n = s.toExponential();
          n = n.slice(0, n.indexOf('e') + 1) + e;
        }

        r = new BigNumber(n);
      } else {
        r = new BigNumber(s + '');
      }

      // Check for zero.
      // r could be zero if MIN_EXP is changed after the this value was created.
      // This would cause a division by zero (x/t) and hence Infinity below, which would cause
      // coeffToString to throw.
      if (r.c[0]) {
        e = r.e;
        s = e + dp;
        if (s < 3) s = 0;

        // Newton-Raphson iteration.
        for (; ;) {
          t = r;
          r = half.times(t.plus(div(x, t, dp, 1)));

          if (coeffToString(t.c).slice(0, s) === (n = coeffToString(r.c)).slice(0, s)) {

            // The exponent of r may here be one less than the final result exponent,
            // e.g 0.0009999 (e-4) --> 0.001 (e-3), so adjust s so the rounding digits
            // are indexed correctly.
            if (r.e < e) --s;
            n = n.slice(s - 3, s + 1);

            // The 4th rounding digit may be in error by -1 so if the 4 rounding digits
            // are 9999 or 4999 (i.e. approaching a rounding boundary) continue the
            // iteration.
            if (n == '9999' || !rep && n == '4999') {

              // On the first iteration only, check to see if rounding up gives the
              // exact result as the nines may infinitely repeat.
              if (!rep) {
                round(t, t.e + DECIMAL_PLACES + 2, 0);

                if (t.times(t).eq(x)) {
                  r = t;
                  break;
                }
              }

              dp += 4;
              s += 4;
              rep = 1;
            } else {

              // If rounding digits are null, 0{0,4} or 50{0,3}, check for exact
              // result. If not, then there are further digits and m will be truthy.
              if (!+n || !+n.slice(1) && n.charAt(0) == '5') {

                // Truncate to the first rounding digit.
                round(r, r.e + DECIMAL_PLACES + 2, 1);
                m = !r.times(r).eq(x);
              }

              break;
            }
          }
        }
      }

      return round(r, r.e + DECIMAL_PLACES + 1, ROUNDING_MODE, m);
    };


    /*
     * Return a string representing the value of this BigNumber in exponential notation and
     * rounded using ROUNDING_MODE to dp fixed decimal places.
     *
     * [dp] {number} Decimal places. Integer, 0 to MAX inclusive.
     * [rm] {number} Rounding mode. Integer, 0 to 8 inclusive.
     *
     * '[BigNumber Error] Argument {not a primitive number|not an integer|out of range}: {dp|rm}'
     */
    P.toExponential = function (dp, rm) {
      if (dp != null) {
        intCheck(dp, 0, MAX);
        dp++;
      }
      return format(this, dp, rm, 1);
    };


    /*
     * Return a string representing the value of this BigNumber in fixed-point notation rounding
     * to dp fixed decimal places using rounding mode rm, or ROUNDING_MODE if rm is omitted.
     *
     * Note: as with JavaScript's number type, (-0).toFixed(0) is '0',
     * but e.g. (-0.00001).toFixed(0) is '-0'.
     *
     * [dp] {number} Decimal places. Integer, 0 to MAX inclusive.
     * [rm] {number} Rounding mode. Integer, 0 to 8 inclusive.
     *
     * '[BigNumber Error] Argument {not a primitive number|not an integer|out of range}: {dp|rm}'
     */
    P.toFixed = function (dp, rm) {
      if (dp != null) {
        intCheck(dp, 0, MAX);
        dp = dp + this.e + 1;
      }
      return format(this, dp, rm);
    };


    /*
     * Return a string representing the value of this BigNumber in fixed-point notation rounded
     * using rm or ROUNDING_MODE to dp decimal places, and formatted according to the properties
     * of the format or FORMAT object (see BigNumber.set).
     *
     * The formatting object may contain some or all of the properties shown below.
     *
     * FORMAT = {
     *   prefix: '',
     *   groupSize: 3,
     *   secondaryGroupSize: 0,
     *   groupSeparator: ',',
     *   decimalSeparator: '.',
     *   fractionGroupSize: 0,
     *   fractionGroupSeparator: '\xA0',      // non-breaking space
     *   suffix: ''
     * };
     *
     * [dp] {number} Decimal places. Integer, 0 to MAX inclusive.
     * [rm] {number} Rounding mode. Integer, 0 to 8 inclusive.
     * [format] {object} Formatting options. See FORMAT pbject above.
     *
     * '[BigNumber Error] Argument {not a primitive number|not an integer|out of range}: {dp|rm}'
     * '[BigNumber Error] Argument not an object: {format}'
     */
    P.toFormat = function (dp, rm, format) {
      var str,
        x = this;

      if (format == null) {
        if (dp != null && rm && typeof rm == 'object') {
          format = rm;
          rm = null;
        } else if (dp && typeof dp == 'object') {
          format = dp;
          dp = rm = null;
        } else {
          format = FORMAT;
        }
      } else if (typeof format != 'object') {
        throw Error
          (bignumberError + 'Argument not an object: ' + format);
      }

      str = x.toFixed(dp, rm);

      if (x.c) {
        var i,
          arr = str.split('.'),
          g1 = +format.groupSize,
          g2 = +format.secondaryGroupSize,
          groupSeparator = format.groupSeparator || '',
          intPart = arr[0],
          fractionPart = arr[1],
          isNeg = x.s < 0,
          intDigits = isNeg ? intPart.slice(1) : intPart,
          len = intDigits.length;

        if (g2) i = g1, g1 = g2, g2 = i, len -= i;

        if (g1 > 0 && len > 0) {
          i = len % g1 || g1;
          intPart = intDigits.substr(0, i);
          for (; i < len; i += g1) intPart += groupSeparator + intDigits.substr(i, g1);
          if (g2 > 0) intPart += groupSeparator + intDigits.slice(i);
          if (isNeg) intPart = '-' + intPart;
        }

        str = fractionPart
         ? intPart + (format.decimalSeparator || '') + ((g2 = +format.fractionGroupSize)
          ? fractionPart.replace(new RegExp('\\d{' + g2 + '}\\B', 'g'),
           '$&' + (format.fractionGroupSeparator || ''))
          : fractionPart)
         : intPart;
      }

      return (format.prefix || '') + str + (format.suffix || '');
    };


    /*
     * Return an array of two BigNumbers representing the value of this BigNumber as a simple
     * fraction with an integer numerator and an integer denominator.
     * The denominator will be a positive non-zero value less than or equal to the specified
     * maximum denominator. If a maximum denominator is not specified, the denominator will be
     * the lowest value necessary to represent the number exactly.
     *
     * [md] {number|string|BigNumber} Integer >= 1, or Infinity. The maximum denominator.
     *
     * '[BigNumber Error] Argument {not an integer|out of range} : {md}'
     */
    P.toFraction = function (md) {
      var d, d0, d1, d2, e, exp, n, n0, n1, q, r, s,
        x = this,
        xc = x.c;

      if (md != null) {
        n = new BigNumber(md);

        // Throw if md is less than one or is not an integer, unless it is Infinity.
        if (!n.isInteger() && (n.c || n.s !== 1) || n.lt(ONE)) {
          throw Error
            (bignumberError + 'Argument ' +
              (n.isInteger() ? 'out of range: ' : 'not an integer: ') + valueOf(n));
        }
      }

      if (!xc) return new BigNumber(x);

      d = new BigNumber(ONE);
      n1 = d0 = new BigNumber(ONE);
      d1 = n0 = new BigNumber(ONE);
      s = coeffToString(xc);

      // Determine initial denominator.
      // d is a power of 10 and the minimum max denominator that specifies the value exactly.
      e = d.e = s.length - x.e - 1;
      d.c[0] = POWS_TEN[(exp = e % LOG_BASE) < 0 ? LOG_BASE + exp : exp];
      md = !md || n.comparedTo(d) > 0 ? (e > 0 ? d : n1) : n;

      exp = MAX_EXP;
      MAX_EXP = 1 / 0;
      n = new BigNumber(s);

      // n0 = d1 = 0
      n0.c[0] = 0;

      for (; ;)  {
        q = div(n, d, 0, 1);
        d2 = d0.plus(q.times(d1));
        if (d2.comparedTo(md) == 1) break;
        d0 = d1;
        d1 = d2;
        n1 = n0.plus(q.times(d2 = n1));
        n0 = d2;
        d = n.minus(q.times(d2 = d));
        n = d2;
      }

      d2 = div(md.minus(d0), d1, 0, 1);
      n0 = n0.plus(d2.times(n1));
      d0 = d0.plus(d2.times(d1));
      n0.s = n1.s = x.s;
      e = e * 2;

      // Determine which fraction is closer to x, n0/d0 or n1/d1
      r = div(n1, d1, e, ROUNDING_MODE).minus(x).abs().comparedTo(
          div(n0, d0, e, ROUNDING_MODE).minus(x).abs()) < 1 ? [n1, d1] : [n0, d0];

      MAX_EXP = exp;

      return r;
    };


    /*
     * Return the value of this BigNumber converted to a number primitive.
     */
    P.toNumber = function () {
      return +valueOf(this);
    };


    /*
     * Return a string representing the value of this BigNumber rounded to sd significant digits
     * using rounding mode rm or ROUNDING_MODE. If sd is less than the number of digits
     * necessary to represent the integer part of the value in fixed-point notation, then use
     * exponential notation.
     *
     * [sd] {number} Significant digits. Integer, 1 to MAX inclusive.
     * [rm] {number} Rounding mode. Integer, 0 to 8 inclusive.
     *
     * '[BigNumber Error] Argument {not a primitive number|not an integer|out of range}: {sd|rm}'
     */
    P.toPrecision = function (sd, rm) {
      if (sd != null) intCheck(sd, 1, MAX);
      return format(this, sd, rm, 2);
    };


    /*
     * Return a string representing the value of this BigNumber in base b, or base 10 if b is
     * omitted. If a base is specified, including base 10, round according to DECIMAL_PLACES and
     * ROUNDING_MODE. If a base is not specified, and this BigNumber has a positive exponent
     * that is equal to or greater than TO_EXP_POS, or a negative exponent equal to or less than
     * TO_EXP_NEG, return exponential notation.
     *
     * [b] {number} Integer, 2 to ALPHABET.length inclusive.
     *
     * '[BigNumber Error] Base {not a primitive number|not an integer|out of range}: {b}'
     */
    P.toString = function (b) {
      var str,
        n = this,
        s = n.s,
        e = n.e;

      // Infinity or NaN?
      if (e === null) {
        if (s) {
          str = 'Infinity';
          if (s < 0) str = '-' + str;
        } else {
          str = 'NaN';
        }
      } else {
        if (b == null) {
          str = e <= TO_EXP_NEG || e >= TO_EXP_POS
           ? toExponential(coeffToString(n.c), e)
           : toFixedPoint(coeffToString(n.c), e, '0');
        } else if (b === 10 && alphabetHasNormalDecimalDigits) {
          n = round(new BigNumber(n), DECIMAL_PLACES + e + 1, ROUNDING_MODE);
          str = toFixedPoint(coeffToString(n.c), n.e, '0');
        } else {
          intCheck(b, 2, ALPHABET.length, 'Base');
          str = convertBase(toFixedPoint(coeffToString(n.c), e, '0'), 10, b, s, true);
        }

        if (s < 0 && n.c[0]) str = '-' + str;
      }

      return str;
    };


    /*
     * Return as toString, but do not accept a base argument, and include the minus sign for
     * negative zero.
     */
    P.valueOf = P.toJSON = function () {
      return valueOf(this);
    };


    P._isBigNumber = true;

    if (configObject != null) BigNumber.set(configObject);

    return BigNumber;
  }


  // PRIVATE HELPER FUNCTIONS

  // These functions don't need access to variables,
  // e.g. DECIMAL_PLACES, in the scope of the `clone` function above.


  function bitFloor(n) {
    var i = n | 0;
    return n > 0 || n === i ? i : i - 1;
  }


  // Return a coefficient array as a string of base 10 digits.
  function coeffToString(a) {
    var s, z,
      i = 1,
      j = a.length,
      r = a[0] + '';

    for (; i < j;) {
      s = a[i++] + '';
      z = LOG_BASE - s.length;
      for (; z--; s = '0' + s);
      r += s;
    }

    // Determine trailing zeros.
    for (j = r.length; r.charCodeAt(--j) === 48;);

    return r.slice(0, j + 1 || 1);
  }


  // Compare the value of BigNumbers x and y.
  function compare(x, y) {
    var a, b,
      xc = x.c,
      yc = y.c,
      i = x.s,
      j = y.s,
      k = x.e,
      l = y.e;

    // Either NaN?
    if (!i || !j) return null;

    a = xc && !xc[0];
    b = yc && !yc[0];

    // Either zero?
    if (a || b) return a ? b ? 0 : -j : i;

    // Signs differ?
    if (i != j) return i;

    a = i < 0;
    b = k == l;

    // Either Infinity?
    if (!xc || !yc) return b ? 0 : !xc ^ a ? 1 : -1;

    // Compare exponents.
    if (!b) return k > l ^ a ? 1 : -1;

    j = (k = xc.length) < (l = yc.length) ? k : l;

    // Compare digit by digit.
    for (i = 0; i < j; i++) if (xc[i] != yc[i]) return xc[i] > yc[i] ^ a ? 1 : -1;

    // Compare lengths.
    return k == l ? 0 : k > l ^ a ? 1 : -1;
  }


  /*
   * Check that n is a primitive number, an integer, and in range, otherwise throw.
   */
  function intCheck(n, min, max, name) {
    if (n < min || n > max || n !== mathfloor(n)) {
      throw Error
       (bignumberError + (name || 'Argument') + (typeof n == 'number'
         ? n < min || n > max ? ' out of range: ' : ' not an integer: '
         : ' not a primitive number: ') + String(n));
    }
  }


  // Assumes finite n.
  function isOdd(n) {
    var k = n.c.length - 1;
    return bitFloor(n.e / LOG_BASE) == k && n.c[k] % 2 != 0;
  }


  function toExponential(str, e) {
    return (str.length > 1 ? str.charAt(0) + '.' + str.slice(1) : str) +
     (e < 0 ? 'e' : 'e+') + e;
  }


  function toFixedPoint(str, e, z) {
    var len, zs;

    // Negative exponent?
    if (e < 0) {

      // Prepend zeros.
      for (zs = z + '.'; ++e; zs += z);
      str = zs + str;

    // Positive exponent
    } else {
      len = str.length;

      // Append zeros.
      if (++e > len) {
        for (zs = z, e -= len; --e; zs += z);
        str += zs;
      } else if (e < len) {
        str = str.slice(0, e) + '.' + str.slice(e);
      }
    }

    return str;
  }


  // EXPORT


  BigNumber = clone();
  BigNumber['default'] = BigNumber.BigNumber = BigNumber;

  // AMD.
  if (true) {
    !(__WEBPACK_AMD_DEFINE_RESULT__ = (function () { return BigNumber; }).call(exports, __webpack_require__, exports, module),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

  // Node.js and other environments that support module.exports.
  } else {}
})(this);


/***/ }),

/***/ "907a":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var ArrayBufferViewCore = __webpack_require__("ebb5");
var lengthOfArrayLike = __webpack_require__("07fa");
var toIntegerOrInfinity = __webpack_require__("5926");

var aTypedArray = ArrayBufferViewCore.aTypedArray;
var exportTypedArrayMethod = ArrayBufferViewCore.exportTypedArrayMethod;

// `%TypedArray%.prototype.at` method
// https://github.com/tc39/proposal-relative-indexing-method
exportTypedArrayMethod('at', function at(index) {
  var O = aTypedArray(this);
  var len = lengthOfArrayLike(O);
  var relativeIndex = toIntegerOrInfinity(index);
  var k = relativeIndex >= 0 ? relativeIndex : len + relativeIndex;
  return (k < 0 || k >= len) ? undefined : O[k];
});


/***/ }),

/***/ "90e3":
/***/ (function(module, exports, __webpack_require__) {

var uncurryThis = __webpack_require__("e330");

var id = 0;
var postfix = Math.random();
var toString = uncurryThis(1.0.toString);

module.exports = function (key) {
  return 'Symbol(' + (key === undefined ? '' : key) + ')_' + toString(++id + postfix, 36);
};


/***/ }),

/***/ "9112":
/***/ (function(module, exports, __webpack_require__) {

var DESCRIPTORS = __webpack_require__("83ab");
var definePropertyModule = __webpack_require__("9bf2");
var createPropertyDescriptor = __webpack_require__("5c6c");

module.exports = DESCRIPTORS ? function (object, key, value) {
  return definePropertyModule.f(object, key, createPropertyDescriptor(1, value));
} : function (object, key, value) {
  object[key] = value;
  return object;
};


/***/ }),

/***/ "9129":
/***/ (function(module, exports, __webpack_require__) {

var $ = __webpack_require__("23e7");

// `Number.isNaN` method
// https://tc39.es/ecma262/#sec-number.isnan
$({ target: 'Number', stat: true }, {
  isNaN: function isNaN(number) {
    // eslint-disable-next-line no-self-compare -- NaN check
    return number != number;
  }
});


/***/ }),

/***/ "9152":
/***/ (function(module, exports) {

/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
exports.read = function (buffer, offset, isLE, mLen, nBytes) {
  var e, m
  var eLen = (nBytes * 8) - mLen - 1
  var eMax = (1 << eLen) - 1
  var eBias = eMax >> 1
  var nBits = -7
  var i = isLE ? (nBytes - 1) : 0
  var d = isLE ? -1 : 1
  var s = buffer[offset + i]

  i += d

  e = s & ((1 << (-nBits)) - 1)
  s >>= (-nBits)
  nBits += eLen
  for (; nBits > 0; e = (e * 256) + buffer[offset + i], i += d, nBits -= 8) {}

  m = e & ((1 << (-nBits)) - 1)
  e >>= (-nBits)
  nBits += mLen
  for (; nBits > 0; m = (m * 256) + buffer[offset + i], i += d, nBits -= 8) {}

  if (e === 0) {
    e = 1 - eBias
  } else if (e === eMax) {
    return m ? NaN : ((s ? -1 : 1) * Infinity)
  } else {
    m = m + Math.pow(2, mLen)
    e = e - eBias
  }
  return (s ? -1 : 1) * m * Math.pow(2, e - mLen)
}

exports.write = function (buffer, value, offset, isLE, mLen, nBytes) {
  var e, m, c
  var eLen = (nBytes * 8) - mLen - 1
  var eMax = (1 << eLen) - 1
  var eBias = eMax >> 1
  var rt = (mLen === 23 ? Math.pow(2, -24) - Math.pow(2, -77) : 0)
  var i = isLE ? 0 : (nBytes - 1)
  var d = isLE ? 1 : -1
  var s = value < 0 || (value === 0 && 1 / value < 0) ? 1 : 0

  value = Math.abs(value)

  if (isNaN(value) || value === Infinity) {
    m = isNaN(value) ? 1 : 0
    e = eMax
  } else {
    e = Math.floor(Math.log(value) / Math.LN2)
    if (value * (c = Math.pow(2, -e)) < 1) {
      e--
      c *= 2
    }
    if (e + eBias >= 1) {
      value += rt / c
    } else {
      value += rt * Math.pow(2, 1 - eBias)
    }
    if (value * c >= 2) {
      e++
      c /= 2
    }

    if (e + eBias >= eMax) {
      m = 0
      e = eMax
    } else if (e + eBias >= 1) {
      m = ((value * c) - 1) * Math.pow(2, mLen)
      e = e + eBias
    } else {
      m = value * Math.pow(2, eBias - 1) * Math.pow(2, mLen)
      e = 0
    }
  }

  for (; mLen >= 8; buffer[offset + i] = m & 0xff, i += d, m /= 256, mLen -= 8) {}

  e = (e << mLen) | m
  eLen += mLen
  for (; eLen > 0; buffer[offset + i] = e & 0xff, i += d, e /= 256, eLen -= 8) {}

  buffer[offset + i - d] |= s * 128
}


/***/ }),

/***/ "9263":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

/* eslint-disable regexp/no-empty-capturing-group, regexp/no-empty-group, regexp/no-lazy-ends -- testing */
/* eslint-disable regexp/no-useless-quantifier -- testing */
var call = __webpack_require__("c65b");
var uncurryThis = __webpack_require__("e330");
var toString = __webpack_require__("577e");
var regexpFlags = __webpack_require__("ad6d");
var stickyHelpers = __webpack_require__("9f7f");
var shared = __webpack_require__("5692");
var create = __webpack_require__("7c73");
var getInternalState = __webpack_require__("69f3").get;
var UNSUPPORTED_DOT_ALL = __webpack_require__("fce3");
var UNSUPPORTED_NCG = __webpack_require__("107c");

var nativeReplace = shared('native-string-replace', String.prototype.replace);
var nativeExec = RegExp.prototype.exec;
var patchedExec = nativeExec;
var charAt = uncurryThis(''.charAt);
var indexOf = uncurryThis(''.indexOf);
var replace = uncurryThis(''.replace);
var stringSlice = uncurryThis(''.slice);

var UPDATES_LAST_INDEX_WRONG = (function () {
  var re1 = /a/;
  var re2 = /b*/g;
  call(nativeExec, re1, 'a');
  call(nativeExec, re2, 'a');
  return re1.lastIndex !== 0 || re2.lastIndex !== 0;
})();

var UNSUPPORTED_Y = stickyHelpers.UNSUPPORTED_Y || stickyHelpers.BROKEN_CARET;

// nonparticipating capturing group, copied from es5-shim's String#split patch.
var NPCG_INCLUDED = /()??/.exec('')[1] !== undefined;

var PATCH = UPDATES_LAST_INDEX_WRONG || NPCG_INCLUDED || UNSUPPORTED_Y || UNSUPPORTED_DOT_ALL || UNSUPPORTED_NCG;

if (PATCH) {
  // eslint-disable-next-line max-statements -- TODO
  patchedExec = function exec(string) {
    var re = this;
    var state = getInternalState(re);
    var str = toString(string);
    var raw = state.raw;
    var result, reCopy, lastIndex, match, i, object, group;

    if (raw) {
      raw.lastIndex = re.lastIndex;
      result = call(patchedExec, raw, str);
      re.lastIndex = raw.lastIndex;
      return result;
    }

    var groups = state.groups;
    var sticky = UNSUPPORTED_Y && re.sticky;
    var flags = call(regexpFlags, re);
    var source = re.source;
    var charsAdded = 0;
    var strCopy = str;

    if (sticky) {
      flags = replace(flags, 'y', '');
      if (indexOf(flags, 'g') === -1) {
        flags += 'g';
      }

      strCopy = stringSlice(str, re.lastIndex);
      // Support anchored sticky behavior.
      if (re.lastIndex > 0 && (!re.multiline || re.multiline && charAt(str, re.lastIndex - 1) !== '\n')) {
        source = '(?: ' + source + ')';
        strCopy = ' ' + strCopy;
        charsAdded++;
      }
      // ^(? + rx + ) is needed, in combination with some str slicing, to
      // simulate the 'y' flag.
      reCopy = new RegExp('^(?:' + source + ')', flags);
    }

    if (NPCG_INCLUDED) {
      reCopy = new RegExp('^' + source + '$(?!\\s)', flags);
    }
    if (UPDATES_LAST_INDEX_WRONG) lastIndex = re.lastIndex;

    match = call(nativeExec, sticky ? reCopy : re, strCopy);

    if (sticky) {
      if (match) {
        match.input = stringSlice(match.input, charsAdded);
        match[0] = stringSlice(match[0], charsAdded);
        match.index = re.lastIndex;
        re.lastIndex += match[0].length;
      } else re.lastIndex = 0;
    } else if (UPDATES_LAST_INDEX_WRONG && match) {
      re.lastIndex = re.global ? match.index + match[0].length : lastIndex;
    }
    if (NPCG_INCLUDED && match && match.length > 1) {
      // Fix browsers whose `exec` methods don't consistently return `undefined`
      // for NPCG, like IE8. NOTE: This doesn' work for /(.?)?/
      call(nativeReplace, match[0], reCopy, function () {
        for (i = 1; i < arguments.length - 2; i++) {
          if (arguments[i] === undefined) match[i] = undefined;
        }
      });
    }

    if (match && groups) {
      match.groups = object = create(null);
      for (i = 0; i < groups.length; i++) {
        group = groups[i];
        object[group[0]] = match[group[1]];
      }
    }

    return match;
  };
}

module.exports = patchedExec;


/***/ }),

/***/ "93e1":
/***/ (function(module, exports, __webpack_require__) {

// Imports
var ___CSS_LOADER_API_IMPORT___ = __webpack_require__("24fb");
exports = ___CSS_LOADER_API_IMPORT___(false);
// Module
exports.push([module.i, ".line-content[data-v-3fd5e29c]{position:absolute;pointer-events:auto;z-index:30;top:0;left:0;width:auto;height:auto;background-color:rgba(0,0,0,.5);overflow:hidden}.line-content[data-v-3fd5e29c] .el-button--small{padding:0;border:0;border-radius:0}.line-content .line-item[data-v-3fd5e29c]{display:inline-block;border:0;position:absolute}.line-content .line-item .vdr[data-v-3fd5e29c]{border:0 dashed #000}.line-content .line-item .vdr[data-v-3fd5e29c]:focus,.line-content .line-item .vdr[data-v-3fd5e29c]:hover{border:1px dashed #000}", ""]);
// Exports
module.exports = exports;


/***/ }),

/***/ "94ca":
/***/ (function(module, exports, __webpack_require__) {

var fails = __webpack_require__("d039");
var isCallable = __webpack_require__("1626");

var replacement = /#|\.prototype\./;

var isForced = function (feature, detection) {
  var value = data[normalize(feature)];
  return value == POLYFILL ? true
    : value == NATIVE ? false
    : isCallable(detection) ? fails(detection)
    : !!detection;
};

var normalize = isForced.normalize = function (string) {
  return String(string).replace(replacement, '.').toLowerCase();
};

var data = isForced.data = {};
var NATIVE = isForced.NATIVE = 'N';
var POLYFILL = isForced.POLYFILL = 'P';

module.exports = isForced;


/***/ }),

/***/ "94eb":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return ERRORTYPES; });
/* harmony import */ var core_js_modules_es_function_name_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("b0c0");
/* harmony import */ var core_js_modules_es_function_name_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_es_function_name_js__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var core_js_modules_es_object_to_string_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__("d3b7");
/* harmony import */ var core_js_modules_es_object_to_string_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_es_object_to_string_js__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var core_js_modules_es_regexp_to_string_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__("25f0");
/* harmony import */ var core_js_modules_es_regexp_to_string_js__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_es_regexp_to_string_js__WEBPACK_IMPORTED_MODULE_2__);




// Copyright 2015-2018 FormBucket LLC
// List of errors in the spreadsheet system
function FormulaError(name, message) {
  this.name = name || 'NotImplementedError';
  this.message = message || '';
}

FormulaError.prototype = Error.prototype;

FormulaError.prototype.toString = function () {
  return this.name;
};

var nil = new FormulaError('#NULL!', 'Null reference'),
    div0 = new FormulaError('#DIV/0!', 'Divide by zero'),
    value = new FormulaError('#VALUE!', 'Invalid value'),
    ref = new FormulaError('#REF!', 'Invalid reference'),
    name = new FormulaError('#NAME?', 'Invalid name'),
    num = new FormulaError('#NUM!', 'Invalid number'),
    na = new FormulaError('#N/A!', 'Not applicable'),
    error = new FormulaError('#ERROR!', 'Error'),
    data = new FormulaError('#GETTING_DATA!', 'Error getting data'),
    missing = new FormulaError('#MISSING!', 'Missing'),
    unknown = new FormulaError('#UNKNOWN!', 'Unknown error');
var ERRORTYPES = {
  nil: nil,
  '#NULL!': nil,
  div0: div0,
  '#DIV/0!': div0,
  value: value,
  '#VALUE!': value,
  ref: ref,
  '#REF!': ref,
  name: name,
  '#NAME?': name,
  num: num,
  '#NUM!': num,
  na: na,
  '#N/A!': na,
  error: error,
  '#ERROR!': error,
  data: data,
  '#GETTING_DATA!': data,
  missing: missing,
  '#MISSING!': missing,
  unknown: unknown,
  '#UNKNOWN!': unknown
};
missing;

function _error(type) {
  return ERRORTYPES[type] || error;
}

/* harmony default export */ __webpack_exports__["b"] = (_error);

/***/ }),

/***/ "96cf":
/***/ (function(module, exports) {

/**
 * Copyright (c) 2014-present, Facebook, Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */

!(function(global) {
  "use strict";

  var Op = Object.prototype;
  var hasOwn = Op.hasOwnProperty;
  var undefined; // More compressible than void 0.
  var $Symbol = typeof Symbol === "function" ? Symbol : {};
  var iteratorSymbol = $Symbol.iterator || "@@iterator";
  var asyncIteratorSymbol = $Symbol.asyncIterator || "@@asyncIterator";
  var toStringTagSymbol = $Symbol.toStringTag || "@@toStringTag";

  var inModule = typeof module === "object";
  var runtime = global.regeneratorRuntime;
  if (runtime) {
    if (inModule) {
      // If regeneratorRuntime is defined globally and we're in a module,
      // make the exports object identical to regeneratorRuntime.
      module.exports = runtime;
    }
    // Don't bother evaluating the rest of this file if the runtime was
    // already defined globally.
    return;
  }

  // Define the runtime globally (as expected by generated code) as either
  // module.exports (if we're in a module) or a new, empty object.
  runtime = global.regeneratorRuntime = inModule ? module.exports : {};

  function wrap(innerFn, outerFn, self, tryLocsList) {
    // If outerFn provided and outerFn.prototype is a Generator, then outerFn.prototype instanceof Generator.
    var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator;
    var generator = Object.create(protoGenerator.prototype);
    var context = new Context(tryLocsList || []);

    // The ._invoke method unifies the implementations of the .next,
    // .throw, and .return methods.
    generator._invoke = makeInvokeMethod(innerFn, self, context);

    return generator;
  }
  runtime.wrap = wrap;

  // Try/catch helper to minimize deoptimizations. Returns a completion
  // record like context.tryEntries[i].completion. This interface could
  // have been (and was previously) designed to take a closure to be
  // invoked without arguments, but in all the cases we care about we
  // already have an existing method we want to call, so there's no need
  // to create a new function object. We can even get away with assuming
  // the method takes exactly one argument, since that happens to be true
  // in every case, so we don't have to touch the arguments object. The
  // only additional allocation required is the completion record, which
  // has a stable shape and so hopefully should be cheap to allocate.
  function tryCatch(fn, obj, arg) {
    try {
      return { type: "normal", arg: fn.call(obj, arg) };
    } catch (err) {
      return { type: "throw", arg: err };
    }
  }

  var GenStateSuspendedStart = "suspendedStart";
  var GenStateSuspendedYield = "suspendedYield";
  var GenStateExecuting = "executing";
  var GenStateCompleted = "completed";

  // Returning this object from the innerFn has the same effect as
  // breaking out of the dispatch switch statement.
  var ContinueSentinel = {};

  // Dummy constructor functions that we use as the .constructor and
  // .constructor.prototype properties for functions that return Generator
  // objects. For full spec compliance, you may wish to configure your
  // minifier not to mangle the names of these two functions.
  function Generator() {}
  function GeneratorFunction() {}
  function GeneratorFunctionPrototype() {}

  // This is a polyfill for %IteratorPrototype% for environments that
  // don't natively support it.
  var IteratorPrototype = {};
  IteratorPrototype[iteratorSymbol] = function () {
    return this;
  };

  var getProto = Object.getPrototypeOf;
  var NativeIteratorPrototype = getProto && getProto(getProto(values([])));
  if (NativeIteratorPrototype &&
      NativeIteratorPrototype !== Op &&
      hasOwn.call(NativeIteratorPrototype, iteratorSymbol)) {
    // This environment has a native %IteratorPrototype%; use it instead
    // of the polyfill.
    IteratorPrototype = NativeIteratorPrototype;
  }

  var Gp = GeneratorFunctionPrototype.prototype =
    Generator.prototype = Object.create(IteratorPrototype);
  GeneratorFunction.prototype = Gp.constructor = GeneratorFunctionPrototype;
  GeneratorFunctionPrototype.constructor = GeneratorFunction;
  GeneratorFunctionPrototype[toStringTagSymbol] =
    GeneratorFunction.displayName = "GeneratorFunction";

  // Helper for defining the .next, .throw, and .return methods of the
  // Iterator interface in terms of a single ._invoke method.
  function defineIteratorMethods(prototype) {
    ["next", "throw", "return"].forEach(function(method) {
      prototype[method] = function(arg) {
        return this._invoke(method, arg);
      };
    });
  }

  runtime.isGeneratorFunction = function(genFun) {
    var ctor = typeof genFun === "function" && genFun.constructor;
    return ctor
      ? ctor === GeneratorFunction ||
        // For the native GeneratorFunction constructor, the best we can
        // do is to check its .name property.
        (ctor.displayName || ctor.name) === "GeneratorFunction"
      : false;
  };

  runtime.mark = function(genFun) {
    if (Object.setPrototypeOf) {
      Object.setPrototypeOf(genFun, GeneratorFunctionPrototype);
    } else {
      genFun.__proto__ = GeneratorFunctionPrototype;
      if (!(toStringTagSymbol in genFun)) {
        genFun[toStringTagSymbol] = "GeneratorFunction";
      }
    }
    genFun.prototype = Object.create(Gp);
    return genFun;
  };

  // Within the body of any async function, `await x` is transformed to
  // `yield regeneratorRuntime.awrap(x)`, so that the runtime can test
  // `hasOwn.call(value, "__await")` to determine if the yielded value is
  // meant to be awaited.
  runtime.awrap = function(arg) {
    return { __await: arg };
  };

  function AsyncIterator(generator) {
    function invoke(method, arg, resolve, reject) {
      var record = tryCatch(generator[method], generator, arg);
      if (record.type === "throw") {
        reject(record.arg);
      } else {
        var result = record.arg;
        var value = result.value;
        if (value &&
            typeof value === "object" &&
            hasOwn.call(value, "__await")) {
          return Promise.resolve(value.__await).then(function(value) {
            invoke("next", value, resolve, reject);
          }, function(err) {
            invoke("throw", err, resolve, reject);
          });
        }

        return Promise.resolve(value).then(function(unwrapped) {
          // When a yielded Promise is resolved, its final value becomes
          // the .value of the Promise<{value,done}> result for the
          // current iteration. If the Promise is rejected, however, the
          // result for this iteration will be rejected with the same
          // reason. Note that rejections of yielded Promises are not
          // thrown back into the generator function, as is the case
          // when an awaited Promise is rejected. This difference in
          // behavior between yield and await is important, because it
          // allows the consumer to decide what to do with the yielded
          // rejection (swallow it and continue, manually .throw it back
          // into the generator, abandon iteration, whatever). With
          // await, by contrast, there is no opportunity to examine the
          // rejection reason outside the generator function, so the
          // only option is to throw it from the await expression, and
          // let the generator function handle the exception.
          result.value = unwrapped;
          resolve(result);
        }, reject);
      }
    }

    var previousPromise;

    function enqueue(method, arg) {
      function callInvokeWithMethodAndArg() {
        return new Promise(function(resolve, reject) {
          invoke(method, arg, resolve, reject);
        });
      }

      return previousPromise =
        // If enqueue has been called before, then we want to wait until
        // all previous Promises have been resolved before calling invoke,
        // so that results are always delivered in the correct order. If
        // enqueue has not been called before, then it is important to
        // call invoke immediately, without waiting on a callback to fire,
        // so that the async generator function has the opportunity to do
        // any necessary setup in a predictable way. This predictability
        // is why the Promise constructor synchronously invokes its
        // executor callback, and why async functions synchronously
        // execute code before the first await. Since we implement simple
        // async functions in terms of async generators, it is especially
        // important to get this right, even though it requires care.
        previousPromise ? previousPromise.then(
          callInvokeWithMethodAndArg,
          // Avoid propagating failures to Promises returned by later
          // invocations of the iterator.
          callInvokeWithMethodAndArg
        ) : callInvokeWithMethodAndArg();
    }

    // Define the unified helper method that is used to implement .next,
    // .throw, and .return (see defineIteratorMethods).
    this._invoke = enqueue;
  }

  defineIteratorMethods(AsyncIterator.prototype);
  AsyncIterator.prototype[asyncIteratorSymbol] = function () {
    return this;
  };
  runtime.AsyncIterator = AsyncIterator;

  // Note that simple async functions are implemented on top of
  // AsyncIterator objects; they just return a Promise for the value of
  // the final result produced by the iterator.
  runtime.async = function(innerFn, outerFn, self, tryLocsList) {
    var iter = new AsyncIterator(
      wrap(innerFn, outerFn, self, tryLocsList)
    );

    return runtime.isGeneratorFunction(outerFn)
      ? iter // If outerFn is a generator, return the full iterator.
      : iter.next().then(function(result) {
          return result.done ? result.value : iter.next();
        });
  };

  function makeInvokeMethod(innerFn, self, context) {
    var state = GenStateSuspendedStart;

    return function invoke(method, arg) {
      if (state === GenStateExecuting) {
        throw new Error("Generator is already running");
      }

      if (state === GenStateCompleted) {
        if (method === "throw") {
          throw arg;
        }

        // Be forgiving, per 25.3.3.3.3 of the spec:
        // https://people.mozilla.org/~jorendorff/es6-draft.html#sec-generatorresume
        return doneResult();
      }

      context.method = method;
      context.arg = arg;

      while (true) {
        var delegate = context.delegate;
        if (delegate) {
          var delegateResult = maybeInvokeDelegate(delegate, context);
          if (delegateResult) {
            if (delegateResult === ContinueSentinel) continue;
            return delegateResult;
          }
        }

        if (context.method === "next") {
          // Setting context._sent for legacy support of Babel's
          // function.sent implementation.
          context.sent = context._sent = context.arg;

        } else if (context.method === "throw") {
          if (state === GenStateSuspendedStart) {
            state = GenStateCompleted;
            throw context.arg;
          }

          context.dispatchException(context.arg);

        } else if (context.method === "return") {
          context.abrupt("return", context.arg);
        }

        state = GenStateExecuting;

        var record = tryCatch(innerFn, self, context);
        if (record.type === "normal") {
          // If an exception is thrown from innerFn, we leave state ===
          // GenStateExecuting and loop back for another invocation.
          state = context.done
            ? GenStateCompleted
            : GenStateSuspendedYield;

          if (record.arg === ContinueSentinel) {
            continue;
          }

          return {
            value: record.arg,
            done: context.done
          };

        } else if (record.type === "throw") {
          state = GenStateCompleted;
          // Dispatch the exception by looping back around to the
          // context.dispatchException(context.arg) call above.
          context.method = "throw";
          context.arg = record.arg;
        }
      }
    };
  }

  // Call delegate.iterator[context.method](context.arg) and handle the
  // result, either by returning a { value, done } result from the
  // delegate iterator, or by modifying context.method and context.arg,
  // setting context.delegate to null, and returning the ContinueSentinel.
  function maybeInvokeDelegate(delegate, context) {
    var method = delegate.iterator[context.method];
    if (method === undefined) {
      // A .throw or .return when the delegate iterator has no .throw
      // method always terminates the yield* loop.
      context.delegate = null;

      if (context.method === "throw") {
        if (delegate.iterator.return) {
          // If the delegate iterator has a return method, give it a
          // chance to clean up.
          context.method = "return";
          context.arg = undefined;
          maybeInvokeDelegate(delegate, context);

          if (context.method === "throw") {
            // If maybeInvokeDelegate(context) changed context.method from
            // "return" to "throw", let that override the TypeError below.
            return ContinueSentinel;
          }
        }

        context.method = "throw";
        context.arg = new TypeError(
          "The iterator does not provide a 'throw' method");
      }

      return ContinueSentinel;
    }

    var record = tryCatch(method, delegate.iterator, context.arg);

    if (record.type === "throw") {
      context.method = "throw";
      context.arg = record.arg;
      context.delegate = null;
      return ContinueSentinel;
    }

    var info = record.arg;

    if (! info) {
      context.method = "throw";
      context.arg = new TypeError("iterator result is not an object");
      context.delegate = null;
      return ContinueSentinel;
    }

    if (info.done) {
      // Assign the result of the finished delegate to the temporary
      // variable specified by delegate.resultName (see delegateYield).
      context[delegate.resultName] = info.value;

      // Resume execution at the desired location (see delegateYield).
      context.next = delegate.nextLoc;

      // If context.method was "throw" but the delegate handled the
      // exception, let the outer generator proceed normally. If
      // context.method was "next", forget context.arg since it has been
      // "consumed" by the delegate iterator. If context.method was
      // "return", allow the original .return call to continue in the
      // outer generator.
      if (context.method !== "return") {
        context.method = "next";
        context.arg = undefined;
      }

    } else {
      // Re-yield the result returned by the delegate method.
      return info;
    }

    // The delegate iterator is finished, so forget it and continue with
    // the outer generator.
    context.delegate = null;
    return ContinueSentinel;
  }

  // Define Generator.prototype.{next,throw,return} in terms of the
  // unified ._invoke helper method.
  defineIteratorMethods(Gp);

  Gp[toStringTagSymbol] = "Generator";

  // A Generator should always return itself as the iterator object when the
  // @@iterator function is called on it. Some browsers' implementations of the
  // iterator prototype chain incorrectly implement this, causing the Generator
  // object to not be returned from this call. This ensures that doesn't happen.
  // See https://github.com/facebook/regenerator/issues/274 for more details.
  Gp[iteratorSymbol] = function() {
    return this;
  };

  Gp.toString = function() {
    return "[object Generator]";
  };

  function pushTryEntry(locs) {
    var entry = { tryLoc: locs[0] };

    if (1 in locs) {
      entry.catchLoc = locs[1];
    }

    if (2 in locs) {
      entry.finallyLoc = locs[2];
      entry.afterLoc = locs[3];
    }

    this.tryEntries.push(entry);
  }

  function resetTryEntry(entry) {
    var record = entry.completion || {};
    record.type = "normal";
    delete record.arg;
    entry.completion = record;
  }

  function Context(tryLocsList) {
    // The root entry object (effectively a try statement without a catch
    // or a finally block) gives us a place to store values thrown from
    // locations where there is no enclosing try statement.
    this.tryEntries = [{ tryLoc: "root" }];
    tryLocsList.forEach(pushTryEntry, this);
    this.reset(true);
  }

  runtime.keys = function(object) {
    var keys = [];
    for (var key in object) {
      keys.push(key);
    }
    keys.reverse();

    // Rather than returning an object with a next method, we keep
    // things simple and return the next function itself.
    return function next() {
      while (keys.length) {
        var key = keys.pop();
        if (key in object) {
          next.value = key;
          next.done = false;
          return next;
        }
      }

      // To avoid creating an additional object, we just hang the .value
      // and .done properties off the next function object itself. This
      // also ensures that the minifier will not anonymize the function.
      next.done = true;
      return next;
    };
  };

  function values(iterable) {
    if (iterable) {
      var iteratorMethod = iterable[iteratorSymbol];
      if (iteratorMethod) {
        return iteratorMethod.call(iterable);
      }

      if (typeof iterable.next === "function") {
        return iterable;
      }

      if (!isNaN(iterable.length)) {
        var i = -1, next = function next() {
          while (++i < iterable.length) {
            if (hasOwn.call(iterable, i)) {
              next.value = iterable[i];
              next.done = false;
              return next;
            }
          }

          next.value = undefined;
          next.done = true;

          return next;
        };

        return next.next = next;
      }
    }

    // Return an iterator with no values.
    return { next: doneResult };
  }
  runtime.values = values;

  function doneResult() {
    return { value: undefined, done: true };
  }

  Context.prototype = {
    constructor: Context,

    reset: function(skipTempReset) {
      this.prev = 0;
      this.next = 0;
      // Resetting context._sent for legacy support of Babel's
      // function.sent implementation.
      this.sent = this._sent = undefined;
      this.done = false;
      this.delegate = null;

      this.method = "next";
      this.arg = undefined;

      this.tryEntries.forEach(resetTryEntry);

      if (!skipTempReset) {
        for (var name in this) {
          // Not sure about the optimal order of these conditions:
          if (name.charAt(0) === "t" &&
              hasOwn.call(this, name) &&
              !isNaN(+name.slice(1))) {
            this[name] = undefined;
          }
        }
      }
    },

    stop: function() {
      this.done = true;

      var rootEntry = this.tryEntries[0];
      var rootRecord = rootEntry.completion;
      if (rootRecord.type === "throw") {
        throw rootRecord.arg;
      }

      return this.rval;
    },

    dispatchException: function(exception) {
      if (this.done) {
        throw exception;
      }

      var context = this;
      function handle(loc, caught) {
        record.type = "throw";
        record.arg = exception;
        context.next = loc;

        if (caught) {
          // If the dispatched exception was caught by a catch block,
          // then let that catch block handle the exception normally.
          context.method = "next";
          context.arg = undefined;
        }

        return !! caught;
      }

      for (var i = this.tryEntries.length - 1; i >= 0; --i) {
        var entry = this.tryEntries[i];
        var record = entry.completion;

        if (entry.tryLoc === "root") {
          // Exception thrown outside of any try block that could handle
          // it, so set the completion value of the entire function to
          // throw the exception.
          return handle("end");
        }

        if (entry.tryLoc <= this.prev) {
          var hasCatch = hasOwn.call(entry, "catchLoc");
          var hasFinally = hasOwn.call(entry, "finallyLoc");

          if (hasCatch && hasFinally) {
            if (this.prev < entry.catchLoc) {
              return handle(entry.catchLoc, true);
            } else if (this.prev < entry.finallyLoc) {
              return handle(entry.finallyLoc);
            }

          } else if (hasCatch) {
            if (this.prev < entry.catchLoc) {
              return handle(entry.catchLoc, true);
            }

          } else if (hasFinally) {
            if (this.prev < entry.finallyLoc) {
              return handle(entry.finallyLoc);
            }

          } else {
            throw new Error("try statement without catch or finally");
          }
        }
      }
    },

    abrupt: function(type, arg) {
      for (var i = this.tryEntries.length - 1; i >= 0; --i) {
        var entry = this.tryEntries[i];
        if (entry.tryLoc <= this.prev &&
            hasOwn.call(entry, "finallyLoc") &&
            this.prev < entry.finallyLoc) {
          var finallyEntry = entry;
          break;
        }
      }

      if (finallyEntry &&
          (type === "break" ||
           type === "continue") &&
          finallyEntry.tryLoc <= arg &&
          arg <= finallyEntry.finallyLoc) {
        // Ignore the finally entry if control is not jumping to a
        // location outside the try/catch block.
        finallyEntry = null;
      }

      var record = finallyEntry ? finallyEntry.completion : {};
      record.type = type;
      record.arg = arg;

      if (finallyEntry) {
        this.method = "next";
        this.next = finallyEntry.finallyLoc;
        return ContinueSentinel;
      }

      return this.complete(record);
    },

    complete: function(record, afterLoc) {
      if (record.type === "throw") {
        throw record.arg;
      }

      if (record.type === "break" ||
          record.type === "continue") {
        this.next = record.arg;
      } else if (record.type === "return") {
        this.rval = this.arg = record.arg;
        this.method = "return";
        this.next = "end";
      } else if (record.type === "normal" && afterLoc) {
        this.next = afterLoc;
      }

      return ContinueSentinel;
    },

    finish: function(finallyLoc) {
      for (var i = this.tryEntries.length - 1; i >= 0; --i) {
        var entry = this.tryEntries[i];
        if (entry.finallyLoc === finallyLoc) {
          this.complete(entry.completion, entry.afterLoc);
          resetTryEntry(entry);
          return ContinueSentinel;
        }
      }
    },

    "catch": function(tryLoc) {
      for (var i = this.tryEntries.length - 1; i >= 0; --i) {
        var entry = this.tryEntries[i];
        if (entry.tryLoc === tryLoc) {
          var record = entry.completion;
          if (record.type === "throw") {
            var thrown = record.arg;
            resetTryEntry(entry);
          }
          return thrown;
        }
      }

      // The context.catch method must only be called with a location
      // argument that corresponds to a known catch block.
      throw new Error("illegal catch attempt");
    },

    delegateYield: function(iterable, resultName, nextLoc) {
      this.delegate = {
        iterator: values(iterable),
        resultName: resultName,
        nextLoc: nextLoc
      };

      if (this.method === "next") {
        // Deliberately forget the last sent value so that we don't
        // accidentally pass it on to the delegate.
        this.arg = undefined;
      }

      return ContinueSentinel;
    }
  };
})(
  // In sloppy mode, unbound `this` refers to the global object, fallback to
  // Function constructor if we're in global strict mode. That is sadly a form
  // of indirect eval which violates Content Security Policy.
  (function() { return this })() || Function("return this")()
);


/***/ }),

/***/ "99af":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var $ = __webpack_require__("23e7");
var global = __webpack_require__("da84");
var fails = __webpack_require__("d039");
var isArray = __webpack_require__("e8b5");
var isObject = __webpack_require__("861d");
var toObject = __webpack_require__("7b0b");
var lengthOfArrayLike = __webpack_require__("07fa");
var createProperty = __webpack_require__("8418");
var arraySpeciesCreate = __webpack_require__("65f0");
var arrayMethodHasSpeciesSupport = __webpack_require__("1dde");
var wellKnownSymbol = __webpack_require__("b622");
var V8_VERSION = __webpack_require__("2d00");

var IS_CONCAT_SPREADABLE = wellKnownSymbol('isConcatSpreadable');
var MAX_SAFE_INTEGER = 0x1FFFFFFFFFFFFF;
var MAXIMUM_ALLOWED_INDEX_EXCEEDED = 'Maximum allowed index exceeded';
var TypeError = global.TypeError;

// We can't use this feature detection in V8 since it causes
// deoptimization and serious performance degradation
// https://github.com/zloirock/core-js/issues/679
var IS_CONCAT_SPREADABLE_SUPPORT = V8_VERSION >= 51 || !fails(function () {
  var array = [];
  array[IS_CONCAT_SPREADABLE] = false;
  return array.concat()[0] !== array;
});

var SPECIES_SUPPORT = arrayMethodHasSpeciesSupport('concat');

var isConcatSpreadable = function (O) {
  if (!isObject(O)) return false;
  var spreadable = O[IS_CONCAT_SPREADABLE];
  return spreadable !== undefined ? !!spreadable : isArray(O);
};

var FORCED = !IS_CONCAT_SPREADABLE_SUPPORT || !SPECIES_SUPPORT;

// `Array.prototype.concat` method
// https://tc39.es/ecma262/#sec-array.prototype.concat
// with adding support of @@isConcatSpreadable and @@species
$({ target: 'Array', proto: true, forced: FORCED }, {
  // eslint-disable-next-line no-unused-vars -- required for `.length`
  concat: function concat(arg) {
    var O = toObject(this);
    var A = arraySpeciesCreate(O, 0);
    var n = 0;
    var i, k, length, len, E;
    for (i = -1, length = arguments.length; i < length; i++) {
      E = i === -1 ? O : arguments[i];
      if (isConcatSpreadable(E)) {
        len = lengthOfArrayLike(E);
        if (n + len > MAX_SAFE_INTEGER) throw TypeError(MAXIMUM_ALLOWED_INDEX_EXCEEDED);
        for (k = 0; k < len; k++, n++) if (k in E) createProperty(A, n, E[k]);
      } else {
        if (n >= MAX_SAFE_INTEGER) throw TypeError(MAXIMUM_ALLOWED_INDEX_EXCEEDED);
        createProperty(A, n++, E);
      }
    }
    A.length = n;
    return A;
  }
});


/***/ }),

/***/ "9a1f":
/***/ (function(module, exports, __webpack_require__) {

var global = __webpack_require__("da84");
var call = __webpack_require__("c65b");
var aCallable = __webpack_require__("59ed");
var anObject = __webpack_require__("825a");
var tryToString = __webpack_require__("0d51");
var getIteratorMethod = __webpack_require__("35a1");

var TypeError = global.TypeError;

module.exports = function (argument, usingIterator) {
  var iteratorMethod = arguments.length < 2 ? getIteratorMethod(argument) : usingIterator;
  if (aCallable(iteratorMethod)) return anObject(call(iteratorMethod, argument));
  throw TypeError(tryToString(argument) + ' is not iterable');
};


/***/ }),

/***/ "9a8c":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var uncurryThis = __webpack_require__("e330");
var ArrayBufferViewCore = __webpack_require__("ebb5");
var $ArrayCopyWithin = __webpack_require__("145e");

var u$ArrayCopyWithin = uncurryThis($ArrayCopyWithin);
var aTypedArray = ArrayBufferViewCore.aTypedArray;
var exportTypedArrayMethod = ArrayBufferViewCore.exportTypedArrayMethod;

// `%TypedArray%.prototype.copyWithin` method
// https://tc39.es/ecma262/#sec-%typedarray%.prototype.copywithin
exportTypedArrayMethod('copyWithin', function copyWithin(target, start /* , end */) {
  return u$ArrayCopyWithin(aTypedArray(this), target, start, arguments.length > 2 ? arguments[2] : undefined);
});


/***/ }),

/***/ "9b33":
/***/ (function(module, exports) {

module.exports = "data:font/woff2;base64,d09GMgABAAAAAAkoAAsAAAAAEXwAAAjaAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHFQGYACFNgqRaI5FATYCJANMCygABCAFhRcHgWEb7A4jklFSAtlfHdjB8PFHiNoC1idUI3wBxm9cnBUQIO7HESpO4AnvuvmnqcQucQmPB/hj/54br5p+VOBflEV7ROLTUeNwOIHhGmjcAkOQsTHypLZ5+sD/BAgg8MPpbw6hI0z/kgw1/fRp8tLez7hyuTAcwuMUzoCRDOGmXRKgXYIWqYijrVOfSRIqOqEzp3smyeZkcwJTA2ZitBPXZ3LaLGEO4drj5hCGQ1iUXWn7jKQp3/yzyppLYdcSErnGcH8Ig+VQOCwWoRRCeUxsKyYrJ9Y6YqFY1+zF3UdA1brd4sG7w6c1b9qHtw3KxNBAUTPcpCvnlN+0csAuKEcVh+6bhRcKxGfxK577zw//bBZEhUSc5PjlQxd9eJ5rrv+fIv1ghXhtaP2IAhKWjywmfA8nfgQpQ8terHINs7cY1G7c6GdU1zFo1LwdZzzy/sW/mj88W9M0EOBcV4QSDEp22KRp/7P/yKMhiLKCpKijq6SqrKWiqa6mTSiCWF8Z/S7q8hPW7jT4ibkT+MnHQkQIKoOIQBVAxKASiARUEcQfWJMEQNgPCQFVAokFVQWJA1UGyQG2D0KAqoCMANUE2QB36vz6506NP8JG2qBn95nFAeI7Up+Q3vj6WVKW1aSSRK1ORAKR3XNEEMo5AiGnVSinjNi7FUcYCS7/KRmPFyaQy4MlgSjSlscfJfaSNIm4wgoRaFZhHLT6omYm3uEvB9SBKBlqORSggOjDsVg54EPmnmy0HGNcgb4QHYAzLGWVBV/CZrP7+hphFGmEdxwJAgDl1lhlAKAWq5WVyzHQZ9n1ihDG2O02hRaibVXDMsxADPn8Rg7KbdArm2ExMkAIWlUAhYSJZAboAVAgkgTNlasQCTxQBAnLIQy0SHpK4CyogaZUp9XOeAkYN6Bu4MDt1kFrAca0QDRaTsdoRgloEKgcj1oQBIMpjIHwQoNk6BkLqWgmba51DjlYcjQTO8tk++4+vGpbgi0GO3oj50gVw564Tqyo0OKkXVgjI3cT7PrVTgW09FiW4pwlQ7bjwPKt8Ww0eqwl/3g73/OMSVOt7Qf4UI1ewSxi9m4EmdqwZ+oy+zZBXHrz/gHCEauVnMNFIzmUw0wqNh+WTDZLWwt+w5Yi3NyRflM2KycczGF6oKW5mW5pYdxu6sYNc3c8Y2ghYYymyWIxXcUMi6lwmTqbRYaThrFScgJnWMbXQDB2WkEaSL9Ibaa8cI1BgcvkDAve+OHzZfMd0TsNig0yq83mS1cxLtppWU85sB5GkdlO21A0ar7ValOQ+cqhyw5jTLRhLWq5gYe1lguzshhR/hQ0wBjfKoxgZfulGPZG7faT4fPf3k5DpM23wWhoMBFmYyPZ04j36kk09sr+mDXWNFZ5POaO+07HwsyumV9KumR2AW3bAO0jfYRJleR9N3TpY8rIr1KyZwrb+MR7joxwEWrwKi72oqT+ruyPlHdX8THsHK8JLdOn1XEno+Xu5IcthJNwENuS3kSjFOH6s1go44RHcEcG8HUjwnmNsydxkHB/jMkBvTvrw71b1pqBE8jakkgKrccxrtDldDmcjMHWBMLp3CCyo5gkNPWuLN3jJJ0/ECLQIlkZX4Df6P/HvozyD6CndzfoyfpCH7hrq169OvafP3bSuIUnOmcVapVVk8qKbvXUt87SKMu0heBruEbO0fjN8/n5PqZ2m3hs1eIDFhzMigyH9y4oCkwblc83hcRcawiBdO93QYT5SVqu56Zu3V3FID00JEXPGNFfy2TLflX3iIpDikUvdJC4KR8zCWKONQRDuou28OKm42m5929l2O7yBqZBQ0LSXhY47GDxuH3cOLtsdgJI8JzxDlBETwXsXRSQumhvQLbOgvxhc+cOE0RMP0zHB1nL893NI/YFNagbUrukdO6U0jX1aJfUzikfsJx3NLVrSidAcB3HCHKpfZrdJXn784KOFA7S6wdNUNCpJ2THAmFF8sG1umqNplpXe19Xp6mq1pbRg49IbQ4JElOrqa7WLM/7gvYklF3T0roqiTMKOpiXI9LP4OndVnrpIB2iLq7EE4zykVZWODMq3stNVg07MjVl2XST/L2iXbZaURd4PI1bjcatlxR0y1yuUJFKJamquAIImVSW3wke1+7Hp0qsw2zv6d58k2ptN740ERxPrTClnS+uL0W8inJ95kcuiJwWOdUHeE4VDpkMtucKJV5FSGtO+Kg54Z1VIG9GJHf9zD7rIoOKBYUnAzp0KxG2pxu8uKtgDVIHyjfC6rDiddOKLVOKLTLV9nPTmIj/5krqX1E/M4qr56i5cN0pmRLURVUoO1ZAT1UNhs5A+3CgUCwWdiPEIpEEx7+hhbqeUAzGeR4CcCCTkSNInmcPI0eRxMDdiIu9jaTDX1e/h/DhbwAACA3/SjLhI3BztTyFFADgORID6NnHyBJEUehBaAQKJRbDmavE9vDDWIlP4ecrNIRUC8719J/1tKVOlPPNG/tfOumh5lEdZXgOF87iFyiDCRz2mOWhVA8cMC8ns+jN9b4WItv3eMf5EVCVg4BlZGrX7/6l3mDeIn5FtXWIvIQ6JHwxIBspHQoweQ5FfG0cqhI9H1wj9QUB5ZmAWd+JA8TPjwNM6CpCOKM/xIHRvwOXIlEkD1ZFO6DIro6HiWlekcAqvOk/DTkuQSlap+YXfFdHQB8wtGRl3a74yAukEheznC3aSu5RIHPuUN+GlWowQTibu9gXQ0psJuE1nM5G1el8Pg/ciWeO88Y1AZYCz+h9Wr/EYUUoVtU0pL7XqUaQinqg+Rs0iSUDusShF+IniLSHuTOWZhYDwb1YBnd4pBDl3wxWVCqB0c0Fy4y7Y1cgUSIzcRW2JuDQ7IefkD85N5cDhaHi7BpI+UWZBVXizXrBiqrphjAt23E9nz9Igk+QBpnDOxNKpwIcucQV+YFnnsuglurY1u217fvNjnrLPVl+B0E3ym2n5+QPW/GQRAV7VYUi9khtIrdbk63jXmKOz9MuRFh26Blbbq8iwelBaMVyzw/ef/JWJcl7zhaHtLEBAA=="

/***/ }),

/***/ "9bdd":
/***/ (function(module, exports, __webpack_require__) {

var anObject = __webpack_require__("825a");
var iteratorClose = __webpack_require__("2a62");

// call something on iterator step with safe closing on error
module.exports = function (iterator, fn, value, ENTRIES) {
  try {
    return ENTRIES ? fn(anObject(value)[0], value[1]) : fn(value);
  } catch (error) {
    iteratorClose(iterator, 'throw', error);
  }
};


/***/ }),

/***/ "9bf2":
/***/ (function(module, exports, __webpack_require__) {

var global = __webpack_require__("da84");
var DESCRIPTORS = __webpack_require__("83ab");
var IE8_DOM_DEFINE = __webpack_require__("0cfb");
var anObject = __webpack_require__("825a");
var toPropertyKey = __webpack_require__("a04b");

var TypeError = global.TypeError;
// eslint-disable-next-line es/no-object-defineproperty -- safe
var $defineProperty = Object.defineProperty;

// `Object.defineProperty` method
// https://tc39.es/ecma262/#sec-object.defineproperty
exports.f = DESCRIPTORS ? $defineProperty : function defineProperty(O, P, Attributes) {
  anObject(O);
  P = toPropertyKey(P);
  anObject(Attributes);
  if (IE8_DOM_DEFINE) try {
    return $defineProperty(O, P, Attributes);
  } catch (error) { /* empty */ }
  if ('get' in Attributes || 'set' in Attributes) throw TypeError('Accessors not supported');
  if ('value' in Attributes) O[P] = Attributes.value;
  return O;
};


/***/ }),

/***/ "9e67":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var _node_modules_vue_style_loader_index_js_ref_9_oneOf_1_0_node_modules_css_loader_dist_cjs_js_ref_9_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_9_oneOf_1_2_node_modules_postcss_loader_src_index_js_ref_9_oneOf_1_3_node_modules_sass_loader_dist_cjs_js_ref_9_oneOf_1_4_node_modules_cache_loader_dist_cjs_js_ref_1_0_node_modules_vue_loader_lib_index_js_vue_loader_options_index_vue_vue_type_style_index_0_id_544d9ff4_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("10dc");
/* harmony import */ var _node_modules_vue_style_loader_index_js_ref_9_oneOf_1_0_node_modules_css_loader_dist_cjs_js_ref_9_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_9_oneOf_1_2_node_modules_postcss_loader_src_index_js_ref_9_oneOf_1_3_node_modules_sass_loader_dist_cjs_js_ref_9_oneOf_1_4_node_modules_cache_loader_dist_cjs_js_ref_1_0_node_modules_vue_loader_lib_index_js_vue_loader_options_index_vue_vue_type_style_index_0_id_544d9ff4_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_node_modules_vue_style_loader_index_js_ref_9_oneOf_1_0_node_modules_css_loader_dist_cjs_js_ref_9_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_9_oneOf_1_2_node_modules_postcss_loader_src_index_js_ref_9_oneOf_1_3_node_modules_sass_loader_dist_cjs_js_ref_9_oneOf_1_4_node_modules_cache_loader_dist_cjs_js_ref_1_0_node_modules_vue_loader_lib_index_js_vue_loader_options_index_vue_vue_type_style_index_0_id_544d9ff4_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0__);
/* unused harmony reexport * */


/***/ }),

/***/ "9ed3":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var IteratorPrototype = __webpack_require__("ae93").IteratorPrototype;
var create = __webpack_require__("7c73");
var createPropertyDescriptor = __webpack_require__("5c6c");
var setToStringTag = __webpack_require__("d44e");
var Iterators = __webpack_require__("3f8c");

var returnThis = function () { return this; };

module.exports = function (IteratorConstructor, NAME, next) {
  var TO_STRING_TAG = NAME + ' Iterator';
  IteratorConstructor.prototype = create(IteratorPrototype, { next: createPropertyDescriptor(1, next) });
  setToStringTag(IteratorConstructor, TO_STRING_TAG, false, true);
  Iterators[TO_STRING_TAG] = returnThis;
  return IteratorConstructor;
};


/***/ }),

/***/ "9f7f":
/***/ (function(module, exports, __webpack_require__) {

var fails = __webpack_require__("d039");
var global = __webpack_require__("da84");

// babel-minify and Closure Compiler transpiles RegExp('a', 'y') -> /a/y and it causes SyntaxError
var $RegExp = global.RegExp;

exports.UNSUPPORTED_Y = fails(function () {
  var re = $RegExp('a', 'y');
  re.lastIndex = 2;
  return re.exec('abcd') != null;
});

exports.BROKEN_CARET = fails(function () {
  // https://bugzilla.mozilla.org/show_bug.cgi?id=773687
  var re = $RegExp('^r', 'gy');
  re.lastIndex = 2;
  return re.exec('str') != null;
});


/***/ }),

/***/ "9ff1":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function(module, Buffer) {/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return decodebase64; });
/* harmony import */ var core_js_modules_es_regexp_exec_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("ac1f");
/* harmony import */ var core_js_modules_es_regexp_exec_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_es_regexp_exec_js__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var core_js_modules_es_string_replace_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__("5319");
/* harmony import */ var core_js_modules_es_string_replace_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_es_string_replace_js__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var core_js_modules_es_object_to_string_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__("d3b7");
/* harmony import */ var core_js_modules_es_object_to_string_js__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_es_object_to_string_js__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var core_js_modules_es_regexp_to_string_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__("25f0");
/* harmony import */ var core_js_modules_es_regexp_to_string_js__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_es_regexp_to_string_js__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var _error__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__("94eb");




// Copyright 2015-2018 FormBucket LLC

function decodebase64(str) {
  function atob(input) {
    var str = String(input).replace(/=+$/, '');

    if (str.length % 4 == 1) {
      return _error__WEBPACK_IMPORTED_MODULE_4__[/* ERRORTYPES */ "a"].value;
    }

    for ( // initialize result and counters
    var bc = 0, bs, buffer, idx = 0, output = ''; // get next character
    buffer = str.charAt(idx++); // character found in table? initialize bit storage and add its ascii value;
    ~buffer && (bs = bc % 4 ? bs * 64 + buffer : buffer, // and if not first of each 4 characters,
    // convert the first 8 bits to one ascii character
    bc++ % 4) ? output += String.fromCharCode(255 & bs >> (-2 * bc & 6)) : 0) {
      // try to find character in table (0-63, not found => -1)
      buffer = chars.indexOf(buffer);
    }

    return output;
  }

  if (typeof window !== 'undefined' && typeof atob !== 'undefined') {
    return window.atob(str);
  } else if ( true && module.exports) {
    return new Buffer(str, 'base64').toString();
  } else {
    var chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';
    return atob(str);
  }
}
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("dd40")(module), __webpack_require__("b639").Buffer))

/***/ }),

/***/ "a04b":
/***/ (function(module, exports, __webpack_require__) {

var toPrimitive = __webpack_require__("c04e");
var isSymbol = __webpack_require__("d9b5");

// `ToPropertyKey` abstract operation
// https://tc39.es/ecma262/#sec-topropertykey
module.exports = function (argument) {
  var key = toPrimitive(argument, 'string');
  return isSymbol(key) ? key : key + '';
};


/***/ }),

/***/ "a078":
/***/ (function(module, exports, __webpack_require__) {

var bind = __webpack_require__("0366");
var call = __webpack_require__("c65b");
var aConstructor = __webpack_require__("5087");
var toObject = __webpack_require__("7b0b");
var lengthOfArrayLike = __webpack_require__("07fa");
var getIterator = __webpack_require__("9a1f");
var getIteratorMethod = __webpack_require__("35a1");
var isArrayIteratorMethod = __webpack_require__("e95a");
var aTypedArrayConstructor = __webpack_require__("ebb5").aTypedArrayConstructor;

module.exports = function from(source /* , mapfn, thisArg */) {
  var C = aConstructor(this);
  var O = toObject(source);
  var argumentsLength = arguments.length;
  var mapfn = argumentsLength > 1 ? arguments[1] : undefined;
  var mapping = mapfn !== undefined;
  var iteratorMethod = getIteratorMethod(O);
  var i, length, result, step, iterator, next;
  if (iteratorMethod && !isArrayIteratorMethod(iteratorMethod)) {
    iterator = getIterator(O, iteratorMethod);
    next = iterator.next;
    O = [];
    while (!(step = call(next, iterator)).done) {
      O.push(step.value);
    }
  }
  if (mapping && argumentsLength > 2) {
    mapfn = bind(mapfn, arguments[2]);
  }
  length = lengthOfArrayLike(O);
  result = new (aTypedArrayConstructor(C))(length);
  for (i = 0; length > i; i++) {
    result[i] = mapping ? mapfn(O[i], i) : O[i];
  }
  return result;
};


/***/ }),

/***/ "a15b":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var $ = __webpack_require__("23e7");
var uncurryThis = __webpack_require__("e330");
var IndexedObject = __webpack_require__("44ad");
var toIndexedObject = __webpack_require__("fc6a");
var arrayMethodIsStrict = __webpack_require__("a640");

var un$Join = uncurryThis([].join);

var ES3_STRINGS = IndexedObject != Object;
var STRICT_METHOD = arrayMethodIsStrict('join', ',');

// `Array.prototype.join` method
// https://tc39.es/ecma262/#sec-array.prototype.join
$({ target: 'Array', proto: true, forced: ES3_STRINGS || !STRICT_METHOD }, {
  join: function join(separator) {
    return un$Join(toIndexedObject(this), separator === undefined ? ',' : separator);
  }
});


/***/ }),

/***/ "a434":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var $ = __webpack_require__("23e7");
var global = __webpack_require__("da84");
var toAbsoluteIndex = __webpack_require__("23cb");
var toIntegerOrInfinity = __webpack_require__("5926");
var lengthOfArrayLike = __webpack_require__("07fa");
var toObject = __webpack_require__("7b0b");
var arraySpeciesCreate = __webpack_require__("65f0");
var createProperty = __webpack_require__("8418");
var arrayMethodHasSpeciesSupport = __webpack_require__("1dde");

var HAS_SPECIES_SUPPORT = arrayMethodHasSpeciesSupport('splice');

var TypeError = global.TypeError;
var max = Math.max;
var min = Math.min;
var MAX_SAFE_INTEGER = 0x1FFFFFFFFFFFFF;
var MAXIMUM_ALLOWED_LENGTH_EXCEEDED = 'Maximum allowed length exceeded';

// `Array.prototype.splice` method
// https://tc39.es/ecma262/#sec-array.prototype.splice
// with adding support of @@species
$({ target: 'Array', proto: true, forced: !HAS_SPECIES_SUPPORT }, {
  splice: function splice(start, deleteCount /* , ...items */) {
    var O = toObject(this);
    var len = lengthOfArrayLike(O);
    var actualStart = toAbsoluteIndex(start, len);
    var argumentsLength = arguments.length;
    var insertCount, actualDeleteCount, A, k, from, to;
    if (argumentsLength === 0) {
      insertCount = actualDeleteCount = 0;
    } else if (argumentsLength === 1) {
      insertCount = 0;
      actualDeleteCount = len - actualStart;
    } else {
      insertCount = argumentsLength - 2;
      actualDeleteCount = min(max(toIntegerOrInfinity(deleteCount), 0), len - actualStart);
    }
    if (len + insertCount - actualDeleteCount > MAX_SAFE_INTEGER) {
      throw TypeError(MAXIMUM_ALLOWED_LENGTH_EXCEEDED);
    }
    A = arraySpeciesCreate(O, actualDeleteCount);
    for (k = 0; k < actualDeleteCount; k++) {
      from = actualStart + k;
      if (from in O) createProperty(A, k, O[from]);
    }
    A.length = actualDeleteCount;
    if (insertCount < actualDeleteCount) {
      for (k = actualStart; k < len - actualDeleteCount; k++) {
        from = k + actualDeleteCount;
        to = k + insertCount;
        if (from in O) O[to] = O[from];
        else delete O[to];
      }
      for (k = len; k > len - actualDeleteCount + insertCount; k--) delete O[k - 1];
    } else if (insertCount > actualDeleteCount) {
      for (k = len - actualDeleteCount; k > actualStart; k--) {
        from = k + actualDeleteCount - 1;
        to = k + insertCount - 1;
        if (from in O) O[to] = O[from];
        else delete O[to];
      }
    }
    for (k = 0; k < insertCount; k++) {
      O[k + actualStart] = arguments[k + 2];
    }
    O.length = len - actualDeleteCount + insertCount;
    return A;
  }
});


/***/ }),

/***/ "a4b4":
/***/ (function(module, exports, __webpack_require__) {

var userAgent = __webpack_require__("342f");

module.exports = /web0s(?!.*chrome)/i.test(userAgent);


/***/ }),

/***/ "a4d3":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var $ = __webpack_require__("23e7");
var global = __webpack_require__("da84");
var getBuiltIn = __webpack_require__("d066");
var apply = __webpack_require__("2ba4");
var call = __webpack_require__("c65b");
var uncurryThis = __webpack_require__("e330");
var IS_PURE = __webpack_require__("c430");
var DESCRIPTORS = __webpack_require__("83ab");
var NATIVE_SYMBOL = __webpack_require__("4930");
var fails = __webpack_require__("d039");
var hasOwn = __webpack_require__("1a2d");
var isArray = __webpack_require__("e8b5");
var isCallable = __webpack_require__("1626");
var isObject = __webpack_require__("861d");
var isPrototypeOf = __webpack_require__("3a9b");
var isSymbol = __webpack_require__("d9b5");
var anObject = __webpack_require__("825a");
var toObject = __webpack_require__("7b0b");
var toIndexedObject = __webpack_require__("fc6a");
var toPropertyKey = __webpack_require__("a04b");
var $toString = __webpack_require__("577e");
var createPropertyDescriptor = __webpack_require__("5c6c");
var nativeObjectCreate = __webpack_require__("7c73");
var objectKeys = __webpack_require__("df75");
var getOwnPropertyNamesModule = __webpack_require__("241c");
var getOwnPropertyNamesExternal = __webpack_require__("057f");
var getOwnPropertySymbolsModule = __webpack_require__("7418");
var getOwnPropertyDescriptorModule = __webpack_require__("06cf");
var definePropertyModule = __webpack_require__("9bf2");
var propertyIsEnumerableModule = __webpack_require__("d1e7");
var arraySlice = __webpack_require__("f36a");
var redefine = __webpack_require__("6eeb");
var shared = __webpack_require__("5692");
var sharedKey = __webpack_require__("f772");
var hiddenKeys = __webpack_require__("d012");
var uid = __webpack_require__("90e3");
var wellKnownSymbol = __webpack_require__("b622");
var wrappedWellKnownSymbolModule = __webpack_require__("e538");
var defineWellKnownSymbol = __webpack_require__("746f");
var setToStringTag = __webpack_require__("d44e");
var InternalStateModule = __webpack_require__("69f3");
var $forEach = __webpack_require__("b727").forEach;

var HIDDEN = sharedKey('hidden');
var SYMBOL = 'Symbol';
var PROTOTYPE = 'prototype';
var TO_PRIMITIVE = wellKnownSymbol('toPrimitive');

var setInternalState = InternalStateModule.set;
var getInternalState = InternalStateModule.getterFor(SYMBOL);

var ObjectPrototype = Object[PROTOTYPE];
var $Symbol = global.Symbol;
var SymbolPrototype = $Symbol && $Symbol[PROTOTYPE];
var TypeError = global.TypeError;
var QObject = global.QObject;
var $stringify = getBuiltIn('JSON', 'stringify');
var nativeGetOwnPropertyDescriptor = getOwnPropertyDescriptorModule.f;
var nativeDefineProperty = definePropertyModule.f;
var nativeGetOwnPropertyNames = getOwnPropertyNamesExternal.f;
var nativePropertyIsEnumerable = propertyIsEnumerableModule.f;
var push = uncurryThis([].push);

var AllSymbols = shared('symbols');
var ObjectPrototypeSymbols = shared('op-symbols');
var StringToSymbolRegistry = shared('string-to-symbol-registry');
var SymbolToStringRegistry = shared('symbol-to-string-registry');
var WellKnownSymbolsStore = shared('wks');

// Don't use setters in Qt Script, https://github.com/zloirock/core-js/issues/173
var USE_SETTER = !QObject || !QObject[PROTOTYPE] || !QObject[PROTOTYPE].findChild;

// fallback for old Android, https://code.google.com/p/v8/issues/detail?id=687
var setSymbolDescriptor = DESCRIPTORS && fails(function () {
  return nativeObjectCreate(nativeDefineProperty({}, 'a', {
    get: function () { return nativeDefineProperty(this, 'a', { value: 7 }).a; }
  })).a != 7;
}) ? function (O, P, Attributes) {
  var ObjectPrototypeDescriptor = nativeGetOwnPropertyDescriptor(ObjectPrototype, P);
  if (ObjectPrototypeDescriptor) delete ObjectPrototype[P];
  nativeDefineProperty(O, P, Attributes);
  if (ObjectPrototypeDescriptor && O !== ObjectPrototype) {
    nativeDefineProperty(ObjectPrototype, P, ObjectPrototypeDescriptor);
  }
} : nativeDefineProperty;

var wrap = function (tag, description) {
  var symbol = AllSymbols[tag] = nativeObjectCreate(SymbolPrototype);
  setInternalState(symbol, {
    type: SYMBOL,
    tag: tag,
    description: description
  });
  if (!DESCRIPTORS) symbol.description = description;
  return symbol;
};

var $defineProperty = function defineProperty(O, P, Attributes) {
  if (O === ObjectPrototype) $defineProperty(ObjectPrototypeSymbols, P, Attributes);
  anObject(O);
  var key = toPropertyKey(P);
  anObject(Attributes);
  if (hasOwn(AllSymbols, key)) {
    if (!Attributes.enumerable) {
      if (!hasOwn(O, HIDDEN)) nativeDefineProperty(O, HIDDEN, createPropertyDescriptor(1, {}));
      O[HIDDEN][key] = true;
    } else {
      if (hasOwn(O, HIDDEN) && O[HIDDEN][key]) O[HIDDEN][key] = false;
      Attributes = nativeObjectCreate(Attributes, { enumerable: createPropertyDescriptor(0, false) });
    } return setSymbolDescriptor(O, key, Attributes);
  } return nativeDefineProperty(O, key, Attributes);
};

var $defineProperties = function defineProperties(O, Properties) {
  anObject(O);
  var properties = toIndexedObject(Properties);
  var keys = objectKeys(properties).concat($getOwnPropertySymbols(properties));
  $forEach(keys, function (key) {
    if (!DESCRIPTORS || call($propertyIsEnumerable, properties, key)) $defineProperty(O, key, properties[key]);
  });
  return O;
};

var $create = function create(O, Properties) {
  return Properties === undefined ? nativeObjectCreate(O) : $defineProperties(nativeObjectCreate(O), Properties);
};

var $propertyIsEnumerable = function propertyIsEnumerable(V) {
  var P = toPropertyKey(V);
  var enumerable = call(nativePropertyIsEnumerable, this, P);
  if (this === ObjectPrototype && hasOwn(AllSymbols, P) && !hasOwn(ObjectPrototypeSymbols, P)) return false;
  return enumerable || !hasOwn(this, P) || !hasOwn(AllSymbols, P) || hasOwn(this, HIDDEN) && this[HIDDEN][P]
    ? enumerable : true;
};

var $getOwnPropertyDescriptor = function getOwnPropertyDescriptor(O, P) {
  var it = toIndexedObject(O);
  var key = toPropertyKey(P);
  if (it === ObjectPrototype && hasOwn(AllSymbols, key) && !hasOwn(ObjectPrototypeSymbols, key)) return;
  var descriptor = nativeGetOwnPropertyDescriptor(it, key);
  if (descriptor && hasOwn(AllSymbols, key) && !(hasOwn(it, HIDDEN) && it[HIDDEN][key])) {
    descriptor.enumerable = true;
  }
  return descriptor;
};

var $getOwnPropertyNames = function getOwnPropertyNames(O) {
  var names = nativeGetOwnPropertyNames(toIndexedObject(O));
  var result = [];
  $forEach(names, function (key) {
    if (!hasOwn(AllSymbols, key) && !hasOwn(hiddenKeys, key)) push(result, key);
  });
  return result;
};

var $getOwnPropertySymbols = function getOwnPropertySymbols(O) {
  var IS_OBJECT_PROTOTYPE = O === ObjectPrototype;
  var names = nativeGetOwnPropertyNames(IS_OBJECT_PROTOTYPE ? ObjectPrototypeSymbols : toIndexedObject(O));
  var result = [];
  $forEach(names, function (key) {
    if (hasOwn(AllSymbols, key) && (!IS_OBJECT_PROTOTYPE || hasOwn(ObjectPrototype, key))) {
      push(result, AllSymbols[key]);
    }
  });
  return result;
};

// `Symbol` constructor
// https://tc39.es/ecma262/#sec-symbol-constructor
if (!NATIVE_SYMBOL) {
  $Symbol = function Symbol() {
    if (isPrototypeOf(SymbolPrototype, this)) throw TypeError('Symbol is not a constructor');
    var description = !arguments.length || arguments[0] === undefined ? undefined : $toString(arguments[0]);
    var tag = uid(description);
    var setter = function (value) {
      if (this === ObjectPrototype) call(setter, ObjectPrototypeSymbols, value);
      if (hasOwn(this, HIDDEN) && hasOwn(this[HIDDEN], tag)) this[HIDDEN][tag] = false;
      setSymbolDescriptor(this, tag, createPropertyDescriptor(1, value));
    };
    if (DESCRIPTORS && USE_SETTER) setSymbolDescriptor(ObjectPrototype, tag, { configurable: true, set: setter });
    return wrap(tag, description);
  };

  SymbolPrototype = $Symbol[PROTOTYPE];

  redefine(SymbolPrototype, 'toString', function toString() {
    return getInternalState(this).tag;
  });

  redefine($Symbol, 'withoutSetter', function (description) {
    return wrap(uid(description), description);
  });

  propertyIsEnumerableModule.f = $propertyIsEnumerable;
  definePropertyModule.f = $defineProperty;
  getOwnPropertyDescriptorModule.f = $getOwnPropertyDescriptor;
  getOwnPropertyNamesModule.f = getOwnPropertyNamesExternal.f = $getOwnPropertyNames;
  getOwnPropertySymbolsModule.f = $getOwnPropertySymbols;

  wrappedWellKnownSymbolModule.f = function (name) {
    return wrap(wellKnownSymbol(name), name);
  };

  if (DESCRIPTORS) {
    // https://github.com/tc39/proposal-Symbol-description
    nativeDefineProperty(SymbolPrototype, 'description', {
      configurable: true,
      get: function description() {
        return getInternalState(this).description;
      }
    });
    if (!IS_PURE) {
      redefine(ObjectPrototype, 'propertyIsEnumerable', $propertyIsEnumerable, { unsafe: true });
    }
  }
}

$({ global: true, wrap: true, forced: !NATIVE_SYMBOL, sham: !NATIVE_SYMBOL }, {
  Symbol: $Symbol
});

$forEach(objectKeys(WellKnownSymbolsStore), function (name) {
  defineWellKnownSymbol(name);
});

$({ target: SYMBOL, stat: true, forced: !NATIVE_SYMBOL }, {
  // `Symbol.for` method
  // https://tc39.es/ecma262/#sec-symbol.for
  'for': function (key) {
    var string = $toString(key);
    if (hasOwn(StringToSymbolRegistry, string)) return StringToSymbolRegistry[string];
    var symbol = $Symbol(string);
    StringToSymbolRegistry[string] = symbol;
    SymbolToStringRegistry[symbol] = string;
    return symbol;
  },
  // `Symbol.keyFor` method
  // https://tc39.es/ecma262/#sec-symbol.keyfor
  keyFor: function keyFor(sym) {
    if (!isSymbol(sym)) throw TypeError(sym + ' is not a symbol');
    if (hasOwn(SymbolToStringRegistry, sym)) return SymbolToStringRegistry[sym];
  },
  useSetter: function () { USE_SETTER = true; },
  useSimple: function () { USE_SETTER = false; }
});

$({ target: 'Object', stat: true, forced: !NATIVE_SYMBOL, sham: !DESCRIPTORS }, {
  // `Object.create` method
  // https://tc39.es/ecma262/#sec-object.create
  create: $create,
  // `Object.defineProperty` method
  // https://tc39.es/ecma262/#sec-object.defineproperty
  defineProperty: $defineProperty,
  // `Object.defineProperties` method
  // https://tc39.es/ecma262/#sec-object.defineproperties
  defineProperties: $defineProperties,
  // `Object.getOwnPropertyDescriptor` method
  // https://tc39.es/ecma262/#sec-object.getownpropertydescriptors
  getOwnPropertyDescriptor: $getOwnPropertyDescriptor
});

$({ target: 'Object', stat: true, forced: !NATIVE_SYMBOL }, {
  // `Object.getOwnPropertyNames` method
  // https://tc39.es/ecma262/#sec-object.getownpropertynames
  getOwnPropertyNames: $getOwnPropertyNames,
  // `Object.getOwnPropertySymbols` method
  // https://tc39.es/ecma262/#sec-object.getownpropertysymbols
  getOwnPropertySymbols: $getOwnPropertySymbols
});

// Chrome 38 and 39 `Object.getOwnPropertySymbols` fails on primitives
// https://bugs.chromium.org/p/v8/issues/detail?id=3443
$({ target: 'Object', stat: true, forced: fails(function () { getOwnPropertySymbolsModule.f(1); }) }, {
  getOwnPropertySymbols: function getOwnPropertySymbols(it) {
    return getOwnPropertySymbolsModule.f(toObject(it));
  }
});

// `JSON.stringify` method behavior with symbols
// https://tc39.es/ecma262/#sec-json.stringify
if ($stringify) {
  var FORCED_JSON_STRINGIFY = !NATIVE_SYMBOL || fails(function () {
    var symbol = $Symbol();
    // MS Edge converts symbol values to JSON as {}
    return $stringify([symbol]) != '[null]'
      // WebKit converts symbol values to JSON as null
      || $stringify({ a: symbol }) != '{}'
      // V8 throws on boxed symbols
      || $stringify(Object(symbol)) != '{}';
  });

  $({ target: 'JSON', stat: true, forced: FORCED_JSON_STRINGIFY }, {
    // eslint-disable-next-line no-unused-vars -- required for `.length`
    stringify: function stringify(it, replacer, space) {
      var args = arraySlice(arguments);
      var $replacer = replacer;
      if (!isObject(replacer) && it === undefined || isSymbol(it)) return; // IE8 returns string on undefined
      if (!isArray(replacer)) replacer = function (key, value) {
        if (isCallable($replacer)) value = call($replacer, this, key, value);
        if (!isSymbol(value)) return value;
      };
      args[1] = replacer;
      return apply($stringify, null, args);
    }
  });
}

// `Symbol.prototype[@@toPrimitive]` method
// https://tc39.es/ecma262/#sec-symbol.prototype-@@toprimitive
if (!SymbolPrototype[TO_PRIMITIVE]) {
  var valueOf = SymbolPrototype.valueOf;
  // eslint-disable-next-line no-unused-vars -- required for .length
  redefine(SymbolPrototype, TO_PRIMITIVE, function (hint) {
    // TODO: improve hint logic
    return call(valueOf, this);
  });
}
// `Symbol.prototype[@@toStringTag]` property
// https://tc39.es/ecma262/#sec-symbol.prototype-@@tostringtag
setToStringTag($Symbol, SYMBOL);

hiddenKeys[HIDDEN] = true;


/***/ }),

/***/ "a630":
/***/ (function(module, exports, __webpack_require__) {

var $ = __webpack_require__("23e7");
var from = __webpack_require__("4df4");
var checkCorrectnessOfIteration = __webpack_require__("1c7e");

var INCORRECT_ITERATION = !checkCorrectnessOfIteration(function (iterable) {
  // eslint-disable-next-line es/no-array-from -- required for testing
  Array.from(iterable);
});

// `Array.from` method
// https://tc39.es/ecma262/#sec-array.from
$({ target: 'Array', stat: true, forced: INCORRECT_ITERATION }, {
  from: from
});


/***/ }),

/***/ "a640":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var fails = __webpack_require__("d039");

module.exports = function (METHOD_NAME, argument) {
  var method = [][METHOD_NAME];
  return !!method && fails(function () {
    // eslint-disable-next-line no-useless-call,no-throw-literal -- required for testing
    method.call(null, argument || function () { throw 1; }, 1);
  });
};


/***/ }),

/***/ "a975":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var ArrayBufferViewCore = __webpack_require__("ebb5");
var $every = __webpack_require__("b727").every;

var aTypedArray = ArrayBufferViewCore.aTypedArray;
var exportTypedArrayMethod = ArrayBufferViewCore.exportTypedArrayMethod;

// `%TypedArray%.prototype.every` method
// https://tc39.es/ecma262/#sec-%typedarray%.prototype.every
exportTypedArrayMethod('every', function every(callbackfn /* , thisArg */) {
  return $every(aTypedArray(this), callbackfn, arguments.length > 1 ? arguments[1] : undefined);
});


/***/ }),

/***/ "a981":
/***/ (function(module, exports) {

// eslint-disable-next-line es/no-typed-arrays -- safe
module.exports = typeof ArrayBuffer != 'undefined' && typeof DataView != 'undefined';


/***/ }),

/***/ "a9e3":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var DESCRIPTORS = __webpack_require__("83ab");
var global = __webpack_require__("da84");
var uncurryThis = __webpack_require__("e330");
var isForced = __webpack_require__("94ca");
var redefine = __webpack_require__("6eeb");
var hasOwn = __webpack_require__("1a2d");
var inheritIfRequired = __webpack_require__("7156");
var isPrototypeOf = __webpack_require__("3a9b");
var isSymbol = __webpack_require__("d9b5");
var toPrimitive = __webpack_require__("c04e");
var fails = __webpack_require__("d039");
var getOwnPropertyNames = __webpack_require__("241c").f;
var getOwnPropertyDescriptor = __webpack_require__("06cf").f;
var defineProperty = __webpack_require__("9bf2").f;
var thisNumberValue = __webpack_require__("408a");
var trim = __webpack_require__("58a8").trim;

var NUMBER = 'Number';
var NativeNumber = global[NUMBER];
var NumberPrototype = NativeNumber.prototype;
var TypeError = global.TypeError;
var arraySlice = uncurryThis(''.slice);
var charCodeAt = uncurryThis(''.charCodeAt);

// `ToNumeric` abstract operation
// https://tc39.es/ecma262/#sec-tonumeric
var toNumeric = function (value) {
  var primValue = toPrimitive(value, 'number');
  return typeof primValue == 'bigint' ? primValue : toNumber(primValue);
};

// `ToNumber` abstract operation
// https://tc39.es/ecma262/#sec-tonumber
var toNumber = function (argument) {
  var it = toPrimitive(argument, 'number');
  var first, third, radix, maxCode, digits, length, index, code;
  if (isSymbol(it)) throw TypeError('Cannot convert a Symbol value to a number');
  if (typeof it == 'string' && it.length > 2) {
    it = trim(it);
    first = charCodeAt(it, 0);
    if (first === 43 || first === 45) {
      third = charCodeAt(it, 2);
      if (third === 88 || third === 120) return NaN; // Number('+0x1') should be NaN, old V8 fix
    } else if (first === 48) {
      switch (charCodeAt(it, 1)) {
        case 66: case 98: radix = 2; maxCode = 49; break; // fast equal of /^0b[01]+$/i
        case 79: case 111: radix = 8; maxCode = 55; break; // fast equal of /^0o[0-7]+$/i
        default: return +it;
      }
      digits = arraySlice(it, 2);
      length = digits.length;
      for (index = 0; index < length; index++) {
        code = charCodeAt(digits, index);
        // parseInt parses a string to a first unavailable symbol
        // but ToNumber should return NaN if a string contains unavailable symbols
        if (code < 48 || code > maxCode) return NaN;
      } return parseInt(digits, radix);
    }
  } return +it;
};

// `Number` constructor
// https://tc39.es/ecma262/#sec-number-constructor
if (isForced(NUMBER, !NativeNumber(' 0o1') || !NativeNumber('0b1') || NativeNumber('+0x1'))) {
  var NumberWrapper = function Number(value) {
    var n = arguments.length < 1 ? 0 : NativeNumber(toNumeric(value));
    var dummy = this;
    // check on 1..constructor(foo) case
    return isPrototypeOf(NumberPrototype, dummy) && fails(function () { thisNumberValue(dummy); })
      ? inheritIfRequired(Object(n), dummy, NumberWrapper) : n;
  };
  for (var keys = DESCRIPTORS ? getOwnPropertyNames(NativeNumber) : (
    // ES3:
    'MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,' +
    // ES2015 (in case, if modules with ES2015 Number statics required before):
    'EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,' +
    // ESNext
    'fromString,range'
  ).split(','), j = 0, key; keys.length > j; j++) {
    if (hasOwn(NativeNumber, key = keys[j]) && !hasOwn(NumberWrapper, key)) {
      defineProperty(NumberWrapper, key, getOwnPropertyDescriptor(NativeNumber, key));
    }
  }
  NumberWrapper.prototype = NumberPrototype;
  NumberPrototype.constructor = NumberWrapper;
  redefine(global, NUMBER, NumberWrapper);
}


/***/ }),

/***/ "ab13":
/***/ (function(module, exports, __webpack_require__) {

var wellKnownSymbol = __webpack_require__("b622");

var MATCH = wellKnownSymbol('match');

module.exports = function (METHOD_NAME) {
  var regexp = /./;
  try {
    '/./'[METHOD_NAME](regexp);
  } catch (error1) {
    try {
      regexp[MATCH] = false;
      return '/./'[METHOD_NAME](regexp);
    } catch (error2) { /* empty */ }
  } return false;
};


/***/ }),

/***/ "ac1b":
/***/ (function(module, exports, __webpack_require__) {

// style-loader: Adds some css to the DOM by adding a <style> tag

// load the styles
var content = __webpack_require__("76d7");
if(content.__esModule) content = content.default;
if(typeof content === 'string') content = [[module.i, content, '']];
if(content.locals) module.exports = content.locals;
// add the styles to the DOM
var add = __webpack_require__("499e").default
var update = add("59bfb4b5", content, true, {"sourceMap":false,"shadowMode":false});

/***/ }),

/***/ "ac1f":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var $ = __webpack_require__("23e7");
var exec = __webpack_require__("9263");

// `RegExp.prototype.exec` method
// https://tc39.es/ecma262/#sec-regexp.prototype.exec
$({ target: 'RegExp', proto: true, forced: /./.exec !== exec }, {
  exec: exec
});


/***/ }),

/***/ "ace4":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var $ = __webpack_require__("23e7");
var uncurryThis = __webpack_require__("e330");
var fails = __webpack_require__("d039");
var ArrayBufferModule = __webpack_require__("621a");
var anObject = __webpack_require__("825a");
var toAbsoluteIndex = __webpack_require__("23cb");
var toLength = __webpack_require__("50c4");
var speciesConstructor = __webpack_require__("4840");

var ArrayBuffer = ArrayBufferModule.ArrayBuffer;
var DataView = ArrayBufferModule.DataView;
var DataViewPrototype = DataView.prototype;
var un$ArrayBufferSlice = uncurryThis(ArrayBuffer.prototype.slice);
var getUint8 = uncurryThis(DataViewPrototype.getUint8);
var setUint8 = uncurryThis(DataViewPrototype.setUint8);

var INCORRECT_SLICE = fails(function () {
  return !new ArrayBuffer(2).slice(1, undefined).byteLength;
});

// `ArrayBuffer.prototype.slice` method
// https://tc39.es/ecma262/#sec-arraybuffer.prototype.slice
$({ target: 'ArrayBuffer', proto: true, unsafe: true, forced: INCORRECT_SLICE }, {
  slice: function slice(start, end) {
    if (un$ArrayBufferSlice && end === undefined) {
      return un$ArrayBufferSlice(anObject(this), start); // FF fix
    }
    var length = anObject(this).byteLength;
    var first = toAbsoluteIndex(start, length);
    var fin = toAbsoluteIndex(end === undefined ? length : end, length);
    var result = new (speciesConstructor(this, ArrayBuffer))(toLength(fin - first));
    var viewSource = new DataView(this);
    var viewTarget = new DataView(result);
    var index = 0;
    while (first < fin) {
      setUint8(viewTarget, index++, getUint8(viewSource, first++));
    } return result;
  }
});


/***/ }),

/***/ "ad6d":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var anObject = __webpack_require__("825a");

// `RegExp.prototype.flags` getter implementation
// https://tc39.es/ecma262/#sec-get-regexp.prototype.flags
module.exports = function () {
  var that = anObject(this);
  var result = '';
  if (that.global) result += 'g';
  if (that.ignoreCase) result += 'i';
  if (that.multiline) result += 'm';
  if (that.dotAll) result += 's';
  if (that.unicode) result += 'u';
  if (that.sticky) result += 'y';
  return result;
};


/***/ }),

/***/ "addb":
/***/ (function(module, exports, __webpack_require__) {

var arraySlice = __webpack_require__("f36a");

var floor = Math.floor;

var mergeSort = function (array, comparefn) {
  var length = array.length;
  var middle = floor(length / 2);
  return length < 8 ? insertionSort(array, comparefn) : merge(
    array,
    mergeSort(arraySlice(array, 0, middle), comparefn),
    mergeSort(arraySlice(array, middle), comparefn),
    comparefn
  );
};

var insertionSort = function (array, comparefn) {
  var length = array.length;
  var i = 1;
  var element, j;

  while (i < length) {
    j = i;
    element = array[i];
    while (j && comparefn(array[j - 1], element) > 0) {
      array[j] = array[--j];
    }
    if (j !== i++) array[j] = element;
  } return array;
};

var merge = function (array, left, right, comparefn) {
  var llength = left.length;
  var rlength = right.length;
  var lindex = 0;
  var rindex = 0;

  while (lindex < llength || rindex < rlength) {
    array[lindex + rindex] = (lindex < llength && rindex < rlength)
      ? comparefn(left[lindex], right[rindex]) <= 0 ? left[lindex++] : right[rindex++]
      : lindex < llength ? left[lindex++] : right[rindex++];
  } return array;
};

module.exports = mergeSort;


/***/ }),

/***/ "ae93":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var fails = __webpack_require__("d039");
var isCallable = __webpack_require__("1626");
var create = __webpack_require__("7c73");
var getPrototypeOf = __webpack_require__("e163");
var redefine = __webpack_require__("6eeb");
var wellKnownSymbol = __webpack_require__("b622");
var IS_PURE = __webpack_require__("c430");

var ITERATOR = wellKnownSymbol('iterator');
var BUGGY_SAFARI_ITERATORS = false;

// `%IteratorPrototype%` object
// https://tc39.es/ecma262/#sec-%iteratorprototype%-object
var IteratorPrototype, PrototypeOfArrayIteratorPrototype, arrayIterator;

/* eslint-disable es/no-array-prototype-keys -- safe */
if ([].keys) {
  arrayIterator = [].keys();
  // Safari 8 has buggy iterators w/o `next`
  if (!('next' in arrayIterator)) BUGGY_SAFARI_ITERATORS = true;
  else {
    PrototypeOfArrayIteratorPrototype = getPrototypeOf(getPrototypeOf(arrayIterator));
    if (PrototypeOfArrayIteratorPrototype !== Object.prototype) IteratorPrototype = PrototypeOfArrayIteratorPrototype;
  }
}

var NEW_ITERATOR_PROTOTYPE = IteratorPrototype == undefined || fails(function () {
  var test = {};
  // FF44- legacy iterators case
  return IteratorPrototype[ITERATOR].call(test) !== test;
});

if (NEW_ITERATOR_PROTOTYPE) IteratorPrototype = {};
else if (IS_PURE) IteratorPrototype = create(IteratorPrototype);

// `%IteratorPrototype%[@@iterator]()` method
// https://tc39.es/ecma262/#sec-%iteratorprototype%-@@iterator
if (!isCallable(IteratorPrototype[ITERATOR])) {
  redefine(IteratorPrototype, ITERATOR, function () {
    return this;
  });
}

module.exports = {
  IteratorPrototype: IteratorPrototype,
  BUGGY_SAFARI_ITERATORS: BUGGY_SAFARI_ITERATORS
};


/***/ }),

/***/ "af03":
/***/ (function(module, exports, __webpack_require__) {

var fails = __webpack_require__("d039");

// check the existence of a method, lowercase
// of a tag and escaping quotes in arguments
module.exports = function (METHOD_NAME) {
  return fails(function () {
    var test = ''[METHOD_NAME]('"');
    return test !== test.toLowerCase() || test.split('"').length > 3;
  });
};


/***/ }),

/***/ "b041":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var TO_STRING_TAG_SUPPORT = __webpack_require__("00ee");
var classof = __webpack_require__("f5df");

// `Object.prototype.toString` method implementation
// https://tc39.es/ecma262/#sec-object.prototype.tostring
module.exports = TO_STRING_TAG_SUPPORT ? {}.toString : function toString() {
  return '[object ' + classof(this) + ']';
};


/***/ }),

/***/ "b0c0":
/***/ (function(module, exports, __webpack_require__) {

var DESCRIPTORS = __webpack_require__("83ab");
var FUNCTION_NAME_EXISTS = __webpack_require__("5e77").EXISTS;
var uncurryThis = __webpack_require__("e330");
var defineProperty = __webpack_require__("9bf2").f;

var FunctionPrototype = Function.prototype;
var functionToString = uncurryThis(FunctionPrototype.toString);
var nameRE = /^\s*function ([^ (]*)/;
var regExpExec = uncurryThis(nameRE.exec);
var NAME = 'name';

// Function instances `.name` property
// https://tc39.es/ecma262/#sec-function-instances-name
if (DESCRIPTORS && !FUNCTION_NAME_EXISTS) {
  defineProperty(FunctionPrototype, NAME, {
    configurable: true,
    get: function () {
      try {
        return regExpExec(nameRE, functionToString(this))[1];
      } catch (error) {
        return '';
      }
    }
  });
}


/***/ }),

/***/ "b39a":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var global = __webpack_require__("da84");
var apply = __webpack_require__("2ba4");
var ArrayBufferViewCore = __webpack_require__("ebb5");
var fails = __webpack_require__("d039");
var arraySlice = __webpack_require__("f36a");

var Int8Array = global.Int8Array;
var aTypedArray = ArrayBufferViewCore.aTypedArray;
var exportTypedArrayMethod = ArrayBufferViewCore.exportTypedArrayMethod;
var $toLocaleString = [].toLocaleString;

// iOS Safari 6.x fails here
var TO_LOCALE_STRING_BUG = !!Int8Array && fails(function () {
  $toLocaleString.call(new Int8Array(1));
});

var FORCED = fails(function () {
  return [1, 2].toLocaleString() != new Int8Array([1, 2]).toLocaleString();
}) || !fails(function () {
  Int8Array.prototype.toLocaleString.call([1, 2]);
});

// `%TypedArray%.prototype.toLocaleString` method
// https://tc39.es/ecma262/#sec-%typedarray%.prototype.tolocalestring
exportTypedArrayMethod('toLocaleString', function toLocaleString() {
  return apply(
    $toLocaleString,
    TO_LOCALE_STRING_BUG ? arraySlice(aTypedArray(this)) : aTypedArray(this),
    arraySlice(arguments)
  );
}, FORCED);


/***/ }),

/***/ "b3bd":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var _node_modules_vue_style_loader_index_js_ref_9_oneOf_1_0_node_modules_css_loader_dist_cjs_js_ref_9_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_9_oneOf_1_2_node_modules_postcss_loader_src_index_js_ref_9_oneOf_1_3_node_modules_sass_loader_dist_cjs_js_ref_9_oneOf_1_4_node_modules_cache_loader_dist_cjs_js_ref_1_0_node_modules_vue_loader_lib_index_js_vue_loader_options_index_vue_vue_type_style_index_0_id_04b2b68d_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("ba8b");
/* harmony import */ var _node_modules_vue_style_loader_index_js_ref_9_oneOf_1_0_node_modules_css_loader_dist_cjs_js_ref_9_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_9_oneOf_1_2_node_modules_postcss_loader_src_index_js_ref_9_oneOf_1_3_node_modules_sass_loader_dist_cjs_js_ref_9_oneOf_1_4_node_modules_cache_loader_dist_cjs_js_ref_1_0_node_modules_vue_loader_lib_index_js_vue_loader_options_index_vue_vue_type_style_index_0_id_04b2b68d_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_node_modules_vue_style_loader_index_js_ref_9_oneOf_1_0_node_modules_css_loader_dist_cjs_js_ref_9_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_9_oneOf_1_2_node_modules_postcss_loader_src_index_js_ref_9_oneOf_1_3_node_modules_sass_loader_dist_cjs_js_ref_9_oneOf_1_4_node_modules_cache_loader_dist_cjs_js_ref_1_0_node_modules_vue_loader_lib_index_js_vue_loader_options_index_vue_vue_type_style_index_0_id_04b2b68d_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0__);
/* unused harmony reexport * */


/***/ }),

/***/ "b575":
/***/ (function(module, exports, __webpack_require__) {

var global = __webpack_require__("da84");
var bind = __webpack_require__("0366");
var getOwnPropertyDescriptor = __webpack_require__("06cf").f;
var macrotask = __webpack_require__("2cf4").set;
var IS_IOS = __webpack_require__("1cdc");
var IS_IOS_PEBBLE = __webpack_require__("d4c3");
var IS_WEBOS_WEBKIT = __webpack_require__("a4b4");
var IS_NODE = __webpack_require__("605d");

var MutationObserver = global.MutationObserver || global.WebKitMutationObserver;
var document = global.document;
var process = global.process;
var Promise = global.Promise;
// Node.js 11 shows ExperimentalWarning on getting `queueMicrotask`
var queueMicrotaskDescriptor = getOwnPropertyDescriptor(global, 'queueMicrotask');
var queueMicrotask = queueMicrotaskDescriptor && queueMicrotaskDescriptor.value;

var flush, head, last, notify, toggle, node, promise, then;

// modern engines have queueMicrotask method
if (!queueMicrotask) {
  flush = function () {
    var parent, fn;
    if (IS_NODE && (parent = process.domain)) parent.exit();
    while (head) {
      fn = head.fn;
      head = head.next;
      try {
        fn();
      } catch (error) {
        if (head) notify();
        else last = undefined;
        throw error;
      }
    } last = undefined;
    if (parent) parent.enter();
  };

  // browsers with MutationObserver, except iOS - https://github.com/zloirock/core-js/issues/339
  // also except WebOS Webkit https://github.com/zloirock/core-js/issues/898
  if (!IS_IOS && !IS_NODE && !IS_WEBOS_WEBKIT && MutationObserver && document) {
    toggle = true;
    node = document.createTextNode('');
    new MutationObserver(flush).observe(node, { characterData: true });
    notify = function () {
      node.data = toggle = !toggle;
    };
  // environments with maybe non-completely correct, but existent Promise
  } else if (!IS_IOS_PEBBLE && Promise && Promise.resolve) {
    // Promise.resolve without an argument throws an error in LG WebOS 2
    promise = Promise.resolve(undefined);
    // workaround of WebKit ~ iOS Safari 10.1 bug
    promise.constructor = Promise;
    then = bind(promise.then, promise);
    notify = function () {
      then(flush);
    };
  // Node.js without promises
  } else if (IS_NODE) {
    notify = function () {
      process.nextTick(flush);
    };
  // for other environments - macrotask based on:
  // - setImmediate
  // - MessageChannel
  // - window.postMessag
  // - onreadystatechange
  // - setTimeout
  } else {
    // strange IE + webpack dev server bug - use .bind(global)
    macrotask = bind(macrotask, global);
    notify = function () {
      macrotask(flush);
    };
  }
}

module.exports = queueMicrotask || function (fn) {
  var task = { fn: fn, next: undefined };
  if (last) last.next = task;
  if (!head) {
    head = task;
    notify();
  } last = task;
};


/***/ }),

/***/ "b622":
/***/ (function(module, exports, __webpack_require__) {

var global = __webpack_require__("da84");
var shared = __webpack_require__("5692");
var hasOwn = __webpack_require__("1a2d");
var uid = __webpack_require__("90e3");
var NATIVE_SYMBOL = __webpack_require__("4930");
var USE_SYMBOL_AS_UID = __webpack_require__("fdbf");

var WellKnownSymbolsStore = shared('wks');
var Symbol = global.Symbol;
var symbolFor = Symbol && Symbol['for'];
var createWellKnownSymbol = USE_SYMBOL_AS_UID ? Symbol : Symbol && Symbol.withoutSetter || uid;

module.exports = function (name) {
  if (!hasOwn(WellKnownSymbolsStore, name) || !(NATIVE_SYMBOL || typeof WellKnownSymbolsStore[name] == 'string')) {
    var description = 'Symbol.' + name;
    if (NATIVE_SYMBOL && hasOwn(Symbol, name)) {
      WellKnownSymbolsStore[name] = Symbol[name];
    } else if (USE_SYMBOL_AS_UID && symbolFor) {
      WellKnownSymbolsStore[name] = symbolFor(description);
    } else {
      WellKnownSymbolsStore[name] = createWellKnownSymbol(description);
    }
  } return WellKnownSymbolsStore[name];
};


/***/ }),

/***/ "b639":
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function(global) {/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <http://feross.org>
 * @license  MIT
 */
/* eslint-disable no-proto */



var base64 = __webpack_require__("1fb5")
var ieee754 = __webpack_require__("9152")
var isArray = __webpack_require__("e3db")

exports.Buffer = Buffer
exports.SlowBuffer = SlowBuffer
exports.INSPECT_MAX_BYTES = 50

/**
 * If `Buffer.TYPED_ARRAY_SUPPORT`:
 *   === true    Use Uint8Array implementation (fastest)
 *   === false   Use Object implementation (most compatible, even IE6)
 *
 * Browsers that support typed arrays are IE 10+, Firefox 4+, Chrome 7+, Safari 5.1+,
 * Opera 11.6+, iOS 4.2+.
 *
 * Due to various browser bugs, sometimes the Object implementation will be used even
 * when the browser supports typed arrays.
 *
 * Note:
 *
 *   - Firefox 4-29 lacks support for adding new properties to `Uint8Array` instances,
 *     See: https://bugzilla.mozilla.org/show_bug.cgi?id=695438.
 *
 *   - Chrome 9-10 is missing the `TypedArray.prototype.subarray` function.
 *
 *   - IE10 has a broken `TypedArray.prototype.subarray` function which returns arrays of
 *     incorrect length in some situations.

 * We detect these buggy browsers and set `Buffer.TYPED_ARRAY_SUPPORT` to `false` so they
 * get the Object implementation, which is slower but behaves correctly.
 */
Buffer.TYPED_ARRAY_SUPPORT = global.TYPED_ARRAY_SUPPORT !== undefined
  ? global.TYPED_ARRAY_SUPPORT
  : typedArraySupport()

/*
 * Export kMaxLength after typed array support is determined.
 */
exports.kMaxLength = kMaxLength()

function typedArraySupport () {
  try {
    var arr = new Uint8Array(1)
    arr.__proto__ = {__proto__: Uint8Array.prototype, foo: function () { return 42 }}
    return arr.foo() === 42 && // typed array instances can be augmented
        typeof arr.subarray === 'function' && // chrome 9-10 lack `subarray`
        arr.subarray(1, 1).byteLength === 0 // ie10 has broken `subarray`
  } catch (e) {
    return false
  }
}

function kMaxLength () {
  return Buffer.TYPED_ARRAY_SUPPORT
    ? 0x7fffffff
    : 0x3fffffff
}

function createBuffer (that, length) {
  if (kMaxLength() < length) {
    throw new RangeError('Invalid typed array length')
  }
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    // Return an augmented `Uint8Array` instance, for best performance
    that = new Uint8Array(length)
    that.__proto__ = Buffer.prototype
  } else {
    // Fallback: Return an object instance of the Buffer class
    if (that === null) {
      that = new Buffer(length)
    }
    that.length = length
  }

  return that
}

/**
 * The Buffer constructor returns instances of `Uint8Array` that have their
 * prototype changed to `Buffer.prototype`. Furthermore, `Buffer` is a subclass of
 * `Uint8Array`, so the returned instances will have all the node `Buffer` methods
 * and the `Uint8Array` methods. Square bracket notation works as expected -- it
 * returns a single octet.
 *
 * The `Uint8Array` prototype remains unmodified.
 */

function Buffer (arg, encodingOrOffset, length) {
  if (!Buffer.TYPED_ARRAY_SUPPORT && !(this instanceof Buffer)) {
    return new Buffer(arg, encodingOrOffset, length)
  }

  // Common case.
  if (typeof arg === 'number') {
    if (typeof encodingOrOffset === 'string') {
      throw new Error(
        'If encoding is specified then the first argument must be a string'
      )
    }
    return allocUnsafe(this, arg)
  }
  return from(this, arg, encodingOrOffset, length)
}

Buffer.poolSize = 8192 // not used by this implementation

// TODO: Legacy, not needed anymore. Remove in next major version.
Buffer._augment = function (arr) {
  arr.__proto__ = Buffer.prototype
  return arr
}

function from (that, value, encodingOrOffset, length) {
  if (typeof value === 'number') {
    throw new TypeError('"value" argument must not be a number')
  }

  if (typeof ArrayBuffer !== 'undefined' && value instanceof ArrayBuffer) {
    return fromArrayBuffer(that, value, encodingOrOffset, length)
  }

  if (typeof value === 'string') {
    return fromString(that, value, encodingOrOffset)
  }

  return fromObject(that, value)
}

/**
 * Functionally equivalent to Buffer(arg, encoding) but throws a TypeError
 * if value is a number.
 * Buffer.from(str[, encoding])
 * Buffer.from(array)
 * Buffer.from(buffer)
 * Buffer.from(arrayBuffer[, byteOffset[, length]])
 **/
Buffer.from = function (value, encodingOrOffset, length) {
  return from(null, value, encodingOrOffset, length)
}

if (Buffer.TYPED_ARRAY_SUPPORT) {
  Buffer.prototype.__proto__ = Uint8Array.prototype
  Buffer.__proto__ = Uint8Array
  if (typeof Symbol !== 'undefined' && Symbol.species &&
      Buffer[Symbol.species] === Buffer) {
    // Fix subarray() in ES2016. See: https://github.com/feross/buffer/pull/97
    Object.defineProperty(Buffer, Symbol.species, {
      value: null,
      configurable: true
    })
  }
}

function assertSize (size) {
  if (typeof size !== 'number') {
    throw new TypeError('"size" argument must be a number')
  } else if (size < 0) {
    throw new RangeError('"size" argument must not be negative')
  }
}

function alloc (that, size, fill, encoding) {
  assertSize(size)
  if (size <= 0) {
    return createBuffer(that, size)
  }
  if (fill !== undefined) {
    // Only pay attention to encoding if it's a string. This
    // prevents accidentally sending in a number that would
    // be interpretted as a start offset.
    return typeof encoding === 'string'
      ? createBuffer(that, size).fill(fill, encoding)
      : createBuffer(that, size).fill(fill)
  }
  return createBuffer(that, size)
}

/**
 * Creates a new filled Buffer instance.
 * alloc(size[, fill[, encoding]])
 **/
Buffer.alloc = function (size, fill, encoding) {
  return alloc(null, size, fill, encoding)
}

function allocUnsafe (that, size) {
  assertSize(size)
  that = createBuffer(that, size < 0 ? 0 : checked(size) | 0)
  if (!Buffer.TYPED_ARRAY_SUPPORT) {
    for (var i = 0; i < size; ++i) {
      that[i] = 0
    }
  }
  return that
}

/**
 * Equivalent to Buffer(num), by default creates a non-zero-filled Buffer instance.
 * */
Buffer.allocUnsafe = function (size) {
  return allocUnsafe(null, size)
}
/**
 * Equivalent to SlowBuffer(num), by default creates a non-zero-filled Buffer instance.
 */
Buffer.allocUnsafeSlow = function (size) {
  return allocUnsafe(null, size)
}

function fromString (that, string, encoding) {
  if (typeof encoding !== 'string' || encoding === '') {
    encoding = 'utf8'
  }

  if (!Buffer.isEncoding(encoding)) {
    throw new TypeError('"encoding" must be a valid string encoding')
  }

  var length = byteLength(string, encoding) | 0
  that = createBuffer(that, length)

  var actual = that.write(string, encoding)

  if (actual !== length) {
    // Writing a hex string, for example, that contains invalid characters will
    // cause everything after the first invalid character to be ignored. (e.g.
    // 'abxxcd' will be treated as 'ab')
    that = that.slice(0, actual)
  }

  return that
}

function fromArrayLike (that, array) {
  var length = array.length < 0 ? 0 : checked(array.length) | 0
  that = createBuffer(that, length)
  for (var i = 0; i < length; i += 1) {
    that[i] = array[i] & 255
  }
  return that
}

function fromArrayBuffer (that, array, byteOffset, length) {
  array.byteLength // this throws if `array` is not a valid ArrayBuffer

  if (byteOffset < 0 || array.byteLength < byteOffset) {
    throw new RangeError('\'offset\' is out of bounds')
  }

  if (array.byteLength < byteOffset + (length || 0)) {
    throw new RangeError('\'length\' is out of bounds')
  }

  if (byteOffset === undefined && length === undefined) {
    array = new Uint8Array(array)
  } else if (length === undefined) {
    array = new Uint8Array(array, byteOffset)
  } else {
    array = new Uint8Array(array, byteOffset, length)
  }

  if (Buffer.TYPED_ARRAY_SUPPORT) {
    // Return an augmented `Uint8Array` instance, for best performance
    that = array
    that.__proto__ = Buffer.prototype
  } else {
    // Fallback: Return an object instance of the Buffer class
    that = fromArrayLike(that, array)
  }
  return that
}

function fromObject (that, obj) {
  if (Buffer.isBuffer(obj)) {
    var len = checked(obj.length) | 0
    that = createBuffer(that, len)

    if (that.length === 0) {
      return that
    }

    obj.copy(that, 0, 0, len)
    return that
  }

  if (obj) {
    if ((typeof ArrayBuffer !== 'undefined' &&
        obj.buffer instanceof ArrayBuffer) || 'length' in obj) {
      if (typeof obj.length !== 'number' || isnan(obj.length)) {
        return createBuffer(that, 0)
      }
      return fromArrayLike(that, obj)
    }

    if (obj.type === 'Buffer' && isArray(obj.data)) {
      return fromArrayLike(that, obj.data)
    }
  }

  throw new TypeError('First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.')
}

function checked (length) {
  // Note: cannot use `length < kMaxLength()` here because that fails when
  // length is NaN (which is otherwise coerced to zero.)
  if (length >= kMaxLength()) {
    throw new RangeError('Attempt to allocate Buffer larger than maximum ' +
                         'size: 0x' + kMaxLength().toString(16) + ' bytes')
  }
  return length | 0
}

function SlowBuffer (length) {
  if (+length != length) { // eslint-disable-line eqeqeq
    length = 0
  }
  return Buffer.alloc(+length)
}

Buffer.isBuffer = function isBuffer (b) {
  return !!(b != null && b._isBuffer)
}

Buffer.compare = function compare (a, b) {
  if (!Buffer.isBuffer(a) || !Buffer.isBuffer(b)) {
    throw new TypeError('Arguments must be Buffers')
  }

  if (a === b) return 0

  var x = a.length
  var y = b.length

  for (var i = 0, len = Math.min(x, y); i < len; ++i) {
    if (a[i] !== b[i]) {
      x = a[i]
      y = b[i]
      break
    }
  }

  if (x < y) return -1
  if (y < x) return 1
  return 0
}

Buffer.isEncoding = function isEncoding (encoding) {
  switch (String(encoding).toLowerCase()) {
    case 'hex':
    case 'utf8':
    case 'utf-8':
    case 'ascii':
    case 'latin1':
    case 'binary':
    case 'base64':
    case 'ucs2':
    case 'ucs-2':
    case 'utf16le':
    case 'utf-16le':
      return true
    default:
      return false
  }
}

Buffer.concat = function concat (list, length) {
  if (!isArray(list)) {
    throw new TypeError('"list" argument must be an Array of Buffers')
  }

  if (list.length === 0) {
    return Buffer.alloc(0)
  }

  var i
  if (length === undefined) {
    length = 0
    for (i = 0; i < list.length; ++i) {
      length += list[i].length
    }
  }

  var buffer = Buffer.allocUnsafe(length)
  var pos = 0
  for (i = 0; i < list.length; ++i) {
    var buf = list[i]
    if (!Buffer.isBuffer(buf)) {
      throw new TypeError('"list" argument must be an Array of Buffers')
    }
    buf.copy(buffer, pos)
    pos += buf.length
  }
  return buffer
}

function byteLength (string, encoding) {
  if (Buffer.isBuffer(string)) {
    return string.length
  }
  if (typeof ArrayBuffer !== 'undefined' && typeof ArrayBuffer.isView === 'function' &&
      (ArrayBuffer.isView(string) || string instanceof ArrayBuffer)) {
    return string.byteLength
  }
  if (typeof string !== 'string') {
    string = '' + string
  }

  var len = string.length
  if (len === 0) return 0

  // Use a for loop to avoid recursion
  var loweredCase = false
  for (;;) {
    switch (encoding) {
      case 'ascii':
      case 'latin1':
      case 'binary':
        return len
      case 'utf8':
      case 'utf-8':
      case undefined:
        return utf8ToBytes(string).length
      case 'ucs2':
      case 'ucs-2':
      case 'utf16le':
      case 'utf-16le':
        return len * 2
      case 'hex':
        return len >>> 1
      case 'base64':
        return base64ToBytes(string).length
      default:
        if (loweredCase) return utf8ToBytes(string).length // assume utf8
        encoding = ('' + encoding).toLowerCase()
        loweredCase = true
    }
  }
}
Buffer.byteLength = byteLength

function slowToString (encoding, start, end) {
  var loweredCase = false

  // No need to verify that "this.length <= MAX_UINT32" since it's a read-only
  // property of a typed array.

  // This behaves neither like String nor Uint8Array in that we set start/end
  // to their upper/lower bounds if the value passed is out of range.
  // undefined is handled specially as per ECMA-262 6th Edition,
  // Section 13.3.3.7 Runtime Semantics: KeyedBindingInitialization.
  if (start === undefined || start < 0) {
    start = 0
  }
  // Return early if start > this.length. Done here to prevent potential uint32
  // coercion fail below.
  if (start > this.length) {
    return ''
  }

  if (end === undefined || end > this.length) {
    end = this.length
  }

  if (end <= 0) {
    return ''
  }

  // Force coersion to uint32. This will also coerce falsey/NaN values to 0.
  end >>>= 0
  start >>>= 0

  if (end <= start) {
    return ''
  }

  if (!encoding) encoding = 'utf8'

  while (true) {
    switch (encoding) {
      case 'hex':
        return hexSlice(this, start, end)

      case 'utf8':
      case 'utf-8':
        return utf8Slice(this, start, end)

      case 'ascii':
        return asciiSlice(this, start, end)

      case 'latin1':
      case 'binary':
        return latin1Slice(this, start, end)

      case 'base64':
        return base64Slice(this, start, end)

      case 'ucs2':
      case 'ucs-2':
      case 'utf16le':
      case 'utf-16le':
        return utf16leSlice(this, start, end)

      default:
        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)
        encoding = (encoding + '').toLowerCase()
        loweredCase = true
    }
  }
}

// The property is used by `Buffer.isBuffer` and `is-buffer` (in Safari 5-7) to detect
// Buffer instances.
Buffer.prototype._isBuffer = true

function swap (b, n, m) {
  var i = b[n]
  b[n] = b[m]
  b[m] = i
}

Buffer.prototype.swap16 = function swap16 () {
  var len = this.length
  if (len % 2 !== 0) {
    throw new RangeError('Buffer size must be a multiple of 16-bits')
  }
  for (var i = 0; i < len; i += 2) {
    swap(this, i, i + 1)
  }
  return this
}

Buffer.prototype.swap32 = function swap32 () {
  var len = this.length
  if (len % 4 !== 0) {
    throw new RangeError('Buffer size must be a multiple of 32-bits')
  }
  for (var i = 0; i < len; i += 4) {
    swap(this, i, i + 3)
    swap(this, i + 1, i + 2)
  }
  return this
}

Buffer.prototype.swap64 = function swap64 () {
  var len = this.length
  if (len % 8 !== 0) {
    throw new RangeError('Buffer size must be a multiple of 64-bits')
  }
  for (var i = 0; i < len; i += 8) {
    swap(this, i, i + 7)
    swap(this, i + 1, i + 6)
    swap(this, i + 2, i + 5)
    swap(this, i + 3, i + 4)
  }
  return this
}

Buffer.prototype.toString = function toString () {
  var length = this.length | 0
  if (length === 0) return ''
  if (arguments.length === 0) return utf8Slice(this, 0, length)
  return slowToString.apply(this, arguments)
}

Buffer.prototype.equals = function equals (b) {
  if (!Buffer.isBuffer(b)) throw new TypeError('Argument must be a Buffer')
  if (this === b) return true
  return Buffer.compare(this, b) === 0
}

Buffer.prototype.inspect = function inspect () {
  var str = ''
  var max = exports.INSPECT_MAX_BYTES
  if (this.length > 0) {
    str = this.toString('hex', 0, max).match(/.{2}/g).join(' ')
    if (this.length > max) str += ' ... '
  }
  return '<Buffer ' + str + '>'
}

Buffer.prototype.compare = function compare (target, start, end, thisStart, thisEnd) {
  if (!Buffer.isBuffer(target)) {
    throw new TypeError('Argument must be a Buffer')
  }

  if (start === undefined) {
    start = 0
  }
  if (end === undefined) {
    end = target ? target.length : 0
  }
  if (thisStart === undefined) {
    thisStart = 0
  }
  if (thisEnd === undefined) {
    thisEnd = this.length
  }

  if (start < 0 || end > target.length || thisStart < 0 || thisEnd > this.length) {
    throw new RangeError('out of range index')
  }

  if (thisStart >= thisEnd && start >= end) {
    return 0
  }
  if (thisStart >= thisEnd) {
    return -1
  }
  if (start >= end) {
    return 1
  }

  start >>>= 0
  end >>>= 0
  thisStart >>>= 0
  thisEnd >>>= 0

  if (this === target) return 0

  var x = thisEnd - thisStart
  var y = end - start
  var len = Math.min(x, y)

  var thisCopy = this.slice(thisStart, thisEnd)
  var targetCopy = target.slice(start, end)

  for (var i = 0; i < len; ++i) {
    if (thisCopy[i] !== targetCopy[i]) {
      x = thisCopy[i]
      y = targetCopy[i]
      break
    }
  }

  if (x < y) return -1
  if (y < x) return 1
  return 0
}

// Finds either the first index of `val` in `buffer` at offset >= `byteOffset`,
// OR the last index of `val` in `buffer` at offset <= `byteOffset`.
//
// Arguments:
// - buffer - a Buffer to search
// - val - a string, Buffer, or number
// - byteOffset - an index into `buffer`; will be clamped to an int32
// - encoding - an optional encoding, relevant is val is a string
// - dir - true for indexOf, false for lastIndexOf
function bidirectionalIndexOf (buffer, val, byteOffset, encoding, dir) {
  // Empty buffer means no match
  if (buffer.length === 0) return -1

  // Normalize byteOffset
  if (typeof byteOffset === 'string') {
    encoding = byteOffset
    byteOffset = 0
  } else if (byteOffset > 0x7fffffff) {
    byteOffset = 0x7fffffff
  } else if (byteOffset < -0x80000000) {
    byteOffset = -0x80000000
  }
  byteOffset = +byteOffset  // Coerce to Number.
  if (isNaN(byteOffset)) {
    // byteOffset: it it's undefined, null, NaN, "foo", etc, search whole buffer
    byteOffset = dir ? 0 : (buffer.length - 1)
  }

  // Normalize byteOffset: negative offsets start from the end of the buffer
  if (byteOffset < 0) byteOffset = buffer.length + byteOffset
  if (byteOffset >= buffer.length) {
    if (dir) return -1
    else byteOffset = buffer.length - 1
  } else if (byteOffset < 0) {
    if (dir) byteOffset = 0
    else return -1
  }

  // Normalize val
  if (typeof val === 'string') {
    val = Buffer.from(val, encoding)
  }

  // Finally, search either indexOf (if dir is true) or lastIndexOf
  if (Buffer.isBuffer(val)) {
    // Special case: looking for empty string/buffer always fails
    if (val.length === 0) {
      return -1
    }
    return arrayIndexOf(buffer, val, byteOffset, encoding, dir)
  } else if (typeof val === 'number') {
    val = val & 0xFF // Search for a byte value [0-255]
    if (Buffer.TYPED_ARRAY_SUPPORT &&
        typeof Uint8Array.prototype.indexOf === 'function') {
      if (dir) {
        return Uint8Array.prototype.indexOf.call(buffer, val, byteOffset)
      } else {
        return Uint8Array.prototype.lastIndexOf.call(buffer, val, byteOffset)
      }
    }
    return arrayIndexOf(buffer, [ val ], byteOffset, encoding, dir)
  }

  throw new TypeError('val must be string, number or Buffer')
}

function arrayIndexOf (arr, val, byteOffset, encoding, dir) {
  var indexSize = 1
  var arrLength = arr.length
  var valLength = val.length

  if (encoding !== undefined) {
    encoding = String(encoding).toLowerCase()
    if (encoding === 'ucs2' || encoding === 'ucs-2' ||
        encoding === 'utf16le' || encoding === 'utf-16le') {
      if (arr.length < 2 || val.length < 2) {
        return -1
      }
      indexSize = 2
      arrLength /= 2
      valLength /= 2
      byteOffset /= 2
    }
  }

  function read (buf, i) {
    if (indexSize === 1) {
      return buf[i]
    } else {
      return buf.readUInt16BE(i * indexSize)
    }
  }

  var i
  if (dir) {
    var foundIndex = -1
    for (i = byteOffset; i < arrLength; i++) {
      if (read(arr, i) === read(val, foundIndex === -1 ? 0 : i - foundIndex)) {
        if (foundIndex === -1) foundIndex = i
        if (i - foundIndex + 1 === valLength) return foundIndex * indexSize
      } else {
        if (foundIndex !== -1) i -= i - foundIndex
        foundIndex = -1
      }
    }
  } else {
    if (byteOffset + valLength > arrLength) byteOffset = arrLength - valLength
    for (i = byteOffset; i >= 0; i--) {
      var found = true
      for (var j = 0; j < valLength; j++) {
        if (read(arr, i + j) !== read(val, j)) {
          found = false
          break
        }
      }
      if (found) return i
    }
  }

  return -1
}

Buffer.prototype.includes = function includes (val, byteOffset, encoding) {
  return this.indexOf(val, byteOffset, encoding) !== -1
}

Buffer.prototype.indexOf = function indexOf (val, byteOffset, encoding) {
  return bidirectionalIndexOf(this, val, byteOffset, encoding, true)
}

Buffer.prototype.lastIndexOf = function lastIndexOf (val, byteOffset, encoding) {
  return bidirectionalIndexOf(this, val, byteOffset, encoding, false)
}

function hexWrite (buf, string, offset, length) {
  offset = Number(offset) || 0
  var remaining = buf.length - offset
  if (!length) {
    length = remaining
  } else {
    length = Number(length)
    if (length > remaining) {
      length = remaining
    }
  }

  // must be an even number of digits
  var strLen = string.length
  if (strLen % 2 !== 0) throw new TypeError('Invalid hex string')

  if (length > strLen / 2) {
    length = strLen / 2
  }
  for (var i = 0; i < length; ++i) {
    var parsed = parseInt(string.substr(i * 2, 2), 16)
    if (isNaN(parsed)) return i
    buf[offset + i] = parsed
  }
  return i
}

function utf8Write (buf, string, offset, length) {
  return blitBuffer(utf8ToBytes(string, buf.length - offset), buf, offset, length)
}

function asciiWrite (buf, string, offset, length) {
  return blitBuffer(asciiToBytes(string), buf, offset, length)
}

function latin1Write (buf, string, offset, length) {
  return asciiWrite(buf, string, offset, length)
}

function base64Write (buf, string, offset, length) {
  return blitBuffer(base64ToBytes(string), buf, offset, length)
}

function ucs2Write (buf, string, offset, length) {
  return blitBuffer(utf16leToBytes(string, buf.length - offset), buf, offset, length)
}

Buffer.prototype.write = function write (string, offset, length, encoding) {
  // Buffer#write(string)
  if (offset === undefined) {
    encoding = 'utf8'
    length = this.length
    offset = 0
  // Buffer#write(string, encoding)
  } else if (length === undefined && typeof offset === 'string') {
    encoding = offset
    length = this.length
    offset = 0
  // Buffer#write(string, offset[, length][, encoding])
  } else if (isFinite(offset)) {
    offset = offset | 0
    if (isFinite(length)) {
      length = length | 0
      if (encoding === undefined) encoding = 'utf8'
    } else {
      encoding = length
      length = undefined
    }
  // legacy write(string, encoding, offset, length) - remove in v0.13
  } else {
    throw new Error(
      'Buffer.write(string, encoding, offset[, length]) is no longer supported'
    )
  }

  var remaining = this.length - offset
  if (length === undefined || length > remaining) length = remaining

  if ((string.length > 0 && (length < 0 || offset < 0)) || offset > this.length) {
    throw new RangeError('Attempt to write outside buffer bounds')
  }

  if (!encoding) encoding = 'utf8'

  var loweredCase = false
  for (;;) {
    switch (encoding) {
      case 'hex':
        return hexWrite(this, string, offset, length)

      case 'utf8':
      case 'utf-8':
        return utf8Write(this, string, offset, length)

      case 'ascii':
        return asciiWrite(this, string, offset, length)

      case 'latin1':
      case 'binary':
        return latin1Write(this, string, offset, length)

      case 'base64':
        // Warning: maxLength not taken into account in base64Write
        return base64Write(this, string, offset, length)

      case 'ucs2':
      case 'ucs-2':
      case 'utf16le':
      case 'utf-16le':
        return ucs2Write(this, string, offset, length)

      default:
        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)
        encoding = ('' + encoding).toLowerCase()
        loweredCase = true
    }
  }
}

Buffer.prototype.toJSON = function toJSON () {
  return {
    type: 'Buffer',
    data: Array.prototype.slice.call(this._arr || this, 0)
  }
}

function base64Slice (buf, start, end) {
  if (start === 0 && end === buf.length) {
    return base64.fromByteArray(buf)
  } else {
    return base64.fromByteArray(buf.slice(start, end))
  }
}

function utf8Slice (buf, start, end) {
  end = Math.min(buf.length, end)
  var res = []

  var i = start
  while (i < end) {
    var firstByte = buf[i]
    var codePoint = null
    var bytesPerSequence = (firstByte > 0xEF) ? 4
      : (firstByte > 0xDF) ? 3
      : (firstByte > 0xBF) ? 2
      : 1

    if (i + bytesPerSequence <= end) {
      var secondByte, thirdByte, fourthByte, tempCodePoint

      switch (bytesPerSequence) {
        case 1:
          if (firstByte < 0x80) {
            codePoint = firstByte
          }
          break
        case 2:
          secondByte = buf[i + 1]
          if ((secondByte & 0xC0) === 0x80) {
            tempCodePoint = (firstByte & 0x1F) << 0x6 | (secondByte & 0x3F)
            if (tempCodePoint > 0x7F) {
              codePoint = tempCodePoint
            }
          }
          break
        case 3:
          secondByte = buf[i + 1]
          thirdByte = buf[i + 2]
          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80) {
            tempCodePoint = (firstByte & 0xF) << 0xC | (secondByte & 0x3F) << 0x6 | (thirdByte & 0x3F)
            if (tempCodePoint > 0x7FF && (tempCodePoint < 0xD800 || tempCodePoint > 0xDFFF)) {
              codePoint = tempCodePoint
            }
          }
          break
        case 4:
          secondByte = buf[i + 1]
          thirdByte = buf[i + 2]
          fourthByte = buf[i + 3]
          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80 && (fourthByte & 0xC0) === 0x80) {
            tempCodePoint = (firstByte & 0xF) << 0x12 | (secondByte & 0x3F) << 0xC | (thirdByte & 0x3F) << 0x6 | (fourthByte & 0x3F)
            if (tempCodePoint > 0xFFFF && tempCodePoint < 0x110000) {
              codePoint = tempCodePoint
            }
          }
      }
    }

    if (codePoint === null) {
      // we did not generate a valid codePoint so insert a
      // replacement char (U+FFFD) and advance only 1 byte
      codePoint = 0xFFFD
      bytesPerSequence = 1
    } else if (codePoint > 0xFFFF) {
      // encode to utf16 (surrogate pair dance)
      codePoint -= 0x10000
      res.push(codePoint >>> 10 & 0x3FF | 0xD800)
      codePoint = 0xDC00 | codePoint & 0x3FF
    }

    res.push(codePoint)
    i += bytesPerSequence
  }

  return decodeCodePointsArray(res)
}

// Based on http://stackoverflow.com/a/22747272/680742, the browser with
// the lowest limit is Chrome, with 0x10000 args.
// We go 1 magnitude less, for safety
var MAX_ARGUMENTS_LENGTH = 0x1000

function decodeCodePointsArray (codePoints) {
  var len = codePoints.length
  if (len <= MAX_ARGUMENTS_LENGTH) {
    return String.fromCharCode.apply(String, codePoints) // avoid extra slice()
  }

  // Decode in chunks to avoid "call stack size exceeded".
  var res = ''
  var i = 0
  while (i < len) {
    res += String.fromCharCode.apply(
      String,
      codePoints.slice(i, i += MAX_ARGUMENTS_LENGTH)
    )
  }
  return res
}

function asciiSlice (buf, start, end) {
  var ret = ''
  end = Math.min(buf.length, end)

  for (var i = start; i < end; ++i) {
    ret += String.fromCharCode(buf[i] & 0x7F)
  }
  return ret
}

function latin1Slice (buf, start, end) {
  var ret = ''
  end = Math.min(buf.length, end)

  for (var i = start; i < end; ++i) {
    ret += String.fromCharCode(buf[i])
  }
  return ret
}

function hexSlice (buf, start, end) {
  var len = buf.length

  if (!start || start < 0) start = 0
  if (!end || end < 0 || end > len) end = len

  var out = ''
  for (var i = start; i < end; ++i) {
    out += toHex(buf[i])
  }
  return out
}

function utf16leSlice (buf, start, end) {
  var bytes = buf.slice(start, end)
  var res = ''
  for (var i = 0; i < bytes.length; i += 2) {
    res += String.fromCharCode(bytes[i] + bytes[i + 1] * 256)
  }
  return res
}

Buffer.prototype.slice = function slice (start, end) {
  var len = this.length
  start = ~~start
  end = end === undefined ? len : ~~end

  if (start < 0) {
    start += len
    if (start < 0) start = 0
  } else if (start > len) {
    start = len
  }

  if (end < 0) {
    end += len
    if (end < 0) end = 0
  } else if (end > len) {
    end = len
  }

  if (end < start) end = start

  var newBuf
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    newBuf = this.subarray(start, end)
    newBuf.__proto__ = Buffer.prototype
  } else {
    var sliceLen = end - start
    newBuf = new Buffer(sliceLen, undefined)
    for (var i = 0; i < sliceLen; ++i) {
      newBuf[i] = this[i + start]
    }
  }

  return newBuf
}

/*
 * Need to make sure that buffer isn't trying to write out of bounds.
 */
function checkOffset (offset, ext, length) {
  if ((offset % 1) !== 0 || offset < 0) throw new RangeError('offset is not uint')
  if (offset + ext > length) throw new RangeError('Trying to access beyond buffer length')
}

Buffer.prototype.readUIntLE = function readUIntLE (offset, byteLength, noAssert) {
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) checkOffset(offset, byteLength, this.length)

  var val = this[offset]
  var mul = 1
  var i = 0
  while (++i < byteLength && (mul *= 0x100)) {
    val += this[offset + i] * mul
  }

  return val
}

Buffer.prototype.readUIntBE = function readUIntBE (offset, byteLength, noAssert) {
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) {
    checkOffset(offset, byteLength, this.length)
  }

  var val = this[offset + --byteLength]
  var mul = 1
  while (byteLength > 0 && (mul *= 0x100)) {
    val += this[offset + --byteLength] * mul
  }

  return val
}

Buffer.prototype.readUInt8 = function readUInt8 (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 1, this.length)
  return this[offset]
}

Buffer.prototype.readUInt16LE = function readUInt16LE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 2, this.length)
  return this[offset] | (this[offset + 1] << 8)
}

Buffer.prototype.readUInt16BE = function readUInt16BE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 2, this.length)
  return (this[offset] << 8) | this[offset + 1]
}

Buffer.prototype.readUInt32LE = function readUInt32LE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)

  return ((this[offset]) |
      (this[offset + 1] << 8) |
      (this[offset + 2] << 16)) +
      (this[offset + 3] * 0x1000000)
}

Buffer.prototype.readUInt32BE = function readUInt32BE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)

  return (this[offset] * 0x1000000) +
    ((this[offset + 1] << 16) |
    (this[offset + 2] << 8) |
    this[offset + 3])
}

Buffer.prototype.readIntLE = function readIntLE (offset, byteLength, noAssert) {
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) checkOffset(offset, byteLength, this.length)

  var val = this[offset]
  var mul = 1
  var i = 0
  while (++i < byteLength && (mul *= 0x100)) {
    val += this[offset + i] * mul
  }
  mul *= 0x80

  if (val >= mul) val -= Math.pow(2, 8 * byteLength)

  return val
}

Buffer.prototype.readIntBE = function readIntBE (offset, byteLength, noAssert) {
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) checkOffset(offset, byteLength, this.length)

  var i = byteLength
  var mul = 1
  var val = this[offset + --i]
  while (i > 0 && (mul *= 0x100)) {
    val += this[offset + --i] * mul
  }
  mul *= 0x80

  if (val >= mul) val -= Math.pow(2, 8 * byteLength)

  return val
}

Buffer.prototype.readInt8 = function readInt8 (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 1, this.length)
  if (!(this[offset] & 0x80)) return (this[offset])
  return ((0xff - this[offset] + 1) * -1)
}

Buffer.prototype.readInt16LE = function readInt16LE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 2, this.length)
  var val = this[offset] | (this[offset + 1] << 8)
  return (val & 0x8000) ? val | 0xFFFF0000 : val
}

Buffer.prototype.readInt16BE = function readInt16BE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 2, this.length)
  var val = this[offset + 1] | (this[offset] << 8)
  return (val & 0x8000) ? val | 0xFFFF0000 : val
}

Buffer.prototype.readInt32LE = function readInt32LE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)

  return (this[offset]) |
    (this[offset + 1] << 8) |
    (this[offset + 2] << 16) |
    (this[offset + 3] << 24)
}

Buffer.prototype.readInt32BE = function readInt32BE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)

  return (this[offset] << 24) |
    (this[offset + 1] << 16) |
    (this[offset + 2] << 8) |
    (this[offset + 3])
}

Buffer.prototype.readFloatLE = function readFloatLE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)
  return ieee754.read(this, offset, true, 23, 4)
}

Buffer.prototype.readFloatBE = function readFloatBE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)
  return ieee754.read(this, offset, false, 23, 4)
}

Buffer.prototype.readDoubleLE = function readDoubleLE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 8, this.length)
  return ieee754.read(this, offset, true, 52, 8)
}

Buffer.prototype.readDoubleBE = function readDoubleBE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 8, this.length)
  return ieee754.read(this, offset, false, 52, 8)
}

function checkInt (buf, value, offset, ext, max, min) {
  if (!Buffer.isBuffer(buf)) throw new TypeError('"buffer" argument must be a Buffer instance')
  if (value > max || value < min) throw new RangeError('"value" argument is out of bounds')
  if (offset + ext > buf.length) throw new RangeError('Index out of range')
}

Buffer.prototype.writeUIntLE = function writeUIntLE (value, offset, byteLength, noAssert) {
  value = +value
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) {
    var maxBytes = Math.pow(2, 8 * byteLength) - 1
    checkInt(this, value, offset, byteLength, maxBytes, 0)
  }

  var mul = 1
  var i = 0
  this[offset] = value & 0xFF
  while (++i < byteLength && (mul *= 0x100)) {
    this[offset + i] = (value / mul) & 0xFF
  }

  return offset + byteLength
}

Buffer.prototype.writeUIntBE = function writeUIntBE (value, offset, byteLength, noAssert) {
  value = +value
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) {
    var maxBytes = Math.pow(2, 8 * byteLength) - 1
    checkInt(this, value, offset, byteLength, maxBytes, 0)
  }

  var i = byteLength - 1
  var mul = 1
  this[offset + i] = value & 0xFF
  while (--i >= 0 && (mul *= 0x100)) {
    this[offset + i] = (value / mul) & 0xFF
  }

  return offset + byteLength
}

Buffer.prototype.writeUInt8 = function writeUInt8 (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 1, 0xff, 0)
  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)
  this[offset] = (value & 0xff)
  return offset + 1
}

function objectWriteUInt16 (buf, value, offset, littleEndian) {
  if (value < 0) value = 0xffff + value + 1
  for (var i = 0, j = Math.min(buf.length - offset, 2); i < j; ++i) {
    buf[offset + i] = (value & (0xff << (8 * (littleEndian ? i : 1 - i)))) >>>
      (littleEndian ? i : 1 - i) * 8
  }
}

Buffer.prototype.writeUInt16LE = function writeUInt16LE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value & 0xff)
    this[offset + 1] = (value >>> 8)
  } else {
    objectWriteUInt16(this, value, offset, true)
  }
  return offset + 2
}

Buffer.prototype.writeUInt16BE = function writeUInt16BE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value >>> 8)
    this[offset + 1] = (value & 0xff)
  } else {
    objectWriteUInt16(this, value, offset, false)
  }
  return offset + 2
}

function objectWriteUInt32 (buf, value, offset, littleEndian) {
  if (value < 0) value = 0xffffffff + value + 1
  for (var i = 0, j = Math.min(buf.length - offset, 4); i < j; ++i) {
    buf[offset + i] = (value >>> (littleEndian ? i : 3 - i) * 8) & 0xff
  }
}

Buffer.prototype.writeUInt32LE = function writeUInt32LE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset + 3] = (value >>> 24)
    this[offset + 2] = (value >>> 16)
    this[offset + 1] = (value >>> 8)
    this[offset] = (value & 0xff)
  } else {
    objectWriteUInt32(this, value, offset, true)
  }
  return offset + 4
}

Buffer.prototype.writeUInt32BE = function writeUInt32BE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value >>> 24)
    this[offset + 1] = (value >>> 16)
    this[offset + 2] = (value >>> 8)
    this[offset + 3] = (value & 0xff)
  } else {
    objectWriteUInt32(this, value, offset, false)
  }
  return offset + 4
}

Buffer.prototype.writeIntLE = function writeIntLE (value, offset, byteLength, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) {
    var limit = Math.pow(2, 8 * byteLength - 1)

    checkInt(this, value, offset, byteLength, limit - 1, -limit)
  }

  var i = 0
  var mul = 1
  var sub = 0
  this[offset] = value & 0xFF
  while (++i < byteLength && (mul *= 0x100)) {
    if (value < 0 && sub === 0 && this[offset + i - 1] !== 0) {
      sub = 1
    }
    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF
  }

  return offset + byteLength
}

Buffer.prototype.writeIntBE = function writeIntBE (value, offset, byteLength, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) {
    var limit = Math.pow(2, 8 * byteLength - 1)

    checkInt(this, value, offset, byteLength, limit - 1, -limit)
  }

  var i = byteLength - 1
  var mul = 1
  var sub = 0
  this[offset + i] = value & 0xFF
  while (--i >= 0 && (mul *= 0x100)) {
    if (value < 0 && sub === 0 && this[offset + i + 1] !== 0) {
      sub = 1
    }
    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF
  }

  return offset + byteLength
}

Buffer.prototype.writeInt8 = function writeInt8 (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 1, 0x7f, -0x80)
  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)
  if (value < 0) value = 0xff + value + 1
  this[offset] = (value & 0xff)
  return offset + 1
}

Buffer.prototype.writeInt16LE = function writeInt16LE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value & 0xff)
    this[offset + 1] = (value >>> 8)
  } else {
    objectWriteUInt16(this, value, offset, true)
  }
  return offset + 2
}

Buffer.prototype.writeInt16BE = function writeInt16BE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value >>> 8)
    this[offset + 1] = (value & 0xff)
  } else {
    objectWriteUInt16(this, value, offset, false)
  }
  return offset + 2
}

Buffer.prototype.writeInt32LE = function writeInt32LE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value & 0xff)
    this[offset + 1] = (value >>> 8)
    this[offset + 2] = (value >>> 16)
    this[offset + 3] = (value >>> 24)
  } else {
    objectWriteUInt32(this, value, offset, true)
  }
  return offset + 4
}

Buffer.prototype.writeInt32BE = function writeInt32BE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)
  if (value < 0) value = 0xffffffff + value + 1
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value >>> 24)
    this[offset + 1] = (value >>> 16)
    this[offset + 2] = (value >>> 8)
    this[offset + 3] = (value & 0xff)
  } else {
    objectWriteUInt32(this, value, offset, false)
  }
  return offset + 4
}

function checkIEEE754 (buf, value, offset, ext, max, min) {
  if (offset + ext > buf.length) throw new RangeError('Index out of range')
  if (offset < 0) throw new RangeError('Index out of range')
}

function writeFloat (buf, value, offset, littleEndian, noAssert) {
  if (!noAssert) {
    checkIEEE754(buf, value, offset, 4, 3.4028234663852886e+38, -3.4028234663852886e+38)
  }
  ieee754.write(buf, value, offset, littleEndian, 23, 4)
  return offset + 4
}

Buffer.prototype.writeFloatLE = function writeFloatLE (value, offset, noAssert) {
  return writeFloat(this, value, offset, true, noAssert)
}

Buffer.prototype.writeFloatBE = function writeFloatBE (value, offset, noAssert) {
  return writeFloat(this, value, offset, false, noAssert)
}

function writeDouble (buf, value, offset, littleEndian, noAssert) {
  if (!noAssert) {
    checkIEEE754(buf, value, offset, 8, 1.7976931348623157E+308, -1.7976931348623157E+308)
  }
  ieee754.write(buf, value, offset, littleEndian, 52, 8)
  return offset + 8
}

Buffer.prototype.writeDoubleLE = function writeDoubleLE (value, offset, noAssert) {
  return writeDouble(this, value, offset, true, noAssert)
}

Buffer.prototype.writeDoubleBE = function writeDoubleBE (value, offset, noAssert) {
  return writeDouble(this, value, offset, false, noAssert)
}

// copy(targetBuffer, targetStart=0, sourceStart=0, sourceEnd=buffer.length)
Buffer.prototype.copy = function copy (target, targetStart, start, end) {
  if (!start) start = 0
  if (!end && end !== 0) end = this.length
  if (targetStart >= target.length) targetStart = target.length
  if (!targetStart) targetStart = 0
  if (end > 0 && end < start) end = start

  // Copy 0 bytes; we're done
  if (end === start) return 0
  if (target.length === 0 || this.length === 0) return 0

  // Fatal error conditions
  if (targetStart < 0) {
    throw new RangeError('targetStart out of bounds')
  }
  if (start < 0 || start >= this.length) throw new RangeError('sourceStart out of bounds')
  if (end < 0) throw new RangeError('sourceEnd out of bounds')

  // Are we oob?
  if (end > this.length) end = this.length
  if (target.length - targetStart < end - start) {
    end = target.length - targetStart + start
  }

  var len = end - start
  var i

  if (this === target && start < targetStart && targetStart < end) {
    // descending copy from end
    for (i = len - 1; i >= 0; --i) {
      target[i + targetStart] = this[i + start]
    }
  } else if (len < 1000 || !Buffer.TYPED_ARRAY_SUPPORT) {
    // ascending copy from start
    for (i = 0; i < len; ++i) {
      target[i + targetStart] = this[i + start]
    }
  } else {
    Uint8Array.prototype.set.call(
      target,
      this.subarray(start, start + len),
      targetStart
    )
  }

  return len
}

// Usage:
//    buffer.fill(number[, offset[, end]])
//    buffer.fill(buffer[, offset[, end]])
//    buffer.fill(string[, offset[, end]][, encoding])
Buffer.prototype.fill = function fill (val, start, end, encoding) {
  // Handle string cases:
  if (typeof val === 'string') {
    if (typeof start === 'string') {
      encoding = start
      start = 0
      end = this.length
    } else if (typeof end === 'string') {
      encoding = end
      end = this.length
    }
    if (val.length === 1) {
      var code = val.charCodeAt(0)
      if (code < 256) {
        val = code
      }
    }
    if (encoding !== undefined && typeof encoding !== 'string') {
      throw new TypeError('encoding must be a string')
    }
    if (typeof encoding === 'string' && !Buffer.isEncoding(encoding)) {
      throw new TypeError('Unknown encoding: ' + encoding)
    }
  } else if (typeof val === 'number') {
    val = val & 255
  }

  // Invalid ranges are not set to a default, so can range check early.
  if (start < 0 || this.length < start || this.length < end) {
    throw new RangeError('Out of range index')
  }

  if (end <= start) {
    return this
  }

  start = start >>> 0
  end = end === undefined ? this.length : end >>> 0

  if (!val) val = 0

  var i
  if (typeof val === 'number') {
    for (i = start; i < end; ++i) {
      this[i] = val
    }
  } else {
    var bytes = Buffer.isBuffer(val)
      ? val
      : utf8ToBytes(new Buffer(val, encoding).toString())
    var len = bytes.length
    for (i = 0; i < end - start; ++i) {
      this[i + start] = bytes[i % len]
    }
  }

  return this
}

// HELPER FUNCTIONS
// ================

var INVALID_BASE64_RE = /[^+\/0-9A-Za-z-_]/g

function base64clean (str) {
  // Node strips out invalid characters like \n and \t from the string, base64-js does not
  str = stringtrim(str).replace(INVALID_BASE64_RE, '')
  // Node converts strings with length < 2 to ''
  if (str.length < 2) return ''
  // Node allows for non-padded base64 strings (missing trailing ===), base64-js does not
  while (str.length % 4 !== 0) {
    str = str + '='
  }
  return str
}

function stringtrim (str) {
  if (str.trim) return str.trim()
  return str.replace(/^\s+|\s+$/g, '')
}

function toHex (n) {
  if (n < 16) return '0' + n.toString(16)
  return n.toString(16)
}

function utf8ToBytes (string, units) {
  units = units || Infinity
  var codePoint
  var length = string.length
  var leadSurrogate = null
  var bytes = []

  for (var i = 0; i < length; ++i) {
    codePoint = string.charCodeAt(i)

    // is surrogate component
    if (codePoint > 0xD7FF && codePoint < 0xE000) {
      // last char was a lead
      if (!leadSurrogate) {
        // no lead yet
        if (codePoint > 0xDBFF) {
          // unexpected trail
          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)
          continue
        } else if (i + 1 === length) {
          // unpaired lead
          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)
          continue
        }

        // valid lead
        leadSurrogate = codePoint

        continue
      }

      // 2 leads in a row
      if (codePoint < 0xDC00) {
        if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)
        leadSurrogate = codePoint
        continue
      }

      // valid surrogate pair
      codePoint = (leadSurrogate - 0xD800 << 10 | codePoint - 0xDC00) + 0x10000
    } else if (leadSurrogate) {
      // valid bmp char, but last char was a lead
      if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)
    }

    leadSurrogate = null

    // encode utf8
    if (codePoint < 0x80) {
      if ((units -= 1) < 0) break
      bytes.push(codePoint)
    } else if (codePoint < 0x800) {
      if ((units -= 2) < 0) break
      bytes.push(
        codePoint >> 0x6 | 0xC0,
        codePoint & 0x3F | 0x80
      )
    } else if (codePoint < 0x10000) {
      if ((units -= 3) < 0) break
      bytes.push(
        codePoint >> 0xC | 0xE0,
        codePoint >> 0x6 & 0x3F | 0x80,
        codePoint & 0x3F | 0x80
      )
    } else if (codePoint < 0x110000) {
      if ((units -= 4) < 0) break
      bytes.push(
        codePoint >> 0x12 | 0xF0,
        codePoint >> 0xC & 0x3F | 0x80,
        codePoint >> 0x6 & 0x3F | 0x80,
        codePoint & 0x3F | 0x80
      )
    } else {
      throw new Error('Invalid code point')
    }
  }

  return bytes
}

function asciiToBytes (str) {
  var byteArray = []
  for (var i = 0; i < str.length; ++i) {
    // Node's code seems to be doing this and not & 0x7F..
    byteArray.push(str.charCodeAt(i) & 0xFF)
  }
  return byteArray
}

function utf16leToBytes (str, units) {
  var c, hi, lo
  var byteArray = []
  for (var i = 0; i < str.length; ++i) {
    if ((units -= 2) < 0) break

    c = str.charCodeAt(i)
    hi = c >> 8
    lo = c % 256
    byteArray.push(lo)
    byteArray.push(hi)
  }

  return byteArray
}

function base64ToBytes (str) {
  return base64.toByteArray(base64clean(str))
}

function blitBuffer (src, dst, offset, length) {
  for (var i = 0; i < length; ++i) {
    if ((i + offset >= dst.length) || (i >= src.length)) break
    dst[i + offset] = src[i]
  }
  return i
}

function isnan (val) {
  return val !== val // eslint-disable-line no-self-compare
}

/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("c8ba")))

/***/ }),

/***/ "b64b":
/***/ (function(module, exports, __webpack_require__) {

var $ = __webpack_require__("23e7");
var toObject = __webpack_require__("7b0b");
var nativeKeys = __webpack_require__("df75");
var fails = __webpack_require__("d039");

var FAILS_ON_PRIMITIVES = fails(function () { nativeKeys(1); });

// `Object.keys` method
// https://tc39.es/ecma262/#sec-object.keys
$({ target: 'Object', stat: true, forced: FAILS_ON_PRIMITIVES }, {
  keys: function keys(it) {
    return nativeKeys(toObject(it));
  }
});


/***/ }),

/***/ "b680":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var $ = __webpack_require__("23e7");
var global = __webpack_require__("da84");
var uncurryThis = __webpack_require__("e330");
var toIntegerOrInfinity = __webpack_require__("5926");
var thisNumberValue = __webpack_require__("408a");
var $repeat = __webpack_require__("1148");
var fails = __webpack_require__("d039");

var RangeError = global.RangeError;
var String = global.String;
var floor = Math.floor;
var repeat = uncurryThis($repeat);
var stringSlice = uncurryThis(''.slice);
var un$ToFixed = uncurryThis(1.0.toFixed);

var pow = function (x, n, acc) {
  return n === 0 ? acc : n % 2 === 1 ? pow(x, n - 1, acc * x) : pow(x * x, n / 2, acc);
};

var log = function (x) {
  var n = 0;
  var x2 = x;
  while (x2 >= 4096) {
    n += 12;
    x2 /= 4096;
  }
  while (x2 >= 2) {
    n += 1;
    x2 /= 2;
  } return n;
};

var multiply = function (data, n, c) {
  var index = -1;
  var c2 = c;
  while (++index < 6) {
    c2 += n * data[index];
    data[index] = c2 % 1e7;
    c2 = floor(c2 / 1e7);
  }
};

var divide = function (data, n) {
  var index = 6;
  var c = 0;
  while (--index >= 0) {
    c += data[index];
    data[index] = floor(c / n);
    c = (c % n) * 1e7;
  }
};

var dataToString = function (data) {
  var index = 6;
  var s = '';
  while (--index >= 0) {
    if (s !== '' || index === 0 || data[index] !== 0) {
      var t = String(data[index]);
      s = s === '' ? t : s + repeat('0', 7 - t.length) + t;
    }
  } return s;
};

var FORCED = fails(function () {
  return un$ToFixed(0.00008, 3) !== '0.000' ||
    un$ToFixed(0.9, 0) !== '1' ||
    un$ToFixed(1.255, 2) !== '1.25' ||
    un$ToFixed(1000000000000000128.0, 0) !== '1000000000000000128';
}) || !fails(function () {
  // V8 ~ Android 4.3-
  un$ToFixed({});
});

// `Number.prototype.toFixed` method
// https://tc39.es/ecma262/#sec-number.prototype.tofixed
$({ target: 'Number', proto: true, forced: FORCED }, {
  toFixed: function toFixed(fractionDigits) {
    var number = thisNumberValue(this);
    var fractDigits = toIntegerOrInfinity(fractionDigits);
    var data = [0, 0, 0, 0, 0, 0];
    var sign = '';
    var result = '0';
    var e, z, j, k;

    if (fractDigits < 0 || fractDigits > 20) throw RangeError('Incorrect fraction digits');
    // eslint-disable-next-line no-self-compare -- NaN check
    if (number != number) return 'NaN';
    if (number <= -1e21 || number >= 1e21) return String(number);
    if (number < 0) {
      sign = '-';
      number = -number;
    }
    if (number > 1e-21) {
      e = log(number * pow(2, 69, 1)) - 69;
      z = e < 0 ? number * pow(2, -e, 1) : number / pow(2, e, 1);
      z *= 0x10000000000000;
      e = 52 - e;
      if (e > 0) {
        multiply(data, 0, z);
        j = fractDigits;
        while (j >= 7) {
          multiply(data, 1e7, 0);
          j -= 7;
        }
        multiply(data, pow(10, j, 1), 0);
        j = e - 1;
        while (j >= 23) {
          divide(data, 1 << 23);
          j -= 23;
        }
        divide(data, 1 << j);
        multiply(data, 1, 1);
        divide(data, 2);
        result = dataToString(data);
      } else {
        multiply(data, 0, z);
        multiply(data, 1 << -e, 0);
        result = dataToString(data) + repeat('0', fractDigits);
      }
    }
    if (fractDigits > 0) {
      k = result.length;
      result = sign + (k <= fractDigits
        ? '0.' + repeat('0', fractDigits - k) + result
        : stringSlice(result, 0, k - fractDigits) + '.' + stringSlice(result, k - fractDigits));
    } else {
      result = sign + result;
    } return result;
  }
});


/***/ }),

/***/ "b6b7":
/***/ (function(module, exports, __webpack_require__) {

var ArrayBufferViewCore = __webpack_require__("ebb5");
var speciesConstructor = __webpack_require__("4840");

var TYPED_ARRAY_CONSTRUCTOR = ArrayBufferViewCore.TYPED_ARRAY_CONSTRUCTOR;
var aTypedArrayConstructor = ArrayBufferViewCore.aTypedArrayConstructor;

// a part of `TypedArraySpeciesCreate` abstract operation
// https://tc39.es/ecma262/#typedarray-species-create
module.exports = function (originalArray) {
  return aTypedArrayConstructor(speciesConstructor(originalArray, originalArray[TYPED_ARRAY_CONSTRUCTOR]));
};


/***/ }),

/***/ "b727":
/***/ (function(module, exports, __webpack_require__) {

var bind = __webpack_require__("0366");
var uncurryThis = __webpack_require__("e330");
var IndexedObject = __webpack_require__("44ad");
var toObject = __webpack_require__("7b0b");
var lengthOfArrayLike = __webpack_require__("07fa");
var arraySpeciesCreate = __webpack_require__("65f0");

var push = uncurryThis([].push);

// `Array.prototype.{ forEach, map, filter, some, every, find, findIndex, filterReject }` methods implementation
var createMethod = function (TYPE) {
  var IS_MAP = TYPE == 1;
  var IS_FILTER = TYPE == 2;
  var IS_SOME = TYPE == 3;
  var IS_EVERY = TYPE == 4;
  var IS_FIND_INDEX = TYPE == 6;
  var IS_FILTER_REJECT = TYPE == 7;
  var NO_HOLES = TYPE == 5 || IS_FIND_INDEX;
  return function ($this, callbackfn, that, specificCreate) {
    var O = toObject($this);
    var self = IndexedObject(O);
    var boundFunction = bind(callbackfn, that);
    var length = lengthOfArrayLike(self);
    var index = 0;
    var create = specificCreate || arraySpeciesCreate;
    var target = IS_MAP ? create($this, length) : IS_FILTER || IS_FILTER_REJECT ? create($this, 0) : undefined;
    var value, result;
    for (;length > index; index++) if (NO_HOLES || index in self) {
      value = self[index];
      result = boundFunction(value, index, O);
      if (TYPE) {
        if (IS_MAP) target[index] = result; // map
        else if (result) switch (TYPE) {
          case 3: return true;              // some
          case 5: return value;             // find
          case 6: return index;             // findIndex
          case 2: push(target, value);      // filter
        } else switch (TYPE) {
          case 4: return false;             // every
          case 7: push(target, value);      // filterReject
        }
      }
    }
    return IS_FIND_INDEX ? -1 : IS_SOME || IS_EVERY ? IS_EVERY : target;
  };
};

module.exports = {
  // `Array.prototype.forEach` method
  // https://tc39.es/ecma262/#sec-array.prototype.foreach
  forEach: createMethod(0),
  // `Array.prototype.map` method
  // https://tc39.es/ecma262/#sec-array.prototype.map
  map: createMethod(1),
  // `Array.prototype.filter` method
  // https://tc39.es/ecma262/#sec-array.prototype.filter
  filter: createMethod(2),
  // `Array.prototype.some` method
  // https://tc39.es/ecma262/#sec-array.prototype.some
  some: createMethod(3),
  // `Array.prototype.every` method
  // https://tc39.es/ecma262/#sec-array.prototype.every
  every: createMethod(4),
  // `Array.prototype.find` method
  // https://tc39.es/ecma262/#sec-array.prototype.find
  find: createMethod(5),
  // `Array.prototype.findIndex` method
  // https://tc39.es/ecma262/#sec-array.prototype.findIndex
  findIndex: createMethod(6),
  // `Array.prototype.filterReject` method
  // https://github.com/tc39/proposal-array-filtering
  filterReject: createMethod(7)
};


/***/ }),

/***/ "ba8b":
/***/ (function(module, exports, __webpack_require__) {

// style-loader: Adds some css to the DOM by adding a <style> tag

// load the styles
var content = __webpack_require__("5960");
if(content.__esModule) content = content.default;
if(typeof content === 'string') content = [[module.i, content, '']];
if(content.locals) module.exports = content.locals;
// add the styles to the DOM
var add = __webpack_require__("499e").default
var update = add("8b7e338e", content, true, {"sourceMap":false,"shadowMode":false});

/***/ }),

/***/ "bb2f":
/***/ (function(module, exports, __webpack_require__) {

var fails = __webpack_require__("d039");

module.exports = !fails(function () {
  // eslint-disable-next-line es/no-object-isextensible, es/no-object-preventextensions -- required for testing
  return Object.isExtensible(Object.preventExtensions({}));
});


/***/ }),

/***/ "bd00":
/***/ (function(module, exports, __webpack_require__) {

// Imports
var ___CSS_LOADER_API_IMPORT___ = __webpack_require__("24fb");
exports = ___CSS_LOADER_API_IMPORT___(false);
// Module
exports.push([module.i, ".spread-sheet[data-v-018ee75b]{height:100%;width:100%}", ""]);
// Exports
module.exports = exports;


/***/ }),

/***/ "c04e":
/***/ (function(module, exports, __webpack_require__) {

var global = __webpack_require__("da84");
var call = __webpack_require__("c65b");
var isObject = __webpack_require__("861d");
var isSymbol = __webpack_require__("d9b5");
var getMethod = __webpack_require__("dc4a");
var ordinaryToPrimitive = __webpack_require__("485a");
var wellKnownSymbol = __webpack_require__("b622");

var TypeError = global.TypeError;
var TO_PRIMITIVE = wellKnownSymbol('toPrimitive');

// `ToPrimitive` abstract operation
// https://tc39.es/ecma262/#sec-toprimitive
module.exports = function (input, pref) {
  if (!isObject(input) || isSymbol(input)) return input;
  var exoticToPrim = getMethod(input, TO_PRIMITIVE);
  var result;
  if (exoticToPrim) {
    if (pref === undefined) pref = 'default';
    result = call(exoticToPrim, input, pref);
    if (!isObject(result) || isSymbol(result)) return result;
    throw TypeError("Can't convert object to primitive value");
  }
  if (pref === undefined) pref = 'number';
  return ordinaryToPrimitive(input, pref);
};


/***/ }),

/***/ "c0e9":
/***/ (function(module, exports, __webpack_require__) {

/*!
 * html2canvas 1.3.2 <https://html2canvas.hertzen.com>
 * Copyright (c) 2021 Niklas von Hertzen <https://hertzen.com>
 * Released under MIT License
 */
(function (global, factory) {
     true ? module.exports = factory() :
    undefined;
}(this, (function () { 'use strict';

    /*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */
    /* global Reflect, Promise */

    var extendStatics = function(d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };
        return extendStatics(d, b);
    };

    function __extends(d, b) {
        if (typeof b !== "function" && b !== null)
            throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    }

    var __assign = function() {
        __assign = Object.assign || function __assign(t) {
            for (var s, i = 1, n = arguments.length; i < n; i++) {
                s = arguments[i];
                for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];
            }
            return t;
        };
        return __assign.apply(this, arguments);
    };

    function __awaiter(thisArg, _arguments, P, generator) {
        function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
        return new (P || (P = Promise))(function (resolve, reject) {
            function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
            function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
            function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
            step((generator = generator.apply(thisArg, _arguments || [])).next());
        });
    }

    function __generator(thisArg, body) {
        var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;
        return g = { next: verb(0), "throw": verb(1), "return": verb(2) }, typeof Symbol === "function" && (g[Symbol.iterator] = function() { return this; }), g;
        function verb(n) { return function (v) { return step([n, v]); }; }
        function step(op) {
            if (f) throw new TypeError("Generator is already executing.");
            while (_) try {
                if (f = 1, y && (t = op[0] & 2 ? y["return"] : op[0] ? y["throw"] || ((t = y["return"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;
                if (y = 0, t) op = [op[0] & 2, t.value];
                switch (op[0]) {
                    case 0: case 1: t = op; break;
                    case 4: _.label++; return { value: op[1], done: false };
                    case 5: _.label++; y = op[1]; op = [0]; continue;
                    case 7: op = _.ops.pop(); _.trys.pop(); continue;
                    default:
                        if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }
                        if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }
                        if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }
                        if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }
                        if (t[2]) _.ops.pop();
                        _.trys.pop(); continue;
                }
                op = body.call(thisArg, _);
            } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }
            if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };
        }
    }

    function __spreadArray(to, from, pack) {
        if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {
            if (ar || !(i in from)) {
                if (!ar) ar = Array.prototype.slice.call(from, 0, i);
                ar[i] = from[i];
            }
        }
        return to.concat(ar || from);
    }

    var Bounds = /** @class */ (function () {
        function Bounds(left, top, width, height) {
            this.left = left;
            this.top = top;
            this.width = width;
            this.height = height;
        }
        Bounds.prototype.add = function (x, y, w, h) {
            return new Bounds(this.left + x, this.top + y, this.width + w, this.height + h);
        };
        Bounds.fromClientRect = function (context, clientRect) {
            return new Bounds(clientRect.left + context.windowBounds.left, clientRect.top + context.windowBounds.top, clientRect.width, clientRect.height);
        };
        Bounds.fromDOMRectList = function (context, domRectList) {
            var domRect = domRectList[0];
            return domRect
                ? new Bounds(domRect.x + context.windowBounds.left, domRect.y + context.windowBounds.top, domRect.width, domRect.height)
                : Bounds.EMPTY;
        };
        Bounds.EMPTY = new Bounds(0, 0, 0, 0);
        return Bounds;
    }());
    var parseBounds = function (context, node) {
        return Bounds.fromClientRect(context, node.getBoundingClientRect());
    };
    var parseDocumentSize = function (document) {
        var body = document.body;
        var documentElement = document.documentElement;
        if (!body || !documentElement) {
            throw new Error("Unable to get document size");
        }
        var width = Math.max(Math.max(body.scrollWidth, documentElement.scrollWidth), Math.max(body.offsetWidth, documentElement.offsetWidth), Math.max(body.clientWidth, documentElement.clientWidth));
        var height = Math.max(Math.max(body.scrollHeight, documentElement.scrollHeight), Math.max(body.offsetHeight, documentElement.offsetHeight), Math.max(body.clientHeight, documentElement.clientHeight));
        return new Bounds(0, 0, width, height);
    };

    /*
     * css-line-break 2.0.1 <https://github.com/niklasvh/css-line-break#readme>
     * Copyright (c) 2021 Niklas von Hertzen <https://hertzen.com>
     * Released under MIT License
     */
    var toCodePoints$1 = function (str) {
        var codePoints = [];
        var i = 0;
        var length = str.length;
        while (i < length) {
            var value = str.charCodeAt(i++);
            if (value >= 0xd800 && value <= 0xdbff && i < length) {
                var extra = str.charCodeAt(i++);
                if ((extra & 0xfc00) === 0xdc00) {
                    codePoints.push(((value & 0x3ff) << 10) + (extra & 0x3ff) + 0x10000);
                }
                else {
                    codePoints.push(value);
                    i--;
                }
            }
            else {
                codePoints.push(value);
            }
        }
        return codePoints;
    };
    var fromCodePoint$1 = function () {
        var codePoints = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            codePoints[_i] = arguments[_i];
        }
        if (String.fromCodePoint) {
            return String.fromCodePoint.apply(String, codePoints);
        }
        var length = codePoints.length;
        if (!length) {
            return '';
        }
        var codeUnits = [];
        var index = -1;
        var result = '';
        while (++index < length) {
            var codePoint = codePoints[index];
            if (codePoint <= 0xffff) {
                codeUnits.push(codePoint);
            }
            else {
                codePoint -= 0x10000;
                codeUnits.push((codePoint >> 10) + 0xd800, (codePoint % 0x400) + 0xdc00);
            }
            if (index + 1 === length || codeUnits.length > 0x4000) {
                result += String.fromCharCode.apply(String, codeUnits);
                codeUnits.length = 0;
            }
        }
        return result;
    };
    var chars$2 = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';
    // Use a lookup table to find the index.
    var lookup$2 = typeof Uint8Array === 'undefined' ? [] : new Uint8Array(256);
    for (var i$2 = 0; i$2 < chars$2.length; i$2++) {
        lookup$2[chars$2.charCodeAt(i$2)] = i$2;
    }
    var decode$1 = function (base64) {
        var bufferLength = base64.length * 0.75, len = base64.length, i, p = 0, encoded1, encoded2, encoded3, encoded4;
        if (base64[base64.length - 1] === '=') {
            bufferLength--;
            if (base64[base64.length - 2] === '=') {
                bufferLength--;
            }
        }
        var buffer = typeof ArrayBuffer !== 'undefined' &&
            typeof Uint8Array !== 'undefined' &&
            typeof Uint8Array.prototype.slice !== 'undefined'
            ? new ArrayBuffer(bufferLength)
            : new Array(bufferLength);
        var bytes = Array.isArray(buffer) ? buffer : new Uint8Array(buffer);
        for (i = 0; i < len; i += 4) {
            encoded1 = lookup$2[base64.charCodeAt(i)];
            encoded2 = lookup$2[base64.charCodeAt(i + 1)];
            encoded3 = lookup$2[base64.charCodeAt(i + 2)];
            encoded4 = lookup$2[base64.charCodeAt(i + 3)];
            bytes[p++] = (encoded1 << 2) | (encoded2 >> 4);
            bytes[p++] = ((encoded2 & 15) << 4) | (encoded3 >> 2);
            bytes[p++] = ((encoded3 & 3) << 6) | (encoded4 & 63);
        }
        return buffer;
    };
    var polyUint16Array$1 = function (buffer) {
        var length = buffer.length;
        var bytes = [];
        for (var i = 0; i < length; i += 2) {
            bytes.push((buffer[i + 1] << 8) | buffer[i]);
        }
        return bytes;
    };
    var polyUint32Array$1 = function (buffer) {
        var length = buffer.length;
        var bytes = [];
        for (var i = 0; i < length; i += 4) {
            bytes.push((buffer[i + 3] << 24) | (buffer[i + 2] << 16) | (buffer[i + 1] << 8) | buffer[i]);
        }
        return bytes;
    };

    /** Shift size for getting the index-2 table offset. */
    var UTRIE2_SHIFT_2$1 = 5;
    /** Shift size for getting the index-1 table offset. */
    var UTRIE2_SHIFT_1$1 = 6 + 5;
    /**
     * Shift size for shifting left the index array values.
     * Increases possible data size with 16-bit index values at the cost
     * of compactability.
     * This requires data blocks to be aligned by UTRIE2_DATA_GRANULARITY.
     */
    var UTRIE2_INDEX_SHIFT$1 = 2;
    /**
     * Difference between the two shift sizes,
     * for getting an index-1 offset from an index-2 offset. 6=11-5
     */
    var UTRIE2_SHIFT_1_2$1 = UTRIE2_SHIFT_1$1 - UTRIE2_SHIFT_2$1;
    /**
     * The part of the index-2 table for U+D800..U+DBFF stores values for
     * lead surrogate code _units_ not code _points_.
     * Values for lead surrogate code _points_ are indexed with this portion of the table.
     * Length=32=0x20=0x400>>UTRIE2_SHIFT_2. (There are 1024=0x400 lead surrogates.)
     */
    var UTRIE2_LSCP_INDEX_2_OFFSET$1 = 0x10000 >> UTRIE2_SHIFT_2$1;
    /** Number of entries in a data block. 32=0x20 */
    var UTRIE2_DATA_BLOCK_LENGTH$1 = 1 << UTRIE2_SHIFT_2$1;
    /** Mask for getting the lower bits for the in-data-block offset. */
    var UTRIE2_DATA_MASK$1 = UTRIE2_DATA_BLOCK_LENGTH$1 - 1;
    var UTRIE2_LSCP_INDEX_2_LENGTH$1 = 0x400 >> UTRIE2_SHIFT_2$1;
    /** Count the lengths of both BMP pieces. 2080=0x820 */
    var UTRIE2_INDEX_2_BMP_LENGTH$1 = UTRIE2_LSCP_INDEX_2_OFFSET$1 + UTRIE2_LSCP_INDEX_2_LENGTH$1;
    /**
     * The 2-byte UTF-8 version of the index-2 table follows at offset 2080=0x820.
     * Length 32=0x20 for lead bytes C0..DF, regardless of UTRIE2_SHIFT_2.
     */
    var UTRIE2_UTF8_2B_INDEX_2_OFFSET$1 = UTRIE2_INDEX_2_BMP_LENGTH$1;
    var UTRIE2_UTF8_2B_INDEX_2_LENGTH$1 = 0x800 >> 6; /* U+0800 is the first code point after 2-byte UTF-8 */
    /**
     * The index-1 table, only used for supplementary code points, at offset 2112=0x840.
     * Variable length, for code points up to highStart, where the last single-value range starts.
     * Maximum length 512=0x200=0x100000>>UTRIE2_SHIFT_1.
     * (For 0x100000 supplementary code points U+10000..U+10ffff.)
     *
     * The part of the index-2 table for supplementary code points starts
     * after this index-1 table.
     *
     * Both the index-1 table and the following part of the index-2 table
     * are omitted completely if there is only BMP data.
     */
    var UTRIE2_INDEX_1_OFFSET$1 = UTRIE2_UTF8_2B_INDEX_2_OFFSET$1 + UTRIE2_UTF8_2B_INDEX_2_LENGTH$1;
    /**
     * Number of index-1 entries for the BMP. 32=0x20
     * This part of the index-1 table is omitted from the serialized form.
     */
    var UTRIE2_OMITTED_BMP_INDEX_1_LENGTH$1 = 0x10000 >> UTRIE2_SHIFT_1$1;
    /** Number of entries in an index-2 block. 64=0x40 */
    var UTRIE2_INDEX_2_BLOCK_LENGTH$1 = 1 << UTRIE2_SHIFT_1_2$1;
    /** Mask for getting the lower bits for the in-index-2-block offset. */
    var UTRIE2_INDEX_2_MASK$1 = UTRIE2_INDEX_2_BLOCK_LENGTH$1 - 1;
    var slice16$1 = function (view, start, end) {
        if (view.slice) {
            return view.slice(start, end);
        }
        return new Uint16Array(Array.prototype.slice.call(view, start, end));
    };
    var slice32$1 = function (view, start, end) {
        if (view.slice) {
            return view.slice(start, end);
        }
        return new Uint32Array(Array.prototype.slice.call(view, start, end));
    };
    var createTrieFromBase64$1 = function (base64) {
        var buffer = decode$1(base64);
        var view32 = Array.isArray(buffer) ? polyUint32Array$1(buffer) : new Uint32Array(buffer);
        var view16 = Array.isArray(buffer) ? polyUint16Array$1(buffer) : new Uint16Array(buffer);
        var headerLength = 24;
        var index = slice16$1(view16, headerLength / 2, view32[4] / 2);
        var data = view32[5] === 2
            ? slice16$1(view16, (headerLength + view32[4]) / 2)
            : slice32$1(view32, Math.ceil((headerLength + view32[4]) / 4));
        return new Trie$1(view32[0], view32[1], view32[2], view32[3], index, data);
    };
    var Trie$1 = /** @class */ (function () {
        function Trie(initialValue, errorValue, highStart, highValueIndex, index, data) {
            this.initialValue = initialValue;
            this.errorValue = errorValue;
            this.highStart = highStart;
            this.highValueIndex = highValueIndex;
            this.index = index;
            this.data = data;
        }
        /**
         * Get the value for a code point as stored in the Trie.
         *
         * @param codePoint the code point
         * @return the value
         */
        Trie.prototype.get = function (codePoint) {
            var ix;
            if (codePoint >= 0) {
                if (codePoint < 0x0d800 || (codePoint > 0x0dbff && codePoint <= 0x0ffff)) {
                    // Ordinary BMP code point, excluding leading surrogates.
                    // BMP uses a single level lookup.  BMP index starts at offset 0 in the Trie2 index.
                    // 16 bit data is stored in the index array itself.
                    ix = this.index[codePoint >> UTRIE2_SHIFT_2$1];
                    ix = (ix << UTRIE2_INDEX_SHIFT$1) + (codePoint & UTRIE2_DATA_MASK$1);
                    return this.data[ix];
                }
                if (codePoint <= 0xffff) {
                    // Lead Surrogate Code Point.  A Separate index section is stored for
                    // lead surrogate code units and code points.
                    //   The main index has the code unit data.
                    //   For this function, we need the code point data.
                    // Note: this expression could be refactored for slightly improved efficiency, but
                    //       surrogate code points will be so rare in practice that it's not worth it.
                    ix = this.index[UTRIE2_LSCP_INDEX_2_OFFSET$1 + ((codePoint - 0xd800) >> UTRIE2_SHIFT_2$1)];
                    ix = (ix << UTRIE2_INDEX_SHIFT$1) + (codePoint & UTRIE2_DATA_MASK$1);
                    return this.data[ix];
                }
                if (codePoint < this.highStart) {
                    // Supplemental code point, use two-level lookup.
                    ix = UTRIE2_INDEX_1_OFFSET$1 - UTRIE2_OMITTED_BMP_INDEX_1_LENGTH$1 + (codePoint >> UTRIE2_SHIFT_1$1);
                    ix = this.index[ix];
                    ix += (codePoint >> UTRIE2_SHIFT_2$1) & UTRIE2_INDEX_2_MASK$1;
                    ix = this.index[ix];
                    ix = (ix << UTRIE2_INDEX_SHIFT$1) + (codePoint & UTRIE2_DATA_MASK$1);
                    return this.data[ix];
                }
                if (codePoint <= 0x10ffff) {
                    return this.data[this.highValueIndex];
                }
            }
            // Fall through.  The code point is outside of the legal range of 0..0x10ffff.
            return this.errorValue;
        };
        return Trie;
    }());

    var base64$1 = 'KwAAAAAAAAAACA4AUD0AADAgAAACAAAAAAAIABAAGABAAEgAUABYAGAAaABgAGgAYgBqAF8AZwBgAGgAcQB5AHUAfQCFAI0AlQCdAKIAqgCyALoAYABoAGAAaABgAGgAwgDKAGAAaADGAM4A0wDbAOEA6QDxAPkAAQEJAQ8BFwF1AH0AHAEkASwBNAE6AUIBQQFJAVEBWQFhAWgBcAF4ATAAgAGGAY4BlQGXAZ8BpwGvAbUBvQHFAc0B0wHbAeMB6wHxAfkBAQIJAvEBEQIZAiECKQIxAjgCQAJGAk4CVgJeAmQCbAJ0AnwCgQKJApECmQKgAqgCsAK4ArwCxAIwAMwC0wLbAjAA4wLrAvMC+AIAAwcDDwMwABcDHQMlAy0DNQN1AD0DQQNJA0kDSQNRA1EDVwNZA1kDdQB1AGEDdQBpA20DdQN1AHsDdQCBA4kDkQN1AHUAmQOhA3UAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AKYDrgN1AHUAtgO+A8YDzgPWAxcD3gPjA+sD8wN1AHUA+wMDBAkEdQANBBUEHQQlBCoEFwMyBDgEYABABBcDSARQBFgEYARoBDAAcAQzAXgEgASIBJAEdQCXBHUAnwSnBK4EtgS6BMIEyAR1AHUAdQB1AHUAdQCVANAEYABgAGAAYABgAGAAYABgANgEYADcBOQEYADsBPQE/AQEBQwFFAUcBSQFLAU0BWQEPAVEBUsFUwVbBWAAYgVgAGoFcgV6BYIFigWRBWAAmQWfBaYFYABgAGAAYABgAKoFYACxBbAFuQW6BcEFwQXHBcEFwQXPBdMF2wXjBeoF8gX6BQIGCgYSBhoGIgYqBjIGOgZgAD4GRgZMBmAAUwZaBmAAYABgAGAAYABgAGAAYABgAGAAYABgAGIGYABpBnAGYABgAGAAYABgAGAAYABgAGAAYAB4Bn8GhQZgAGAAYAB1AHcDFQSLBmAAYABgAJMGdQA9A3UAmwajBqsGqwaVALMGuwbDBjAAywbSBtIG1QbSBtIG0gbSBtIG0gbdBuMG6wbzBvsGAwcLBxMHAwcbByMHJwcsBywHMQcsB9IGOAdAB0gHTgfSBkgHVgfSBtIG0gbSBtIG0gbSBtIG0gbSBiwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdgAGAALAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdbB2MHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB2kH0gZwB64EdQB1AHUAdQB1AHUAdQB1AHUHfQdgAIUHjQd1AHUAlQedB2AAYAClB6sHYACzB7YHvgfGB3UAzgfWBzMB3gfmB1EB7gf1B/0HlQENAQUIDQh1ABUIHQglCBcDLQg1CD0IRQhNCEEDUwh1AHUAdQBbCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIcAh3CHoIMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIgggwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAALAcsBywHLAcsBywHLAcsBywHLAcsB4oILAcsB44I0gaWCJ4Ipgh1AHUAqgiyCHUAdQB1AHUAdQB1AHUAdQB1AHUAtwh8AXUAvwh1AMUIyQjRCNkI4AjoCHUAdQB1AO4I9gj+CAYJDgkTCS0HGwkjCYIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiAAIAAAAFAAYABgAGIAXwBgAHEAdQBFAJUAogCyAKAAYABgAEIA4ABGANMA4QDxAMEBDwE1AFwBLAE6AQEBUQF4QkhCmEKoQrhCgAHIQsAB0MLAAcABwAHAAeDC6ABoAHDCwMMAAcABwAHAAdDDGMMAAcAB6MM4wwjDWMNow3jDaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAEjDqABWw6bDqABpg6gAaABoAHcDvwOPA+gAaABfA/8DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DpcPAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcAB9cPKwkyCToJMAB1AHUAdQBCCUoJTQl1AFUJXAljCWcJawkwADAAMAAwAHMJdQB2CX4JdQCECYoJjgmWCXUAngkwAGAAYABxAHUApgn3A64JtAl1ALkJdQDACTAAMAAwADAAdQB1AHUAdQB1AHUAdQB1AHUAowYNBMUIMAAwADAAMADICcsJ0wnZCRUE4QkwAOkJ8An4CTAAMAB1AAAKvwh1AAgKDwoXCh8KdQAwACcKLgp1ADYKqAmICT4KRgowADAAdQB1AE4KMAB1AFYKdQBeCnUAZQowADAAMAAwADAAMAAwADAAMAAVBHUAbQowADAAdQC5CXUKMAAwAHwBxAijBogEMgF9CoQKiASMCpQKmgqIBKIKqgquCogEDQG2Cr4KxgrLCjAAMADTCtsKCgHjCusK8Qr5CgELMAAwADAAMAB1AIsECQsRC3UANAEZCzAAMAAwADAAMAB1ACELKQswAHUANAExCzkLdQBBC0kLMABRC1kLMAAwADAAMAAwADAAdQBhCzAAMAAwAGAAYABpC3ELdwt/CzAAMACHC4sLkwubC58Lpwt1AK4Ltgt1APsDMAAwADAAMAAwADAAMAAwAL4LwwvLC9IL1wvdCzAAMADlC+kL8Qv5C/8LSQswADAAMAAwADAAMAAwADAAMAAHDDAAMAAwADAAMAAODBYMHgx1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1ACYMMAAwADAAdQB1AHUALgx1AHUAdQB1AHUAdQA2DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AD4MdQBGDHUAdQB1AHUAdQB1AEkMdQB1AHUAdQB1AFAMMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQBYDHUAdQB1AF8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUA+wMVBGcMMAAwAHwBbwx1AHcMfwyHDI8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAYABgAJcMMAAwADAAdQB1AJ8MlQClDDAAMACtDCwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB7UMLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AA0EMAC9DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAsBywHLAcsBywHLAcsBywHLQcwAMEMyAwsBywHLAcsBywHLAcsBywHLAcsBywHzAwwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1ANQM2QzhDDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMABgAGAAYABgAGAAYABgAOkMYADxDGAA+AwADQYNYABhCWAAYAAODTAAMAAwADAAFg1gAGAAHg37AzAAMAAwADAAYABgACYNYAAsDTQNPA1gAEMNPg1LDWAAYABgAGAAYABgAGAAYABgAGAAUg1aDYsGVglhDV0NcQBnDW0NdQ15DWAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAlQCBDZUAiA2PDZcNMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAnw2nDTAAMAAwADAAMAAwAHUArw23DTAAMAAwADAAMAAwADAAMAAwADAAMAB1AL8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQDHDTAAYABgAM8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA1w11ANwNMAAwAD0B5A0wADAAMAAwADAAMADsDfQN/A0EDgwOFA4wABsOMAAwADAAMAAwADAAMAAwANIG0gbSBtIG0gbSBtIG0gYjDigOwQUuDsEFMw7SBjoO0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGQg5KDlIOVg7SBtIGXg5lDm0OdQ7SBtIGfQ6EDooOjQ6UDtIGmg6hDtIG0gaoDqwO0ga0DrwO0gZgAGAAYADEDmAAYAAkBtIGzA5gANIOYADaDokO0gbSBt8O5w7SBu8O0gb1DvwO0gZgAGAAxA7SBtIG0gbSBtIGYABgAGAAYAAED2AAsAUMD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHJA8sBywHLAcsBywHLAccDywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywPLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAc0D9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHPA/SBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gYUD0QPlQCVAJUAMAAwADAAMACVAJUAlQCVAJUAlQCVAEwPMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA//8EAAQABAAEAAQABAAEAAQABAANAAMAAQABAAIABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQACgATABcAHgAbABoAHgAXABYAEgAeABsAGAAPABgAHABLAEsASwBLAEsASwBLAEsASwBLABgAGAAeAB4AHgATAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABYAGwASAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWAA0AEQAeAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAFAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJABYAGgAbABsAGwAeAB0AHQAeAE8AFwAeAA0AHgAeABoAGwBPAE8ADgBQAB0AHQAdAE8ATwAXAE8ATwBPABYAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAFAATwBAAE8ATwBPAEAATwBQAFAATwBQAB4AHgAeAB4AHgAeAB0AHQAdAB0AHgAdAB4ADgBQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgBQAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAkACQAJAAkACQAJAAkABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAFAAHgAeAB4AKwArAFAAUABQAFAAGABQACsAKwArACsAHgAeAFAAHgBQAFAAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUAAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAYAA0AKwArAB4AHgAbACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAB4ABAAEAB4ABAAEABMABAArACsAKwArACsAKwArACsAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAKwArACsAKwBWAFYAVgBWAB4AHgArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AGgAaABoAGAAYAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQAEwAEACsAEwATAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABLAEsASwBLAEsASwBLAEsASwBLABoAGQAZAB4AUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABMAUAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABABQAFAABAAEAB4ABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUAAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAFAABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQAUABQAB4AHgAYABMAUAArACsABAAbABsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAFAABAAEAAQABAAEAFAABAAEAAQAUAAEAAQABAAEAAQAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArACsAHgArAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAUAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEAA0ADQBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUAArACsAKwBQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABABQACsAKwArACsAKwArACsAKwAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUAAaABoAUABQAFAAUABQAEwAHgAbAFAAHgAEACsAKwAEAAQABAArAFAAUABQAFAAUABQACsAKwArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQACsAUABQACsAKwAEACsABAAEAAQABAAEACsAKwArACsABAAEACsAKwAEAAQABAArACsAKwAEACsAKwArACsAKwArACsAUABQAFAAUAArAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLAAQABABQAFAAUAAEAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAArACsAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AGwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAKwArACsAKwArAAQABAAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAAQAUAArAFAAUABQAFAAUABQACsAKwArAFAAUABQACsAUABQAFAAUAArACsAKwBQAFAAKwBQACsAUABQACsAKwArAFAAUAArACsAKwBQAFAAUAArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArAAQABAAEAAQABAArACsAKwAEAAQABAArAAQABAAEAAQAKwArAFAAKwArACsAKwArACsABAArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAHgAeAB4AHgAeAB4AGwAeACsAKwArACsAKwAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAUABQAFAAKwArACsAKwArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwAOAFAAUABQAFAAUABQAFAAHgBQAAQABAAEAA4AUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAKwArAAQAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAKwArACsAKwArACsAUAArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABABQAB4AKwArACsAKwBQAFAAUAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQABoAUABQAFAAUABQAFAAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQACsAUAArACsAUABQAFAAUABQAFAAUAArACsAKwAEACsAKwArACsABAAEAAQABAAEAAQAKwAEACsABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArAAQABAAeACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAXAAqACoAKgAqACoAKgAqACsAKwArACsAGwBcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAeAEsASwBLAEsASwBLAEsASwBLAEsADQANACsAKwArACsAKwBcAFwAKwBcACsAXABcAFwAXABcACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAXAArAFwAXABcAFwAXABcAFwAXABcAFwAKgBcAFwAKgAqACoAKgAqACoAKgAqACoAXAArACsAXABcAFwAXABcACsAXAArACoAKgAqACoAKgAqACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwBcAFwAXABcAFAADgAOAA4ADgAeAA4ADgAJAA4ADgANAAkAEwATABMAEwATAAkAHgATAB4AHgAeAAQABAAeAB4AHgAeAB4AHgBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQAFAADQAEAB4ABAAeAAQAFgARABYAEQAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAAQABAAEAAQADQAEAAQAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAA0ADQAeAB4AHgAeAB4AHgAEAB4AHgAeAB4AHgAeACsAHgAeAA4ADgANAA4AHgAeAB4AHgAeAAkACQArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgBcAEsASwBLAEsASwBLAEsASwBLAEsADQANAB4AHgAeAB4AXABcAFwAXABcAFwAKgAqACoAKgBcAFwAXABcACoAKgAqAFwAKgAqACoAXABcACoAKgAqACoAKgAqACoAXABcAFwAKgAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqAFwAKgBLAEsASwBLAEsASwBLAEsASwBLACoAKgAqACoAKgAqAFAAUABQAFAAUABQACsAUAArACsAKwArACsAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAKwBQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsABAAEAAQAHgANAB4AHgAeAB4AHgAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUAArACsADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWABEAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQANAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAANAA0AKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUAArAAQABAArACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqAA0ADQAVAFwADQAeAA0AGwBcACoAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwAeAB4AEwATAA0ADQAOAB4AEwATAB4ABAAEAAQACQArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAHgArACsAKwATABMASwBLAEsASwBLAEsASwBLAEsASwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAXABcAFwAXABcACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAXAArACsAKwAqACoAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsAHgAeAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKwAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKwArAAQASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACoAKgAqACoAKgAqACoAXAAqACoAKgAqACoAKgArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABABQAFAAUABQAFAAUABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwANAA0AHgANAA0ADQANAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwAeAB4AHgAeAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArAA0ADQANAA0ADQBLAEsASwBLAEsASwBLAEsASwBLACsAKwArAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUAAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAAQAUABQAFAAUABQAFAABABQAFAABAAEAAQAUAArACsAKwArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQACsAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAFAAUABQACsAHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQACsAKwAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQACsAHgAeAB4AHgAeAB4AHgAOAB4AKwANAA0ADQANAA0ADQANAAkADQANAA0ACAAEAAsABAAEAA0ACQANAA0ADAAdAB0AHgAXABcAFgAXABcAFwAWABcAHQAdAB4AHgAUABQAFAANAAEAAQAEAAQABAAEAAQACQAaABoAGgAaABoAGgAaABoAHgAXABcAHQAVABUAHgAeAB4AHgAeAB4AGAAWABEAFQAVABUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ADQAeAA0ADQANAA0AHgANAA0ADQAHAB4AHgAeAB4AKwAEAAQABAAEAAQABAAEAAQABAAEAFAAUAArACsATwBQAFAAUABQAFAAHgAeAB4AFgARAE8AUABPAE8ATwBPAFAAUABQAFAAUAAeAB4AHgAWABEAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArABsAGwAbABsAGwAbABsAGgAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGgAbABsAGwAbABoAGwAbABoAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAHgAeAFAAGgAeAB0AHgBQAB4AGgAeAB4AHgAeAB4AHgAeAB4AHgBPAB4AUAAbAB4AHgBQAFAAUABQAFAAHgAeAB4AHQAdAB4AUAAeAFAAHgBQAB4AUABPAFAAUAAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgBQAFAAUABQAE8ATwBQAFAAUABQAFAATwBQAFAATwBQAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAUABQAFAATwBPAE8ATwBPAE8ATwBPAE8ATwBQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABPAB4AHgArACsAKwArAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHQAdAB4AHgAeAB0AHQAeAB4AHQAeAB4AHgAdAB4AHQAbABsAHgAdAB4AHgAeAB4AHQAeAB4AHQAdAB0AHQAeAB4AHQAeAB0AHgAdAB0AHQAdAB0AHQAeAB0AHgAeAB4AHgAeAB0AHQAdAB0AHgAeAB4AHgAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeAB0AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAeAB0AHQAdAB0AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAWABEAHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAWABEAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AHQAdAB0AHgAeAB0AHgAeAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlAB4AHQAdAB4AHgAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AJQAlAB0AHQAlAB4AJQAlACUAIAAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAdAB0AHQAeAB0AJQAdAB0AHgAdAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAdAB0AHQAdACUAHgAlACUAJQAdACUAJQAdAB0AHQAlACUAHQAdACUAHQAdACUAJQAlAB4AHQAeAB4AHgAeAB0AHQAlAB0AHQAdAB0AHQAdACUAJQAlACUAJQAdACUAJQAgACUAHQAdACUAJQAlACUAJQAlACUAJQAeAB4AHgAlACUAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AFwAXABcAFwAXABcAHgATABMAJQAeAB4AHgAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARABYAEQAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAEAAQABAAeAB4AKwArACsAKwArABMADQANAA0AUAATAA0AUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUAANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAA0ADQANAA0ADQANAA0ADQAeAA0AFgANAB4AHgAXABcAHgAeABcAFwAWABEAFgARABYAEQAWABEADQANAA0ADQATAFAADQANAB4ADQANAB4AHgAeAB4AHgAMAAwADQANAA0AHgANAA0AFgANAA0ADQANAA0ADQANAA0AHgANAB4ADQANAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArAA0AEQARACUAJQBHAFcAVwAWABEAFgARABYAEQAWABEAFgARACUAJQAWABEAFgARABYAEQAWABEAFQAWABEAEQAlAFcAVwBXAFcAVwBXAFcAVwBXAAQABAAEAAQABAAEACUAVwBXAFcAVwA2ACUAJQBXAFcAVwBHAEcAJQAlACUAKwBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBRAFcAUQBXAFEAVwBXAFcAVwBXAFcAUQBXAFcAVwBXAFcAVwBRAFEAKwArAAQABAAVABUARwBHAFcAFQBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBRAFcAVwBXAFcAVwBXAFEAUQBXAFcAVwBXABUAUQBHAEcAVwArACsAKwArACsAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwAlACUAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACsAKwArACsAKwArACsAKwArACsAKwArAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBPAE8ATwBPAE8ATwBPAE8AJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADQATAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABLAEsASwBLAEsASwBLAEsASwBLAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAABAAEAAQABAAeAAQABAAEAAQABAAEAAQABAAEAAQAHgBQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAeAA0ADQANAA0ADQArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAAQAUABQAFAABABQAFAAUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAeAB4AHgAeAAQAKwArACsAUABQAFAAUABQAFAAHgAeABoAHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADgAOABMAEwArACsAKwArACsAKwArACsABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwANAA0ASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUAAeAB4AHgBQAA4AUABQAAQAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArAB4AWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYACsAKwArAAQAHgAeAB4AHgAeAB4ADQANAA0AHgAeAB4AHgArAFAASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArAB4AHgBcAFwAXABcAFwAKgBcAFwAXABcAFwAXABcAFwAXABcAEsASwBLAEsASwBLAEsASwBLAEsAXABcAFwAXABcACsAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAFAAUABQAAQAUABQAFAAUABQAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAHgANAA0ADQBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAXAAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAKgAqACoAXABcACoAKgBcAFwAXABcAFwAKgAqAFwAKgBcACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcACoAKgBQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAA0ADQBQAFAAUAAEAAQAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQADQAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAVABVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBUAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVACsAKwArACsAKwArACsAKwArACsAKwArAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAKwArACsAKwBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAKwArACsAKwAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAKwArACsAKwArAFYABABWAFYAVgBWAFYAVgBWAFYAVgBWAB4AVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgArAFYAVgBWAFYAVgArAFYAKwBWAFYAKwBWAFYAKwBWAFYAVgBWAFYAVgBWAFYAVgBWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAEQAWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAaAB4AKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAGAARABEAGAAYABMAEwAWABEAFAArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACUAJQAlACUAJQAWABEAFgARABYAEQAWABEAFgARABYAEQAlACUAFgARACUAJQAlACUAJQAlACUAEQAlABEAKwAVABUAEwATACUAFgARABYAEQAWABEAJQAlACUAJQAlACUAJQAlACsAJQAbABoAJQArACsAKwArAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAcAKwATACUAJQAbABoAJQAlABYAEQAlACUAEQAlABEAJQBXAFcAVwBXAFcAVwBXAFcAVwBXABUAFQAlACUAJQATACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXABYAJQARACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAWACUAEQAlABYAEQARABYAEQARABUAVwBRAFEAUQBRAFEAUQBRAFEAUQBRAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcARwArACsAVwBXAFcAVwBXAFcAKwArAFcAVwBXAFcAVwBXACsAKwBXAFcAVwBXAFcAVwArACsAVwBXAFcAKwArACsAGgAbACUAJQAlABsAGwArAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAAQAB0AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsADQANAA0AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAA0AUABQAFAAUAArACsAKwArAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwArAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwBQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAUABQAFAAUABQAAQABAAEACsABAAEACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAKwBQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAA0ADQANAA0ADQANAA0ADQAeACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAArACsAKwArAFAAUABQAFAAUAANAA0ADQANAA0ADQAUACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsADQANAA0ADQANAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArAAQABAANACsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAB4AHgAeAB4AHgArACsAKwArACsAKwAEAAQABAAEAAQABAAEAA0ADQAeAB4AHgAeAB4AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsASwBLAEsASwBLAEsASwBLAEsASwANAA0ADQANAFAABAAEAFAAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAeAA4AUAArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAADQANAB4ADQAEAAQABAAEAB4ABAAEAEsASwBLAEsASwBLAEsASwBLAEsAUAAOAFAADQANAA0AKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAANAA0AHgANAA0AHgAEACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAA0AKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsABAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsABAAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAUAArACsAKwArACsAKwAEACsAKwArACsAKwBQAFAAUABQAFAABAAEACsAKwAEAAQABAAEAAQABAAEACsAKwArAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABABQAFAAUABQAA0ADQANAA0AHgBLAEsASwBLAEsASwBLAEsASwBLAA0ADQArAB4ABABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUAAeAFAAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABAAEAAQADgANAA0AEwATAB4AHgAeAA0ADQANAA0ADQANAA0ADQANAA0ADQANAA0ADQANAFAAUABQAFAABAAEACsAKwAEAA0ADQAeAFAAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKwArACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBcAFwADQANAA0AKgBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAKwArAFAAKwArAFAAUABQAFAAUABQAFAAUAArAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQAKwAEAAQAKwArAAQABAAEAAQAUAAEAFAABAAEAA0ADQANACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABABQAA4AUAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAFAABAAEAAQABAAOAB4ADQANAA0ADQAOAB4ABAArACsAKwArACsAKwArACsAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAA0ADQANAFAADgAOAA4ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAAQABAAEAFAADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAOABMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAArACsAKwAEACsABAAEACsABAAEAAQABAAEAAQABABQAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAaABoAGgAaAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABIAEgAQwBDAEMAUABQAFAAUABDAFAAUABQAEgAQwBIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABDAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAJAAkACQAJAAkACQAJABYAEQArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwANAA0AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAANACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAA0ADQANAB4AHgAeAB4AHgAeAFAAUABQAFAADQAeACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAA0AHgAeACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAARwBHABUARwAJACsAKwArACsAKwArACsAKwArACsAKwAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUQBRAFEAKwArACsAKwArACsAKwArACsAKwArACsAKwBRAFEAUQBRACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAHgAEAAQADQAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQABAAEAAQABAAeAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQAHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAKwArAFAAKwArAFAAUAArACsAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUAArAFAAUABQAFAAUABQAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAHgAeAFAAUABQAFAAUAArAFAAKwArACsAUABQAFAAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeACsAKwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4ABAAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAHgAeAA0ADQANAA0AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArAAQABAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwBQAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArABsAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAB4AHgAeAB4ABAAEAAQABAAEAAQABABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArABYAFgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAGgBQAFAAUAAaAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUAArACsAKwArACsAKwBQACsAKwArACsAUAArAFAAKwBQACsAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUAArAFAAKwBQACsAUAArAFAAUAArAFAAKwArAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAKwBQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8AJQAlACUAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB4AHgAeACUAJQAlAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAlACUAJQAlACUAHgAlACUAJQAlACUAIAAgACAAJQAlACAAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACEAIQAhACEAIQAlACUAIAAgACUAJQAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAIAAlACUAJQAlACAAIAAgACUAIAAgACAAJQAlACUAJQAlACUAJQAgACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAlAB4AJQAeACUAJQAlACUAJQAgACUAJQAlACUAHgAlAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACAAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABcAFwAXABUAFQAVAB4AHgAeAB4AJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAgACUAJQAgACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAIAAgACUAJQAgACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACAAIAAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACAAIAAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAA==';

    /* @flow */
    var LETTER_NUMBER_MODIFIER = 50;
    // Non-tailorable Line Breaking Classes
    var BK = 1; //  Cause a line break (after)
    var CR$1 = 2; //  Cause a line break (after), except between CR and LF
    var LF$1 = 3; //  Cause a line break (after)
    var CM = 4; //  Prohibit a line break between the character and the preceding character
    var NL = 5; //  Cause a line break (after)
    var WJ = 7; //  Prohibit line breaks before and after
    var ZW = 8; //  Provide a break opportunity
    var GL = 9; //  Prohibit line breaks before and after
    var SP = 10; // Enable indirect line breaks
    var ZWJ$1 = 11; // Prohibit line breaks within joiner sequences
    // Break Opportunities
    var B2 = 12; //  Provide a line break opportunity before and after the character
    var BA = 13; //  Generally provide a line break opportunity after the character
    var BB = 14; //  Generally provide a line break opportunity before the character
    var HY = 15; //  Provide a line break opportunity after the character, except in numeric context
    var CB = 16; //   Provide a line break opportunity contingent on additional information
    // Characters Prohibiting Certain Breaks
    var CL = 17; //  Prohibit line breaks before
    var CP = 18; //  Prohibit line breaks before
    var EX = 19; //  Prohibit line breaks before
    var IN = 20; //  Allow only indirect line breaks between pairs
    var NS = 21; //  Allow only indirect line breaks before
    var OP = 22; //  Prohibit line breaks after
    var QU = 23; //  Act like they are both opening and closing
    // Numeric Context
    var IS = 24; //  Prevent breaks after any and before numeric
    var NU = 25; //  Form numeric expressions for line breaking purposes
    var PO = 26; //  Do not break following a numeric expression
    var PR = 27; //  Do not break in front of a numeric expression
    var SY = 28; //  Prevent a break before; and allow a break after
    // Other Characters
    var AI = 29; //  Act like AL when the resolvedEAW is N; otherwise; act as ID
    var AL = 30; //  Are alphabetic characters or symbols that are used with alphabetic characters
    var CJ = 31; //  Treat as NS or ID for strict or normal breaking.
    var EB = 32; //  Do not break from following Emoji Modifier
    var EM = 33; //  Do not break from preceding Emoji Base
    var H2 = 34; //  Form Korean syllable blocks
    var H3 = 35; //  Form Korean syllable blocks
    var HL = 36; //  Do not break around a following hyphen; otherwise act as Alphabetic
    var ID = 37; //  Break before or after; except in some numeric context
    var JL = 38; //  Form Korean syllable blocks
    var JV = 39; //  Form Korean syllable blocks
    var JT = 40; //  Form Korean syllable blocks
    var RI$1 = 41; //  Keep pairs together. For pairs; break before and after other classes
    var SA = 42; //  Provide a line break opportunity contingent on additional, language-specific context analysis
    var XX = 43; //  Have as yet unknown line breaking behavior or unassigned code positions
    var ea_OP = [0x2329, 0xff08];
    var BREAK_MANDATORY = '!';
    var BREAK_NOT_ALLOWED$1 = '×';
    var BREAK_ALLOWED$1 = '÷';
    var UnicodeTrie$1 = createTrieFromBase64$1(base64$1);
    var ALPHABETICS = [AL, HL];
    var HARD_LINE_BREAKS = [BK, CR$1, LF$1, NL];
    var SPACE$1 = [SP, ZW];
    var PREFIX_POSTFIX = [PR, PO];
    var LINE_BREAKS = HARD_LINE_BREAKS.concat(SPACE$1);
    var KOREAN_SYLLABLE_BLOCK = [JL, JV, JT, H2, H3];
    var HYPHEN = [HY, BA];
    var codePointsToCharacterClasses = function (codePoints, lineBreak) {
        if (lineBreak === void 0) { lineBreak = 'strict'; }
        var types = [];
        var indices = [];
        var categories = [];
        codePoints.forEach(function (codePoint, index) {
            var classType = UnicodeTrie$1.get(codePoint);
            if (classType > LETTER_NUMBER_MODIFIER) {
                categories.push(true);
                classType -= LETTER_NUMBER_MODIFIER;
            }
            else {
                categories.push(false);
            }
            if (['normal', 'auto', 'loose'].indexOf(lineBreak) !== -1) {
                // U+2010, – U+2013, 〜 U+301C, ゠ U+30A0
                if ([0x2010, 0x2013, 0x301c, 0x30a0].indexOf(codePoint) !== -1) {
                    indices.push(index);
                    return types.push(CB);
                }
            }
            if (classType === CM || classType === ZWJ$1) {
                // LB10 Treat any remaining combining mark or ZWJ as AL.
                if (index === 0) {
                    indices.push(index);
                    return types.push(AL);
                }
                // LB9 Do not break a combining character sequence; treat it as if it has the line breaking class of
                // the base character in all of the following rules. Treat ZWJ as if it were CM.
                var prev = types[index - 1];
                if (LINE_BREAKS.indexOf(prev) === -1) {
                    indices.push(indices[index - 1]);
                    return types.push(prev);
                }
                indices.push(index);
                return types.push(AL);
            }
            indices.push(index);
            if (classType === CJ) {
                return types.push(lineBreak === 'strict' ? NS : ID);
            }
            if (classType === SA) {
                return types.push(AL);
            }
            if (classType === AI) {
                return types.push(AL);
            }
            // For supplementary characters, a useful default is to treat characters in the range 10000..1FFFD as AL
            // and characters in the ranges 20000..2FFFD and 30000..3FFFD as ID, until the implementation can be revised
            // to take into account the actual line breaking properties for these characters.
            if (classType === XX) {
                if ((codePoint >= 0x20000 && codePoint <= 0x2fffd) || (codePoint >= 0x30000 && codePoint <= 0x3fffd)) {
                    return types.push(ID);
                }
                else {
                    return types.push(AL);
                }
            }
            types.push(classType);
        });
        return [indices, types, categories];
    };
    var isAdjacentWithSpaceIgnored = function (a, b, currentIndex, classTypes) {
        var current = classTypes[currentIndex];
        if (Array.isArray(a) ? a.indexOf(current) !== -1 : a === current) {
            var i = currentIndex;
            while (i <= classTypes.length) {
                i++;
                var next = classTypes[i];
                if (next === b) {
                    return true;
                }
                if (next !== SP) {
                    break;
                }
            }
        }
        if (current === SP) {
            var i = currentIndex;
            while (i > 0) {
                i--;
                var prev = classTypes[i];
                if (Array.isArray(a) ? a.indexOf(prev) !== -1 : a === prev) {
                    var n = currentIndex;
                    while (n <= classTypes.length) {
                        n++;
                        var next = classTypes[n];
                        if (next === b) {
                            return true;
                        }
                        if (next !== SP) {
                            break;
                        }
                    }
                }
                if (prev !== SP) {
                    break;
                }
            }
        }
        return false;
    };
    var previousNonSpaceClassType = function (currentIndex, classTypes) {
        var i = currentIndex;
        while (i >= 0) {
            var type = classTypes[i];
            if (type === SP) {
                i--;
            }
            else {
                return type;
            }
        }
        return 0;
    };
    var _lineBreakAtIndex = function (codePoints, classTypes, indicies, index, forbiddenBreaks) {
        if (indicies[index] === 0) {
            return BREAK_NOT_ALLOWED$1;
        }
        var currentIndex = index - 1;
        if (Array.isArray(forbiddenBreaks) && forbiddenBreaks[currentIndex] === true) {
            return BREAK_NOT_ALLOWED$1;
        }
        var beforeIndex = currentIndex - 1;
        var afterIndex = currentIndex + 1;
        var current = classTypes[currentIndex];
        // LB4 Always break after hard line breaks.
        // LB5 Treat CR followed by LF, as well as CR, LF, and NL as hard line breaks.
        var before = beforeIndex >= 0 ? classTypes[beforeIndex] : 0;
        var next = classTypes[afterIndex];
        if (current === CR$1 && next === LF$1) {
            return BREAK_NOT_ALLOWED$1;
        }
        if (HARD_LINE_BREAKS.indexOf(current) !== -1) {
            return BREAK_MANDATORY;
        }
        // LB6 Do not break before hard line breaks.
        if (HARD_LINE_BREAKS.indexOf(next) !== -1) {
            return BREAK_NOT_ALLOWED$1;
        }
        // LB7 Do not break before spaces or zero width space.
        if (SPACE$1.indexOf(next) !== -1) {
            return BREAK_NOT_ALLOWED$1;
        }
        // LB8 Break before any character following a zero-width space, even if one or more spaces intervene.
        if (previousNonSpaceClassType(currentIndex, classTypes) === ZW) {
            return BREAK_ALLOWED$1;
        }
        // LB8a Do not break after a zero width joiner.
        if (UnicodeTrie$1.get(codePoints[currentIndex]) === ZWJ$1) {
            return BREAK_NOT_ALLOWED$1;
        }
        // zwj emojis
        if ((current === EB || current === EM) && UnicodeTrie$1.get(codePoints[afterIndex]) === ZWJ$1) {
            return BREAK_NOT_ALLOWED$1;
        }
        // LB11 Do not break before or after Word joiner and related characters.
        if (current === WJ || next === WJ) {
            return BREAK_NOT_ALLOWED$1;
        }
        // LB12 Do not break after NBSP and related characters.
        if (current === GL) {
            return BREAK_NOT_ALLOWED$1;
        }
        // LB12a Do not break before NBSP and related characters, except after spaces and hyphens.
        if ([SP, BA, HY].indexOf(current) === -1 && next === GL) {
            return BREAK_NOT_ALLOWED$1;
        }
        // LB13 Do not break before ‘]’ or ‘!’ or ‘;’ or ‘/’, even after spaces.
        if ([CL, CP, EX, IS, SY].indexOf(next) !== -1) {
            return BREAK_NOT_ALLOWED$1;
        }
        // LB14 Do not break after ‘[’, even after spaces.
        if (previousNonSpaceClassType(currentIndex, classTypes) === OP) {
            return BREAK_NOT_ALLOWED$1;
        }
        // LB15 Do not break within ‘”[’, even with intervening spaces.
        if (isAdjacentWithSpaceIgnored(QU, OP, currentIndex, classTypes)) {
            return BREAK_NOT_ALLOWED$1;
        }
        // LB16 Do not break between closing punctuation and a nonstarter (lb=NS), even with intervening spaces.
        if (isAdjacentWithSpaceIgnored([CL, CP], NS, currentIndex, classTypes)) {
            return BREAK_NOT_ALLOWED$1;
        }
        // LB17 Do not break within ‘——’, even with intervening spaces.
        if (isAdjacentWithSpaceIgnored(B2, B2, currentIndex, classTypes)) {
            return BREAK_NOT_ALLOWED$1;
        }
        // LB18 Break after spaces.
        if (current === SP) {
            return BREAK_ALLOWED$1;
        }
        // LB19 Do not break before or after quotation marks, such as ‘ ” ’.
        if (current === QU || next === QU) {
            return BREAK_NOT_ALLOWED$1;
        }
        // LB20 Break before and after unresolved CB.
        if (next === CB || current === CB) {
            return BREAK_ALLOWED$1;
        }
        // LB21 Do not break before hyphen-minus, other hyphens, fixed-width spaces, small kana, and other non-starters, or after acute accents.
        if ([BA, HY, NS].indexOf(next) !== -1 || current === BB) {
            return BREAK_NOT_ALLOWED$1;
        }
        // LB21a Don't break after Hebrew + Hyphen.
        if (before === HL && HYPHEN.indexOf(current) !== -1) {
            return BREAK_NOT_ALLOWED$1;
        }
        // LB21b Don’t break between Solidus and Hebrew letters.
        if (current === SY && next === HL) {
            return BREAK_NOT_ALLOWED$1;
        }
        // LB22 Do not break before ellipsis.
        if (next === IN) {
            return BREAK_NOT_ALLOWED$1;
        }
        // LB23 Do not break between digits and letters.
        if ((ALPHABETICS.indexOf(next) !== -1 && current === NU) || (ALPHABETICS.indexOf(current) !== -1 && next === NU)) {
            return BREAK_NOT_ALLOWED$1;
        }
        // LB23a Do not break between numeric prefixes and ideographs, or between ideographs and numeric postfixes.
        if ((current === PR && [ID, EB, EM].indexOf(next) !== -1) ||
            ([ID, EB, EM].indexOf(current) !== -1 && next === PO)) {
            return BREAK_NOT_ALLOWED$1;
        }
        // LB24 Do not break between numeric prefix/postfix and letters, or between letters and prefix/postfix.
        if ((ALPHABETICS.indexOf(current) !== -1 && PREFIX_POSTFIX.indexOf(next) !== -1) ||
            (PREFIX_POSTFIX.indexOf(current) !== -1 && ALPHABETICS.indexOf(next) !== -1)) {
            return BREAK_NOT_ALLOWED$1;
        }
        // LB25 Do not break between the following pairs of classes relevant to numbers:
        if (
        // (PR | PO) × ( OP | HY )? NU
        ([PR, PO].indexOf(current) !== -1 &&
            (next === NU || ([OP, HY].indexOf(next) !== -1 && classTypes[afterIndex + 1] === NU))) ||
            // ( OP | HY ) × NU
            ([OP, HY].indexOf(current) !== -1 && next === NU) ||
            // NU ×	(NU | SY | IS)
            (current === NU && [NU, SY, IS].indexOf(next) !== -1)) {
            return BREAK_NOT_ALLOWED$1;
        }
        // NU (NU | SY | IS)* × (NU | SY | IS | CL | CP)
        if ([NU, SY, IS, CL, CP].indexOf(next) !== -1) {
            var prevIndex = currentIndex;
            while (prevIndex >= 0) {
                var type = classTypes[prevIndex];
                if (type === NU) {
                    return BREAK_NOT_ALLOWED$1;
                }
                else if ([SY, IS].indexOf(type) !== -1) {
                    prevIndex--;
                }
                else {
                    break;
                }
            }
        }
        // NU (NU | SY | IS)* (CL | CP)? × (PO | PR))
        if ([PR, PO].indexOf(next) !== -1) {
            var prevIndex = [CL, CP].indexOf(current) !== -1 ? beforeIndex : currentIndex;
            while (prevIndex >= 0) {
                var type = classTypes[prevIndex];
                if (type === NU) {
                    return BREAK_NOT_ALLOWED$1;
                }
                else if ([SY, IS].indexOf(type) !== -1) {
                    prevIndex--;
                }
                else {
                    break;
                }
            }
        }
        // LB26 Do not break a Korean syllable.
        if ((JL === current && [JL, JV, H2, H3].indexOf(next) !== -1) ||
            ([JV, H2].indexOf(current) !== -1 && [JV, JT].indexOf(next) !== -1) ||
            ([JT, H3].indexOf(current) !== -1 && next === JT)) {
            return BREAK_NOT_ALLOWED$1;
        }
        // LB27 Treat a Korean Syllable Block the same as ID.
        if ((KOREAN_SYLLABLE_BLOCK.indexOf(current) !== -1 && [IN, PO].indexOf(next) !== -1) ||
            (KOREAN_SYLLABLE_BLOCK.indexOf(next) !== -1 && current === PR)) {
            return BREAK_NOT_ALLOWED$1;
        }
        // LB28 Do not break between alphabetics (“at”).
        if (ALPHABETICS.indexOf(current) !== -1 && ALPHABETICS.indexOf(next) !== -1) {
            return BREAK_NOT_ALLOWED$1;
        }
        // LB29 Do not break between numeric punctuation and alphabetics (“e.g.”).
        if (current === IS && ALPHABETICS.indexOf(next) !== -1) {
            return BREAK_NOT_ALLOWED$1;
        }
        // LB30 Do not break between letters, numbers, or ordinary symbols and opening or closing parentheses.
        if ((ALPHABETICS.concat(NU).indexOf(current) !== -1 &&
            next === OP &&
            ea_OP.indexOf(codePoints[afterIndex]) === -1) ||
            (ALPHABETICS.concat(NU).indexOf(next) !== -1 && current === CP)) {
            return BREAK_NOT_ALLOWED$1;
        }
        // LB30a Break between two regional indicator symbols if and only if there are an even number of regional
        // indicators preceding the position of the break.
        if (current === RI$1 && next === RI$1) {
            var i = indicies[currentIndex];
            var count = 1;
            while (i > 0) {
                i--;
                if (classTypes[i] === RI$1) {
                    count++;
                }
                else {
                    break;
                }
            }
            if (count % 2 !== 0) {
                return BREAK_NOT_ALLOWED$1;
            }
        }
        // LB30b Do not break between an emoji base and an emoji modifier.
        if (current === EB && next === EM) {
            return BREAK_NOT_ALLOWED$1;
        }
        return BREAK_ALLOWED$1;
    };
    var cssFormattedClasses = function (codePoints, options) {
        if (!options) {
            options = { lineBreak: 'normal', wordBreak: 'normal' };
        }
        var _a = codePointsToCharacterClasses(codePoints, options.lineBreak), indicies = _a[0], classTypes = _a[1], isLetterNumber = _a[2];
        if (options.wordBreak === 'break-all' || options.wordBreak === 'break-word') {
            classTypes = classTypes.map(function (type) { return ([NU, AL, SA].indexOf(type) !== -1 ? ID : type); });
        }
        var forbiddenBreakpoints = options.wordBreak === 'keep-all'
            ? isLetterNumber.map(function (letterNumber, i) {
                return letterNumber && codePoints[i] >= 0x4e00 && codePoints[i] <= 0x9fff;
            })
            : undefined;
        return [indicies, classTypes, forbiddenBreakpoints];
    };
    var Break = /** @class */ (function () {
        function Break(codePoints, lineBreak, start, end) {
            this.codePoints = codePoints;
            this.required = lineBreak === BREAK_MANDATORY;
            this.start = start;
            this.end = end;
        }
        Break.prototype.slice = function () {
            return fromCodePoint$1.apply(void 0, this.codePoints.slice(this.start, this.end));
        };
        return Break;
    }());
    var LineBreaker = function (str, options) {
        var codePoints = toCodePoints$1(str);
        var _a = cssFormattedClasses(codePoints, options), indicies = _a[0], classTypes = _a[1], forbiddenBreakpoints = _a[2];
        var length = codePoints.length;
        var lastEnd = 0;
        var nextIndex = 0;
        return {
            next: function () {
                if (nextIndex >= length) {
                    return { done: true, value: null };
                }
                var lineBreak = BREAK_NOT_ALLOWED$1;
                while (nextIndex < length &&
                    (lineBreak = _lineBreakAtIndex(codePoints, classTypes, indicies, ++nextIndex, forbiddenBreakpoints)) ===
                        BREAK_NOT_ALLOWED$1) { }
                if (lineBreak !== BREAK_NOT_ALLOWED$1 || nextIndex === length) {
                    var value = new Break(codePoints, lineBreak, lastEnd, nextIndex);
                    lastEnd = nextIndex;
                    return { value: value, done: false };
                }
                return { done: true, value: null };
            },
        };
    };

    // https://www.w3.org/TR/css-syntax-3
    var FLAG_UNRESTRICTED = 1 << 0;
    var FLAG_ID = 1 << 1;
    var FLAG_INTEGER = 1 << 2;
    var FLAG_NUMBER = 1 << 3;
    var LINE_FEED = 0x000a;
    var SOLIDUS = 0x002f;
    var REVERSE_SOLIDUS = 0x005c;
    var CHARACTER_TABULATION = 0x0009;
    var SPACE = 0x0020;
    var QUOTATION_MARK = 0x0022;
    var EQUALS_SIGN = 0x003d;
    var NUMBER_SIGN = 0x0023;
    var DOLLAR_SIGN = 0x0024;
    var PERCENTAGE_SIGN = 0x0025;
    var APOSTROPHE = 0x0027;
    var LEFT_PARENTHESIS = 0x0028;
    var RIGHT_PARENTHESIS = 0x0029;
    var LOW_LINE = 0x005f;
    var HYPHEN_MINUS = 0x002d;
    var EXCLAMATION_MARK = 0x0021;
    var LESS_THAN_SIGN = 0x003c;
    var GREATER_THAN_SIGN = 0x003e;
    var COMMERCIAL_AT = 0x0040;
    var LEFT_SQUARE_BRACKET = 0x005b;
    var RIGHT_SQUARE_BRACKET = 0x005d;
    var CIRCUMFLEX_ACCENT = 0x003d;
    var LEFT_CURLY_BRACKET = 0x007b;
    var QUESTION_MARK = 0x003f;
    var RIGHT_CURLY_BRACKET = 0x007d;
    var VERTICAL_LINE = 0x007c;
    var TILDE = 0x007e;
    var CONTROL = 0x0080;
    var REPLACEMENT_CHARACTER = 0xfffd;
    var ASTERISK = 0x002a;
    var PLUS_SIGN = 0x002b;
    var COMMA = 0x002c;
    var COLON = 0x003a;
    var SEMICOLON = 0x003b;
    var FULL_STOP = 0x002e;
    var NULL = 0x0000;
    var BACKSPACE = 0x0008;
    var LINE_TABULATION = 0x000b;
    var SHIFT_OUT = 0x000e;
    var INFORMATION_SEPARATOR_ONE = 0x001f;
    var DELETE = 0x007f;
    var EOF = -1;
    var ZERO = 0x0030;
    var a = 0x0061;
    var e = 0x0065;
    var f = 0x0066;
    var u = 0x0075;
    var z = 0x007a;
    var A = 0x0041;
    var E = 0x0045;
    var F = 0x0046;
    var U = 0x0055;
    var Z = 0x005a;
    var isDigit = function (codePoint) { return codePoint >= ZERO && codePoint <= 0x0039; };
    var isSurrogateCodePoint = function (codePoint) { return codePoint >= 0xd800 && codePoint <= 0xdfff; };
    var isHex = function (codePoint) {
        return isDigit(codePoint) || (codePoint >= A && codePoint <= F) || (codePoint >= a && codePoint <= f);
    };
    var isLowerCaseLetter = function (codePoint) { return codePoint >= a && codePoint <= z; };
    var isUpperCaseLetter = function (codePoint) { return codePoint >= A && codePoint <= Z; };
    var isLetter = function (codePoint) { return isLowerCaseLetter(codePoint) || isUpperCaseLetter(codePoint); };
    var isNonASCIICodePoint = function (codePoint) { return codePoint >= CONTROL; };
    var isWhiteSpace = function (codePoint) {
        return codePoint === LINE_FEED || codePoint === CHARACTER_TABULATION || codePoint === SPACE;
    };
    var isNameStartCodePoint = function (codePoint) {
        return isLetter(codePoint) || isNonASCIICodePoint(codePoint) || codePoint === LOW_LINE;
    };
    var isNameCodePoint = function (codePoint) {
        return isNameStartCodePoint(codePoint) || isDigit(codePoint) || codePoint === HYPHEN_MINUS;
    };
    var isNonPrintableCodePoint = function (codePoint) {
        return ((codePoint >= NULL && codePoint <= BACKSPACE) ||
            codePoint === LINE_TABULATION ||
            (codePoint >= SHIFT_OUT && codePoint <= INFORMATION_SEPARATOR_ONE) ||
            codePoint === DELETE);
    };
    var isValidEscape = function (c1, c2) {
        if (c1 !== REVERSE_SOLIDUS) {
            return false;
        }
        return c2 !== LINE_FEED;
    };
    var isIdentifierStart = function (c1, c2, c3) {
        if (c1 === HYPHEN_MINUS) {
            return isNameStartCodePoint(c2) || isValidEscape(c2, c3);
        }
        else if (isNameStartCodePoint(c1)) {
            return true;
        }
        else if (c1 === REVERSE_SOLIDUS && isValidEscape(c1, c2)) {
            return true;
        }
        return false;
    };
    var isNumberStart = function (c1, c2, c3) {
        if (c1 === PLUS_SIGN || c1 === HYPHEN_MINUS) {
            if (isDigit(c2)) {
                return true;
            }
            return c2 === FULL_STOP && isDigit(c3);
        }
        if (c1 === FULL_STOP) {
            return isDigit(c2);
        }
        return isDigit(c1);
    };
    var stringToNumber = function (codePoints) {
        var c = 0;
        var sign = 1;
        if (codePoints[c] === PLUS_SIGN || codePoints[c] === HYPHEN_MINUS) {
            if (codePoints[c] === HYPHEN_MINUS) {
                sign = -1;
            }
            c++;
        }
        var integers = [];
        while (isDigit(codePoints[c])) {
            integers.push(codePoints[c++]);
        }
        var int = integers.length ? parseInt(fromCodePoint$1.apply(void 0, integers), 10) : 0;
        if (codePoints[c] === FULL_STOP) {
            c++;
        }
        var fraction = [];
        while (isDigit(codePoints[c])) {
            fraction.push(codePoints[c++]);
        }
        var fracd = fraction.length;
        var frac = fracd ? parseInt(fromCodePoint$1.apply(void 0, fraction), 10) : 0;
        if (codePoints[c] === E || codePoints[c] === e) {
            c++;
        }
        var expsign = 1;
        if (codePoints[c] === PLUS_SIGN || codePoints[c] === HYPHEN_MINUS) {
            if (codePoints[c] === HYPHEN_MINUS) {
                expsign = -1;
            }
            c++;
        }
        var exponent = [];
        while (isDigit(codePoints[c])) {
            exponent.push(codePoints[c++]);
        }
        var exp = exponent.length ? parseInt(fromCodePoint$1.apply(void 0, exponent), 10) : 0;
        return sign * (int + frac * Math.pow(10, -fracd)) * Math.pow(10, expsign * exp);
    };
    var LEFT_PARENTHESIS_TOKEN = {
        type: 2 /* LEFT_PARENTHESIS_TOKEN */
    };
    var RIGHT_PARENTHESIS_TOKEN = {
        type: 3 /* RIGHT_PARENTHESIS_TOKEN */
    };
    var COMMA_TOKEN = { type: 4 /* COMMA_TOKEN */ };
    var SUFFIX_MATCH_TOKEN = { type: 13 /* SUFFIX_MATCH_TOKEN */ };
    var PREFIX_MATCH_TOKEN = { type: 8 /* PREFIX_MATCH_TOKEN */ };
    var COLUMN_TOKEN = { type: 21 /* COLUMN_TOKEN */ };
    var DASH_MATCH_TOKEN = { type: 9 /* DASH_MATCH_TOKEN */ };
    var INCLUDE_MATCH_TOKEN = { type: 10 /* INCLUDE_MATCH_TOKEN */ };
    var LEFT_CURLY_BRACKET_TOKEN = {
        type: 11 /* LEFT_CURLY_BRACKET_TOKEN */
    };
    var RIGHT_CURLY_BRACKET_TOKEN = {
        type: 12 /* RIGHT_CURLY_BRACKET_TOKEN */
    };
    var SUBSTRING_MATCH_TOKEN = { type: 14 /* SUBSTRING_MATCH_TOKEN */ };
    var BAD_URL_TOKEN = { type: 23 /* BAD_URL_TOKEN */ };
    var BAD_STRING_TOKEN = { type: 1 /* BAD_STRING_TOKEN */ };
    var CDO_TOKEN = { type: 25 /* CDO_TOKEN */ };
    var CDC_TOKEN = { type: 24 /* CDC_TOKEN */ };
    var COLON_TOKEN = { type: 26 /* COLON_TOKEN */ };
    var SEMICOLON_TOKEN = { type: 27 /* SEMICOLON_TOKEN */ };
    var LEFT_SQUARE_BRACKET_TOKEN = {
        type: 28 /* LEFT_SQUARE_BRACKET_TOKEN */
    };
    var RIGHT_SQUARE_BRACKET_TOKEN = {
        type: 29 /* RIGHT_SQUARE_BRACKET_TOKEN */
    };
    var WHITESPACE_TOKEN = { type: 31 /* WHITESPACE_TOKEN */ };
    var EOF_TOKEN = { type: 32 /* EOF_TOKEN */ };
    var Tokenizer = /** @class */ (function () {
        function Tokenizer() {
            this._value = [];
        }
        Tokenizer.prototype.write = function (chunk) {
            this._value = this._value.concat(toCodePoints$1(chunk));
        };
        Tokenizer.prototype.read = function () {
            var tokens = [];
            var token = this.consumeToken();
            while (token !== EOF_TOKEN) {
                tokens.push(token);
                token = this.consumeToken();
            }
            return tokens;
        };
        Tokenizer.prototype.consumeToken = function () {
            var codePoint = this.consumeCodePoint();
            switch (codePoint) {
                case QUOTATION_MARK:
                    return this.consumeStringToken(QUOTATION_MARK);
                case NUMBER_SIGN:
                    var c1 = this.peekCodePoint(0);
                    var c2 = this.peekCodePoint(1);
                    var c3 = this.peekCodePoint(2);
                    if (isNameCodePoint(c1) || isValidEscape(c2, c3)) {
                        var flags = isIdentifierStart(c1, c2, c3) ? FLAG_ID : FLAG_UNRESTRICTED;
                        var value = this.consumeName();
                        return { type: 5 /* HASH_TOKEN */, value: value, flags: flags };
                    }
                    break;
                case DOLLAR_SIGN:
                    if (this.peekCodePoint(0) === EQUALS_SIGN) {
                        this.consumeCodePoint();
                        return SUFFIX_MATCH_TOKEN;
                    }
                    break;
                case APOSTROPHE:
                    return this.consumeStringToken(APOSTROPHE);
                case LEFT_PARENTHESIS:
                    return LEFT_PARENTHESIS_TOKEN;
                case RIGHT_PARENTHESIS:
                    return RIGHT_PARENTHESIS_TOKEN;
                case ASTERISK:
                    if (this.peekCodePoint(0) === EQUALS_SIGN) {
                        this.consumeCodePoint();
                        return SUBSTRING_MATCH_TOKEN;
                    }
                    break;
                case PLUS_SIGN:
                    if (isNumberStart(codePoint, this.peekCodePoint(0), this.peekCodePoint(1))) {
                        this.reconsumeCodePoint(codePoint);
                        return this.consumeNumericToken();
                    }
                    break;
                case COMMA:
                    return COMMA_TOKEN;
                case HYPHEN_MINUS:
                    var e1 = codePoint;
                    var e2 = this.peekCodePoint(0);
                    var e3 = this.peekCodePoint(1);
                    if (isNumberStart(e1, e2, e3)) {
                        this.reconsumeCodePoint(codePoint);
                        return this.consumeNumericToken();
                    }
                    if (isIdentifierStart(e1, e2, e3)) {
                        this.reconsumeCodePoint(codePoint);
                        return this.consumeIdentLikeToken();
                    }
                    if (e2 === HYPHEN_MINUS && e3 === GREATER_THAN_SIGN) {
                        this.consumeCodePoint();
                        this.consumeCodePoint();
                        return CDC_TOKEN;
                    }
                    break;
                case FULL_STOP:
                    if (isNumberStart(codePoint, this.peekCodePoint(0), this.peekCodePoint(1))) {
                        this.reconsumeCodePoint(codePoint);
                        return this.consumeNumericToken();
                    }
                    break;
                case SOLIDUS:
                    if (this.peekCodePoint(0) === ASTERISK) {
                        this.consumeCodePoint();
                        while (true) {
                            var c = this.consumeCodePoint();
                            if (c === ASTERISK) {
                                c = this.consumeCodePoint();
                                if (c === SOLIDUS) {
                                    return this.consumeToken();
                                }
                            }
                            if (c === EOF) {
                                return this.consumeToken();
                            }
                        }
                    }
                    break;
                case COLON:
                    return COLON_TOKEN;
                case SEMICOLON:
                    return SEMICOLON_TOKEN;
                case LESS_THAN_SIGN:
                    if (this.peekCodePoint(0) === EXCLAMATION_MARK &&
                        this.peekCodePoint(1) === HYPHEN_MINUS &&
                        this.peekCodePoint(2) === HYPHEN_MINUS) {
                        this.consumeCodePoint();
                        this.consumeCodePoint();
                        return CDO_TOKEN;
                    }
                    break;
                case COMMERCIAL_AT:
                    var a1 = this.peekCodePoint(0);
                    var a2 = this.peekCodePoint(1);
                    var a3 = this.peekCodePoint(2);
                    if (isIdentifierStart(a1, a2, a3)) {
                        var value = this.consumeName();
                        return { type: 7 /* AT_KEYWORD_TOKEN */, value: value };
                    }
                    break;
                case LEFT_SQUARE_BRACKET:
                    return LEFT_SQUARE_BRACKET_TOKEN;
                case REVERSE_SOLIDUS:
                    if (isValidEscape(codePoint, this.peekCodePoint(0))) {
                        this.reconsumeCodePoint(codePoint);
                        return this.consumeIdentLikeToken();
                    }
                    break;
                case RIGHT_SQUARE_BRACKET:
                    return RIGHT_SQUARE_BRACKET_TOKEN;
                case CIRCUMFLEX_ACCENT:
                    if (this.peekCodePoint(0) === EQUALS_SIGN) {
                        this.consumeCodePoint();
                        return PREFIX_MATCH_TOKEN;
                    }
                    break;
                case LEFT_CURLY_BRACKET:
                    return LEFT_CURLY_BRACKET_TOKEN;
                case RIGHT_CURLY_BRACKET:
                    return RIGHT_CURLY_BRACKET_TOKEN;
                case u:
                case U:
                    var u1 = this.peekCodePoint(0);
                    var u2 = this.peekCodePoint(1);
                    if (u1 === PLUS_SIGN && (isHex(u2) || u2 === QUESTION_MARK)) {
                        this.consumeCodePoint();
                        this.consumeUnicodeRangeToken();
                    }
                    this.reconsumeCodePoint(codePoint);
                    return this.consumeIdentLikeToken();
                case VERTICAL_LINE:
                    if (this.peekCodePoint(0) === EQUALS_SIGN) {
                        this.consumeCodePoint();
                        return DASH_MATCH_TOKEN;
                    }
                    if (this.peekCodePoint(0) === VERTICAL_LINE) {
                        this.consumeCodePoint();
                        return COLUMN_TOKEN;
                    }
                    break;
                case TILDE:
                    if (this.peekCodePoint(0) === EQUALS_SIGN) {
                        this.consumeCodePoint();
                        return INCLUDE_MATCH_TOKEN;
                    }
                    break;
                case EOF:
                    return EOF_TOKEN;
            }
            if (isWhiteSpace(codePoint)) {
                this.consumeWhiteSpace();
                return WHITESPACE_TOKEN;
            }
            if (isDigit(codePoint)) {
                this.reconsumeCodePoint(codePoint);
                return this.consumeNumericToken();
            }
            if (isNameStartCodePoint(codePoint)) {
                this.reconsumeCodePoint(codePoint);
                return this.consumeIdentLikeToken();
            }
            return { type: 6 /* DELIM_TOKEN */, value: fromCodePoint$1(codePoint) };
        };
        Tokenizer.prototype.consumeCodePoint = function () {
            var value = this._value.shift();
            return typeof value === 'undefined' ? -1 : value;
        };
        Tokenizer.prototype.reconsumeCodePoint = function (codePoint) {
            this._value.unshift(codePoint);
        };
        Tokenizer.prototype.peekCodePoint = function (delta) {
            if (delta >= this._value.length) {
                return -1;
            }
            return this._value[delta];
        };
        Tokenizer.prototype.consumeUnicodeRangeToken = function () {
            var digits = [];
            var codePoint = this.consumeCodePoint();
            while (isHex(codePoint) && digits.length < 6) {
                digits.push(codePoint);
                codePoint = this.consumeCodePoint();
            }
            var questionMarks = false;
            while (codePoint === QUESTION_MARK && digits.length < 6) {
                digits.push(codePoint);
                codePoint = this.consumeCodePoint();
                questionMarks = true;
            }
            if (questionMarks) {
                var start_1 = parseInt(fromCodePoint$1.apply(void 0, digits.map(function (digit) { return (digit === QUESTION_MARK ? ZERO : digit); })), 16);
                var end = parseInt(fromCodePoint$1.apply(void 0, digits.map(function (digit) { return (digit === QUESTION_MARK ? F : digit); })), 16);
                return { type: 30 /* UNICODE_RANGE_TOKEN */, start: start_1, end: end };
            }
            var start = parseInt(fromCodePoint$1.apply(void 0, digits), 16);
            if (this.peekCodePoint(0) === HYPHEN_MINUS && isHex(this.peekCodePoint(1))) {
                this.consumeCodePoint();
                codePoint = this.consumeCodePoint();
                var endDigits = [];
                while (isHex(codePoint) && endDigits.length < 6) {
                    endDigits.push(codePoint);
                    codePoint = this.consumeCodePoint();
                }
                var end = parseInt(fromCodePoint$1.apply(void 0, endDigits), 16);
                return { type: 30 /* UNICODE_RANGE_TOKEN */, start: start, end: end };
            }
            else {
                return { type: 30 /* UNICODE_RANGE_TOKEN */, start: start, end: start };
            }
        };
        Tokenizer.prototype.consumeIdentLikeToken = function () {
            var value = this.consumeName();
            if (value.toLowerCase() === 'url' && this.peekCodePoint(0) === LEFT_PARENTHESIS) {
                this.consumeCodePoint();
                return this.consumeUrlToken();
            }
            else if (this.peekCodePoint(0) === LEFT_PARENTHESIS) {
                this.consumeCodePoint();
                return { type: 19 /* FUNCTION_TOKEN */, value: value };
            }
            return { type: 20 /* IDENT_TOKEN */, value: value };
        };
        Tokenizer.prototype.consumeUrlToken = function () {
            var value = [];
            this.consumeWhiteSpace();
            if (this.peekCodePoint(0) === EOF) {
                return { type: 22 /* URL_TOKEN */, value: '' };
            }
            var next = this.peekCodePoint(0);
            if (next === APOSTROPHE || next === QUOTATION_MARK) {
                var stringToken = this.consumeStringToken(this.consumeCodePoint());
                if (stringToken.type === 0 /* STRING_TOKEN */) {
                    this.consumeWhiteSpace();
                    if (this.peekCodePoint(0) === EOF || this.peekCodePoint(0) === RIGHT_PARENTHESIS) {
                        this.consumeCodePoint();
                        return { type: 22 /* URL_TOKEN */, value: stringToken.value };
                    }
                }
                this.consumeBadUrlRemnants();
                return BAD_URL_TOKEN;
            }
            while (true) {
                var codePoint = this.consumeCodePoint();
                if (codePoint === EOF || codePoint === RIGHT_PARENTHESIS) {
                    return { type: 22 /* URL_TOKEN */, value: fromCodePoint$1.apply(void 0, value) };
                }
                else if (isWhiteSpace(codePoint)) {
                    this.consumeWhiteSpace();
                    if (this.peekCodePoint(0) === EOF || this.peekCodePoint(0) === RIGHT_PARENTHESIS) {
                        this.consumeCodePoint();
                        return { type: 22 /* URL_TOKEN */, value: fromCodePoint$1.apply(void 0, value) };
                    }
                    this.consumeBadUrlRemnants();
                    return BAD_URL_TOKEN;
                }
                else if (codePoint === QUOTATION_MARK ||
                    codePoint === APOSTROPHE ||
                    codePoint === LEFT_PARENTHESIS ||
                    isNonPrintableCodePoint(codePoint)) {
                    this.consumeBadUrlRemnants();
                    return BAD_URL_TOKEN;
                }
                else if (codePoint === REVERSE_SOLIDUS) {
                    if (isValidEscape(codePoint, this.peekCodePoint(0))) {
                        value.push(this.consumeEscapedCodePoint());
                    }
                    else {
                        this.consumeBadUrlRemnants();
                        return BAD_URL_TOKEN;
                    }
                }
                else {
                    value.push(codePoint);
                }
            }
        };
        Tokenizer.prototype.consumeWhiteSpace = function () {
            while (isWhiteSpace(this.peekCodePoint(0))) {
                this.consumeCodePoint();
            }
        };
        Tokenizer.prototype.consumeBadUrlRemnants = function () {
            while (true) {
                var codePoint = this.consumeCodePoint();
                if (codePoint === RIGHT_PARENTHESIS || codePoint === EOF) {
                    return;
                }
                if (isValidEscape(codePoint, this.peekCodePoint(0))) {
                    this.consumeEscapedCodePoint();
                }
            }
        };
        Tokenizer.prototype.consumeStringSlice = function (count) {
            var SLICE_STACK_SIZE = 60000;
            var value = '';
            while (count > 0) {
                var amount = Math.min(SLICE_STACK_SIZE, count);
                value += fromCodePoint$1.apply(void 0, this._value.splice(0, amount));
                count -= amount;
            }
            this._value.shift();
            return value;
        };
        Tokenizer.prototype.consumeStringToken = function (endingCodePoint) {
            var value = '';
            var i = 0;
            do {
                var codePoint = this._value[i];
                if (codePoint === EOF || codePoint === undefined || codePoint === endingCodePoint) {
                    value += this.consumeStringSlice(i);
                    return { type: 0 /* STRING_TOKEN */, value: value };
                }
                if (codePoint === LINE_FEED) {
                    this._value.splice(0, i);
                    return BAD_STRING_TOKEN;
                }
                if (codePoint === REVERSE_SOLIDUS) {
                    var next = this._value[i + 1];
                    if (next !== EOF && next !== undefined) {
                        if (next === LINE_FEED) {
                            value += this.consumeStringSlice(i);
                            i = -1;
                            this._value.shift();
                        }
                        else if (isValidEscape(codePoint, next)) {
                            value += this.consumeStringSlice(i);
                            value += fromCodePoint$1(this.consumeEscapedCodePoint());
                            i = -1;
                        }
                    }
                }
                i++;
            } while (true);
        };
        Tokenizer.prototype.consumeNumber = function () {
            var repr = [];
            var type = FLAG_INTEGER;
            var c1 = this.peekCodePoint(0);
            if (c1 === PLUS_SIGN || c1 === HYPHEN_MINUS) {
                repr.push(this.consumeCodePoint());
            }
            while (isDigit(this.peekCodePoint(0))) {
                repr.push(this.consumeCodePoint());
            }
            c1 = this.peekCodePoint(0);
            var c2 = this.peekCodePoint(1);
            if (c1 === FULL_STOP && isDigit(c2)) {
                repr.push(this.consumeCodePoint(), this.consumeCodePoint());
                type = FLAG_NUMBER;
                while (isDigit(this.peekCodePoint(0))) {
                    repr.push(this.consumeCodePoint());
                }
            }
            c1 = this.peekCodePoint(0);
            c2 = this.peekCodePoint(1);
            var c3 = this.peekCodePoint(2);
            if ((c1 === E || c1 === e) && (((c2 === PLUS_SIGN || c2 === HYPHEN_MINUS) && isDigit(c3)) || isDigit(c2))) {
                repr.push(this.consumeCodePoint(), this.consumeCodePoint());
                type = FLAG_NUMBER;
                while (isDigit(this.peekCodePoint(0))) {
                    repr.push(this.consumeCodePoint());
                }
            }
            return [stringToNumber(repr), type];
        };
        Tokenizer.prototype.consumeNumericToken = function () {
            var _a = this.consumeNumber(), number = _a[0], flags = _a[1];
            var c1 = this.peekCodePoint(0);
            var c2 = this.peekCodePoint(1);
            var c3 = this.peekCodePoint(2);
            if (isIdentifierStart(c1, c2, c3)) {
                var unit = this.consumeName();
                return { type: 15 /* DIMENSION_TOKEN */, number: number, flags: flags, unit: unit };
            }
            if (c1 === PERCENTAGE_SIGN) {
                this.consumeCodePoint();
                return { type: 16 /* PERCENTAGE_TOKEN */, number: number, flags: flags };
            }
            return { type: 17 /* NUMBER_TOKEN */, number: number, flags: flags };
        };
        Tokenizer.prototype.consumeEscapedCodePoint = function () {
            var codePoint = this.consumeCodePoint();
            if (isHex(codePoint)) {
                var hex = fromCodePoint$1(codePoint);
                while (isHex(this.peekCodePoint(0)) && hex.length < 6) {
                    hex += fromCodePoint$1(this.consumeCodePoint());
                }
                if (isWhiteSpace(this.peekCodePoint(0))) {
                    this.consumeCodePoint();
                }
                var hexCodePoint = parseInt(hex, 16);
                if (hexCodePoint === 0 || isSurrogateCodePoint(hexCodePoint) || hexCodePoint > 0x10ffff) {
                    return REPLACEMENT_CHARACTER;
                }
                return hexCodePoint;
            }
            if (codePoint === EOF) {
                return REPLACEMENT_CHARACTER;
            }
            return codePoint;
        };
        Tokenizer.prototype.consumeName = function () {
            var result = '';
            while (true) {
                var codePoint = this.consumeCodePoint();
                if (isNameCodePoint(codePoint)) {
                    result += fromCodePoint$1(codePoint);
                }
                else if (isValidEscape(codePoint, this.peekCodePoint(0))) {
                    result += fromCodePoint$1(this.consumeEscapedCodePoint());
                }
                else {
                    this.reconsumeCodePoint(codePoint);
                    return result;
                }
            }
        };
        return Tokenizer;
    }());

    var Parser = /** @class */ (function () {
        function Parser(tokens) {
            this._tokens = tokens;
        }
        Parser.create = function (value) {
            var tokenizer = new Tokenizer();
            tokenizer.write(value);
            return new Parser(tokenizer.read());
        };
        Parser.parseValue = function (value) {
            return Parser.create(value).parseComponentValue();
        };
        Parser.parseValues = function (value) {
            return Parser.create(value).parseComponentValues();
        };
        Parser.prototype.parseComponentValue = function () {
            var token = this.consumeToken();
            while (token.type === 31 /* WHITESPACE_TOKEN */) {
                token = this.consumeToken();
            }
            if (token.type === 32 /* EOF_TOKEN */) {
                throw new SyntaxError("Error parsing CSS component value, unexpected EOF");
            }
            this.reconsumeToken(token);
            var value = this.consumeComponentValue();
            do {
                token = this.consumeToken();
            } while (token.type === 31 /* WHITESPACE_TOKEN */);
            if (token.type === 32 /* EOF_TOKEN */) {
                return value;
            }
            throw new SyntaxError("Error parsing CSS component value, multiple values found when expecting only one");
        };
        Parser.prototype.parseComponentValues = function () {
            var values = [];
            while (true) {
                var value = this.consumeComponentValue();
                if (value.type === 32 /* EOF_TOKEN */) {
                    return values;
                }
                values.push(value);
                values.push();
            }
        };
        Parser.prototype.consumeComponentValue = function () {
            var token = this.consumeToken();
            switch (token.type) {
                case 11 /* LEFT_CURLY_BRACKET_TOKEN */:
                case 28 /* LEFT_SQUARE_BRACKET_TOKEN */:
                case 2 /* LEFT_PARENTHESIS_TOKEN */:
                    return this.consumeSimpleBlock(token.type);
                case 19 /* FUNCTION_TOKEN */:
                    return this.consumeFunction(token);
            }
            return token;
        };
        Parser.prototype.consumeSimpleBlock = function (type) {
            var block = { type: type, values: [] };
            var token = this.consumeToken();
            while (true) {
                if (token.type === 32 /* EOF_TOKEN */ || isEndingTokenFor(token, type)) {
                    return block;
                }
                this.reconsumeToken(token);
                block.values.push(this.consumeComponentValue());
                token = this.consumeToken();
            }
        };
        Parser.prototype.consumeFunction = function (functionToken) {
            var cssFunction = {
                name: functionToken.value,
                values: [],
                type: 18 /* FUNCTION */
            };
            while (true) {
                var token = this.consumeToken();
                if (token.type === 32 /* EOF_TOKEN */ || token.type === 3 /* RIGHT_PARENTHESIS_TOKEN */) {
                    return cssFunction;
                }
                this.reconsumeToken(token);
                cssFunction.values.push(this.consumeComponentValue());
            }
        };
        Parser.prototype.consumeToken = function () {
            var token = this._tokens.shift();
            return typeof token === 'undefined' ? EOF_TOKEN : token;
        };
        Parser.prototype.reconsumeToken = function (token) {
            this._tokens.unshift(token);
        };
        return Parser;
    }());
    var isDimensionToken = function (token) { return token.type === 15 /* DIMENSION_TOKEN */; };
    var isNumberToken = function (token) { return token.type === 17 /* NUMBER_TOKEN */; };
    var isIdentToken = function (token) { return token.type === 20 /* IDENT_TOKEN */; };
    var isStringToken = function (token) { return token.type === 0 /* STRING_TOKEN */; };
    var isIdentWithValue = function (token, value) {
        return isIdentToken(token) && token.value === value;
    };
    var nonWhiteSpace = function (token) { return token.type !== 31 /* WHITESPACE_TOKEN */; };
    var nonFunctionArgSeparator = function (token) {
        return token.type !== 31 /* WHITESPACE_TOKEN */ && token.type !== 4 /* COMMA_TOKEN */;
    };
    var parseFunctionArgs = function (tokens) {
        var args = [];
        var arg = [];
        tokens.forEach(function (token) {
            if (token.type === 4 /* COMMA_TOKEN */) {
                if (arg.length === 0) {
                    throw new Error("Error parsing function args, zero tokens for arg");
                }
                args.push(arg);
                arg = [];
                return;
            }
            if (token.type !== 31 /* WHITESPACE_TOKEN */) {
                arg.push(token);
            }
        });
        if (arg.length) {
            args.push(arg);
        }
        return args;
    };
    var isEndingTokenFor = function (token, type) {
        if (type === 11 /* LEFT_CURLY_BRACKET_TOKEN */ && token.type === 12 /* RIGHT_CURLY_BRACKET_TOKEN */) {
            return true;
        }
        if (type === 28 /* LEFT_SQUARE_BRACKET_TOKEN */ && token.type === 29 /* RIGHT_SQUARE_BRACKET_TOKEN */) {
            return true;
        }
        return type === 2 /* LEFT_PARENTHESIS_TOKEN */ && token.type === 3 /* RIGHT_PARENTHESIS_TOKEN */;
    };

    var isLength = function (token) {
        return token.type === 17 /* NUMBER_TOKEN */ || token.type === 15 /* DIMENSION_TOKEN */;
    };

    var isLengthPercentage = function (token) {
        return token.type === 16 /* PERCENTAGE_TOKEN */ || isLength(token);
    };
    var parseLengthPercentageTuple = function (tokens) {
        return tokens.length > 1 ? [tokens[0], tokens[1]] : [tokens[0]];
    };
    var ZERO_LENGTH = {
        type: 17 /* NUMBER_TOKEN */,
        number: 0,
        flags: FLAG_INTEGER
    };
    var FIFTY_PERCENT = {
        type: 16 /* PERCENTAGE_TOKEN */,
        number: 50,
        flags: FLAG_INTEGER
    };
    var HUNDRED_PERCENT = {
        type: 16 /* PERCENTAGE_TOKEN */,
        number: 100,
        flags: FLAG_INTEGER
    };
    var getAbsoluteValueForTuple = function (tuple, width, height) {
        var x = tuple[0], y = tuple[1];
        return [getAbsoluteValue(x, width), getAbsoluteValue(typeof y !== 'undefined' ? y : x, height)];
    };
    var getAbsoluteValue = function (token, parent) {
        if (token.type === 16 /* PERCENTAGE_TOKEN */) {
            return (token.number / 100) * parent;
        }
        if (isDimensionToken(token)) {
            switch (token.unit) {
                case 'rem':
                case 'em':
                    return 16 * token.number; // TODO use correct font-size
                case 'px':
                default:
                    return token.number;
            }
        }
        return token.number;
    };

    var DEG = 'deg';
    var GRAD = 'grad';
    var RAD = 'rad';
    var TURN = 'turn';
    var angle = {
        name: 'angle',
        parse: function (_context, value) {
            if (value.type === 15 /* DIMENSION_TOKEN */) {
                switch (value.unit) {
                    case DEG:
                        return (Math.PI * value.number) / 180;
                    case GRAD:
                        return (Math.PI / 200) * value.number;
                    case RAD:
                        return value.number;
                    case TURN:
                        return Math.PI * 2 * value.number;
                }
            }
            throw new Error("Unsupported angle type");
        }
    };
    var isAngle = function (value) {
        if (value.type === 15 /* DIMENSION_TOKEN */) {
            if (value.unit === DEG || value.unit === GRAD || value.unit === RAD || value.unit === TURN) {
                return true;
            }
        }
        return false;
    };
    var parseNamedSide = function (tokens) {
        var sideOrCorner = tokens
            .filter(isIdentToken)
            .map(function (ident) { return ident.value; })
            .join(' ');
        switch (sideOrCorner) {
            case 'to bottom right':
            case 'to right bottom':
            case 'left top':
            case 'top left':
                return [ZERO_LENGTH, ZERO_LENGTH];
            case 'to top':
            case 'bottom':
                return deg(0);
            case 'to bottom left':
            case 'to left bottom':
            case 'right top':
            case 'top right':
                return [ZERO_LENGTH, HUNDRED_PERCENT];
            case 'to right':
            case 'left':
                return deg(90);
            case 'to top left':
            case 'to left top':
            case 'right bottom':
            case 'bottom right':
                return [HUNDRED_PERCENT, HUNDRED_PERCENT];
            case 'to bottom':
            case 'top':
                return deg(180);
            case 'to top right':
            case 'to right top':
            case 'left bottom':
            case 'bottom left':
                return [HUNDRED_PERCENT, ZERO_LENGTH];
            case 'to left':
            case 'right':
                return deg(270);
        }
        return 0;
    };
    var deg = function (deg) { return (Math.PI * deg) / 180; };

    var color$1 = {
        name: 'color',
        parse: function (context, value) {
            if (value.type === 18 /* FUNCTION */) {
                var colorFunction = SUPPORTED_COLOR_FUNCTIONS[value.name];
                if (typeof colorFunction === 'undefined') {
                    throw new Error("Attempting to parse an unsupported color function \"" + value.name + "\"");
                }
                return colorFunction(context, value.values);
            }
            if (value.type === 5 /* HASH_TOKEN */) {
                if (value.value.length === 3) {
                    var r = value.value.substring(0, 1);
                    var g = value.value.substring(1, 2);
                    var b = value.value.substring(2, 3);
                    return pack(parseInt(r + r, 16), parseInt(g + g, 16), parseInt(b + b, 16), 1);
                }
                if (value.value.length === 4) {
                    var r = value.value.substring(0, 1);
                    var g = value.value.substring(1, 2);
                    var b = value.value.substring(2, 3);
                    var a = value.value.substring(3, 4);
                    return pack(parseInt(r + r, 16), parseInt(g + g, 16), parseInt(b + b, 16), parseInt(a + a, 16) / 255);
                }
                if (value.value.length === 6) {
                    var r = value.value.substring(0, 2);
                    var g = value.value.substring(2, 4);
                    var b = value.value.substring(4, 6);
                    return pack(parseInt(r, 16), parseInt(g, 16), parseInt(b, 16), 1);
                }
                if (value.value.length === 8) {
                    var r = value.value.substring(0, 2);
                    var g = value.value.substring(2, 4);
                    var b = value.value.substring(4, 6);
                    var a = value.value.substring(6, 8);
                    return pack(parseInt(r, 16), parseInt(g, 16), parseInt(b, 16), parseInt(a, 16) / 255);
                }
            }
            if (value.type === 20 /* IDENT_TOKEN */) {
                var namedColor = COLORS[value.value.toUpperCase()];
                if (typeof namedColor !== 'undefined') {
                    return namedColor;
                }
            }
            return COLORS.TRANSPARENT;
        }
    };
    var isTransparent = function (color) { return (0xff & color) === 0; };
    var asString = function (color) {
        var alpha = 0xff & color;
        var blue = 0xff & (color >> 8);
        var green = 0xff & (color >> 16);
        var red = 0xff & (color >> 24);
        return alpha < 255 ? "rgba(" + red + "," + green + "," + blue + "," + alpha / 255 + ")" : "rgb(" + red + "," + green + "," + blue + ")";
    };
    var pack = function (r, g, b, a) {
        return ((r << 24) | (g << 16) | (b << 8) | (Math.round(a * 255) << 0)) >>> 0;
    };
    var getTokenColorValue = function (token, i) {
        if (token.type === 17 /* NUMBER_TOKEN */) {
            return token.number;
        }
        if (token.type === 16 /* PERCENTAGE_TOKEN */) {
            var max = i === 3 ? 1 : 255;
            return i === 3 ? (token.number / 100) * max : Math.round((token.number / 100) * max);
        }
        return 0;
    };
    var rgb = function (_context, args) {
        var tokens = args.filter(nonFunctionArgSeparator);
        if (tokens.length === 3) {
            var _a = tokens.map(getTokenColorValue), r = _a[0], g = _a[1], b = _a[2];
            return pack(r, g, b, 1);
        }
        if (tokens.length === 4) {
            var _b = tokens.map(getTokenColorValue), r = _b[0], g = _b[1], b = _b[2], a = _b[3];
            return pack(r, g, b, a);
        }
        return 0;
    };
    function hue2rgb(t1, t2, hue) {
        if (hue < 0) {
            hue += 1;
        }
        if (hue >= 1) {
            hue -= 1;
        }
        if (hue < 1 / 6) {
            return (t2 - t1) * hue * 6 + t1;
        }
        else if (hue < 1 / 2) {
            return t2;
        }
        else if (hue < 2 / 3) {
            return (t2 - t1) * 6 * (2 / 3 - hue) + t1;
        }
        else {
            return t1;
        }
    }
    var hsl = function (context, args) {
        var tokens = args.filter(nonFunctionArgSeparator);
        var hue = tokens[0], saturation = tokens[1], lightness = tokens[2], alpha = tokens[3];
        var h = (hue.type === 17 /* NUMBER_TOKEN */ ? deg(hue.number) : angle.parse(context, hue)) / (Math.PI * 2);
        var s = isLengthPercentage(saturation) ? saturation.number / 100 : 0;
        var l = isLengthPercentage(lightness) ? lightness.number / 100 : 0;
        var a = typeof alpha !== 'undefined' && isLengthPercentage(alpha) ? getAbsoluteValue(alpha, 1) : 1;
        if (s === 0) {
            return pack(l * 255, l * 255, l * 255, 1);
        }
        var t2 = l <= 0.5 ? l * (s + 1) : l + s - l * s;
        var t1 = l * 2 - t2;
        var r = hue2rgb(t1, t2, h + 1 / 3);
        var g = hue2rgb(t1, t2, h);
        var b = hue2rgb(t1, t2, h - 1 / 3);
        return pack(r * 255, g * 255, b * 255, a);
    };
    var SUPPORTED_COLOR_FUNCTIONS = {
        hsl: hsl,
        hsla: hsl,
        rgb: rgb,
        rgba: rgb
    };
    var parseColor = function (context, value) {
        return color$1.parse(context, Parser.create(value).parseComponentValue());
    };
    var COLORS = {
        ALICEBLUE: 0xf0f8ffff,
        ANTIQUEWHITE: 0xfaebd7ff,
        AQUA: 0x00ffffff,
        AQUAMARINE: 0x7fffd4ff,
        AZURE: 0xf0ffffff,
        BEIGE: 0xf5f5dcff,
        BISQUE: 0xffe4c4ff,
        BLACK: 0x000000ff,
        BLANCHEDALMOND: 0xffebcdff,
        BLUE: 0x0000ffff,
        BLUEVIOLET: 0x8a2be2ff,
        BROWN: 0xa52a2aff,
        BURLYWOOD: 0xdeb887ff,
        CADETBLUE: 0x5f9ea0ff,
        CHARTREUSE: 0x7fff00ff,
        CHOCOLATE: 0xd2691eff,
        CORAL: 0xff7f50ff,
        CORNFLOWERBLUE: 0x6495edff,
        CORNSILK: 0xfff8dcff,
        CRIMSON: 0xdc143cff,
        CYAN: 0x00ffffff,
        DARKBLUE: 0x00008bff,
        DARKCYAN: 0x008b8bff,
        DARKGOLDENROD: 0xb886bbff,
        DARKGRAY: 0xa9a9a9ff,
        DARKGREEN: 0x006400ff,
        DARKGREY: 0xa9a9a9ff,
        DARKKHAKI: 0xbdb76bff,
        DARKMAGENTA: 0x8b008bff,
        DARKOLIVEGREEN: 0x556b2fff,
        DARKORANGE: 0xff8c00ff,
        DARKORCHID: 0x9932ccff,
        DARKRED: 0x8b0000ff,
        DARKSALMON: 0xe9967aff,
        DARKSEAGREEN: 0x8fbc8fff,
        DARKSLATEBLUE: 0x483d8bff,
        DARKSLATEGRAY: 0x2f4f4fff,
        DARKSLATEGREY: 0x2f4f4fff,
        DARKTURQUOISE: 0x00ced1ff,
        DARKVIOLET: 0x9400d3ff,
        DEEPPINK: 0xff1493ff,
        DEEPSKYBLUE: 0x00bfffff,
        DIMGRAY: 0x696969ff,
        DIMGREY: 0x696969ff,
        DODGERBLUE: 0x1e90ffff,
        FIREBRICK: 0xb22222ff,
        FLORALWHITE: 0xfffaf0ff,
        FORESTGREEN: 0x228b22ff,
        FUCHSIA: 0xff00ffff,
        GAINSBORO: 0xdcdcdcff,
        GHOSTWHITE: 0xf8f8ffff,
        GOLD: 0xffd700ff,
        GOLDENROD: 0xdaa520ff,
        GRAY: 0x808080ff,
        GREEN: 0x008000ff,
        GREENYELLOW: 0xadff2fff,
        GREY: 0x808080ff,
        HONEYDEW: 0xf0fff0ff,
        HOTPINK: 0xff69b4ff,
        INDIANRED: 0xcd5c5cff,
        INDIGO: 0x4b0082ff,
        IVORY: 0xfffff0ff,
        KHAKI: 0xf0e68cff,
        LAVENDER: 0xe6e6faff,
        LAVENDERBLUSH: 0xfff0f5ff,
        LAWNGREEN: 0x7cfc00ff,
        LEMONCHIFFON: 0xfffacdff,
        LIGHTBLUE: 0xadd8e6ff,
        LIGHTCORAL: 0xf08080ff,
        LIGHTCYAN: 0xe0ffffff,
        LIGHTGOLDENRODYELLOW: 0xfafad2ff,
        LIGHTGRAY: 0xd3d3d3ff,
        LIGHTGREEN: 0x90ee90ff,
        LIGHTGREY: 0xd3d3d3ff,
        LIGHTPINK: 0xffb6c1ff,
        LIGHTSALMON: 0xffa07aff,
        LIGHTSEAGREEN: 0x20b2aaff,
        LIGHTSKYBLUE: 0x87cefaff,
        LIGHTSLATEGRAY: 0x778899ff,
        LIGHTSLATEGREY: 0x778899ff,
        LIGHTSTEELBLUE: 0xb0c4deff,
        LIGHTYELLOW: 0xffffe0ff,
        LIME: 0x00ff00ff,
        LIMEGREEN: 0x32cd32ff,
        LINEN: 0xfaf0e6ff,
        MAGENTA: 0xff00ffff,
        MAROON: 0x800000ff,
        MEDIUMAQUAMARINE: 0x66cdaaff,
        MEDIUMBLUE: 0x0000cdff,
        MEDIUMORCHID: 0xba55d3ff,
        MEDIUMPURPLE: 0x9370dbff,
        MEDIUMSEAGREEN: 0x3cb371ff,
        MEDIUMSLATEBLUE: 0x7b68eeff,
        MEDIUMSPRINGGREEN: 0x00fa9aff,
        MEDIUMTURQUOISE: 0x48d1ccff,
        MEDIUMVIOLETRED: 0xc71585ff,
        MIDNIGHTBLUE: 0x191970ff,
        MINTCREAM: 0xf5fffaff,
        MISTYROSE: 0xffe4e1ff,
        MOCCASIN: 0xffe4b5ff,
        NAVAJOWHITE: 0xffdeadff,
        NAVY: 0x000080ff,
        OLDLACE: 0xfdf5e6ff,
        OLIVE: 0x808000ff,
        OLIVEDRAB: 0x6b8e23ff,
        ORANGE: 0xffa500ff,
        ORANGERED: 0xff4500ff,
        ORCHID: 0xda70d6ff,
        PALEGOLDENROD: 0xeee8aaff,
        PALEGREEN: 0x98fb98ff,
        PALETURQUOISE: 0xafeeeeff,
        PALEVIOLETRED: 0xdb7093ff,
        PAPAYAWHIP: 0xffefd5ff,
        PEACHPUFF: 0xffdab9ff,
        PERU: 0xcd853fff,
        PINK: 0xffc0cbff,
        PLUM: 0xdda0ddff,
        POWDERBLUE: 0xb0e0e6ff,
        PURPLE: 0x800080ff,
        REBECCAPURPLE: 0x663399ff,
        RED: 0xff0000ff,
        ROSYBROWN: 0xbc8f8fff,
        ROYALBLUE: 0x4169e1ff,
        SADDLEBROWN: 0x8b4513ff,
        SALMON: 0xfa8072ff,
        SANDYBROWN: 0xf4a460ff,
        SEAGREEN: 0x2e8b57ff,
        SEASHELL: 0xfff5eeff,
        SIENNA: 0xa0522dff,
        SILVER: 0xc0c0c0ff,
        SKYBLUE: 0x87ceebff,
        SLATEBLUE: 0x6a5acdff,
        SLATEGRAY: 0x708090ff,
        SLATEGREY: 0x708090ff,
        SNOW: 0xfffafaff,
        SPRINGGREEN: 0x00ff7fff,
        STEELBLUE: 0x4682b4ff,
        TAN: 0xd2b48cff,
        TEAL: 0x008080ff,
        THISTLE: 0xd8bfd8ff,
        TOMATO: 0xff6347ff,
        TRANSPARENT: 0x00000000,
        TURQUOISE: 0x40e0d0ff,
        VIOLET: 0xee82eeff,
        WHEAT: 0xf5deb3ff,
        WHITE: 0xffffffff,
        WHITESMOKE: 0xf5f5f5ff,
        YELLOW: 0xffff00ff,
        YELLOWGREEN: 0x9acd32ff
    };

    var BACKGROUND_CLIP;
    (function (BACKGROUND_CLIP) {
        BACKGROUND_CLIP[BACKGROUND_CLIP["BORDER_BOX"] = 0] = "BORDER_BOX";
        BACKGROUND_CLIP[BACKGROUND_CLIP["PADDING_BOX"] = 1] = "PADDING_BOX";
        BACKGROUND_CLIP[BACKGROUND_CLIP["CONTENT_BOX"] = 2] = "CONTENT_BOX";
    })(BACKGROUND_CLIP || (BACKGROUND_CLIP = {}));
    var backgroundClip = {
        name: 'background-clip',
        initialValue: 'border-box',
        prefix: false,
        type: 1 /* LIST */,
        parse: function (_context, tokens) {
            return tokens.map(function (token) {
                if (isIdentToken(token)) {
                    switch (token.value) {
                        case 'padding-box':
                            return BACKGROUND_CLIP.PADDING_BOX;
                        case 'content-box':
                            return BACKGROUND_CLIP.CONTENT_BOX;
                    }
                }
                return BACKGROUND_CLIP.BORDER_BOX;
            });
        }
    };

    var backgroundColor = {
        name: "background-color",
        initialValue: 'transparent',
        prefix: false,
        type: 3 /* TYPE_VALUE */,
        format: 'color'
    };

    var parseColorStop = function (context, args) {
        var color = color$1.parse(context, args[0]);
        var stop = args[1];
        return stop && isLengthPercentage(stop) ? { color: color, stop: stop } : { color: color, stop: null };
    };
    var processColorStops = function (stops, lineLength) {
        var first = stops[0];
        var last = stops[stops.length - 1];
        if (first.stop === null) {
            first.stop = ZERO_LENGTH;
        }
        if (last.stop === null) {
            last.stop = HUNDRED_PERCENT;
        }
        var processStops = [];
        var previous = 0;
        for (var i = 0; i < stops.length; i++) {
            var stop_1 = stops[i].stop;
            if (stop_1 !== null) {
                var absoluteValue = getAbsoluteValue(stop_1, lineLength);
                if (absoluteValue > previous) {
                    processStops.push(absoluteValue);
                }
                else {
                    processStops.push(previous);
                }
                previous = absoluteValue;
            }
            else {
                processStops.push(null);
            }
        }
        var gapBegin = null;
        for (var i = 0; i < processStops.length; i++) {
            var stop_2 = processStops[i];
            if (stop_2 === null) {
                if (gapBegin === null) {
                    gapBegin = i;
                }
            }
            else if (gapBegin !== null) {
                var gapLength = i - gapBegin;
                var beforeGap = processStops[gapBegin - 1];
                var gapValue = (stop_2 - beforeGap) / (gapLength + 1);
                for (var g = 1; g <= gapLength; g++) {
                    processStops[gapBegin + g - 1] = gapValue * g;
                }
                gapBegin = null;
            }
        }
        return stops.map(function (_a, i) {
            var color = _a.color;
            return { color: color, stop: Math.max(Math.min(1, processStops[i] / lineLength), 0) };
        });
    };
    var getAngleFromCorner = function (corner, width, height) {
        var centerX = width / 2;
        var centerY = height / 2;
        var x = getAbsoluteValue(corner[0], width) - centerX;
        var y = centerY - getAbsoluteValue(corner[1], height);
        return (Math.atan2(y, x) + Math.PI * 2) % (Math.PI * 2);
    };
    var calculateGradientDirection = function (angle, width, height) {
        var radian = typeof angle === 'number' ? angle : getAngleFromCorner(angle, width, height);
        var lineLength = Math.abs(width * Math.sin(radian)) + Math.abs(height * Math.cos(radian));
        var halfWidth = width / 2;
        var halfHeight = height / 2;
        var halfLineLength = lineLength / 2;
        var yDiff = Math.sin(radian - Math.PI / 2) * halfLineLength;
        var xDiff = Math.cos(radian - Math.PI / 2) * halfLineLength;
        return [lineLength, halfWidth - xDiff, halfWidth + xDiff, halfHeight - yDiff, halfHeight + yDiff];
    };
    var distance = function (a, b) { return Math.sqrt(a * a + b * b); };
    var findCorner = function (width, height, x, y, closest) {
        var corners = [
            [0, 0],
            [0, height],
            [width, 0],
            [width, height]
        ];
        return corners.reduce(function (stat, corner) {
            var cx = corner[0], cy = corner[1];
            var d = distance(x - cx, y - cy);
            if (closest ? d < stat.optimumDistance : d > stat.optimumDistance) {
                return {
                    optimumCorner: corner,
                    optimumDistance: d
                };
            }
            return stat;
        }, {
            optimumDistance: closest ? Infinity : -Infinity,
            optimumCorner: null
        }).optimumCorner;
    };
    var calculateRadius = function (gradient, x, y, width, height) {
        var rx = 0;
        var ry = 0;
        switch (gradient.size) {
            case CSSRadialExtent.CLOSEST_SIDE:
                // The ending shape is sized so that that it exactly meets the side of the gradient box closest to the gradient’s center.
                // If the shape is an ellipse, it exactly meets the closest side in each dimension.
                if (gradient.shape === CSSRadialShape.CIRCLE) {
                    rx = ry = Math.min(Math.abs(x), Math.abs(x - width), Math.abs(y), Math.abs(y - height));
                }
                else if (gradient.shape === CSSRadialShape.ELLIPSE) {
                    rx = Math.min(Math.abs(x), Math.abs(x - width));
                    ry = Math.min(Math.abs(y), Math.abs(y - height));
                }
                break;
            case CSSRadialExtent.CLOSEST_CORNER:
                // The ending shape is sized so that that it passes through the corner of the gradient box closest to the gradient’s center.
                // If the shape is an ellipse, the ending shape is given the same aspect-ratio it would have if closest-side were specified.
                if (gradient.shape === CSSRadialShape.CIRCLE) {
                    rx = ry = Math.min(distance(x, y), distance(x, y - height), distance(x - width, y), distance(x - width, y - height));
                }
                else if (gradient.shape === CSSRadialShape.ELLIPSE) {
                    // Compute the ratio ry/rx (which is to be the same as for "closest-side")
                    var c = Math.min(Math.abs(y), Math.abs(y - height)) / Math.min(Math.abs(x), Math.abs(x - width));
                    var _a = findCorner(width, height, x, y, true), cx = _a[0], cy = _a[1];
                    rx = distance(cx - x, (cy - y) / c);
                    ry = c * rx;
                }
                break;
            case CSSRadialExtent.FARTHEST_SIDE:
                // Same as closest-side, except the ending shape is sized based on the farthest side(s)
                if (gradient.shape === CSSRadialShape.CIRCLE) {
                    rx = ry = Math.max(Math.abs(x), Math.abs(x - width), Math.abs(y), Math.abs(y - height));
                }
                else if (gradient.shape === CSSRadialShape.ELLIPSE) {
                    rx = Math.max(Math.abs(x), Math.abs(x - width));
                    ry = Math.max(Math.abs(y), Math.abs(y - height));
                }
                break;
            case CSSRadialExtent.FARTHEST_CORNER:
                // Same as closest-corner, except the ending shape is sized based on the farthest corner.
                // If the shape is an ellipse, the ending shape is given the same aspect ratio it would have if farthest-side were specified.
                if (gradient.shape === CSSRadialShape.CIRCLE) {
                    rx = ry = Math.max(distance(x, y), distance(x, y - height), distance(x - width, y), distance(x - width, y - height));
                }
                else if (gradient.shape === CSSRadialShape.ELLIPSE) {
                    // Compute the ratio ry/rx (which is to be the same as for "farthest-side")
                    var c = Math.max(Math.abs(y), Math.abs(y - height)) / Math.max(Math.abs(x), Math.abs(x - width));
                    var _b = findCorner(width, height, x, y, false), cx = _b[0], cy = _b[1];
                    rx = distance(cx - x, (cy - y) / c);
                    ry = c * rx;
                }
                break;
        }
        if (Array.isArray(gradient.size)) {
            rx = getAbsoluteValue(gradient.size[0], width);
            ry = gradient.size.length === 2 ? getAbsoluteValue(gradient.size[1], height) : rx;
        }
        return [rx, ry];
    };

    var linearGradient = function (context, tokens) {
        var angle$1 = deg(180);
        var stops = [];
        parseFunctionArgs(tokens).forEach(function (arg, i) {
            if (i === 0) {
                var firstToken = arg[0];
                if (firstToken.type === 20 /* IDENT_TOKEN */ && firstToken.value === 'to') {
                    angle$1 = parseNamedSide(arg);
                    return;
                }
                else if (isAngle(firstToken)) {
                    angle$1 = angle.parse(context, firstToken);
                    return;
                }
            }
            var colorStop = parseColorStop(context, arg);
            stops.push(colorStop);
        });
        return { angle: angle$1, stops: stops, type: CSSImageType.LINEAR_GRADIENT };
    };

    var prefixLinearGradient = function (context, tokens) {
        var angle$1 = deg(180);
        var stops = [];
        parseFunctionArgs(tokens).forEach(function (arg, i) {
            if (i === 0) {
                var firstToken = arg[0];
                if (firstToken.type === 20 /* IDENT_TOKEN */ &&
                    ['top', 'left', 'right', 'bottom'].indexOf(firstToken.value) !== -1) {
                    angle$1 = parseNamedSide(arg);
                    return;
                }
                else if (isAngle(firstToken)) {
                    angle$1 = (angle.parse(context, firstToken) + deg(270)) % deg(360);
                    return;
                }
            }
            var colorStop = parseColorStop(context, arg);
            stops.push(colorStop);
        });
        return {
            angle: angle$1,
            stops: stops,
            type: CSSImageType.LINEAR_GRADIENT
        };
    };

    var webkitGradient = function (context, tokens) {
        var angle = deg(180);
        var stops = [];
        var type = CSSImageType.LINEAR_GRADIENT;
        var shape = CSSRadialShape.CIRCLE;
        var size = CSSRadialExtent.FARTHEST_CORNER;
        var position = [];
        parseFunctionArgs(tokens).forEach(function (arg, i) {
            var firstToken = arg[0];
            if (i === 0) {
                if (isIdentToken(firstToken) && firstToken.value === 'linear') {
                    type = CSSImageType.LINEAR_GRADIENT;
                    return;
                }
                else if (isIdentToken(firstToken) && firstToken.value === 'radial') {
                    type = CSSImageType.RADIAL_GRADIENT;
                    return;
                }
            }
            if (firstToken.type === 18 /* FUNCTION */) {
                if (firstToken.name === 'from') {
                    var color = color$1.parse(context, firstToken.values[0]);
                    stops.push({ stop: ZERO_LENGTH, color: color });
                }
                else if (firstToken.name === 'to') {
                    var color = color$1.parse(context, firstToken.values[0]);
                    stops.push({ stop: HUNDRED_PERCENT, color: color });
                }
                else if (firstToken.name === 'color-stop') {
                    var values = firstToken.values.filter(nonFunctionArgSeparator);
                    if (values.length === 2) {
                        var color = color$1.parse(context, values[1]);
                        var stop_1 = values[0];
                        if (isNumberToken(stop_1)) {
                            stops.push({
                                stop: { type: 16 /* PERCENTAGE_TOKEN */, number: stop_1.number * 100, flags: stop_1.flags },
                                color: color
                            });
                        }
                    }
                }
            }
        });
        return type === CSSImageType.LINEAR_GRADIENT
            ? {
                angle: (angle + deg(180)) % deg(360),
                stops: stops,
                type: type
            }
            : { size: size, shape: shape, stops: stops, position: position, type: type };
    };

    var CLOSEST_SIDE = 'closest-side';
    var FARTHEST_SIDE = 'farthest-side';
    var CLOSEST_CORNER = 'closest-corner';
    var FARTHEST_CORNER = 'farthest-corner';
    var CIRCLE = 'circle';
    var ELLIPSE = 'ellipse';
    var COVER = 'cover';
    var CONTAIN = 'contain';
    var radialGradient = function (context, tokens) {
        var shape = CSSRadialShape.CIRCLE;
        var size = CSSRadialExtent.FARTHEST_CORNER;
        var stops = [];
        var position = [];
        parseFunctionArgs(tokens).forEach(function (arg, i) {
            var isColorStop = true;
            if (i === 0) {
                var isAtPosition_1 = false;
                isColorStop = arg.reduce(function (acc, token) {
                    if (isAtPosition_1) {
                        if (isIdentToken(token)) {
                            switch (token.value) {
                                case 'center':
                                    position.push(FIFTY_PERCENT);
                                    return acc;
                                case 'top':
                                case 'left':
                                    position.push(ZERO_LENGTH);
                                    return acc;
                                case 'right':
                                case 'bottom':
                                    position.push(HUNDRED_PERCENT);
                                    return acc;
                            }
                        }
                        else if (isLengthPercentage(token) || isLength(token)) {
                            position.push(token);
                        }
                    }
                    else if (isIdentToken(token)) {
                        switch (token.value) {
                            case CIRCLE:
                                shape = CSSRadialShape.CIRCLE;
                                return false;
                            case ELLIPSE:
                                shape = CSSRadialShape.ELLIPSE;
                                return false;
                            case 'at':
                                isAtPosition_1 = true;
                                return false;
                            case CLOSEST_SIDE:
                                size = CSSRadialExtent.CLOSEST_SIDE;
                                return false;
                            case COVER:
                            case FARTHEST_SIDE:
                                size = CSSRadialExtent.FARTHEST_SIDE;
                                return false;
                            case CONTAIN:
                            case CLOSEST_CORNER:
                                size = CSSRadialExtent.CLOSEST_CORNER;
                                return false;
                            case FARTHEST_CORNER:
                                size = CSSRadialExtent.FARTHEST_CORNER;
                                return false;
                        }
                    }
                    else if (isLength(token) || isLengthPercentage(token)) {
                        if (!Array.isArray(size)) {
                            size = [];
                        }
                        size.push(token);
                        return false;
                    }
                    return acc;
                }, isColorStop);
            }
            if (isColorStop) {
                var colorStop = parseColorStop(context, arg);
                stops.push(colorStop);
            }
        });
        return { size: size, shape: shape, stops: stops, position: position, type: CSSImageType.RADIAL_GRADIENT };
    };

    var prefixRadialGradient = function (context, tokens) {
        var shape = CSSRadialShape.CIRCLE;
        var size = CSSRadialExtent.FARTHEST_CORNER;
        var stops = [];
        var position = [];
        parseFunctionArgs(tokens).forEach(function (arg, i) {
            var isColorStop = true;
            if (i === 0) {
                isColorStop = arg.reduce(function (acc, token) {
                    if (isIdentToken(token)) {
                        switch (token.value) {
                            case 'center':
                                position.push(FIFTY_PERCENT);
                                return false;
                            case 'top':
                            case 'left':
                                position.push(ZERO_LENGTH);
                                return false;
                            case 'right':
                            case 'bottom':
                                position.push(HUNDRED_PERCENT);
                                return false;
                        }
                    }
                    else if (isLengthPercentage(token) || isLength(token)) {
                        position.push(token);
                        return false;
                    }
                    return acc;
                }, isColorStop);
            }
            else if (i === 1) {
                isColorStop = arg.reduce(function (acc, token) {
                    if (isIdentToken(token)) {
                        switch (token.value) {
                            case CIRCLE:
                                shape = CSSRadialShape.CIRCLE;
                                return false;
                            case ELLIPSE:
                                shape = CSSRadialShape.ELLIPSE;
                                return false;
                            case CONTAIN:
                            case CLOSEST_SIDE:
                                size = CSSRadialExtent.CLOSEST_SIDE;
                                return false;
                            case FARTHEST_SIDE:
                                size = CSSRadialExtent.FARTHEST_SIDE;
                                return false;
                            case CLOSEST_CORNER:
                                size = CSSRadialExtent.CLOSEST_CORNER;
                                return false;
                            case COVER:
                            case FARTHEST_CORNER:
                                size = CSSRadialExtent.FARTHEST_CORNER;
                                return false;
                        }
                    }
                    else if (isLength(token) || isLengthPercentage(token)) {
                        if (!Array.isArray(size)) {
                            size = [];
                        }
                        size.push(token);
                        return false;
                    }
                    return acc;
                }, isColorStop);
            }
            if (isColorStop) {
                var colorStop = parseColorStop(context, arg);
                stops.push(colorStop);
            }
        });
        return { size: size, shape: shape, stops: stops, position: position, type: CSSImageType.RADIAL_GRADIENT };
    };

    var CSSImageType;
    (function (CSSImageType) {
        CSSImageType[CSSImageType["URL"] = 0] = "URL";
        CSSImageType[CSSImageType["LINEAR_GRADIENT"] = 1] = "LINEAR_GRADIENT";
        CSSImageType[CSSImageType["RADIAL_GRADIENT"] = 2] = "RADIAL_GRADIENT";
    })(CSSImageType || (CSSImageType = {}));
    var isLinearGradient = function (background) {
        return background.type === CSSImageType.LINEAR_GRADIENT;
    };
    var isRadialGradient = function (background) {
        return background.type === CSSImageType.RADIAL_GRADIENT;
    };
    var CSSRadialShape;
    (function (CSSRadialShape) {
        CSSRadialShape[CSSRadialShape["CIRCLE"] = 0] = "CIRCLE";
        CSSRadialShape[CSSRadialShape["ELLIPSE"] = 1] = "ELLIPSE";
    })(CSSRadialShape || (CSSRadialShape = {}));
    var CSSRadialExtent;
    (function (CSSRadialExtent) {
        CSSRadialExtent[CSSRadialExtent["CLOSEST_SIDE"] = 0] = "CLOSEST_SIDE";
        CSSRadialExtent[CSSRadialExtent["FARTHEST_SIDE"] = 1] = "FARTHEST_SIDE";
        CSSRadialExtent[CSSRadialExtent["CLOSEST_CORNER"] = 2] = "CLOSEST_CORNER";
        CSSRadialExtent[CSSRadialExtent["FARTHEST_CORNER"] = 3] = "FARTHEST_CORNER";
    })(CSSRadialExtent || (CSSRadialExtent = {}));
    var image = {
        name: 'image',
        parse: function (context, value) {
            if (value.type === 22 /* URL_TOKEN */) {
                var image_1 = { url: value.value, type: CSSImageType.URL };
                context.cache.addImage(value.value);
                return image_1;
            }
            if (value.type === 18 /* FUNCTION */) {
                var imageFunction = SUPPORTED_IMAGE_FUNCTIONS[value.name];
                if (typeof imageFunction === 'undefined') {
                    throw new Error("Attempting to parse an unsupported image function \"" + value.name + "\"");
                }
                return imageFunction(context, value.values);
            }
            throw new Error("Unsupported image type " + value.type);
        }
    };
    function isSupportedImage(value) {
        return (!(value.type === 20 /* IDENT_TOKEN */ && value.value === 'none') &&
            (value.type !== 18 /* FUNCTION */ || !!SUPPORTED_IMAGE_FUNCTIONS[value.name]));
    }
    var SUPPORTED_IMAGE_FUNCTIONS = {
        'linear-gradient': linearGradient,
        '-moz-linear-gradient': prefixLinearGradient,
        '-ms-linear-gradient': prefixLinearGradient,
        '-o-linear-gradient': prefixLinearGradient,
        '-webkit-linear-gradient': prefixLinearGradient,
        'radial-gradient': radialGradient,
        '-moz-radial-gradient': prefixRadialGradient,
        '-ms-radial-gradient': prefixRadialGradient,
        '-o-radial-gradient': prefixRadialGradient,
        '-webkit-radial-gradient': prefixRadialGradient,
        '-webkit-gradient': webkitGradient
    };

    var backgroundImage = {
        name: 'background-image',
        initialValue: 'none',
        type: 1 /* LIST */,
        prefix: false,
        parse: function (context, tokens) {
            if (tokens.length === 0) {
                return [];
            }
            var first = tokens[0];
            if (first.type === 20 /* IDENT_TOKEN */ && first.value === 'none') {
                return [];
            }
            return tokens
                .filter(function (value) { return nonFunctionArgSeparator(value) && isSupportedImage(value); })
                .map(function (value) { return image.parse(context, value); });
        }
    };

    var backgroundOrigin = {
        name: 'background-origin',
        initialValue: 'border-box',
        prefix: false,
        type: 1 /* LIST */,
        parse: function (_context, tokens) {
            return tokens.map(function (token) {
                if (isIdentToken(token)) {
                    switch (token.value) {
                        case 'padding-box':
                            return 1 /* PADDING_BOX */;
                        case 'content-box':
                            return 2 /* CONTENT_BOX */;
                    }
                }
                return 0 /* BORDER_BOX */;
            });
        }
    };

    var backgroundPosition = {
        name: 'background-position',
        initialValue: '0% 0%',
        type: 1 /* LIST */,
        prefix: false,
        parse: function (_context, tokens) {
            return parseFunctionArgs(tokens)
                .map(function (values) { return values.filter(isLengthPercentage); })
                .map(parseLengthPercentageTuple);
        }
    };

    var BACKGROUND_REPEAT;
    (function (BACKGROUND_REPEAT) {
        BACKGROUND_REPEAT[BACKGROUND_REPEAT["REPEAT"] = 0] = "REPEAT";
        BACKGROUND_REPEAT[BACKGROUND_REPEAT["NO_REPEAT"] = 1] = "NO_REPEAT";
        BACKGROUND_REPEAT[BACKGROUND_REPEAT["REPEAT_X"] = 2] = "REPEAT_X";
        BACKGROUND_REPEAT[BACKGROUND_REPEAT["REPEAT_Y"] = 3] = "REPEAT_Y";
    })(BACKGROUND_REPEAT || (BACKGROUND_REPEAT = {}));
    var backgroundRepeat = {
        name: 'background-repeat',
        initialValue: 'repeat',
        prefix: false,
        type: 1 /* LIST */,
        parse: function (_context, tokens) {
            return parseFunctionArgs(tokens)
                .map(function (values) {
                return values
                    .filter(isIdentToken)
                    .map(function (token) { return token.value; })
                    .join(' ');
            })
                .map(parseBackgroundRepeat);
        }
    };
    var parseBackgroundRepeat = function (value) {
        switch (value) {
            case 'no-repeat':
                return BACKGROUND_REPEAT.NO_REPEAT;
            case 'repeat-x':
            case 'repeat no-repeat':
                return BACKGROUND_REPEAT.REPEAT_X;
            case 'repeat-y':
            case 'no-repeat repeat':
                return BACKGROUND_REPEAT.REPEAT_Y;
            case 'repeat':
            default:
                return BACKGROUND_REPEAT.REPEAT;
        }
    };

    var BACKGROUND_SIZE;
    (function (BACKGROUND_SIZE) {
        BACKGROUND_SIZE["AUTO"] = "auto";
        BACKGROUND_SIZE["CONTAIN"] = "contain";
        BACKGROUND_SIZE["COVER"] = "cover";
    })(BACKGROUND_SIZE || (BACKGROUND_SIZE = {}));
    var backgroundSize = {
        name: 'background-size',
        initialValue: '0',
        prefix: false,
        type: 1 /* LIST */,
        parse: function (_context, tokens) {
            return parseFunctionArgs(tokens).map(function (values) { return values.filter(isBackgroundSizeInfoToken); });
        }
    };
    var isBackgroundSizeInfoToken = function (value) {
        return isIdentToken(value) || isLengthPercentage(value);
    };

    var borderColorForSide = function (side) { return ({
        name: "border-" + side + "-color",
        initialValue: 'transparent',
        prefix: false,
        type: 3 /* TYPE_VALUE */,
        format: 'color'
    }); };
    var borderTopColor = borderColorForSide('top');
    var borderRightColor = borderColorForSide('right');
    var borderBottomColor = borderColorForSide('bottom');
    var borderLeftColor = borderColorForSide('left');

    var borderRadiusForSide = function (side) { return ({
        name: "border-radius-" + side,
        initialValue: '0 0',
        prefix: false,
        type: 1 /* LIST */,
        parse: function (_context, tokens) {
            return parseLengthPercentageTuple(tokens.filter(isLengthPercentage));
        }
    }); };
    var borderTopLeftRadius = borderRadiusForSide('top-left');
    var borderTopRightRadius = borderRadiusForSide('top-right');
    var borderBottomRightRadius = borderRadiusForSide('bottom-right');
    var borderBottomLeftRadius = borderRadiusForSide('bottom-left');

    var BORDER_STYLE;
    (function (BORDER_STYLE) {
        BORDER_STYLE[BORDER_STYLE["NONE"] = 0] = "NONE";
        BORDER_STYLE[BORDER_STYLE["SOLID"] = 1] = "SOLID";
        BORDER_STYLE[BORDER_STYLE["DASHED"] = 2] = "DASHED";
        BORDER_STYLE[BORDER_STYLE["DOTTED"] = 3] = "DOTTED";
        BORDER_STYLE[BORDER_STYLE["DOUBLE"] = 4] = "DOUBLE";
    })(BORDER_STYLE || (BORDER_STYLE = {}));
    var borderStyleForSide = function (side) { return ({
        name: "border-" + side + "-style",
        initialValue: 'solid',
        prefix: false,
        type: 2 /* IDENT_VALUE */,
        parse: function (_context, style) {
            switch (style) {
                case 'none':
                    return BORDER_STYLE.NONE;
                case 'dashed':
                    return BORDER_STYLE.DASHED;
                case 'dotted':
                    return BORDER_STYLE.DOTTED;
                case 'double':
                    return BORDER_STYLE.DOUBLE;
            }
            return BORDER_STYLE.SOLID;
        }
    }); };
    var borderTopStyle = borderStyleForSide('top');
    var borderRightStyle = borderStyleForSide('right');
    var borderBottomStyle = borderStyleForSide('bottom');
    var borderLeftStyle = borderStyleForSide('left');

    var borderWidthForSide = function (side) { return ({
        name: "border-" + side + "-width",
        initialValue: '0',
        type: 0 /* VALUE */,
        prefix: false,
        parse: function (_context, token) {
            if (isDimensionToken(token)) {
                return token.number;
            }
            return 0;
        }
    }); };
    var borderTopWidth = borderWidthForSide('top');
    var borderRightWidth = borderWidthForSide('right');
    var borderBottomWidth = borderWidthForSide('bottom');
    var borderLeftWidth = borderWidthForSide('left');

    var color = {
        name: "color",
        initialValue: 'transparent',
        prefix: false,
        type: 3 /* TYPE_VALUE */,
        format: 'color'
    };

    var direction = {
        name: 'direction',
        initialValue: 'ltr',
        prefix: false,
        type: 2 /* IDENT_VALUE */,
        parse: function (_context, direction) {
            switch (direction) {
                case 'rtl':
                    return 1 /* RTL */;
                case 'ltr':
                default:
                    return 0 /* LTR */;
            }
        }
    };

    var display = {
        name: 'display',
        initialValue: 'inline-block',
        prefix: false,
        type: 1 /* LIST */,
        parse: function (_context, tokens) {
            return tokens.filter(isIdentToken).reduce(function (bit, token) {
                return bit | parseDisplayValue(token.value);
            }, 0 /* NONE */);
        }
    };
    var parseDisplayValue = function (display) {
        switch (display) {
            case 'block':
            case '-webkit-box':
                return 2 /* BLOCK */;
            case 'inline':
                return 4 /* INLINE */;
            case 'run-in':
                return 8 /* RUN_IN */;
            case 'flow':
                return 16 /* FLOW */;
            case 'flow-root':
                return 32 /* FLOW_ROOT */;
            case 'table':
                return 64 /* TABLE */;
            case 'flex':
            case '-webkit-flex':
                return 128 /* FLEX */;
            case 'grid':
            case '-ms-grid':
                return 256 /* GRID */;
            case 'ruby':
                return 512 /* RUBY */;
            case 'subgrid':
                return 1024 /* SUBGRID */;
            case 'list-item':
                return 2048 /* LIST_ITEM */;
            case 'table-row-group':
                return 4096 /* TABLE_ROW_GROUP */;
            case 'table-header-group':
                return 8192 /* TABLE_HEADER_GROUP */;
            case 'table-footer-group':
                return 16384 /* TABLE_FOOTER_GROUP */;
            case 'table-row':
                return 32768 /* TABLE_ROW */;
            case 'table-cell':
                return 65536 /* TABLE_CELL */;
            case 'table-column-group':
                return 131072 /* TABLE_COLUMN_GROUP */;
            case 'table-column':
                return 262144 /* TABLE_COLUMN */;
            case 'table-caption':
                return 524288 /* TABLE_CAPTION */;
            case 'ruby-base':
                return 1048576 /* RUBY_BASE */;
            case 'ruby-text':
                return 2097152 /* RUBY_TEXT */;
            case 'ruby-base-container':
                return 4194304 /* RUBY_BASE_CONTAINER */;
            case 'ruby-text-container':
                return 8388608 /* RUBY_TEXT_CONTAINER */;
            case 'contents':
                return 16777216 /* CONTENTS */;
            case 'inline-block':
                return 33554432 /* INLINE_BLOCK */;
            case 'inline-list-item':
                return 67108864 /* INLINE_LIST_ITEM */;
            case 'inline-table':
                return 134217728 /* INLINE_TABLE */;
            case 'inline-flex':
                return 268435456 /* INLINE_FLEX */;
            case 'inline-grid':
                return 536870912 /* INLINE_GRID */;
        }
        return 0 /* NONE */;
    };

    var FLOAT;
    (function (FLOAT) {
        FLOAT[FLOAT["NONE"] = 0] = "NONE";
        FLOAT[FLOAT["LEFT"] = 1] = "LEFT";
        FLOAT[FLOAT["RIGHT"] = 2] = "RIGHT";
        FLOAT[FLOAT["INLINE_START"] = 3] = "INLINE_START";
        FLOAT[FLOAT["INLINE_END"] = 4] = "INLINE_END";
    })(FLOAT || (FLOAT = {}));
    var float = {
        name: 'float',
        initialValue: 'none',
        prefix: false,
        type: 2 /* IDENT_VALUE */,
        parse: function (_context, float) {
            switch (float) {
                case 'left':
                    return FLOAT.LEFT;
                case 'right':
                    return FLOAT.RIGHT;
                case 'inline-start':
                    return FLOAT.INLINE_START;
                case 'inline-end':
                    return FLOAT.INLINE_END;
            }
            return FLOAT.NONE;
        }
    };

    var letterSpacing = {
        name: 'letter-spacing',
        initialValue: '0',
        prefix: false,
        type: 0 /* VALUE */,
        parse: function (_context, token) {
            if (token.type === 20 /* IDENT_TOKEN */ && token.value === 'normal') {
                return 0;
            }
            if (token.type === 17 /* NUMBER_TOKEN */) {
                return token.number;
            }
            if (token.type === 15 /* DIMENSION_TOKEN */) {
                return token.number;
            }
            return 0;
        }
    };

    var LINE_BREAK;
    (function (LINE_BREAK) {
        LINE_BREAK["NORMAL"] = "normal";
        LINE_BREAK["STRICT"] = "strict";
    })(LINE_BREAK || (LINE_BREAK = {}));
    var lineBreak = {
        name: 'line-break',
        initialValue: 'normal',
        prefix: false,
        type: 2 /* IDENT_VALUE */,
        parse: function (_context, lineBreak) {
            switch (lineBreak) {
                case 'strict':
                    return LINE_BREAK.STRICT;
                case 'normal':
                default:
                    return LINE_BREAK.NORMAL;
            }
        }
    };

    var lineHeight = {
        name: 'line-height',
        initialValue: 'normal',
        prefix: false,
        type: 4 /* TOKEN_VALUE */
    };
    var computeLineHeight = function (token, fontSize) {
        if (isIdentToken(token) && token.value === 'normal') {
            return 1.2 * fontSize;
        }
        else if (token.type === 17 /* NUMBER_TOKEN */) {
            return fontSize * token.number;
        }
        else if (isLengthPercentage(token)) {
            return getAbsoluteValue(token, fontSize);
        }
        return fontSize;
    };

    var listStyleImage = {
        name: 'list-style-image',
        initialValue: 'none',
        type: 0 /* VALUE */,
        prefix: false,
        parse: function (context, token) {
            if (token.type === 20 /* IDENT_TOKEN */ && token.value === 'none') {
                return null;
            }
            return image.parse(context, token);
        }
    };

    var LIST_STYLE_POSITION;
    (function (LIST_STYLE_POSITION) {
        LIST_STYLE_POSITION[LIST_STYLE_POSITION["INSIDE"] = 0] = "INSIDE";
        LIST_STYLE_POSITION[LIST_STYLE_POSITION["OUTSIDE"] = 1] = "OUTSIDE";
    })(LIST_STYLE_POSITION || (LIST_STYLE_POSITION = {}));
    var listStylePosition = {
        name: 'list-style-position',
        initialValue: 'outside',
        prefix: false,
        type: 2 /* IDENT_VALUE */,
        parse: function (_context, position) {
            switch (position) {
                case 'inside':
                    return LIST_STYLE_POSITION.INSIDE;
                case 'outside':
                default:
                    return LIST_STYLE_POSITION.OUTSIDE;
            }
        }
    };

    var LIST_STYLE_TYPE;
    (function (LIST_STYLE_TYPE) {
        LIST_STYLE_TYPE[LIST_STYLE_TYPE["NONE"] = -1] = "NONE";
        LIST_STYLE_TYPE[LIST_STYLE_TYPE["DISC"] = 0] = "DISC";
        LIST_STYLE_TYPE[LIST_STYLE_TYPE["CIRCLE"] = 1] = "CIRCLE";
        LIST_STYLE_TYPE[LIST_STYLE_TYPE["SQUARE"] = 2] = "SQUARE";
        LIST_STYLE_TYPE[LIST_STYLE_TYPE["DECIMAL"] = 3] = "DECIMAL";
        LIST_STYLE_TYPE[LIST_STYLE_TYPE["CJK_DECIMAL"] = 4] = "CJK_DECIMAL";
        LIST_STYLE_TYPE[LIST_STYLE_TYPE["DECIMAL_LEADING_ZERO"] = 5] = "DECIMAL_LEADING_ZERO";
        LIST_STYLE_TYPE[LIST_STYLE_TYPE["LOWER_ROMAN"] = 6] = "LOWER_ROMAN";
        LIST_STYLE_TYPE[LIST_STYLE_TYPE["UPPER_ROMAN"] = 7] = "UPPER_ROMAN";
        LIST_STYLE_TYPE[LIST_STYLE_TYPE["LOWER_GREEK"] = 8] = "LOWER_GREEK";
        LIST_STYLE_TYPE[LIST_STYLE_TYPE["LOWER_ALPHA"] = 9] = "LOWER_ALPHA";
        LIST_STYLE_TYPE[LIST_STYLE_TYPE["UPPER_ALPHA"] = 10] = "UPPER_ALPHA";
        LIST_STYLE_TYPE[LIST_STYLE_TYPE["ARABIC_INDIC"] = 11] = "ARABIC_INDIC";
        LIST_STYLE_TYPE[LIST_STYLE_TYPE["ARMENIAN"] = 12] = "ARMENIAN";
        LIST_STYLE_TYPE[LIST_STYLE_TYPE["BENGALI"] = 13] = "BENGALI";
        LIST_STYLE_TYPE[LIST_STYLE_TYPE["CAMBODIAN"] = 14] = "CAMBODIAN";
        LIST_STYLE_TYPE[LIST_STYLE_TYPE["CJK_EARTHLY_BRANCH"] = 15] = "CJK_EARTHLY_BRANCH";
        LIST_STYLE_TYPE[LIST_STYLE_TYPE["CJK_HEAVENLY_STEM"] = 16] = "CJK_HEAVENLY_STEM";
        LIST_STYLE_TYPE[LIST_STYLE_TYPE["CJK_IDEOGRAPHIC"] = 17] = "CJK_IDEOGRAPHIC";
        LIST_STYLE_TYPE[LIST_STYLE_TYPE["DEVANAGARI"] = 18] = "DEVANAGARI";
        LIST_STYLE_TYPE[LIST_STYLE_TYPE["ETHIOPIC_NUMERIC"] = 19] = "ETHIOPIC_NUMERIC";
        LIST_STYLE_TYPE[LIST_STYLE_TYPE["GEORGIAN"] = 20] = "GEORGIAN";
        LIST_STYLE_TYPE[LIST_STYLE_TYPE["GUJARATI"] = 21] = "GUJARATI";
        LIST_STYLE_TYPE[LIST_STYLE_TYPE["GURMUKHI"] = 22] = "GURMUKHI";
        LIST_STYLE_TYPE[LIST_STYLE_TYPE["HEBREW"] = 22] = "HEBREW";
        LIST_STYLE_TYPE[LIST_STYLE_TYPE["HIRAGANA"] = 23] = "HIRAGANA";
        LIST_STYLE_TYPE[LIST_STYLE_TYPE["HIRAGANA_IROHA"] = 24] = "HIRAGANA_IROHA";
        LIST_STYLE_TYPE[LIST_STYLE_TYPE["JAPANESE_FORMAL"] = 25] = "JAPANESE_FORMAL";
        LIST_STYLE_TYPE[LIST_STYLE_TYPE["JAPANESE_INFORMAL"] = 26] = "JAPANESE_INFORMAL";
        LIST_STYLE_TYPE[LIST_STYLE_TYPE["KANNADA"] = 27] = "KANNADA";
        LIST_STYLE_TYPE[LIST_STYLE_TYPE["KATAKANA"] = 28] = "KATAKANA";
        LIST_STYLE_TYPE[LIST_STYLE_TYPE["KATAKANA_IROHA"] = 29] = "KATAKANA_IROHA";
        LIST_STYLE_TYPE[LIST_STYLE_TYPE["KHMER"] = 30] = "KHMER";
        LIST_STYLE_TYPE[LIST_STYLE_TYPE["KOREAN_HANGUL_FORMAL"] = 31] = "KOREAN_HANGUL_FORMAL";
        LIST_STYLE_TYPE[LIST_STYLE_TYPE["KOREAN_HANJA_FORMAL"] = 32] = "KOREAN_HANJA_FORMAL";
        LIST_STYLE_TYPE[LIST_STYLE_TYPE["KOREAN_HANJA_INFORMAL"] = 33] = "KOREAN_HANJA_INFORMAL";
        LIST_STYLE_TYPE[LIST_STYLE_TYPE["LAO"] = 34] = "LAO";
        LIST_STYLE_TYPE[LIST_STYLE_TYPE["LOWER_ARMENIAN"] = 35] = "LOWER_ARMENIAN";
        LIST_STYLE_TYPE[LIST_STYLE_TYPE["MALAYALAM"] = 36] = "MALAYALAM";
        LIST_STYLE_TYPE[LIST_STYLE_TYPE["MONGOLIAN"] = 37] = "MONGOLIAN";
        LIST_STYLE_TYPE[LIST_STYLE_TYPE["MYANMAR"] = 38] = "MYANMAR";
        LIST_STYLE_TYPE[LIST_STYLE_TYPE["ORIYA"] = 39] = "ORIYA";
        LIST_STYLE_TYPE[LIST_STYLE_TYPE["PERSIAN"] = 40] = "PERSIAN";
        LIST_STYLE_TYPE[LIST_STYLE_TYPE["SIMP_CHINESE_FORMAL"] = 41] = "SIMP_CHINESE_FORMAL";
        LIST_STYLE_TYPE[LIST_STYLE_TYPE["SIMP_CHINESE_INFORMAL"] = 42] = "SIMP_CHINESE_INFORMAL";
        LIST_STYLE_TYPE[LIST_STYLE_TYPE["TAMIL"] = 43] = "TAMIL";
        LIST_STYLE_TYPE[LIST_STYLE_TYPE["TELUGU"] = 44] = "TELUGU";
        LIST_STYLE_TYPE[LIST_STYLE_TYPE["THAI"] = 45] = "THAI";
        LIST_STYLE_TYPE[LIST_STYLE_TYPE["TIBETAN"] = 46] = "TIBETAN";
        LIST_STYLE_TYPE[LIST_STYLE_TYPE["TRAD_CHINESE_FORMAL"] = 47] = "TRAD_CHINESE_FORMAL";
        LIST_STYLE_TYPE[LIST_STYLE_TYPE["TRAD_CHINESE_INFORMAL"] = 48] = "TRAD_CHINESE_INFORMAL";
        LIST_STYLE_TYPE[LIST_STYLE_TYPE["UPPER_ARMENIAN"] = 49] = "UPPER_ARMENIAN";
        LIST_STYLE_TYPE[LIST_STYLE_TYPE["DISCLOSURE_OPEN"] = 50] = "DISCLOSURE_OPEN";
        LIST_STYLE_TYPE[LIST_STYLE_TYPE["DISCLOSURE_CLOSED"] = 51] = "DISCLOSURE_CLOSED";
    })(LIST_STYLE_TYPE || (LIST_STYLE_TYPE = {}));
    var listStyleType = {
        name: 'list-style-type',
        initialValue: 'none',
        prefix: false,
        type: 2 /* IDENT_VALUE */,
        parse: function (_context, type) {
            switch (type) {
                case 'disc':
                    return LIST_STYLE_TYPE.DISC;
                case 'circle':
                    return LIST_STYLE_TYPE.CIRCLE;
                case 'square':
                    return LIST_STYLE_TYPE.SQUARE;
                case 'decimal':
                    return LIST_STYLE_TYPE.DECIMAL;
                case 'cjk-decimal':
                    return LIST_STYLE_TYPE.CJK_DECIMAL;
                case 'decimal-leading-zero':
                    return LIST_STYLE_TYPE.DECIMAL_LEADING_ZERO;
                case 'lower-roman':
                    return LIST_STYLE_TYPE.LOWER_ROMAN;
                case 'upper-roman':
                    return LIST_STYLE_TYPE.UPPER_ROMAN;
                case 'lower-greek':
                    return LIST_STYLE_TYPE.LOWER_GREEK;
                case 'lower-alpha':
                    return LIST_STYLE_TYPE.LOWER_ALPHA;
                case 'upper-alpha':
                    return LIST_STYLE_TYPE.UPPER_ALPHA;
                case 'arabic-indic':
                    return LIST_STYLE_TYPE.ARABIC_INDIC;
                case 'armenian':
                    return LIST_STYLE_TYPE.ARMENIAN;
                case 'bengali':
                    return LIST_STYLE_TYPE.BENGALI;
                case 'cambodian':
                    return LIST_STYLE_TYPE.CAMBODIAN;
                case 'cjk-earthly-branch':
                    return LIST_STYLE_TYPE.CJK_EARTHLY_BRANCH;
                case 'cjk-heavenly-stem':
                    return LIST_STYLE_TYPE.CJK_HEAVENLY_STEM;
                case 'cjk-ideographic':
                    return LIST_STYLE_TYPE.CJK_IDEOGRAPHIC;
                case 'devanagari':
                    return LIST_STYLE_TYPE.DEVANAGARI;
                case 'ethiopic-numeric':
                    return LIST_STYLE_TYPE.ETHIOPIC_NUMERIC;
                case 'georgian':
                    return LIST_STYLE_TYPE.GEORGIAN;
                case 'gujarati':
                    return LIST_STYLE_TYPE.GUJARATI;
                case 'gurmukhi':
                    return LIST_STYLE_TYPE.GURMUKHI;
                case 'hebrew':
                    return LIST_STYLE_TYPE.HEBREW;
                case 'hiragana':
                    return LIST_STYLE_TYPE.HIRAGANA;
                case 'hiragana-iroha':
                    return LIST_STYLE_TYPE.HIRAGANA_IROHA;
                case 'japanese-formal':
                    return LIST_STYLE_TYPE.JAPANESE_FORMAL;
                case 'japanese-informal':
                    return LIST_STYLE_TYPE.JAPANESE_INFORMAL;
                case 'kannada':
                    return LIST_STYLE_TYPE.KANNADA;
                case 'katakana':
                    return LIST_STYLE_TYPE.KATAKANA;
                case 'katakana-iroha':
                    return LIST_STYLE_TYPE.KATAKANA_IROHA;
                case 'khmer':
                    return LIST_STYLE_TYPE.KHMER;
                case 'korean-hangul-formal':
                    return LIST_STYLE_TYPE.KOREAN_HANGUL_FORMAL;
                case 'korean-hanja-formal':
                    return LIST_STYLE_TYPE.KOREAN_HANJA_FORMAL;
                case 'korean-hanja-informal':
                    return LIST_STYLE_TYPE.KOREAN_HANJA_INFORMAL;
                case 'lao':
                    return LIST_STYLE_TYPE.LAO;
                case 'lower-armenian':
                    return LIST_STYLE_TYPE.LOWER_ARMENIAN;
                case 'malayalam':
                    return LIST_STYLE_TYPE.MALAYALAM;
                case 'mongolian':
                    return LIST_STYLE_TYPE.MONGOLIAN;
                case 'myanmar':
                    return LIST_STYLE_TYPE.MYANMAR;
                case 'oriya':
                    return LIST_STYLE_TYPE.ORIYA;
                case 'persian':
                    return LIST_STYLE_TYPE.PERSIAN;
                case 'simp-chinese-formal':
                    return LIST_STYLE_TYPE.SIMP_CHINESE_FORMAL;
                case 'simp-chinese-informal':
                    return LIST_STYLE_TYPE.SIMP_CHINESE_INFORMAL;
                case 'tamil':
                    return LIST_STYLE_TYPE.TAMIL;
                case 'telugu':
                    return LIST_STYLE_TYPE.TELUGU;
                case 'thai':
                    return LIST_STYLE_TYPE.THAI;
                case 'tibetan':
                    return LIST_STYLE_TYPE.TIBETAN;
                case 'trad-chinese-formal':
                    return LIST_STYLE_TYPE.TRAD_CHINESE_FORMAL;
                case 'trad-chinese-informal':
                    return LIST_STYLE_TYPE.TRAD_CHINESE_INFORMAL;
                case 'upper-armenian':
                    return LIST_STYLE_TYPE.UPPER_ARMENIAN;
                case 'disclosure-open':
                    return LIST_STYLE_TYPE.DISCLOSURE_OPEN;
                case 'disclosure-closed':
                    return LIST_STYLE_TYPE.DISCLOSURE_CLOSED;
                case 'none':
                default:
                    return LIST_STYLE_TYPE.NONE;
            }
        }
    };

    var marginForSide = function (side) { return ({
        name: "margin-" + side,
        initialValue: '0',
        prefix: false,
        type: 4 /* TOKEN_VALUE */
    }); };
    var marginTop = marginForSide('top');
    var marginRight = marginForSide('right');
    var marginBottom = marginForSide('bottom');
    var marginLeft = marginForSide('left');

    var OVERFLOW;
    (function (OVERFLOW) {
        OVERFLOW[OVERFLOW["VISIBLE"] = 0] = "VISIBLE";
        OVERFLOW[OVERFLOW["HIDDEN"] = 1] = "HIDDEN";
        OVERFLOW[OVERFLOW["SCROLL"] = 2] = "SCROLL";
        OVERFLOW[OVERFLOW["CLIP"] = 3] = "CLIP";
        OVERFLOW[OVERFLOW["AUTO"] = 4] = "AUTO";
    })(OVERFLOW || (OVERFLOW = {}));
    var overflow = {
        name: 'overflow',
        initialValue: 'visible',
        prefix: false,
        type: 1 /* LIST */,
        parse: function (_context, tokens) {
            return tokens.filter(isIdentToken).map(function (overflow) {
                switch (overflow.value) {
                    case 'hidden':
                        return OVERFLOW.HIDDEN;
                    case 'scroll':
                        return OVERFLOW.SCROLL;
                    case 'clip':
                        return OVERFLOW.CLIP;
                    case 'auto':
                        return OVERFLOW.AUTO;
                    case 'visible':
                    default:
                        return OVERFLOW.VISIBLE;
                }
            });
        }
    };

    var overflowWrap = {
        name: 'overflow-wrap',
        initialValue: 'normal',
        prefix: false,
        type: 2 /* IDENT_VALUE */,
        parse: function (_context, overflow) {
            switch (overflow) {
                case 'break-word':
                    return "break-word" /* BREAK_WORD */;
                case 'normal':
                default:
                    return "normal" /* NORMAL */;
            }
        }
    };

    var paddingForSide = function (side) { return ({
        name: "padding-" + side,
        initialValue: '0',
        prefix: false,
        type: 3 /* TYPE_VALUE */,
        format: 'length-percentage'
    }); };
    var paddingTop = paddingForSide('top');
    var paddingRight = paddingForSide('right');
    var paddingBottom = paddingForSide('bottom');
    var paddingLeft = paddingForSide('left');

    var TEXT_ALIGN;
    (function (TEXT_ALIGN) {
        TEXT_ALIGN[TEXT_ALIGN["LEFT"] = 0] = "LEFT";
        TEXT_ALIGN[TEXT_ALIGN["CENTER"] = 1] = "CENTER";
        TEXT_ALIGN[TEXT_ALIGN["RIGHT"] = 2] = "RIGHT";
    })(TEXT_ALIGN || (TEXT_ALIGN = {}));
    var textAlign = {
        name: 'text-align',
        initialValue: 'left',
        prefix: false,
        type: 2 /* IDENT_VALUE */,
        parse: function (_context, textAlign) {
            switch (textAlign) {
                case 'right':
                    return TEXT_ALIGN.RIGHT;
                case 'center':
                case 'justify':
                    return TEXT_ALIGN.CENTER;
                case 'left':
                default:
                    return TEXT_ALIGN.LEFT;
            }
        }
    };

    var POSITION;
    (function (POSITION) {
        POSITION[POSITION["STATIC"] = 0] = "STATIC";
        POSITION[POSITION["RELATIVE"] = 1] = "RELATIVE";
        POSITION[POSITION["ABSOLUTE"] = 2] = "ABSOLUTE";
        POSITION[POSITION["FIXED"] = 3] = "FIXED";
        POSITION[POSITION["STICKY"] = 4] = "STICKY";
    })(POSITION || (POSITION = {}));
    var position = {
        name: 'position',
        initialValue: 'static',
        prefix: false,
        type: 2 /* IDENT_VALUE */,
        parse: function (_context, position) {
            switch (position) {
                case 'relative':
                    return POSITION.RELATIVE;
                case 'absolute':
                    return POSITION.ABSOLUTE;
                case 'fixed':
                    return POSITION.FIXED;
                case 'sticky':
                    return POSITION.STICKY;
            }
            return POSITION.STATIC;
        }
    };

    var textShadow = {
        name: 'text-shadow',
        initialValue: 'none',
        type: 1 /* LIST */,
        prefix: false,
        parse: function (context, tokens) {
            if (tokens.length === 1 && isIdentWithValue(tokens[0], 'none')) {
                return [];
            }
            return parseFunctionArgs(tokens).map(function (values) {
                var shadow = {
                    color: COLORS.TRANSPARENT,
                    offsetX: ZERO_LENGTH,
                    offsetY: ZERO_LENGTH,
                    blur: ZERO_LENGTH
                };
                var c = 0;
                for (var i = 0; i < values.length; i++) {
                    var token = values[i];
                    if (isLength(token)) {
                        if (c === 0) {
                            shadow.offsetX = token;
                        }
                        else if (c === 1) {
                            shadow.offsetY = token;
                        }
                        else {
                            shadow.blur = token;
                        }
                        c++;
                    }
                    else {
                        shadow.color = color$1.parse(context, token);
                    }
                }
                return shadow;
            });
        }
    };

    var TEXT_TRANSFORM;
    (function (TEXT_TRANSFORM) {
        TEXT_TRANSFORM[TEXT_TRANSFORM["NONE"] = 0] = "NONE";
        TEXT_TRANSFORM[TEXT_TRANSFORM["LOWERCASE"] = 1] = "LOWERCASE";
        TEXT_TRANSFORM[TEXT_TRANSFORM["UPPERCASE"] = 2] = "UPPERCASE";
        TEXT_TRANSFORM[TEXT_TRANSFORM["CAPITALIZE"] = 3] = "CAPITALIZE";
    })(TEXT_TRANSFORM || (TEXT_TRANSFORM = {}));
    var textTransform = {
        name: 'text-transform',
        initialValue: 'none',
        prefix: false,
        type: 2 /* IDENT_VALUE */,
        parse: function (_context, textTransform) {
            switch (textTransform) {
                case 'uppercase':
                    return TEXT_TRANSFORM.UPPERCASE;
                case 'lowercase':
                    return TEXT_TRANSFORM.LOWERCASE;
                case 'capitalize':
                    return TEXT_TRANSFORM.CAPITALIZE;
            }
            return TEXT_TRANSFORM.NONE;
        }
    };

    var transform$1 = {
        name: 'transform',
        initialValue: 'none',
        prefix: true,
        type: 0 /* VALUE */,
        parse: function (_context, token) {
            if (token.type === 20 /* IDENT_TOKEN */ && token.value === 'none') {
                return null;
            }
            if (token.type === 18 /* FUNCTION */) {
                var transformFunction = SUPPORTED_TRANSFORM_FUNCTIONS[token.name];
                if (typeof transformFunction === 'undefined') {
                    throw new Error("Attempting to parse an unsupported transform function \"" + token.name + "\"");
                }
                return transformFunction(token.values);
            }
            return null;
        }
    };
    var matrix = function (args) {
        var values = args.filter(function (arg) { return arg.type === 17 /* NUMBER_TOKEN */; }).map(function (arg) { return arg.number; });
        return values.length === 6 ? values : null;
    };
    // doesn't support 3D transforms at the moment
    var matrix3d = function (args) {
        var values = args.filter(function (arg) { return arg.type === 17 /* NUMBER_TOKEN */; }).map(function (arg) { return arg.number; });
        var a1 = values[0], b1 = values[1]; values[2]; values[3]; var a2 = values[4], b2 = values[5]; values[6]; values[7]; values[8]; values[9]; values[10]; values[11]; var a4 = values[12], b4 = values[13]; values[14]; values[15];
        return values.length === 16 ? [a1, b1, a2, b2, a4, b4] : null;
    };
    var SUPPORTED_TRANSFORM_FUNCTIONS = {
        matrix: matrix,
        matrix3d: matrix3d
    };

    var DEFAULT_VALUE = {
        type: 16 /* PERCENTAGE_TOKEN */,
        number: 50,
        flags: FLAG_INTEGER
    };
    var DEFAULT = [DEFAULT_VALUE, DEFAULT_VALUE];
    var transformOrigin = {
        name: 'transform-origin',
        initialValue: '50% 50%',
        prefix: true,
        type: 1 /* LIST */,
        parse: function (_context, tokens) {
            var origins = tokens.filter(isLengthPercentage);
            if (origins.length !== 2) {
                return DEFAULT;
            }
            return [origins[0], origins[1]];
        }
    };

    var VISIBILITY;
    (function (VISIBILITY) {
        VISIBILITY[VISIBILITY["VISIBLE"] = 0] = "VISIBLE";
        VISIBILITY[VISIBILITY["HIDDEN"] = 1] = "HIDDEN";
        VISIBILITY[VISIBILITY["COLLAPSE"] = 2] = "COLLAPSE";
    })(VISIBILITY || (VISIBILITY = {}));
    var visibility = {
        name: 'visible',
        initialValue: 'none',
        prefix: false,
        type: 2 /* IDENT_VALUE */,
        parse: function (_context, visibility) {
            switch (visibility) {
                case 'hidden':
                    return VISIBILITY.HIDDEN;
                case 'collapse':
                    return VISIBILITY.COLLAPSE;
                case 'visible':
                default:
                    return VISIBILITY.VISIBLE;
            }
        }
    };

    var WORD_BREAK;
    (function (WORD_BREAK) {
        WORD_BREAK["NORMAL"] = "normal";
        WORD_BREAK["BREAK_ALL"] = "break-all";
        WORD_BREAK["KEEP_ALL"] = "keep-all";
    })(WORD_BREAK || (WORD_BREAK = {}));
    var wordBreak = {
        name: 'word-break',
        initialValue: 'normal',
        prefix: false,
        type: 2 /* IDENT_VALUE */,
        parse: function (_context, wordBreak) {
            switch (wordBreak) {
                case 'break-all':
                    return WORD_BREAK.BREAK_ALL;
                case 'keep-all':
                    return WORD_BREAK.KEEP_ALL;
                case 'normal':
                default:
                    return WORD_BREAK.NORMAL;
            }
        }
    };

    var zIndex = {
        name: 'z-index',
        initialValue: 'auto',
        prefix: false,
        type: 0 /* VALUE */,
        parse: function (_context, token) {
            if (token.type === 20 /* IDENT_TOKEN */) {
                return { auto: true, order: 0 };
            }
            if (isNumberToken(token)) {
                return { auto: false, order: token.number };
            }
            throw new Error("Invalid z-index number parsed");
        }
    };

    var time = {
        name: 'time',
        parse: function (_context, value) {
            if (value.type === 15 /* DIMENSION_TOKEN */) {
                switch (value.unit.toLowerCase()) {
                    case 's':
                        return 1000 * value.number;
                    case 'ms':
                        return value.number;
                }
            }
            throw new Error("Unsupported time type");
        }
    };

    var opacity = {
        name: 'opacity',
        initialValue: '1',
        type: 0 /* VALUE */,
        prefix: false,
        parse: function (_context, token) {
            if (isNumberToken(token)) {
                return token.number;
            }
            return 1;
        }
    };

    var textDecorationColor = {
        name: "text-decoration-color",
        initialValue: 'transparent',
        prefix: false,
        type: 3 /* TYPE_VALUE */,
        format: 'color'
    };

    var textDecorationLine = {
        name: 'text-decoration-line',
        initialValue: 'none',
        prefix: false,
        type: 1 /* LIST */,
        parse: function (_context, tokens) {
            return tokens
                .filter(isIdentToken)
                .map(function (token) {
                switch (token.value) {
                    case 'underline':
                        return 1 /* UNDERLINE */;
                    case 'overline':
                        return 2 /* OVERLINE */;
                    case 'line-through':
                        return 3 /* LINE_THROUGH */;
                    case 'none':
                        return 4 /* BLINK */;
                }
                return 0 /* NONE */;
            })
                .filter(function (line) { return line !== 0 /* NONE */; });
        }
    };

    var fontFamily = {
        name: "font-family",
        initialValue: '',
        prefix: false,
        type: 1 /* LIST */,
        parse: function (_context, tokens) {
            var accumulator = [];
            var results = [];
            tokens.forEach(function (token) {
                switch (token.type) {
                    case 20 /* IDENT_TOKEN */:
                    case 0 /* STRING_TOKEN */:
                        accumulator.push(token.value);
                        break;
                    case 17 /* NUMBER_TOKEN */:
                        accumulator.push(token.number.toString());
                        break;
                    case 4 /* COMMA_TOKEN */:
                        results.push(accumulator.join(' '));
                        accumulator.length = 0;
                        break;
                }
            });
            if (accumulator.length) {
                results.push(accumulator.join(' '));
            }
            return results.map(function (result) { return (result.indexOf(' ') === -1 ? result : "'" + result + "'"); });
        }
    };

    var fontSize = {
        name: "font-size",
        initialValue: '0',
        prefix: false,
        type: 3 /* TYPE_VALUE */,
        format: 'length'
    };

    var fontWeight = {
        name: 'font-weight',
        initialValue: 'normal',
        type: 0 /* VALUE */,
        prefix: false,
        parse: function (_context, token) {
            if (isNumberToken(token)) {
                return token.number;
            }
            if (isIdentToken(token)) {
                switch (token.value) {
                    case 'bold':
                        return 700;
                    case 'normal':
                    default:
                        return 400;
                }
            }
            return 400;
        }
    };

    var fontVariant = {
        name: 'font-variant',
        initialValue: 'none',
        type: 1 /* LIST */,
        prefix: false,
        parse: function (_context, tokens) {
            return tokens.filter(isIdentToken).map(function (token) { return token.value; });
        }
    };

    var FONT_STYLE;
    (function (FONT_STYLE) {
        FONT_STYLE["NORMAL"] = "normal";
        FONT_STYLE["ITALIC"] = "italic";
        FONT_STYLE["OBLIQUE"] = "oblique";
    })(FONT_STYLE || (FONT_STYLE = {}));
    var fontStyle = {
        name: 'font-style',
        initialValue: 'normal',
        prefix: false,
        type: 2 /* IDENT_VALUE */,
        parse: function (_context, overflow) {
            switch (overflow) {
                case 'oblique':
                    return FONT_STYLE.OBLIQUE;
                case 'italic':
                    return FONT_STYLE.ITALIC;
                case 'normal':
                default:
                    return FONT_STYLE.NORMAL;
            }
        }
    };

    var contains = function (bit, value) { return (bit & value) !== 0; };

    var content = {
        name: 'content',
        initialValue: 'none',
        type: 1 /* LIST */,
        prefix: false,
        parse: function (_context, tokens) {
            if (tokens.length === 0) {
                return [];
            }
            var first = tokens[0];
            if (first.type === 20 /* IDENT_TOKEN */ && first.value === 'none') {
                return [];
            }
            return tokens;
        }
    };

    var counterIncrement = {
        name: 'counter-increment',
        initialValue: 'none',
        prefix: true,
        type: 1 /* LIST */,
        parse: function (_context, tokens) {
            if (tokens.length === 0) {
                return null;
            }
            var first = tokens[0];
            if (first.type === 20 /* IDENT_TOKEN */ && first.value === 'none') {
                return null;
            }
            var increments = [];
            var filtered = tokens.filter(nonWhiteSpace);
            for (var i = 0; i < filtered.length; i++) {
                var counter = filtered[i];
                var next = filtered[i + 1];
                if (counter.type === 20 /* IDENT_TOKEN */) {
                    var increment = next && isNumberToken(next) ? next.number : 1;
                    increments.push({ counter: counter.value, increment: increment });
                }
            }
            return increments;
        }
    };

    var counterReset = {
        name: 'counter-reset',
        initialValue: 'none',
        prefix: true,
        type: 1 /* LIST */,
        parse: function (_context, tokens) {
            if (tokens.length === 0) {
                return [];
            }
            var resets = [];
            var filtered = tokens.filter(nonWhiteSpace);
            for (var i = 0; i < filtered.length; i++) {
                var counter = filtered[i];
                var next = filtered[i + 1];
                if (isIdentToken(counter) && counter.value !== 'none') {
                    var reset = next && isNumberToken(next) ? next.number : 0;
                    resets.push({ counter: counter.value, reset: reset });
                }
            }
            return resets;
        }
    };

    var duration = {
        name: 'duration',
        initialValue: '0s',
        prefix: false,
        type: 1 /* LIST */,
        parse: function (context, tokens) {
            return tokens.filter(isDimensionToken).map(function (token) { return time.parse(context, token); });
        }
    };

    var quotes = {
        name: 'quotes',
        initialValue: 'none',
        prefix: true,
        type: 1 /* LIST */,
        parse: function (_context, tokens) {
            if (tokens.length === 0) {
                return null;
            }
            var first = tokens[0];
            if (first.type === 20 /* IDENT_TOKEN */ && first.value === 'none') {
                return null;
            }
            var quotes = [];
            var filtered = tokens.filter(isStringToken);
            if (filtered.length % 2 !== 0) {
                return null;
            }
            for (var i = 0; i < filtered.length; i += 2) {
                var open_1 = filtered[i].value;
                var close_1 = filtered[i + 1].value;
                quotes.push({ open: open_1, close: close_1 });
            }
            return quotes;
        }
    };
    var getQuote = function (quotes, depth, open) {
        if (!quotes) {
            return '';
        }
        var quote = quotes[Math.min(depth, quotes.length - 1)];
        if (!quote) {
            return '';
        }
        return open ? quote.open : quote.close;
    };

    var boxShadow = {
        name: 'box-shadow',
        initialValue: 'none',
        type: 1 /* LIST */,
        prefix: false,
        parse: function (context, tokens) {
            if (tokens.length === 1 && isIdentWithValue(tokens[0], 'none')) {
                return [];
            }
            return parseFunctionArgs(tokens).map(function (values) {
                var shadow = {
                    color: 0x000000ff,
                    offsetX: ZERO_LENGTH,
                    offsetY: ZERO_LENGTH,
                    blur: ZERO_LENGTH,
                    spread: ZERO_LENGTH,
                    inset: false
                };
                var c = 0;
                for (var i = 0; i < values.length; i++) {
                    var token = values[i];
                    if (isIdentWithValue(token, 'inset')) {
                        shadow.inset = true;
                    }
                    else if (isLength(token)) {
                        if (c === 0) {
                            shadow.offsetX = token;
                        }
                        else if (c === 1) {
                            shadow.offsetY = token;
                        }
                        else if (c === 2) {
                            shadow.blur = token;
                        }
                        else {
                            shadow.spread = token;
                        }
                        c++;
                    }
                    else {
                        shadow.color = color$1.parse(context, token);
                    }
                }
                return shadow;
            });
        }
    };

    var PAINT_ORDER_LAYER;
    (function (PAINT_ORDER_LAYER) {
        PAINT_ORDER_LAYER[PAINT_ORDER_LAYER["FILL"] = 0] = "FILL";
        PAINT_ORDER_LAYER[PAINT_ORDER_LAYER["STROKE"] = 1] = "STROKE";
        PAINT_ORDER_LAYER[PAINT_ORDER_LAYER["MARKERS"] = 2] = "MARKERS";
    })(PAINT_ORDER_LAYER || (PAINT_ORDER_LAYER = {}));
    var paintOrder = {
        name: 'paint-order',
        initialValue: 'normal',
        prefix: false,
        type: 1 /* LIST */,
        parse: function (_context, tokens) {
            var DEFAULT_VALUE = [PAINT_ORDER_LAYER.FILL, PAINT_ORDER_LAYER.STROKE, PAINT_ORDER_LAYER.MARKERS];
            var layers = [];
            tokens.filter(isIdentToken).forEach(function (token) {
                switch (token.value) {
                    case 'stroke':
                        layers.push(PAINT_ORDER_LAYER.STROKE);
                        break;
                    case 'fill':
                        layers.push(PAINT_ORDER_LAYER.FILL);
                        break;
                    case 'markers':
                        layers.push(PAINT_ORDER_LAYER.MARKERS);
                        break;
                }
            });
            DEFAULT_VALUE.forEach(function (value) {
                if (layers.indexOf(value) === -1) {
                    layers.push(value);
                }
            });
            return layers;
        }
    };

    var webkitTextStrokeColor = {
        name: "-webkit-text-stroke-color",
        initialValue: 'currentcolor',
        prefix: false,
        type: 3 /* TYPE_VALUE */,
        format: 'color'
    };

    var webkitTextStrokeWidth = {
        name: "-webkit-text-stroke-width",
        initialValue: '0',
        type: 0 /* VALUE */,
        prefix: false,
        parse: function (_context, token) {
            if (isDimensionToken(token)) {
                return token.number;
            }
            return 0;
        }
    };

    var CSSParsedDeclaration = /** @class */ (function () {
        function CSSParsedDeclaration(context, declaration) {
            var _a, _b;
            this.animationDuration = parse(context, duration, declaration.animationDuration);
            this.backgroundClip = parse(context, backgroundClip, declaration.backgroundClip);
            this.backgroundColor = parse(context, backgroundColor, declaration.backgroundColor);
            this.backgroundImage = parse(context, backgroundImage, declaration.backgroundImage);
            this.backgroundOrigin = parse(context, backgroundOrigin, declaration.backgroundOrigin);
            this.backgroundPosition = parse(context, backgroundPosition, declaration.backgroundPosition);
            this.backgroundRepeat = parse(context, backgroundRepeat, declaration.backgroundRepeat);
            this.backgroundSize = parse(context, backgroundSize, declaration.backgroundSize);
            this.borderTopColor = parse(context, borderTopColor, declaration.borderTopColor);
            this.borderRightColor = parse(context, borderRightColor, declaration.borderRightColor);
            this.borderBottomColor = parse(context, borderBottomColor, declaration.borderBottomColor);
            this.borderLeftColor = parse(context, borderLeftColor, declaration.borderLeftColor);
            this.borderTopLeftRadius = parse(context, borderTopLeftRadius, declaration.borderTopLeftRadius);
            this.borderTopRightRadius = parse(context, borderTopRightRadius, declaration.borderTopRightRadius);
            this.borderBottomRightRadius = parse(context, borderBottomRightRadius, declaration.borderBottomRightRadius);
            this.borderBottomLeftRadius = parse(context, borderBottomLeftRadius, declaration.borderBottomLeftRadius);
            this.borderTopStyle = parse(context, borderTopStyle, declaration.borderTopStyle);
            this.borderRightStyle = parse(context, borderRightStyle, declaration.borderRightStyle);
            this.borderBottomStyle = parse(context, borderBottomStyle, declaration.borderBottomStyle);
            this.borderLeftStyle = parse(context, borderLeftStyle, declaration.borderLeftStyle);
            this.borderTopWidth = parse(context, borderTopWidth, declaration.borderTopWidth);
            this.borderRightWidth = parse(context, borderRightWidth, declaration.borderRightWidth);
            this.borderBottomWidth = parse(context, borderBottomWidth, declaration.borderBottomWidth);
            this.borderLeftWidth = parse(context, borderLeftWidth, declaration.borderLeftWidth);
            this.boxShadow = parse(context, boxShadow, declaration.boxShadow);
            this.color = parse(context, color, declaration.color);
            this.direction = parse(context, direction, declaration.direction);
            this.display = parse(context, display, declaration.display);
            this.float = parse(context, float, declaration.cssFloat);
            this.fontFamily = parse(context, fontFamily, declaration.fontFamily);
            this.fontSize = parse(context, fontSize, declaration.fontSize);
            this.fontStyle = parse(context, fontStyle, declaration.fontStyle);
            this.fontVariant = parse(context, fontVariant, declaration.fontVariant);
            this.fontWeight = parse(context, fontWeight, declaration.fontWeight);
            this.letterSpacing = parse(context, letterSpacing, declaration.letterSpacing);
            this.lineBreak = parse(context, lineBreak, declaration.lineBreak);
            this.lineHeight = parse(context, lineHeight, declaration.lineHeight);
            this.listStyleImage = parse(context, listStyleImage, declaration.listStyleImage);
            this.listStylePosition = parse(context, listStylePosition, declaration.listStylePosition);
            this.listStyleType = parse(context, listStyleType, declaration.listStyleType);
            this.marginTop = parse(context, marginTop, declaration.marginTop);
            this.marginRight = parse(context, marginRight, declaration.marginRight);
            this.marginBottom = parse(context, marginBottom, declaration.marginBottom);
            this.marginLeft = parse(context, marginLeft, declaration.marginLeft);
            this.opacity = parse(context, opacity, declaration.opacity);
            var overflowTuple = parse(context, overflow, declaration.overflow);
            this.overflowX = overflowTuple[0];
            this.overflowY = overflowTuple[overflowTuple.length > 1 ? 1 : 0];
            this.overflowWrap = parse(context, overflowWrap, declaration.overflowWrap);
            this.paddingTop = parse(context, paddingTop, declaration.paddingTop);
            this.paddingRight = parse(context, paddingRight, declaration.paddingRight);
            this.paddingBottom = parse(context, paddingBottom, declaration.paddingBottom);
            this.paddingLeft = parse(context, paddingLeft, declaration.paddingLeft);
            this.paintOrder = parse(context, paintOrder, declaration.paintOrder);
            this.position = parse(context, position, declaration.position);
            this.textAlign = parse(context, textAlign, declaration.textAlign);
            this.textDecorationColor = parse(context, textDecorationColor, (_a = declaration.textDecorationColor) !== null && _a !== void 0 ? _a : declaration.color);
            this.textDecorationLine = parse(context, textDecorationLine, (_b = declaration.textDecorationLine) !== null && _b !== void 0 ? _b : declaration.textDecoration);
            this.textShadow = parse(context, textShadow, declaration.textShadow);
            this.textTransform = parse(context, textTransform, declaration.textTransform);
            this.transform = parse(context, transform$1, declaration.transform);
            this.transformOrigin = parse(context, transformOrigin, declaration.transformOrigin);
            this.visibility = parse(context, visibility, declaration.visibility);
            this.webkitTextStrokeColor = parse(context, webkitTextStrokeColor, declaration.webkitTextStrokeColor);
            this.webkitTextStrokeWidth = parse(context, webkitTextStrokeWidth, declaration.webkitTextStrokeWidth);
            this.wordBreak = parse(context, wordBreak, declaration.wordBreak);
            this.zIndex = parse(context, zIndex, declaration.zIndex);
        }
        CSSParsedDeclaration.prototype.isVisible = function () {
            return this.display > 0 && this.opacity > 0 && this.visibility === VISIBILITY.VISIBLE;
        };
        CSSParsedDeclaration.prototype.isTransparent = function () {
            return isTransparent(this.backgroundColor);
        };
        CSSParsedDeclaration.prototype.isTransformed = function () {
            return this.transform !== null;
        };
        CSSParsedDeclaration.prototype.isPositioned = function () {
            return this.position !== POSITION.STATIC;
        };
        CSSParsedDeclaration.prototype.isPositionedWithZIndex = function () {
            return this.isPositioned() && !this.zIndex.auto;
        };
        CSSParsedDeclaration.prototype.isFloating = function () {
            return this.float !== FLOAT.NONE;
        };
        CSSParsedDeclaration.prototype.isInlineLevel = function () {
            return (contains(this.display, 4 /* INLINE */) ||
                contains(this.display, 33554432 /* INLINE_BLOCK */) ||
                contains(this.display, 268435456 /* INLINE_FLEX */) ||
                contains(this.display, 536870912 /* INLINE_GRID */) ||
                contains(this.display, 67108864 /* INLINE_LIST_ITEM */) ||
                contains(this.display, 134217728 /* INLINE_TABLE */));
        };
        return CSSParsedDeclaration;
    }());
    var CSSParsedPseudoDeclaration = /** @class */ (function () {
        function CSSParsedPseudoDeclaration(context, declaration) {
            this.content = parse(context, content, declaration.content);
            this.quotes = parse(context, quotes, declaration.quotes);
        }
        return CSSParsedPseudoDeclaration;
    }());
    var CSSParsedCounterDeclaration = /** @class */ (function () {
        function CSSParsedCounterDeclaration(context, declaration) {
            this.counterIncrement = parse(context, counterIncrement, declaration.counterIncrement);
            this.counterReset = parse(context, counterReset, declaration.counterReset);
        }
        return CSSParsedCounterDeclaration;
    }());
    // eslint-disable-next-line @typescript-eslint/no-explicit-any
    var parse = function (context, descriptor, style) {
        var tokenizer = new Tokenizer();
        var value = style !== null && typeof style !== 'undefined' ? style.toString() : descriptor.initialValue;
        tokenizer.write(value);
        var parser = new Parser(tokenizer.read());
        switch (descriptor.type) {
            case 2 /* IDENT_VALUE */:
                var token = parser.parseComponentValue();
                return descriptor.parse(context, isIdentToken(token) ? token.value : descriptor.initialValue);
            case 0 /* VALUE */:
                return descriptor.parse(context, parser.parseComponentValue());
            case 1 /* LIST */:
                return descriptor.parse(context, parser.parseComponentValues());
            case 4 /* TOKEN_VALUE */:
                return parser.parseComponentValue();
            case 3 /* TYPE_VALUE */:
                switch (descriptor.format) {
                    case 'angle':
                        return angle.parse(context, parser.parseComponentValue());
                    case 'color':
                        return color$1.parse(context, parser.parseComponentValue());
                    case 'image':
                        return image.parse(context, parser.parseComponentValue());
                    case 'length':
                        var length_1 = parser.parseComponentValue();
                        return isLength(length_1) ? length_1 : ZERO_LENGTH;
                    case 'length-percentage':
                        var value_1 = parser.parseComponentValue();
                        return isLengthPercentage(value_1) ? value_1 : ZERO_LENGTH;
                    case 'time':
                        return time.parse(context, parser.parseComponentValue());
                }
                break;
        }
    };

    var elementDebuggerAttribute = 'data-html2canvas-debug';
    var getElementDebugType = function (element) {
        var attribute = element.getAttribute(elementDebuggerAttribute);
        switch (attribute) {
            case 'all':
                return 1 /* ALL */;
            case 'clone':
                return 2 /* CLONE */;
            case 'parse':
                return 3 /* PARSE */;
            case 'render':
                return 4 /* RENDER */;
            default:
                return 0 /* NONE */;
        }
    };
    var isDebugging = function (element, type) {
        var elementType = getElementDebugType(element);
        return elementType === 1 /* ALL */ || type === elementType;
    };

    var ElementContainer = /** @class */ (function () {
        function ElementContainer(context, element) {
            this.context = context;
            this.textNodes = [];
            this.elements = [];
            this.flags = 0;
            if (isDebugging(element, 3 /* PARSE */)) {
                debugger;
            }
            this.styles = new CSSParsedDeclaration(context, window.getComputedStyle(element, null));
            if (isHTMLElementNode(element)) {
                if (this.styles.animationDuration.some(function (duration) { return duration > 0; })) {
                    element.style.animationDuration = '0s';
                }
                if (this.styles.transform !== null) {
                    // getBoundingClientRect takes transforms into account
                    element.style.transform = 'none';
                }
            }
            this.bounds = parseBounds(this.context, element);
            if (isDebugging(element, 4 /* RENDER */)) {
                this.flags |= 16 /* DEBUG_RENDER */;
            }
        }
        return ElementContainer;
    }());

    /*
     * text-segmentation 1.0.2 <https://github.com/niklasvh/text-segmentation>
     * Copyright (c) 2021 Niklas von Hertzen <https://hertzen.com>
     * Released under MIT License
     */
    var base64 = 'AAAAAAAAAAAAEA4AGBkAAFAaAAACAAAAAAAIABAAGAAwADgACAAQAAgAEAAIABAACAAQAAgAEAAIABAACAAQAAgAEAAIABAAQABIAEQATAAIABAACAAQAAgAEAAIABAAVABcAAgAEAAIABAACAAQAGAAaABwAHgAgACIAI4AlgAIABAAmwCjAKgAsAC2AL4AvQDFAMoA0gBPAVYBWgEIAAgACACMANoAYgFkAWwBdAF8AX0BhQGNAZUBlgGeAaMBlQGWAasBswF8AbsBwwF0AcsBYwHTAQgA2wG/AOMBdAF8AekB8QF0AfkB+wHiAHQBfAEIAAMC5gQIAAsCEgIIAAgAFgIeAggAIgIpAggAMQI5AkACygEIAAgASAJQAlgCYAIIAAgACAAKBQoFCgUTBRMFGQUrBSsFCAAIAAgACAAIAAgACAAIAAgACABdAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABoAmgCrwGvAQgAbgJ2AggAHgEIAAgACADnAXsCCAAIAAgAgwIIAAgACAAIAAgACACKAggAkQKZAggAPADJAAgAoQKkAqwCsgK6AsICCADJAggA0AIIAAgACAAIANYC3gIIAAgACAAIAAgACABAAOYCCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAkASoB+QIEAAgACAA8AEMCCABCBQgACABJBVAFCAAIAAgACAAIAAgACAAIAAgACABTBVoFCAAIAFoFCABfBWUFCAAIAAgACAAIAAgAbQUIAAgACAAIAAgACABzBXsFfQWFBYoFigWKBZEFigWKBYoFmAWfBaYFrgWxBbkFCAAIAAgACAAIAAgACAAIAAgACAAIAMEFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAMgFCADQBQgACAAIAAgACAAIAAgACAAIAAgACAAIAO4CCAAIAAgAiQAIAAgACABAAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAD0AggACAD8AggACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIANYFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAMDvwAIAAgAJAIIAAgACAAIAAgACAAIAAgACwMTAwgACAB9BOsEGwMjAwgAKwMyAwsFYgE3A/MEPwMIAEUDTQNRAwgAWQOsAGEDCAAIAAgACAAIAAgACABpAzQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFIQUoBSwFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABtAwgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABMAEwACAAIAAgACAAIABgACAAIAAgACAC/AAgACAAyAQgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACAAIAAwAAgACAAIAAgACAAIAAgACAAIAAAARABIAAgACAAIABQASAAIAAgAIABwAEAAjgCIABsAqAC2AL0AigDQAtwC+IJIQqVAZUBWQqVAZUBlQGVAZUBlQGrC5UBlQGVAZUBlQGVAZUBlQGVAXsKlQGVAbAK6wsrDGUMpQzlDJUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAfAKAAuZA64AtwCJALoC6ADwAAgAuACgA/oEpgO6AqsD+AAIAAgAswMIAAgACAAIAIkAuwP5AfsBwwPLAwgACAAIAAgACADRA9kDCAAIAOED6QMIAAgACAAIAAgACADuA/YDCAAIAP4DyQAIAAgABgQIAAgAXQAOBAgACAAIAAgACAAIABMECAAIAAgACAAIAAgACAD8AAQBCAAIAAgAGgQiBCoECAExBAgAEAEIAAgACAAIAAgACAAIAAgACAAIAAgACAA4BAgACABABEYECAAIAAgATAQYAQgAVAQIAAgACAAIAAgACAAIAAgACAAIAFoECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAOQEIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAB+BAcACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAEABhgSMBAgACAAIAAgAlAQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAwAEAAQABAADAAMAAwADAAQABAAEAAQABAAEAAQABHATAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAdQMIAAgACAAIAAgACAAIAMkACAAIAAgAfQMIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACFA4kDCAAIAAgACAAIAOcBCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAIcDCAAIAAgACAAIAAgACAAIAAgACAAIAJEDCAAIAAgACADFAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABgBAgAZgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAbAQCBXIECAAIAHkECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABAAJwEQACjBKoEsgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAC6BMIECAAIAAgACAAIAAgACABmBAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAxwQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAGYECAAIAAgAzgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBd0FXwUIAOIF6gXxBYoF3gT5BQAGCAaKBYoFigWKBYoFigWKBYoFigWKBYoFigXWBIoFigWKBYoFigWKBYoFigWKBYsFEAaKBYoFigWKBYoFigWKBRQGCACKBYoFigWKBQgACAAIANEECAAIABgGigUgBggAJgYIAC4GMwaKBYoF0wQ3Bj4GigWKBYoFigWKBYoFigWKBYoFigWKBYoFigUIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWLBf///////wQABAAEAAQABAAEAAQABAAEAAQAAwAEAAQAAgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAQADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUAAAAFAAUAAAAFAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAQAAAAUABQAFAAUABQAFAAAAAAAFAAUAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAFAAUAAQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAAABwAHAAcAAAAHAAcABwAFAAEAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAcABwAFAAUAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAQABAAAAAAAAAAAAAAAFAAUABQAFAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAHAAcAAAAHAAcAAAAAAAUABQAHAAUAAQAHAAEABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwABAAUABQAFAAUAAAAAAAAAAAAAAAEAAQABAAEAAQABAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABQANAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAABQAHAAUABQAFAAAAAAAAAAcABQAFAAUABQAFAAQABAAEAAQABAAEAAQABAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUAAAAFAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAUAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAcABwAFAAcABwAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUABwAHAAUABQAFAAUAAAAAAAcABwAAAAAABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAAAAAAAAAAABQAFAAAAAAAFAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAFAAUABQAFAAUAAAAFAAUABwAAAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABwAFAAUABQAFAAAAAAAHAAcAAAAAAAcABwAFAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAAAAAAAAAHAAcABwAAAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAUABQAFAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAHAAcABQAHAAcAAAAFAAcABwAAAAcABwAFAAUAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAFAAcABwAFAAUABQAAAAUAAAAHAAcABwAHAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAHAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUAAAAFAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAUAAAAFAAUAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABwAFAAUABQAFAAUABQAAAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABQAFAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAFAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAHAAUABQAFAAUABQAFAAUABwAHAAcABwAHAAcABwAHAAUABwAHAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABwAHAAcABwAFAAUABwAHAAcAAAAAAAAAAAAHAAcABQAHAAcABwAHAAcABwAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAUABQAFAAUABQAFAAUAAAAFAAAABQAAAAAABQAFAAUABQAFAAUABQAFAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAUABQAFAAUABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABwAFAAcABwAHAAcABwAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAUABQAFAAUABwAHAAUABQAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABQAFAAcABwAHAAUABwAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAcABQAFAAUABQAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAAAAAABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAUABQAHAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAFAAUABQAFAAcABwAFAAUABwAHAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAcABwAFAAUABwAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABQAAAAAABQAFAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAcABwAAAAAAAAAAAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAcABwAFAAcABwAAAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAFAAUABQAAAAUABQAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABwAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAHAAcABQAHAAUABQAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAAABwAHAAAAAAAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAFAAUABwAFAAcABwAFAAcABQAFAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAAAAAABwAHAAcABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAFAAcABwAFAAUABQAFAAUABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAUABQAFAAcABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABQAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAAAAAAFAAUABwAHAAcABwAFAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAHAAUABQAFAAUABQAFAAUABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAABQAAAAUABQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAHAAcAAAAFAAUAAAAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABQAFAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAABQAFAAUABQAFAAUABQAAAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAFAAUABQAFAAUADgAOAA4ADgAOAA4ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAMAAwADAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkAAAAAAAAAAAAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAAAAAAAAAAAAsADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwACwAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAADgAOAA4AAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAAAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4AAAAOAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAAAAAAAAAAAA4AAAAOAAAAAAAAAAAADgAOAA4AAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAA=';

    /*
     * utrie 1.0.1 <https://github.com/niklasvh/utrie>
     * Copyright (c) 2021 Niklas von Hertzen <https://hertzen.com>
     * Released under MIT License
     */
    var chars$1 = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';
    // Use a lookup table to find the index.
    var lookup$1 = typeof Uint8Array === 'undefined' ? [] : new Uint8Array(256);
    for (var i$1 = 0; i$1 < chars$1.length; i$1++) {
        lookup$1[chars$1.charCodeAt(i$1)] = i$1;
    }
    var decode = function (base64) {
        var bufferLength = base64.length * 0.75, len = base64.length, i, p = 0, encoded1, encoded2, encoded3, encoded4;
        if (base64[base64.length - 1] === '=') {
            bufferLength--;
            if (base64[base64.length - 2] === '=') {
                bufferLength--;
            }
        }
        var buffer = typeof ArrayBuffer !== 'undefined' &&
            typeof Uint8Array !== 'undefined' &&
            typeof Uint8Array.prototype.slice !== 'undefined'
            ? new ArrayBuffer(bufferLength)
            : new Array(bufferLength);
        var bytes = Array.isArray(buffer) ? buffer : new Uint8Array(buffer);
        for (i = 0; i < len; i += 4) {
            encoded1 = lookup$1[base64.charCodeAt(i)];
            encoded2 = lookup$1[base64.charCodeAt(i + 1)];
            encoded3 = lookup$1[base64.charCodeAt(i + 2)];
            encoded4 = lookup$1[base64.charCodeAt(i + 3)];
            bytes[p++] = (encoded1 << 2) | (encoded2 >> 4);
            bytes[p++] = ((encoded2 & 15) << 4) | (encoded3 >> 2);
            bytes[p++] = ((encoded3 & 3) << 6) | (encoded4 & 63);
        }
        return buffer;
    };
    var polyUint16Array = function (buffer) {
        var length = buffer.length;
        var bytes = [];
        for (var i = 0; i < length; i += 2) {
            bytes.push((buffer[i + 1] << 8) | buffer[i]);
        }
        return bytes;
    };
    var polyUint32Array = function (buffer) {
        var length = buffer.length;
        var bytes = [];
        for (var i = 0; i < length; i += 4) {
            bytes.push((buffer[i + 3] << 24) | (buffer[i + 2] << 16) | (buffer[i + 1] << 8) | buffer[i]);
        }
        return bytes;
    };

    /** Shift size for getting the index-2 table offset. */
    var UTRIE2_SHIFT_2 = 5;
    /** Shift size for getting the index-1 table offset. */
    var UTRIE2_SHIFT_1 = 6 + 5;
    /**
     * Shift size for shifting left the index array values.
     * Increases possible data size with 16-bit index values at the cost
     * of compactability.
     * This requires data blocks to be aligned by UTRIE2_DATA_GRANULARITY.
     */
    var UTRIE2_INDEX_SHIFT = 2;
    /**
     * Difference between the two shift sizes,
     * for getting an index-1 offset from an index-2 offset. 6=11-5
     */
    var UTRIE2_SHIFT_1_2 = UTRIE2_SHIFT_1 - UTRIE2_SHIFT_2;
    /**
     * The part of the index-2 table for U+D800..U+DBFF stores values for
     * lead surrogate code _units_ not code _points_.
     * Values for lead surrogate code _points_ are indexed with this portion of the table.
     * Length=32=0x20=0x400>>UTRIE2_SHIFT_2. (There are 1024=0x400 lead surrogates.)
     */
    var UTRIE2_LSCP_INDEX_2_OFFSET = 0x10000 >> UTRIE2_SHIFT_2;
    /** Number of entries in a data block. 32=0x20 */
    var UTRIE2_DATA_BLOCK_LENGTH = 1 << UTRIE2_SHIFT_2;
    /** Mask for getting the lower bits for the in-data-block offset. */
    var UTRIE2_DATA_MASK = UTRIE2_DATA_BLOCK_LENGTH - 1;
    var UTRIE2_LSCP_INDEX_2_LENGTH = 0x400 >> UTRIE2_SHIFT_2;
    /** Count the lengths of both BMP pieces. 2080=0x820 */
    var UTRIE2_INDEX_2_BMP_LENGTH = UTRIE2_LSCP_INDEX_2_OFFSET + UTRIE2_LSCP_INDEX_2_LENGTH;
    /**
     * The 2-byte UTF-8 version of the index-2 table follows at offset 2080=0x820.
     * Length 32=0x20 for lead bytes C0..DF, regardless of UTRIE2_SHIFT_2.
     */
    var UTRIE2_UTF8_2B_INDEX_2_OFFSET = UTRIE2_INDEX_2_BMP_LENGTH;
    var UTRIE2_UTF8_2B_INDEX_2_LENGTH = 0x800 >> 6; /* U+0800 is the first code point after 2-byte UTF-8 */
    /**
     * The index-1 table, only used for supplementary code points, at offset 2112=0x840.
     * Variable length, for code points up to highStart, where the last single-value range starts.
     * Maximum length 512=0x200=0x100000>>UTRIE2_SHIFT_1.
     * (For 0x100000 supplementary code points U+10000..U+10ffff.)
     *
     * The part of the index-2 table for supplementary code points starts
     * after this index-1 table.
     *
     * Both the index-1 table and the following part of the index-2 table
     * are omitted completely if there is only BMP data.
     */
    var UTRIE2_INDEX_1_OFFSET = UTRIE2_UTF8_2B_INDEX_2_OFFSET + UTRIE2_UTF8_2B_INDEX_2_LENGTH;
    /**
     * Number of index-1 entries for the BMP. 32=0x20
     * This part of the index-1 table is omitted from the serialized form.
     */
    var UTRIE2_OMITTED_BMP_INDEX_1_LENGTH = 0x10000 >> UTRIE2_SHIFT_1;
    /** Number of entries in an index-2 block. 64=0x40 */
    var UTRIE2_INDEX_2_BLOCK_LENGTH = 1 << UTRIE2_SHIFT_1_2;
    /** Mask for getting the lower bits for the in-index-2-block offset. */
    var UTRIE2_INDEX_2_MASK = UTRIE2_INDEX_2_BLOCK_LENGTH - 1;
    var slice16 = function (view, start, end) {
        if (view.slice) {
            return view.slice(start, end);
        }
        return new Uint16Array(Array.prototype.slice.call(view, start, end));
    };
    var slice32 = function (view, start, end) {
        if (view.slice) {
            return view.slice(start, end);
        }
        return new Uint32Array(Array.prototype.slice.call(view, start, end));
    };
    var createTrieFromBase64 = function (base64, _byteLength) {
        var buffer = decode(base64);
        var view32 = Array.isArray(buffer) ? polyUint32Array(buffer) : new Uint32Array(buffer);
        var view16 = Array.isArray(buffer) ? polyUint16Array(buffer) : new Uint16Array(buffer);
        var headerLength = 24;
        var index = slice16(view16, headerLength / 2, view32[4] / 2);
        var data = view32[5] === 2
            ? slice16(view16, (headerLength + view32[4]) / 2)
            : slice32(view32, Math.ceil((headerLength + view32[4]) / 4));
        return new Trie(view32[0], view32[1], view32[2], view32[3], index, data);
    };
    var Trie = /** @class */ (function () {
        function Trie(initialValue, errorValue, highStart, highValueIndex, index, data) {
            this.initialValue = initialValue;
            this.errorValue = errorValue;
            this.highStart = highStart;
            this.highValueIndex = highValueIndex;
            this.index = index;
            this.data = data;
        }
        /**
         * Get the value for a code point as stored in the Trie.
         *
         * @param codePoint the code point
         * @return the value
         */
        Trie.prototype.get = function (codePoint) {
            var ix;
            if (codePoint >= 0) {
                if (codePoint < 0x0d800 || (codePoint > 0x0dbff && codePoint <= 0x0ffff)) {
                    // Ordinary BMP code point, excluding leading surrogates.
                    // BMP uses a single level lookup.  BMP index starts at offset 0 in the Trie2 index.
                    // 16 bit data is stored in the index array itself.
                    ix = this.index[codePoint >> UTRIE2_SHIFT_2];
                    ix = (ix << UTRIE2_INDEX_SHIFT) + (codePoint & UTRIE2_DATA_MASK);
                    return this.data[ix];
                }
                if (codePoint <= 0xffff) {
                    // Lead Surrogate Code Point.  A Separate index section is stored for
                    // lead surrogate code units and code points.
                    //   The main index has the code unit data.
                    //   For this function, we need the code point data.
                    // Note: this expression could be refactored for slightly improved efficiency, but
                    //       surrogate code points will be so rare in practice that it's not worth it.
                    ix = this.index[UTRIE2_LSCP_INDEX_2_OFFSET + ((codePoint - 0xd800) >> UTRIE2_SHIFT_2)];
                    ix = (ix << UTRIE2_INDEX_SHIFT) + (codePoint & UTRIE2_DATA_MASK);
                    return this.data[ix];
                }
                if (codePoint < this.highStart) {
                    // Supplemental code point, use two-level lookup.
                    ix = UTRIE2_INDEX_1_OFFSET - UTRIE2_OMITTED_BMP_INDEX_1_LENGTH + (codePoint >> UTRIE2_SHIFT_1);
                    ix = this.index[ix];
                    ix += (codePoint >> UTRIE2_SHIFT_2) & UTRIE2_INDEX_2_MASK;
                    ix = this.index[ix];
                    ix = (ix << UTRIE2_INDEX_SHIFT) + (codePoint & UTRIE2_DATA_MASK);
                    return this.data[ix];
                }
                if (codePoint <= 0x10ffff) {
                    return this.data[this.highValueIndex];
                }
            }
            // Fall through.  The code point is outside of the legal range of 0..0x10ffff.
            return this.errorValue;
        };
        return Trie;
    }());

    /*
     * base64-arraybuffer 1.0.1 <https://github.com/niklasvh/base64-arraybuffer>
     * Copyright (c) 2021 Niklas von Hertzen <https://hertzen.com>
     * Released under MIT License
     */
    var chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';
    // Use a lookup table to find the index.
    var lookup = typeof Uint8Array === 'undefined' ? [] : new Uint8Array(256);
    for (var i = 0; i < chars.length; i++) {
        lookup[chars.charCodeAt(i)] = i;
    }

    var Prepend = 1;
    var CR = 2;
    var LF = 3;
    var Control = 4;
    var Extend = 5;
    var SpacingMark = 7;
    var L = 8;
    var V = 9;
    var T = 10;
    var LV = 11;
    var LVT = 12;
    var ZWJ = 13;
    var Extended_Pictographic = 14;
    var RI = 15;
    var toCodePoints = function (str) {
        var codePoints = [];
        var i = 0;
        var length = str.length;
        while (i < length) {
            var value = str.charCodeAt(i++);
            if (value >= 0xd800 && value <= 0xdbff && i < length) {
                var extra = str.charCodeAt(i++);
                if ((extra & 0xfc00) === 0xdc00) {
                    codePoints.push(((value & 0x3ff) << 10) + (extra & 0x3ff) + 0x10000);
                }
                else {
                    codePoints.push(value);
                    i--;
                }
            }
            else {
                codePoints.push(value);
            }
        }
        return codePoints;
    };
    var fromCodePoint = function () {
        var codePoints = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            codePoints[_i] = arguments[_i];
        }
        if (String.fromCodePoint) {
            return String.fromCodePoint.apply(String, codePoints);
        }
        var length = codePoints.length;
        if (!length) {
            return '';
        }
        var codeUnits = [];
        var index = -1;
        var result = '';
        while (++index < length) {
            var codePoint = codePoints[index];
            if (codePoint <= 0xffff) {
                codeUnits.push(codePoint);
            }
            else {
                codePoint -= 0x10000;
                codeUnits.push((codePoint >> 10) + 0xd800, (codePoint % 0x400) + 0xdc00);
            }
            if (index + 1 === length || codeUnits.length > 0x4000) {
                result += String.fromCharCode.apply(String, codeUnits);
                codeUnits.length = 0;
            }
        }
        return result;
    };
    var UnicodeTrie = createTrieFromBase64(base64);
    var BREAK_NOT_ALLOWED = '×';
    var BREAK_ALLOWED = '÷';
    var codePointToClass = function (codePoint) { return UnicodeTrie.get(codePoint); };
    var _graphemeBreakAtIndex = function (_codePoints, classTypes, index) {
        var prevIndex = index - 2;
        var prev = classTypes[prevIndex];
        var current = classTypes[index - 1];
        var next = classTypes[index];
        // GB3 Do not break between a CR and LF
        if (current === CR && next === LF) {
            return BREAK_NOT_ALLOWED;
        }
        // GB4 Otherwise, break before and after controls.
        if (current === CR || current === LF || current === Control) {
            return BREAK_ALLOWED;
        }
        // GB5
        if (next === CR || next === LF || next === Control) {
            return BREAK_ALLOWED;
        }
        // Do not break Hangul syllable sequences.
        // GB6
        if (current === L && [L, V, LV, LVT].indexOf(next) !== -1) {
            return BREAK_NOT_ALLOWED;
        }
        // GB7
        if ((current === LV || current === V) && (next === V || next === T)) {
            return BREAK_NOT_ALLOWED;
        }
        // GB8
        if ((current === LVT || current === T) && next === T) {
            return BREAK_NOT_ALLOWED;
        }
        // GB9 Do not break before extending characters or ZWJ.
        if (next === ZWJ || next === Extend) {
            return BREAK_NOT_ALLOWED;
        }
        // Do not break before SpacingMarks, or after Prepend characters.
        // GB9a
        if (next === SpacingMark) {
            return BREAK_NOT_ALLOWED;
        }
        // GB9a
        if (current === Prepend) {
            return BREAK_NOT_ALLOWED;
        }
        // GB11 Do not break within emoji modifier sequences or emoji zwj sequences.
        if (current === ZWJ && next === Extended_Pictographic) {
            while (prev === Extend) {
                prev = classTypes[--prevIndex];
            }
            if (prev === Extended_Pictographic) {
                return BREAK_NOT_ALLOWED;
            }
        }
        // GB12 Do not break within emoji flag sequences.
        // That is, do not break between regional indicator (RI) symbols
        // if there is an odd number of RI characters before the break point.
        if (current === RI && next === RI) {
            var countRI = 0;
            while (prev === RI) {
                countRI++;
                prev = classTypes[--prevIndex];
            }
            if (countRI % 2 === 0) {
                return BREAK_NOT_ALLOWED;
            }
        }
        return BREAK_ALLOWED;
    };
    var GraphemeBreaker = function (str) {
        var codePoints = toCodePoints(str);
        var length = codePoints.length;
        var index = 0;
        var lastEnd = 0;
        var classTypes = codePoints.map(codePointToClass);
        return {
            next: function () {
                if (index >= length) {
                    return { done: true, value: null };
                }
                var graphemeBreak = BREAK_NOT_ALLOWED;
                while (index < length &&
                    (graphemeBreak = _graphemeBreakAtIndex(codePoints, classTypes, ++index)) === BREAK_NOT_ALLOWED) { }
                if (graphemeBreak !== BREAK_NOT_ALLOWED || index === length) {
                    var value = fromCodePoint.apply(null, codePoints.slice(lastEnd, index));
                    lastEnd = index;
                    return { value: value, done: false };
                }
                return { done: true, value: null };
            },
        };
    };
    var splitGraphemes = function (str) {
        var breaker = GraphemeBreaker(str);
        var graphemes = [];
        var bk;
        while (!(bk = breaker.next()).done) {
            if (bk.value) {
                graphemes.push(bk.value.slice());
            }
        }
        return graphemes;
    };

    var testRangeBounds = function (document) {
        var TEST_HEIGHT = 123;
        if (document.createRange) {
            var range = document.createRange();
            if (range.getBoundingClientRect) {
                var testElement = document.createElement('boundtest');
                testElement.style.height = TEST_HEIGHT + "px";
                testElement.style.display = 'block';
                document.body.appendChild(testElement);
                range.selectNode(testElement);
                var rangeBounds = range.getBoundingClientRect();
                var rangeHeight = Math.round(rangeBounds.height);
                document.body.removeChild(testElement);
                if (rangeHeight === TEST_HEIGHT) {
                    return true;
                }
            }
        }
        return false;
    };
    var testIOSLineBreak = function (document) {
        var testElement = document.createElement('boundtest');
        testElement.style.width = '50px';
        testElement.style.display = 'block';
        testElement.style.fontSize = '12px';
        testElement.style.letterSpacing = '0px';
        testElement.style.wordSpacing = '0px';
        document.body.appendChild(testElement);
        var range = document.createRange();
        testElement.innerHTML = typeof ''.repeat === 'function' ? '&#128104;'.repeat(10) : '';
        var node = testElement.firstChild;
        var textList = toCodePoints$1(node.data).map(function (i) { return fromCodePoint$1(i); });
        var offset = 0;
        var prev = {};
        // ios 13 does not handle range getBoundingClientRect line changes correctly #2177
        var supports = textList.every(function (text, i) {
            range.setStart(node, offset);
            range.setEnd(node, offset + text.length);
            var rect = range.getBoundingClientRect();
            offset += text.length;
            var boundAhead = rect.x > prev.x || rect.y > prev.y;
            prev = rect;
            if (i === 0) {
                return true;
            }
            return boundAhead;
        });
        document.body.removeChild(testElement);
        return supports;
    };
    var testCORS = function () { return typeof new Image().crossOrigin !== 'undefined'; };
    var testResponseType = function () { return typeof new XMLHttpRequest().responseType === 'string'; };
    var testSVG = function (document) {
        var img = new Image();
        var canvas = document.createElement('canvas');
        var ctx = canvas.getContext('2d');
        if (!ctx) {
            return false;
        }
        img.src = "data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";
        try {
            ctx.drawImage(img, 0, 0);
            canvas.toDataURL();
        }
        catch (e) {
            return false;
        }
        return true;
    };
    var isGreenPixel = function (data) {
        return data[0] === 0 && data[1] === 255 && data[2] === 0 && data[3] === 255;
    };
    var testForeignObject = function (document) {
        var canvas = document.createElement('canvas');
        var size = 100;
        canvas.width = size;
        canvas.height = size;
        var ctx = canvas.getContext('2d');
        if (!ctx) {
            return Promise.reject(false);
        }
        ctx.fillStyle = 'rgb(0, 255, 0)';
        ctx.fillRect(0, 0, size, size);
        var img = new Image();
        var greenImageSrc = canvas.toDataURL();
        img.src = greenImageSrc;
        var svg = createForeignObjectSVG(size, size, 0, 0, img);
        ctx.fillStyle = 'red';
        ctx.fillRect(0, 0, size, size);
        return loadSerializedSVG$1(svg)
            .then(function (img) {
            ctx.drawImage(img, 0, 0);
            var data = ctx.getImageData(0, 0, size, size).data;
            ctx.fillStyle = 'red';
            ctx.fillRect(0, 0, size, size);
            var node = document.createElement('div');
            node.style.backgroundImage = "url(" + greenImageSrc + ")";
            node.style.height = size + "px";
            // Firefox 55 does not render inline <img /> tags
            return isGreenPixel(data)
                ? loadSerializedSVG$1(createForeignObjectSVG(size, size, 0, 0, node))
                : Promise.reject(false);
        })
            .then(function (img) {
            ctx.drawImage(img, 0, 0);
            // Edge does not render background-images
            return isGreenPixel(ctx.getImageData(0, 0, size, size).data);
        })
            .catch(function () { return false; });
    };
    var createForeignObjectSVG = function (width, height, x, y, node) {
        var xmlns = 'http://www.w3.org/2000/svg';
        var svg = document.createElementNS(xmlns, 'svg');
        var foreignObject = document.createElementNS(xmlns, 'foreignObject');
        svg.setAttributeNS(null, 'width', width.toString());
        svg.setAttributeNS(null, 'height', height.toString());
        foreignObject.setAttributeNS(null, 'width', '100%');
        foreignObject.setAttributeNS(null, 'height', '100%');
        foreignObject.setAttributeNS(null, 'x', x.toString());
        foreignObject.setAttributeNS(null, 'y', y.toString());
        foreignObject.setAttributeNS(null, 'externalResourcesRequired', 'true');
        svg.appendChild(foreignObject);
        foreignObject.appendChild(node);
        return svg;
    };
    var loadSerializedSVG$1 = function (svg) {
        return new Promise(function (resolve, reject) {
            var img = new Image();
            img.onload = function () { return resolve(img); };
            img.onerror = reject;
            img.src = "data:image/svg+xml;charset=utf-8," + encodeURIComponent(new XMLSerializer().serializeToString(svg));
        });
    };
    var FEATURES = {
        get SUPPORT_RANGE_BOUNDS() {
            var value = testRangeBounds(document);
            Object.defineProperty(FEATURES, 'SUPPORT_RANGE_BOUNDS', { value: value });
            return value;
        },
        get SUPPORT_WORD_BREAKING() {
            var value = FEATURES.SUPPORT_RANGE_BOUNDS && testIOSLineBreak(document);
            Object.defineProperty(FEATURES, 'SUPPORT_WORD_BREAKING', { value: value });
            return value;
        },
        get SUPPORT_SVG_DRAWING() {
            var value = testSVG(document);
            Object.defineProperty(FEATURES, 'SUPPORT_SVG_DRAWING', { value: value });
            return value;
        },
        get SUPPORT_FOREIGNOBJECT_DRAWING() {
            var value = typeof Array.from === 'function' && typeof window.fetch === 'function'
                ? testForeignObject(document)
                : Promise.resolve(false);
            Object.defineProperty(FEATURES, 'SUPPORT_FOREIGNOBJECT_DRAWING', { value: value });
            return value;
        },
        get SUPPORT_CORS_IMAGES() {
            var value = testCORS();
            Object.defineProperty(FEATURES, 'SUPPORT_CORS_IMAGES', { value: value });
            return value;
        },
        get SUPPORT_RESPONSE_TYPE() {
            var value = testResponseType();
            Object.defineProperty(FEATURES, 'SUPPORT_RESPONSE_TYPE', { value: value });
            return value;
        },
        get SUPPORT_CORS_XHR() {
            var value = 'withCredentials' in new XMLHttpRequest();
            Object.defineProperty(FEATURES, 'SUPPORT_CORS_XHR', { value: value });
            return value;
        }
    };

    var TextBounds = /** @class */ (function () {
        function TextBounds(text, bounds) {
            this.text = text;
            this.bounds = bounds;
        }
        return TextBounds;
    }());
    var parseTextBounds = function (context, value, styles, node) {
        var textList = breakText(value, styles);
        var textBounds = [];
        var offset = 0;
        textList.forEach(function (text) {
            if (styles.textDecorationLine.length || text.trim().length > 0) {
                if (FEATURES.SUPPORT_RANGE_BOUNDS) {
                    if (!FEATURES.SUPPORT_WORD_BREAKING) {
                        textBounds.push(new TextBounds(text, Bounds.fromDOMRectList(context, createRange(node, offset, text.length).getClientRects())));
                    }
                    else {
                        textBounds.push(new TextBounds(text, getRangeBounds(context, node, offset, text.length)));
                    }
                }
                else {
                    var replacementNode = node.splitText(text.length);
                    textBounds.push(new TextBounds(text, getWrapperBounds(context, node)));
                    node = replacementNode;
                }
            }
            else if (!FEATURES.SUPPORT_RANGE_BOUNDS) {
                node = node.splitText(text.length);
            }
            offset += text.length;
        });
        return textBounds;
    };
    var getWrapperBounds = function (context, node) {
        var ownerDocument = node.ownerDocument;
        if (ownerDocument) {
            var wrapper = ownerDocument.createElement('html2canvaswrapper');
            wrapper.appendChild(node.cloneNode(true));
            var parentNode = node.parentNode;
            if (parentNode) {
                parentNode.replaceChild(wrapper, node);
                var bounds = parseBounds(context, wrapper);
                if (wrapper.firstChild) {
                    parentNode.replaceChild(wrapper.firstChild, wrapper);
                }
                return bounds;
            }
        }
        return Bounds.EMPTY;
    };
    var createRange = function (node, offset, length) {
        var ownerDocument = node.ownerDocument;
        if (!ownerDocument) {
            throw new Error('Node has no owner document');
        }
        var range = ownerDocument.createRange();
        range.setStart(node, offset);
        range.setEnd(node, offset + length);
        return range;
    };
    var getRangeBounds = function (context, node, offset, length) {
        return Bounds.fromClientRect(context, createRange(node, offset, length).getBoundingClientRect());
    };
    var breakText = function (value, styles) {
        return styles.letterSpacing !== 0 ? splitGraphemes(value) : breakWords(value, styles);
    };
    // https://drafts.csswg.org/css-text/#word-separator
    var wordSeparators = [0x0020, 0x00a0, 0x1361, 0x10100, 0x10101, 0x1039, 0x1091];
    var breakWords = function (str, styles) {
        var breaker = LineBreaker(str, {
            lineBreak: styles.lineBreak,
            wordBreak: styles.overflowWrap === "break-word" /* BREAK_WORD */ ? 'break-word' : styles.wordBreak
        });
        var words = [];
        var bk;
        var _loop_1 = function () {
            if (bk.value) {
                var value = bk.value.slice();
                var codePoints = toCodePoints$1(value);
                var word_1 = '';
                codePoints.forEach(function (codePoint) {
                    if (wordSeparators.indexOf(codePoint) === -1) {
                        word_1 += fromCodePoint$1(codePoint);
                    }
                    else {
                        if (word_1.length) {
                            words.push(word_1);
                        }
                        words.push(fromCodePoint$1(codePoint));
                        word_1 = '';
                    }
                });
                if (word_1.length) {
                    words.push(word_1);
                }
            }
        };
        while (!(bk = breaker.next()).done) {
            _loop_1();
        }
        return words;
    };

    var TextContainer = /** @class */ (function () {
        function TextContainer(context, node, styles) {
            this.text = transform(node.data, styles.textTransform);
            this.textBounds = parseTextBounds(context, this.text, styles, node);
        }
        return TextContainer;
    }());
    var transform = function (text, transform) {
        switch (transform) {
            case TEXT_TRANSFORM.LOWERCASE:
                return text.toLowerCase();
            case TEXT_TRANSFORM.CAPITALIZE:
                return text.replace(CAPITALIZE, capitalize);
            case TEXT_TRANSFORM.UPPERCASE:
                return text.toUpperCase();
            default:
                return text;
        }
    };
    var CAPITALIZE = /(^|\s|:|-|\(|\))([a-z])/g;
    var capitalize = function (m, p1, p2) {
        if (m.length > 0) {
            return p1 + p2.toUpperCase();
        }
        return m;
    };

    var ImageElementContainer = /** @class */ (function (_super) {
        __extends(ImageElementContainer, _super);
        function ImageElementContainer(context, img) {
            var _this = _super.call(this, context, img) || this;
            _this.src = img.currentSrc || img.src;
            _this.intrinsicWidth = img.naturalWidth;
            _this.intrinsicHeight = img.naturalHeight;
            _this.context.cache.addImage(_this.src);
            return _this;
        }
        return ImageElementContainer;
    }(ElementContainer));

    var CanvasElementContainer = /** @class */ (function (_super) {
        __extends(CanvasElementContainer, _super);
        function CanvasElementContainer(context, canvas) {
            var _this = _super.call(this, context, canvas) || this;
            _this.canvas = canvas;
            _this.intrinsicWidth = canvas.width;
            _this.intrinsicHeight = canvas.height;
            return _this;
        }
        return CanvasElementContainer;
    }(ElementContainer));

    var SVGElementContainer = /** @class */ (function (_super) {
        __extends(SVGElementContainer, _super);
        function SVGElementContainer(context, img) {
            var _this = _super.call(this, context, img) || this;
            var s = new XMLSerializer();
            var bounds = parseBounds(context, img);
            img.setAttribute('width', bounds.width + "px");
            img.setAttribute('height', bounds.height + "px");
            _this.svg = "data:image/svg+xml," + encodeURIComponent(s.serializeToString(img));
            _this.intrinsicWidth = img.width.baseVal.value;
            _this.intrinsicHeight = img.height.baseVal.value;
            _this.context.cache.addImage(_this.svg);
            return _this;
        }
        return SVGElementContainer;
    }(ElementContainer));

    var LIElementContainer = /** @class */ (function (_super) {
        __extends(LIElementContainer, _super);
        function LIElementContainer(context, element) {
            var _this = _super.call(this, context, element) || this;
            _this.value = element.value;
            return _this;
        }
        return LIElementContainer;
    }(ElementContainer));

    var OLElementContainer = /** @class */ (function (_super) {
        __extends(OLElementContainer, _super);
        function OLElementContainer(context, element) {
            var _this = _super.call(this, context, element) || this;
            _this.start = element.start;
            _this.reversed = typeof element.reversed === 'boolean' && element.reversed === true;
            return _this;
        }
        return OLElementContainer;
    }(ElementContainer));

    var CHECKBOX_BORDER_RADIUS = [
        {
            type: 15 /* DIMENSION_TOKEN */,
            flags: 0,
            unit: 'px',
            number: 3
        }
    ];
    var RADIO_BORDER_RADIUS = [
        {
            type: 16 /* PERCENTAGE_TOKEN */,
            flags: 0,
            number: 50
        }
    ];
    var reformatInputBounds = function (bounds) {
        if (bounds.width > bounds.height) {
            return new Bounds(bounds.left + (bounds.width - bounds.height) / 2, bounds.top, bounds.height, bounds.height);
        }
        else if (bounds.width < bounds.height) {
            return new Bounds(bounds.left, bounds.top + (bounds.height - bounds.width) / 2, bounds.width, bounds.width);
        }
        return bounds;
    };
    var getInputValue = function (node) {
        var value = node.type === PASSWORD ? new Array(node.value.length + 1).join('\u2022') : node.value;
        return value.length === 0 ? node.placeholder || '' : value;
    };
    var CHECKBOX = 'checkbox';
    var RADIO = 'radio';
    var PASSWORD = 'password';
    var INPUT_COLOR = 0x2a2a2aff;
    var InputElementContainer = /** @class */ (function (_super) {
        __extends(InputElementContainer, _super);
        function InputElementContainer(context, input) {
            var _this = _super.call(this, context, input) || this;
            _this.type = input.type.toLowerCase();
            _this.checked = input.checked;
            _this.value = getInputValue(input);
            if (_this.type === CHECKBOX || _this.type === RADIO) {
                _this.styles.backgroundColor = 0xdededeff;
                _this.styles.borderTopColor =
                    _this.styles.borderRightColor =
                        _this.styles.borderBottomColor =
                            _this.styles.borderLeftColor =
                                0xa5a5a5ff;
                _this.styles.borderTopWidth =
                    _this.styles.borderRightWidth =
                        _this.styles.borderBottomWidth =
                            _this.styles.borderLeftWidth =
                                1;
                _this.styles.borderTopStyle =
                    _this.styles.borderRightStyle =
                        _this.styles.borderBottomStyle =
                            _this.styles.borderLeftStyle =
                                BORDER_STYLE.SOLID;
                _this.styles.backgroundClip = [BACKGROUND_CLIP.BORDER_BOX];
                _this.styles.backgroundOrigin = [0 /* BORDER_BOX */];
                _this.bounds = reformatInputBounds(_this.bounds);
            }
            switch (_this.type) {
                case CHECKBOX:
                    _this.styles.borderTopRightRadius =
                        _this.styles.borderTopLeftRadius =
                            _this.styles.borderBottomRightRadius =
                                _this.styles.borderBottomLeftRadius =
                                    CHECKBOX_BORDER_RADIUS;
                    break;
                case RADIO:
                    _this.styles.borderTopRightRadius =
                        _this.styles.borderTopLeftRadius =
                            _this.styles.borderBottomRightRadius =
                                _this.styles.borderBottomLeftRadius =
                                    RADIO_BORDER_RADIUS;
                    break;
            }
            return _this;
        }
        return InputElementContainer;
    }(ElementContainer));

    var SelectElementContainer = /** @class */ (function (_super) {
        __extends(SelectElementContainer, _super);
        function SelectElementContainer(context, element) {
            var _this = _super.call(this, context, element) || this;
            var option = element.options[element.selectedIndex || 0];
            _this.value = option ? option.text || '' : '';
            return _this;
        }
        return SelectElementContainer;
    }(ElementContainer));

    var TextareaElementContainer = /** @class */ (function (_super) {
        __extends(TextareaElementContainer, _super);
        function TextareaElementContainer(context, element) {
            var _this = _super.call(this, context, element) || this;
            _this.value = element.value;
            return _this;
        }
        return TextareaElementContainer;
    }(ElementContainer));

    var IFrameElementContainer = /** @class */ (function (_super) {
        __extends(IFrameElementContainer, _super);
        function IFrameElementContainer(context, iframe) {
            var _this = _super.call(this, context, iframe) || this;
            _this.src = iframe.src;
            _this.width = parseInt(iframe.width, 10) || 0;
            _this.height = parseInt(iframe.height, 10) || 0;
            _this.backgroundColor = _this.styles.backgroundColor;
            try {
                if (iframe.contentWindow &&
                    iframe.contentWindow.document &&
                    iframe.contentWindow.document.documentElement) {
                    _this.tree = parseTree(context, iframe.contentWindow.document.documentElement);
                    // http://www.w3.org/TR/css3-background/#special-backgrounds
                    var documentBackgroundColor = iframe.contentWindow.document.documentElement
                        ? parseColor(context, getComputedStyle(iframe.contentWindow.document.documentElement).backgroundColor)
                        : COLORS.TRANSPARENT;
                    var bodyBackgroundColor = iframe.contentWindow.document.body
                        ? parseColor(context, getComputedStyle(iframe.contentWindow.document.body).backgroundColor)
                        : COLORS.TRANSPARENT;
                    _this.backgroundColor = isTransparent(documentBackgroundColor)
                        ? isTransparent(bodyBackgroundColor)
                            ? _this.styles.backgroundColor
                            : bodyBackgroundColor
                        : documentBackgroundColor;
                }
            }
            catch (e) { }
            return _this;
        }
        return IFrameElementContainer;
    }(ElementContainer));

    var LIST_OWNERS = ['OL', 'UL', 'MENU'];
    var parseNodeTree = function (context, node, parent, root) {
        for (var childNode = node.firstChild, nextNode = void 0; childNode; childNode = nextNode) {
            nextNode = childNode.nextSibling;
            if (isTextNode(childNode) && childNode.data.trim().length > 0) {
                parent.textNodes.push(new TextContainer(context, childNode, parent.styles));
            }
            else if (isElementNode(childNode)) {
                if (isSlotElement(childNode) && childNode.assignedNodes) {
                    childNode.assignedNodes().forEach(function (childNode) { return parseNodeTree(context, childNode, parent, root); });
                }
                else {
                    var container = createContainer(context, childNode);
                    if (container.styles.isVisible()) {
                        if (createsRealStackingContext(childNode, container, root)) {
                            container.flags |= 4 /* CREATES_REAL_STACKING_CONTEXT */;
                        }
                        else if (createsStackingContext(container.styles)) {
                            container.flags |= 2 /* CREATES_STACKING_CONTEXT */;
                        }
                        if (LIST_OWNERS.indexOf(childNode.tagName) !== -1) {
                            container.flags |= 8 /* IS_LIST_OWNER */;
                        }
                        parent.elements.push(container);
                        childNode.slot;
                        if (childNode.shadowRoot) {
                            parseNodeTree(context, childNode.shadowRoot, container, root);
                        }
                        else if (!isTextareaElement(childNode) &&
                            !isSVGElement(childNode) &&
                            !isSelectElement(childNode)) {
                            parseNodeTree(context, childNode, container, root);
                        }
                    }
                }
            }
        }
    };
    var createContainer = function (context, element) {
        if (isImageElement(element)) {
            return new ImageElementContainer(context, element);
        }
        if (isCanvasElement(element)) {
            return new CanvasElementContainer(context, element);
        }
        if (isSVGElement(element)) {
            return new SVGElementContainer(context, element);
        }
        if (isLIElement(element)) {
            return new LIElementContainer(context, element);
        }
        if (isOLElement(element)) {
            return new OLElementContainer(context, element);
        }
        if (isInputElement(element)) {
            return new InputElementContainer(context, element);
        }
        if (isSelectElement(element)) {
            return new SelectElementContainer(context, element);
        }
        if (isTextareaElement(element)) {
            return new TextareaElementContainer(context, element);
        }
        if (isIFrameElement(element)) {
            return new IFrameElementContainer(context, element);
        }
        return new ElementContainer(context, element);
    };
    var parseTree = function (context, element) {
        var container = createContainer(context, element);
        container.flags |= 4 /* CREATES_REAL_STACKING_CONTEXT */;
        parseNodeTree(context, element, container, container);
        return container;
    };
    var createsRealStackingContext = function (node, container, root) {
        return (container.styles.isPositionedWithZIndex() ||
            container.styles.opacity < 1 ||
            container.styles.isTransformed() ||
            (isBodyElement(node) && root.styles.isTransparent()));
    };
    var createsStackingContext = function (styles) { return styles.isPositioned() || styles.isFloating(); };
    var isTextNode = function (node) { return node.nodeType === Node.TEXT_NODE; };
    var isElementNode = function (node) { return node.nodeType === Node.ELEMENT_NODE; };
    var isHTMLElementNode = function (node) {
        return isElementNode(node) && typeof node.style !== 'undefined' && !isSVGElementNode(node);
    };
    var isSVGElementNode = function (element) {
        return typeof element.className === 'object';
    };
    var isLIElement = function (node) { return node.tagName === 'LI'; };
    var isOLElement = function (node) { return node.tagName === 'OL'; };
    var isInputElement = function (node) { return node.tagName === 'INPUT'; };
    var isHTMLElement = function (node) { return node.tagName === 'HTML'; };
    var isSVGElement = function (node) { return node.tagName === 'svg'; };
    var isBodyElement = function (node) { return node.tagName === 'BODY'; };
    var isCanvasElement = function (node) { return node.tagName === 'CANVAS'; };
    var isImageElement = function (node) { return node.tagName === 'IMG'; };
    var isIFrameElement = function (node) { return node.tagName === 'IFRAME'; };
    var isStyleElement = function (node) { return node.tagName === 'STYLE'; };
    var isScriptElement = function (node) { return node.tagName === 'SCRIPT'; };
    var isTextareaElement = function (node) { return node.tagName === 'TEXTAREA'; };
    var isSelectElement = function (node) { return node.tagName === 'SELECT'; };
    var isSlotElement = function (node) { return node.tagName === 'SLOT'; };

    var CounterState = /** @class */ (function () {
        function CounterState() {
            this.counters = {};
        }
        CounterState.prototype.getCounterValue = function (name) {
            var counter = this.counters[name];
            if (counter && counter.length) {
                return counter[counter.length - 1];
            }
            return 1;
        };
        CounterState.prototype.getCounterValues = function (name) {
            var counter = this.counters[name];
            return counter ? counter : [];
        };
        CounterState.prototype.pop = function (counters) {
            var _this = this;
            counters.forEach(function (counter) { return _this.counters[counter].pop(); });
        };
        CounterState.prototype.parse = function (style) {
            var _this = this;
            var counterIncrement = style.counterIncrement;
            var counterReset = style.counterReset;
            var canReset = true;
            if (counterIncrement !== null) {
                counterIncrement.forEach(function (entry) {
                    var counter = _this.counters[entry.counter];
                    if (counter && entry.increment !== 0) {
                        canReset = false;
                        if (!counter.length) {
                            counter.push(1);
                        }
                        counter[Math.max(0, counter.length - 1)] += entry.increment;
                    }
                });
            }
            var counterNames = [];
            if (canReset) {
                counterReset.forEach(function (entry) {
                    var counter = _this.counters[entry.counter];
                    counterNames.push(entry.counter);
                    if (!counter) {
                        counter = _this.counters[entry.counter] = [];
                    }
                    counter.push(entry.reset);
                });
            }
            return counterNames;
        };
        return CounterState;
    }());
    var ROMAN_UPPER = {
        integers: [1000, 900, 500, 400, 100, 90, 50, 40, 10, 9, 5, 4, 1],
        values: ['M', 'CM', 'D', 'CD', 'C', 'XC', 'L', 'XL', 'X', 'IX', 'V', 'IV', 'I']
    };
    var ARMENIAN = {
        integers: [
            9000, 8000, 7000, 6000, 5000, 4000, 3000, 2000, 1000, 900, 800, 700, 600, 500, 400, 300, 200, 100, 90, 80, 70,
            60, 50, 40, 30, 20, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1
        ],
        values: [
            'Ք',
            'Փ',
            'Ւ',
            'Ց',
            'Ր',
            'Տ',
            'Վ',
            'Ս',
            'Ռ',
            'Ջ',
            'Պ',
            'Չ',
            'Ո',
            'Շ',
            'Ն',
            'Յ',
            'Մ',
            'Ճ',
            'Ղ',
            'Ձ',
            'Հ',
            'Կ',
            'Ծ',
            'Խ',
            'Լ',
            'Ի',
            'Ժ',
            'Թ',
            'Ը',
            'Է',
            'Զ',
            'Ե',
            'Դ',
            'Գ',
            'Բ',
            'Ա'
        ]
    };
    var HEBREW = {
        integers: [
            10000, 9000, 8000, 7000, 6000, 5000, 4000, 3000, 2000, 1000, 400, 300, 200, 100, 90, 80, 70, 60, 50, 40, 30, 20,
            19, 18, 17, 16, 15, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1
        ],
        values: [
            'י׳',
            'ט׳',
            'ח׳',
            'ז׳',
            'ו׳',
            'ה׳',
            'ד׳',
            'ג׳',
            'ב׳',
            'א׳',
            'ת',
            'ש',
            'ר',
            'ק',
            'צ',
            'פ',
            'ע',
            'ס',
            'נ',
            'מ',
            'ל',
            'כ',
            'יט',
            'יח',
            'יז',
            'טז',
            'טו',
            'י',
            'ט',
            'ח',
            'ז',
            'ו',
            'ה',
            'ד',
            'ג',
            'ב',
            'א'
        ]
    };
    var GEORGIAN = {
        integers: [
            10000, 9000, 8000, 7000, 6000, 5000, 4000, 3000, 2000, 1000, 900, 800, 700, 600, 500, 400, 300, 200, 100, 90,
            80, 70, 60, 50, 40, 30, 20, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1
        ],
        values: [
            'ჵ',
            'ჰ',
            'ჯ',
            'ჴ',
            'ხ',
            'ჭ',
            'წ',
            'ძ',
            'ც',
            'ჩ',
            'შ',
            'ყ',
            'ღ',
            'ქ',
            'ფ',
            'ჳ',
            'ტ',
            'ს',
            'რ',
            'ჟ',
            'პ',
            'ო',
            'ჲ',
            'ნ',
            'მ',
            'ლ',
            'კ',
            'ი',
            'თ',
            'ჱ',
            'ზ',
            'ვ',
            'ე',
            'დ',
            'გ',
            'ბ',
            'ა'
        ]
    };
    var createAdditiveCounter = function (value, min, max, symbols, fallback, suffix) {
        if (value < min || value > max) {
            return createCounterText(value, fallback, suffix.length > 0);
        }
        return (symbols.integers.reduce(function (string, integer, index) {
            while (value >= integer) {
                value -= integer;
                string += symbols.values[index];
            }
            return string;
        }, '') + suffix);
    };
    var createCounterStyleWithSymbolResolver = function (value, codePointRangeLength, isNumeric, resolver) {
        var string = '';
        do {
            if (!isNumeric) {
                value--;
            }
            string = resolver(value) + string;
            value /= codePointRangeLength;
        } while (value * codePointRangeLength >= codePointRangeLength);
        return string;
    };
    var createCounterStyleFromRange = function (value, codePointRangeStart, codePointRangeEnd, isNumeric, suffix) {
        var codePointRangeLength = codePointRangeEnd - codePointRangeStart + 1;
        return ((value < 0 ? '-' : '') +
            (createCounterStyleWithSymbolResolver(Math.abs(value), codePointRangeLength, isNumeric, function (codePoint) {
                return fromCodePoint$1(Math.floor(codePoint % codePointRangeLength) + codePointRangeStart);
            }) +
                suffix));
    };
    var createCounterStyleFromSymbols = function (value, symbols, suffix) {
        if (suffix === void 0) { suffix = '. '; }
        var codePointRangeLength = symbols.length;
        return (createCounterStyleWithSymbolResolver(Math.abs(value), codePointRangeLength, false, function (codePoint) { return symbols[Math.floor(codePoint % codePointRangeLength)]; }) + suffix);
    };
    var CJK_ZEROS = 1 << 0;
    var CJK_TEN_COEFFICIENTS = 1 << 1;
    var CJK_TEN_HIGH_COEFFICIENTS = 1 << 2;
    var CJK_HUNDRED_COEFFICIENTS = 1 << 3;
    var createCJKCounter = function (value, numbers, multipliers, negativeSign, suffix, flags) {
        if (value < -9999 || value > 9999) {
            return createCounterText(value, LIST_STYLE_TYPE.CJK_DECIMAL, suffix.length > 0);
        }
        var tmp = Math.abs(value);
        var string = suffix;
        if (tmp === 0) {
            return numbers[0] + string;
        }
        for (var digit = 0; tmp > 0 && digit <= 4; digit++) {
            var coefficient = tmp % 10;
            if (coefficient === 0 && contains(flags, CJK_ZEROS) && string !== '') {
                string = numbers[coefficient] + string;
            }
            else if (coefficient > 1 ||
                (coefficient === 1 && digit === 0) ||
                (coefficient === 1 && digit === 1 && contains(flags, CJK_TEN_COEFFICIENTS)) ||
                (coefficient === 1 && digit === 1 && contains(flags, CJK_TEN_HIGH_COEFFICIENTS) && value > 100) ||
                (coefficient === 1 && digit > 1 && contains(flags, CJK_HUNDRED_COEFFICIENTS))) {
                string = numbers[coefficient] + (digit > 0 ? multipliers[digit - 1] : '') + string;
            }
            else if (coefficient === 1 && digit > 0) {
                string = multipliers[digit - 1] + string;
            }
            tmp = Math.floor(tmp / 10);
        }
        return (value < 0 ? negativeSign : '') + string;
    };
    var CHINESE_INFORMAL_MULTIPLIERS = '十百千萬';
    var CHINESE_FORMAL_MULTIPLIERS = '拾佰仟萬';
    var JAPANESE_NEGATIVE = 'マイナス';
    var KOREAN_NEGATIVE = '마이너스';
    var createCounterText = function (value, type, appendSuffix) {
        var defaultSuffix = appendSuffix ? '. ' : '';
        var cjkSuffix = appendSuffix ? '、' : '';
        var koreanSuffix = appendSuffix ? ', ' : '';
        var spaceSuffix = appendSuffix ? ' ' : '';
        switch (type) {
            case LIST_STYLE_TYPE.DISC:
                return '•' + spaceSuffix;
            case LIST_STYLE_TYPE.CIRCLE:
                return '◦' + spaceSuffix;
            case LIST_STYLE_TYPE.SQUARE:
                return '◾' + spaceSuffix;
            case LIST_STYLE_TYPE.DECIMAL_LEADING_ZERO:
                var string = createCounterStyleFromRange(value, 48, 57, true, defaultSuffix);
                return string.length < 4 ? "0" + string : string;
            case LIST_STYLE_TYPE.CJK_DECIMAL:
                return createCounterStyleFromSymbols(value, '〇一二三四五六七八九', cjkSuffix);
            case LIST_STYLE_TYPE.LOWER_ROMAN:
                return createAdditiveCounter(value, 1, 3999, ROMAN_UPPER, LIST_STYLE_TYPE.DECIMAL, defaultSuffix).toLowerCase();
            case LIST_STYLE_TYPE.UPPER_ROMAN:
                return createAdditiveCounter(value, 1, 3999, ROMAN_UPPER, LIST_STYLE_TYPE.DECIMAL, defaultSuffix);
            case LIST_STYLE_TYPE.LOWER_GREEK:
                return createCounterStyleFromRange(value, 945, 969, false, defaultSuffix);
            case LIST_STYLE_TYPE.LOWER_ALPHA:
                return createCounterStyleFromRange(value, 97, 122, false, defaultSuffix);
            case LIST_STYLE_TYPE.UPPER_ALPHA:
                return createCounterStyleFromRange(value, 65, 90, false, defaultSuffix);
            case LIST_STYLE_TYPE.ARABIC_INDIC:
                return createCounterStyleFromRange(value, 1632, 1641, true, defaultSuffix);
            case LIST_STYLE_TYPE.ARMENIAN:
            case LIST_STYLE_TYPE.UPPER_ARMENIAN:
                return createAdditiveCounter(value, 1, 9999, ARMENIAN, LIST_STYLE_TYPE.DECIMAL, defaultSuffix);
            case LIST_STYLE_TYPE.LOWER_ARMENIAN:
                return createAdditiveCounter(value, 1, 9999, ARMENIAN, LIST_STYLE_TYPE.DECIMAL, defaultSuffix).toLowerCase();
            case LIST_STYLE_TYPE.BENGALI:
                return createCounterStyleFromRange(value, 2534, 2543, true, defaultSuffix);
            case LIST_STYLE_TYPE.CAMBODIAN:
            case LIST_STYLE_TYPE.KHMER:
                return createCounterStyleFromRange(value, 6112, 6121, true, defaultSuffix);
            case LIST_STYLE_TYPE.CJK_EARTHLY_BRANCH:
                return createCounterStyleFromSymbols(value, '子丑寅卯辰巳午未申酉戌亥', cjkSuffix);
            case LIST_STYLE_TYPE.CJK_HEAVENLY_STEM:
                return createCounterStyleFromSymbols(value, '甲乙丙丁戊己庚辛壬癸', cjkSuffix);
            case LIST_STYLE_TYPE.CJK_IDEOGRAPHIC:
            case LIST_STYLE_TYPE.TRAD_CHINESE_INFORMAL:
                return createCJKCounter(value, '零一二三四五六七八九', CHINESE_INFORMAL_MULTIPLIERS, '負', cjkSuffix, CJK_TEN_COEFFICIENTS | CJK_TEN_HIGH_COEFFICIENTS | CJK_HUNDRED_COEFFICIENTS);
            case LIST_STYLE_TYPE.TRAD_CHINESE_FORMAL:
                return createCJKCounter(value, '零壹貳參肆伍陸柒捌玖', CHINESE_FORMAL_MULTIPLIERS, '負', cjkSuffix, CJK_ZEROS | CJK_TEN_COEFFICIENTS | CJK_TEN_HIGH_COEFFICIENTS | CJK_HUNDRED_COEFFICIENTS);
            case LIST_STYLE_TYPE.SIMP_CHINESE_INFORMAL:
                return createCJKCounter(value, '零一二三四五六七八九', CHINESE_INFORMAL_MULTIPLIERS, '负', cjkSuffix, CJK_TEN_COEFFICIENTS | CJK_TEN_HIGH_COEFFICIENTS | CJK_HUNDRED_COEFFICIENTS);
            case LIST_STYLE_TYPE.SIMP_CHINESE_FORMAL:
                return createCJKCounter(value, '零壹贰叁肆伍陆柒捌玖', CHINESE_FORMAL_MULTIPLIERS, '负', cjkSuffix, CJK_ZEROS | CJK_TEN_COEFFICIENTS | CJK_TEN_HIGH_COEFFICIENTS | CJK_HUNDRED_COEFFICIENTS);
            case LIST_STYLE_TYPE.JAPANESE_INFORMAL:
                return createCJKCounter(value, '〇一二三四五六七八九', '十百千万', JAPANESE_NEGATIVE, cjkSuffix, 0);
            case LIST_STYLE_TYPE.JAPANESE_FORMAL:
                return createCJKCounter(value, '零壱弐参四伍六七八九', '拾百千万', JAPANESE_NEGATIVE, cjkSuffix, CJK_ZEROS | CJK_TEN_COEFFICIENTS | CJK_TEN_HIGH_COEFFICIENTS);
            case LIST_STYLE_TYPE.KOREAN_HANGUL_FORMAL:
                return createCJKCounter(value, '영일이삼사오육칠팔구', '십백천만', KOREAN_NEGATIVE, koreanSuffix, CJK_ZEROS | CJK_TEN_COEFFICIENTS | CJK_TEN_HIGH_COEFFICIENTS);
            case LIST_STYLE_TYPE.KOREAN_HANJA_INFORMAL:
                return createCJKCounter(value, '零一二三四五六七八九', '十百千萬', KOREAN_NEGATIVE, koreanSuffix, 0);
            case LIST_STYLE_TYPE.KOREAN_HANJA_FORMAL:
                return createCJKCounter(value, '零壹貳參四五六七八九', '拾百千', KOREAN_NEGATIVE, koreanSuffix, CJK_ZEROS | CJK_TEN_COEFFICIENTS | CJK_TEN_HIGH_COEFFICIENTS);
            case LIST_STYLE_TYPE.DEVANAGARI:
                return createCounterStyleFromRange(value, 0x966, 0x96f, true, defaultSuffix);
            case LIST_STYLE_TYPE.GEORGIAN:
                return createAdditiveCounter(value, 1, 19999, GEORGIAN, LIST_STYLE_TYPE.DECIMAL, defaultSuffix);
            case LIST_STYLE_TYPE.GUJARATI:
                return createCounterStyleFromRange(value, 0xae6, 0xaef, true, defaultSuffix);
            case LIST_STYLE_TYPE.GURMUKHI:
                return createCounterStyleFromRange(value, 0xa66, 0xa6f, true, defaultSuffix);
            case LIST_STYLE_TYPE.HEBREW:
                return createAdditiveCounter(value, 1, 10999, HEBREW, LIST_STYLE_TYPE.DECIMAL, defaultSuffix);
            case LIST_STYLE_TYPE.HIRAGANA:
                return createCounterStyleFromSymbols(value, 'あいうえおかきくけこさしすせそたちつてとなにぬねのはひふへほまみむめもやゆよらりるれろわゐゑをん');
            case LIST_STYLE_TYPE.HIRAGANA_IROHA:
                return createCounterStyleFromSymbols(value, 'いろはにほへとちりぬるをわかよたれそつねならむうゐのおくやまけふこえてあさきゆめみしゑひもせす');
            case LIST_STYLE_TYPE.KANNADA:
                return createCounterStyleFromRange(value, 0xce6, 0xcef, true, defaultSuffix);
            case LIST_STYLE_TYPE.KATAKANA:
                return createCounterStyleFromSymbols(value, 'アイウエオカキクケコサシスセソタチツテトナニヌネノハヒフヘホマミムメモヤユヨラリルレロワヰヱヲン', cjkSuffix);
            case LIST_STYLE_TYPE.KATAKANA_IROHA:
                return createCounterStyleFromSymbols(value, 'イロハニホヘトチリヌルヲワカヨタレソツネナラムウヰノオクヤマケフコエテアサキユメミシヱヒモセス', cjkSuffix);
            case LIST_STYLE_TYPE.LAO:
                return createCounterStyleFromRange(value, 0xed0, 0xed9, true, defaultSuffix);
            case LIST_STYLE_TYPE.MONGOLIAN:
                return createCounterStyleFromRange(value, 0x1810, 0x1819, true, defaultSuffix);
            case LIST_STYLE_TYPE.MYANMAR:
                return createCounterStyleFromRange(value, 0x1040, 0x1049, true, defaultSuffix);
            case LIST_STYLE_TYPE.ORIYA:
                return createCounterStyleFromRange(value, 0xb66, 0xb6f, true, defaultSuffix);
            case LIST_STYLE_TYPE.PERSIAN:
                return createCounterStyleFromRange(value, 0x6f0, 0x6f9, true, defaultSuffix);
            case LIST_STYLE_TYPE.TAMIL:
                return createCounterStyleFromRange(value, 0xbe6, 0xbef, true, defaultSuffix);
            case LIST_STYLE_TYPE.TELUGU:
                return createCounterStyleFromRange(value, 0xc66, 0xc6f, true, defaultSuffix);
            case LIST_STYLE_TYPE.THAI:
                return createCounterStyleFromRange(value, 0xe50, 0xe59, true, defaultSuffix);
            case LIST_STYLE_TYPE.TIBETAN:
                return createCounterStyleFromRange(value, 0xf20, 0xf29, true, defaultSuffix);
            case LIST_STYLE_TYPE.DECIMAL:
            default:
                return createCounterStyleFromRange(value, 48, 57, true, defaultSuffix);
        }
    };

    var IGNORE_ATTRIBUTE = 'data-html2canvas-ignore';
    var DocumentCloner = /** @class */ (function () {
        function DocumentCloner(context, element, options) {
            this.context = context;
            this.options = options;
            this.scrolledElements = [];
            this.referenceElement = element;
            this.counters = new CounterState();
            this.quoteDepth = 0;
            if (!element.ownerDocument) {
                throw new Error('Cloned element does not have an owner document');
            }
            this.documentElement = this.cloneNode(element.ownerDocument.documentElement);
        }
        DocumentCloner.prototype.toIFrame = function (ownerDocument, windowSize) {
            var _this = this;
            var iframe = createIFrameContainer(ownerDocument, windowSize);
            if (!iframe.contentWindow) {
                return Promise.reject("Unable to find iframe window");
            }
            var scrollX = ownerDocument.defaultView.pageXOffset;
            var scrollY = ownerDocument.defaultView.pageYOffset;
            var cloneWindow = iframe.contentWindow;
            var documentClone = cloneWindow.document;
            /* Chrome doesn't detect relative background-images assigned in inline <style> sheets when fetched through getComputedStyle
             if window url is about:blank, we can assign the url to current by writing onto the document
             */
            var iframeLoad = iframeLoader(iframe).then(function () { return __awaiter(_this, void 0, void 0, function () {
                var onclone, referenceElement;
                return __generator(this, function (_a) {
                    switch (_a.label) {
                        case 0:
                            this.scrolledElements.forEach(restoreNodeScroll);
                            if (cloneWindow) {
                                cloneWindow.scrollTo(windowSize.left, windowSize.top);
                                if (/(iPad|iPhone|iPod)/g.test(navigator.userAgent) &&
                                    (cloneWindow.scrollY !== windowSize.top || cloneWindow.scrollX !== windowSize.left)) {
                                    this.context.logger.warn('Unable to restore scroll position for cloned document');
                                    this.context.windowBounds = this.context.windowBounds.add(cloneWindow.scrollX - windowSize.left, cloneWindow.scrollY - windowSize.top, 0, 0);
                                }
                            }
                            onclone = this.options.onclone;
                            referenceElement = this.clonedReferenceElement;
                            if (typeof referenceElement === 'undefined') {
                                return [2 /*return*/, Promise.reject("Error finding the " + this.referenceElement.nodeName + " in the cloned document")];
                            }
                            if (!(documentClone.fonts && documentClone.fonts.ready)) return [3 /*break*/, 2];
                            return [4 /*yield*/, documentClone.fonts.ready];
                        case 1:
                            _a.sent();
                            _a.label = 2;
                        case 2:
                            if (!/(AppleWebKit)/g.test(navigator.userAgent)) return [3 /*break*/, 4];
                            return [4 /*yield*/, imagesReady(documentClone)];
                        case 3:
                            _a.sent();
                            _a.label = 4;
                        case 4:
                            if (typeof onclone === 'function') {
                                return [2 /*return*/, Promise.resolve()
                                        .then(function () { return onclone(documentClone, referenceElement); })
                                        .then(function () { return iframe; })];
                            }
                            return [2 /*return*/, iframe];
                    }
                });
            }); });
            documentClone.open();
            documentClone.write(serializeDoctype(document.doctype) + "<html></html>");
            // Chrome scrolls the parent document for some reason after the write to the cloned window???
            restoreOwnerScroll(this.referenceElement.ownerDocument, scrollX, scrollY);
            documentClone.replaceChild(documentClone.adoptNode(this.documentElement), documentClone.documentElement);
            documentClone.close();
            return iframeLoad;
        };
        DocumentCloner.prototype.createElementClone = function (node) {
            if (isDebugging(node, 2 /* CLONE */)) {
                debugger;
            }
            if (isCanvasElement(node)) {
                return this.createCanvasClone(node);
            }
            if (isStyleElement(node)) {
                return this.createStyleClone(node);
            }
            var clone = node.cloneNode(false);
            if (isImageElement(clone)) {
                if (isImageElement(node) && node.currentSrc && node.currentSrc !== node.src) {
                    clone.src = node.currentSrc;
                    clone.srcset = '';
                }
                if (clone.loading === 'lazy') {
                    clone.loading = 'eager';
                }
            }
            return clone;
        };
        DocumentCloner.prototype.createStyleClone = function (node) {
            try {
                var sheet = node.sheet;
                if (sheet && sheet.cssRules) {
                    var css = [].slice.call(sheet.cssRules, 0).reduce(function (css, rule) {
                        if (rule && typeof rule.cssText === 'string') {
                            return css + rule.cssText;
                        }
                        return css;
                    }, '');
                    var style = node.cloneNode(false);
                    style.textContent = css;
                    return style;
                }
            }
            catch (e) {
                // accessing node.sheet.cssRules throws a DOMException
                this.context.logger.error('Unable to access cssRules property', e);
                if (e.name !== 'SecurityError') {
                    throw e;
                }
            }
            return node.cloneNode(false);
        };
        DocumentCloner.prototype.createCanvasClone = function (canvas) {
            var _a;
            if (this.options.inlineImages && canvas.ownerDocument) {
                var img = canvas.ownerDocument.createElement('img');
                try {
                    img.src = canvas.toDataURL();
                    return img;
                }
                catch (e) {
                    this.context.logger.info("Unable to inline canvas contents, canvas is tainted", canvas);
                }
            }
            var clonedCanvas = canvas.cloneNode(false);
            try {
                clonedCanvas.width = canvas.width;
                clonedCanvas.height = canvas.height;
                var ctx = canvas.getContext('2d');
                var clonedCtx = clonedCanvas.getContext('2d');
                if (clonedCtx) {
                    if (!this.options.allowTaint && ctx) {
                        clonedCtx.putImageData(ctx.getImageData(0, 0, canvas.width, canvas.height), 0, 0);
                    }
                    else {
                        var gl = (_a = canvas.getContext('webgl2')) !== null && _a !== void 0 ? _a : canvas.getContext('webgl');
                        if (gl) {
                            var attribs = gl.getContextAttributes();
                            if ((attribs === null || attribs === void 0 ? void 0 : attribs.preserveDrawingBuffer) === false) {
                                this.context.logger.warn('Unable to clone WebGL context as it has preserveDrawingBuffer=false', canvas);
                            }
                        }
                        clonedCtx.drawImage(canvas, 0, 0);
                    }
                }
                return clonedCanvas;
            }
            catch (e) {
                this.context.logger.info("Unable to clone canvas as it is tainted", canvas);
            }
            return clonedCanvas;
        };
        DocumentCloner.prototype.cloneNode = function (node) {
            if (isTextNode(node)) {
                return document.createTextNode(node.data);
            }
            if (!node.ownerDocument) {
                return node.cloneNode(false);
            }
            var window = node.ownerDocument.defaultView;
            if (window && isElementNode(node) && (isHTMLElementNode(node) || isSVGElementNode(node))) {
                var clone = this.createElementClone(node);
                clone.style.transitionProperty = 'none';
                var style = window.getComputedStyle(node);
                var styleBefore = window.getComputedStyle(node, ':before');
                var styleAfter = window.getComputedStyle(node, ':after');
                if (this.referenceElement === node && isHTMLElementNode(clone)) {
                    this.clonedReferenceElement = clone;
                }
                if (isBodyElement(clone)) {
                    createPseudoHideStyles(clone);
                }
                var counters = this.counters.parse(new CSSParsedCounterDeclaration(this.context, style));
                var before = this.resolvePseudoContent(node, clone, styleBefore, PseudoElementType.BEFORE);
                for (var child = node.firstChild; child; child = child.nextSibling) {
                    if (!isElementNode(child) ||
                        (!isScriptElement(child) &&
                            !child.hasAttribute(IGNORE_ATTRIBUTE) &&
                            (typeof this.options.ignoreElements !== 'function' || !this.options.ignoreElements(child)))) {
                        if (!this.options.copyStyles || !isElementNode(child) || !isStyleElement(child)) {
                            clone.appendChild(this.cloneNode(child));
                        }
                    }
                }
                if (before) {
                    clone.insertBefore(before, clone.firstChild);
                }
                var after = this.resolvePseudoContent(node, clone, styleAfter, PseudoElementType.AFTER);
                if (after) {
                    clone.appendChild(after);
                }
                this.counters.pop(counters);
                if (style && (this.options.copyStyles || isSVGElementNode(node)) && !isIFrameElement(node)) {
                    copyCSSStyles(style, clone);
                }
                if (node.scrollTop !== 0 || node.scrollLeft !== 0) {
                    this.scrolledElements.push([clone, node.scrollLeft, node.scrollTop]);
                }
                if ((isTextareaElement(node) || isSelectElement(node)) &&
                    (isTextareaElement(clone) || isSelectElement(clone))) {
                    clone.value = node.value;
                }
                return clone;
            }
            return node.cloneNode(false);
        };
        DocumentCloner.prototype.resolvePseudoContent = function (node, clone, style, pseudoElt) {
            var _this = this;
            if (!style) {
                return;
            }
            var value = style.content;
            var document = clone.ownerDocument;
            if (!document || !value || value === 'none' || value === '-moz-alt-content' || style.display === 'none') {
                return;
            }
            this.counters.parse(new CSSParsedCounterDeclaration(this.context, style));
            var declaration = new CSSParsedPseudoDeclaration(this.context, style);
            var anonymousReplacedElement = document.createElement('html2canvaspseudoelement');
            copyCSSStyles(style, anonymousReplacedElement);
            declaration.content.forEach(function (token) {
                if (token.type === 0 /* STRING_TOKEN */) {
                    anonymousReplacedElement.appendChild(document.createTextNode(token.value));
                }
                else if (token.type === 22 /* URL_TOKEN */) {
                    var img = document.createElement('img');
                    img.src = token.value;
                    img.style.opacity = '1';
                    anonymousReplacedElement.appendChild(img);
                }
                else if (token.type === 18 /* FUNCTION */) {
                    if (token.name === 'attr') {
                        var attr = token.values.filter(isIdentToken);
                        if (attr.length) {
                            anonymousReplacedElement.appendChild(document.createTextNode(node.getAttribute(attr[0].value) || ''));
                        }
                    }
                    else if (token.name === 'counter') {
                        var _a = token.values.filter(nonFunctionArgSeparator), counter = _a[0], counterStyle = _a[1];
                        if (counter && isIdentToken(counter)) {
                            var counterState = _this.counters.getCounterValue(counter.value);
                            var counterType = counterStyle && isIdentToken(counterStyle)
                                ? listStyleType.parse(_this.context, counterStyle.value)
                                : LIST_STYLE_TYPE.DECIMAL;
                            anonymousReplacedElement.appendChild(document.createTextNode(createCounterText(counterState, counterType, false)));
                        }
                    }
                    else if (token.name === 'counters') {
                        var _b = token.values.filter(nonFunctionArgSeparator), counter = _b[0], delim = _b[1], counterStyle = _b[2];
                        if (counter && isIdentToken(counter)) {
                            var counterStates = _this.counters.getCounterValues(counter.value);
                            var counterType_1 = counterStyle && isIdentToken(counterStyle)
                                ? listStyleType.parse(_this.context, counterStyle.value)
                                : LIST_STYLE_TYPE.DECIMAL;
                            var separator = delim && delim.type === 0 /* STRING_TOKEN */ ? delim.value : '';
                            var text = counterStates
                                .map(function (value) { return createCounterText(value, counterType_1, false); })
                                .join(separator);
                            anonymousReplacedElement.appendChild(document.createTextNode(text));
                        }
                    }
                    else ;
                }
                else if (token.type === 20 /* IDENT_TOKEN */) {
                    switch (token.value) {
                        case 'open-quote':
                            anonymousReplacedElement.appendChild(document.createTextNode(getQuote(declaration.quotes, _this.quoteDepth++, true)));
                            break;
                        case 'close-quote':
                            anonymousReplacedElement.appendChild(document.createTextNode(getQuote(declaration.quotes, --_this.quoteDepth, false)));
                            break;
                        default:
                            // safari doesn't parse string tokens correctly because of lack of quotes
                            anonymousReplacedElement.appendChild(document.createTextNode(token.value));
                    }
                }
            });
            anonymousReplacedElement.className = PSEUDO_HIDE_ELEMENT_CLASS_BEFORE + " " + PSEUDO_HIDE_ELEMENT_CLASS_AFTER;
            var newClassName = pseudoElt === PseudoElementType.BEFORE
                ? " " + PSEUDO_HIDE_ELEMENT_CLASS_BEFORE
                : " " + PSEUDO_HIDE_ELEMENT_CLASS_AFTER;
            if (isSVGElementNode(clone)) {
                clone.className.baseValue += newClassName;
            }
            else {
                clone.className += newClassName;
            }
            return anonymousReplacedElement;
        };
        DocumentCloner.destroy = function (container) {
            if (container.parentNode) {
                container.parentNode.removeChild(container);
                return true;
            }
            return false;
        };
        return DocumentCloner;
    }());
    var PseudoElementType;
    (function (PseudoElementType) {
        PseudoElementType[PseudoElementType["BEFORE"] = 0] = "BEFORE";
        PseudoElementType[PseudoElementType["AFTER"] = 1] = "AFTER";
    })(PseudoElementType || (PseudoElementType = {}));
    var createIFrameContainer = function (ownerDocument, bounds) {
        var cloneIframeContainer = ownerDocument.createElement('iframe');
        cloneIframeContainer.className = 'html2canvas-container';
        cloneIframeContainer.style.visibility = 'hidden';
        cloneIframeContainer.style.position = 'fixed';
        cloneIframeContainer.style.left = '-10000px';
        cloneIframeContainer.style.top = '0px';
        cloneIframeContainer.style.border = '0';
        cloneIframeContainer.width = bounds.width.toString();
        cloneIframeContainer.height = bounds.height.toString();
        cloneIframeContainer.scrolling = 'no'; // ios won't scroll without it
        cloneIframeContainer.setAttribute(IGNORE_ATTRIBUTE, 'true');
        ownerDocument.body.appendChild(cloneIframeContainer);
        return cloneIframeContainer;
    };
    var imageReady = function (img) {
        return new Promise(function (resolve) {
            if (img.complete) {
                resolve();
                return;
            }
            if (!img.src) {
                resolve();
                return;
            }
            img.onload = resolve;
            img.onerror = resolve;
        });
    };
    var imagesReady = function (document) {
        return Promise.all([].slice.call(document.images, 0).map(imageReady));
    };
    var iframeLoader = function (iframe) {
        return new Promise(function (resolve, reject) {
            var cloneWindow = iframe.contentWindow;
            if (!cloneWindow) {
                return reject("No window assigned for iframe");
            }
            var documentClone = cloneWindow.document;
            cloneWindow.onload = iframe.onload = function () {
                cloneWindow.onload = iframe.onload = null;
                var interval = setInterval(function () {
                    if (documentClone.body.childNodes.length > 0 && documentClone.readyState === 'complete') {
                        clearInterval(interval);
                        resolve(iframe);
                    }
                }, 50);
            };
        });
    };
    var ignoredStyleProperties = [
        'all',
        'd',
        'content' // Safari shows pseudoelements if content is set
    ];
    var copyCSSStyles = function (style, target) {
        // Edge does not provide value for cssText
        for (var i = style.length - 1; i >= 0; i--) {
            var property = style.item(i);
            if (ignoredStyleProperties.indexOf(property) === -1) {
                target.style.setProperty(property, style.getPropertyValue(property));
            }
        }
        return target;
    };
    var serializeDoctype = function (doctype) {
        var str = '';
        if (doctype) {
            str += '<!DOCTYPE ';
            if (doctype.name) {
                str += doctype.name;
            }
            if (doctype.internalSubset) {
                str += doctype.internalSubset;
            }
            if (doctype.publicId) {
                str += "\"" + doctype.publicId + "\"";
            }
            if (doctype.systemId) {
                str += "\"" + doctype.systemId + "\"";
            }
            str += '>';
        }
        return str;
    };
    var restoreOwnerScroll = function (ownerDocument, x, y) {
        if (ownerDocument &&
            ownerDocument.defaultView &&
            (x !== ownerDocument.defaultView.pageXOffset || y !== ownerDocument.defaultView.pageYOffset)) {
            ownerDocument.defaultView.scrollTo(x, y);
        }
    };
    var restoreNodeScroll = function (_a) {
        var element = _a[0], x = _a[1], y = _a[2];
        element.scrollLeft = x;
        element.scrollTop = y;
    };
    var PSEUDO_BEFORE = ':before';
    var PSEUDO_AFTER = ':after';
    var PSEUDO_HIDE_ELEMENT_CLASS_BEFORE = '___html2canvas___pseudoelement_before';
    var PSEUDO_HIDE_ELEMENT_CLASS_AFTER = '___html2canvas___pseudoelement_after';
    var PSEUDO_HIDE_ELEMENT_STYLE = "{\n    content: \"\" !important;\n    display: none !important;\n}";
    var createPseudoHideStyles = function (body) {
        createStyles(body, "." + PSEUDO_HIDE_ELEMENT_CLASS_BEFORE + PSEUDO_BEFORE + PSEUDO_HIDE_ELEMENT_STYLE + "\n         ." + PSEUDO_HIDE_ELEMENT_CLASS_AFTER + PSEUDO_AFTER + PSEUDO_HIDE_ELEMENT_STYLE);
    };
    var createStyles = function (body, styles) {
        var document = body.ownerDocument;
        if (document) {
            var style = document.createElement('style');
            style.textContent = styles;
            body.appendChild(style);
        }
    };

    var CacheStorage = /** @class */ (function () {
        function CacheStorage() {
        }
        CacheStorage.getOrigin = function (url) {
            var link = CacheStorage._link;
            if (!link) {
                return 'about:blank';
            }
            link.href = url;
            link.href = link.href; // IE9, LOL! - http://jsfiddle.net/niklasvh/2e48b/
            return link.protocol + link.hostname + link.port;
        };
        CacheStorage.isSameOrigin = function (src) {
            return CacheStorage.getOrigin(src) === CacheStorage._origin;
        };
        CacheStorage.setContext = function (window) {
            CacheStorage._link = window.document.createElement('a');
            CacheStorage._origin = CacheStorage.getOrigin(window.location.href);
        };
        CacheStorage._origin = 'about:blank';
        return CacheStorage;
    }());
    var Cache = /** @class */ (function () {
        function Cache(context, _options) {
            this.context = context;
            this._options = _options;
            // eslint-disable-next-line @typescript-eslint/no-explicit-any
            this._cache = {};
        }
        Cache.prototype.addImage = function (src) {
            var result = Promise.resolve();
            if (this.has(src)) {
                return result;
            }
            if (isBlobImage(src) || isRenderable(src)) {
                (this._cache[src] = this.loadImage(src)).catch(function () {
                    // prevent unhandled rejection
                });
                return result;
            }
            return result;
        };
        // eslint-disable-next-line @typescript-eslint/no-explicit-any
        Cache.prototype.match = function (src) {
            return this._cache[src];
        };
        Cache.prototype.loadImage = function (key) {
            return __awaiter(this, void 0, void 0, function () {
                var isSameOrigin, useCORS, useProxy, src;
                var _this = this;
                return __generator(this, function (_a) {
                    switch (_a.label) {
                        case 0:
                            isSameOrigin = CacheStorage.isSameOrigin(key);
                            useCORS = !isInlineImage(key) && this._options.useCORS === true && FEATURES.SUPPORT_CORS_IMAGES && !isSameOrigin;
                            useProxy = !isInlineImage(key) &&
                                !isSameOrigin &&
                                !isBlobImage(key) &&
                                typeof this._options.proxy === 'string' &&
                                FEATURES.SUPPORT_CORS_XHR &&
                                !useCORS;
                            if (!isSameOrigin &&
                                this._options.allowTaint === false &&
                                !isInlineImage(key) &&
                                !isBlobImage(key) &&
                                !useProxy &&
                                !useCORS) {
                                return [2 /*return*/];
                            }
                            src = key;
                            if (!useProxy) return [3 /*break*/, 2];
                            return [4 /*yield*/, this.proxy(src)];
                        case 1:
                            src = _a.sent();
                            _a.label = 2;
                        case 2:
                            this.context.logger.debug("Added image " + key.substring(0, 256));
                            return [4 /*yield*/, new Promise(function (resolve, reject) {
                                    var img = new Image();
                                    img.onload = function () { return resolve(img); };
                                    img.onerror = reject;
                                    //ios safari 10.3 taints canvas with data urls unless crossOrigin is set to anonymous
                                    if (isInlineBase64Image(src) || useCORS) {
                                        img.crossOrigin = 'anonymous';
                                    }
                                    img.src = src;
                                    if (img.complete === true) {
                                        // Inline XML images may fail to parse, throwing an Error later on
                                        setTimeout(function () { return resolve(img); }, 500);
                                    }
                                    if (_this._options.imageTimeout > 0) {
                                        setTimeout(function () { return reject("Timed out (" + _this._options.imageTimeout + "ms) loading image"); }, _this._options.imageTimeout);
                                    }
                                })];
                        case 3: return [2 /*return*/, _a.sent()];
                    }
                });
            });
        };
        Cache.prototype.has = function (key) {
            return typeof this._cache[key] !== 'undefined';
        };
        Cache.prototype.keys = function () {
            return Promise.resolve(Object.keys(this._cache));
        };
        Cache.prototype.proxy = function (src) {
            var _this = this;
            var proxy = this._options.proxy;
            if (!proxy) {
                throw new Error('No proxy defined');
            }
            var key = src.substring(0, 256);
            return new Promise(function (resolve, reject) {
                var responseType = FEATURES.SUPPORT_RESPONSE_TYPE ? 'blob' : 'text';
                var xhr = new XMLHttpRequest();
                xhr.onload = function () {
                    if (xhr.status === 200) {
                        if (responseType === 'text') {
                            resolve(xhr.response);
                        }
                        else {
                            var reader_1 = new FileReader();
                            reader_1.addEventListener('load', function () { return resolve(reader_1.result); }, false);
                            reader_1.addEventListener('error', function (e) { return reject(e); }, false);
                            reader_1.readAsDataURL(xhr.response);
                        }
                    }
                    else {
                        reject("Failed to proxy resource " + key + " with status code " + xhr.status);
                    }
                };
                xhr.onerror = reject;
                var queryString = proxy.indexOf('?') > -1 ? '&' : '?';
                xhr.open('GET', "" + proxy + queryString + "url=" + encodeURIComponent(src) + "&responseType=" + responseType);
                if (responseType !== 'text' && xhr instanceof XMLHttpRequest) {
                    xhr.responseType = responseType;
                }
                if (_this._options.imageTimeout) {
                    var timeout_1 = _this._options.imageTimeout;
                    xhr.timeout = timeout_1;
                    xhr.ontimeout = function () { return reject("Timed out (" + timeout_1 + "ms) proxying " + key); };
                }
                xhr.send();
            });
        };
        return Cache;
    }());
    var INLINE_SVG = /^data:image\/svg\+xml/i;
    var INLINE_BASE64 = /^data:image\/.*;base64,/i;
    var INLINE_IMG = /^data:image\/.*/i;
    var isRenderable = function (src) { return FEATURES.SUPPORT_SVG_DRAWING || !isSVG(src); };
    var isInlineImage = function (src) { return INLINE_IMG.test(src); };
    var isInlineBase64Image = function (src) { return INLINE_BASE64.test(src); };
    var isBlobImage = function (src) { return src.substr(0, 4) === 'blob'; };
    var isSVG = function (src) { return src.substr(-3).toLowerCase() === 'svg' || INLINE_SVG.test(src); };

    var PathType;
    (function (PathType) {
        PathType[PathType["VECTOR"] = 0] = "VECTOR";
        PathType[PathType["BEZIER_CURVE"] = 1] = "BEZIER_CURVE";
    })(PathType || (PathType = {}));
    var equalPath = function (a, b) {
        if (a.length === b.length) {
            return a.some(function (v, i) { return v === b[i]; });
        }
        return false;
    };
    var transformPath = function (path, deltaX, deltaY, deltaW, deltaH) {
        return path.map(function (point, index) {
            switch (index) {
                case 0:
                    return point.add(deltaX, deltaY);
                case 1:
                    return point.add(deltaX + deltaW, deltaY);
                case 2:
                    return point.add(deltaX + deltaW, deltaY + deltaH);
                case 3:
                    return point.add(deltaX, deltaY + deltaH);
            }
            return point;
        });
    };

    var Vector = /** @class */ (function () {
        function Vector(x, y) {
            this.type = PathType.VECTOR;
            this.x = x;
            this.y = y;
        }
        Vector.prototype.add = function (deltaX, deltaY) {
            return new Vector(this.x + deltaX, this.y + deltaY);
        };
        return Vector;
    }());

    var lerp = function (a, b, t) {
        return new Vector(a.x + (b.x - a.x) * t, a.y + (b.y - a.y) * t);
    };
    var BezierCurve = /** @class */ (function () {
        function BezierCurve(start, startControl, endControl, end) {
            this.type = PathType.BEZIER_CURVE;
            this.start = start;
            this.startControl = startControl;
            this.endControl = endControl;
            this.end = end;
        }
        BezierCurve.prototype.subdivide = function (t, firstHalf) {
            var ab = lerp(this.start, this.startControl, t);
            var bc = lerp(this.startControl, this.endControl, t);
            var cd = lerp(this.endControl, this.end, t);
            var abbc = lerp(ab, bc, t);
            var bccd = lerp(bc, cd, t);
            var dest = lerp(abbc, bccd, t);
            return firstHalf ? new BezierCurve(this.start, ab, abbc, dest) : new BezierCurve(dest, bccd, cd, this.end);
        };
        BezierCurve.prototype.add = function (deltaX, deltaY) {
            return new BezierCurve(this.start.add(deltaX, deltaY), this.startControl.add(deltaX, deltaY), this.endControl.add(deltaX, deltaY), this.end.add(deltaX, deltaY));
        };
        BezierCurve.prototype.reverse = function () {
            return new BezierCurve(this.end, this.endControl, this.startControl, this.start);
        };
        return BezierCurve;
    }());
    var isBezierCurve = function (path) { return path.type === PathType.BEZIER_CURVE; };

    var BoundCurves = /** @class */ (function () {
        function BoundCurves(element) {
            var styles = element.styles;
            var bounds = element.bounds;
            var _a = getAbsoluteValueForTuple(styles.borderTopLeftRadius, bounds.width, bounds.height), tlh = _a[0], tlv = _a[1];
            var _b = getAbsoluteValueForTuple(styles.borderTopRightRadius, bounds.width, bounds.height), trh = _b[0], trv = _b[1];
            var _c = getAbsoluteValueForTuple(styles.borderBottomRightRadius, bounds.width, bounds.height), brh = _c[0], brv = _c[1];
            var _d = getAbsoluteValueForTuple(styles.borderBottomLeftRadius, bounds.width, bounds.height), blh = _d[0], blv = _d[1];
            var factors = [];
            factors.push((tlh + trh) / bounds.width);
            factors.push((blh + brh) / bounds.width);
            factors.push((tlv + blv) / bounds.height);
            factors.push((trv + brv) / bounds.height);
            var maxFactor = Math.max.apply(Math, factors);
            if (maxFactor > 1) {
                tlh /= maxFactor;
                tlv /= maxFactor;
                trh /= maxFactor;
                trv /= maxFactor;
                brh /= maxFactor;
                brv /= maxFactor;
                blh /= maxFactor;
                blv /= maxFactor;
            }
            var topWidth = bounds.width - trh;
            var rightHeight = bounds.height - brv;
            var bottomWidth = bounds.width - brh;
            var leftHeight = bounds.height - blv;
            var borderTopWidth = styles.borderTopWidth;
            var borderRightWidth = styles.borderRightWidth;
            var borderBottomWidth = styles.borderBottomWidth;
            var borderLeftWidth = styles.borderLeftWidth;
            var paddingTop = getAbsoluteValue(styles.paddingTop, element.bounds.width);
            var paddingRight = getAbsoluteValue(styles.paddingRight, element.bounds.width);
            var paddingBottom = getAbsoluteValue(styles.paddingBottom, element.bounds.width);
            var paddingLeft = getAbsoluteValue(styles.paddingLeft, element.bounds.width);
            this.topLeftBorderDoubleOuterBox =
                tlh > 0 || tlv > 0
                    ? getCurvePoints(bounds.left + borderLeftWidth / 3, bounds.top + borderTopWidth / 3, tlh - borderLeftWidth / 3, tlv - borderTopWidth / 3, CORNER.TOP_LEFT)
                    : new Vector(bounds.left + borderLeftWidth / 3, bounds.top + borderTopWidth / 3);
            this.topRightBorderDoubleOuterBox =
                tlh > 0 || tlv > 0
                    ? getCurvePoints(bounds.left + topWidth, bounds.top + borderTopWidth / 3, trh - borderRightWidth / 3, trv - borderTopWidth / 3, CORNER.TOP_RIGHT)
                    : new Vector(bounds.left + bounds.width - borderRightWidth / 3, bounds.top + borderTopWidth / 3);
            this.bottomRightBorderDoubleOuterBox =
                brh > 0 || brv > 0
                    ? getCurvePoints(bounds.left + bottomWidth, bounds.top + rightHeight, brh - borderRightWidth / 3, brv - borderBottomWidth / 3, CORNER.BOTTOM_RIGHT)
                    : new Vector(bounds.left + bounds.width - borderRightWidth / 3, bounds.top + bounds.height - borderBottomWidth / 3);
            this.bottomLeftBorderDoubleOuterBox =
                blh > 0 || blv > 0
                    ? getCurvePoints(bounds.left + borderLeftWidth / 3, bounds.top + leftHeight, blh - borderLeftWidth / 3, blv - borderBottomWidth / 3, CORNER.BOTTOM_LEFT)
                    : new Vector(bounds.left + borderLeftWidth / 3, bounds.top + bounds.height - borderBottomWidth / 3);
            this.topLeftBorderDoubleInnerBox =
                tlh > 0 || tlv > 0
                    ? getCurvePoints(bounds.left + (borderLeftWidth * 2) / 3, bounds.top + (borderTopWidth * 2) / 3, tlh - (borderLeftWidth * 2) / 3, tlv - (borderTopWidth * 2) / 3, CORNER.TOP_LEFT)
                    : new Vector(bounds.left + (borderLeftWidth * 2) / 3, bounds.top + (borderTopWidth * 2) / 3);
            this.topRightBorderDoubleInnerBox =
                tlh > 0 || tlv > 0
                    ? getCurvePoints(bounds.left + topWidth, bounds.top + (borderTopWidth * 2) / 3, trh - (borderRightWidth * 2) / 3, trv - (borderTopWidth * 2) / 3, CORNER.TOP_RIGHT)
                    : new Vector(bounds.left + bounds.width - (borderRightWidth * 2) / 3, bounds.top + (borderTopWidth * 2) / 3);
            this.bottomRightBorderDoubleInnerBox =
                brh > 0 || brv > 0
                    ? getCurvePoints(bounds.left + bottomWidth, bounds.top + rightHeight, brh - (borderRightWidth * 2) / 3, brv - (borderBottomWidth * 2) / 3, CORNER.BOTTOM_RIGHT)
                    : new Vector(bounds.left + bounds.width - (borderRightWidth * 2) / 3, bounds.top + bounds.height - (borderBottomWidth * 2) / 3);
            this.bottomLeftBorderDoubleInnerBox =
                blh > 0 || blv > 0
                    ? getCurvePoints(bounds.left + (borderLeftWidth * 2) / 3, bounds.top + leftHeight, blh - (borderLeftWidth * 2) / 3, blv - (borderBottomWidth * 2) / 3, CORNER.BOTTOM_LEFT)
                    : new Vector(bounds.left + (borderLeftWidth * 2) / 3, bounds.top + bounds.height - (borderBottomWidth * 2) / 3);
            this.topLeftBorderStroke =
                tlh > 0 || tlv > 0
                    ? getCurvePoints(bounds.left + borderLeftWidth / 2, bounds.top + borderTopWidth / 2, tlh - borderLeftWidth / 2, tlv - borderTopWidth / 2, CORNER.TOP_LEFT)
                    : new Vector(bounds.left + borderLeftWidth / 2, bounds.top + borderTopWidth / 2);
            this.topRightBorderStroke =
                tlh > 0 || tlv > 0
                    ? getCurvePoints(bounds.left + topWidth, bounds.top + borderTopWidth / 2, trh - borderRightWidth / 2, trv - borderTopWidth / 2, CORNER.TOP_RIGHT)
                    : new Vector(bounds.left + bounds.width - borderRightWidth / 2, bounds.top + borderTopWidth / 2);
            this.bottomRightBorderStroke =
                brh > 0 || brv > 0
                    ? getCurvePoints(bounds.left + bottomWidth, bounds.top + rightHeight, brh - borderRightWidth / 2, brv - borderBottomWidth / 2, CORNER.BOTTOM_RIGHT)
                    : new Vector(bounds.left + bounds.width - borderRightWidth / 2, bounds.top + bounds.height - borderBottomWidth / 2);
            this.bottomLeftBorderStroke =
                blh > 0 || blv > 0
                    ? getCurvePoints(bounds.left + borderLeftWidth / 2, bounds.top + leftHeight, blh - borderLeftWidth / 2, blv - borderBottomWidth / 2, CORNER.BOTTOM_LEFT)
                    : new Vector(bounds.left + borderLeftWidth / 2, bounds.top + bounds.height - borderBottomWidth / 2);
            this.topLeftBorderBox =
                tlh > 0 || tlv > 0
                    ? getCurvePoints(bounds.left, bounds.top, tlh, tlv, CORNER.TOP_LEFT)
                    : new Vector(bounds.left, bounds.top);
            this.topRightBorderBox =
                trh > 0 || trv > 0
                    ? getCurvePoints(bounds.left + topWidth, bounds.top, trh, trv, CORNER.TOP_RIGHT)
                    : new Vector(bounds.left + bounds.width, bounds.top);
            this.bottomRightBorderBox =
                brh > 0 || brv > 0
                    ? getCurvePoints(bounds.left + bottomWidth, bounds.top + rightHeight, brh, brv, CORNER.BOTTOM_RIGHT)
                    : new Vector(bounds.left + bounds.width, bounds.top + bounds.height);
            this.bottomLeftBorderBox =
                blh > 0 || blv > 0
                    ? getCurvePoints(bounds.left, bounds.top + leftHeight, blh, blv, CORNER.BOTTOM_LEFT)
                    : new Vector(bounds.left, bounds.top + bounds.height);
            this.topLeftPaddingBox =
                tlh > 0 || tlv > 0
                    ? getCurvePoints(bounds.left + borderLeftWidth, bounds.top + borderTopWidth, Math.max(0, tlh - borderLeftWidth), Math.max(0, tlv - borderTopWidth), CORNER.TOP_LEFT)
                    : new Vector(bounds.left + borderLeftWidth, bounds.top + borderTopWidth);
            this.topRightPaddingBox =
                trh > 0 || trv > 0
                    ? getCurvePoints(bounds.left + Math.min(topWidth, bounds.width - borderRightWidth), bounds.top + borderTopWidth, topWidth > bounds.width + borderRightWidth ? 0 : Math.max(0, trh - borderRightWidth), Math.max(0, trv - borderTopWidth), CORNER.TOP_RIGHT)
                    : new Vector(bounds.left + bounds.width - borderRightWidth, bounds.top + borderTopWidth);
            this.bottomRightPaddingBox =
                brh > 0 || brv > 0
                    ? getCurvePoints(bounds.left + Math.min(bottomWidth, bounds.width - borderLeftWidth), bounds.top + Math.min(rightHeight, bounds.height - borderBottomWidth), Math.max(0, brh - borderRightWidth), Math.max(0, brv - borderBottomWidth), CORNER.BOTTOM_RIGHT)
                    : new Vector(bounds.left + bounds.width - borderRightWidth, bounds.top + bounds.height - borderBottomWidth);
            this.bottomLeftPaddingBox =
                blh > 0 || blv > 0
                    ? getCurvePoints(bounds.left + borderLeftWidth, bounds.top + Math.min(leftHeight, bounds.height - borderBottomWidth), Math.max(0, blh - borderLeftWidth), Math.max(0, blv - borderBottomWidth), CORNER.BOTTOM_LEFT)
                    : new Vector(bounds.left + borderLeftWidth, bounds.top + bounds.height - borderBottomWidth);
            this.topLeftContentBox =
                tlh > 0 || tlv > 0
                    ? getCurvePoints(bounds.left + borderLeftWidth + paddingLeft, bounds.top + borderTopWidth + paddingTop, Math.max(0, tlh - (borderLeftWidth + paddingLeft)), Math.max(0, tlv - (borderTopWidth + paddingTop)), CORNER.TOP_LEFT)
                    : new Vector(bounds.left + borderLeftWidth + paddingLeft, bounds.top + borderTopWidth + paddingTop);
            this.topRightContentBox =
                trh > 0 || trv > 0
                    ? getCurvePoints(bounds.left + Math.min(topWidth, bounds.width + borderLeftWidth + paddingLeft), bounds.top + borderTopWidth + paddingTop, topWidth > bounds.width + borderLeftWidth + paddingLeft ? 0 : trh - borderLeftWidth + paddingLeft, trv - (borderTopWidth + paddingTop), CORNER.TOP_RIGHT)
                    : new Vector(bounds.left + bounds.width - (borderRightWidth + paddingRight), bounds.top + borderTopWidth + paddingTop);
            this.bottomRightContentBox =
                brh > 0 || brv > 0
                    ? getCurvePoints(bounds.left + Math.min(bottomWidth, bounds.width - (borderLeftWidth + paddingLeft)), bounds.top + Math.min(rightHeight, bounds.height + borderTopWidth + paddingTop), Math.max(0, brh - (borderRightWidth + paddingRight)), brv - (borderBottomWidth + paddingBottom), CORNER.BOTTOM_RIGHT)
                    : new Vector(bounds.left + bounds.width - (borderRightWidth + paddingRight), bounds.top + bounds.height - (borderBottomWidth + paddingBottom));
            this.bottomLeftContentBox =
                blh > 0 || blv > 0
                    ? getCurvePoints(bounds.left + borderLeftWidth + paddingLeft, bounds.top + leftHeight, Math.max(0, blh - (borderLeftWidth + paddingLeft)), blv - (borderBottomWidth + paddingBottom), CORNER.BOTTOM_LEFT)
                    : new Vector(bounds.left + borderLeftWidth + paddingLeft, bounds.top + bounds.height - (borderBottomWidth + paddingBottom));
        }
        return BoundCurves;
    }());
    var CORNER;
    (function (CORNER) {
        CORNER[CORNER["TOP_LEFT"] = 0] = "TOP_LEFT";
        CORNER[CORNER["TOP_RIGHT"] = 1] = "TOP_RIGHT";
        CORNER[CORNER["BOTTOM_RIGHT"] = 2] = "BOTTOM_RIGHT";
        CORNER[CORNER["BOTTOM_LEFT"] = 3] = "BOTTOM_LEFT";
    })(CORNER || (CORNER = {}));
    var getCurvePoints = function (x, y, r1, r2, position) {
        var kappa = 4 * ((Math.sqrt(2) - 1) / 3);
        var ox = r1 * kappa; // control point offset horizontal
        var oy = r2 * kappa; // control point offset vertical
        var xm = x + r1; // x-middle
        var ym = y + r2; // y-middle
        switch (position) {
            case CORNER.TOP_LEFT:
                return new BezierCurve(new Vector(x, ym), new Vector(x, ym - oy), new Vector(xm - ox, y), new Vector(xm, y));
            case CORNER.TOP_RIGHT:
                return new BezierCurve(new Vector(x, y), new Vector(x + ox, y), new Vector(xm, ym - oy), new Vector(xm, ym));
            case CORNER.BOTTOM_RIGHT:
                return new BezierCurve(new Vector(xm, y), new Vector(xm, y + oy), new Vector(x + ox, ym), new Vector(x, ym));
            case CORNER.BOTTOM_LEFT:
            default:
                return new BezierCurve(new Vector(xm, ym), new Vector(xm - ox, ym), new Vector(x, y + oy), new Vector(x, y));
        }
    };
    var calculateBorderBoxPath = function (curves) {
        return [curves.topLeftBorderBox, curves.topRightBorderBox, curves.bottomRightBorderBox, curves.bottomLeftBorderBox];
    };
    var calculateContentBoxPath = function (curves) {
        return [
            curves.topLeftContentBox,
            curves.topRightContentBox,
            curves.bottomRightContentBox,
            curves.bottomLeftContentBox
        ];
    };
    var calculatePaddingBoxPath = function (curves) {
        return [
            curves.topLeftPaddingBox,
            curves.topRightPaddingBox,
            curves.bottomRightPaddingBox,
            curves.bottomLeftPaddingBox
        ];
    };

    var TransformEffect = /** @class */ (function () {
        function TransformEffect(offsetX, offsetY, matrix) {
            this.offsetX = offsetX;
            this.offsetY = offsetY;
            this.matrix = matrix;
            this.type = 0 /* TRANSFORM */;
            this.target = 2 /* BACKGROUND_BORDERS */ | 4 /* CONTENT */;
        }
        return TransformEffect;
    }());
    var ClipEffect = /** @class */ (function () {
        function ClipEffect(path, target) {
            this.path = path;
            this.target = target;
            this.type = 1 /* CLIP */;
        }
        return ClipEffect;
    }());
    var OpacityEffect = /** @class */ (function () {
        function OpacityEffect(opacity) {
            this.opacity = opacity;
            this.type = 2 /* OPACITY */;
            this.target = 2 /* BACKGROUND_BORDERS */ | 4 /* CONTENT */;
        }
        return OpacityEffect;
    }());
    var isTransformEffect = function (effect) {
        return effect.type === 0 /* TRANSFORM */;
    };
    var isClipEffect = function (effect) { return effect.type === 1 /* CLIP */; };
    var isOpacityEffect = function (effect) { return effect.type === 2 /* OPACITY */; };

    var StackingContext = /** @class */ (function () {
        function StackingContext(container) {
            this.element = container;
            this.inlineLevel = [];
            this.nonInlineLevel = [];
            this.negativeZIndex = [];
            this.zeroOrAutoZIndexOrTransformedOrOpacity = [];
            this.positiveZIndex = [];
            this.nonPositionedFloats = [];
            this.nonPositionedInlineLevel = [];
        }
        return StackingContext;
    }());
    var ElementPaint = /** @class */ (function () {
        function ElementPaint(container, parent) {
            this.container = container;
            this.parent = parent;
            this.effects = [];
            this.curves = new BoundCurves(this.container);
            if (this.container.styles.opacity < 1) {
                this.effects.push(new OpacityEffect(this.container.styles.opacity));
            }
            if (this.container.styles.transform !== null) {
                var offsetX = this.container.bounds.left + this.container.styles.transformOrigin[0].number;
                var offsetY = this.container.bounds.top + this.container.styles.transformOrigin[1].number;
                var matrix = this.container.styles.transform;
                this.effects.push(new TransformEffect(offsetX, offsetY, matrix));
            }
            if (this.container.styles.overflowX !== OVERFLOW.VISIBLE) {
                var borderBox = calculateBorderBoxPath(this.curves);
                var paddingBox = calculatePaddingBoxPath(this.curves);
                if (equalPath(borderBox, paddingBox)) {
                    this.effects.push(new ClipEffect(borderBox, 2 /* BACKGROUND_BORDERS */ | 4 /* CONTENT */));
                }
                else {
                    this.effects.push(new ClipEffect(borderBox, 2 /* BACKGROUND_BORDERS */));
                    this.effects.push(new ClipEffect(paddingBox, 4 /* CONTENT */));
                }
            }
        }
        ElementPaint.prototype.getEffects = function (target) {
            var inFlow = [POSITION.ABSOLUTE, POSITION.FIXED].indexOf(this.container.styles.position) === -1;
            var parent = this.parent;
            var effects = this.effects.slice(0);
            while (parent) {
                var croplessEffects = parent.effects.filter(function (effect) { return !isClipEffect(effect); });
                if (inFlow || parent.container.styles.position !== POSITION.STATIC || !parent.parent) {
                    effects.unshift.apply(effects, croplessEffects);
                    inFlow = [POSITION.ABSOLUTE, POSITION.FIXED].indexOf(parent.container.styles.position) === -1;
                    if (parent.container.styles.overflowX !== OVERFLOW.VISIBLE) {
                        var borderBox = calculateBorderBoxPath(parent.curves);
                        var paddingBox = calculatePaddingBoxPath(parent.curves);
                        if (!equalPath(borderBox, paddingBox)) {
                            effects.unshift(new ClipEffect(paddingBox, 2 /* BACKGROUND_BORDERS */ | 4 /* CONTENT */));
                        }
                    }
                }
                else {
                    effects.unshift.apply(effects, croplessEffects);
                }
                parent = parent.parent;
            }
            return effects.filter(function (effect) { return contains(effect.target, target); });
        };
        return ElementPaint;
    }());
    var parseStackTree = function (parent, stackingContext, realStackingContext, listItems) {
        parent.container.elements.forEach(function (child) {
            var treatAsRealStackingContext = contains(child.flags, 4 /* CREATES_REAL_STACKING_CONTEXT */);
            var createsStackingContext = contains(child.flags, 2 /* CREATES_STACKING_CONTEXT */);
            var paintContainer = new ElementPaint(child, parent);
            if (contains(child.styles.display, 2048 /* LIST_ITEM */)) {
                listItems.push(paintContainer);
            }
            var listOwnerItems = contains(child.flags, 8 /* IS_LIST_OWNER */) ? [] : listItems;
            if (treatAsRealStackingContext || createsStackingContext) {
                var parentStack = treatAsRealStackingContext || child.styles.isPositioned() ? realStackingContext : stackingContext;
                var stack = new StackingContext(paintContainer);
                if (child.styles.isPositioned() || child.styles.opacity < 1 || child.styles.isTransformed()) {
                    var order_1 = child.styles.zIndex.order;
                    if (order_1 < 0) {
                        var index_1 = 0;
                        parentStack.negativeZIndex.some(function (current, i) {
                            if (order_1 > current.element.container.styles.zIndex.order) {
                                index_1 = i;
                                return false;
                            }
                            else if (index_1 > 0) {
                                return true;
                            }
                            return false;
                        });
                        parentStack.negativeZIndex.splice(index_1, 0, stack);
                    }
                    else if (order_1 > 0) {
                        var index_2 = 0;
                        parentStack.positiveZIndex.some(function (current, i) {
                            if (order_1 >= current.element.container.styles.zIndex.order) {
                                index_2 = i + 1;
                                return false;
                            }
                            else if (index_2 > 0) {
                                return true;
                            }
                            return false;
                        });
                        parentStack.positiveZIndex.splice(index_2, 0, stack);
                    }
                    else {
                        parentStack.zeroOrAutoZIndexOrTransformedOrOpacity.push(stack);
                    }
                }
                else {
                    if (child.styles.isFloating()) {
                        parentStack.nonPositionedFloats.push(stack);
                    }
                    else {
                        parentStack.nonPositionedInlineLevel.push(stack);
                    }
                }
                parseStackTree(paintContainer, stack, treatAsRealStackingContext ? stack : realStackingContext, listOwnerItems);
            }
            else {
                if (child.styles.isInlineLevel()) {
                    stackingContext.inlineLevel.push(paintContainer);
                }
                else {
                    stackingContext.nonInlineLevel.push(paintContainer);
                }
                parseStackTree(paintContainer, stackingContext, realStackingContext, listOwnerItems);
            }
            if (contains(child.flags, 8 /* IS_LIST_OWNER */)) {
                processListItems(child, listOwnerItems);
            }
        });
    };
    var processListItems = function (owner, elements) {
        var numbering = owner instanceof OLElementContainer ? owner.start : 1;
        var reversed = owner instanceof OLElementContainer ? owner.reversed : false;
        for (var i = 0; i < elements.length; i++) {
            var item = elements[i];
            if (item.container instanceof LIElementContainer &&
                typeof item.container.value === 'number' &&
                item.container.value !== 0) {
                numbering = item.container.value;
            }
            item.listValue = createCounterText(numbering, item.container.styles.listStyleType, true);
            numbering += reversed ? -1 : 1;
        }
    };
    var parseStackingContexts = function (container) {
        var paintContainer = new ElementPaint(container, null);
        var root = new StackingContext(paintContainer);
        var listItems = [];
        parseStackTree(paintContainer, root, root, listItems);
        processListItems(paintContainer.container, listItems);
        return root;
    };

    var parsePathForBorder = function (curves, borderSide) {
        switch (borderSide) {
            case 0:
                return createPathFromCurves(curves.topLeftBorderBox, curves.topLeftPaddingBox, curves.topRightBorderBox, curves.topRightPaddingBox);
            case 1:
                return createPathFromCurves(curves.topRightBorderBox, curves.topRightPaddingBox, curves.bottomRightBorderBox, curves.bottomRightPaddingBox);
            case 2:
                return createPathFromCurves(curves.bottomRightBorderBox, curves.bottomRightPaddingBox, curves.bottomLeftBorderBox, curves.bottomLeftPaddingBox);
            case 3:
            default:
                return createPathFromCurves(curves.bottomLeftBorderBox, curves.bottomLeftPaddingBox, curves.topLeftBorderBox, curves.topLeftPaddingBox);
        }
    };
    var parsePathForBorderDoubleOuter = function (curves, borderSide) {
        switch (borderSide) {
            case 0:
                return createPathFromCurves(curves.topLeftBorderBox, curves.topLeftBorderDoubleOuterBox, curves.topRightBorderBox, curves.topRightBorderDoubleOuterBox);
            case 1:
                return createPathFromCurves(curves.topRightBorderBox, curves.topRightBorderDoubleOuterBox, curves.bottomRightBorderBox, curves.bottomRightBorderDoubleOuterBox);
            case 2:
                return createPathFromCurves(curves.bottomRightBorderBox, curves.bottomRightBorderDoubleOuterBox, curves.bottomLeftBorderBox, curves.bottomLeftBorderDoubleOuterBox);
            case 3:
            default:
                return createPathFromCurves(curves.bottomLeftBorderBox, curves.bottomLeftBorderDoubleOuterBox, curves.topLeftBorderBox, curves.topLeftBorderDoubleOuterBox);
        }
    };
    var parsePathForBorderDoubleInner = function (curves, borderSide) {
        switch (borderSide) {
            case 0:
                return createPathFromCurves(curves.topLeftBorderDoubleInnerBox, curves.topLeftPaddingBox, curves.topRightBorderDoubleInnerBox, curves.topRightPaddingBox);
            case 1:
                return createPathFromCurves(curves.topRightBorderDoubleInnerBox, curves.topRightPaddingBox, curves.bottomRightBorderDoubleInnerBox, curves.bottomRightPaddingBox);
            case 2:
                return createPathFromCurves(curves.bottomRightBorderDoubleInnerBox, curves.bottomRightPaddingBox, curves.bottomLeftBorderDoubleInnerBox, curves.bottomLeftPaddingBox);
            case 3:
            default:
                return createPathFromCurves(curves.bottomLeftBorderDoubleInnerBox, curves.bottomLeftPaddingBox, curves.topLeftBorderDoubleInnerBox, curves.topLeftPaddingBox);
        }
    };
    var parsePathForBorderStroke = function (curves, borderSide) {
        switch (borderSide) {
            case 0:
                return createStrokePathFromCurves(curves.topLeftBorderStroke, curves.topRightBorderStroke);
            case 1:
                return createStrokePathFromCurves(curves.topRightBorderStroke, curves.bottomRightBorderStroke);
            case 2:
                return createStrokePathFromCurves(curves.bottomRightBorderStroke, curves.bottomLeftBorderStroke);
            case 3:
            default:
                return createStrokePathFromCurves(curves.bottomLeftBorderStroke, curves.topLeftBorderStroke);
        }
    };
    var createStrokePathFromCurves = function (outer1, outer2) {
        var path = [];
        if (isBezierCurve(outer1)) {
            path.push(outer1.subdivide(0.5, false));
        }
        else {
            path.push(outer1);
        }
        if (isBezierCurve(outer2)) {
            path.push(outer2.subdivide(0.5, true));
        }
        else {
            path.push(outer2);
        }
        return path;
    };
    var createPathFromCurves = function (outer1, inner1, outer2, inner2) {
        var path = [];
        if (isBezierCurve(outer1)) {
            path.push(outer1.subdivide(0.5, false));
        }
        else {
            path.push(outer1);
        }
        if (isBezierCurve(outer2)) {
            path.push(outer2.subdivide(0.5, true));
        }
        else {
            path.push(outer2);
        }
        if (isBezierCurve(inner2)) {
            path.push(inner2.subdivide(0.5, true).reverse());
        }
        else {
            path.push(inner2);
        }
        if (isBezierCurve(inner1)) {
            path.push(inner1.subdivide(0.5, false).reverse());
        }
        else {
            path.push(inner1);
        }
        return path;
    };

    var paddingBox = function (element) {
        var bounds = element.bounds;
        var styles = element.styles;
        return bounds.add(styles.borderLeftWidth, styles.borderTopWidth, -(styles.borderRightWidth + styles.borderLeftWidth), -(styles.borderTopWidth + styles.borderBottomWidth));
    };
    var contentBox = function (element) {
        var styles = element.styles;
        var bounds = element.bounds;
        var paddingLeft = getAbsoluteValue(styles.paddingLeft, bounds.width);
        var paddingRight = getAbsoluteValue(styles.paddingRight, bounds.width);
        var paddingTop = getAbsoluteValue(styles.paddingTop, bounds.width);
        var paddingBottom = getAbsoluteValue(styles.paddingBottom, bounds.width);
        return bounds.add(paddingLeft + styles.borderLeftWidth, paddingTop + styles.borderTopWidth, -(styles.borderRightWidth + styles.borderLeftWidth + paddingLeft + paddingRight), -(styles.borderTopWidth + styles.borderBottomWidth + paddingTop + paddingBottom));
    };

    var calculateBackgroundPositioningArea = function (backgroundOrigin, element) {
        if (backgroundOrigin === 0 /* BORDER_BOX */) {
            return element.bounds;
        }
        if (backgroundOrigin === 2 /* CONTENT_BOX */) {
            return contentBox(element);
        }
        return paddingBox(element);
    };
    var calculateBackgroundPaintingArea = function (backgroundClip, element) {
        if (backgroundClip === BACKGROUND_CLIP.BORDER_BOX) {
            return element.bounds;
        }
        if (backgroundClip === BACKGROUND_CLIP.CONTENT_BOX) {
            return contentBox(element);
        }
        return paddingBox(element);
    };
    var calculateBackgroundRendering = function (container, index, intrinsicSize) {
        var backgroundPositioningArea = calculateBackgroundPositioningArea(getBackgroundValueForIndex(container.styles.backgroundOrigin, index), container);
        var backgroundPaintingArea = calculateBackgroundPaintingArea(getBackgroundValueForIndex(container.styles.backgroundClip, index), container);
        var backgroundImageSize = calculateBackgroundSize(getBackgroundValueForIndex(container.styles.backgroundSize, index), intrinsicSize, backgroundPositioningArea);
        var sizeWidth = backgroundImageSize[0], sizeHeight = backgroundImageSize[1];
        var position = getAbsoluteValueForTuple(getBackgroundValueForIndex(container.styles.backgroundPosition, index), backgroundPositioningArea.width - sizeWidth, backgroundPositioningArea.height - sizeHeight);
        var path = calculateBackgroundRepeatPath(getBackgroundValueForIndex(container.styles.backgroundRepeat, index), position, backgroundImageSize, backgroundPositioningArea, backgroundPaintingArea);
        var offsetX = Math.round(backgroundPositioningArea.left + position[0]);
        var offsetY = Math.round(backgroundPositioningArea.top + position[1]);
        return [path, offsetX, offsetY, sizeWidth, sizeHeight];
    };
    var isAuto = function (token) { return isIdentToken(token) && token.value === BACKGROUND_SIZE.AUTO; };
    var hasIntrinsicValue = function (value) { return typeof value === 'number'; };
    var calculateBackgroundSize = function (size, _a, bounds) {
        var intrinsicWidth = _a[0], intrinsicHeight = _a[1], intrinsicProportion = _a[2];
        var first = size[0], second = size[1];
        if (!first) {
            return [0, 0];
        }
        if (isLengthPercentage(first) && second && isLengthPercentage(second)) {
            return [getAbsoluteValue(first, bounds.width), getAbsoluteValue(second, bounds.height)];
        }
        var hasIntrinsicProportion = hasIntrinsicValue(intrinsicProportion);
        if (isIdentToken(first) && (first.value === BACKGROUND_SIZE.CONTAIN || first.value === BACKGROUND_SIZE.COVER)) {
            if (hasIntrinsicValue(intrinsicProportion)) {
                var targetRatio = bounds.width / bounds.height;
                return targetRatio < intrinsicProportion !== (first.value === BACKGROUND_SIZE.COVER)
                    ? [bounds.width, bounds.width / intrinsicProportion]
                    : [bounds.height * intrinsicProportion, bounds.height];
            }
            return [bounds.width, bounds.height];
        }
        var hasIntrinsicWidth = hasIntrinsicValue(intrinsicWidth);
        var hasIntrinsicHeight = hasIntrinsicValue(intrinsicHeight);
        var hasIntrinsicDimensions = hasIntrinsicWidth || hasIntrinsicHeight;
        // If the background-size is auto or auto auto:
        if (isAuto(first) && (!second || isAuto(second))) {
            // If the image has both horizontal and vertical intrinsic dimensions, it's rendered at that size.
            if (hasIntrinsicWidth && hasIntrinsicHeight) {
                return [intrinsicWidth, intrinsicHeight];
            }
            // If the image has no intrinsic dimensions and has no intrinsic proportions,
            // it's rendered at the size of the background positioning area.
            if (!hasIntrinsicProportion && !hasIntrinsicDimensions) {
                return [bounds.width, bounds.height];
            }
            // TODO If the image has no intrinsic dimensions but has intrinsic proportions, it's rendered as if contain had been specified instead.
            // If the image has only one intrinsic dimension and has intrinsic proportions, it's rendered at the size corresponding to that one dimension.
            // The other dimension is computed using the specified dimension and the intrinsic proportions.
            if (hasIntrinsicDimensions && hasIntrinsicProportion) {
                var width_1 = hasIntrinsicWidth
                    ? intrinsicWidth
                    : intrinsicHeight * intrinsicProportion;
                var height_1 = hasIntrinsicHeight
                    ? intrinsicHeight
                    : intrinsicWidth / intrinsicProportion;
                return [width_1, height_1];
            }
            // If the image has only one intrinsic dimension but has no intrinsic proportions,
            // it's rendered using the specified dimension and the other dimension of the background positioning area.
            var width_2 = hasIntrinsicWidth ? intrinsicWidth : bounds.width;
            var height_2 = hasIntrinsicHeight ? intrinsicHeight : bounds.height;
            return [width_2, height_2];
        }
        // If the image has intrinsic proportions, it's stretched to the specified dimension.
        // The unspecified dimension is computed using the specified dimension and the intrinsic proportions.
        if (hasIntrinsicProportion) {
            var width_3 = 0;
            var height_3 = 0;
            if (isLengthPercentage(first)) {
                width_3 = getAbsoluteValue(first, bounds.width);
            }
            else if (isLengthPercentage(second)) {
                height_3 = getAbsoluteValue(second, bounds.height);
            }
            if (isAuto(first)) {
                width_3 = height_3 * intrinsicProportion;
            }
            else if (!second || isAuto(second)) {
                height_3 = width_3 / intrinsicProportion;
            }
            return [width_3, height_3];
        }
        // If the image has no intrinsic proportions, it's stretched to the specified dimension.
        // The unspecified dimension is computed using the image's corresponding intrinsic dimension,
        // if there is one. If there is no such intrinsic dimension,
        // it becomes the corresponding dimension of the background positioning area.
        var width = null;
        var height = null;
        if (isLengthPercentage(first)) {
            width = getAbsoluteValue(first, bounds.width);
        }
        else if (second && isLengthPercentage(second)) {
            height = getAbsoluteValue(second, bounds.height);
        }
        if (width !== null && (!second || isAuto(second))) {
            height =
                hasIntrinsicWidth && hasIntrinsicHeight
                    ? (width / intrinsicWidth) * intrinsicHeight
                    : bounds.height;
        }
        if (height !== null && isAuto(first)) {
            width =
                hasIntrinsicWidth && hasIntrinsicHeight
                    ? (height / intrinsicHeight) * intrinsicWidth
                    : bounds.width;
        }
        if (width !== null && height !== null) {
            return [width, height];
        }
        throw new Error("Unable to calculate background-size for element");
    };
    var getBackgroundValueForIndex = function (values, index) {
        var value = values[index];
        if (typeof value === 'undefined') {
            return values[0];
        }
        return value;
    };
    var calculateBackgroundRepeatPath = function (repeat, _a, _b, backgroundPositioningArea, backgroundPaintingArea) {
        var x = _a[0], y = _a[1];
        var width = _b[0], height = _b[1];
        switch (repeat) {
            case BACKGROUND_REPEAT.REPEAT_X:
                return [
                    new Vector(Math.round(backgroundPositioningArea.left), Math.round(backgroundPositioningArea.top + y)),
                    new Vector(Math.round(backgroundPositioningArea.left + backgroundPositioningArea.width), Math.round(backgroundPositioningArea.top + y)),
                    new Vector(Math.round(backgroundPositioningArea.left + backgroundPositioningArea.width), Math.round(height + backgroundPositioningArea.top + y)),
                    new Vector(Math.round(backgroundPositioningArea.left), Math.round(height + backgroundPositioningArea.top + y))
                ];
            case BACKGROUND_REPEAT.REPEAT_Y:
                return [
                    new Vector(Math.round(backgroundPositioningArea.left + x), Math.round(backgroundPositioningArea.top)),
                    new Vector(Math.round(backgroundPositioningArea.left + x + width), Math.round(backgroundPositioningArea.top)),
                    new Vector(Math.round(backgroundPositioningArea.left + x + width), Math.round(backgroundPositioningArea.height + backgroundPositioningArea.top)),
                    new Vector(Math.round(backgroundPositioningArea.left + x), Math.round(backgroundPositioningArea.height + backgroundPositioningArea.top))
                ];
            case BACKGROUND_REPEAT.NO_REPEAT:
                return [
                    new Vector(Math.round(backgroundPositioningArea.left + x), Math.round(backgroundPositioningArea.top + y)),
                    new Vector(Math.round(backgroundPositioningArea.left + x + width), Math.round(backgroundPositioningArea.top + y)),
                    new Vector(Math.round(backgroundPositioningArea.left + x + width), Math.round(backgroundPositioningArea.top + y + height)),
                    new Vector(Math.round(backgroundPositioningArea.left + x), Math.round(backgroundPositioningArea.top + y + height))
                ];
            default:
                return [
                    new Vector(Math.round(backgroundPaintingArea.left), Math.round(backgroundPaintingArea.top)),
                    new Vector(Math.round(backgroundPaintingArea.left + backgroundPaintingArea.width), Math.round(backgroundPaintingArea.top)),
                    new Vector(Math.round(backgroundPaintingArea.left + backgroundPaintingArea.width), Math.round(backgroundPaintingArea.height + backgroundPaintingArea.top)),
                    new Vector(Math.round(backgroundPaintingArea.left), Math.round(backgroundPaintingArea.height + backgroundPaintingArea.top))
                ];
        }
    };

    var SMALL_IMAGE = 'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7';

    var SAMPLE_TEXT = 'Hidden Text';
    var FontMetrics = /** @class */ (function () {
        function FontMetrics(document) {
            this._data = {};
            this._document = document;
        }
        FontMetrics.prototype.parseMetrics = function (fontFamily, fontSize) {
            var container = this._document.createElement('div');
            var img = this._document.createElement('img');
            var span = this._document.createElement('span');
            var body = this._document.body;
            container.style.visibility = 'hidden';
            container.style.fontFamily = fontFamily;
            container.style.fontSize = fontSize;
            container.style.margin = '0';
            container.style.padding = '0';
            body.appendChild(container);
            img.src = SMALL_IMAGE;
            img.width = 1;
            img.height = 1;
            img.style.margin = '0';
            img.style.padding = '0';
            img.style.verticalAlign = 'baseline';
            span.style.fontFamily = fontFamily;
            span.style.fontSize = fontSize;
            span.style.margin = '0';
            span.style.padding = '0';
            span.appendChild(this._document.createTextNode(SAMPLE_TEXT));
            container.appendChild(span);
            container.appendChild(img);
            var baseline = img.offsetTop - span.offsetTop + 2;
            container.removeChild(span);
            container.appendChild(this._document.createTextNode(SAMPLE_TEXT));
            container.style.lineHeight = 'normal';
            img.style.verticalAlign = 'super';
            var middle = img.offsetTop - container.offsetTop + 2;
            body.removeChild(container);
            return { baseline: baseline, middle: middle };
        };
        FontMetrics.prototype.getMetrics = function (fontFamily, fontSize) {
            var key = fontFamily + " " + fontSize;
            if (typeof this._data[key] === 'undefined') {
                this._data[key] = this.parseMetrics(fontFamily, fontSize);
            }
            return this._data[key];
        };
        return FontMetrics;
    }());

    var Renderer = /** @class */ (function () {
        function Renderer(context, options) {
            this.context = context;
            this.options = options;
        }
        return Renderer;
    }());

    var MASK_OFFSET = 10000;
    var CanvasRenderer = /** @class */ (function (_super) {
        __extends(CanvasRenderer, _super);
        function CanvasRenderer(context, options) {
            var _this = _super.call(this, context, options) || this;
            _this._activeEffects = [];
            _this.canvas = options.canvas ? options.canvas : document.createElement('canvas');
            _this.ctx = _this.canvas.getContext('2d');
            if (!options.canvas) {
                _this.canvas.width = Math.floor(options.width * options.scale);
                _this.canvas.height = Math.floor(options.height * options.scale);
                _this.canvas.style.width = options.width + "px";
                _this.canvas.style.height = options.height + "px";
            }
            _this.fontMetrics = new FontMetrics(document);
            _this.ctx.scale(_this.options.scale, _this.options.scale);
            _this.ctx.translate(-options.x, -options.y);
            _this.ctx.textBaseline = 'bottom';
            _this._activeEffects = [];
            _this.context.logger.debug("Canvas renderer initialized (" + options.width + "x" + options.height + ") with scale " + options.scale);
            return _this;
        }
        CanvasRenderer.prototype.applyEffects = function (effects) {
            var _this = this;
            while (this._activeEffects.length) {
                this.popEffect();
            }
            effects.forEach(function (effect) { return _this.applyEffect(effect); });
        };
        CanvasRenderer.prototype.applyEffect = function (effect) {
            this.ctx.save();
            if (isOpacityEffect(effect)) {
                this.ctx.globalAlpha = effect.opacity;
            }
            if (isTransformEffect(effect)) {
                this.ctx.translate(effect.offsetX, effect.offsetY);
                this.ctx.transform(effect.matrix[0], effect.matrix[1], effect.matrix[2], effect.matrix[3], effect.matrix[4], effect.matrix[5]);
                this.ctx.translate(-effect.offsetX, -effect.offsetY);
            }
            if (isClipEffect(effect)) {
                this.path(effect.path);
                this.ctx.clip();
            }
            this._activeEffects.push(effect);
        };
        CanvasRenderer.prototype.popEffect = function () {
            this._activeEffects.pop();
            this.ctx.restore();
        };
        CanvasRenderer.prototype.renderStack = function (stack) {
            return __awaiter(this, void 0, void 0, function () {
                var styles;
                return __generator(this, function (_a) {
                    switch (_a.label) {
                        case 0:
                            styles = stack.element.container.styles;
                            if (!styles.isVisible()) return [3 /*break*/, 2];
                            return [4 /*yield*/, this.renderStackContent(stack)];
                        case 1:
                            _a.sent();
                            _a.label = 2;
                        case 2: return [2 /*return*/];
                    }
                });
            });
        };
        CanvasRenderer.prototype.renderNode = function (paint) {
            return __awaiter(this, void 0, void 0, function () {
                return __generator(this, function (_a) {
                    switch (_a.label) {
                        case 0:
                            if (contains(paint.container.flags, 16 /* DEBUG_RENDER */)) {
                                debugger;
                            }
                            if (!paint.container.styles.isVisible()) return [3 /*break*/, 3];
                            return [4 /*yield*/, this.renderNodeBackgroundAndBorders(paint)];
                        case 1:
                            _a.sent();
                            return [4 /*yield*/, this.renderNodeContent(paint)];
                        case 2:
                            _a.sent();
                            _a.label = 3;
                        case 3: return [2 /*return*/];
                    }
                });
            });
        };
        CanvasRenderer.prototype.renderTextWithLetterSpacing = function (text, letterSpacing, baseline) {
            var _this = this;
            if (letterSpacing === 0) {
                this.ctx.fillText(text.text, text.bounds.left, text.bounds.top + baseline);
            }
            else {
                var letters = splitGraphemes(text.text);
                letters.reduce(function (left, letter) {
                    _this.ctx.fillText(letter, left, text.bounds.top + baseline);
                    return left + _this.ctx.measureText(letter).width;
                }, text.bounds.left);
            }
        };
        CanvasRenderer.prototype.createFontStyle = function (styles) {
            var fontVariant = styles.fontVariant
                .filter(function (variant) { return variant === 'normal' || variant === 'small-caps'; })
                .join('');
            var fontFamily = styles.fontFamily.join(', ');
            var fontSize = isDimensionToken(styles.fontSize)
                ? "" + styles.fontSize.number + styles.fontSize.unit
                : styles.fontSize.number + "px";
            return [
                [styles.fontStyle, fontVariant, styles.fontWeight, fontSize, fontFamily].join(' '),
                fontFamily,
                fontSize
            ];
        };
        CanvasRenderer.prototype.renderTextNode = function (text, styles) {
            return __awaiter(this, void 0, void 0, function () {
                var _a, font, fontFamily, fontSize, _b, baseline, middle, paintOrder;
                var _this = this;
                return __generator(this, function (_c) {
                    _a = this.createFontStyle(styles), font = _a[0], fontFamily = _a[1], fontSize = _a[2];
                    this.ctx.font = font;
                    this.ctx.direction = styles.direction === 1 /* RTL */ ? 'rtl' : 'ltr';
                    this.ctx.textAlign = 'left';
                    this.ctx.textBaseline = 'alphabetic';
                    _b = this.fontMetrics.getMetrics(fontFamily, fontSize), baseline = _b.baseline, middle = _b.middle;
                    paintOrder = styles.paintOrder;
                    text.textBounds.forEach(function (text) {
                        paintOrder.forEach(function (paintOrderLayer) {
                            switch (paintOrderLayer) {
                                case PAINT_ORDER_LAYER.FILL:
                                    _this.ctx.fillStyle = asString(styles.color);
                                    _this.renderTextWithLetterSpacing(text, styles.letterSpacing, baseline);
                                    var textShadows = styles.textShadow;
                                    if (textShadows.length && text.text.trim().length) {
                                        textShadows
                                            .slice(0)
                                            .reverse()
                                            .forEach(function (textShadow) {
                                            _this.ctx.shadowColor = asString(textShadow.color);
                                            _this.ctx.shadowOffsetX = textShadow.offsetX.number * _this.options.scale;
                                            _this.ctx.shadowOffsetY = textShadow.offsetY.number * _this.options.scale;
                                            _this.ctx.shadowBlur = textShadow.blur.number;
                                            _this.renderTextWithLetterSpacing(text, styles.letterSpacing, baseline);
                                        });
                                        _this.ctx.shadowColor = '';
                                        _this.ctx.shadowOffsetX = 0;
                                        _this.ctx.shadowOffsetY = 0;
                                        _this.ctx.shadowBlur = 0;
                                    }
                                    if (styles.textDecorationLine.length) {
                                        _this.ctx.fillStyle = asString(styles.textDecorationColor || styles.color);
                                        styles.textDecorationLine.forEach(function (textDecorationLine) {
                                            switch (textDecorationLine) {
                                                case 1 /* UNDERLINE */:
                                                    // Draws a line at the baseline of the font
                                                    // TODO As some browsers display the line as more than 1px if the font-size is big,
                                                    // need to take that into account both in position and size
                                                    _this.ctx.fillRect(text.bounds.left, Math.round(text.bounds.top + baseline), text.bounds.width, 1);
                                                    break;
                                                case 2 /* OVERLINE */:
                                                    _this.ctx.fillRect(text.bounds.left, Math.round(text.bounds.top), text.bounds.width, 1);
                                                    break;
                                                case 3 /* LINE_THROUGH */:
                                                    // TODO try and find exact position for line-through
                                                    _this.ctx.fillRect(text.bounds.left, Math.ceil(text.bounds.top + middle), text.bounds.width, 1);
                                                    break;
                                            }
                                        });
                                    }
                                    break;
                                case PAINT_ORDER_LAYER.STROKE:
                                    if (styles.webkitTextStrokeWidth && text.text.trim().length) {
                                        _this.ctx.strokeStyle = asString(styles.webkitTextStrokeColor);
                                        _this.ctx.lineWidth = styles.webkitTextStrokeWidth;
                                        // eslint-disable-next-line @typescript-eslint/no-explicit-any
                                        _this.ctx.lineJoin = !!window.chrome ? 'miter' : 'round';
                                        _this.ctx.strokeText(text.text, text.bounds.left, text.bounds.top + baseline);
                                    }
                                    _this.ctx.strokeStyle = '';
                                    _this.ctx.lineWidth = 0;
                                    _this.ctx.lineJoin = 'miter';
                                    break;
                            }
                        });
                    });
                    return [2 /*return*/];
                });
            });
        };
        CanvasRenderer.prototype.renderReplacedElement = function (container, curves, image) {
            if (image && container.intrinsicWidth > 0 && container.intrinsicHeight > 0) {
                var box = contentBox(container);
                var path = calculatePaddingBoxPath(curves);
                this.path(path);
                this.ctx.save();
                this.ctx.clip();
                this.ctx.drawImage(image, 0, 0, container.intrinsicWidth, container.intrinsicHeight, box.left, box.top, box.width, box.height);
                this.ctx.restore();
            }
        };
        CanvasRenderer.prototype.renderNodeContent = function (paint) {
            return __awaiter(this, void 0, void 0, function () {
                var container, curves, styles, _i, _a, child, image, image, iframeRenderer, canvas, size, _b, fontFamily, fontSize, baseline, bounds, x, textBounds, img, image, url, fontFamily, bounds;
                return __generator(this, function (_c) {
                    switch (_c.label) {
                        case 0:
                            this.applyEffects(paint.getEffects(4 /* CONTENT */));
                            container = paint.container;
                            curves = paint.curves;
                            styles = container.styles;
                            _i = 0, _a = container.textNodes;
                            _c.label = 1;
                        case 1:
                            if (!(_i < _a.length)) return [3 /*break*/, 4];
                            child = _a[_i];
                            return [4 /*yield*/, this.renderTextNode(child, styles)];
                        case 2:
                            _c.sent();
                            _c.label = 3;
                        case 3:
                            _i++;
                            return [3 /*break*/, 1];
                        case 4:
                            if (!(container instanceof ImageElementContainer)) return [3 /*break*/, 8];
                            _c.label = 5;
                        case 5:
                            _c.trys.push([5, 7, , 8]);
                            return [4 /*yield*/, this.context.cache.match(container.src)];
                        case 6:
                            image = _c.sent();
                            this.renderReplacedElement(container, curves, image);
                            return [3 /*break*/, 8];
                        case 7:
                            _c.sent();
                            this.context.logger.error("Error loading image " + container.src);
                            return [3 /*break*/, 8];
                        case 8:
                            if (container instanceof CanvasElementContainer) {
                                this.renderReplacedElement(container, curves, container.canvas);
                            }
                            if (!(container instanceof SVGElementContainer)) return [3 /*break*/, 12];
                            _c.label = 9;
                        case 9:
                            _c.trys.push([9, 11, , 12]);
                            return [4 /*yield*/, this.context.cache.match(container.svg)];
                        case 10:
                            image = _c.sent();
                            this.renderReplacedElement(container, curves, image);
                            return [3 /*break*/, 12];
                        case 11:
                            _c.sent();
                            this.context.logger.error("Error loading svg " + container.svg.substring(0, 255));
                            return [3 /*break*/, 12];
                        case 12:
                            if (!(container instanceof IFrameElementContainer && container.tree)) return [3 /*break*/, 14];
                            iframeRenderer = new CanvasRenderer(this.context, {
                                scale: this.options.scale,
                                backgroundColor: container.backgroundColor,
                                x: 0,
                                y: 0,
                                width: container.width,
                                height: container.height
                            });
                            return [4 /*yield*/, iframeRenderer.render(container.tree)];
                        case 13:
                            canvas = _c.sent();
                            if (container.width && container.height) {
                                this.ctx.drawImage(canvas, 0, 0, container.width, container.height, container.bounds.left, container.bounds.top, container.bounds.width, container.bounds.height);
                            }
                            _c.label = 14;
                        case 14:
                            if (container instanceof InputElementContainer) {
                                size = Math.min(container.bounds.width, container.bounds.height);
                                if (container.type === CHECKBOX) {
                                    if (container.checked) {
                                        this.ctx.save();
                                        this.path([
                                            new Vector(container.bounds.left + size * 0.39363, container.bounds.top + size * 0.79),
                                            new Vector(container.bounds.left + size * 0.16, container.bounds.top + size * 0.5549),
                                            new Vector(container.bounds.left + size * 0.27347, container.bounds.top + size * 0.44071),
                                            new Vector(container.bounds.left + size * 0.39694, container.bounds.top + size * 0.5649),
                                            new Vector(container.bounds.left + size * 0.72983, container.bounds.top + size * 0.23),
                                            new Vector(container.bounds.left + size * 0.84, container.bounds.top + size * 0.34085),
                                            new Vector(container.bounds.left + size * 0.39363, container.bounds.top + size * 0.79)
                                        ]);
                                        this.ctx.fillStyle = asString(INPUT_COLOR);
                                        this.ctx.fill();
                                        this.ctx.restore();
                                    }
                                }
                                else if (container.type === RADIO) {
                                    if (container.checked) {
                                        this.ctx.save();
                                        this.ctx.beginPath();
                                        this.ctx.arc(container.bounds.left + size / 2, container.bounds.top + size / 2, size / 4, 0, Math.PI * 2, true);
                                        this.ctx.fillStyle = asString(INPUT_COLOR);
                                        this.ctx.fill();
                                        this.ctx.restore();
                                    }
                                }
                            }
                            if (isTextInputElement(container) && container.value.length) {
                                _b = this.createFontStyle(styles), fontFamily = _b[0], fontSize = _b[1];
                                baseline = this.fontMetrics.getMetrics(fontFamily, fontSize).baseline;
                                this.ctx.font = fontFamily;
                                this.ctx.fillStyle = asString(styles.color);
                                this.ctx.textBaseline = 'alphabetic';
                                this.ctx.textAlign = canvasTextAlign(container.styles.textAlign);
                                bounds = contentBox(container);
                                x = 0;
                                switch (container.styles.textAlign) {
                                    case TEXT_ALIGN.CENTER:
                                        x += bounds.width / 2;
                                        break;
                                    case TEXT_ALIGN.RIGHT:
                                        x += bounds.width;
                                        break;
                                }
                                textBounds = bounds.add(x, 0, 0, -bounds.height / 2 + 1);
                                this.ctx.save();
                                this.path([
                                    new Vector(bounds.left, bounds.top),
                                    new Vector(bounds.left + bounds.width, bounds.top),
                                    new Vector(bounds.left + bounds.width, bounds.top + bounds.height),
                                    new Vector(bounds.left, bounds.top + bounds.height)
                                ]);
                                this.ctx.clip();
                                this.renderTextWithLetterSpacing(new TextBounds(container.value, textBounds), styles.letterSpacing, baseline);
                                this.ctx.restore();
                                this.ctx.textBaseline = 'alphabetic';
                                this.ctx.textAlign = 'left';
                            }
                            if (!contains(container.styles.display, 2048 /* LIST_ITEM */)) return [3 /*break*/, 20];
                            if (!(container.styles.listStyleImage !== null)) return [3 /*break*/, 19];
                            img = container.styles.listStyleImage;
                            if (!(img.type === CSSImageType.URL)) return [3 /*break*/, 18];
                            image = void 0;
                            url = img.url;
                            _c.label = 15;
                        case 15:
                            _c.trys.push([15, 17, , 18]);
                            return [4 /*yield*/, this.context.cache.match(url)];
                        case 16:
                            image = _c.sent();
                            this.ctx.drawImage(image, container.bounds.left - (image.width + 10), container.bounds.top);
                            return [3 /*break*/, 18];
                        case 17:
                            _c.sent();
                            this.context.logger.error("Error loading list-style-image " + url);
                            return [3 /*break*/, 18];
                        case 18: return [3 /*break*/, 20];
                        case 19:
                            if (paint.listValue && container.styles.listStyleType !== LIST_STYLE_TYPE.NONE) {
                                fontFamily = this.createFontStyle(styles)[0];
                                this.ctx.font = fontFamily;
                                this.ctx.fillStyle = asString(styles.color);
                                this.ctx.textBaseline = 'middle';
                                this.ctx.textAlign = 'right';
                                bounds = new Bounds(container.bounds.left, container.bounds.top + getAbsoluteValue(container.styles.paddingTop, container.bounds.width), container.bounds.width, computeLineHeight(styles.lineHeight, styles.fontSize.number) / 2 + 1);
                                this.renderTextWithLetterSpacing(new TextBounds(paint.listValue, bounds), styles.letterSpacing, computeLineHeight(styles.lineHeight, styles.fontSize.number) / 2 + 2);
                                this.ctx.textBaseline = 'bottom';
                                this.ctx.textAlign = 'left';
                            }
                            _c.label = 20;
                        case 20: return [2 /*return*/];
                    }
                });
            });
        };
        CanvasRenderer.prototype.renderStackContent = function (stack) {
            return __awaiter(this, void 0, void 0, function () {
                var _i, _a, child, _b, _c, child, _d, _e, child, _f, _g, child, _h, _j, child, _k, _l, child, _m, _o, child;
                return __generator(this, function (_p) {
                    switch (_p.label) {
                        case 0:
                            if (contains(stack.element.container.flags, 16 /* DEBUG_RENDER */)) {
                                debugger;
                            }
                            // https://www.w3.org/TR/css-position-3/#painting-order
                            // 1. the background and borders of the element forming the stacking context.
                            return [4 /*yield*/, this.renderNodeBackgroundAndBorders(stack.element)];
                        case 1:
                            // https://www.w3.org/TR/css-position-3/#painting-order
                            // 1. the background and borders of the element forming the stacking context.
                            _p.sent();
                            _i = 0, _a = stack.negativeZIndex;
                            _p.label = 2;
                        case 2:
                            if (!(_i < _a.length)) return [3 /*break*/, 5];
                            child = _a[_i];
                            return [4 /*yield*/, this.renderStack(child)];
                        case 3:
                            _p.sent();
                            _p.label = 4;
                        case 4:
                            _i++;
                            return [3 /*break*/, 2];
                        case 5: 
                        // 3. For all its in-flow, non-positioned, block-level descendants in tree order:
                        return [4 /*yield*/, this.renderNodeContent(stack.element)];
                        case 6:
                            // 3. For all its in-flow, non-positioned, block-level descendants in tree order:
                            _p.sent();
                            _b = 0, _c = stack.nonInlineLevel;
                            _p.label = 7;
                        case 7:
                            if (!(_b < _c.length)) return [3 /*break*/, 10];
                            child = _c[_b];
                            return [4 /*yield*/, this.renderNode(child)];
                        case 8:
                            _p.sent();
                            _p.label = 9;
                        case 9:
                            _b++;
                            return [3 /*break*/, 7];
                        case 10:
                            _d = 0, _e = stack.nonPositionedFloats;
                            _p.label = 11;
                        case 11:
                            if (!(_d < _e.length)) return [3 /*break*/, 14];
                            child = _e[_d];
                            return [4 /*yield*/, this.renderStack(child)];
                        case 12:
                            _p.sent();
                            _p.label = 13;
                        case 13:
                            _d++;
                            return [3 /*break*/, 11];
                        case 14:
                            _f = 0, _g = stack.nonPositionedInlineLevel;
                            _p.label = 15;
                        case 15:
                            if (!(_f < _g.length)) return [3 /*break*/, 18];
                            child = _g[_f];
                            return [4 /*yield*/, this.renderStack(child)];
                        case 16:
                            _p.sent();
                            _p.label = 17;
                        case 17:
                            _f++;
                            return [3 /*break*/, 15];
                        case 18:
                            _h = 0, _j = stack.inlineLevel;
                            _p.label = 19;
                        case 19:
                            if (!(_h < _j.length)) return [3 /*break*/, 22];
                            child = _j[_h];
                            return [4 /*yield*/, this.renderNode(child)];
                        case 20:
                            _p.sent();
                            _p.label = 21;
                        case 21:
                            _h++;
                            return [3 /*break*/, 19];
                        case 22:
                            _k = 0, _l = stack.zeroOrAutoZIndexOrTransformedOrOpacity;
                            _p.label = 23;
                        case 23:
                            if (!(_k < _l.length)) return [3 /*break*/, 26];
                            child = _l[_k];
                            return [4 /*yield*/, this.renderStack(child)];
                        case 24:
                            _p.sent();
                            _p.label = 25;
                        case 25:
                            _k++;
                            return [3 /*break*/, 23];
                        case 26:
                            _m = 0, _o = stack.positiveZIndex;
                            _p.label = 27;
                        case 27:
                            if (!(_m < _o.length)) return [3 /*break*/, 30];
                            child = _o[_m];
                            return [4 /*yield*/, this.renderStack(child)];
                        case 28:
                            _p.sent();
                            _p.label = 29;
                        case 29:
                            _m++;
                            return [3 /*break*/, 27];
                        case 30: return [2 /*return*/];
                    }
                });
            });
        };
        CanvasRenderer.prototype.mask = function (paths) {
            this.ctx.beginPath();
            this.ctx.moveTo(0, 0);
            this.ctx.lineTo(this.canvas.width, 0);
            this.ctx.lineTo(this.canvas.width, this.canvas.height);
            this.ctx.lineTo(0, this.canvas.height);
            this.ctx.lineTo(0, 0);
            this.formatPath(paths.slice(0).reverse());
            this.ctx.closePath();
        };
        CanvasRenderer.prototype.path = function (paths) {
            this.ctx.beginPath();
            this.formatPath(paths);
            this.ctx.closePath();
        };
        CanvasRenderer.prototype.formatPath = function (paths) {
            var _this = this;
            paths.forEach(function (point, index) {
                var start = isBezierCurve(point) ? point.start : point;
                if (index === 0) {
                    _this.ctx.moveTo(start.x, start.y);
                }
                else {
                    _this.ctx.lineTo(start.x, start.y);
                }
                if (isBezierCurve(point)) {
                    _this.ctx.bezierCurveTo(point.startControl.x, point.startControl.y, point.endControl.x, point.endControl.y, point.end.x, point.end.y);
                }
            });
        };
        CanvasRenderer.prototype.renderRepeat = function (path, pattern, offsetX, offsetY) {
            this.path(path);
            this.ctx.fillStyle = pattern;
            this.ctx.translate(offsetX, offsetY);
            this.ctx.fill();
            this.ctx.translate(-offsetX, -offsetY);
        };
        CanvasRenderer.prototype.resizeImage = function (image, width, height) {
            var _a;
            if (image.width === width && image.height === height) {
                return image;
            }
            var ownerDocument = (_a = this.canvas.ownerDocument) !== null && _a !== void 0 ? _a : document;
            var canvas = ownerDocument.createElement('canvas');
            canvas.width = Math.max(1, width);
            canvas.height = Math.max(1, height);
            var ctx = canvas.getContext('2d');
            ctx.drawImage(image, 0, 0, image.width, image.height, 0, 0, width, height);
            return canvas;
        };
        CanvasRenderer.prototype.renderBackgroundImage = function (container) {
            return __awaiter(this, void 0, void 0, function () {
                var index, _loop_1, this_1, _i, _a, backgroundImage;
                return __generator(this, function (_b) {
                    switch (_b.label) {
                        case 0:
                            index = container.styles.backgroundImage.length - 1;
                            _loop_1 = function (backgroundImage) {
                                var image, url, _c, path, x, y, width, height, pattern, _d, path, x, y, width, height, _e, lineLength, x0, x1, y0, y1, canvas, ctx, gradient_1, pattern, _f, path, left, top_1, width, height, position, x, y, _g, rx, ry, radialGradient_1, midX, midY, f, invF;
                                return __generator(this, function (_h) {
                                    switch (_h.label) {
                                        case 0:
                                            if (!(backgroundImage.type === CSSImageType.URL)) return [3 /*break*/, 5];
                                            image = void 0;
                                            url = backgroundImage.url;
                                            _h.label = 1;
                                        case 1:
                                            _h.trys.push([1, 3, , 4]);
                                            return [4 /*yield*/, this_1.context.cache.match(url)];
                                        case 2:
                                            image = _h.sent();
                                            return [3 /*break*/, 4];
                                        case 3:
                                            _h.sent();
                                            this_1.context.logger.error("Error loading background-image " + url);
                                            return [3 /*break*/, 4];
                                        case 4:
                                            if (image) {
                                                _c = calculateBackgroundRendering(container, index, [
                                                    image.width,
                                                    image.height,
                                                    image.width / image.height
                                                ]), path = _c[0], x = _c[1], y = _c[2], width = _c[3], height = _c[4];
                                                pattern = this_1.ctx.createPattern(this_1.resizeImage(image, width, height), 'repeat');
                                                this_1.renderRepeat(path, pattern, x, y);
                                            }
                                            return [3 /*break*/, 6];
                                        case 5:
                                            if (isLinearGradient(backgroundImage)) {
                                                _d = calculateBackgroundRendering(container, index, [null, null, null]), path = _d[0], x = _d[1], y = _d[2], width = _d[3], height = _d[4];
                                                _e = calculateGradientDirection(backgroundImage.angle, width, height), lineLength = _e[0], x0 = _e[1], x1 = _e[2], y0 = _e[3], y1 = _e[4];
                                                canvas = document.createElement('canvas');
                                                canvas.width = width;
                                                canvas.height = height;
                                                ctx = canvas.getContext('2d');
                                                gradient_1 = ctx.createLinearGradient(x0, y0, x1, y1);
                                                processColorStops(backgroundImage.stops, lineLength).forEach(function (colorStop) {
                                                    return gradient_1.addColorStop(colorStop.stop, asString(colorStop.color));
                                                });
                                                ctx.fillStyle = gradient_1;
                                                ctx.fillRect(0, 0, width, height);
                                                if (width > 0 && height > 0) {
                                                    pattern = this_1.ctx.createPattern(canvas, 'repeat');
                                                    this_1.renderRepeat(path, pattern, x, y);
                                                }
                                            }
                                            else if (isRadialGradient(backgroundImage)) {
                                                _f = calculateBackgroundRendering(container, index, [
                                                    null,
                                                    null,
                                                    null
                                                ]), path = _f[0], left = _f[1], top_1 = _f[2], width = _f[3], height = _f[4];
                                                position = backgroundImage.position.length === 0 ? [FIFTY_PERCENT] : backgroundImage.position;
                                                x = getAbsoluteValue(position[0], width);
                                                y = getAbsoluteValue(position[position.length - 1], height);
                                                _g = calculateRadius(backgroundImage, x, y, width, height), rx = _g[0], ry = _g[1];
                                                if (rx > 0 && ry > 0) {
                                                    radialGradient_1 = this_1.ctx.createRadialGradient(left + x, top_1 + y, 0, left + x, top_1 + y, rx);
                                                    processColorStops(backgroundImage.stops, rx * 2).forEach(function (colorStop) {
                                                        return radialGradient_1.addColorStop(colorStop.stop, asString(colorStop.color));
                                                    });
                                                    this_1.path(path);
                                                    this_1.ctx.fillStyle = radialGradient_1;
                                                    if (rx !== ry) {
                                                        midX = container.bounds.left + 0.5 * container.bounds.width;
                                                        midY = container.bounds.top + 0.5 * container.bounds.height;
                                                        f = ry / rx;
                                                        invF = 1 / f;
                                                        this_1.ctx.save();
                                                        this_1.ctx.translate(midX, midY);
                                                        this_1.ctx.transform(1, 0, 0, f, 0, 0);
                                                        this_1.ctx.translate(-midX, -midY);
                                                        this_1.ctx.fillRect(left, invF * (top_1 - midY) + midY, width, height * invF);
                                                        this_1.ctx.restore();
                                                    }
                                                    else {
                                                        this_1.ctx.fill();
                                                    }
                                                }
                                            }
                                            _h.label = 6;
                                        case 6:
                                            index--;
                                            return [2 /*return*/];
                                    }
                                });
                            };
                            this_1 = this;
                            _i = 0, _a = container.styles.backgroundImage.slice(0).reverse();
                            _b.label = 1;
                        case 1:
                            if (!(_i < _a.length)) return [3 /*break*/, 4];
                            backgroundImage = _a[_i];
                            return [5 /*yield**/, _loop_1(backgroundImage)];
                        case 2:
                            _b.sent();
                            _b.label = 3;
                        case 3:
                            _i++;
                            return [3 /*break*/, 1];
                        case 4: return [2 /*return*/];
                    }
                });
            });
        };
        CanvasRenderer.prototype.renderSolidBorder = function (color, side, curvePoints) {
            return __awaiter(this, void 0, void 0, function () {
                return __generator(this, function (_a) {
                    this.path(parsePathForBorder(curvePoints, side));
                    this.ctx.fillStyle = asString(color);
                    this.ctx.fill();
                    return [2 /*return*/];
                });
            });
        };
        CanvasRenderer.prototype.renderDoubleBorder = function (color, width, side, curvePoints) {
            return __awaiter(this, void 0, void 0, function () {
                var outerPaths, innerPaths;
                return __generator(this, function (_a) {
                    switch (_a.label) {
                        case 0:
                            if (!(width < 3)) return [3 /*break*/, 2];
                            return [4 /*yield*/, this.renderSolidBorder(color, side, curvePoints)];
                        case 1:
                            _a.sent();
                            return [2 /*return*/];
                        case 2:
                            outerPaths = parsePathForBorderDoubleOuter(curvePoints, side);
                            this.path(outerPaths);
                            this.ctx.fillStyle = asString(color);
                            this.ctx.fill();
                            innerPaths = parsePathForBorderDoubleInner(curvePoints, side);
                            this.path(innerPaths);
                            this.ctx.fill();
                            return [2 /*return*/];
                    }
                });
            });
        };
        CanvasRenderer.prototype.renderNodeBackgroundAndBorders = function (paint) {
            return __awaiter(this, void 0, void 0, function () {
                var styles, hasBackground, borders, backgroundPaintingArea, side, _i, borders_1, border;
                var _this = this;
                return __generator(this, function (_a) {
                    switch (_a.label) {
                        case 0:
                            this.applyEffects(paint.getEffects(2 /* BACKGROUND_BORDERS */));
                            styles = paint.container.styles;
                            hasBackground = !isTransparent(styles.backgroundColor) || styles.backgroundImage.length;
                            borders = [
                                { style: styles.borderTopStyle, color: styles.borderTopColor, width: styles.borderTopWidth },
                                { style: styles.borderRightStyle, color: styles.borderRightColor, width: styles.borderRightWidth },
                                { style: styles.borderBottomStyle, color: styles.borderBottomColor, width: styles.borderBottomWidth },
                                { style: styles.borderLeftStyle, color: styles.borderLeftColor, width: styles.borderLeftWidth }
                            ];
                            backgroundPaintingArea = calculateBackgroundCurvedPaintingArea(getBackgroundValueForIndex(styles.backgroundClip, 0), paint.curves);
                            if (!(hasBackground || styles.boxShadow.length)) return [3 /*break*/, 2];
                            this.ctx.save();
                            this.path(backgroundPaintingArea);
                            this.ctx.clip();
                            if (!isTransparent(styles.backgroundColor)) {
                                this.ctx.fillStyle = asString(styles.backgroundColor);
                                this.ctx.fill();
                            }
                            return [4 /*yield*/, this.renderBackgroundImage(paint.container)];
                        case 1:
                            _a.sent();
                            this.ctx.restore();
                            styles.boxShadow
                                .slice(0)
                                .reverse()
                                .forEach(function (shadow) {
                                _this.ctx.save();
                                var borderBoxArea = calculateBorderBoxPath(paint.curves);
                                var maskOffset = shadow.inset ? 0 : MASK_OFFSET;
                                var shadowPaintingArea = transformPath(borderBoxArea, -maskOffset + (shadow.inset ? 1 : -1) * shadow.spread.number, (shadow.inset ? 1 : -1) * shadow.spread.number, shadow.spread.number * (shadow.inset ? -2 : 2), shadow.spread.number * (shadow.inset ? -2 : 2));
                                if (shadow.inset) {
                                    _this.path(borderBoxArea);
                                    _this.ctx.clip();
                                    _this.mask(shadowPaintingArea);
                                }
                                else {
                                    _this.mask(borderBoxArea);
                                    _this.ctx.clip();
                                    _this.path(shadowPaintingArea);
                                }
                                _this.ctx.shadowOffsetX = shadow.offsetX.number + maskOffset;
                                _this.ctx.shadowOffsetY = shadow.offsetY.number;
                                _this.ctx.shadowColor = asString(shadow.color);
                                _this.ctx.shadowBlur = shadow.blur.number;
                                _this.ctx.fillStyle = shadow.inset ? asString(shadow.color) : 'rgba(0,0,0,1)';
                                _this.ctx.fill();
                                _this.ctx.restore();
                            });
                            _a.label = 2;
                        case 2:
                            side = 0;
                            _i = 0, borders_1 = borders;
                            _a.label = 3;
                        case 3:
                            if (!(_i < borders_1.length)) return [3 /*break*/, 13];
                            border = borders_1[_i];
                            if (!(border.style !== BORDER_STYLE.NONE && !isTransparent(border.color) && border.width > 0)) return [3 /*break*/, 11];
                            if (!(border.style === BORDER_STYLE.DASHED)) return [3 /*break*/, 5];
                            return [4 /*yield*/, this.renderDashedDottedBorder(border.color, border.width, side, paint.curves, BORDER_STYLE.DASHED)];
                        case 4:
                            _a.sent();
                            return [3 /*break*/, 11];
                        case 5:
                            if (!(border.style === BORDER_STYLE.DOTTED)) return [3 /*break*/, 7];
                            return [4 /*yield*/, this.renderDashedDottedBorder(border.color, border.width, side, paint.curves, BORDER_STYLE.DOTTED)];
                        case 6:
                            _a.sent();
                            return [3 /*break*/, 11];
                        case 7:
                            if (!(border.style === BORDER_STYLE.DOUBLE)) return [3 /*break*/, 9];
                            return [4 /*yield*/, this.renderDoubleBorder(border.color, border.width, side, paint.curves)];
                        case 8:
                            _a.sent();
                            return [3 /*break*/, 11];
                        case 9: return [4 /*yield*/, this.renderSolidBorder(border.color, side, paint.curves)];
                        case 10:
                            _a.sent();
                            _a.label = 11;
                        case 11:
                            side++;
                            _a.label = 12;
                        case 12:
                            _i++;
                            return [3 /*break*/, 3];
                        case 13: return [2 /*return*/];
                    }
                });
            });
        };
        CanvasRenderer.prototype.renderDashedDottedBorder = function (color, width, side, curvePoints, style) {
            return __awaiter(this, void 0, void 0, function () {
                var strokePaths, boxPaths, startX, startY, endX, endY, length, dashLength, spaceLength, useLineDash, multiplier, numberOfDashes, minSpace, maxSpace, path1, path2, path1, path2;
                return __generator(this, function (_a) {
                    this.ctx.save();
                    strokePaths = parsePathForBorderStroke(curvePoints, side);
                    boxPaths = parsePathForBorder(curvePoints, side);
                    if (style === BORDER_STYLE.DASHED) {
                        this.path(boxPaths);
                        this.ctx.clip();
                    }
                    if (isBezierCurve(boxPaths[0])) {
                        startX = boxPaths[0].start.x;
                        startY = boxPaths[0].start.y;
                    }
                    else {
                        startX = boxPaths[0].x;
                        startY = boxPaths[0].y;
                    }
                    if (isBezierCurve(boxPaths[1])) {
                        endX = boxPaths[1].end.x;
                        endY = boxPaths[1].end.y;
                    }
                    else {
                        endX = boxPaths[1].x;
                        endY = boxPaths[1].y;
                    }
                    if (side === 0 || side === 2) {
                        length = Math.abs(startX - endX);
                    }
                    else {
                        length = Math.abs(startY - endY);
                    }
                    this.ctx.beginPath();
                    if (style === BORDER_STYLE.DOTTED) {
                        this.formatPath(strokePaths);
                    }
                    else {
                        this.formatPath(boxPaths.slice(0, 2));
                    }
                    dashLength = width < 3 ? width * 3 : width * 2;
                    spaceLength = width < 3 ? width * 2 : width;
                    if (style === BORDER_STYLE.DOTTED) {
                        dashLength = width;
                        spaceLength = width;
                    }
                    useLineDash = true;
                    if (length <= dashLength * 2) {
                        useLineDash = false;
                    }
                    else if (length <= dashLength * 2 + spaceLength) {
                        multiplier = length / (2 * dashLength + spaceLength);
                        dashLength *= multiplier;
                        spaceLength *= multiplier;
                    }
                    else {
                        numberOfDashes = Math.floor((length + spaceLength) / (dashLength + spaceLength));
                        minSpace = (length - numberOfDashes * dashLength) / (numberOfDashes - 1);
                        maxSpace = (length - (numberOfDashes + 1) * dashLength) / numberOfDashes;
                        spaceLength =
                            maxSpace <= 0 || Math.abs(spaceLength - minSpace) < Math.abs(spaceLength - maxSpace)
                                ? minSpace
                                : maxSpace;
                    }
                    if (useLineDash) {
                        if (style === BORDER_STYLE.DOTTED) {
                            this.ctx.setLineDash([0, dashLength + spaceLength]);
                        }
                        else {
                            this.ctx.setLineDash([dashLength, spaceLength]);
                        }
                    }
                    if (style === BORDER_STYLE.DOTTED) {
                        this.ctx.lineCap = 'round';
                        this.ctx.lineWidth = width;
                    }
                    else {
                        this.ctx.lineWidth = width * 2 + 1.1;
                    }
                    this.ctx.strokeStyle = asString(color);
                    this.ctx.stroke();
                    this.ctx.setLineDash([]);
                    // dashed round edge gap
                    if (style === BORDER_STYLE.DASHED) {
                        if (isBezierCurve(boxPaths[0])) {
                            path1 = boxPaths[3];
                            path2 = boxPaths[0];
                            this.ctx.beginPath();
                            this.formatPath([new Vector(path1.end.x, path1.end.y), new Vector(path2.start.x, path2.start.y)]);
                            this.ctx.stroke();
                        }
                        if (isBezierCurve(boxPaths[1])) {
                            path1 = boxPaths[1];
                            path2 = boxPaths[2];
                            this.ctx.beginPath();
                            this.formatPath([new Vector(path1.end.x, path1.end.y), new Vector(path2.start.x, path2.start.y)]);
                            this.ctx.stroke();
                        }
                    }
                    this.ctx.restore();
                    return [2 /*return*/];
                });
            });
        };
        CanvasRenderer.prototype.render = function (element) {
            return __awaiter(this, void 0, void 0, function () {
                var stack;
                return __generator(this, function (_a) {
                    switch (_a.label) {
                        case 0:
                            if (this.options.backgroundColor) {
                                this.ctx.fillStyle = asString(this.options.backgroundColor);
                                this.ctx.fillRect(this.options.x, this.options.y, this.options.width, this.options.height);
                            }
                            stack = parseStackingContexts(element);
                            return [4 /*yield*/, this.renderStack(stack)];
                        case 1:
                            _a.sent();
                            this.applyEffects([]);
                            return [2 /*return*/, this.canvas];
                    }
                });
            });
        };
        return CanvasRenderer;
    }(Renderer));
    var isTextInputElement = function (container) {
        if (container instanceof TextareaElementContainer) {
            return true;
        }
        else if (container instanceof SelectElementContainer) {
            return true;
        }
        else if (container instanceof InputElementContainer && container.type !== RADIO && container.type !== CHECKBOX) {
            return true;
        }
        return false;
    };
    var calculateBackgroundCurvedPaintingArea = function (clip, curves) {
        switch (clip) {
            case BACKGROUND_CLIP.BORDER_BOX:
                return calculateBorderBoxPath(curves);
            case BACKGROUND_CLIP.CONTENT_BOX:
                return calculateContentBoxPath(curves);
            case BACKGROUND_CLIP.PADDING_BOX:
            default:
                return calculatePaddingBoxPath(curves);
        }
    };
    var canvasTextAlign = function (textAlign) {
        switch (textAlign) {
            case TEXT_ALIGN.CENTER:
                return 'center';
            case TEXT_ALIGN.RIGHT:
                return 'right';
            case TEXT_ALIGN.LEFT:
            default:
                return 'left';
        }
    };

    var ForeignObjectRenderer = /** @class */ (function (_super) {
        __extends(ForeignObjectRenderer, _super);
        function ForeignObjectRenderer(context, options) {
            var _this = _super.call(this, context, options) || this;
            _this.canvas = options.canvas ? options.canvas : document.createElement('canvas');
            _this.ctx = _this.canvas.getContext('2d');
            _this.options = options;
            _this.canvas.width = Math.floor(options.width * options.scale);
            _this.canvas.height = Math.floor(options.height * options.scale);
            _this.canvas.style.width = options.width + "px";
            _this.canvas.style.height = options.height + "px";
            _this.ctx.scale(_this.options.scale, _this.options.scale);
            _this.ctx.translate(-options.x, -options.y);
            _this.context.logger.debug("EXPERIMENTAL ForeignObject renderer initialized (" + options.width + "x" + options.height + " at " + options.x + "," + options.y + ") with scale " + options.scale);
            return _this;
        }
        ForeignObjectRenderer.prototype.render = function (element) {
            return __awaiter(this, void 0, void 0, function () {
                var svg, img;
                return __generator(this, function (_a) {
                    switch (_a.label) {
                        case 0:
                            svg = createForeignObjectSVG(this.options.width * this.options.scale, this.options.height * this.options.scale, this.options.scale, this.options.scale, element);
                            return [4 /*yield*/, loadSerializedSVG(svg)];
                        case 1:
                            img = _a.sent();
                            if (this.options.backgroundColor) {
                                this.ctx.fillStyle = asString(this.options.backgroundColor);
                                this.ctx.fillRect(0, 0, this.options.width * this.options.scale, this.options.height * this.options.scale);
                            }
                            this.ctx.drawImage(img, -this.options.x * this.options.scale, -this.options.y * this.options.scale);
                            return [2 /*return*/, this.canvas];
                    }
                });
            });
        };
        return ForeignObjectRenderer;
    }(Renderer));
    var loadSerializedSVG = function (svg) {
        return new Promise(function (resolve, reject) {
            var img = new Image();
            img.onload = function () {
                resolve(img);
            };
            img.onerror = reject;
            img.src = "data:image/svg+xml;charset=utf-8," + encodeURIComponent(new XMLSerializer().serializeToString(svg));
        });
    };

    var Logger = /** @class */ (function () {
        function Logger(_a) {
            var id = _a.id, enabled = _a.enabled;
            this.id = id;
            this.enabled = enabled;
            this.start = Date.now();
        }
        // eslint-disable-next-line @typescript-eslint/no-explicit-any
        Logger.prototype.debug = function () {
            var args = [];
            for (var _i = 0; _i < arguments.length; _i++) {
                args[_i] = arguments[_i];
            }
            if (this.enabled) {
                // eslint-disable-next-line no-console
                if (typeof window !== 'undefined' && window.console && typeof console.debug === 'function') {
                    // eslint-disable-next-line no-console
                    console.debug.apply(console, __spreadArray([this.id, this.getTime() + "ms"], args));
                }
                else {
                    this.info.apply(this, args);
                }
            }
        };
        Logger.prototype.getTime = function () {
            return Date.now() - this.start;
        };
        // eslint-disable-next-line @typescript-eslint/no-explicit-any
        Logger.prototype.info = function () {
            var args = [];
            for (var _i = 0; _i < arguments.length; _i++) {
                args[_i] = arguments[_i];
            }
            if (this.enabled) {
                // eslint-disable-next-line no-console
                if (typeof window !== 'undefined' && window.console && typeof console.info === 'function') {
                    // eslint-disable-next-line no-console
                    console.info.apply(console, __spreadArray([this.id, this.getTime() + "ms"], args));
                }
            }
        };
        // eslint-disable-next-line @typescript-eslint/no-explicit-any
        Logger.prototype.warn = function () {
            var args = [];
            for (var _i = 0; _i < arguments.length; _i++) {
                args[_i] = arguments[_i];
            }
            if (this.enabled) {
                // eslint-disable-next-line no-console
                if (typeof window !== 'undefined' && window.console && typeof console.warn === 'function') {
                    // eslint-disable-next-line no-console
                    console.warn.apply(console, __spreadArray([this.id, this.getTime() + "ms"], args));
                }
                else {
                    this.info.apply(this, args);
                }
            }
        };
        // eslint-disable-next-line @typescript-eslint/no-explicit-any
        Logger.prototype.error = function () {
            var args = [];
            for (var _i = 0; _i < arguments.length; _i++) {
                args[_i] = arguments[_i];
            }
            if (this.enabled) {
                // eslint-disable-next-line no-console
                if (typeof window !== 'undefined' && window.console && typeof console.error === 'function') {
                    // eslint-disable-next-line no-console
                    console.error.apply(console, __spreadArray([this.id, this.getTime() + "ms"], args));
                }
                else {
                    this.info.apply(this, args);
                }
            }
        };
        Logger.instances = {};
        return Logger;
    }());

    var Context = /** @class */ (function () {
        function Context(options, windowBounds) {
            var _a;
            this.windowBounds = windowBounds;
            this.instanceName = "#" + Context.instanceCount++;
            this.logger = new Logger({ id: this.instanceName, enabled: options.logging });
            this.cache = (_a = options.cache) !== null && _a !== void 0 ? _a : new Cache(this, options);
        }
        Context.instanceCount = 1;
        return Context;
    }());

    var html2canvas = function (element, options) {
        if (options === void 0) { options = {}; }
        return renderElement(element, options);
    };
    if (typeof window !== 'undefined') {
        CacheStorage.setContext(window);
    }
    var renderElement = function (element, opts) { return __awaiter(void 0, void 0, void 0, function () {
        var ownerDocument, defaultView, resourceOptions, contextOptions, windowOptions, windowBounds, context, foreignObjectRendering, cloneOptions, documentCloner, clonedElement, container, _a, width, height, left, top, backgroundColor, renderOptions, canvas, renderer, root, renderer;
        var _b, _c, _d, _e, _f, _g, _h, _j, _k, _l, _m, _o, _p, _q, _r, _s, _t;
        return __generator(this, function (_u) {
            switch (_u.label) {
                case 0:
                    if (!element || typeof element !== 'object') {
                        return [2 /*return*/, Promise.reject('Invalid element provided as first argument')];
                    }
                    ownerDocument = element.ownerDocument;
                    if (!ownerDocument) {
                        throw new Error("Element is not attached to a Document");
                    }
                    defaultView = ownerDocument.defaultView;
                    if (!defaultView) {
                        throw new Error("Document is not attached to a Window");
                    }
                    resourceOptions = {
                        allowTaint: (_b = opts.allowTaint) !== null && _b !== void 0 ? _b : false,
                        imageTimeout: (_c = opts.imageTimeout) !== null && _c !== void 0 ? _c : 15000,
                        proxy: opts.proxy,
                        useCORS: (_d = opts.useCORS) !== null && _d !== void 0 ? _d : false
                    };
                    contextOptions = __assign({ logging: (_e = opts.logging) !== null && _e !== void 0 ? _e : true, cache: opts.cache }, resourceOptions);
                    windowOptions = {
                        windowWidth: (_f = opts.windowWidth) !== null && _f !== void 0 ? _f : defaultView.innerWidth,
                        windowHeight: (_g = opts.windowHeight) !== null && _g !== void 0 ? _g : defaultView.innerHeight,
                        scrollX: (_h = opts.scrollX) !== null && _h !== void 0 ? _h : defaultView.pageXOffset,
                        scrollY: (_j = opts.scrollY) !== null && _j !== void 0 ? _j : defaultView.pageYOffset
                    };
                    windowBounds = new Bounds(windowOptions.scrollX, windowOptions.scrollY, windowOptions.windowWidth, windowOptions.windowHeight);
                    context = new Context(contextOptions, windowBounds);
                    foreignObjectRendering = (_k = opts.foreignObjectRendering) !== null && _k !== void 0 ? _k : false;
                    cloneOptions = {
                        allowTaint: (_l = opts.allowTaint) !== null && _l !== void 0 ? _l : false,
                        onclone: opts.onclone,
                        ignoreElements: opts.ignoreElements,
                        inlineImages: foreignObjectRendering,
                        copyStyles: foreignObjectRendering
                    };
                    context.logger.debug("Starting document clone with size " + windowBounds.width + "x" + windowBounds.height + " scrolled to " + -windowBounds.left + "," + -windowBounds.top);
                    documentCloner = new DocumentCloner(context, element, cloneOptions);
                    clonedElement = documentCloner.clonedReferenceElement;
                    if (!clonedElement) {
                        return [2 /*return*/, Promise.reject("Unable to find element in cloned iframe")];
                    }
                    return [4 /*yield*/, documentCloner.toIFrame(ownerDocument, windowBounds)];
                case 1:
                    container = _u.sent();
                    _a = isBodyElement(clonedElement) || isHTMLElement(clonedElement)
                        ? parseDocumentSize(clonedElement.ownerDocument)
                        : parseBounds(context, clonedElement), width = _a.width, height = _a.height, left = _a.left, top = _a.top;
                    backgroundColor = parseBackgroundColor(context, clonedElement, opts.backgroundColor);
                    renderOptions = {
                        canvas: opts.canvas,
                        backgroundColor: backgroundColor,
                        scale: (_o = (_m = opts.scale) !== null && _m !== void 0 ? _m : defaultView.devicePixelRatio) !== null && _o !== void 0 ? _o : 1,
                        x: ((_p = opts.x) !== null && _p !== void 0 ? _p : 0) + left,
                        y: ((_q = opts.y) !== null && _q !== void 0 ? _q : 0) + top,
                        width: (_r = opts.width) !== null && _r !== void 0 ? _r : Math.ceil(width),
                        height: (_s = opts.height) !== null && _s !== void 0 ? _s : Math.ceil(height)
                    };
                    if (!foreignObjectRendering) return [3 /*break*/, 3];
                    context.logger.debug("Document cloned, using foreign object rendering");
                    renderer = new ForeignObjectRenderer(context, renderOptions);
                    return [4 /*yield*/, renderer.render(clonedElement)];
                case 2:
                    canvas = _u.sent();
                    return [3 /*break*/, 5];
                case 3:
                    context.logger.debug("Document cloned, element located at " + left + "," + top + " with size " + width + "x" + height + " using computed rendering");
                    context.logger.debug("Starting DOM parsing");
                    root = parseTree(context, clonedElement);
                    if (backgroundColor === root.styles.backgroundColor) {
                        root.styles.backgroundColor = COLORS.TRANSPARENT;
                    }
                    context.logger.debug("Starting renderer for element at " + renderOptions.x + "," + renderOptions.y + " with size " + renderOptions.width + "x" + renderOptions.height);
                    renderer = new CanvasRenderer(context, renderOptions);
                    return [4 /*yield*/, renderer.render(root)];
                case 4:
                    canvas = _u.sent();
                    _u.label = 5;
                case 5:
                    if ((_t = opts.removeContainer) !== null && _t !== void 0 ? _t : true) {
                        if (!DocumentCloner.destroy(container)) {
                            context.logger.error("Cannot detach cloned iframe as it is not in the DOM anymore");
                        }
                    }
                    context.logger.debug("Finished rendering");
                    return [2 /*return*/, canvas];
            }
        });
    }); };
    var parseBackgroundColor = function (context, element, backgroundColorOverride) {
        var ownerDocument = element.ownerDocument;
        // http://www.w3.org/TR/css3-background/#special-backgrounds
        var documentBackgroundColor = ownerDocument.documentElement
            ? parseColor(context, getComputedStyle(ownerDocument.documentElement).backgroundColor)
            : COLORS.TRANSPARENT;
        var bodyBackgroundColor = ownerDocument.body
            ? parseColor(context, getComputedStyle(ownerDocument.body).backgroundColor)
            : COLORS.TRANSPARENT;
        var defaultBackgroundColor = typeof backgroundColorOverride === 'string'
            ? parseColor(context, backgroundColorOverride)
            : backgroundColorOverride === null
                ? COLORS.TRANSPARENT
                : 0xffffffff;
        return element === ownerDocument.documentElement
            ? isTransparent(documentBackgroundColor)
                ? isTransparent(bodyBackgroundColor)
                    ? defaultBackgroundColor
                    : bodyBackgroundColor
                : documentBackgroundColor
            : defaultBackgroundColor;
    };

    return html2canvas;

})));
//# sourceMappingURL=html2canvas.js.map


/***/ }),

/***/ "c1ac":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var ArrayBufferViewCore = __webpack_require__("ebb5");
var $filter = __webpack_require__("b727").filter;
var fromSpeciesAndList = __webpack_require__("1448");

var aTypedArray = ArrayBufferViewCore.aTypedArray;
var exportTypedArrayMethod = ArrayBufferViewCore.exportTypedArrayMethod;

// `%TypedArray%.prototype.filter` method
// https://tc39.es/ecma262/#sec-%typedarray%.prototype.filter
exportTypedArrayMethod('filter', function filter(callbackfn /* , thisArg */) {
  var list = $filter(aTypedArray(this), callbackfn, arguments.length > 1 ? arguments[1] : undefined);
  return fromSpeciesAndList(this, list);
});


/***/ }),

/***/ "c29c":
/***/ (function(module, exports, __webpack_require__) {

// style-loader: Adds some css to the DOM by adding a <style> tag

// load the styles
var content = __webpack_require__("4064");
if(content.__esModule) content = content.default;
if(typeof content === 'string') content = [[module.i, content, '']];
if(content.locals) module.exports = content.locals;
// add the styles to the DOM
var add = __webpack_require__("499e").default
var update = add("301abc2e", content, true, {"sourceMap":false,"shadowMode":false});

/***/ }),

/***/ "c430":
/***/ (function(module, exports) {

module.exports = false;


/***/ }),

/***/ "c4e3":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(Buffer, global) {var require;var require;/*!

JSZip v3.7.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/master/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/master/LICENSE
*/

!function(t){if(true)module.exports=t();else {}}(function(){return function s(a,o,h){function u(r,t){if(!o[r]){if(!a[r]){var e="function"==typeof require&&require;if(!t&&e)return require(r,!0);if(l)return l(r,!0);var i=new Error("Cannot find module '"+r+"'");throw i.code="MODULE_NOT_FOUND",i}var n=o[r]={exports:{}};a[r][0].call(n.exports,function(t){var e=a[r][1][t];return u(e||t)},n,n.exports,s,a,o,h)}return o[r].exports}for(var l="function"==typeof require&&require,t=0;t<h.length;t++)u(h[t]);return u}({1:[function(t,e,r){"use strict";var c=t("./utils"),d=t("./support"),p="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";r.encode=function(t){for(var e,r,i,n,s,a,o,h=[],u=0,l=t.length,f=l,d="string"!==c.getTypeOf(t);u<t.length;)f=l-u,i=d?(e=t[u++],r=u<l?t[u++]:0,u<l?t[u++]:0):(e=t.charCodeAt(u++),r=u<l?t.charCodeAt(u++):0,u<l?t.charCodeAt(u++):0),n=e>>2,s=(3&e)<<4|r>>4,a=1<f?(15&r)<<2|i>>6:64,o=2<f?63&i:64,h.push(p.charAt(n)+p.charAt(s)+p.charAt(a)+p.charAt(o));return h.join("")},r.decode=function(t){var e,r,i,n,s,a,o=0,h=0,u="data:";if(t.substr(0,u.length)===u)throw new Error("Invalid base64 input, it looks like a data url.");var l,f=3*(t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"")).length/4;if(t.charAt(t.length-1)===p.charAt(64)&&f--,t.charAt(t.length-2)===p.charAt(64)&&f--,f%1!=0)throw new Error("Invalid base64 input, bad content length.");for(l=d.uint8array?new Uint8Array(0|f):new Array(0|f);o<t.length;)e=p.indexOf(t.charAt(o++))<<2|(n=p.indexOf(t.charAt(o++)))>>4,r=(15&n)<<4|(s=p.indexOf(t.charAt(o++)))>>2,i=(3&s)<<6|(a=p.indexOf(t.charAt(o++))),l[h++]=e,64!==s&&(l[h++]=r),64!==a&&(l[h++]=i);return l}},{"./support":30,"./utils":32}],2:[function(t,e,r){"use strict";var i=t("./external"),n=t("./stream/DataWorker"),s=t("./stream/Crc32Probe"),a=t("./stream/DataLengthProbe");function o(t,e,r,i,n){this.compressedSize=t,this.uncompressedSize=e,this.crc32=r,this.compression=i,this.compressedContent=n}o.prototype={getContentWorker:function(){var t=new n(i.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new a("data_length")),e=this;return t.on("end",function(){if(this.streamInfo.data_length!==e.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),t},getCompressedWorker:function(){return new n(i.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},o.createWorkerFrom=function(t,e,r){return t.pipe(new s).pipe(new a("uncompressedSize")).pipe(e.compressWorker(r)).pipe(new a("compressedSize")).withStreamInfo("compression",e)},e.exports=o},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(t,e,r){"use strict";var i=t("./stream/GenericWorker");r.STORE={magic:"\0\0",compressWorker:function(t){return new i("STORE compression")},uncompressWorker:function(){return new i("STORE decompression")}},r.DEFLATE=t("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(t,e,r){"use strict";var i=t("./utils");var o=function(){for(var t,e=[],r=0;r<256;r++){t=r;for(var i=0;i<8;i++)t=1&t?3988292384^t>>>1:t>>>1;e[r]=t}return e}();e.exports=function(t,e){return void 0!==t&&t.length?"string"!==i.getTypeOf(t)?function(t,e,r,i){var n=o,s=i+r;t^=-1;for(var a=i;a<s;a++)t=t>>>8^n[255&(t^e[a])];return-1^t}(0|e,t,t.length,0):function(t,e,r,i){var n=o,s=i+r;t^=-1;for(var a=i;a<s;a++)t=t>>>8^n[255&(t^e.charCodeAt(a))];return-1^t}(0|e,t,t.length,0):0}},{"./utils":32}],5:[function(t,e,r){"use strict";r.base64=!1,r.binary=!1,r.dir=!1,r.createFolders=!0,r.date=null,r.compression=null,r.compressionOptions=null,r.comment=null,r.unixPermissions=null,r.dosPermissions=null},{}],6:[function(t,e,r){"use strict";var i=null;i="undefined"!=typeof Promise?Promise:t("lie"),e.exports={Promise:i}},{lie:37}],7:[function(t,e,r){"use strict";var i="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,n=t("pako"),s=t("./utils"),a=t("./stream/GenericWorker"),o=i?"uint8array":"array";function h(t,e){a.call(this,"FlateWorker/"+t),this._pako=null,this._pakoAction=t,this._pakoOptions=e,this.meta={}}r.magic="\b\0",s.inherits(h,a),h.prototype.processChunk=function(t){this.meta=t.meta,null===this._pako&&this._createPako(),this._pako.push(s.transformTo(o,t.data),!1)},h.prototype.flush=function(){a.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},h.prototype.cleanUp=function(){a.prototype.cleanUp.call(this),this._pako=null},h.prototype._createPako=function(){this._pako=new n[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var e=this;this._pako.onData=function(t){e.push({data:t,meta:e.meta})}},r.compressWorker=function(t){return new h("Deflate",t)},r.uncompressWorker=function(){return new h("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(t,e,r){"use strict";function A(t,e){var r,i="";for(r=0;r<e;r++)i+=String.fromCharCode(255&t),t>>>=8;return i}function i(t,e,r,i,n,s){var a,o,h=t.file,u=t.compression,l=s!==O.utf8encode,f=I.transformTo("string",s(h.name)),d=I.transformTo("string",O.utf8encode(h.name)),c=h.comment,p=I.transformTo("string",s(c)),m=I.transformTo("string",O.utf8encode(c)),_=d.length!==h.name.length,g=m.length!==c.length,b="",v="",y="",w=h.dir,k=h.date,x={crc32:0,compressedSize:0,uncompressedSize:0};e&&!r||(x.crc32=t.crc32,x.compressedSize=t.compressedSize,x.uncompressedSize=t.uncompressedSize);var S=0;e&&(S|=8),l||!_&&!g||(S|=2048);var z=0,C=0;w&&(z|=16),"UNIX"===n?(C=798,z|=function(t,e){var r=t;return t||(r=e?16893:33204),(65535&r)<<16}(h.unixPermissions,w)):(C=20,z|=function(t){return 63&(t||0)}(h.dosPermissions)),a=k.getUTCHours(),a<<=6,a|=k.getUTCMinutes(),a<<=5,a|=k.getUTCSeconds()/2,o=k.getUTCFullYear()-1980,o<<=4,o|=k.getUTCMonth()+1,o<<=5,o|=k.getUTCDate(),_&&(v=A(1,1)+A(B(f),4)+d,b+="up"+A(v.length,2)+v),g&&(y=A(1,1)+A(B(p),4)+m,b+="uc"+A(y.length,2)+y);var E="";return E+="\n\0",E+=A(S,2),E+=u.magic,E+=A(a,2),E+=A(o,2),E+=A(x.crc32,4),E+=A(x.compressedSize,4),E+=A(x.uncompressedSize,4),E+=A(f.length,2),E+=A(b.length,2),{fileRecord:R.LOCAL_FILE_HEADER+E+f+b,dirRecord:R.CENTRAL_FILE_HEADER+A(C,2)+E+A(p.length,2)+"\0\0\0\0"+A(z,4)+A(i,4)+f+b+p}}var I=t("../utils"),n=t("../stream/GenericWorker"),O=t("../utf8"),B=t("../crc32"),R=t("../signature");function s(t,e,r,i){n.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=e,this.zipPlatform=r,this.encodeFileName=i,this.streamFiles=t,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}I.inherits(s,n),s.prototype.push=function(t){var e=t.meta.percent||0,r=this.entriesCount,i=this._sources.length;this.accumulate?this.contentBuffer.push(t):(this.bytesWritten+=t.data.length,n.prototype.push.call(this,{data:t.data,meta:{currentFile:this.currentFile,percent:r?(e+100*(r-i-1))/r:100}}))},s.prototype.openedSource=function(t){this.currentSourceOffset=this.bytesWritten,this.currentFile=t.file.name;var e=this.streamFiles&&!t.file.dir;if(e){var r=i(t,e,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:r.fileRecord,meta:{percent:0}})}else this.accumulate=!0},s.prototype.closedSource=function(t){this.accumulate=!1;var e=this.streamFiles&&!t.file.dir,r=i(t,e,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(r.dirRecord),e)this.push({data:function(t){return R.DATA_DESCRIPTOR+A(t.crc32,4)+A(t.compressedSize,4)+A(t.uncompressedSize,4)}(t),meta:{percent:100}});else for(this.push({data:r.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},s.prototype.flush=function(){for(var t=this.bytesWritten,e=0;e<this.dirRecords.length;e++)this.push({data:this.dirRecords[e],meta:{percent:100}});var r=this.bytesWritten-t,i=function(t,e,r,i,n){var s=I.transformTo("string",n(i));return R.CENTRAL_DIRECTORY_END+"\0\0\0\0"+A(t,2)+A(t,2)+A(e,4)+A(r,4)+A(s.length,2)+s}(this.dirRecords.length,r,t,this.zipComment,this.encodeFileName);this.push({data:i,meta:{percent:100}})},s.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},s.prototype.registerPrevious=function(t){this._sources.push(t);var e=this;return t.on("data",function(t){e.processChunk(t)}),t.on("end",function(){e.closedSource(e.previous.streamInfo),e._sources.length?e.prepareNextSource():e.end()}),t.on("error",function(t){e.error(t)}),this},s.prototype.resume=function(){return!!n.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},s.prototype.error=function(t){var e=this._sources;if(!n.prototype.error.call(this,t))return!1;for(var r=0;r<e.length;r++)try{e[r].error(t)}catch(t){}return!0},s.prototype.lock=function(){n.prototype.lock.call(this);for(var t=this._sources,e=0;e<t.length;e++)t[e].lock()},e.exports=s},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(t,e,r){"use strict";var u=t("../compressions"),i=t("./ZipFileWorker");r.generateWorker=function(t,a,e){var o=new i(a.streamFiles,e,a.platform,a.encodeFileName),h=0;try{t.forEach(function(t,e){h++;var r=function(t,e){var r=t||e,i=u[r];if(!i)throw new Error(r+" is not a valid compression method !");return i}(e.options.compression,a.compression),i=e.options.compressionOptions||a.compressionOptions||{},n=e.dir,s=e.date;e._compressWorker(r,i).withStreamInfo("file",{name:t,dir:n,date:s,comment:e.comment||"",unixPermissions:e.unixPermissions,dosPermissions:e.dosPermissions}).pipe(o)}),o.entriesCount=h}catch(t){o.error(t)}return o}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(t,e,r){"use strict";function i(){if(!(this instanceof i))return new i;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var t=new i;for(var e in this)"function"!=typeof this[e]&&(t[e]=this[e]);return t}}(i.prototype=t("./object")).loadAsync=t("./load"),i.support=t("./support"),i.defaults=t("./defaults"),i.version="3.7.1",i.loadAsync=function(t,e){return(new i).loadAsync(t,e)},i.external=t("./external"),e.exports=i},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(t,e,r){"use strict";var i=t("./utils"),n=t("./external"),o=t("./utf8"),h=t("./zipEntries"),s=t("./stream/Crc32Probe"),u=t("./nodejsUtils");function l(i){return new n.Promise(function(t,e){var r=i.decompressed.getContentWorker().pipe(new s);r.on("error",function(t){e(t)}).on("end",function(){r.streamInfo.crc32!==i.decompressed.crc32?e(new Error("Corrupted zip : CRC32 mismatch")):t()}).resume()})}e.exports=function(t,s){var a=this;return s=i.extend(s||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:o.utf8decode}),u.isNode&&u.isStream(t)?n.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):i.prepareContent("the loaded zip file",t,!0,s.optimizedBinaryString,s.base64).then(function(t){var e=new h(s);return e.load(t),e}).then(function(t){var e=[n.Promise.resolve(t)],r=t.files;if(s.checkCRC32)for(var i=0;i<r.length;i++)e.push(l(r[i]));return n.Promise.all(e)}).then(function(t){for(var e=t.shift(),r=e.files,i=0;i<r.length;i++){var n=r[i];a.file(n.fileNameStr,n.decompressed,{binary:!0,optimizedBinaryString:!0,date:n.date,dir:n.dir,comment:n.fileCommentStr.length?n.fileCommentStr:null,unixPermissions:n.unixPermissions,dosPermissions:n.dosPermissions,createFolders:s.createFolders})}return e.zipComment.length&&(a.comment=e.zipComment),a})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(t,e,r){"use strict";var i=t("../utils"),n=t("../stream/GenericWorker");function s(t,e){n.call(this,"Nodejs stream input adapter for "+t),this._upstreamEnded=!1,this._bindStream(e)}i.inherits(s,n),s.prototype._bindStream=function(t){var e=this;(this._stream=t).pause(),t.on("data",function(t){e.push({data:t,meta:{percent:0}})}).on("error",function(t){e.isPaused?this.generatedError=t:e.error(t)}).on("end",function(){e.isPaused?e._upstreamEnded=!0:e.end()})},s.prototype.pause=function(){return!!n.prototype.pause.call(this)&&(this._stream.pause(),!0)},s.prototype.resume=function(){return!!n.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},e.exports=s},{"../stream/GenericWorker":28,"../utils":32}],13:[function(t,e,r){"use strict";var n=t("readable-stream").Readable;function i(t,e,r){n.call(this,e),this._helper=t;var i=this;t.on("data",function(t,e){i.push(t)||i._helper.pause(),r&&r(e)}).on("error",function(t){i.emit("error",t)}).on("end",function(){i.push(null)})}t("../utils").inherits(i,n),i.prototype._read=function(){this._helper.resume()},e.exports=i},{"../utils":32,"readable-stream":16}],14:[function(t,e,r){"use strict";e.exports={isNode:"undefined"!=typeof Buffer,newBufferFrom:function(t,e){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(t,e);if("number"==typeof t)throw new Error('The "data" argument must not be a number');return new Buffer(t,e)},allocBuffer:function(t){if(Buffer.alloc)return Buffer.alloc(t);var e=new Buffer(t);return e.fill(0),e},isBuffer:function(t){return Buffer.isBuffer(t)},isStream:function(t){return t&&"function"==typeof t.on&&"function"==typeof t.pause&&"function"==typeof t.resume}}},{}],15:[function(t,e,r){"use strict";function s(t,e,r){var i,n=u.getTypeOf(e),s=u.extend(r||{},f);s.date=s.date||new Date,null!==s.compression&&(s.compression=s.compression.toUpperCase()),"string"==typeof s.unixPermissions&&(s.unixPermissions=parseInt(s.unixPermissions,8)),s.unixPermissions&&16384&s.unixPermissions&&(s.dir=!0),s.dosPermissions&&16&s.dosPermissions&&(s.dir=!0),s.dir&&(t=g(t)),s.createFolders&&(i=_(t))&&b.call(this,i,!0);var a="string"===n&&!1===s.binary&&!1===s.base64;r&&void 0!==r.binary||(s.binary=!a),(e instanceof d&&0===e.uncompressedSize||s.dir||!e||0===e.length)&&(s.base64=!1,s.binary=!0,e="",s.compression="STORE",n="string");var o=null;o=e instanceof d||e instanceof l?e:p.isNode&&p.isStream(e)?new m(t,e):u.prepareContent(t,e,s.binary,s.optimizedBinaryString,s.base64);var h=new c(t,o,s);this.files[t]=h}var n=t("./utf8"),u=t("./utils"),l=t("./stream/GenericWorker"),a=t("./stream/StreamHelper"),f=t("./defaults"),d=t("./compressedObject"),c=t("./zipObject"),o=t("./generate"),p=t("./nodejsUtils"),m=t("./nodejs/NodejsStreamInputAdapter"),_=function(t){"/"===t.slice(-1)&&(t=t.substring(0,t.length-1));var e=t.lastIndexOf("/");return 0<e?t.substring(0,e):""},g=function(t){return"/"!==t.slice(-1)&&(t+="/"),t},b=function(t,e){return e=void 0!==e?e:f.createFolders,t=g(t),this.files[t]||s.call(this,t,null,{dir:!0,createFolders:e}),this.files[t]};function h(t){return"[object RegExp]"===Object.prototype.toString.call(t)}var i={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(t){var e,r,i;for(e in this.files)i=this.files[e],(r=e.slice(this.root.length,e.length))&&e.slice(0,this.root.length)===this.root&&t(r,i)},filter:function(r){var i=[];return this.forEach(function(t,e){r(t,e)&&i.push(e)}),i},file:function(t,e,r){if(1!==arguments.length)return t=this.root+t,s.call(this,t,e,r),this;if(h(t)){var i=t;return this.filter(function(t,e){return!e.dir&&i.test(t)})}var n=this.files[this.root+t];return n&&!n.dir?n:null},folder:function(r){if(!r)return this;if(h(r))return this.filter(function(t,e){return e.dir&&r.test(t)});var t=this.root+r,e=b.call(this,t),i=this.clone();return i.root=e.name,i},remove:function(r){r=this.root+r;var t=this.files[r];if(t||("/"!==r.slice(-1)&&(r+="/"),t=this.files[r]),t&&!t.dir)delete this.files[r];else for(var e=this.filter(function(t,e){return e.name.slice(0,r.length)===r}),i=0;i<e.length;i++)delete this.files[e[i].name];return this},generate:function(t){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(t){var e,r={};try{if((r=u.extend(t||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:n.utf8encode})).type=r.type.toLowerCase(),r.compression=r.compression.toUpperCase(),"binarystring"===r.type&&(r.type="string"),!r.type)throw new Error("No output type specified.");u.checkSupport(r.type),"darwin"!==r.platform&&"freebsd"!==r.platform&&"linux"!==r.platform&&"sunos"!==r.platform||(r.platform="UNIX"),"win32"===r.platform&&(r.platform="DOS");var i=r.comment||this.comment||"";e=o.generateWorker(this,r,i)}catch(t){(e=new l("error")).error(t)}return new a(e,r.type||"string",r.mimeType)},generateAsync:function(t,e){return this.generateInternalStream(t).accumulate(e)},generateNodeStream:function(t,e){return(t=t||{}).type||(t.type="nodebuffer"),this.generateInternalStream(t).toNodejsStream(e)}};e.exports=i},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(t,e,r){e.exports=t("stream")},{stream:void 0}],17:[function(t,e,r){"use strict";var i=t("./DataReader");function n(t){i.call(this,t);for(var e=0;e<this.data.length;e++)t[e]=255&t[e]}t("../utils").inherits(n,i),n.prototype.byteAt=function(t){return this.data[this.zero+t]},n.prototype.lastIndexOfSignature=function(t){for(var e=t.charCodeAt(0),r=t.charCodeAt(1),i=t.charCodeAt(2),n=t.charCodeAt(3),s=this.length-4;0<=s;--s)if(this.data[s]===e&&this.data[s+1]===r&&this.data[s+2]===i&&this.data[s+3]===n)return s-this.zero;return-1},n.prototype.readAndCheckSignature=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1),i=t.charCodeAt(2),n=t.charCodeAt(3),s=this.readData(4);return e===s[0]&&r===s[1]&&i===s[2]&&n===s[3]},n.prototype.readData=function(t){if(this.checkOffset(t),0===t)return[];var e=this.data.slice(this.zero+this.index,this.zero+this.index+t);return this.index+=t,e},e.exports=n},{"../utils":32,"./DataReader":18}],18:[function(t,e,r){"use strict";var i=t("../utils");function n(t){this.data=t,this.length=t.length,this.index=0,this.zero=0}n.prototype={checkOffset:function(t){this.checkIndex(this.index+t)},checkIndex:function(t){if(this.length<this.zero+t||t<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+t+"). Corrupted zip ?")},setIndex:function(t){this.checkIndex(t),this.index=t},skip:function(t){this.setIndex(this.index+t)},byteAt:function(t){},readInt:function(t){var e,r=0;for(this.checkOffset(t),e=this.index+t-1;e>=this.index;e--)r=(r<<8)+this.byteAt(e);return this.index+=t,r},readString:function(t){return i.transformTo("string",this.readData(t))},readData:function(t){},lastIndexOfSignature:function(t){},readAndCheckSignature:function(t){},readDate:function(){var t=this.readInt(4);return new Date(Date.UTC(1980+(t>>25&127),(t>>21&15)-1,t>>16&31,t>>11&31,t>>5&63,(31&t)<<1))}},e.exports=n},{"../utils":32}],19:[function(t,e,r){"use strict";var i=t("./Uint8ArrayReader");function n(t){i.call(this,t)}t("../utils").inherits(n,i),n.prototype.readData=function(t){this.checkOffset(t);var e=this.data.slice(this.zero+this.index,this.zero+this.index+t);return this.index+=t,e},e.exports=n},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(t,e,r){"use strict";var i=t("./DataReader");function n(t){i.call(this,t)}t("../utils").inherits(n,i),n.prototype.byteAt=function(t){return this.data.charCodeAt(this.zero+t)},n.prototype.lastIndexOfSignature=function(t){return this.data.lastIndexOf(t)-this.zero},n.prototype.readAndCheckSignature=function(t){return t===this.readData(4)},n.prototype.readData=function(t){this.checkOffset(t);var e=this.data.slice(this.zero+this.index,this.zero+this.index+t);return this.index+=t,e},e.exports=n},{"../utils":32,"./DataReader":18}],21:[function(t,e,r){"use strict";var i=t("./ArrayReader");function n(t){i.call(this,t)}t("../utils").inherits(n,i),n.prototype.readData=function(t){if(this.checkOffset(t),0===t)return new Uint8Array(0);var e=this.data.subarray(this.zero+this.index,this.zero+this.index+t);return this.index+=t,e},e.exports=n},{"../utils":32,"./ArrayReader":17}],22:[function(t,e,r){"use strict";var i=t("../utils"),n=t("../support"),s=t("./ArrayReader"),a=t("./StringReader"),o=t("./NodeBufferReader"),h=t("./Uint8ArrayReader");e.exports=function(t){var e=i.getTypeOf(t);return i.checkSupport(e),"string"!==e||n.uint8array?"nodebuffer"===e?new o(t):n.uint8array?new h(i.transformTo("uint8array",t)):new s(i.transformTo("array",t)):new a(t)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(t,e,r){"use strict";r.LOCAL_FILE_HEADER="PK",r.CENTRAL_FILE_HEADER="PK",r.CENTRAL_DIRECTORY_END="PK",r.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK",r.ZIP64_CENTRAL_DIRECTORY_END="PK",r.DATA_DESCRIPTOR="PK\b"},{}],24:[function(t,e,r){"use strict";var i=t("./GenericWorker"),n=t("../utils");function s(t){i.call(this,"ConvertWorker to "+t),this.destType=t}n.inherits(s,i),s.prototype.processChunk=function(t){this.push({data:n.transformTo(this.destType,t.data),meta:t.meta})},e.exports=s},{"../utils":32,"./GenericWorker":28}],25:[function(t,e,r){"use strict";var i=t("./GenericWorker"),n=t("../crc32");function s(){i.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}t("../utils").inherits(s,i),s.prototype.processChunk=function(t){this.streamInfo.crc32=n(t.data,this.streamInfo.crc32||0),this.push(t)},e.exports=s},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(t,e,r){"use strict";var i=t("../utils"),n=t("./GenericWorker");function s(t){n.call(this,"DataLengthProbe for "+t),this.propName=t,this.withStreamInfo(t,0)}i.inherits(s,n),s.prototype.processChunk=function(t){if(t){var e=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=e+t.data.length}n.prototype.processChunk.call(this,t)},e.exports=s},{"../utils":32,"./GenericWorker":28}],27:[function(t,e,r){"use strict";var i=t("../utils"),n=t("./GenericWorker");function s(t){n.call(this,"DataWorker");var e=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,t.then(function(t){e.dataIsReady=!0,e.data=t,e.max=t&&t.length||0,e.type=i.getTypeOf(t),e.isPaused||e._tickAndRepeat()},function(t){e.error(t)})}i.inherits(s,n),s.prototype.cleanUp=function(){n.prototype.cleanUp.call(this),this.data=null},s.prototype.resume=function(){return!!n.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,i.delay(this._tickAndRepeat,[],this)),!0)},s.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(i.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},s.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var t=null,e=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":t=this.data.substring(this.index,e);break;case"uint8array":t=this.data.subarray(this.index,e);break;case"array":case"nodebuffer":t=this.data.slice(this.index,e)}return this.index=e,this.push({data:t,meta:{percent:this.max?this.index/this.max*100:0}})},e.exports=s},{"../utils":32,"./GenericWorker":28}],28:[function(t,e,r){"use strict";function i(t){this.name=t||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}i.prototype={push:function(t){this.emit("data",t)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(t){this.emit("error",t)}return!0},error:function(t){return!this.isFinished&&(this.isPaused?this.generatedError=t:(this.isFinished=!0,this.emit("error",t),this.previous&&this.previous.error(t),this.cleanUp()),!0)},on:function(t,e){return this._listeners[t].push(e),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(t,e){if(this._listeners[t])for(var r=0;r<this._listeners[t].length;r++)this._listeners[t][r].call(this,e)},pipe:function(t){return t.registerPrevious(this)},registerPrevious:function(t){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=t.streamInfo,this.mergeStreamInfo(),this.previous=t;var e=this;return t.on("data",function(t){e.processChunk(t)}),t.on("end",function(){e.end()}),t.on("error",function(t){e.error(t)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var t=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),t=!0),this.previous&&this.previous.resume(),!t},flush:function(){},processChunk:function(t){this.push(t)},withStreamInfo:function(t,e){return this.extraStreamInfo[t]=e,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var t in this.extraStreamInfo)this.extraStreamInfo.hasOwnProperty(t)&&(this.streamInfo[t]=this.extraStreamInfo[t])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var t="Worker "+this.name;return this.previous?this.previous+" -> "+t:t}},e.exports=i},{}],29:[function(t,e,r){"use strict";var h=t("../utils"),n=t("./ConvertWorker"),s=t("./GenericWorker"),u=t("../base64"),i=t("../support"),a=t("../external"),o=null;if(i.nodestream)try{o=t("../nodejs/NodejsStreamOutputAdapter")}catch(t){}function l(t,o){return new a.Promise(function(e,r){var i=[],n=t._internalType,s=t._outputType,a=t._mimeType;t.on("data",function(t,e){i.push(t),o&&o(e)}).on("error",function(t){i=[],r(t)}).on("end",function(){try{var t=function(t,e,r){switch(t){case"blob":return h.newBlob(h.transformTo("arraybuffer",e),r);case"base64":return u.encode(e);default:return h.transformTo(t,e)}}(s,function(t,e){var r,i=0,n=null,s=0;for(r=0;r<e.length;r++)s+=e[r].length;switch(t){case"string":return e.join("");case"array":return Array.prototype.concat.apply([],e);case"uint8array":for(n=new Uint8Array(s),r=0;r<e.length;r++)n.set(e[r],i),i+=e[r].length;return n;case"nodebuffer":return Buffer.concat(e);default:throw new Error("concat : unsupported type '"+t+"'")}}(n,i),a);e(t)}catch(t){r(t)}i=[]}).resume()})}function f(t,e,r){var i=e;switch(e){case"blob":case"arraybuffer":i="uint8array";break;case"base64":i="string"}try{this._internalType=i,this._outputType=e,this._mimeType=r,h.checkSupport(i),this._worker=t.pipe(new n(i)),t.lock()}catch(t){this._worker=new s("error"),this._worker.error(t)}}f.prototype={accumulate:function(t){return l(this,t)},on:function(t,e){var r=this;return"data"===t?this._worker.on(t,function(t){e.call(r,t.data,t.meta)}):this._worker.on(t,function(){h.delay(e,arguments,r)}),this},resume:function(){return h.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(t){if(h.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw new Error(this._outputType+" is not supported by this method");return new o(this,{objectMode:"nodebuffer"!==this._outputType},t)}},e.exports=f},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(t,e,r){"use strict";if(r.base64=!0,r.array=!0,r.string=!0,r.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,r.nodebuffer="undefined"!=typeof Buffer,r.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)r.blob=!1;else{var i=new ArrayBuffer(0);try{r.blob=0===new Blob([i],{type:"application/zip"}).size}catch(t){try{var n=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);n.append(i),r.blob=0===n.getBlob("application/zip").size}catch(t){r.blob=!1}}}try{r.nodestream=!!t("readable-stream").Readable}catch(t){r.nodestream=!1}},{"readable-stream":16}],31:[function(t,e,s){"use strict";for(var o=t("./utils"),h=t("./support"),r=t("./nodejsUtils"),i=t("./stream/GenericWorker"),u=new Array(256),n=0;n<256;n++)u[n]=252<=n?6:248<=n?5:240<=n?4:224<=n?3:192<=n?2:1;u[254]=u[254]=1;function a(){i.call(this,"utf-8 decode"),this.leftOver=null}function l(){i.call(this,"utf-8 encode")}s.utf8encode=function(t){return h.nodebuffer?r.newBufferFrom(t,"utf-8"):function(t){var e,r,i,n,s,a=t.length,o=0;for(n=0;n<a;n++)55296==(64512&(r=t.charCodeAt(n)))&&n+1<a&&56320==(64512&(i=t.charCodeAt(n+1)))&&(r=65536+(r-55296<<10)+(i-56320),n++),o+=r<128?1:r<2048?2:r<65536?3:4;for(e=h.uint8array?new Uint8Array(o):new Array(o),n=s=0;s<o;n++)55296==(64512&(r=t.charCodeAt(n)))&&n+1<a&&56320==(64512&(i=t.charCodeAt(n+1)))&&(r=65536+(r-55296<<10)+(i-56320),n++),r<128?e[s++]=r:(r<2048?e[s++]=192|r>>>6:(r<65536?e[s++]=224|r>>>12:(e[s++]=240|r>>>18,e[s++]=128|r>>>12&63),e[s++]=128|r>>>6&63),e[s++]=128|63&r);return e}(t)},s.utf8decode=function(t){return h.nodebuffer?o.transformTo("nodebuffer",t).toString("utf-8"):function(t){var e,r,i,n,s=t.length,a=new Array(2*s);for(e=r=0;e<s;)if((i=t[e++])<128)a[r++]=i;else if(4<(n=u[i]))a[r++]=65533,e+=n-1;else{for(i&=2===n?31:3===n?15:7;1<n&&e<s;)i=i<<6|63&t[e++],n--;1<n?a[r++]=65533:i<65536?a[r++]=i:(i-=65536,a[r++]=55296|i>>10&1023,a[r++]=56320|1023&i)}return a.length!==r&&(a.subarray?a=a.subarray(0,r):a.length=r),o.applyFromCharCode(a)}(t=o.transformTo(h.uint8array?"uint8array":"array",t))},o.inherits(a,i),a.prototype.processChunk=function(t){var e=o.transformTo(h.uint8array?"uint8array":"array",t.data);if(this.leftOver&&this.leftOver.length){if(h.uint8array){var r=e;(e=new Uint8Array(r.length+this.leftOver.length)).set(this.leftOver,0),e.set(r,this.leftOver.length)}else e=this.leftOver.concat(e);this.leftOver=null}var i=function(t,e){var r;for((e=e||t.length)>t.length&&(e=t.length),r=e-1;0<=r&&128==(192&t[r]);)r--;return r<0?e:0===r?e:r+u[t[r]]>e?r:e}(e),n=e;i!==e.length&&(h.uint8array?(n=e.subarray(0,i),this.leftOver=e.subarray(i,e.length)):(n=e.slice(0,i),this.leftOver=e.slice(i,e.length))),this.push({data:s.utf8decode(n),meta:t.meta})},a.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:s.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},s.Utf8DecodeWorker=a,o.inherits(l,i),l.prototype.processChunk=function(t){this.push({data:s.utf8encode(t.data),meta:t.meta})},s.Utf8EncodeWorker=l},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(t,e,a){"use strict";var o=t("./support"),h=t("./base64"),r=t("./nodejsUtils"),i=t("set-immediate-shim"),u=t("./external");function n(t){return t}function l(t,e){for(var r=0;r<t.length;++r)e[r]=255&t.charCodeAt(r);return e}a.newBlob=function(e,r){a.checkSupport("blob");try{return new Blob([e],{type:r})}catch(t){try{var i=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return i.append(e),i.getBlob(r)}catch(t){throw new Error("Bug : can't construct the Blob.")}}};var s={stringifyByChunk:function(t,e,r){var i=[],n=0,s=t.length;if(s<=r)return String.fromCharCode.apply(null,t);for(;n<s;)"array"===e||"nodebuffer"===e?i.push(String.fromCharCode.apply(null,t.slice(n,Math.min(n+r,s)))):i.push(String.fromCharCode.apply(null,t.subarray(n,Math.min(n+r,s)))),n+=r;return i.join("")},stringifyByChar:function(t){for(var e="",r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},applyCanBeUsed:{uint8array:function(){try{return o.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch(t){return!1}}(),nodebuffer:function(){try{return o.nodebuffer&&1===String.fromCharCode.apply(null,r.allocBuffer(1)).length}catch(t){return!1}}()}};function f(t){var e=65536,r=a.getTypeOf(t),i=!0;if("uint8array"===r?i=s.applyCanBeUsed.uint8array:"nodebuffer"===r&&(i=s.applyCanBeUsed.nodebuffer),i)for(;1<e;)try{return s.stringifyByChunk(t,r,e)}catch(t){e=Math.floor(e/2)}return s.stringifyByChar(t)}function d(t,e){for(var r=0;r<t.length;r++)e[r]=t[r];return e}a.applyFromCharCode=f;var c={};c.string={string:n,array:function(t){return l(t,new Array(t.length))},arraybuffer:function(t){return c.string.uint8array(t).buffer},uint8array:function(t){return l(t,new Uint8Array(t.length))},nodebuffer:function(t){return l(t,r.allocBuffer(t.length))}},c.array={string:f,array:n,arraybuffer:function(t){return new Uint8Array(t).buffer},uint8array:function(t){return new Uint8Array(t)},nodebuffer:function(t){return r.newBufferFrom(t)}},c.arraybuffer={string:function(t){return f(new Uint8Array(t))},array:function(t){return d(new Uint8Array(t),new Array(t.byteLength))},arraybuffer:n,uint8array:function(t){return new Uint8Array(t)},nodebuffer:function(t){return r.newBufferFrom(new Uint8Array(t))}},c.uint8array={string:f,array:function(t){return d(t,new Array(t.length))},arraybuffer:function(t){return t.buffer},uint8array:n,nodebuffer:function(t){return r.newBufferFrom(t)}},c.nodebuffer={string:f,array:function(t){return d(t,new Array(t.length))},arraybuffer:function(t){return c.nodebuffer.uint8array(t).buffer},uint8array:function(t){return d(t,new Uint8Array(t.length))},nodebuffer:n},a.transformTo=function(t,e){if(e=e||"",!t)return e;a.checkSupport(t);var r=a.getTypeOf(e);return c[r][t](e)},a.getTypeOf=function(t){return"string"==typeof t?"string":"[object Array]"===Object.prototype.toString.call(t)?"array":o.nodebuffer&&r.isBuffer(t)?"nodebuffer":o.uint8array&&t instanceof Uint8Array?"uint8array":o.arraybuffer&&t instanceof ArrayBuffer?"arraybuffer":void 0},a.checkSupport=function(t){if(!o[t.toLowerCase()])throw new Error(t+" is not supported by this platform")},a.MAX_VALUE_16BITS=65535,a.MAX_VALUE_32BITS=-1,a.pretty=function(t){var e,r,i="";for(r=0;r<(t||"").length;r++)i+="\\x"+((e=t.charCodeAt(r))<16?"0":"")+e.toString(16).toUpperCase();return i},a.delay=function(t,e,r){i(function(){t.apply(r||null,e||[])})},a.inherits=function(t,e){function r(){}r.prototype=e.prototype,t.prototype=new r},a.extend=function(){var t,e,r={};for(t=0;t<arguments.length;t++)for(e in arguments[t])arguments[t].hasOwnProperty(e)&&void 0===r[e]&&(r[e]=arguments[t][e]);return r},a.prepareContent=function(r,t,i,n,s){return u.Promise.resolve(t).then(function(i){return o.blob&&(i instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(i)))&&"undefined"!=typeof FileReader?new u.Promise(function(e,r){var t=new FileReader;t.onload=function(t){e(t.target.result)},t.onerror=function(t){r(t.target.error)},t.readAsArrayBuffer(i)}):i}).then(function(t){var e=a.getTypeOf(t);return e?("arraybuffer"===e?t=a.transformTo("uint8array",t):"string"===e&&(s?t=h.decode(t):i&&!0!==n&&(t=function(t){return l(t,o.uint8array?new Uint8Array(t.length):new Array(t.length))}(t))),t):u.Promise.reject(new Error("Can't read the data of '"+r+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,"set-immediate-shim":54}],33:[function(t,e,r){"use strict";var i=t("./reader/readerFor"),n=t("./utils"),s=t("./signature"),a=t("./zipEntry"),o=(t("./utf8"),t("./support"));function h(t){this.files=[],this.loadOptions=t}h.prototype={checkSignature:function(t){if(!this.reader.readAndCheckSignature(t)){this.reader.index-=4;var e=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+n.pretty(e)+", expected "+n.pretty(t)+")")}},isSignature:function(t,e){var r=this.reader.index;this.reader.setIndex(t);var i=this.reader.readString(4)===e;return this.reader.setIndex(r),i},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var t=this.reader.readData(this.zipCommentLength),e=o.uint8array?"uint8array":"array",r=n.transformTo(e,t);this.zipComment=this.loadOptions.decodeFileName(r)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var t,e,r,i=this.zip64EndOfCentralSize-44;0<i;)t=this.reader.readInt(2),e=this.reader.readInt(4),r=this.reader.readData(e),this.zip64ExtensibleData[t]={id:t,length:e,value:r}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var t,e;for(t=0;t<this.files.length;t++)e=this.files[t],this.reader.setIndex(e.localHeaderOffset),this.checkSignature(s.LOCAL_FILE_HEADER),e.readLocalPart(this.reader),e.handleUTF8(),e.processAttributes()},readCentralDir:function(){var t;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(s.CENTRAL_FILE_HEADER);)(t=new a({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(t);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var t=this.reader.lastIndexOfSignature(s.CENTRAL_DIRECTORY_END);if(t<0)throw!this.isSignature(0,s.LOCAL_FILE_HEADER)?new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html"):new Error("Corrupted zip: can't find end of central directory");this.reader.setIndex(t);var e=t;if(this.checkSignature(s.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===n.MAX_VALUE_16BITS||this.diskWithCentralDirStart===n.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===n.MAX_VALUE_16BITS||this.centralDirRecords===n.MAX_VALUE_16BITS||this.centralDirSize===n.MAX_VALUE_32BITS||this.centralDirOffset===n.MAX_VALUE_32BITS){if(this.zip64=!0,(t=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(t),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,s.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var r=this.centralDirOffset+this.centralDirSize;this.zip64&&(r+=20,r+=12+this.zip64EndOfCentralSize);var i=e-r;if(0<i)this.isSignature(e,s.CENTRAL_FILE_HEADER)||(this.reader.zero=i);else if(i<0)throw new Error("Corrupted zip: missing "+Math.abs(i)+" bytes.")},prepareReader:function(t){this.reader=i(t)},load:function(t){this.prepareReader(t),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},e.exports=h},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utf8":31,"./utils":32,"./zipEntry":34}],34:[function(t,e,r){"use strict";var i=t("./reader/readerFor"),s=t("./utils"),n=t("./compressedObject"),a=t("./crc32"),o=t("./utf8"),h=t("./compressions"),u=t("./support");function l(t,e){this.options=t,this.loadOptions=e}l.prototype={isEncrypted:function(){return 1==(1&this.bitFlag)},useUTF8:function(){return 2048==(2048&this.bitFlag)},readLocalPart:function(t){var e,r;if(t.skip(22),this.fileNameLength=t.readInt(2),r=t.readInt(2),this.fileName=t.readData(this.fileNameLength),t.skip(r),-1===this.compressedSize||-1===this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(null===(e=function(t){for(var e in h)if(h.hasOwnProperty(e)&&h[e].magic===t)return h[e];return null}(this.compressionMethod)))throw new Error("Corrupted zip : compression "+s.pretty(this.compressionMethod)+" unknown (inner file : "+s.transformTo("string",this.fileName)+")");this.decompressed=new n(this.compressedSize,this.uncompressedSize,this.crc32,e,t.readData(this.compressedSize))},readCentralPart:function(t){this.versionMadeBy=t.readInt(2),t.skip(2),this.bitFlag=t.readInt(2),this.compressionMethod=t.readString(2),this.date=t.readDate(),this.crc32=t.readInt(4),this.compressedSize=t.readInt(4),this.uncompressedSize=t.readInt(4);var e=t.readInt(2);if(this.extraFieldsLength=t.readInt(2),this.fileCommentLength=t.readInt(2),this.diskNumberStart=t.readInt(2),this.internalFileAttributes=t.readInt(2),this.externalFileAttributes=t.readInt(4),this.localHeaderOffset=t.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");t.skip(e),this.readExtraFields(t),this.parseZIP64ExtraField(t),this.fileComment=t.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var t=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0==t&&(this.dosPermissions=63&this.externalFileAttributes),3==t&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(t){if(this.extraFields[1]){var e=i(this.extraFields[1].value);this.uncompressedSize===s.MAX_VALUE_32BITS&&(this.uncompressedSize=e.readInt(8)),this.compressedSize===s.MAX_VALUE_32BITS&&(this.compressedSize=e.readInt(8)),this.localHeaderOffset===s.MAX_VALUE_32BITS&&(this.localHeaderOffset=e.readInt(8)),this.diskNumberStart===s.MAX_VALUE_32BITS&&(this.diskNumberStart=e.readInt(4))}},readExtraFields:function(t){var e,r,i,n=t.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});t.index+4<n;)e=t.readInt(2),r=t.readInt(2),i=t.readData(r),this.extraFields[e]={id:e,length:r,value:i};t.setIndex(n)},handleUTF8:function(){var t=u.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=o.utf8decode(this.fileName),this.fileCommentStr=o.utf8decode(this.fileComment);else{var e=this.findExtraFieldUnicodePath();if(null!==e)this.fileNameStr=e;else{var r=s.transformTo(t,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(r)}var i=this.findExtraFieldUnicodeComment();if(null!==i)this.fileCommentStr=i;else{var n=s.transformTo(t,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(n)}}},findExtraFieldUnicodePath:function(){var t=this.extraFields[28789];if(t){var e=i(t.value);return 1!==e.readInt(1)?null:a(this.fileName)!==e.readInt(4)?null:o.utf8decode(e.readData(t.length-5))}return null},findExtraFieldUnicodeComment:function(){var t=this.extraFields[25461];if(t){var e=i(t.value);return 1!==e.readInt(1)?null:a(this.fileComment)!==e.readInt(4)?null:o.utf8decode(e.readData(t.length-5))}return null}},e.exports=l},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(t,e,r){"use strict";function i(t,e,r){this.name=t,this.dir=r.dir,this.date=r.date,this.comment=r.comment,this.unixPermissions=r.unixPermissions,this.dosPermissions=r.dosPermissions,this._data=e,this._dataBinary=r.binary,this.options={compression:r.compression,compressionOptions:r.compressionOptions}}var s=t("./stream/StreamHelper"),n=t("./stream/DataWorker"),a=t("./utf8"),o=t("./compressedObject"),h=t("./stream/GenericWorker");i.prototype={internalStream:function(t){var e=null,r="string";try{if(!t)throw new Error("No output type specified.");var i="string"===(r=t.toLowerCase())||"text"===r;"binarystring"!==r&&"text"!==r||(r="string"),e=this._decompressWorker();var n=!this._dataBinary;n&&!i&&(e=e.pipe(new a.Utf8EncodeWorker)),!n&&i&&(e=e.pipe(new a.Utf8DecodeWorker))}catch(t){(e=new h("error")).error(t)}return new s(e,r,"")},async:function(t,e){return this.internalStream(t).accumulate(e)},nodeStream:function(t,e){return this.internalStream(t||"nodebuffer").toNodejsStream(e)},_compressWorker:function(t,e){if(this._data instanceof o&&this._data.compression.magic===t.magic)return this._data.getCompressedWorker();var r=this._decompressWorker();return this._dataBinary||(r=r.pipe(new a.Utf8EncodeWorker)),o.createWorkerFrom(r,t,e)},_decompressWorker:function(){return this._data instanceof o?this._data.getContentWorker():this._data instanceof h?this._data:new n(this._data)}};for(var u=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],l=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},f=0;f<u.length;f++)i.prototype[u[f]]=l;e.exports=i},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(t,l,e){(function(e){"use strict";var r,i,t=e.MutationObserver||e.WebKitMutationObserver;if(t){var n=0,s=new t(u),a=e.document.createTextNode("");s.observe(a,{characterData:!0}),r=function(){a.data=n=++n%2}}else if(e.setImmediate||void 0===e.MessageChannel)r="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){u(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(u,0)};else{var o=new e.MessageChannel;o.port1.onmessage=u,r=function(){o.port2.postMessage(0)}}var h=[];function u(){var t,e;i=!0;for(var r=h.length;r;){for(e=h,h=[],t=-1;++t<r;)e[t]();r=h.length}i=!1}l.exports=function(t){1!==h.push(t)||i||r()}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],37:[function(t,e,r){"use strict";var n=t("immediate");function u(){}var l={},s=["REJECTED"],a=["FULFILLED"],i=["PENDING"];function o(t){if("function"!=typeof t)throw new TypeError("resolver must be a function");this.state=i,this.queue=[],this.outcome=void 0,t!==u&&c(this,t)}function h(t,e,r){this.promise=t,"function"==typeof e&&(this.onFulfilled=e,this.callFulfilled=this.otherCallFulfilled),"function"==typeof r&&(this.onRejected=r,this.callRejected=this.otherCallRejected)}function f(e,r,i){n(function(){var t;try{t=r(i)}catch(t){return l.reject(e,t)}t===e?l.reject(e,new TypeError("Cannot resolve promise with itself")):l.resolve(e,t)})}function d(t){var e=t&&t.then;if(t&&("object"==typeof t||"function"==typeof t)&&"function"==typeof e)return function(){e.apply(t,arguments)}}function c(e,t){var r=!1;function i(t){r||(r=!0,l.reject(e,t))}function n(t){r||(r=!0,l.resolve(e,t))}var s=p(function(){t(n,i)});"error"===s.status&&i(s.value)}function p(t,e){var r={};try{r.value=t(e),r.status="success"}catch(t){r.status="error",r.value=t}return r}(e.exports=o).prototype.finally=function(e){if("function"!=typeof e)return this;var r=this.constructor;return this.then(function(t){return r.resolve(e()).then(function(){return t})},function(t){return r.resolve(e()).then(function(){throw t})})},o.prototype.catch=function(t){return this.then(null,t)},o.prototype.then=function(t,e){if("function"!=typeof t&&this.state===a||"function"!=typeof e&&this.state===s)return this;var r=new this.constructor(u);this.state!==i?f(r,this.state===a?t:e,this.outcome):this.queue.push(new h(r,t,e));return r},h.prototype.callFulfilled=function(t){l.resolve(this.promise,t)},h.prototype.otherCallFulfilled=function(t){f(this.promise,this.onFulfilled,t)},h.prototype.callRejected=function(t){l.reject(this.promise,t)},h.prototype.otherCallRejected=function(t){f(this.promise,this.onRejected,t)},l.resolve=function(t,e){var r=p(d,e);if("error"===r.status)return l.reject(t,r.value);var i=r.value;if(i)c(t,i);else{t.state=a,t.outcome=e;for(var n=-1,s=t.queue.length;++n<s;)t.queue[n].callFulfilled(e)}return t},l.reject=function(t,e){t.state=s,t.outcome=e;for(var r=-1,i=t.queue.length;++r<i;)t.queue[r].callRejected(e);return t},o.resolve=function(t){if(t instanceof this)return t;return l.resolve(new this(u),t)},o.reject=function(t){var e=new this(u);return l.reject(e,t)},o.all=function(t){var r=this;if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var i=t.length,n=!1;if(!i)return this.resolve([]);var s=new Array(i),a=0,e=-1,o=new this(u);for(;++e<i;)h(t[e],e);return o;function h(t,e){r.resolve(t).then(function(t){s[e]=t,++a!==i||n||(n=!0,l.resolve(o,s))},function(t){n||(n=!0,l.reject(o,t))})}},o.race=function(t){var e=this;if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var r=t.length,i=!1;if(!r)return this.resolve([]);var n=-1,s=new this(u);for(;++n<r;)a=t[n],e.resolve(a).then(function(t){i||(i=!0,l.resolve(s,t))},function(t){i||(i=!0,l.reject(s,t))});var a;return s}},{immediate:36}],38:[function(t,e,r){"use strict";var i={};(0,t("./lib/utils/common").assign)(i,t("./lib/deflate"),t("./lib/inflate"),t("./lib/zlib/constants")),e.exports=i},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(t,e,r){"use strict";var a=t("./zlib/deflate"),o=t("./utils/common"),h=t("./utils/strings"),n=t("./zlib/messages"),s=t("./zlib/zstream"),u=Object.prototype.toString,l=0,f=-1,d=0,c=8;function p(t){if(!(this instanceof p))return new p(t);this.options=o.assign({level:f,method:c,chunkSize:16384,windowBits:15,memLevel:8,strategy:d,to:""},t||{});var e=this.options;e.raw&&0<e.windowBits?e.windowBits=-e.windowBits:e.gzip&&0<e.windowBits&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new s,this.strm.avail_out=0;var r=a.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(r!==l)throw new Error(n[r]);if(e.header&&a.deflateSetHeader(this.strm,e.header),e.dictionary){var i;if(i="string"==typeof e.dictionary?h.string2buf(e.dictionary):"[object ArrayBuffer]"===u.call(e.dictionary)?new Uint8Array(e.dictionary):e.dictionary,(r=a.deflateSetDictionary(this.strm,i))!==l)throw new Error(n[r]);this._dict_set=!0}}function i(t,e){var r=new p(e);if(r.push(t,!0),r.err)throw r.msg||n[r.err];return r.result}p.prototype.push=function(t,e){var r,i,n=this.strm,s=this.options.chunkSize;if(this.ended)return!1;i=e===~~e?e:!0===e?4:0,"string"==typeof t?n.input=h.string2buf(t):"[object ArrayBuffer]"===u.call(t)?n.input=new Uint8Array(t):n.input=t,n.next_in=0,n.avail_in=n.input.length;do{if(0===n.avail_out&&(n.output=new o.Buf8(s),n.next_out=0,n.avail_out=s),1!==(r=a.deflate(n,i))&&r!==l)return this.onEnd(r),!(this.ended=!0);0!==n.avail_out&&(0!==n.avail_in||4!==i&&2!==i)||("string"===this.options.to?this.onData(h.buf2binstring(o.shrinkBuf(n.output,n.next_out))):this.onData(o.shrinkBuf(n.output,n.next_out)))}while((0<n.avail_in||0===n.avail_out)&&1!==r);return 4===i?(r=a.deflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===l):2!==i||(this.onEnd(l),!(n.avail_out=0))},p.prototype.onData=function(t){this.chunks.push(t)},p.prototype.onEnd=function(t){t===l&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},r.Deflate=p,r.deflate=i,r.deflateRaw=function(t,e){return(e=e||{}).raw=!0,i(t,e)},r.gzip=function(t,e){return(e=e||{}).gzip=!0,i(t,e)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(t,e,r){"use strict";var d=t("./zlib/inflate"),c=t("./utils/common"),p=t("./utils/strings"),m=t("./zlib/constants"),i=t("./zlib/messages"),n=t("./zlib/zstream"),s=t("./zlib/gzheader"),_=Object.prototype.toString;function a(t){if(!(this instanceof a))return new a(t);this.options=c.assign({chunkSize:16384,windowBits:0,to:""},t||{});var e=this.options;e.raw&&0<=e.windowBits&&e.windowBits<16&&(e.windowBits=-e.windowBits,0===e.windowBits&&(e.windowBits=-15)),!(0<=e.windowBits&&e.windowBits<16)||t&&t.windowBits||(e.windowBits+=32),15<e.windowBits&&e.windowBits<48&&0==(15&e.windowBits)&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new n,this.strm.avail_out=0;var r=d.inflateInit2(this.strm,e.windowBits);if(r!==m.Z_OK)throw new Error(i[r]);this.header=new s,d.inflateGetHeader(this.strm,this.header)}function o(t,e){var r=new a(e);if(r.push(t,!0),r.err)throw r.msg||i[r.err];return r.result}a.prototype.push=function(t,e){var r,i,n,s,a,o,h=this.strm,u=this.options.chunkSize,l=this.options.dictionary,f=!1;if(this.ended)return!1;i=e===~~e?e:!0===e?m.Z_FINISH:m.Z_NO_FLUSH,"string"==typeof t?h.input=p.binstring2buf(t):"[object ArrayBuffer]"===_.call(t)?h.input=new Uint8Array(t):h.input=t,h.next_in=0,h.avail_in=h.input.length;do{if(0===h.avail_out&&(h.output=new c.Buf8(u),h.next_out=0,h.avail_out=u),(r=d.inflate(h,m.Z_NO_FLUSH))===m.Z_NEED_DICT&&l&&(o="string"==typeof l?p.string2buf(l):"[object ArrayBuffer]"===_.call(l)?new Uint8Array(l):l,r=d.inflateSetDictionary(this.strm,o)),r===m.Z_BUF_ERROR&&!0===f&&(r=m.Z_OK,f=!1),r!==m.Z_STREAM_END&&r!==m.Z_OK)return this.onEnd(r),!(this.ended=!0);h.next_out&&(0!==h.avail_out&&r!==m.Z_STREAM_END&&(0!==h.avail_in||i!==m.Z_FINISH&&i!==m.Z_SYNC_FLUSH)||("string"===this.options.to?(n=p.utf8border(h.output,h.next_out),s=h.next_out-n,a=p.buf2string(h.output,n),h.next_out=s,h.avail_out=u-s,s&&c.arraySet(h.output,h.output,n,s,0),this.onData(a)):this.onData(c.shrinkBuf(h.output,h.next_out)))),0===h.avail_in&&0===h.avail_out&&(f=!0)}while((0<h.avail_in||0===h.avail_out)&&r!==m.Z_STREAM_END);return r===m.Z_STREAM_END&&(i=m.Z_FINISH),i===m.Z_FINISH?(r=d.inflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===m.Z_OK):i!==m.Z_SYNC_FLUSH||(this.onEnd(m.Z_OK),!(h.avail_out=0))},a.prototype.onData=function(t){this.chunks.push(t)},a.prototype.onEnd=function(t){t===m.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=c.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},r.Inflate=a,r.inflate=o,r.inflateRaw=function(t,e){return(e=e||{}).raw=!0,o(t,e)},r.ungzip=o},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(t,e,r){"use strict";var i="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;r.assign=function(t){for(var e=Array.prototype.slice.call(arguments,1);e.length;){var r=e.shift();if(r){if("object"!=typeof r)throw new TypeError(r+"must be non-object");for(var i in r)r.hasOwnProperty(i)&&(t[i]=r[i])}}return t},r.shrinkBuf=function(t,e){return t.length===e?t:t.subarray?t.subarray(0,e):(t.length=e,t)};var n={arraySet:function(t,e,r,i,n){if(e.subarray&&t.subarray)t.set(e.subarray(r,r+i),n);else for(var s=0;s<i;s++)t[n+s]=e[r+s]},flattenChunks:function(t){var e,r,i,n,s,a;for(e=i=0,r=t.length;e<r;e++)i+=t[e].length;for(a=new Uint8Array(i),e=n=0,r=t.length;e<r;e++)s=t[e],a.set(s,n),n+=s.length;return a}},s={arraySet:function(t,e,r,i,n){for(var s=0;s<i;s++)t[n+s]=e[r+s]},flattenChunks:function(t){return[].concat.apply([],t)}};r.setTyped=function(t){t?(r.Buf8=Uint8Array,r.Buf16=Uint16Array,r.Buf32=Int32Array,r.assign(r,n)):(r.Buf8=Array,r.Buf16=Array,r.Buf32=Array,r.assign(r,s))},r.setTyped(i)},{}],42:[function(t,e,r){"use strict";var h=t("./common"),n=!0,s=!0;try{String.fromCharCode.apply(null,[0])}catch(t){n=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(t){s=!1}for(var u=new h.Buf8(256),i=0;i<256;i++)u[i]=252<=i?6:248<=i?5:240<=i?4:224<=i?3:192<=i?2:1;function l(t,e){if(e<65537&&(t.subarray&&s||!t.subarray&&n))return String.fromCharCode.apply(null,h.shrinkBuf(t,e));for(var r="",i=0;i<e;i++)r+=String.fromCharCode(t[i]);return r}u[254]=u[254]=1,r.string2buf=function(t){var e,r,i,n,s,a=t.length,o=0;for(n=0;n<a;n++)55296==(64512&(r=t.charCodeAt(n)))&&n+1<a&&56320==(64512&(i=t.charCodeAt(n+1)))&&(r=65536+(r-55296<<10)+(i-56320),n++),o+=r<128?1:r<2048?2:r<65536?3:4;for(e=new h.Buf8(o),n=s=0;s<o;n++)55296==(64512&(r=t.charCodeAt(n)))&&n+1<a&&56320==(64512&(i=t.charCodeAt(n+1)))&&(r=65536+(r-55296<<10)+(i-56320),n++),r<128?e[s++]=r:(r<2048?e[s++]=192|r>>>6:(r<65536?e[s++]=224|r>>>12:(e[s++]=240|r>>>18,e[s++]=128|r>>>12&63),e[s++]=128|r>>>6&63),e[s++]=128|63&r);return e},r.buf2binstring=function(t){return l(t,t.length)},r.binstring2buf=function(t){for(var e=new h.Buf8(t.length),r=0,i=e.length;r<i;r++)e[r]=t.charCodeAt(r);return e},r.buf2string=function(t,e){var r,i,n,s,a=e||t.length,o=new Array(2*a);for(r=i=0;r<a;)if((n=t[r++])<128)o[i++]=n;else if(4<(s=u[n]))o[i++]=65533,r+=s-1;else{for(n&=2===s?31:3===s?15:7;1<s&&r<a;)n=n<<6|63&t[r++],s--;1<s?o[i++]=65533:n<65536?o[i++]=n:(n-=65536,o[i++]=55296|n>>10&1023,o[i++]=56320|1023&n)}return l(o,i)},r.utf8border=function(t,e){var r;for((e=e||t.length)>t.length&&(e=t.length),r=e-1;0<=r&&128==(192&t[r]);)r--;return r<0?e:0===r?e:r+u[t[r]]>e?r:e}},{"./common":41}],43:[function(t,e,r){"use strict";e.exports=function(t,e,r,i){for(var n=65535&t|0,s=t>>>16&65535|0,a=0;0!==r;){for(r-=a=2e3<r?2e3:r;s=s+(n=n+e[i++]|0)|0,--a;);n%=65521,s%=65521}return n|s<<16|0}},{}],44:[function(t,e,r){"use strict";e.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(t,e,r){"use strict";var o=function(){for(var t,e=[],r=0;r<256;r++){t=r;for(var i=0;i<8;i++)t=1&t?3988292384^t>>>1:t>>>1;e[r]=t}return e}();e.exports=function(t,e,r,i){var n=o,s=i+r;t^=-1;for(var a=i;a<s;a++)t=t>>>8^n[255&(t^e[a])];return-1^t}},{}],46:[function(t,e,r){"use strict";var h,d=t("../utils/common"),u=t("./trees"),c=t("./adler32"),p=t("./crc32"),i=t("./messages"),l=0,f=4,m=0,_=-2,g=-1,b=4,n=2,v=8,y=9,s=286,a=30,o=19,w=2*s+1,k=15,x=3,S=258,z=S+x+1,C=42,E=113,A=1,I=2,O=3,B=4;function R(t,e){return t.msg=i[e],e}function T(t){return(t<<1)-(4<t?9:0)}function D(t){for(var e=t.length;0<=--e;)t[e]=0}function F(t){var e=t.state,r=e.pending;r>t.avail_out&&(r=t.avail_out),0!==r&&(d.arraySet(t.output,e.pending_buf,e.pending_out,r,t.next_out),t.next_out+=r,e.pending_out+=r,t.total_out+=r,t.avail_out-=r,e.pending-=r,0===e.pending&&(e.pending_out=0))}function N(t,e){u._tr_flush_block(t,0<=t.block_start?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,F(t.strm)}function U(t,e){t.pending_buf[t.pending++]=e}function P(t,e){t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=255&e}function L(t,e){var r,i,n=t.max_chain_length,s=t.strstart,a=t.prev_length,o=t.nice_match,h=t.strstart>t.w_size-z?t.strstart-(t.w_size-z):0,u=t.window,l=t.w_mask,f=t.prev,d=t.strstart+S,c=u[s+a-1],p=u[s+a];t.prev_length>=t.good_match&&(n>>=2),o>t.lookahead&&(o=t.lookahead);do{if(u[(r=e)+a]===p&&u[r+a-1]===c&&u[r]===u[s]&&u[++r]===u[s+1]){s+=2,r++;do{}while(u[++s]===u[++r]&&u[++s]===u[++r]&&u[++s]===u[++r]&&u[++s]===u[++r]&&u[++s]===u[++r]&&u[++s]===u[++r]&&u[++s]===u[++r]&&u[++s]===u[++r]&&s<d);if(i=S-(d-s),s=d-S,a<i){if(t.match_start=e,o<=(a=i))break;c=u[s+a-1],p=u[s+a]}}}while((e=f[e&l])>h&&0!=--n);return a<=t.lookahead?a:t.lookahead}function j(t){var e,r,i,n,s,a,o,h,u,l,f=t.w_size;do{if(n=t.window_size-t.lookahead-t.strstart,t.strstart>=f+(f-z)){for(d.arraySet(t.window,t.window,f,f,0),t.match_start-=f,t.strstart-=f,t.block_start-=f,e=r=t.hash_size;i=t.head[--e],t.head[e]=f<=i?i-f:0,--r;);for(e=r=f;i=t.prev[--e],t.prev[e]=f<=i?i-f:0,--r;);n+=f}if(0===t.strm.avail_in)break;if(a=t.strm,o=t.window,h=t.strstart+t.lookahead,u=n,l=void 0,l=a.avail_in,u<l&&(l=u),r=0===l?0:(a.avail_in-=l,d.arraySet(o,a.input,a.next_in,l,h),1===a.state.wrap?a.adler=c(a.adler,o,l,h):2===a.state.wrap&&(a.adler=p(a.adler,o,l,h)),a.next_in+=l,a.total_in+=l,l),t.lookahead+=r,t.lookahead+t.insert>=x)for(s=t.strstart-t.insert,t.ins_h=t.window[s],t.ins_h=(t.ins_h<<t.hash_shift^t.window[s+1])&t.hash_mask;t.insert&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[s+x-1])&t.hash_mask,t.prev[s&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=s,s++,t.insert--,!(t.lookahead+t.insert<x)););}while(t.lookahead<z&&0!==t.strm.avail_in)}function Z(t,e){for(var r,i;;){if(t.lookahead<z){if(j(t),t.lookahead<z&&e===l)return A;if(0===t.lookahead)break}if(r=0,t.lookahead>=x&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+x-1])&t.hash_mask,r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==r&&t.strstart-r<=t.w_size-z&&(t.match_length=L(t,r)),t.match_length>=x)if(i=u._tr_tally(t,t.strstart-t.match_start,t.match_length-x),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=x){for(t.match_length--;t.strstart++,t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+x-1])&t.hash_mask,r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart,0!=--t.match_length;);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+1])&t.hash_mask;else i=u._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(i&&(N(t,!1),0===t.strm.avail_out))return A}return t.insert=t.strstart<x-1?t.strstart:x-1,e===f?(N(t,!0),0===t.strm.avail_out?O:B):t.last_lit&&(N(t,!1),0===t.strm.avail_out)?A:I}function W(t,e){for(var r,i,n;;){if(t.lookahead<z){if(j(t),t.lookahead<z&&e===l)return A;if(0===t.lookahead)break}if(r=0,t.lookahead>=x&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+x-1])&t.hash_mask,r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=x-1,0!==r&&t.prev_length<t.max_lazy_match&&t.strstart-r<=t.w_size-z&&(t.match_length=L(t,r),t.match_length<=5&&(1===t.strategy||t.match_length===x&&4096<t.strstart-t.match_start)&&(t.match_length=x-1)),t.prev_length>=x&&t.match_length<=t.prev_length){for(n=t.strstart+t.lookahead-x,i=u._tr_tally(t,t.strstart-1-t.prev_match,t.prev_length-x),t.lookahead-=t.prev_length-1,t.prev_length-=2;++t.strstart<=n&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+x-1])&t.hash_mask,r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!=--t.prev_length;);if(t.match_available=0,t.match_length=x-1,t.strstart++,i&&(N(t,!1),0===t.strm.avail_out))return A}else if(t.match_available){if((i=u._tr_tally(t,0,t.window[t.strstart-1]))&&N(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return A}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(i=u._tr_tally(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<x-1?t.strstart:x-1,e===f?(N(t,!0),0===t.strm.avail_out?O:B):t.last_lit&&(N(t,!1),0===t.strm.avail_out)?A:I}function M(t,e,r,i,n){this.good_length=t,this.max_lazy=e,this.nice_length=r,this.max_chain=i,this.func=n}function H(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=v,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new d.Buf16(2*w),this.dyn_dtree=new d.Buf16(2*(2*a+1)),this.bl_tree=new d.Buf16(2*(2*o+1)),D(this.dyn_ltree),D(this.dyn_dtree),D(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new d.Buf16(k+1),this.heap=new d.Buf16(2*s+1),D(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new d.Buf16(2*s+1),D(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function G(t){var e;return t&&t.state?(t.total_in=t.total_out=0,t.data_type=n,(e=t.state).pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap?C:E,t.adler=2===e.wrap?0:1,e.last_flush=l,u._tr_init(e),m):R(t,_)}function K(t){var e=G(t);return e===m&&function(t){t.window_size=2*t.w_size,D(t.head),t.max_lazy_match=h[t.level].max_lazy,t.good_match=h[t.level].good_length,t.nice_match=h[t.level].nice_length,t.max_chain_length=h[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=x-1,t.match_available=0,t.ins_h=0}(t.state),e}function Y(t,e,r,i,n,s){if(!t)return _;var a=1;if(e===g&&(e=6),i<0?(a=0,i=-i):15<i&&(a=2,i-=16),n<1||y<n||r!==v||i<8||15<i||e<0||9<e||s<0||b<s)return R(t,_);8===i&&(i=9);var o=new H;return(t.state=o).strm=t,o.wrap=a,o.gzhead=null,o.w_bits=i,o.w_size=1<<o.w_bits,o.w_mask=o.w_size-1,o.hash_bits=n+7,o.hash_size=1<<o.hash_bits,o.hash_mask=o.hash_size-1,o.hash_shift=~~((o.hash_bits+x-1)/x),o.window=new d.Buf8(2*o.w_size),o.head=new d.Buf16(o.hash_size),o.prev=new d.Buf16(o.w_size),o.lit_bufsize=1<<n+6,o.pending_buf_size=4*o.lit_bufsize,o.pending_buf=new d.Buf8(o.pending_buf_size),o.d_buf=1*o.lit_bufsize,o.l_buf=3*o.lit_bufsize,o.level=e,o.strategy=s,o.method=r,K(t)}h=[new M(0,0,0,0,function(t,e){var r=65535;for(r>t.pending_buf_size-5&&(r=t.pending_buf_size-5);;){if(t.lookahead<=1){if(j(t),0===t.lookahead&&e===l)return A;if(0===t.lookahead)break}t.strstart+=t.lookahead,t.lookahead=0;var i=t.block_start+r;if((0===t.strstart||t.strstart>=i)&&(t.lookahead=t.strstart-i,t.strstart=i,N(t,!1),0===t.strm.avail_out))return A;if(t.strstart-t.block_start>=t.w_size-z&&(N(t,!1),0===t.strm.avail_out))return A}return t.insert=0,e===f?(N(t,!0),0===t.strm.avail_out?O:B):(t.strstart>t.block_start&&(N(t,!1),t.strm.avail_out),A)}),new M(4,4,8,4,Z),new M(4,5,16,8,Z),new M(4,6,32,32,Z),new M(4,4,16,16,W),new M(8,16,32,32,W),new M(8,16,128,128,W),new M(8,32,128,256,W),new M(32,128,258,1024,W),new M(32,258,258,4096,W)],r.deflateInit=function(t,e){return Y(t,e,v,15,8,0)},r.deflateInit2=Y,r.deflateReset=K,r.deflateResetKeep=G,r.deflateSetHeader=function(t,e){return t&&t.state?2!==t.state.wrap?_:(t.state.gzhead=e,m):_},r.deflate=function(t,e){var r,i,n,s;if(!t||!t.state||5<e||e<0)return t?R(t,_):_;if(i=t.state,!t.output||!t.input&&0!==t.avail_in||666===i.status&&e!==f)return R(t,0===t.avail_out?-5:_);if(i.strm=t,r=i.last_flush,i.last_flush=e,i.status===C)if(2===i.wrap)t.adler=0,U(i,31),U(i,139),U(i,8),i.gzhead?(U(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),U(i,255&i.gzhead.time),U(i,i.gzhead.time>>8&255),U(i,i.gzhead.time>>16&255),U(i,i.gzhead.time>>24&255),U(i,9===i.level?2:2<=i.strategy||i.level<2?4:0),U(i,255&i.gzhead.os),i.gzhead.extra&&i.gzhead.extra.length&&(U(i,255&i.gzhead.extra.length),U(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(t.adler=p(t.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=69):(U(i,0),U(i,0),U(i,0),U(i,0),U(i,0),U(i,9===i.level?2:2<=i.strategy||i.level<2?4:0),U(i,3),i.status=E);else{var a=v+(i.w_bits-8<<4)<<8;a|=(2<=i.strategy||i.level<2?0:i.level<6?1:6===i.level?2:3)<<6,0!==i.strstart&&(a|=32),a+=31-a%31,i.status=E,P(i,a),0!==i.strstart&&(P(i,t.adler>>>16),P(i,65535&t.adler)),t.adler=1}if(69===i.status)if(i.gzhead.extra){for(n=i.pending;i.gzindex<(65535&i.gzhead.extra.length)&&(i.pending!==i.pending_buf_size||(i.gzhead.hcrc&&i.pending>n&&(t.adler=p(t.adler,i.pending_buf,i.pending-n,n)),F(t),n=i.pending,i.pending!==i.pending_buf_size));)U(i,255&i.gzhead.extra[i.gzindex]),i.gzindex++;i.gzhead.hcrc&&i.pending>n&&(t.adler=p(t.adler,i.pending_buf,i.pending-n,n)),i.gzindex===i.gzhead.extra.length&&(i.gzindex=0,i.status=73)}else i.status=73;if(73===i.status)if(i.gzhead.name){n=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>n&&(t.adler=p(t.adler,i.pending_buf,i.pending-n,n)),F(t),n=i.pending,i.pending===i.pending_buf_size)){s=1;break}s=i.gzindex<i.gzhead.name.length?255&i.gzhead.name.charCodeAt(i.gzindex++):0,U(i,s)}while(0!==s);i.gzhead.hcrc&&i.pending>n&&(t.adler=p(t.adler,i.pending_buf,i.pending-n,n)),0===s&&(i.gzindex=0,i.status=91)}else i.status=91;if(91===i.status)if(i.gzhead.comment){n=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>n&&(t.adler=p(t.adler,i.pending_buf,i.pending-n,n)),F(t),n=i.pending,i.pending===i.pending_buf_size)){s=1;break}s=i.gzindex<i.gzhead.comment.length?255&i.gzhead.comment.charCodeAt(i.gzindex++):0,U(i,s)}while(0!==s);i.gzhead.hcrc&&i.pending>n&&(t.adler=p(t.adler,i.pending_buf,i.pending-n,n)),0===s&&(i.status=103)}else i.status=103;if(103===i.status&&(i.gzhead.hcrc?(i.pending+2>i.pending_buf_size&&F(t),i.pending+2<=i.pending_buf_size&&(U(i,255&t.adler),U(i,t.adler>>8&255),t.adler=0,i.status=E)):i.status=E),0!==i.pending){if(F(t),0===t.avail_out)return i.last_flush=-1,m}else if(0===t.avail_in&&T(e)<=T(r)&&e!==f)return R(t,-5);if(666===i.status&&0!==t.avail_in)return R(t,-5);if(0!==t.avail_in||0!==i.lookahead||e!==l&&666!==i.status){var o=2===i.strategy?function(t,e){for(var r;;){if(0===t.lookahead&&(j(t),0===t.lookahead)){if(e===l)return A;break}if(t.match_length=0,r=u._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,r&&(N(t,!1),0===t.strm.avail_out))return A}return t.insert=0,e===f?(N(t,!0),0===t.strm.avail_out?O:B):t.last_lit&&(N(t,!1),0===t.strm.avail_out)?A:I}(i,e):3===i.strategy?function(t,e){for(var r,i,n,s,a=t.window;;){if(t.lookahead<=S){if(j(t),t.lookahead<=S&&e===l)return A;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=x&&0<t.strstart&&(i=a[n=t.strstart-1])===a[++n]&&i===a[++n]&&i===a[++n]){s=t.strstart+S;do{}while(i===a[++n]&&i===a[++n]&&i===a[++n]&&i===a[++n]&&i===a[++n]&&i===a[++n]&&i===a[++n]&&i===a[++n]&&n<s);t.match_length=S-(s-n),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=x?(r=u._tr_tally(t,1,t.match_length-x),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(r=u._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),r&&(N(t,!1),0===t.strm.avail_out))return A}return t.insert=0,e===f?(N(t,!0),0===t.strm.avail_out?O:B):t.last_lit&&(N(t,!1),0===t.strm.avail_out)?A:I}(i,e):h[i.level].func(i,e);if(o!==O&&o!==B||(i.status=666),o===A||o===O)return 0===t.avail_out&&(i.last_flush=-1),m;if(o===I&&(1===e?u._tr_align(i):5!==e&&(u._tr_stored_block(i,0,0,!1),3===e&&(D(i.head),0===i.lookahead&&(i.strstart=0,i.block_start=0,i.insert=0))),F(t),0===t.avail_out))return i.last_flush=-1,m}return e!==f?m:i.wrap<=0?1:(2===i.wrap?(U(i,255&t.adler),U(i,t.adler>>8&255),U(i,t.adler>>16&255),U(i,t.adler>>24&255),U(i,255&t.total_in),U(i,t.total_in>>8&255),U(i,t.total_in>>16&255),U(i,t.total_in>>24&255)):(P(i,t.adler>>>16),P(i,65535&t.adler)),F(t),0<i.wrap&&(i.wrap=-i.wrap),0!==i.pending?m:1)},r.deflateEnd=function(t){var e;return t&&t.state?(e=t.state.status)!==C&&69!==e&&73!==e&&91!==e&&103!==e&&e!==E&&666!==e?R(t,_):(t.state=null,e===E?R(t,-3):m):_},r.deflateSetDictionary=function(t,e){var r,i,n,s,a,o,h,u,l=e.length;if(!t||!t.state)return _;if(2===(s=(r=t.state).wrap)||1===s&&r.status!==C||r.lookahead)return _;for(1===s&&(t.adler=c(t.adler,e,l,0)),r.wrap=0,l>=r.w_size&&(0===s&&(D(r.head),r.strstart=0,r.block_start=0,r.insert=0),u=new d.Buf8(r.w_size),d.arraySet(u,e,l-r.w_size,r.w_size,0),e=u,l=r.w_size),a=t.avail_in,o=t.next_in,h=t.input,t.avail_in=l,t.next_in=0,t.input=e,j(r);r.lookahead>=x;){for(i=r.strstart,n=r.lookahead-(x-1);r.ins_h=(r.ins_h<<r.hash_shift^r.window[i+x-1])&r.hash_mask,r.prev[i&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=i,i++,--n;);r.strstart=i,r.lookahead=x-1,j(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=x-1,r.match_available=0,t.next_in=o,t.input=h,t.avail_in=a,r.wrap=s,m},r.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(t,e,r){"use strict";e.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(t,e,r){"use strict";e.exports=function(t,e){var r,i,n,s,a,o,h,u,l,f,d,c,p,m,_,g,b,v,y,w,k,x,S,z,C;r=t.state,i=t.next_in,z=t.input,n=i+(t.avail_in-5),s=t.next_out,C=t.output,a=s-(e-t.avail_out),o=s+(t.avail_out-257),h=r.dmax,u=r.wsize,l=r.whave,f=r.wnext,d=r.window,c=r.hold,p=r.bits,m=r.lencode,_=r.distcode,g=(1<<r.lenbits)-1,b=(1<<r.distbits)-1;t:do{p<15&&(c+=z[i++]<<p,p+=8,c+=z[i++]<<p,p+=8),v=m[c&g];e:for(;;){if(c>>>=y=v>>>24,p-=y,0===(y=v>>>16&255))C[s++]=65535&v;else{if(!(16&y)){if(0==(64&y)){v=m[(65535&v)+(c&(1<<y)-1)];continue e}if(32&y){r.mode=12;break t}t.msg="invalid literal/length code",r.mode=30;break t}w=65535&v,(y&=15)&&(p<y&&(c+=z[i++]<<p,p+=8),w+=c&(1<<y)-1,c>>>=y,p-=y),p<15&&(c+=z[i++]<<p,p+=8,c+=z[i++]<<p,p+=8),v=_[c&b];r:for(;;){if(c>>>=y=v>>>24,p-=y,!(16&(y=v>>>16&255))){if(0==(64&y)){v=_[(65535&v)+(c&(1<<y)-1)];continue r}t.msg="invalid distance code",r.mode=30;break t}if(k=65535&v,p<(y&=15)&&(c+=z[i++]<<p,(p+=8)<y&&(c+=z[i++]<<p,p+=8)),h<(k+=c&(1<<y)-1)){t.msg="invalid distance too far back",r.mode=30;break t}if(c>>>=y,p-=y,(y=s-a)<k){if(l<(y=k-y)&&r.sane){t.msg="invalid distance too far back",r.mode=30;break t}if(S=d,(x=0)===f){if(x+=u-y,y<w){for(w-=y;C[s++]=d[x++],--y;);x=s-k,S=C}}else if(f<y){if(x+=u+f-y,(y-=f)<w){for(w-=y;C[s++]=d[x++],--y;);if(x=0,f<w){for(w-=y=f;C[s++]=d[x++],--y;);x=s-k,S=C}}}else if(x+=f-y,y<w){for(w-=y;C[s++]=d[x++],--y;);x=s-k,S=C}for(;2<w;)C[s++]=S[x++],C[s++]=S[x++],C[s++]=S[x++],w-=3;w&&(C[s++]=S[x++],1<w&&(C[s++]=S[x++]))}else{for(x=s-k;C[s++]=C[x++],C[s++]=C[x++],C[s++]=C[x++],2<(w-=3););w&&(C[s++]=C[x++],1<w&&(C[s++]=C[x++]))}break}}break}}while(i<n&&s<o);i-=w=p>>3,c&=(1<<(p-=w<<3))-1,t.next_in=i,t.next_out=s,t.avail_in=i<n?n-i+5:5-(i-n),t.avail_out=s<o?o-s+257:257-(s-o),r.hold=c,r.bits=p}},{}],49:[function(t,e,r){"use strict";var I=t("../utils/common"),O=t("./adler32"),B=t("./crc32"),R=t("./inffast"),T=t("./inftrees"),D=1,F=2,N=0,U=-2,P=1,i=852,n=592;function L(t){return(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24)}function s(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new I.Buf16(320),this.work=new I.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function a(t){var e;return t&&t.state?(e=t.state,t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=1&e.wrap),e.mode=P,e.last=0,e.havedict=0,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new I.Buf32(i),e.distcode=e.distdyn=new I.Buf32(n),e.sane=1,e.back=-1,N):U}function o(t){var e;return t&&t.state?((e=t.state).wsize=0,e.whave=0,e.wnext=0,a(t)):U}function h(t,e){var r,i;return t&&t.state?(i=t.state,e<0?(r=0,e=-e):(r=1+(e>>4),e<48&&(e&=15)),e&&(e<8||15<e)?U:(null!==i.window&&i.wbits!==e&&(i.window=null),i.wrap=r,i.wbits=e,o(t))):U}function u(t,e){var r,i;return t?(i=new s,(t.state=i).window=null,(r=h(t,e))!==N&&(t.state=null),r):U}var l,f,d=!0;function j(t){if(d){var e;for(l=new I.Buf32(512),f=new I.Buf32(32),e=0;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(T(D,t.lens,0,288,l,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;T(F,t.lens,0,32,f,0,t.work,{bits:5}),d=!1}t.lencode=l,t.lenbits=9,t.distcode=f,t.distbits=5}function Z(t,e,r,i){var n,s=t.state;return null===s.window&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new I.Buf8(s.wsize)),i>=s.wsize?(I.arraySet(s.window,e,r-s.wsize,s.wsize,0),s.wnext=0,s.whave=s.wsize):(i<(n=s.wsize-s.wnext)&&(n=i),I.arraySet(s.window,e,r-i,n,s.wnext),(i-=n)?(I.arraySet(s.window,e,r-i,i,0),s.wnext=i,s.whave=s.wsize):(s.wnext+=n,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=n))),0}r.inflateReset=o,r.inflateReset2=h,r.inflateResetKeep=a,r.inflateInit=function(t){return u(t,15)},r.inflateInit2=u,r.inflate=function(t,e){var r,i,n,s,a,o,h,u,l,f,d,c,p,m,_,g,b,v,y,w,k,x,S,z,C=0,E=new I.Buf8(4),A=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!t||!t.state||!t.output||!t.input&&0!==t.avail_in)return U;12===(r=t.state).mode&&(r.mode=13),a=t.next_out,n=t.output,h=t.avail_out,s=t.next_in,i=t.input,o=t.avail_in,u=r.hold,l=r.bits,f=o,d=h,x=N;t:for(;;)switch(r.mode){case P:if(0===r.wrap){r.mode=13;break}for(;l<16;){if(0===o)break t;o--,u+=i[s++]<<l,l+=8}if(2&r.wrap&&35615===u){E[r.check=0]=255&u,E[1]=u>>>8&255,r.check=B(r.check,E,2,0),l=u=0,r.mode=2;break}if(r.flags=0,r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&u)<<8)+(u>>8))%31){t.msg="incorrect header check",r.mode=30;break}if(8!=(15&u)){t.msg="unknown compression method",r.mode=30;break}if(l-=4,k=8+(15&(u>>>=4)),0===r.wbits)r.wbits=k;else if(k>r.wbits){t.msg="invalid window size",r.mode=30;break}r.dmax=1<<k,t.adler=r.check=1,r.mode=512&u?10:12,l=u=0;break;case 2:for(;l<16;){if(0===o)break t;o--,u+=i[s++]<<l,l+=8}if(r.flags=u,8!=(255&r.flags)){t.msg="unknown compression method",r.mode=30;break}if(57344&r.flags){t.msg="unknown header flags set",r.mode=30;break}r.head&&(r.head.text=u>>8&1),512&r.flags&&(E[0]=255&u,E[1]=u>>>8&255,r.check=B(r.check,E,2,0)),l=u=0,r.mode=3;case 3:for(;l<32;){if(0===o)break t;o--,u+=i[s++]<<l,l+=8}r.head&&(r.head.time=u),512&r.flags&&(E[0]=255&u,E[1]=u>>>8&255,E[2]=u>>>16&255,E[3]=u>>>24&255,r.check=B(r.check,E,4,0)),l=u=0,r.mode=4;case 4:for(;l<16;){if(0===o)break t;o--,u+=i[s++]<<l,l+=8}r.head&&(r.head.xflags=255&u,r.head.os=u>>8),512&r.flags&&(E[0]=255&u,E[1]=u>>>8&255,r.check=B(r.check,E,2,0)),l=u=0,r.mode=5;case 5:if(1024&r.flags){for(;l<16;){if(0===o)break t;o--,u+=i[s++]<<l,l+=8}r.length=u,r.head&&(r.head.extra_len=u),512&r.flags&&(E[0]=255&u,E[1]=u>>>8&255,r.check=B(r.check,E,2,0)),l=u=0}else r.head&&(r.head.extra=null);r.mode=6;case 6:if(1024&r.flags&&(o<(c=r.length)&&(c=o),c&&(r.head&&(k=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Array(r.head.extra_len)),I.arraySet(r.head.extra,i,s,c,k)),512&r.flags&&(r.check=B(r.check,i,c,s)),o-=c,s+=c,r.length-=c),r.length))break t;r.length=0,r.mode=7;case 7:if(2048&r.flags){if(0===o)break t;for(c=0;k=i[s+c++],r.head&&k&&r.length<65536&&(r.head.name+=String.fromCharCode(k)),k&&c<o;);if(512&r.flags&&(r.check=B(r.check,i,c,s)),o-=c,s+=c,k)break t}else r.head&&(r.head.name=null);r.length=0,r.mode=8;case 8:if(4096&r.flags){if(0===o)break t;for(c=0;k=i[s+c++],r.head&&k&&r.length<65536&&(r.head.comment+=String.fromCharCode(k)),k&&c<o;);if(512&r.flags&&(r.check=B(r.check,i,c,s)),o-=c,s+=c,k)break t}else r.head&&(r.head.comment=null);r.mode=9;case 9:if(512&r.flags){for(;l<16;){if(0===o)break t;o--,u+=i[s++]<<l,l+=8}if(u!==(65535&r.check)){t.msg="header crc mismatch",r.mode=30;break}l=u=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),t.adler=r.check=0,r.mode=12;break;case 10:for(;l<32;){if(0===o)break t;o--,u+=i[s++]<<l,l+=8}t.adler=r.check=L(u),l=u=0,r.mode=11;case 11:if(0===r.havedict)return t.next_out=a,t.avail_out=h,t.next_in=s,t.avail_in=o,r.hold=u,r.bits=l,2;t.adler=r.check=1,r.mode=12;case 12:if(5===e||6===e)break t;case 13:if(r.last){u>>>=7&l,l-=7&l,r.mode=27;break}for(;l<3;){if(0===o)break t;o--,u+=i[s++]<<l,l+=8}switch(r.last=1&u,l-=1,3&(u>>>=1)){case 0:r.mode=14;break;case 1:if(j(r),r.mode=20,6!==e)break;u>>>=2,l-=2;break t;case 2:r.mode=17;break;case 3:t.msg="invalid block type",r.mode=30}u>>>=2,l-=2;break;case 14:for(u>>>=7&l,l-=7&l;l<32;){if(0===o)break t;o--,u+=i[s++]<<l,l+=8}if((65535&u)!=(u>>>16^65535)){t.msg="invalid stored block lengths",r.mode=30;break}if(r.length=65535&u,l=u=0,r.mode=15,6===e)break t;case 15:r.mode=16;case 16:if(c=r.length){if(o<c&&(c=o),h<c&&(c=h),0===c)break t;I.arraySet(n,i,s,c,a),o-=c,s+=c,h-=c,a+=c,r.length-=c;break}r.mode=12;break;case 17:for(;l<14;){if(0===o)break t;o--,u+=i[s++]<<l,l+=8}if(r.nlen=257+(31&u),u>>>=5,l-=5,r.ndist=1+(31&u),u>>>=5,l-=5,r.ncode=4+(15&u),u>>>=4,l-=4,286<r.nlen||30<r.ndist){t.msg="too many length or distance symbols",r.mode=30;break}r.have=0,r.mode=18;case 18:for(;r.have<r.ncode;){for(;l<3;){if(0===o)break t;o--,u+=i[s++]<<l,l+=8}r.lens[A[r.have++]]=7&u,u>>>=3,l-=3}for(;r.have<19;)r.lens[A[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,S={bits:r.lenbits},x=T(0,r.lens,0,19,r.lencode,0,r.work,S),r.lenbits=S.bits,x){t.msg="invalid code lengths set",r.mode=30;break}r.have=0,r.mode=19;case 19:for(;r.have<r.nlen+r.ndist;){for(;g=(C=r.lencode[u&(1<<r.lenbits)-1])>>>16&255,b=65535&C,!((_=C>>>24)<=l);){if(0===o)break t;o--,u+=i[s++]<<l,l+=8}if(b<16)u>>>=_,l-=_,r.lens[r.have++]=b;else{if(16===b){for(z=_+2;l<z;){if(0===o)break t;o--,u+=i[s++]<<l,l+=8}if(u>>>=_,l-=_,0===r.have){t.msg="invalid bit length repeat",r.mode=30;break}k=r.lens[r.have-1],c=3+(3&u),u>>>=2,l-=2}else if(17===b){for(z=_+3;l<z;){if(0===o)break t;o--,u+=i[s++]<<l,l+=8}l-=_,k=0,c=3+(7&(u>>>=_)),u>>>=3,l-=3}else{for(z=_+7;l<z;){if(0===o)break t;o--,u+=i[s++]<<l,l+=8}l-=_,k=0,c=11+(127&(u>>>=_)),u>>>=7,l-=7}if(r.have+c>r.nlen+r.ndist){t.msg="invalid bit length repeat",r.mode=30;break}for(;c--;)r.lens[r.have++]=k}}if(30===r.mode)break;if(0===r.lens[256]){t.msg="invalid code -- missing end-of-block",r.mode=30;break}if(r.lenbits=9,S={bits:r.lenbits},x=T(D,r.lens,0,r.nlen,r.lencode,0,r.work,S),r.lenbits=S.bits,x){t.msg="invalid literal/lengths set",r.mode=30;break}if(r.distbits=6,r.distcode=r.distdyn,S={bits:r.distbits},x=T(F,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,S),r.distbits=S.bits,x){t.msg="invalid distances set",r.mode=30;break}if(r.mode=20,6===e)break t;case 20:r.mode=21;case 21:if(6<=o&&258<=h){t.next_out=a,t.avail_out=h,t.next_in=s,t.avail_in=o,r.hold=u,r.bits=l,R(t,d),a=t.next_out,n=t.output,h=t.avail_out,s=t.next_in,i=t.input,o=t.avail_in,u=r.hold,l=r.bits,12===r.mode&&(r.back=-1);break}for(r.back=0;g=(C=r.lencode[u&(1<<r.lenbits)-1])>>>16&255,b=65535&C,!((_=C>>>24)<=l);){if(0===o)break t;o--,u+=i[s++]<<l,l+=8}if(g&&0==(240&g)){for(v=_,y=g,w=b;g=(C=r.lencode[w+((u&(1<<v+y)-1)>>v)])>>>16&255,b=65535&C,!(v+(_=C>>>24)<=l);){if(0===o)break t;o--,u+=i[s++]<<l,l+=8}u>>>=v,l-=v,r.back+=v}if(u>>>=_,l-=_,r.back+=_,r.length=b,0===g){r.mode=26;break}if(32&g){r.back=-1,r.mode=12;break}if(64&g){t.msg="invalid literal/length code",r.mode=30;break}r.extra=15&g,r.mode=22;case 22:if(r.extra){for(z=r.extra;l<z;){if(0===o)break t;o--,u+=i[s++]<<l,l+=8}r.length+=u&(1<<r.extra)-1,u>>>=r.extra,l-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=23;case 23:for(;g=(C=r.distcode[u&(1<<r.distbits)-1])>>>16&255,b=65535&C,!((_=C>>>24)<=l);){if(0===o)break t;o--,u+=i[s++]<<l,l+=8}if(0==(240&g)){for(v=_,y=g,w=b;g=(C=r.distcode[w+((u&(1<<v+y)-1)>>v)])>>>16&255,b=65535&C,!(v+(_=C>>>24)<=l);){if(0===o)break t;o--,u+=i[s++]<<l,l+=8}u>>>=v,l-=v,r.back+=v}if(u>>>=_,l-=_,r.back+=_,64&g){t.msg="invalid distance code",r.mode=30;break}r.offset=b,r.extra=15&g,r.mode=24;case 24:if(r.extra){for(z=r.extra;l<z;){if(0===o)break t;o--,u+=i[s++]<<l,l+=8}r.offset+=u&(1<<r.extra)-1,u>>>=r.extra,l-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){t.msg="invalid distance too far back",r.mode=30;break}r.mode=25;case 25:if(0===h)break t;if(c=d-h,r.offset>c){if((c=r.offset-c)>r.whave&&r.sane){t.msg="invalid distance too far back",r.mode=30;break}p=c>r.wnext?(c-=r.wnext,r.wsize-c):r.wnext-c,c>r.length&&(c=r.length),m=r.window}else m=n,p=a-r.offset,c=r.length;for(h<c&&(c=h),h-=c,r.length-=c;n[a++]=m[p++],--c;);0===r.length&&(r.mode=21);break;case 26:if(0===h)break t;n[a++]=r.length,h--,r.mode=21;break;case 27:if(r.wrap){for(;l<32;){if(0===o)break t;o--,u|=i[s++]<<l,l+=8}if(d-=h,t.total_out+=d,r.total+=d,d&&(t.adler=r.check=r.flags?B(r.check,n,d,a-d):O(r.check,n,d,a-d)),d=h,(r.flags?u:L(u))!==r.check){t.msg="incorrect data check",r.mode=30;break}l=u=0}r.mode=28;case 28:if(r.wrap&&r.flags){for(;l<32;){if(0===o)break t;o--,u+=i[s++]<<l,l+=8}if(u!==(4294967295&r.total)){t.msg="incorrect length check",r.mode=30;break}l=u=0}r.mode=29;case 29:x=1;break t;case 30:x=-3;break t;case 31:return-4;case 32:default:return U}return t.next_out=a,t.avail_out=h,t.next_in=s,t.avail_in=o,r.hold=u,r.bits=l,(r.wsize||d!==t.avail_out&&r.mode<30&&(r.mode<27||4!==e))&&Z(t,t.output,t.next_out,d-t.avail_out)?(r.mode=31,-4):(f-=t.avail_in,d-=t.avail_out,t.total_in+=f,t.total_out+=d,r.total+=d,r.wrap&&d&&(t.adler=r.check=r.flags?B(r.check,n,d,t.next_out-d):O(r.check,n,d,t.next_out-d)),t.data_type=r.bits+(r.last?64:0)+(12===r.mode?128:0)+(20===r.mode||15===r.mode?256:0),(0==f&&0===d||4===e)&&x===N&&(x=-5),x)},r.inflateEnd=function(t){if(!t||!t.state)return U;var e=t.state;return e.window&&(e.window=null),t.state=null,N},r.inflateGetHeader=function(t,e){var r;return t&&t.state?0==(2&(r=t.state).wrap)?U:((r.head=e).done=!1,N):U},r.inflateSetDictionary=function(t,e){var r,i=e.length;return t&&t.state?0!==(r=t.state).wrap&&11!==r.mode?U:11===r.mode&&O(1,e,i,0)!==r.check?-3:Z(t,e,i,i)?(r.mode=31,-4):(r.havedict=1,N):U},r.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(t,e,r){"use strict";var D=t("../utils/common"),F=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],N=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],U=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],P=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];e.exports=function(t,e,r,i,n,s,a,o){var h,u,l,f,d,c,p,m,_,g=o.bits,b=0,v=0,y=0,w=0,k=0,x=0,S=0,z=0,C=0,E=0,A=null,I=0,O=new D.Buf16(16),B=new D.Buf16(16),R=null,T=0;for(b=0;b<=15;b++)O[b]=0;for(v=0;v<i;v++)O[e[r+v]]++;for(k=g,w=15;1<=w&&0===O[w];w--);if(w<k&&(k=w),0===w)return n[s++]=20971520,n[s++]=20971520,o.bits=1,0;for(y=1;y<w&&0===O[y];y++);for(k<y&&(k=y),b=z=1;b<=15;b++)if(z<<=1,(z-=O[b])<0)return-1;if(0<z&&(0===t||1!==w))return-1;for(B[1]=0,b=1;b<15;b++)B[b+1]=B[b]+O[b];for(v=0;v<i;v++)0!==e[r+v]&&(a[B[e[r+v]]++]=v);if(c=0===t?(A=R=a,19):1===t?(A=F,I-=257,R=N,T-=257,256):(A=U,R=P,-1),b=y,d=s,S=v=E=0,l=-1,f=(C=1<<(x=k))-1,1===t&&852<C||2===t&&592<C)return 1;for(;;){for(p=b-S,_=a[v]<c?(m=0,a[v]):a[v]>c?(m=R[T+a[v]],A[I+a[v]]):(m=96,0),h=1<<b-S,y=u=1<<x;n[d+(E>>S)+(u-=h)]=p<<24|m<<16|_|0,0!==u;);for(h=1<<b-1;E&h;)h>>=1;if(0!==h?(E&=h-1,E+=h):E=0,v++,0==--O[b]){if(b===w)break;b=e[r+a[v]]}if(k<b&&(E&f)!==l){for(0===S&&(S=k),d+=y,z=1<<(x=b-S);x+S<w&&!((z-=O[x+S])<=0);)x++,z<<=1;if(C+=1<<x,1===t&&852<C||2===t&&592<C)return 1;n[l=E&f]=k<<24|x<<16|d-s|0}}return 0!==E&&(n[d+E]=b-S<<24|64<<16|0),o.bits=k,0}},{"../utils/common":41}],51:[function(t,e,r){"use strict";e.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(t,e,r){"use strict";var n=t("../utils/common"),o=0,h=1;function i(t){for(var e=t.length;0<=--e;)t[e]=0}var s=0,a=29,u=256,l=u+1+a,f=30,d=19,_=2*l+1,g=15,c=16,p=7,m=256,b=16,v=17,y=18,w=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],k=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],x=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],S=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],z=new Array(2*(l+2));i(z);var C=new Array(2*f);i(C);var E=new Array(512);i(E);var A=new Array(256);i(A);var I=new Array(a);i(I);var O,B,R,T=new Array(f);function D(t,e,r,i,n){this.static_tree=t,this.extra_bits=e,this.extra_base=r,this.elems=i,this.max_length=n,this.has_stree=t&&t.length}function F(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}function N(t){return t<256?E[t]:E[256+(t>>>7)]}function U(t,e){t.pending_buf[t.pending++]=255&e,t.pending_buf[t.pending++]=e>>>8&255}function P(t,e,r){t.bi_valid>c-r?(t.bi_buf|=e<<t.bi_valid&65535,U(t,t.bi_buf),t.bi_buf=e>>c-t.bi_valid,t.bi_valid+=r-c):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=r)}function L(t,e,r){P(t,r[2*e],r[2*e+1])}function j(t,e){for(var r=0;r|=1&t,t>>>=1,r<<=1,0<--e;);return r>>>1}function Z(t,e,r){var i,n,s=new Array(g+1),a=0;for(i=1;i<=g;i++)s[i]=a=a+r[i-1]<<1;for(n=0;n<=e;n++){var o=t[2*n+1];0!==o&&(t[2*n]=j(s[o]++,o))}}function W(t){var e;for(e=0;e<l;e++)t.dyn_ltree[2*e]=0;for(e=0;e<f;e++)t.dyn_dtree[2*e]=0;for(e=0;e<d;e++)t.bl_tree[2*e]=0;t.dyn_ltree[2*m]=1,t.opt_len=t.static_len=0,t.last_lit=t.matches=0}function M(t){8<t.bi_valid?U(t,t.bi_buf):0<t.bi_valid&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0}function H(t,e,r,i){var n=2*e,s=2*r;return t[n]<t[s]||t[n]===t[s]&&i[e]<=i[r]}function G(t,e,r){for(var i=t.heap[r],n=r<<1;n<=t.heap_len&&(n<t.heap_len&&H(e,t.heap[n+1],t.heap[n],t.depth)&&n++,!H(e,i,t.heap[n],t.depth));)t.heap[r]=t.heap[n],r=n,n<<=1;t.heap[r]=i}function K(t,e,r){var i,n,s,a,o=0;if(0!==t.last_lit)for(;i=t.pending_buf[t.d_buf+2*o]<<8|t.pending_buf[t.d_buf+2*o+1],n=t.pending_buf[t.l_buf+o],o++,0===i?L(t,n,e):(L(t,(s=A[n])+u+1,e),0!==(a=w[s])&&P(t,n-=I[s],a),L(t,s=N(--i),r),0!==(a=k[s])&&P(t,i-=T[s],a)),o<t.last_lit;);L(t,m,e)}function Y(t,e){var r,i,n,s=e.dyn_tree,a=e.stat_desc.static_tree,o=e.stat_desc.has_stree,h=e.stat_desc.elems,u=-1;for(t.heap_len=0,t.heap_max=_,r=0;r<h;r++)0!==s[2*r]?(t.heap[++t.heap_len]=u=r,t.depth[r]=0):s[2*r+1]=0;for(;t.heap_len<2;)s[2*(n=t.heap[++t.heap_len]=u<2?++u:0)]=1,t.depth[n]=0,t.opt_len--,o&&(t.static_len-=a[2*n+1]);for(e.max_code=u,r=t.heap_len>>1;1<=r;r--)G(t,s,r);for(n=h;r=t.heap[1],t.heap[1]=t.heap[t.heap_len--],G(t,s,1),i=t.heap[1],t.heap[--t.heap_max]=r,t.heap[--t.heap_max]=i,s[2*n]=s[2*r]+s[2*i],t.depth[n]=(t.depth[r]>=t.depth[i]?t.depth[r]:t.depth[i])+1,s[2*r+1]=s[2*i+1]=n,t.heap[1]=n++,G(t,s,1),2<=t.heap_len;);t.heap[--t.heap_max]=t.heap[1],function(t,e){var r,i,n,s,a,o,h=e.dyn_tree,u=e.max_code,l=e.stat_desc.static_tree,f=e.stat_desc.has_stree,d=e.stat_desc.extra_bits,c=e.stat_desc.extra_base,p=e.stat_desc.max_length,m=0;for(s=0;s<=g;s++)t.bl_count[s]=0;for(h[2*t.heap[t.heap_max]+1]=0,r=t.heap_max+1;r<_;r++)p<(s=h[2*h[2*(i=t.heap[r])+1]+1]+1)&&(s=p,m++),h[2*i+1]=s,u<i||(t.bl_count[s]++,a=0,c<=i&&(a=d[i-c]),o=h[2*i],t.opt_len+=o*(s+a),f&&(t.static_len+=o*(l[2*i+1]+a)));if(0!==m){do{for(s=p-1;0===t.bl_count[s];)s--;t.bl_count[s]--,t.bl_count[s+1]+=2,t.bl_count[p]--,m-=2}while(0<m);for(s=p;0!==s;s--)for(i=t.bl_count[s];0!==i;)u<(n=t.heap[--r])||(h[2*n+1]!==s&&(t.opt_len+=(s-h[2*n+1])*h[2*n],h[2*n+1]=s),i--)}}(t,e),Z(s,u,t.bl_count)}function X(t,e,r){var i,n,s=-1,a=e[1],o=0,h=7,u=4;for(0===a&&(h=138,u=3),e[2*(r+1)+1]=65535,i=0;i<=r;i++)n=a,a=e[2*(i+1)+1],++o<h&&n===a||(o<u?t.bl_tree[2*n]+=o:0!==n?(n!==s&&t.bl_tree[2*n]++,t.bl_tree[2*b]++):o<=10?t.bl_tree[2*v]++:t.bl_tree[2*y]++,s=n,u=(o=0)===a?(h=138,3):n===a?(h=6,3):(h=7,4))}function V(t,e,r){var i,n,s=-1,a=e[1],o=0,h=7,u=4;for(0===a&&(h=138,u=3),i=0;i<=r;i++)if(n=a,a=e[2*(i+1)+1],!(++o<h&&n===a)){if(o<u)for(;L(t,n,t.bl_tree),0!=--o;);else 0!==n?(n!==s&&(L(t,n,t.bl_tree),o--),L(t,b,t.bl_tree),P(t,o-3,2)):o<=10?(L(t,v,t.bl_tree),P(t,o-3,3)):(L(t,y,t.bl_tree),P(t,o-11,7));s=n,u=(o=0)===a?(h=138,3):n===a?(h=6,3):(h=7,4)}}i(T);var q=!1;function J(t,e,r,i){P(t,(s<<1)+(i?1:0),3),function(t,e,r,i){M(t),i&&(U(t,r),U(t,~r)),n.arraySet(t.pending_buf,t.window,e,r,t.pending),t.pending+=r}(t,e,r,!0)}r._tr_init=function(t){q||(function(){var t,e,r,i,n,s=new Array(g+1);for(i=r=0;i<a-1;i++)for(I[i]=r,t=0;t<1<<w[i];t++)A[r++]=i;for(A[r-1]=i,i=n=0;i<16;i++)for(T[i]=n,t=0;t<1<<k[i];t++)E[n++]=i;for(n>>=7;i<f;i++)for(T[i]=n<<7,t=0;t<1<<k[i]-7;t++)E[256+n++]=i;for(e=0;e<=g;e++)s[e]=0;for(t=0;t<=143;)z[2*t+1]=8,t++,s[8]++;for(;t<=255;)z[2*t+1]=9,t++,s[9]++;for(;t<=279;)z[2*t+1]=7,t++,s[7]++;for(;t<=287;)z[2*t+1]=8,t++,s[8]++;for(Z(z,l+1,s),t=0;t<f;t++)C[2*t+1]=5,C[2*t]=j(t,5);O=new D(z,w,u+1,l,g),B=new D(C,k,0,f,g),R=new D(new Array(0),x,0,d,p)}(),q=!0),t.l_desc=new F(t.dyn_ltree,O),t.d_desc=new F(t.dyn_dtree,B),t.bl_desc=new F(t.bl_tree,R),t.bi_buf=0,t.bi_valid=0,W(t)},r._tr_stored_block=J,r._tr_flush_block=function(t,e,r,i){var n,s,a=0;0<t.level?(2===t.strm.data_type&&(t.strm.data_type=function(t){var e,r=4093624447;for(e=0;e<=31;e++,r>>>=1)if(1&r&&0!==t.dyn_ltree[2*e])return o;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return h;for(e=32;e<u;e++)if(0!==t.dyn_ltree[2*e])return h;return o}(t)),Y(t,t.l_desc),Y(t,t.d_desc),a=function(t){var e;for(X(t,t.dyn_ltree,t.l_desc.max_code),X(t,t.dyn_dtree,t.d_desc.max_code),Y(t,t.bl_desc),e=d-1;3<=e&&0===t.bl_tree[2*S[e]+1];e--);return t.opt_len+=3*(e+1)+5+5+4,e}(t),n=t.opt_len+3+7>>>3,(s=t.static_len+3+7>>>3)<=n&&(n=s)):n=s=r+5,r+4<=n&&-1!==e?J(t,e,r,i):4===t.strategy||s===n?(P(t,2+(i?1:0),3),K(t,z,C)):(P(t,4+(i?1:0),3),function(t,e,r,i){var n;for(P(t,e-257,5),P(t,r-1,5),P(t,i-4,4),n=0;n<i;n++)P(t,t.bl_tree[2*S[n]+1],3);V(t,t.dyn_ltree,e-1),V(t,t.dyn_dtree,r-1)}(t,t.l_desc.max_code+1,t.d_desc.max_code+1,a+1),K(t,t.dyn_ltree,t.dyn_dtree)),W(t),i&&M(t)},r._tr_tally=function(t,e,r){return t.pending_buf[t.d_buf+2*t.last_lit]=e>>>8&255,t.pending_buf[t.d_buf+2*t.last_lit+1]=255&e,t.pending_buf[t.l_buf+t.last_lit]=255&r,t.last_lit++,0===e?t.dyn_ltree[2*r]++:(t.matches++,e--,t.dyn_ltree[2*(A[r]+u+1)]++,t.dyn_dtree[2*N(e)]++),t.last_lit===t.lit_bufsize-1},r._tr_align=function(t){P(t,2,3),L(t,m,z),function(t){16===t.bi_valid?(U(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):8<=t.bi_valid&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)}(t)}},{"../utils/common":41}],53:[function(t,e,r){"use strict";e.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(t,e,r){"use strict";e.exports="function"==typeof setImmediate?setImmediate:function(){var t=[].slice.apply(arguments);t.splice(1,0,0),setTimeout.apply(null,t)}},{}]},{},[10])(10)});
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("b639").Buffer, __webpack_require__("c8ba")))

/***/ }),

/***/ "c5d0":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var $ = __webpack_require__("23e7");
var createHTML = __webpack_require__("857a");
var forcedStringHTMLMethod = __webpack_require__("af03");

// `String.prototype.italics` method
// https://tc39.es/ecma262/#sec-string.prototype.italics
$({ target: 'String', proto: true, forced: forcedStringHTMLMethod('italics') }, {
  italics: function italics() {
    return createHTML(this, 'i', '', '');
  }
});


/***/ }),

/***/ "c607":
/***/ (function(module, exports, __webpack_require__) {

var global = __webpack_require__("da84");
var DESCRIPTORS = __webpack_require__("83ab");
var UNSUPPORTED_DOT_ALL = __webpack_require__("fce3");
var classof = __webpack_require__("c6b6");
var defineProperty = __webpack_require__("9bf2").f;
var getInternalState = __webpack_require__("69f3").get;

var RegExpPrototype = RegExp.prototype;
var TypeError = global.TypeError;

// `RegExp.prototype.dotAll` getter
// https://tc39.es/ecma262/#sec-get-regexp.prototype.dotall
if (DESCRIPTORS && UNSUPPORTED_DOT_ALL) {
  defineProperty(RegExpPrototype, 'dotAll', {
    configurable: true,
    get: function () {
      if (this === RegExpPrototype) return undefined;
      // We can't use InternalStateModule.getterFor because
      // we don't add metadata for regexps created by a literal.
      if (classof(this) === 'RegExp') {
        return !!getInternalState(this).dotAll;
      }
      throw TypeError('Incompatible receiver, RegExp required');
    }
  });
}


/***/ }),

/***/ "c60d":
/***/ (function(module, exports, __webpack_require__) {

var hasOwn = __webpack_require__("1a2d");

module.exports = function (descriptor) {
  return descriptor !== undefined && (hasOwn(descriptor, 'value') || hasOwn(descriptor, 'writable'));
};


/***/ }),

/***/ "c631":
/***/ (function(module, exports, __webpack_require__) {

// Imports
var ___CSS_LOADER_API_IMPORT___ = __webpack_require__("24fb");
exports = ___CSS_LOADER_API_IMPORT___(false);
// Module
exports.push([module.i, ".sheet-edit[data-v-4fb99c2a]{width:100%;height:100%;position:relative}", ""]);
// Exports
module.exports = exports;


/***/ }),

/***/ "c65b":
/***/ (function(module, exports) {

var call = Function.prototype.call;

module.exports = call.bind ? call.bind(call) : function () {
  return call.apply(call, arguments);
};


/***/ }),

/***/ "c6b6":
/***/ (function(module, exports, __webpack_require__) {

var uncurryThis = __webpack_require__("e330");

var toString = uncurryThis({}.toString);
var stringSlice = uncurryThis(''.slice);

module.exports = function (it) {
  return stringSlice(toString(it), 8, -1);
};


/***/ }),

/***/ "c6cd":
/***/ (function(module, exports, __webpack_require__) {

var global = __webpack_require__("da84");
var setGlobal = __webpack_require__("ce4e");

var SHARED = '__core-js_shared__';
var store = global[SHARED] || setGlobal(SHARED, {});

module.exports = store;


/***/ }),

/***/ "c740":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var $ = __webpack_require__("23e7");
var $findIndex = __webpack_require__("b727").findIndex;
var addToUnscopables = __webpack_require__("44d2");

var FIND_INDEX = 'findIndex';
var SKIPS_HOLES = true;

// Shouldn't skip holes
if (FIND_INDEX in []) Array(1)[FIND_INDEX](function () { SKIPS_HOLES = false; });

// `Array.prototype.findIndex` method
// https://tc39.es/ecma262/#sec-array.prototype.findindex
$({ target: 'Array', proto: true, forced: SKIPS_HOLES }, {
  findIndex: function findIndex(callbackfn /* , that = undefined */) {
    return $findIndex(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);
  }
});

// https://tc39.es/ecma262/#sec-array.prototype-@@unscopables
addToUnscopables(FIND_INDEX);


/***/ }),

/***/ "c8ba":
/***/ (function(module, exports) {

var g;

// This works in non-strict mode
g = (function() {
	return this;
})();

try {
	// This works if eval is allowed (see CSP)
	g = g || new Function("return this")();
} catch (e) {
	// This works if the window reference is available
	if (typeof window === "object") g = window;
}

// g can still be undefined, but nothing to do about it...
// We return undefined, instead of nothing here, so it's
// easier to handle this case. if(!global) { ...}

module.exports = g;


/***/ }),

/***/ "c8d2":
/***/ (function(module, exports, __webpack_require__) {

var PROPER_FUNCTION_NAME = __webpack_require__("5e77").PROPER;
var fails = __webpack_require__("d039");
var whitespaces = __webpack_require__("5899");

var non = '\u200B\u0085\u180E';

// check that a method works with the correct list
// of whitespaces and has a correct name
module.exports = function (METHOD_NAME) {
  return fails(function () {
    return !!whitespaces[METHOD_NAME]()
      || non[METHOD_NAME]() !== non
      || (PROPER_FUNCTION_NAME && whitespaces[METHOD_NAME].name !== METHOD_NAME);
  });
};


/***/ }),

/***/ "ca40":
/***/ (function(module, exports) {

module.exports = "data:font/ttf;base64,AAEAAAALAIAAAwAwR1NVQiCLJXoAAAE4AAAAVE9TLzI8F0veAAABjAAAAGBjbWFwOybVcAAAAjgAAAK2Z2x5ZoELv68AAAUYAAAI6GhlYWQjiwa7AAAA4AAAADZoaGVhB94DlAAAALwAAAAkaG10eEwAAAAAAAHsAAAATGxvY2EUthaoAAAE8AAAAChtYXhwASgAcAAAARgAAAAgbmFtZYhxJ0gAAA4AAAACl3Bvc3RCTK1TAAAQmAAAAOEAAQAAA4D/gABcBAAAAAAABAAAAQAAAAAAAAAAAAAAAAAAABMAAQAAAAEAAHyP5NdfDzz1AAsEAAAAAADgNeFfAAAAAOA14V8AAP+/BAADQQAAAAgAAgAAAAAAAAABAAAAEwBkAAsAAAAAAAIAAAAKAAoAAAD/AAAAAAAAAAEAAAAKADAAPgACREZMVAAObGF0bgAaAAQAAAAAAAAAAQAAAAQAAAAAAAAAAQAAAAFsaWdhAAgAAAABAAAAAQAEAAQAAAABAAgAAQAGAAAAAQAAAAQEAAGQAAUAAAKJAswAAACPAokCzAAAAesAMgEIAAACAAUDAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFBmRWQAwOYC6Q4DgP+AAAAD3ACAAAAAAQAAAAAAAAAAAAAAAAACBAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAAAAAUAAAADAAAALAAAAAQAAAHOAAEAAAAAAMgAAwABAAAALAADAAoAAAHOAAQAnAAAABoAEAADAArmAuYM5hHmGuYe5ijmPOZV5nXmrOf96Q7//wAA5gLmC+YO5hnmHuYn5jzmVeZ15qzn/ekO//8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAaABoAHAAiACQAJAAmACYAJgAmACYAJgAAAA0AAQACAAQABQADAAYAEQASAAcACgAIAA8ACQAOAAwACwAQAAABBgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAADoAAAAAAAAABIAAOYCAADmAgAAAA0AAOYLAADmCwAAAAEAAOYMAADmDAAAAAIAAOYOAADmDgAAAAQAAOYPAADmDwAAAAUAAOYQAADmEAAAAAMAAOYRAADmEQAAAAYAAOYZAADmGQAAABEAAOYaAADmGgAAABIAAOYeAADmHgAAAAcAAOYnAADmJwAAAAoAAOYoAADmKAAAAAgAAOY8AADmPAAAAA8AAOZVAADmVQAAAAkAAOZ1AADmdQAAAA4AAOasAADmrAAAAAwAAOf9AADn/QAAAAsAAOkOAADpDgAAABAAAAAAAAAAJABCANwBAAFIAZABwgHiAmICfgK4AwADbgPEA9IEPgRSBHQABAAA/8YDwAM+AAMABwALAA8AAAUhESEBIREhEyEVIRMzESMDv/yCA3781ALb/SVPAjn9x/RRUToDd/zaAtX+vVIBRv3HAAAAAwAA/8YDwAM+AAMABwALAAAFIREhASERIRMhFSEDv/yCA3781ALb/SVPAjn9xzoDd/zaAtX+vVIAAAAACAAA/78DwQMrABQAGAAlADMANwBAAF8AYwAAATIXFh8BFRQGDwEjIiYvATU0NjczAxUhNSUBFh8BMzI2PwE1NCcHMhYUBg8BIyIuATY/AQERIxEBEQ4BBx0BIxETBgcdASMiDgEWHwEzFRQeATY/ATUzMj4BJi8BNTQmExEjEQNuIhgUAwEqHwncHy8DASsfCJL+VQNA/tcNEgfcFCACARAhBggFBQRfBQkBBgUE/kCqAaojLwNV/AUCIgUIAgYFBCIHCgkBASEGCQIHBiUOp6oBQBgUHQncHy8DASofCdwgLgT+61VV6f7YDgIBHBQH3BYRywkKCAEBBwsJAQEBi/6rAVUBVv5ODTwmCoACq/3VAwUEIQcLCQEBIQYIAQYFBCEHCwkBASEICAF8/wABAAAAAAAEAAD/1QOrAysAAwAHAAsADwAAJRUhNQERIxEBESMRBREjEQOr/KoBAKoBqqoBqqorVlYBqv6rAVUBVv1VAqur/gACAAAAAAALAAD/1QOrAysAAwAHAAsADwATABcAGwAfACMAJwArAAABESERBSEVIRMVIzUhFSM1JRUjNSEVIzUlFSM1IxUjNSEVIzUhFSM1IRUjNQOr/KoDAP1WAqpWVv1WVgNWVv1WVgIAqlZVAgBVAQBW/VZWASv+qgFWVqoBqlVVVVWrVVVVVatWVlZWVlZWVlZWAAALAAD/1QOrAysAAwAHAAsADwATABcAGwAfACMAJwArAAATESERJSE1IQM1MxUhNTMVBTUzFSE1MxUFNTMVMzUzFSE1MxUhNTMVITUzFVUDVv0AAqr9VlZWAqpW/KpWAqpW/gCqVlX+AFX/AFYCqlYB1QFW/qpWqv5WVVVVVatVVVVVq1ZWVlZWVlZWVlYAAAADAAD/2gMxAvQADwAXACAAABcRITIWFRQGBxUeARUUBiMDFTMyNjU0IwMVMzI2NTQmI+kBGoGNV0NTZpmFgFA6Q4VIZEBJSEIlAxljV0BhEwIKZk5sfwKbxDcyW/682Ts1MjcAAgAA/90DDAL1AAMAEQAAFzUlFQMQIyIZATMRFDMyNREz9QIWGfjuU6OcVCI1BTUBlP7uAQgBiP58wrwBigAAAAMAAAAAA4EC+QAiADAAUwAAJQcjBiIvASYnJj4BFhcVHgEXMxYyPwE+AiYnJiczFgYHBhMyHgEUDgEjISImNDYzATIXFhcWDgEmJzUuAS8BJiIPAQ4CFhcWFyMmNjc2PwE2MgKQAwI8mUQEeg0CEx4XAgQvLAE2ey8EJDAOFBsOEm8lAiMljAoQCgoQCv1IDxUVDwHoAQJ5DAETHRcCBC0qAzV4LQQkLg4UGg4RbiQCIiQ/BTuXJAIaHAFAeA8XAxIPASg/FxYUAQ4wOTgYDQcxci8xAWcKEBQQChUeFQE4AUB4DhcDEg4BKD4XAhUUAQ4vOjkXDQcxci8xGQIaAAADAAAAAALAAtYAAwAHAAsAAAEXAycBFSE1ExUhNQIrKoAqARX/AID/AALECP2ACAKRKir9gCoqAAMAAAAAA4ADQQATABkAHwAAEyEyHgEVERQOASMhIi4BNRE0PgEFIQERNCYBIQERFBagAoAaLBoaLBr9gBosGhosApr9jQKTE/1zAnP9bRMDQBosGv2AGiwaGiwaAoAaLBpA/W0Ccw0T/UACk/2NDRMAAAAAAgAA/8ADwQNAAB8ALAAAJS8BPgE1NCcmJyYiBwYHBhQXFhcWMzI2NxYfARYyNjQlIi4BND4BMh4BFA4BA6rWCBwdMC9QU8FSUS8wMC9RUmE0YisEAtcVPiz940JwQUFwg3BBQXA/1wYrYjRhUlEvMDAvUVLBU1AvMB0cBQPWFiw+wUFwg3BBQXCDcEEAAAAAAwAA/+IDnQMWABQAKQBGAAABIgcGBwYUFxYXFjI3Njc2NCcmJyYDIicmJyY0NzY3NjIXFhcWFAcGBwYTJiIPAScmIgYUHwEHBhQWMj8BFxYyNjQvATc2NAIEcF9dNjg4Nl1f319dNjg4Nl1fb2RWUzEzMzFTVshVVDEyMjFUVVUHFQiVlgcWDwiVlQgPFQiWlQgVDwiVlQgDFTg2XV/eYFw3ODg3XGDeX102OPz2MzFTVshWUzEyMjFTVshWUzEzAisHB5aWBw8VCJWWBxYPCJaWCA8WB5aVCBUAAAMAAP//A4EDAQAQACsANQAAATIeARQOASInJicmNDc2NzYTNycPARcyFhUGDwEGBwYWFxY3JwYHBi4BNzQTMjY0JiIGFBYzAgBnsmdnss9aVzM0NDNXWlVMEFsFCggJAQg0BgECExEtMAgUDQUHBQFEEhoaIxkZEgMAZ7LOsmc0M1da0FpXMzT91/gCDA4BDQgNGKcUDRQcAQRaCCEMBQEHBAcBPhkjGhojGQABAAAAAANEAjkAAgAAJQEhAgD+vQKGxwFyAAAAAQAAAAADTALgAEkAAAE2NCYrASIPAQ4BJi8BJisBNz4BMzIXNyYjIgYPASMiDwEGFjMXAwYWFzMyNxMzFxYPAQYUFjsBMj8BPgEWHwEWOwEyNjQ1JyY3A0kCBQNIBAN6AwYEAT8DBagJBysjHBUOHRpNVA8JYQcBCwEEA2BZAQQDRAcBWodFAgS0AgUDSAQDewIHBAFBAwVABARgAgQCDgIHBAKSAgEEAY4ELyooBUMGRk0yBjQDBgH+UgMFAQYBsYsFBMsCBwQDkwIBBAGPBQUFAscFAwAAAQAA/9oD5ALmAAUAAAUBNwUBFwFg/qZPAQICNFglATNa5QJiUQAAAAEAAAAAA3EC5gALAAAlCQEnCQEHCQEXCQEDbv7xARFU/u/+8FUBD/7vVQERAQ9uAREBD1b+8AESVf7v/vFVAQ/+7wAAAAASAN4AAQAAAAAAAAATAAAAAQAAAAAAAQAMABMAAQAAAAAAAgAHAB8AAQAAAAAAAwAMACYAAQAAAAAABAAMADIAAQAAAAAABQALAD4AAQAAAAAABgAMAEkAAQAAAAAACgArAFUAAQAAAAAACwATAIAAAwABBAkAAAAmAJMAAwABBAkAAQAYALkAAwABBAkAAgAOANEAAwABBAkAAwAYAN8AAwABBAkABAAYAPcAAwABBAkABQAWAQ8AAwABBAkABgAYASUAAwABBAkACgBWAT0AAwABBAkACwAmAZNDcmVhdGVkIGJ5IGljb25mb250c3ByZWFkLXNoZWV0UmVndWxhcnNwcmVhZC1zaGVldHNwcmVhZC1zaGVldFZlcnNpb24gMS4wc3ByZWFkLXNoZWV0R2VuZXJhdGVkIGJ5IHN2ZzJ0dGYgZnJvbSBGb250ZWxsbyBwcm9qZWN0Lmh0dHA6Ly9mb250ZWxsby5jb20AQwByAGUAYQB0AGUAZAAgAGIAeQAgAGkAYwBvAG4AZgBvAG4AdABzAHAAcgBlAGEAZAAtAHMAaABlAGUAdABSAGUAZwB1AGwAYQByAHMAcAByAGUAYQBkAC0AcwBoAGUAZQB0AHMAcAByAGUAYQBkAC0AcwBoAGUAZQB0AFYAZQByAHMAaQBvAG4AIAAxAC4AMABzAHAAcgBlAGEAZAAtAHMAaABlAGUAdABHAGUAbgBlAHIAYQB0AGUAZAAgAGIAeQAgAHMAdgBnADIAdAB0AGYAIABmAHIAbwBtACAARgBvAG4AdABlAGwAbABvACAAcAByAG8AagBlAGMAdAAuAGgAdAB0AHAAOgAvAC8AZgBvAG4AdABlAGwAbABvAC4AYwBvAG0AAAIAAAAAAAAACgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEwECAQMBBAEFAQYBBwEIAQkBCgELAQwBDQEOAQ8BEAERARIBEwEUAAlvcGVuLXRyZWUKY2xvc2UtdHJlZQ5kb25ndGFpc2h1anVxdQdzaHVqdXF1CmJhb2JpYW93ZWkKYmFvYmlhb3RvdQRib2xkCXVuZGVybGluZQZzdHJpa2UGaXRhbGljBXNsYXNoBmxvb2tVcAVlcnJvcgRpbmZvBnNlbGVjdAhmdW5jdGlvbgdjb25maXJtBmNhbmNlbAAAAAAA"

/***/ }),

/***/ "ca84":
/***/ (function(module, exports, __webpack_require__) {

var uncurryThis = __webpack_require__("e330");
var hasOwn = __webpack_require__("1a2d");
var toIndexedObject = __webpack_require__("fc6a");
var indexOf = __webpack_require__("4d64").indexOf;
var hiddenKeys = __webpack_require__("d012");

var push = uncurryThis([].push);

module.exports = function (object, names) {
  var O = toIndexedObject(object);
  var i = 0;
  var result = [];
  var key;
  for (key in O) !hasOwn(hiddenKeys, key) && hasOwn(O, key) && push(result, key);
  // Don't enum bug & hidden keys
  while (names.length > i) if (hasOwn(O, key = names[i++])) {
    ~indexOf(result, key) || push(result, key);
  }
  return result;
};


/***/ }),

/***/ "ca91":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var ArrayBufferViewCore = __webpack_require__("ebb5");
var $reduce = __webpack_require__("d58f").left;

var aTypedArray = ArrayBufferViewCore.aTypedArray;
var exportTypedArrayMethod = ArrayBufferViewCore.exportTypedArrayMethod;

// `%TypedArray%.prototype.reduce` method
// https://tc39.es/ecma262/#sec-%typedarray%.prototype.reduce
exportTypedArrayMethod('reduce', function reduce(callbackfn /* , initialValue */) {
  var length = arguments.length;
  return $reduce(aTypedArray(this), callbackfn, length, length > 1 ? arguments[1] : undefined);
});


/***/ }),

/***/ "caad":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var $ = __webpack_require__("23e7");
var $includes = __webpack_require__("4d64").includes;
var addToUnscopables = __webpack_require__("44d2");

// `Array.prototype.includes` method
// https://tc39.es/ecma262/#sec-array.prototype.includes
$({ target: 'Array', proto: true }, {
  includes: function includes(el /* , fromIndex = 0 */) {
    return $includes(this, el, arguments.length > 1 ? arguments[1] : undefined);
  }
});

// https://tc39.es/ecma262/#sec-array.prototype-@@unscopables
addToUnscopables('includes');


/***/ }),

/***/ "cb29":
/***/ (function(module, exports, __webpack_require__) {

var $ = __webpack_require__("23e7");
var fill = __webpack_require__("81d5");
var addToUnscopables = __webpack_require__("44d2");

// `Array.prototype.fill` method
// https://tc39.es/ecma262/#sec-array.prototype.fill
$({ target: 'Array', proto: true }, {
  fill: fill
});

// https://tc39.es/ecma262/#sec-array.prototype-@@unscopables
addToUnscopables('fill');


/***/ }),

/***/ "cc12":
/***/ (function(module, exports, __webpack_require__) {

var global = __webpack_require__("da84");
var isObject = __webpack_require__("861d");

var document = global.document;
// typeof document.createElement is 'object' in old IE
var EXISTS = isObject(document) && isObject(document.createElement);

module.exports = function (it) {
  return EXISTS ? document.createElement(it) : {};
};


/***/ }),

/***/ "cc71":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var $ = __webpack_require__("23e7");
var createHTML = __webpack_require__("857a");
var forcedStringHTMLMethod = __webpack_require__("af03");

// `String.prototype.bold` method
// https://tc39.es/ecma262/#sec-string.prototype.bold
$({ target: 'String', proto: true, forced: forcedStringHTMLMethod('bold') }, {
  bold: function bold() {
    return createHTML(this, 'b', '', '');
  }
});


/***/ }),

/***/ "cca6":
/***/ (function(module, exports, __webpack_require__) {

var $ = __webpack_require__("23e7");
var assign = __webpack_require__("60da");

// `Object.assign` method
// https://tc39.es/ecma262/#sec-object.assign
// eslint-disable-next-line es/no-object-assign -- required for testing
$({ target: 'Object', stat: true, forced: Object.assign !== assign }, {
  assign: assign
});


/***/ }),

/***/ "cd26":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var ArrayBufferViewCore = __webpack_require__("ebb5");

var aTypedArray = ArrayBufferViewCore.aTypedArray;
var exportTypedArrayMethod = ArrayBufferViewCore.exportTypedArrayMethod;
var floor = Math.floor;

// `%TypedArray%.prototype.reverse` method
// https://tc39.es/ecma262/#sec-%typedarray%.prototype.reverse
exportTypedArrayMethod('reverse', function reverse() {
  var that = this;
  var length = aTypedArray(that).length;
  var middle = floor(length / 2);
  var index = 0;
  var value;
  while (index < middle) {
    value = that[index];
    that[index++] = that[--length];
    that[length] = value;
  } return that;
});


/***/ }),

/***/ "cdf9":
/***/ (function(module, exports, __webpack_require__) {

var anObject = __webpack_require__("825a");
var isObject = __webpack_require__("861d");
var newPromiseCapability = __webpack_require__("f069");

module.exports = function (C, x) {
  anObject(C);
  if (isObject(x) && x.constructor === C) return x;
  var promiseCapability = newPromiseCapability.f(C);
  var resolve = promiseCapability.resolve;
  resolve(x);
  return promiseCapability.promise;
};


/***/ }),

/***/ "ce4e":
/***/ (function(module, exports, __webpack_require__) {

var global = __webpack_require__("da84");

// eslint-disable-next-line es/no-object-defineproperty -- safe
var defineProperty = Object.defineProperty;

module.exports = function (key, value) {
  try {
    defineProperty(global, key, { value: value, configurable: true, writable: true });
  } catch (error) {
    global[key] = value;
  } return value;
};


/***/ }),

/***/ "cfc3":
/***/ (function(module, exports, __webpack_require__) {

var createTypedArrayConstructor = __webpack_require__("74e8");

// `Float32Array` constructor
// https://tc39.es/ecma262/#sec-typedarray-objects
createTypedArrayConstructor('Float32', function (init) {
  return function Float32Array(data, byteOffset, length) {
    return init(this, data, byteOffset, length);
  };
});


/***/ }),

/***/ "d012":
/***/ (function(module, exports) {

module.exports = {};


/***/ }),

/***/ "d039":
/***/ (function(module, exports) {

module.exports = function (exec) {
  try {
    return !!exec();
  } catch (error) {
    return true;
  }
};


/***/ }),

/***/ "d066":
/***/ (function(module, exports, __webpack_require__) {

var global = __webpack_require__("da84");
var isCallable = __webpack_require__("1626");

var aFunction = function (argument) {
  return isCallable(argument) ? argument : undefined;
};

module.exports = function (namespace, method) {
  return arguments.length < 2 ? aFunction(global[namespace]) : global[namespace] && global[namespace][method];
};


/***/ }),

/***/ "d139":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var ArrayBufferViewCore = __webpack_require__("ebb5");
var $find = __webpack_require__("b727").find;

var aTypedArray = ArrayBufferViewCore.aTypedArray;
var exportTypedArrayMethod = ArrayBufferViewCore.exportTypedArrayMethod;

// `%TypedArray%.prototype.find` method
// https://tc39.es/ecma262/#sec-%typedarray%.prototype.find
exportTypedArrayMethod('find', function find(predicate /* , thisArg */) {
  return $find(aTypedArray(this), predicate, arguments.length > 1 ? arguments[1] : undefined);
});


/***/ }),

/***/ "d1c2":
/***/ (function(module, exports, __webpack_require__) {

// style-loader: Adds some css to the DOM by adding a <style> tag

// load the styles
var content = __webpack_require__("6c29");
if(content.__esModule) content = content.default;
if(typeof content === 'string') content = [[module.i, content, '']];
if(content.locals) module.exports = content.locals;
// add the styles to the DOM
var add = __webpack_require__("499e").default
var update = add("dee6c386", content, true, {"sourceMap":false,"shadowMode":false});

/***/ }),

/***/ "d1e7":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var $propertyIsEnumerable = {}.propertyIsEnumerable;
// eslint-disable-next-line es/no-object-getownpropertydescriptor -- safe
var getOwnPropertyDescriptor = Object.getOwnPropertyDescriptor;

// Nashorn ~ JDK8 bug
var NASHORN_BUG = getOwnPropertyDescriptor && !$propertyIsEnumerable.call({ 1: 2 }, 1);

// `Object.prototype.propertyIsEnumerable` method implementation
// https://tc39.es/ecma262/#sec-object.prototype.propertyisenumerable
exports.f = NASHORN_BUG ? function propertyIsEnumerable(V) {
  var descriptor = getOwnPropertyDescriptor(this, V);
  return !!descriptor && descriptor.enumerable;
} : $propertyIsEnumerable;


/***/ }),

/***/ "d28b":
/***/ (function(module, exports, __webpack_require__) {

var defineWellKnownSymbol = __webpack_require__("746f");

// `Symbol.iterator` well-known symbol
// https://tc39.es/ecma262/#sec-symbol.iterator
defineWellKnownSymbol('iterator');


/***/ }),

/***/ "d2bb":
/***/ (function(module, exports, __webpack_require__) {

/* eslint-disable no-proto -- safe */
var uncurryThis = __webpack_require__("e330");
var anObject = __webpack_require__("825a");
var aPossiblePrototype = __webpack_require__("3bbe");

// `Object.setPrototypeOf` method
// https://tc39.es/ecma262/#sec-object.setprototypeof
// Works with __proto__ only. Old v8 can't work with null proto objects.
// eslint-disable-next-line es/no-object-setprototypeof -- safe
module.exports = Object.setPrototypeOf || ('__proto__' in {} ? function () {
  var CORRECT_SETTER = false;
  var test = {};
  var setter;
  try {
    // eslint-disable-next-line es/no-object-getownpropertydescriptor -- safe
    setter = uncurryThis(Object.getOwnPropertyDescriptor(Object.prototype, '__proto__').set);
    setter(test, []);
    CORRECT_SETTER = test instanceof Array;
  } catch (error) { /* empty */ }
  return function setPrototypeOf(O, proto) {
    anObject(O);
    aPossiblePrototype(proto);
    if (CORRECT_SETTER) setter(O, proto);
    else O.__proto__ = proto;
    return O;
  };
}() : undefined);


/***/ }),

/***/ "d3b7":
/***/ (function(module, exports, __webpack_require__) {

var TO_STRING_TAG_SUPPORT = __webpack_require__("00ee");
var redefine = __webpack_require__("6eeb");
var toString = __webpack_require__("b041");

// `Object.prototype.toString` method
// https://tc39.es/ecma262/#sec-object.prototype.tostring
if (!TO_STRING_TAG_SUPPORT) {
  redefine(Object.prototype, 'toString', toString, { unsafe: true });
}


/***/ }),

/***/ "d44e":
/***/ (function(module, exports, __webpack_require__) {

var defineProperty = __webpack_require__("9bf2").f;
var hasOwn = __webpack_require__("1a2d");
var wellKnownSymbol = __webpack_require__("b622");

var TO_STRING_TAG = wellKnownSymbol('toStringTag');

module.exports = function (it, TAG, STATIC) {
  if (it && !hasOwn(it = STATIC ? it : it.prototype, TO_STRING_TAG)) {
    defineProperty(it, TO_STRING_TAG, { configurable: true, value: TAG });
  }
};


/***/ }),

/***/ "d4c3":
/***/ (function(module, exports, __webpack_require__) {

var userAgent = __webpack_require__("342f");
var global = __webpack_require__("da84");

module.exports = /ipad|iphone|ipod/i.test(userAgent) && global.Pebble !== undefined;


/***/ }),

/***/ "d58f":
/***/ (function(module, exports, __webpack_require__) {

var global = __webpack_require__("da84");
var aCallable = __webpack_require__("59ed");
var toObject = __webpack_require__("7b0b");
var IndexedObject = __webpack_require__("44ad");
var lengthOfArrayLike = __webpack_require__("07fa");

var TypeError = global.TypeError;

// `Array.prototype.{ reduce, reduceRight }` methods implementation
var createMethod = function (IS_RIGHT) {
  return function (that, callbackfn, argumentsLength, memo) {
    aCallable(callbackfn);
    var O = toObject(that);
    var self = IndexedObject(O);
    var length = lengthOfArrayLike(O);
    var index = IS_RIGHT ? length - 1 : 0;
    var i = IS_RIGHT ? -1 : 1;
    if (argumentsLength < 2) while (true) {
      if (index in self) {
        memo = self[index];
        index += i;
        break;
      }
      index += i;
      if (IS_RIGHT ? index < 0 : length <= index) {
        throw TypeError('Reduce of empty array with no initial value');
      }
    }
    for (;IS_RIGHT ? index >= 0 : length > index; index += i) if (index in self) {
      memo = callbackfn(memo, self[index], index, O);
    }
    return memo;
  };
};

module.exports = {
  // `Array.prototype.reduce` method
  // https://tc39.es/ecma262/#sec-array.prototype.reduce
  left: createMethod(false),
  // `Array.prototype.reduceRight` method
  // https://tc39.es/ecma262/#sec-array.prototype.reduceright
  right: createMethod(true)
};


/***/ }),

/***/ "d5d6":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var ArrayBufferViewCore = __webpack_require__("ebb5");
var $forEach = __webpack_require__("b727").forEach;

var aTypedArray = ArrayBufferViewCore.aTypedArray;
var exportTypedArrayMethod = ArrayBufferViewCore.exportTypedArrayMethod;

// `%TypedArray%.prototype.forEach` method
// https://tc39.es/ecma262/#sec-%typedarray%.prototype.foreach
exportTypedArrayMethod('forEach', function forEach(callbackfn /* , thisArg */) {
  $forEach(aTypedArray(this), callbackfn, arguments.length > 1 ? arguments[1] : undefined);
});


/***/ }),

/***/ "d784":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

// TODO: Remove from `core-js@4` since it's moved to entry points
__webpack_require__("ac1f");
var uncurryThis = __webpack_require__("e330");
var redefine = __webpack_require__("6eeb");
var regexpExec = __webpack_require__("9263");
var fails = __webpack_require__("d039");
var wellKnownSymbol = __webpack_require__("b622");
var createNonEnumerableProperty = __webpack_require__("9112");

var SPECIES = wellKnownSymbol('species');
var RegExpPrototype = RegExp.prototype;

module.exports = function (KEY, exec, FORCED, SHAM) {
  var SYMBOL = wellKnownSymbol(KEY);

  var DELEGATES_TO_SYMBOL = !fails(function () {
    // String methods call symbol-named RegEp methods
    var O = {};
    O[SYMBOL] = function () { return 7; };
    return ''[KEY](O) != 7;
  });

  var DELEGATES_TO_EXEC = DELEGATES_TO_SYMBOL && !fails(function () {
    // Symbol-named RegExp methods call .exec
    var execCalled = false;
    var re = /a/;

    if (KEY === 'split') {
      // We can't use real regex here since it causes deoptimization
      // and serious performance degradation in V8
      // https://github.com/zloirock/core-js/issues/306
      re = {};
      // RegExp[@@split] doesn't call the regex's exec method, but first creates
      // a new one. We need to return the patched regex when creating the new one.
      re.constructor = {};
      re.constructor[SPECIES] = function () { return re; };
      re.flags = '';
      re[SYMBOL] = /./[SYMBOL];
    }

    re.exec = function () { execCalled = true; return null; };

    re[SYMBOL]('');
    return !execCalled;
  });

  if (
    !DELEGATES_TO_SYMBOL ||
    !DELEGATES_TO_EXEC ||
    FORCED
  ) {
    var uncurriedNativeRegExpMethod = uncurryThis(/./[SYMBOL]);
    var methods = exec(SYMBOL, ''[KEY], function (nativeMethod, regexp, str, arg2, forceStringMethod) {
      var uncurriedNativeMethod = uncurryThis(nativeMethod);
      var $exec = regexp.exec;
      if ($exec === regexpExec || $exec === RegExpPrototype.exec) {
        if (DELEGATES_TO_SYMBOL && !forceStringMethod) {
          // The native String method already delegates to @@method (this
          // polyfilled function), leasing to infinite recursion.
          // We avoid it by directly calling the native @@method method.
          return { done: true, value: uncurriedNativeRegExpMethod(regexp, str, arg2) };
        }
        return { done: true, value: uncurriedNativeMethod(str, regexp, arg2) };
      }
      return { done: false };
    });

    redefine(String.prototype, KEY, methods[0]);
    redefine(RegExpPrototype, SYMBOL, methods[1]);
  }

  if (SHAM) createNonEnumerableProperty(RegExpPrototype[SYMBOL], 'sham', true);
};


/***/ }),

/***/ "d7f8":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var _node_modules_vue_style_loader_index_js_ref_9_oneOf_1_0_node_modules_css_loader_dist_cjs_js_ref_9_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_9_oneOf_1_2_node_modules_postcss_loader_src_index_js_ref_9_oneOf_1_3_node_modules_sass_loader_dist_cjs_js_ref_9_oneOf_1_4_node_modules_cache_loader_dist_cjs_js_ref_1_0_node_modules_vue_loader_lib_index_js_vue_loader_options_filterSeletor_vue_vue_type_style_index_0_id_4adca92e_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("4f2f");
/* harmony import */ var _node_modules_vue_style_loader_index_js_ref_9_oneOf_1_0_node_modules_css_loader_dist_cjs_js_ref_9_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_9_oneOf_1_2_node_modules_postcss_loader_src_index_js_ref_9_oneOf_1_3_node_modules_sass_loader_dist_cjs_js_ref_9_oneOf_1_4_node_modules_cache_loader_dist_cjs_js_ref_1_0_node_modules_vue_loader_lib_index_js_vue_loader_options_filterSeletor_vue_vue_type_style_index_0_id_4adca92e_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_node_modules_vue_style_loader_index_js_ref_9_oneOf_1_0_node_modules_css_loader_dist_cjs_js_ref_9_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_9_oneOf_1_2_node_modules_postcss_loader_src_index_js_ref_9_oneOf_1_3_node_modules_sass_loader_dist_cjs_js_ref_9_oneOf_1_4_node_modules_cache_loader_dist_cjs_js_ref_1_0_node_modules_vue_loader_lib_index_js_vue_loader_options_filterSeletor_vue_vue_type_style_index_0_id_4adca92e_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0__);
/* unused harmony reexport * */


/***/ }),

/***/ "d7fe":
/***/ (function(module, exports, __webpack_require__) {

// style-loader: Adds some css to the DOM by adding a <style> tag

// load the styles
var content = __webpack_require__("0195");
if(content.__esModule) content = content.default;
if(typeof content === 'string') content = [[module.i, content, '']];
if(content.locals) module.exports = content.locals;
// add the styles to the DOM
var add = __webpack_require__("499e").default
var update = add("c25abeae", content, true, {"sourceMap":false,"shadowMode":false});

/***/ }),

/***/ "d81d":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var $ = __webpack_require__("23e7");
var $map = __webpack_require__("b727").map;
var arrayMethodHasSpeciesSupport = __webpack_require__("1dde");

var HAS_SPECIES_SUPPORT = arrayMethodHasSpeciesSupport('map');

// `Array.prototype.map` method
// https://tc39.es/ecma262/#sec-array.prototype.map
// with adding support of @@species
$({ target: 'Array', proto: true, forced: !HAS_SPECIES_SUPPORT }, {
  map: function map(callbackfn /* , thisArg */) {
    return $map(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);
  }
});


/***/ }),

/***/ "d86b":
/***/ (function(module, exports, __webpack_require__) {

// FF26- bug: ArrayBuffers are non-extensible, but Object.isExtensible does not report it
var fails = __webpack_require__("d039");

module.exports = fails(function () {
  if (typeof ArrayBuffer == 'function') {
    var buffer = new ArrayBuffer(8);
    // eslint-disable-next-line es/no-object-isextensible, es/no-object-defineproperty -- safe
    if (Object.isExtensible(buffer)) Object.defineProperty(buffer, 'a', { value: 8 });
  }
});


/***/ }),

/***/ "d998":
/***/ (function(module, exports, __webpack_require__) {

var UA = __webpack_require__("342f");

module.exports = /MSIE|Trident/.test(UA);


/***/ }),

/***/ "d9b5":
/***/ (function(module, exports, __webpack_require__) {

var global = __webpack_require__("da84");
var getBuiltIn = __webpack_require__("d066");
var isCallable = __webpack_require__("1626");
var isPrototypeOf = __webpack_require__("3a9b");
var USE_SYMBOL_AS_UID = __webpack_require__("fdbf");

var Object = global.Object;

module.exports = USE_SYMBOL_AS_UID ? function (it) {
  return typeof it == 'symbol';
} : function (it) {
  var $Symbol = getBuiltIn('Symbol');
  return isCallable($Symbol) && isPrototypeOf($Symbol.prototype, Object(it));
};


/***/ }),

/***/ "da84":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {var check = function (it) {
  return it && it.Math == Math && it;
};

// https://github.com/zloirock/core-js/issues/86#issuecomment-115759028
module.exports =
  // eslint-disable-next-line es/no-global-this -- safe
  check(typeof globalThis == 'object' && globalThis) ||
  check(typeof window == 'object' && window) ||
  // eslint-disable-next-line no-restricted-globals -- safe
  check(typeof self == 'object' && self) ||
  check(typeof global == 'object' && global) ||
  // eslint-disable-next-line no-new-func -- fallback
  (function () { return this; })() || Function('return this')();

/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("c8ba")))

/***/ }),

/***/ "dbb4":
/***/ (function(module, exports, __webpack_require__) {

var $ = __webpack_require__("23e7");
var DESCRIPTORS = __webpack_require__("83ab");
var ownKeys = __webpack_require__("56ef");
var toIndexedObject = __webpack_require__("fc6a");
var getOwnPropertyDescriptorModule = __webpack_require__("06cf");
var createProperty = __webpack_require__("8418");

// `Object.getOwnPropertyDescriptors` method
// https://tc39.es/ecma262/#sec-object.getownpropertydescriptors
$({ target: 'Object', stat: true, sham: !DESCRIPTORS }, {
  getOwnPropertyDescriptors: function getOwnPropertyDescriptors(object) {
    var O = toIndexedObject(object);
    var getOwnPropertyDescriptor = getOwnPropertyDescriptorModule.f;
    var keys = ownKeys(O);
    var result = {};
    var index = 0;
    var key, descriptor;
    while (keys.length > index) {
      descriptor = getOwnPropertyDescriptor(O, key = keys[index++]);
      if (descriptor !== undefined) createProperty(result, key, descriptor);
    }
    return result;
  }
});


/***/ }),

/***/ "dc4a":
/***/ (function(module, exports, __webpack_require__) {

var aCallable = __webpack_require__("59ed");

// `GetMethod` abstract operation
// https://tc39.es/ecma262/#sec-getmethod
module.exports = function (V, P) {
  var func = V[P];
  return func == null ? undefined : aCallable(func);
};


/***/ }),

/***/ "dd40":
/***/ (function(module, exports) {

module.exports = function(originalModule) {
	if (!originalModule.webpackPolyfill) {
		var module = Object.create(originalModule);
		// module.parent = undefined by default
		if (!module.children) module.children = [];
		Object.defineProperty(module, "loaded", {
			enumerable: true,
			get: function() {
				return module.l;
			}
		});
		Object.defineProperty(module, "id", {
			enumerable: true,
			get: function() {
				return module.i;
			}
		});
		Object.defineProperty(module, "exports", {
			enumerable: true
		});
		module.webpackPolyfill = 1;
	}
	return module;
};


/***/ }),

/***/ "ddb0":
/***/ (function(module, exports, __webpack_require__) {

var global = __webpack_require__("da84");
var DOMIterables = __webpack_require__("fdbc");
var DOMTokenListPrototype = __webpack_require__("785a");
var ArrayIteratorMethods = __webpack_require__("e260");
var createNonEnumerableProperty = __webpack_require__("9112");
var wellKnownSymbol = __webpack_require__("b622");

var ITERATOR = wellKnownSymbol('iterator');
var TO_STRING_TAG = wellKnownSymbol('toStringTag');
var ArrayValues = ArrayIteratorMethods.values;

var handlePrototype = function (CollectionPrototype, COLLECTION_NAME) {
  if (CollectionPrototype) {
    // some Chrome versions have non-configurable methods on DOMTokenList
    if (CollectionPrototype[ITERATOR] !== ArrayValues) try {
      createNonEnumerableProperty(CollectionPrototype, ITERATOR, ArrayValues);
    } catch (error) {
      CollectionPrototype[ITERATOR] = ArrayValues;
    }
    if (!CollectionPrototype[TO_STRING_TAG]) {
      createNonEnumerableProperty(CollectionPrototype, TO_STRING_TAG, COLLECTION_NAME);
    }
    if (DOMIterables[COLLECTION_NAME]) for (var METHOD_NAME in ArrayIteratorMethods) {
      // some Chrome versions have non-configurable methods on DOMTokenList
      if (CollectionPrototype[METHOD_NAME] !== ArrayIteratorMethods[METHOD_NAME]) try {
        createNonEnumerableProperty(CollectionPrototype, METHOD_NAME, ArrayIteratorMethods[METHOD_NAME]);
      } catch (error) {
        CollectionPrototype[METHOD_NAME] = ArrayIteratorMethods[METHOD_NAME];
      }
    }
  }
};

for (var COLLECTION_NAME in DOMIterables) {
  handlePrototype(global[COLLECTION_NAME] && global[COLLECTION_NAME].prototype, COLLECTION_NAME);
}

handlePrototype(DOMTokenListPrototype, 'DOMTokenList');


/***/ }),

/***/ "ddd4":
/***/ (function(module, exports) {

module.exports = "data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0nMS4wJyBlbmNvZGluZz0nVVRGLTgnPz48IURPQ1RZUEUgc3ZnIFBVQkxJQyAiLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4iICJodHRwOi8vd3d3LnczLm9yZy9HcmFwaGljcy9TVkcvMS4xL0RURC9zdmcxMS5kdGQiPgo8c3ZnIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIgogIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdmVyc2lvbj0iMS4xIiB4PSIwIiB5PSIwIiB3aWR0aD0iMjYycHgiIGhlaWdodD0iNzJweCIgdmlld0JveD0iMCAwIDI2MiA3MiIgcHJlc2VydmVBc3BlY3RSYXRpbz0ibm9uZSI+CiAgPGcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwLDApIj4KICAgIDxwYXRoIGZpbGw9IiMwMDAwMDAiIGZpbGwtcnVsZT0iZXZlbm9kZCIgZD0iTTExLjU2NTYzOTEsNC40MzQzNjA4OCBMOSw3IEwxNiw3IEwxNiwwIEwxMy4wNDE4NDI0LDIuOTU4MTU3NTggQzExLjU5MzY3ODcsMS43MzYzNTk1OSA5LjcyMjYwNzc1LDEgNy42Nzk1NTA4MywxIEM0LjIyMTI2MjU4LDEgMS4yNTU3NTU5OSwzLjEwOTg0OTA4IDAsNiBMMiw3IEMyLjkzNjU4Nzc1LDQuNjA5NzQ0MDYgNS4xMjk0MzY5NywzLjA4MDExMjI5IDcuNjc5NTUwODMsMyBDOS4xNDg4MTI0NywzLjA1Mjg3NDcgMTAuNDk5NDc4MywzLjU3ODYyMDUzIDExLjU2NTYzOTEsNC40MzQzNjA4OCBaIiB0cmFuc2Zvcm09Im1hdHJpeCgtMSAwIDAgMSAxNyA1KSIvPgogIDwvZz4KICA8ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE4LDApIj4KICAgIDxwYXRoIGZpbGw9IiMwMDAwMDAiIGZpbGwtcnVsZT0iZXZlbm9kZCIgZD0iTTExLjU2NTYzOTEsNC40MzQzNjA4OCBMOSw3IEwxNiw3IEwxNiwwIEwxMy4wNDE4NDI0LDIuOTU4MTU3NTggQzExLjU5MzY3ODcsMS43MzYzNTk1OSA5LjcyMjYwNzc1LDEgNy42Nzk1NTA4MywxIEM0LjIyMTI2MjU4LDEgMS4yNTU3NTU5OSwzLjEwOTg0OTA4IDAsNiBMMiw3IEMyLjkzNjU4Nzc1LDQuNjA5NzQ0MDYgNS4xMjk0MzY5NywzLjA4MDExMjI5IDcuNjc5NTUwODMsMyBDOS4xNDg4MTI0NywzLjA1Mjg3NDcgMTAuNDk5NDc4MywzLjU3ODYyMDUzIDExLjU2NTYzOTEsNC40MzQzNjA4OCBaIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxIDUpIi8+CiAgPC9nPgogIDxnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMzYsMCkiPgogICAgPHBhdGggZmlsbD0iIzAwMDAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNMTMsMTQgTDMsMTQgTDMsMTEgTDAsMTEgTDAsNi4wMDU5MTkwNSBDMCw0Ljg5ODA4MDU1IDAuODk0NTEzNzU2LDQgMS45OTQwNjAyOCw0IEwxNC4wMDU5Mzk3LDQgQzE1LjEwNzIyODgsNCAxNiw0Ljg4NjU1NDg0IDE2LDYuMDA1OTE5MDUgTDE2LDExIEwxMywxMSBMMTMsMTQgWiBNNSw5IEwxMSw5IEwxMSwxMiBMNSwxMiBMNSw5IFogTTMsMCBMMTMsMCBMMTMsMyBMMywzIEwzLDAgWiBNMTIsNiBMMTQsNiBMMTQsOCBMMTIsOCBMMTIsNiBaIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxIDIpIi8+CiAgPC9nPgogIDxnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNTQsMCkiPgogICAgPHBhdGggZmlsbD0iIzAwMDAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNOSwwIEwxLDAgQzAuNDUsMCAwLDAuNDUgMCwxIEwwLDQgQzAsNC41NSAwLjQ1LDUgMSw1IEw5LDUgQzkuNTUsNSAxMCw0LjU1IDEwLDQgTDEwLDMgTDExLDMgTDExLDYgTDQsNiBMNCwxNCBMNiwxNCBMNiw4IEwxMyw4IEwxMywyIEwxMCwyIEwxMCwxIEMxMCwwLjQ1IDkuNTUsMCA5LDAgWiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMyAyKSIvPgogIDwvZz4KICA8ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHRyYW5zZm9ybT0idHJhbnNsYXRlKDcyLDApIj4KICAgIDxwYXRoIGZpbGw9IiMwMDAwMDAiIGZpbGwtcnVsZT0iZXZlbm9kZCIgZD0iTTAuMjcsMS41NSBMNS40Myw2LjcgTDMsMTIgTDUuNSwxMiBMNy4xNCw4LjQyIEwxMS43MywxMyBMMTMsMTEuNzMgTDEuNTUsMC4yNyBMMC4yNywxLjU1IEwwLjI3LDEuNTUgWiBNMy44MiwwIEw1LjgyLDIgTDcuNTgsMiBMNy4wMywzLjIxIEw4Ljc0LDQuOTIgTDEwLjA4LDIgTDE0LDIgTDE0LDAgTDMuODIsMCBMMy44MiwwIFoiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDIgMykiLz4KICA8L2c+CiAgPGcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg5MCwwKSI+CiAgICA8cGF0aCBmaWxsPSIjMDAwMDAwIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik05LDMuNSBDOSwxLjU3IDcuNDMsMCA1LjUsMCBMMS43NzYzNTY4NGUtMTUsMCBMMS43NzYzNTY4NGUtMTUsMTIgTDYuMjUsMTIgQzguMDQsMTIgOS41LDEwLjU0IDkuNSw4Ljc1IEM5LjUsNy40NSA4LjczLDYuMzQgNy42Myw1LjgyIEM4LjQ2LDUuMjQgOSw0LjM4IDksMy41IFogTTUsMiBDNS44Mjk5OTk5MiwyIDYuNSwyLjY3IDYuNSwzLjUgQzYuNSw0LjMzIDUuODI5OTk5OTIsNSA1LDUgTDMsNSBMMywyIEw1LDIgWiBNMywxMCBMMyw3IEw1LjUsNyBDNi4zMjk5OTk5Miw3IDcsNy42NyA3LDguNSBDNyw5LjMzIDYuMzI5OTk5OTIsMTAgNS41LDEwIEwzLDEwIFoiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDQgMykiLz4KICA8L2c+CiAgPGcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMDgsMCkiPgogICAgPHBvbHlnb24gZmlsbD0iIzAwMDAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBwb2ludHM9IjQgMCA0IDIgNi41OCAyIDIuOTIgMTAgMCAxMCAwIDEyIDggMTIgOCAxMCA1LjQyIDEwIDkuMDggMiAxMiAyIDEyIDAiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDMgMykiLz4KICA8L2c+CiAgPGcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMjYsMCkiPgogICAgPHBhdGggZmlsbD0iIzAwMDAwMCIgZD0iTTYsMTIgQzguNzYsMTIgMTEsOS43NiAxMSw3IEwxMSwwIEw5LDAgTDksNyBDOSw4Ljc1MDI5OTE2IDcuNDk5MTI4MDcsMTAgNiwxMCBDNC41MDA4NzE5MywxMCAzLDguNzU4Mzc0ODYgMyw3IEwzLDAgTDEsMCBMMSw3IEMxLDkuNzYgMy4yNCwxMiA2LDEyIFogTTAsMTMgTDAsMTUgTDEyLDE1IEwxMiwxMyBMMCwxMyBaIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzIDMpIi8+CiAgPC9nPgogIDxnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTQ0LDApIj4KICAgIDxwYXRoIGZpbGw9IiMwMTAxMDEiIGZpbGwtcnVsZT0iZXZlbm9kZCIgZD0iTTIuODg3NSwzLjA2IEMyLjg4NzUsMi42MDI1IDIuOTg1LDIuMTg2MjUgMy4xODM3NSwxLjgwNzUgQzMuMzgyNSwxLjQyODc1IDMuNjYsMS4xMDYyNSA0LjAyLDAuODQgQzQuMzgsMC41NzM3NSA0LjgwMzc1LDAuMzY3NSA1LjI5ODc1LDAuMjIxMjUgQzUuNzkzNzUsMC4wNzUgNi4zMzM3NSwwIDYuOTI2MjUsMCBDNy41MzM3NSwwIDguMDg1LDAuMDgyNSA4LjU4LDAuMjUxMjUgQzkuMDc1LDAuNDIgOS40OTg3NSwwLjY1MjUgOS44NTEyNSwwLjk1NjI1IEMxMC4yMDM3NSwxLjI1NjI1IDEwLjQ3Mzc1LDEuNjEyNSAxMC42NjUsMi4wMjg3NSBDMTAuODU2MjUsMi40NDEyNSAxMC45NSwyLjg5NSAxMC45NSwzLjM4NjI1IEw4LjY5MjUsMy4zODYyNSBDOC42OTI1LDMuMTU3NSA4LjY1NSwyLjk0Mzc1IDguNTgzNzUsMi43NDg3NSBDOC41MTI1LDIuNTUgOC40LDIuMzgxMjUgOC4yNSwyLjI0MjUgQzguMSwyLjEwMzc1IDcuOTEyNSwxLjk5MTI1IDcuNjg3NSwxLjkxNjI1IEM3LjQ2MjUsMS44Mzc1IDcuMTk2MjUsMS44IDYuODg4NzUsMS44IEM2LjU5MjUsMS44IDYuMzM3NSwxLjgzMzc1IDYuMTE2MjUsMS44OTc1IEM1Ljg5ODc1LDEuOTYxMjUgNS43MTg3NSwyLjA1MTI1IDUuNTc2MjUsMi4xNjc1IEM1LjQzMzc1LDIuMjgzNzUgNS4zMjUsMi40MTg3NSA1LjI1Mzc1LDIuNTcyNSBDNS4xODI1LDIuNzI2MjUgNS4xNDUsMi44OTUgNS4xNDUsMy4wNjc1IEM1LjE0NSwzLjQyNzUgNS4zMjg3NSwzLjczMTI1IDUuNjk2MjUsMy45NzUgQzUuNzE3ODAyMDMsMy45ODkwODA2NiA1LjczOTQyMDEyLDQuMDAzMTE3MjggNS43NjExODM1Nyw0LjAxNzMzMzE1IEM2LjAyMzQyOTIzLDQuMTg4NjMxODUgNi41LDQuNSA3LDUgTDQsNSBDNCw1IDMuMjEzNzUsNC4zNzYyNSAzLjE3NjI1LDQuMzA4NzUgQzIuOTg1LDMuOTUyNSAyLjg4NzUsMy41MzYyNSAyLjg4NzUsMy4wNiBaIE0xNCw2IEwwLDYgTDAsOCBMNy4yMTg3NSw4IEM3LjM1Mzc1LDguMDUyNSA3LjUxODc1LDguMTA1IDcuNjMxMjUsOC4xNTM3NSBDNy45MDg3NSw4LjI3NzUgOC4xMjYyNSw4LjQwODc1IDguMjgzNzUsOC41MzYyNSBDOC40NDEyNSw4LjY2NzUgOC41NDYyNSw4LjgxIDguNjAyNSw4Ljk2IEM4LjY1ODc1LDkuMTEzNzUgOC42ODUsOS4yODYyNSA4LjY4NSw5LjQ3Mzc1IEM4LjY4NSw5LjY1IDguNjUxMjUsOS44MTUgOC41ODM3NSw5Ljk2NSBDOC41MTYyNSwxMC4xMTg3NSA4LjQxMTI1LDEwLjI1IDguMjcyNSwxMC4zNTg3NSBDOC4xMzM3NSwxMC40Njc1IDcuOTUzNzUsMTAuNTUzNzUgNy43NCwxMC42MTc1IEM3LjUyMjUsMTAuNjgxMjUgNy4yNzEyNSwxMC43MTEyNSA2Ljk3ODc1LDEwLjcxMTI1IEM2LjY1MjUsMTAuNzExMjUgNi4zNTYyNSwxMC42Nzc1IDYuMDksMTAuNjEzNzUgQzUuODIzNzUsMTAuNTUgNS41OTg3NSwxMC40NDUgNS40MTEyNSwxMC4zMDI1IEM1LjIyMzc1LDEwLjE2IDUuMDc3NSw5Ljk3MjUgNC45NzI1LDkuNzQzNzUgQzQuODY3NSw5LjUxNSA0Ljc4MTI1LDkuMTcgNC43ODEyNSw5IEwyLjU1LDkgQzIuNTUsOS4yNTI1IDIuNjEsOS42ODc1IDIuNzI2MjUsMTAuMDI1IEMyLjg0MjUsMTAuMzYyNSAzLjAwNzUsMTAuNjY2MjUgMy4yMTM3NSwxMC45MzI1IEMzLjQyLDExLjE5ODc1IDMuNjY3NSwxMS40Mjc1IDMuOTQ4NzUsMTEuNjIyNSBDNC4yMywxMS44MTc1IDQuNTMzNzUsMTEuOTgyNSA0Ljg2Mzc1LDEyLjExIEM1LjE5Mzc1LDEyLjI0MTI1IDUuNTM1LDEyLjMzODc1IDUuODk4NzUsMTIuMzk4NzUgQzYuMjU4NzUsMTIuNDYyNSA2LjYyMjUsMTIuNDkyNSA2Ljk4MjUsMTIuNDkyNSBDNy41ODI1LDEyLjQ5MjUgOC4xMywxMi40MjUgOC42MTc1LDEyLjI4NjI1IEM5LjEwNSwxMi4xNDc1IDkuNTI1LDExLjk0ODc1IDkuODcsMTEuNjkzNzUgQzEwLjIxNSwxMS40MzUgMTAuNDgxMjUsMTEuMTIgMTAuNjcyNSwxMC43NDEyNSBDMTAuODYzNzUsMTAuMzYyNSAxMC45NTM3NSw5LjkzNSAxMC45NTM3NSw5LjQ1NSBDMTAuOTUzNzUsOS4wMDUgMTAuODc1LDguNiAxMC43MjEyNSw4LjI0Mzc1IEMxMC42ODM3NSw4LjE1NzUgMTAuNjQyNSw4LjA3NSAxMC41OTM3NSw3Ljk5MjUgTDE0LDggTDE0LDYgWiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMiAzKSIvPgogIDwvZz4KICA8ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE2MiwwKSI+CiAgICA8cGF0aCBmaWxsPSIjMDAwMDAwIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik03LDAgTDUsMCBMMC41LDEyIEwyLjUsMTIgTDMuNjIsOSBMOC4zNyw5IEw5LjQ5LDEyIEwxMS40OSwxMiBMNywwIEw3LDAgWiBNNC4zOCw3IEw2LDIuNjcgTDcuNjIsNyBMNC4zOCw3IEw0LjM4LDcgWiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMyAxKSIvPgogIDwvZz4KICA8ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE4MCwwKSI+CiAgICA8ZyBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICA8cGF0aCBmaWxsPSIjMDAwMDAwIiBkPSJNMTQuNSw4Ljg3IEMxNC41LDguODcgMTMsMTAuNDkgMTMsMTEuNDkgQzEzLDEyLjMyIDEzLjY3LDEyLjk5IDE0LjUsMTIuOTkgQzE1LjMzLDEyLjk5IDE2LDEyLjMyIDE2LDExLjQ5IEMxNiwxMC41IDE0LjUsOC44NyAxNC41LDguODcgTDE0LjUsOC44NyBaIE0xMi43MSw2Ljc5IEw1LjkxLDAgTDQuODUsMS4wNiBMNi40NCwyLjY1IEwyLjI5LDYuNzkgQzEuOSw3LjE4IDEuOSw3LjgxIDIuMjksOC4yIEw2Ljc5LDEyLjcgQzYuOTksMTIuOSA3LjI0LDEzIDcuNSwxMyBDNy43NiwxMyA4LjAxLDEyLjkgOC4yMSwxMi43MSBMMTIuNzEsOC4yMSBDMTMuMSw3LjgyIDEzLjEsNy4xOCAxMi43MSw2Ljc5IEwxMi43MSw2Ljc5IFogTTQuMjEsNyBMNy41LDMuNzEgTDEwLjc5LDcgTDQuMjEsNyBMNC4yMSw3IFoiLz4KICAgIDwvZz4KICA8L2c+CiAgPGcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxOTgsMCkiPgogICAgPHBhdGggZmlsbD0iIzAwMDAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNMyw2IEwxLDYgTDEsMiBMOCwyIEw4LDQgTDMsNCBMMyw2IFogTTEwLDQgTDEwLDIgTDE3LDIgTDE3LDYgTDE1LDYgTDE1LDQgTDEwLDQgWiBNMTAsMTQgTDE1LDE0IEwxNSwxMiBMMTcsMTIgTDE3LDE2IEwxMCwxNiBMMTAsMTQgWiBNMSwxMiBMMywxMiBMMywxNCBMOCwxNCBMOCwxNiBMMSwxNiBMMSwxMiBaIE0xLDggTDUsOCBMNSw2IEw4LDkgTDUsMTIgTDUsMTAgTDEsMTAgTDEsOCBaIE0xMCw5IEwxMyw2IEwxMyw4IEwxNyw4IEwxNywxMCBMMTMsMTAgTDEzLDEyIEwxMCw5IFoiLz4KICA8L2c+CiAgPGcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyMTYsMCkiPgogICAgPHBhdGggZmlsbD0iIzAwMDAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNMCwxNCBMMTAsMTQgTDEwLDEyIEwwLDEyIEwwLDE0IFogTTEwLDQgTDAsNCBMMCw2IEwxMCw2IEwxMCw0IFogTTAsMCBMMCwyIEwxNCwyIEwxNCwwIEwwLDAgWiBNMCwxMCBMMTQsMTAgTDE0LDggTDAsOCBMMCwxMCBaIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyIDIpIi8+CiAgPC9nPgogIDxnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMjM0LDApIj4KICAgIDxwYXRoIGZpbGw9IiMwMDAwMDAiIGZpbGwtcnVsZT0iZXZlbm9kZCIgZD0iTTIsMTIgTDIsMTQgTDEyLDE0IEwxMiwxMiBMMiwxMiBaIE0yLDQgTDIsNiBMMTIsNiBMMTIsNCBMMiw0IFogTTAsMTAgTDE0LDEwIEwxNCw4IEwwLDggTDAsMTAgWiBNMCwwIEwwLDIgTDE0LDIgTDE0LDAgTDAsMCBaIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyIDIpIi8+CiAgPC9nPgogIDxnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMCwxOCkiPgogICAgPHBhdGggZmlsbD0iIzAwMDAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNNCwxNCBMMTQsMTQgTDE0LDEyIEw0LDEyIEw0LDE0IFogTTAsMTAgTDE0LDEwIEwxNCw4IEwwLDggTDAsMTAgWiBNMCwwIEwwLDIgTDE0LDIgTDE0LDAgTDAsMCBaIE00LDYgTDE0LDYgTDE0LDQgTDQsNCBMNCw2IFoiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDIgMikiLz4KICA8L2c+CiAgPGcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxOCwxOCkiPgogICAgPHBhdGggZmlsbD0iIzAwMDAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNMCwwIEwwLDIgTDEyLDIgTDEyLDAgTDAsMCBMMCwwIFogTTIuNSw3IEw1LDcgTDUsMTQgTDcsMTQgTDcsNyBMOS41LDcgTDYsMy41IEwyLjUsNyBMMi41LDcgWiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMyAyKSIvPgogIDwvZz4KICA8ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHRyYW5zZm9ybT0idHJhbnNsYXRlKDM2LDE4KSI+CiAgICA8cGF0aCBmaWxsPSIjMDAwMDAwIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik05LjUsMyBMNywzIEw3LDAgTDUsMCBMNSwzIEwyLjUsMyBMNiw2LjUgTDkuNSwzIEw5LjUsMyBaIE0wLDggTDAsMTAgTDEyLDEwIEwxMiw4IEwwLDggTDAsOCBaIE0yLjUsMTUgTDUsMTUgTDUsMTggTDcsMTggTDcsMTUgTDkuNSwxNSBMNiwxMS41IEwyLjUsMTUgTDIuNSwxNSBaIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzKSIvPgogIDwvZz4KICA8ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHRyYW5zZm9ybT0idHJhbnNsYXRlKDU0LDE4KSI+CiAgICA8cGF0aCBmaWxsPSIjMDAwMDAwIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik05LjUsNyBMNyw3IEw3LDAgTDUsMCBMNSw3IEwyLjUsNyBMNiwxMC41IEw5LjUsNyBMOS41LDcgWiBNMCwxMiBMMCwxNCBMMTIsMTQgTDEyLDEyIEwwLDEyIEwwLDEyIFoiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDMgMikiLz4KICA8L2c+CiAgPGcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg3MiwxOCkiPgogICAgPHBhdGggZmlsbD0iIzAwMDAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNMTQsMCBMMCwwIEwwLDIgTDE0LDIgTDE0LDAgWiBNMCwxMiBMNCwxMiBMNCwxMCBMMCwxMCBMMCwxMiBaIE0xMS41LDUgTDAsNSBMMCw3IEwxMS43NSw3IEMxMi41OCw3IDEzLjI1LDcuNjcgMTMuMjUsOC41IEMxMy4yNSw5LjMzIDEyLjU4LDEwIDExLjc1LDEwIEw5LDEwIEw5LDggTDYsMTEgTDksMTQgTDksMTIgTDExLjUsMTIgQzEzLjQzLDEyIDE1LDEwLjQzIDE1LDguNSBDMTUsNi41NyAxMy40Myw1IDExLjUsNSBaIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyIDMpIi8+CiAgPC9nPgogIDxnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoOTAsMTgpIj4KICAgIDxwYXRoIGZpbGw9IiMwMDAwMDAiIGZpbGwtcnVsZT0iZXZlbm9kZCIgZD0iTTAsMCBMMCwxIEw2LDcgTDYsMTIgTDgsMTEgTDgsNyBMMTQsMSBMMTQsMCBMMCwwIFogTTQsMyBMMTAsMyBMNyw2IEw0LDMgWiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMiAzKSIvPgogIDwvZz4KICA8ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEwOCwxOCkiPgogICAgPHBvbHlnb24gZmlsbD0iIzAwMDAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBwb2ludHM9IjEwIDAgMCAwIDAgMS44IDUuNSA3IDAgMTIuMiAwIDE0IDEwIDE0IDEwIDEyIDMuMSAxMiA4IDcgMy4xIDIgMTAgMiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNCAyKSIvPgogIDwvZz4KICA8ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEyNiwxOCkiPgogICAgPHBvbHlnb24gZmlsbD0iIzAwMDAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBwb2ludHM9IjAgMCA0IDQgOCAwIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg1IDcpIi8+CiAgPC9nPgogIDxnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTQ0LDE4KSI+CiAgICA8cG9seWdvbiBmaWxsPSIjMDAwMDAwIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIHBvaW50cz0iLTIgMiAyIDYgNiAyIiB0cmFuc2Zvcm09InJvdGF0ZSgtOTAgOCAzKSIvPgogIDwvZz4KICA8ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE2MiwxOCkiPgogICAgPHBhdGggZmlsbD0iIzAwMDAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNMS45LDQgQzEuOSwyLjg0IDIuODQsMS45IDQsMS45IEw4LDEuOSBMOCwwIEw0LDAgQzEuNzksMCAwLDEuNzkgMCw0IEMwLDYuMjEgMS43OSw4IDQsOCBMOCw4IEw4LDYuMSBMNCw2LjEgQzIuODQsNi4xIDEuOSw1LjE2IDEuOSw0IEwxLjksNCBaIE0xNCwwIEwxMCwwIEwxMCwxLjkgTDE0LDEuOSBDMTUuMTYsMS45IDE2LjEsMi44NCAxNi4xLDQgQzE2LjEsNS4xNiAxNS4xNiw2LjEgMTQsNi4xIEwxMCw2LjEgTDEwLDggTDE0LDggQzE2LjIxLDggMTgsNi4yMSAxOCw0IEMxOCwxLjc5IDE2LjIxLDAgMTQsMCBMMTQsMCBaIE02LDUgTDEyLDUgTDEyLDMgTDYsMyBMNiw1IEw2LDUgWiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMCA1KSIvPgogIDwvZz4KICA8ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE4MCwxOCkiPgogICAgPHBhdGggZmlsbD0iIzAwMDAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNMTUsMCBDMTUuNTUsMCAxNiwwLjQ1IDE2LDEgTDE2LDE1IEMxNiwxNS41NSAxNS41NSwxNiAxNSwxNiBMMSwxNiBDMC40NSwxNiAwLDE1LjU1IDAsMTUgTDAsMSBDMCwwLjQ1IDAuNDUsMCAxLDAgTDE1LDAgWiBNMiwyIEwyLDE0IEwxNCwxNCBMMTQsMiBMMiwyIFogTTYsMTIgTDQsMTIgTDQsNyBMNiw3IEw2LDEyIEw2LDEyIFogTTksMTIgTDcsMTIgTDcsNCBMOSw0IEw5LDEyIEw5LDEyIFogTTEyLDEyIEwxMCwxMiBMMTAsOCBMMTIsOCBMMTIsMTIgTDEyLDEyIFoiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEgMSkiLz4KICA8L2c+CiAgPGcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxOTgsMTgpIj4KICAgIDxnIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgIDxwYXRoIHN0cm9rZT0iIzAwMDAwMCIgZD0iTTEuNSAzLjVIMTYuNVYxNS41SDEuNXoiLz4KICAgICAgPHBhdGggZmlsbD0iIzAwMDAwMCIgZD0iTTYgOEg3VjE1SDZ6Ii8+CiAgICAgIDxwYXRoIGZpbGw9IiNEOEQ4RDgiIGQ9Ik0yIDRIMTZWN0gyeiIvPgogICAgICA8cGF0aCBmaWxsPSIjMDAwMDAwIiBkPSJNMiA3SDE2VjhIMnpNMiAxMUgxNlYxMkgyeiIvPgogICAgPC9nPgogIDwvZz4KICA8ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHRyYW5zZm9ybT0idHJhbnNsYXRlKDIxNiwxOCkiPgogICAgPHBhdGggZmlsbD0iIzAwMDAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNMiwwLjUgQzEuMTcsMC41IDAuNSwxLjE3IDAuNSwyIEMwLjUsMi44MyAxLjE3LDMuNSAyLDMuNSBDMi44MywzLjUgMy41LDIuODMgMy41LDIgQzMuNSwxLjE3IDIuODMsMC41IDIsMC41IEwyLDAuNSBaIE0xMiwwLjUgQzExLjE3LDAuNSAxMC41LDEuMTcgMTAuNSwyIEMxMC41LDIuODMgMTEuMTcsMy41IDEyLDMuNSBDMTIuODMsMy41IDEzLjUsMi44MyAxMy41LDIgQzEzLjUsMS4xNyAxMi44MywwLjUgMTIsMC41IEwxMiwwLjUgWiBNNywwLjUgQzYuMTcsMC41IDUuNSwxLjE3IDUuNSwyIEM1LjUsMi44MyA2LjE3LDMuNSA3LDMuNSBDNy44MywzLjUgOC41LDIuODMgOC41LDIgQzguNSwxLjE3IDcuODMsMC41IDcsMC41IEw3LDAuNSBaIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyIDcpIi8+CiAgPC9nPgogIDxnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMjM0LDE4KSI+CiAgICA8cGF0aCBmaWxsPSIjMDAwMDAwIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik02LDQgTDYsMCBMNCwwIEw0LDQgTDAsNCBMMCw2IEw0LDYgTDQsMTAgTDYsMTAgTDYsNiBMMTAsNiBMMTAsNCBMNiw0IFoiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDQgNCkiLz4KICA8L2c+CiAgPGcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwLDM2KSI+CiAgICA8cGF0aCBmaWxsPSIjMDAwMDAwIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0wLDAgTDAsMTQgTDE0LDE0IEwxNCwwIEwwLDAgTDAsMCBaIE02LDEyIEwyLDEyIEwyLDggTDYsOCBMNiwxMiBMNiwxMiBaIE02LDYgTDIsNiBMMiwyIEw2LDIgTDYsNiBMNiw2IFogTTEyLDEyIEw4LDEyIEw4LDggTDEyLDggTDEyLDEyIEwxMiwxMiBaIE0xMiw2IEw4LDYgTDgsMiBMMTIsMiBMMTIsNiBMMTIsNiBaIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyIDIpIi8+CiAgPC9nPgogIDxnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTgsMzYpIj4KICAgIDxnIGZpbGw9IiMwMDAwMDAiIGZpbGwtcnVsZT0iZXZlbm9kZCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMiAyKSI+CiAgICAgIDxwYXRoIGQ9Ik0wLDE0IEwyLDE0IEwyLDEyIEwwLDEyIEwwLDE0IEwwLDE0IFogTTIsMyBMMCwzIEwwLDUgTDIsNSBMMiwzIEwyLDMgWiBNMywxNCBMNSwxNCBMNSwxMiBMMywxMiBMMywxNCBMMywxNCBaIE0xMSwwIEw5LDAgTDksMiBMMTEsMiBMMTEsMCBMMTEsMCBaIE0yLDAgTDAsMCBMMCwyIEwyLDIgTDIsMCBMMiwwIFogTTUsMCBMMywwIEwzLDIgTDUsMiBMNSwwIEw1LDAgWiBNMCwxMSBMMiwxMSBMMiw5IEwwLDkgTDAsMTEgTDAsMTEgWiBNOSwxNCBMMTEsMTQgTDExLDEyIEw5LDEyIEw5LDE0IEw5LDE0IFogTTEyLDAgTDEyLDIgTDE0LDIgTDE0LDAgTDEyLDAgTDEyLDAgWiBNMTIsNSBMMTQsNSBMMTQsMyBMMTIsMyBMMTIsNSBMMTIsNSBaIE0xMiwxNCBMMTQsMTQgTDE0LDEyIEwxMiwxMiBMMTIsMTQgTDEyLDE0IFogTTEyLDExIEwxNCwxMSBMMTQsOSBMMTIsOSBMMTIsMTEgTDEyLDExIFoiIG9wYWNpdHk9Ii41NCIvPgogICAgICA8cG9seWdvbiBwb2ludHM9IjggMCA2IDAgNiA2IDAgNiAwIDggNiA4IDYgMTQgOCAxNCA4IDggMTQgOCAxNCA2IDggNiIvPgogICAgPC9nPgogIDwvZz4KICA8ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHRyYW5zZm9ybT0idHJhbnNsYXRlKDM2LDM2KSI+CiAgICA8ZyBmaWxsPSIjMDAwMDAwIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDIgMikiPgogICAgICA8cGF0aCBkPSJNNiwxNCBMOCwxNCBMOCwxMiBMNiwxMiBMNiwxNCBMNiwxNCBaIE0zLDIgTDUsMiBMNSwwIEwzLDAgTDMsMiBMMywyIFogTTYsMTEgTDgsMTEgTDgsOSBMNiw5IEw2LDExIEw2LDExIFogTTMsMTQgTDUsMTQgTDUsMTIgTDMsMTIgTDMsMTQgTDMsMTQgWiBNMCw1IEwyLDUgTDIsMyBMMCwzIEwwLDUgTDAsNSBaIE0wLDE0IEwyLDE0IEwyLDEyIEwwLDEyIEwwLDE0IEwwLDE0IFogTTAsMiBMMiwyIEwyLDAgTDAsMCBMMCwyIEwwLDIgWiBNMCwxMSBMMiwxMSBMMiw5IEwwLDkgTDAsMTEgTDAsMTEgWiBNMTIsMTEgTDE0LDExIEwxNCw5IEwxMiw5IEwxMiwxMSBMMTIsMTEgWiBNMTIsMTQgTDE0LDE0IEwxNCwxMiBMMTIsMTIgTDEyLDE0IEwxMiwxNCBaIE0xMiw1IEwxNCw1IEwxNCwzIEwxMiwzIEwxMiw1IEwxMiw1IFogTTEyLDAgTDEyLDIgTDE0LDIgTDE0LDAgTDEyLDAgTDEyLDAgWiBNNiwyIEw4LDIgTDgsMCBMNiwwIEw2LDIgTDYsMiBaIE05LDIgTDExLDIgTDExLDAgTDksMCBMOSwyIEw5LDIgWiBNNiw1IEw4LDUgTDgsMyBMNiwzIEw2LDUgTDYsNSBaIE05LDE0IEwxMSwxNCBMMTEsMTIgTDksMTIgTDksMTQgTDksMTQgWiIgb3BhY2l0eT0iLjU0Ii8+CiAgICAgIDxwb2x5Z29uIHBvaW50cz0iMCA4IDE0IDggMTQgNiAwIDYiLz4KICAgIDwvZz4KICA8L2c+CiAgPGcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg1NCwzNikiPgogICAgPGcgZmlsbD0iIzAwMDAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyIDIpIj4KICAgICAgPHBhdGggZD0iTTMsMTQgTDUsMTQgTDUsMTIgTDMsMTIgTDMsMTQgTDMsMTQgWiBNMCw1IEwyLDUgTDIsMyBMMCwzIEwwLDUgTDAsNSBaIE0wLDIgTDIsMiBMMiwwIEwwLDAgTDAsMiBMMCwyIFogTTMsOCBMNSw4IEw1LDYgTDMsNiBMMyw4IEwzLDggWiBNMywyIEw1LDIgTDUsMCBMMywwIEwzLDIgTDMsMiBaIE0wLDE0IEwyLDE0IEwyLDEyIEwwLDEyIEwwLDE0IEwwLDE0IFogTTAsOCBMMiw4IEwyLDYgTDAsNiBMMCw4IEwwLDggWiBNMCwxMSBMMiwxMSBMMiw5IEwwLDkgTDAsMTEgTDAsMTEgWiBNMTIsMCBMMTIsMiBMMTQsMiBMMTQsMCBMMTIsMCBMMTIsMCBaIE0xMiw4IEwxNCw4IEwxNCw2IEwxMiw2IEwxMiw4IEwxMiw4IFogTTEyLDE0IEwxNCwxNCBMMTQsMTIgTDEyLDEyIEwxMiwxNCBMMTIsMTQgWiBNMTIsNSBMMTQsNSBMMTQsMyBMMTIsMyBMMTIsNSBMMTIsNSBaIE0xMiwxMSBMMTQsMTEgTDE0LDkgTDEyLDkgTDEyLDExIEwxMiwxMSBaIE05LDE0IEwxMSwxNCBMMTEsMTIgTDksMTIgTDksMTQgTDksMTQgWiBNOSw4IEwxMSw4IEwxMSw2IEw5LDYgTDksOCBMOSw4IFogTTksMiBMMTEsMiBMMTEsMCBMOSwwIEw5LDIgTDksMiBaIiBvcGFjaXR5PSIuNTQiLz4KICAgICAgPHBvbHlnb24gcG9pbnRzPSI2IDE0IDggMTQgOCAwIDYgMCIvPgogICAgPC9nPgogIDwvZz4KICA8ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHRyYW5zZm9ybT0idHJhbnNsYXRlKDcyLDM2KSI+CiAgICA8ZyBmaWxsPSIjMDAwMDAwIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDIgMikiPgogICAgICA8cGF0aCBkPSJNOCwzIEw2LDMgTDYsNSBMOCw1IEw4LDMgTDgsMyBaIE0xMSw2IEw5LDYgTDksOCBMMTEsOCBMMTEsNiBMMTEsNiBaIE04LDYgTDYsNiBMNiw4IEw4LDggTDgsNiBMOCw2IFogTTgsOSBMNiw5IEw2LDExIEw4LDExIEw4LDkgTDgsOSBaIE01LDYgTDMsNiBMMyw4IEw1LDggTDUsNiBMNSw2IFoiIG9wYWNpdHk9Ii41NCIvPgogICAgICA8cGF0aCBkPSJNMCwwIEwxNCwwIEwxNCwxNCBMMCwxNCBMMCwwIFogTTEyLDEyIEwxMiwyIEwyLDIgTDIsMTIgTDEyLDEyIFoiLz4KICAgIDwvZz4KICA8L2c+CiAgPGcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg5MCwzNikiPgogICAgPGcgZmlsbD0iIzAwMDAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyIDIpIj4KICAgICAgPHBhdGggZD0iTTYsOCBMOCw4IEw4LDYgTDYsNiBMNiw4IEw2LDggWiBNNiw1IEw4LDUgTDgsMyBMNiwzIEw2LDUgTDYsNSBaIE02LDExIEw4LDExIEw4LDkgTDYsOSBMNiwxMSBMNiwxMSBaIE02LDE0IEw4LDE0IEw4LDEyIEw2LDEyIEw2LDE0IEw2LDE0IFogTTMsMTQgTDUsMTQgTDUsMTIgTDMsMTIgTDMsMTQgTDMsMTQgWiBNMywyIEw1LDIgTDUsMCBMMywwIEwzLDIgTDMsMiBaIE0zLDggTDUsOCBMNSw2IEwzLDYgTDMsOCBMMyw4IFogTTEyLDE0IEwxNCwxNCBMMTQsMTIgTDEyLDEyIEwxMiwxNCBMMTIsMTQgWiBNMTIsOCBMMTQsOCBMMTQsNiBMMTIsNiBMMTIsOCBMMTIsOCBaIE0xMiwxMSBMMTQsMTEgTDE0LDkgTDEyLDkgTDEyLDExIEwxMiwxMSBaIE0xMiw1IEwxNCw1IEwxNCwzIEwxMiwzIEwxMiw1IEwxMiw1IFogTTYsMiBMOCwyIEw4LDAgTDYsMCBMNiwyIEw2LDIgWiBNMTIsMCBMMTIsMiBMMTQsMiBMMTQsMCBMMTIsMCBMMTIsMCBaIE05LDE0IEwxMSwxNCBMMTEsMTIgTDksMTIgTDksMTQgTDksMTQgWiBNOSw4IEwxMSw4IEwxMSw2IEw5LDYgTDksOCBMOSw4IFogTTksMiBMMTEsMiBMMTEsMCBMOSwwIEw5LDIgTDksMiBaIiBvcGFjaXR5PSIuNTQiLz4KICAgICAgPHBvbHlnb24gcG9pbnRzPSIwIDE0IDIgMTQgMiAwIDAgMCIvPgogICAgPC9nPgogIDwvZz4KICA8ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEwOCwzNikiPgogICAgPGcgZmlsbD0iIzAwMDAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyIDIpIj4KICAgICAgPHBhdGggZD0iTTMsOCBMNSw4IEw1LDYgTDMsNiBMMyw4IEwzLDggWiBNMCwxNCBMMiwxNCBMMiwxMiBMMCwxMiBMMCwxNCBMMCwxNCBaIE02LDE0IEw4LDE0IEw4LDEyIEw2LDEyIEw2LDE0IEw2LDE0IFogTTYsMTEgTDgsMTEgTDgsOSBMNiw5IEw2LDExIEw2LDExIFogTTMsMTQgTDUsMTQgTDUsMTIgTDMsMTIgTDMsMTQgTDMsMTQgWiBNMCwxMSBMMiwxMSBMMiw5IEwwLDkgTDAsMTEgTDAsMTEgWiBNNiw4IEw4LDggTDgsNiBMNiw2IEw2LDggTDYsOCBaIE0wLDUgTDIsNSBMMiwzIEwwLDMgTDAsNSBMMCw1IFogTTAsOCBMMiw4IEwyLDYgTDAsNiBMMCw4IEwwLDggWiBNMTIsOCBMMTQsOCBMMTQsNiBMMTIsNiBMMTIsOCBMMTIsOCBaIE0xMiwxMSBMMTQsMTEgTDE0LDkgTDEyLDkgTDEyLDExIEwxMiwxMSBaIE0xMiw1IEwxNCw1IEwxNCwzIEwxMiwzIEwxMiw1IEwxMiw1IFogTTYsNSBMOCw1IEw4LDMgTDYsMyBMNiw1IEw2LDUgWiBNOSwxNCBMMTEsMTQgTDExLDEyIEw5LDEyIEw5LDE0IEw5LDE0IFogTTksOCBMMTEsOCBMMTEsNiBMOSw2IEw5LDggTDksOCBaIE0xMiwxNCBMMTQsMTQgTDE0LDEyIEwxMiwxMiBMMTIsMTQgTDEyLDE0IFoiIG9wYWNpdHk9Ii41NCIvPgogICAgICA8cG9seWdvbiBwb2ludHM9IjAgMCAwIDIgMTQgMiAxNCAwIi8+CiAgICA8L2c+CiAgPC9nPgogIDxnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTI2LDM2KSI+CiAgICA8ZyBmaWxsPSIjMDAwMDAwIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDIgMikiPgogICAgICA8cGF0aCBkPSJNMCwyIEwyLDIgTDIsMCBMMCwwIEwwLDIgTDAsMiBaIE0zLDIgTDUsMiBMNSwwIEwzLDAgTDMsMiBMMywyIFogTTMsOCBMNSw4IEw1LDYgTDMsNiBMMyw4IEwzLDggWiBNMywxNCBMNSwxNCBMNSwxMiBMMywxMiBMMywxNCBMMywxNCBaIE0wLDUgTDIsNSBMMiwzIEwwLDMgTDAsNSBMMCw1IFogTTAsOCBMMiw4IEwyLDYgTDAsNiBMMCw4IEwwLDggWiBNMCwxNCBMMiwxNCBMMiwxMiBMMCwxMiBMMCwxNCBMMCwxNCBaIE0wLDExIEwyLDExIEwyLDkgTDAsOSBMMCwxMSBMMCwxMSBaIE05LDggTDExLDggTDExLDYgTDksNiBMOSw4IEw5LDggWiBNNiwxNCBMOCwxNCBMOCwxMiBMNiwxMiBMNiwxNCBMNiwxNCBaIE05LDE0IEwxMSwxNCBMMTEsMTIgTDksMTIgTDksMTQgTDksMTQgWiBNNiwyIEw4LDIgTDgsMCBMNiwwIEw2LDIgTDYsMiBaIE05LDIgTDExLDIgTDExLDAgTDksMCBMOSwyIEw5LDIgWiBNNiwxMSBMOCwxMSBMOCw5IEw2LDkgTDYsMTEgTDYsMTEgWiBNNiw1IEw4LDUgTDgsMyBMNiwzIEw2LDUgTDYsNSBaIE02LDggTDgsOCBMOCw2IEw2LDYgTDYsOCBMNiw4IFoiIG9wYWNpdHk9Ii41NCIvPgogICAgICA8cG9seWdvbiBwb2ludHM9IjEyIDAgMTIgMTQgMTQgMTQgMTQgMCIvPgogICAgPC9nPgogIDwvZz4KICA8ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE0NCwzNikiPgogICAgPGcgZmlsbD0iIzAwMDAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyIDIpIj4KICAgICAgPHBhdGggZD0iTTUsMCBMMywwIEwzLDIgTDUsMiBMNSwwIEw1LDAgWiBNOCw2IEw2LDYgTDYsOCBMOCw4IEw4LDYgTDgsNiBaIE04LDkgTDYsOSBMNiwxMSBMOCwxMSBMOCw5IEw4LDkgWiBNMTEsNiBMOSw2IEw5LDggTDExLDggTDExLDYgTDExLDYgWiBNNSw2IEwzLDYgTDMsOCBMNSw4IEw1LDYgTDUsNiBaIE0xMSwwIEw5LDAgTDksMiBMMTEsMiBMMTEsMCBMMTEsMCBaIE04LDMgTDYsMyBMNiw1IEw4LDUgTDgsMyBMOCwzIFogTTgsMCBMNiwwIEw2LDIgTDgsMiBMOCwwIEw4LDAgWiBNMiw5IEwwLDkgTDAsMTEgTDIsMTEgTDIsOSBMMiw5IFogTTEyLDExIEwxNCwxMSBMMTQsOSBMMTIsOSBMMTIsMTEgTDEyLDExIFogTTEyLDUgTDE0LDUgTDE0LDMgTDEyLDMgTDEyLDUgTDEyLDUgWiBNMTIsOCBMMTQsOCBMMTQsNiBMMTIsNiBMMTIsOCBMMTIsOCBaIE0xMiwwIEwxMiwyIEwxNCwyIEwxNCwwIEwxMiwwIEwxMiwwIFogTTIsMCBMMCwwIEwwLDIgTDIsMiBMMiwwIEwyLDAgWiBNMiwzIEwwLDMgTDAsNSBMMiw1IEwyLDMgTDIsMyBaIE0yLDYgTDAsNiBMMCw4IEwyLDggTDIsNiBMMiw2IFoiIG9wYWNpdHk9Ii41NCIvPgogICAgICA8cG9seWdvbiBwb2ludHM9IjAgMTQgMTQgMTQgMTQgMTIgMCAxMiIvPgogICAgPC9nPgogIDwvZz4KICA8ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE2MiwzNikiPgogICAgPHBhdGggZmlsbD0iIzAwMDAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNNiwxNCBMOCwxNCBMOCwxMiBMNiwxMiBMNiwxNCBMNiwxNCBaIE0zLDggTDUsOCBMNSw2IEwzLDYgTDMsOCBMMyw4IFogTTMsMiBMNSwyIEw1LDAgTDMsMCBMMywyIEwzLDIgWiBNNiwxMSBMOCwxMSBMOCw5IEw2LDkgTDYsMTEgTDYsMTEgWiBNMywxNCBMNSwxNCBMNSwxMiBMMywxMiBMMywxNCBMMywxNCBaIE0wLDUgTDIsNSBMMiwzIEwwLDMgTDAsNSBMMCw1IFogTTAsMTQgTDIsMTQgTDIsMTIgTDAsMTIgTDAsMTQgTDAsMTQgWiBNMCwyIEwyLDIgTDIsMCBMMCwwIEwwLDIgTDAsMiBaIE0wLDggTDIsOCBMMiw2IEwwLDYgTDAsOCBMMCw4IFogTTYsOCBMOCw4IEw4LDYgTDYsNiBMNiw4IEw2LDggWiBNMCwxMSBMMiwxMSBMMiw5IEwwLDkgTDAsMTEgTDAsMTEgWiBNMTIsMTEgTDE0LDExIEwxNCw5IEwxMiw5IEwxMiwxMSBMMTIsMTEgWiBNMTIsMTQgTDE0LDE0IEwxNCwxMiBMMTIsMTIgTDEyLDE0IEwxMiwxNCBaIE0xMiw4IEwxNCw4IEwxNCw2IEwxMiw2IEwxMiw4IEwxMiw4IFogTTEyLDUgTDE0LDUgTDE0LDMgTDEyLDMgTDEyLDUgTDEyLDUgWiBNMTIsMCBMMTIsMiBMMTQsMiBMMTQsMCBMMTIsMCBMMTIsMCBaIE02LDIgTDgsMiBMOCwwIEw2LDAgTDYsMiBMNiwyIFogTTksMiBMMTEsMiBMMTEsMCBMOSwwIEw5LDIgTDksMiBaIE02LDUgTDgsNSBMOCwzIEw2LDMgTDYsNSBMNiw1IFogTTksMTQgTDExLDE0IEwxMSwxMiBMOSwxMiBMOSwxNCBMOSwxNCBaIE05LDggTDExLDggTDExLDYgTDksNiBMOSw4IEw5LDggWiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMiAyKSIgb3BhY2l0eT0iLjU0Ii8+CiAgPC9nPgogIDxnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTgwLDM2KSI+CiAgICA8cGF0aCBmaWxsPSIjMDAwMDAwIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik02LjUsMy42MiBMMCwxMC4xMiBMMCwxMyBMMi44OCwxMyBMOS4zOCw2LjUgTDYuNSwzLjYyIFogTTExLjg1LDQuMDIgQzEyLjA1LDMuODIgMTIuMDUsMy41MSAxMS44NSwzLjMxIEw5LjY4LDEuMTQgQzkuNDgsMC45NCA5LjE3LDAuOTQgOC45NywxLjE0IEw3LjYyLDIuNSBMMTAuNSw1LjM4IEwxMS44NSw0LjAyIEwxMS44NSw0LjAyIFoiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDQpIi8+CiAgPC9nPgogIDxnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTk4LDM2KSI+CiAgICA8cGF0aCBmaWxsPSIjMDAwMDAwIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0wLDAgTDE0LDAgTDE0LDIgTDAsMiBMMCwwIFogTTAsNCBMNiw0IEw2LDYgTDAsNiBMMCw0IFogTTAsOCBMMiw4IEwyLDEwIEwwLDEwIEwwLDggWiBNOCw0IEwxNCw0IEwxNCw2IEw4LDYgTDgsNCBaIE00LDggTDYsOCBMNiwxMCBMNCwxMCBMNCw4IFogTTgsOCBMMTAsOCBMMTAsMTAgTDgsMTAgTDgsOCBaIE0xMiw4IEwxNCw4IEwxNCwxMCBMMTIsMTAgTDEyLDggWiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMiA0KSIvPgogIDwvZz4KICA8ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHRyYW5zZm9ybT0idHJhbnNsYXRlKDIxNiwzNikiPgogICAgPHBvbHlnb24gZmlsbD0iIzAwMDAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBwb2ludHM9Ii0yIDIgMiA2IDYgMiIgdHJhbnNmb3JtPSJyb3RhdGUoOTAgMyAxMCkiLz4KICA8L2c+CiAgPGcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyMzQsMzYpIj4KICAgIDxwb2x5Z29uIGZpbGw9IiMwMDAwMDAiIGZpbGwtcnVsZT0iZXZlbm9kZCIgcG9pbnRzPSI3LjUzIDEuNTMgNi40NyAuNDcgNCAyLjk0IDEuNTMgLjQ3IC40NyAxLjUzIDIuOTQgNCAuNDcgNi40NyAxLjUzIDcuNTMgNCA1LjA2IDYuNDcgNy41MyA3LjUzIDYuNDcgNS4wNiA0IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg1IDUpIi8+CiAgPC9nPgogIDxnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMCw1NCkiPgogICAgPHBvbHlnb24gZmlsbD0iIzAwMDAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBwb2ludHM9IjguNDQgLjQ0IDUgMy44OCAxLjU2IC40NCAuNSAxLjUgNSA2IDkuNSAxLjUiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDQgNikiLz4KICA8L2c+CiAgPGcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxOCw1NCkiPgogICAgPHBvbHlnb24gZmlsbD0iIzAwMDAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBwb2ludHM9IjUgMCAuNSA0LjUgMS41NiA1LjU2IDUgMi4xMiA4LjQ0IDUuNTYgOS41IDQuNSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNCA2KSIvPgogIDwvZz4KICA8ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHRyYW5zZm9ybT0idHJhbnNsYXRlKDM2LDU0KSI+CiAgICA8cG9seWdvbiBmaWxsPSIjMDAwMDAwIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIHBvaW50cz0iOC40NCAuNDQgNSAzLjg4IDEuNTYgLjQ0IC41IDEuNSA1IDYgOS41IDEuNSIgdHJhbnNmb3JtPSJyb3RhdGUoOTAgNCA4KSIvPgogIDwvZz4KICA8ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHRyYW5zZm9ybT0idHJhbnNsYXRlKDU0LDU0KSI+CiAgICA8cG9seWdvbiBmaWxsPSIjMDAwMDAwIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIHBvaW50cz0iNSAwIC41IDQuNSAxLjU2IDUuNTYgNSAyLjEyIDguNDQgNS41NiA5LjUgNC41IiB0cmFuc2Zvcm09InJvdGF0ZSg5MCA0IDgpIi8+CiAgPC9nPgogIDxnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNzIsNTQpIj4KICAgIDxwb2x5Z29uIGZpbGw9IiMwMDAwMDAiIGZpbGwtcnVsZT0iZXZlbm9kZCIgcG9pbnRzPSIxMiA1IDMuMTI1IDUgNy4wNiAxLjA2IDYgMCAwIDYgNiAxMiA3LjA2IDEwLjk0IDMuMTI1IDcgMTIgNyIgdHJhbnNmb3JtPSJtYXRyaXgoLTEgMCAwIDEgMTUgMykiLz4KICA8L2c+CiAgPGcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg5MCw1NCkiPgogICAgPHBvbHlnb24gZmlsbD0iIzAwMDAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBwb2ludHM9IjEyIDUgMy4xMjUgNSA3LjA2IDEuMDYgNiAwIDAgNiA2IDEyIDcuMDYgMTAuOTQgMy4xMjUgNyAxMiA3IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzIDMpIi8+CiAgPC9nPgogIDxnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTA4LDU0KSI+CiAgICA8c3ZnIHQ9IjE2NzE2NzQ2MTQ2MzciIGNsYXNzPSJpY29uIiB2aWV3Qm94PSIwIDAgMTAyNCAxMDI0IiB2ZXJzaW9uPSIxLjEiCiAgICAgIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgcC1pZD0iMTQ1NiIgd2lkdGg9IjE2IiBoZWlnaHQ9IjE2Ij4KICAgICAgPHBhdGggZD0iTTEyOCA4OTZoNzY4djY0SDEyOHpNMTI4IDc2OGg3Njh2NjRIMTI4ek0xMjggNjQwaDc2OHY2NEgxMjh6TTEyOCA1MTJoNzY4djY0SDEyOHpNMCA2NGg2NHY4OTZIMHpNOTYwIDY0aDY0djg5NmgtNjR6IiBmaWxsPSIjMDAwIiBwLWlkPSIxNDU3Ij48L3BhdGg+CiAgICAgIDxwYXRoIGQ9Ik00NDAuMiA0NDhsLTEyOC0xMjhoMzk5LjZsLTEyOCAxMjhINzY4bDE5Mi0xOTJMNzY4IDY0SDU4My44bDEyOCAxMjhIMzEyLjJsMTI4LTEyOEgyNTZMNjQgMjU2bDE5MiAxOTJ6IiBmaWxsPSIjMDAwIiBwLWlkPSIxNDU4Ij48L3BhdGg+CiAgICA8L3N2Zz4KICA8L2c+CiAgPGcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMjYsNTQpIj4KICAgIDxzdmcgdD0iMTY3MzU3Nzc3MzMxMiIgY2xhc3M9Imljb24iIHZpZXdCb3g9IjAgMCAxMDI0IDEwMjQiIHZlcnNpb249IjEuMSIKICAgICAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBwLWlkPSIyMzY5IiB3aWR0aD0iMTYiIGhlaWdodD0iMTYiPgogICAgICA8cGF0aCBkPSJNOTYwIDk4MS4zMzMzMzNIMTA2LjY2NjY2N2EyMS4zMzMzMzMgMjEuMzMzMzMzIDAgMCAxIDAtNDIuNjY2NjY2aDg1My4zMzMzMzNhMjEuMzMzMzMzIDIxLjMzMzMzMyAwIDAgMSAwIDQyLjY2NjY2NnogbTAtMjEzLjMzMzMzM0g0OTAuNjY2NjY3YTIxLjMzMzMzMyAyMS4zMzMzMzMgMCAwIDEgMC00Mi42NjY2NjdoNDY5LjMzMzMzM2EyMS4zMzMzMzMgMjEuMzMzMzMzIDAgMCAxIDAgNDIuNjY2NjY3ek0xOTIgNjQwYTIxLjI2NjY2NyAyMS4yNjY2NjcgMCAwIDEtMTUuMDg2NjY3LTYuMjQ2NjY3bC04NS4zMzMzMzMtODUuMzMzMzMzYTIxLjMzMzMzMyAyMS4zMzMzMzMgMCAwIDEgMC0zMC4xNzMzMzNsODUuMzMzMzMzLTg1LjMzMzMzNGEyMS4zMzMzMzMgMjEuMzMzMzMzIDAgMCAxIDMwLjE3MzMzNCAzMC4xNzMzMzRMMTU4LjE2NjY2NyA1MTJIMzIwYTIxLjMzMzMzMyAyMS4zMzMzMzMgMCAwIDEgMCA0Mi42NjY2NjdIMTU4LjE2NjY2N2w0OC45MiA0OC45MTMzMzNBMjEuMzMzMzMzIDIxLjMzMzMzMyAwIDAgMSAxOTIgNjQweiBtNzY4LTg1LjMzMzMzM0g0OTAuNjY2NjY3YTIxLjMzMzMzMyAyMS4zMzMzMzMgMCAwIDEgMC00Mi42NjY2NjdoNDY5LjMzMzMzM2EyMS4zMzMzMzMgMjEuMzMzMzMzIDAgMCAxIDAgNDIuNjY2NjY3eiBtMC0yMTMuMzMzMzM0SDQ5MC42NjY2NjdhMjEuMzMzMzMzIDIxLjMzMzMzMyAwIDAgMSAwLTQyLjY2NjY2Nmg0NjkuMzMzMzMzYTIxLjMzMzMzMyAyMS4zMzMzMzMgMCAwIDEgMCA0Mi42NjY2NjZ6IG0wLTIxMy4zMzMzMzNIMTA2LjY2NjY2N2EyMS4zMzMzMzMgMjEuMzMzMzMzIDAgMCAxIDAtNDIuNjY2NjY3aDg1My4zMzMzMzNhMjEuMzMzMzMzIDIxLjMzMzMzMyAwIDAgMSAwIDQyLjY2NjY2N3oiIGZpbGw9IiMwMDAwMDAiIHAtaWQ9IjIzNzAiPjwvcGF0aD4KICAgIDwvc3ZnPgogIDwvZz4KICA8ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE0NCw1NCkiPgogICAgPHN2ZyB0PSIxNjczNTc3OTI1NjUzIiBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIgogICAgICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjI1NDEiIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiI+CiAgICAgIDxwYXRoIGQ9Ik05NjAgOTgxLjMzMzMzM0gxMDYuNjY2NjY3YTIxLjMzMzMzMyAyMS4zMzMzMzMgMCAwIDEgMC00Mi42NjY2NjZoODUzLjMzMzMzM2EyMS4zMzMzMzMgMjEuMzMzMzMzIDAgMCAxIDAgNDIuNjY2NjY2eiBtMC0yMTMuMzMzMzMzSDQ5MC42NjY2NjdhMjEuMzMzMzMzIDIxLjMzMzMzMyAwIDAgMSAwLTQyLjY2NjY2N2g0NjkuMzMzMzMzYTIxLjMzMzMzMyAyMS4zMzMzMzMgMCAwIDEgMCA0Mi42NjY2Njd6TTIzNC42NjY2NjcgNjQwYTIxLjI2NjY2NyAyMS4yNjY2NjcgMCAwIDAgMTUuMDg2NjY2LTYuMjQ2NjY3bDg1LjMzMzMzNC04NS4zMzMzMzNhMjEuMzMzMzMzIDIxLjMzMzMzMyAwIDAgMCAwLTMwLjE3MzMzM2wtODUuMzMzMzM0LTg1LjMzMzMzNGEyMS4zMzMzMzMgMjEuMzMzMzMzIDAgMCAwLTMwLjE3MzMzMyAzMC4xNzMzMzRMMjY4LjQ5MzMzMyA1MTJIMTA2LjY2NjY2N2EyMS4zMzMzMzMgMjEuMzMzMzMzIDAgMCAwIDAgNDIuNjY2NjY3aDE2MS44MjY2NjZsLTQ4LjkxMzMzMyA0OC45MTMzMzNBMjEuMzMzMzMzIDIxLjMzMzMzMyAwIDAgMCAyMzQuNjY2NjY3IDY0MHogbTcyNS4zMzMzMzMtODUuMzMzMzMzSDQ5MC42NjY2NjdhMjEuMzMzMzMzIDIxLjMzMzMzMyAwIDAgMSAwLTQyLjY2NjY2N2g0NjkuMzMzMzMzYTIxLjMzMzMzMyAyMS4zMzMzMzMgMCAwIDEgMCA0Mi42NjY2Njd6IG0wLTIxMy4zMzMzMzRINDkwLjY2NjY2N2EyMS4zMzMzMzMgMjEuMzMzMzMzIDAgMCAxIDAtNDIuNjY2NjY2aDQ2OS4zMzMzMzNhMjEuMzMzMzMzIDIxLjMzMzMzMyAwIDAgMSAwIDQyLjY2NjY2NnogbTAtMjEzLjMzMzMzM0gxMDYuNjY2NjY3YTIxLjMzMzMzMyAyMS4zMzMzMzMgMCAwIDEgMC00Mi42NjY2NjdoODUzLjMzMzMzM2EyMS4zMzMzMzMgMjEuMzMzMzMzIDAgMCAxIDAgNDIuNjY2NjY3eiIgZmlsbD0iIzAwMDAwMCIgcC1pZD0iMjU0MiI+PC9wYXRoPgogICAgPC9zdmc+CiAgPC9nPgo8L3N2Zz4K"

/***/ }),

/***/ "ddde":
/***/ (function(module, exports, __webpack_require__) {

// Imports
var ___CSS_LOADER_API_IMPORT___ = __webpack_require__("24fb");
exports = ___CSS_LOADER_API_IMPORT___(false);
// Module
exports.push([module.i, ".edit-div{width:100%;height:100%;overflow:auto;word-break:break-all;outline:none;-webkit-user-select:text;-moz-user-select:text;-ms-user-select:text;user-select:text;white-space:pre-wrap;text-align:left;min-width:30px;min-height:13px}.edit-div[contenteditable=true]{user-modify:read-write-plaintext-only}.edit-div[contenteditable=true]:empty:before{content:attr(placeholder);display:block;color:#ccc}", ""]);
// Exports
module.exports = exports;


/***/ }),

/***/ "df75":
/***/ (function(module, exports, __webpack_require__) {

var internalObjectKeys = __webpack_require__("ca84");
var enumBugKeys = __webpack_require__("7839");

// `Object.keys` method
// https://tc39.es/ecma262/#sec-object.keys
// eslint-disable-next-line es/no-object-keys -- safe
module.exports = Object.keys || function keys(O) {
  return internalObjectKeys(O, enumBugKeys);
};


/***/ }),

/***/ "df7c":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(process) {// .dirname, .basename, and .extname methods are extracted from Node.js v8.11.1,
// backported and transplited with Babel, with backwards-compat fixes

// Copyright Joyent, Inc. and other Node contributors.
//
// Permission is hereby granted, free of charge, to any person obtaining a
// copy of this software and associated documentation files (the
// "Software"), to deal in the Software without restriction, including
// without limitation the rights to use, copy, modify, merge, publish,
// distribute, sublicense, and/or sell copies of the Software, and to permit
// persons to whom the Software is furnished to do so, subject to the
// following conditions:
//
// The above copyright notice and this permission notice shall be included
// in all copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN
// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR
// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE
// USE OR OTHER DEALINGS IN THE SOFTWARE.

// resolves . and .. elements in a path array with directory names there
// must be no slashes, empty elements, or device names (c:\) in the array
// (so also no leading and trailing slashes - it does not distinguish
// relative and absolute paths)
function normalizeArray(parts, allowAboveRoot) {
  // if the path tries to go above the root, `up` ends up > 0
  var up = 0;
  for (var i = parts.length - 1; i >= 0; i--) {
    var last = parts[i];
    if (last === '.') {
      parts.splice(i, 1);
    } else if (last === '..') {
      parts.splice(i, 1);
      up++;
    } else if (up) {
      parts.splice(i, 1);
      up--;
    }
  }

  // if the path is allowed to go above the root, restore leading ..s
  if (allowAboveRoot) {
    for (; up--; up) {
      parts.unshift('..');
    }
  }

  return parts;
}

// path.resolve([from ...], to)
// posix version
exports.resolve = function() {
  var resolvedPath = '',
      resolvedAbsolute = false;

  for (var i = arguments.length - 1; i >= -1 && !resolvedAbsolute; i--) {
    var path = (i >= 0) ? arguments[i] : process.cwd();

    // Skip empty and invalid entries
    if (typeof path !== 'string') {
      throw new TypeError('Arguments to path.resolve must be strings');
    } else if (!path) {
      continue;
    }

    resolvedPath = path + '/' + resolvedPath;
    resolvedAbsolute = path.charAt(0) === '/';
  }

  // At this point the path should be resolved to a full absolute path, but
  // handle relative paths to be safe (might happen when process.cwd() fails)

  // Normalize the path
  resolvedPath = normalizeArray(filter(resolvedPath.split('/'), function(p) {
    return !!p;
  }), !resolvedAbsolute).join('/');

  return ((resolvedAbsolute ? '/' : '') + resolvedPath) || '.';
};

// path.normalize(path)
// posix version
exports.normalize = function(path) {
  var isAbsolute = exports.isAbsolute(path),
      trailingSlash = substr(path, -1) === '/';

  // Normalize the path
  path = normalizeArray(filter(path.split('/'), function(p) {
    return !!p;
  }), !isAbsolute).join('/');

  if (!path && !isAbsolute) {
    path = '.';
  }
  if (path && trailingSlash) {
    path += '/';
  }

  return (isAbsolute ? '/' : '') + path;
};

// posix version
exports.isAbsolute = function(path) {
  return path.charAt(0) === '/';
};

// posix version
exports.join = function() {
  var paths = Array.prototype.slice.call(arguments, 0);
  return exports.normalize(filter(paths, function(p, index) {
    if (typeof p !== 'string') {
      throw new TypeError('Arguments to path.join must be strings');
    }
    return p;
  }).join('/'));
};


// path.relative(from, to)
// posix version
exports.relative = function(from, to) {
  from = exports.resolve(from).substr(1);
  to = exports.resolve(to).substr(1);

  function trim(arr) {
    var start = 0;
    for (; start < arr.length; start++) {
      if (arr[start] !== '') break;
    }

    var end = arr.length - 1;
    for (; end >= 0; end--) {
      if (arr[end] !== '') break;
    }

    if (start > end) return [];
    return arr.slice(start, end - start + 1);
  }

  var fromParts = trim(from.split('/'));
  var toParts = trim(to.split('/'));

  var length = Math.min(fromParts.length, toParts.length);
  var samePartsLength = length;
  for (var i = 0; i < length; i++) {
    if (fromParts[i] !== toParts[i]) {
      samePartsLength = i;
      break;
    }
  }

  var outputParts = [];
  for (var i = samePartsLength; i < fromParts.length; i++) {
    outputParts.push('..');
  }

  outputParts = outputParts.concat(toParts.slice(samePartsLength));

  return outputParts.join('/');
};

exports.sep = '/';
exports.delimiter = ':';

exports.dirname = function (path) {
  if (typeof path !== 'string') path = path + '';
  if (path.length === 0) return '.';
  var code = path.charCodeAt(0);
  var hasRoot = code === 47 /*/*/;
  var end = -1;
  var matchedSlash = true;
  for (var i = path.length - 1; i >= 1; --i) {
    code = path.charCodeAt(i);
    if (code === 47 /*/*/) {
        if (!matchedSlash) {
          end = i;
          break;
        }
      } else {
      // We saw the first non-path separator
      matchedSlash = false;
    }
  }

  if (end === -1) return hasRoot ? '/' : '.';
  if (hasRoot && end === 1) {
    // return '//';
    // Backwards-compat fix:
    return '/';
  }
  return path.slice(0, end);
};

function basename(path) {
  if (typeof path !== 'string') path = path + '';

  var start = 0;
  var end = -1;
  var matchedSlash = true;
  var i;

  for (i = path.length - 1; i >= 0; --i) {
    if (path.charCodeAt(i) === 47 /*/*/) {
        // If we reached a path separator that was not part of a set of path
        // separators at the end of the string, stop now
        if (!matchedSlash) {
          start = i + 1;
          break;
        }
      } else if (end === -1) {
      // We saw the first non-path separator, mark this as the end of our
      // path component
      matchedSlash = false;
      end = i + 1;
    }
  }

  if (end === -1) return '';
  return path.slice(start, end);
}

// Uses a mixed approach for backwards-compatibility, as ext behavior changed
// in new Node.js versions, so only basename() above is backported here
exports.basename = function (path, ext) {
  var f = basename(path);
  if (ext && f.substr(-1 * ext.length) === ext) {
    f = f.substr(0, f.length - ext.length);
  }
  return f;
};

exports.extname = function (path) {
  if (typeof path !== 'string') path = path + '';
  var startDot = -1;
  var startPart = 0;
  var end = -1;
  var matchedSlash = true;
  // Track the state of characters (if any) we see before our first dot and
  // after any path separator we find
  var preDotState = 0;
  for (var i = path.length - 1; i >= 0; --i) {
    var code = path.charCodeAt(i);
    if (code === 47 /*/*/) {
        // If we reached a path separator that was not part of a set of path
        // separators at the end of the string, stop now
        if (!matchedSlash) {
          startPart = i + 1;
          break;
        }
        continue;
      }
    if (end === -1) {
      // We saw the first non-path separator, mark this as the end of our
      // extension
      matchedSlash = false;
      end = i + 1;
    }
    if (code === 46 /*.*/) {
        // If this is our first dot, mark it as the start of our extension
        if (startDot === -1)
          startDot = i;
        else if (preDotState !== 1)
          preDotState = 1;
    } else if (startDot !== -1) {
      // We saw a non-dot and non-path separator before our dot, so we should
      // have a good chance at having a non-empty extension
      preDotState = -1;
    }
  }

  if (startDot === -1 || end === -1 ||
      // We saw a non-dot character immediately before the dot
      preDotState === 0 ||
      // The (right-most) trimmed path component is exactly '..'
      preDotState === 1 && startDot === end - 1 && startDot === startPart + 1) {
    return '';
  }
  return path.slice(startDot, end);
};

function filter (xs, f) {
    if (xs.filter) return xs.filter(f);
    var res = [];
    for (var i = 0; i < xs.length; i++) {
        if (f(xs[i], i, xs)) res.push(xs[i]);
    }
    return res;
}

// String.prototype.substr - negative index don't work in IE8
var substr = 'ab'.substr(-1) === 'b'
    ? function (str, start, len) { return str.substr(start, len) }
    : function (str, start, len) {
        if (start < 0) start = str.length + start;
        return str.substr(start, len);
    }
;

/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("4362")))

/***/ }),

/***/ "dfb9":
/***/ (function(module, exports) {

module.exports = function (Constructor, list) {
  var index = 0;
  var length = list.length;
  var result = new Constructor(length);
  while (length > index) result[index] = list[index++];
  return result;
};


/***/ }),

/***/ "e01a":
/***/ (function(module, exports, __webpack_require__) {

"use strict";
// `Symbol.prototype.description` getter
// https://tc39.es/ecma262/#sec-symbol.prototype.description

var $ = __webpack_require__("23e7");
var DESCRIPTORS = __webpack_require__("83ab");
var global = __webpack_require__("da84");
var uncurryThis = __webpack_require__("e330");
var hasOwn = __webpack_require__("1a2d");
var isCallable = __webpack_require__("1626");
var isPrototypeOf = __webpack_require__("3a9b");
var toString = __webpack_require__("577e");
var defineProperty = __webpack_require__("9bf2").f;
var copyConstructorProperties = __webpack_require__("e893");

var NativeSymbol = global.Symbol;
var SymbolPrototype = NativeSymbol && NativeSymbol.prototype;

if (DESCRIPTORS && isCallable(NativeSymbol) && (!('description' in SymbolPrototype) ||
  // Safari 12 bug
  NativeSymbol().description !== undefined
)) {
  var EmptyStringDescriptionStore = {};
  // wrap Symbol constructor for correct work with undefined description
  var SymbolWrapper = function Symbol() {
    var description = arguments.length < 1 || arguments[0] === undefined ? undefined : toString(arguments[0]);
    var result = isPrototypeOf(SymbolPrototype, this)
      ? new NativeSymbol(description)
      // in Edge 13, String(Symbol(undefined)) === 'Symbol(undefined)'
      : description === undefined ? NativeSymbol() : NativeSymbol(description);
    if (description === '') EmptyStringDescriptionStore[result] = true;
    return result;
  };

  copyConstructorProperties(SymbolWrapper, NativeSymbol);
  SymbolWrapper.prototype = SymbolPrototype;
  SymbolPrototype.constructor = SymbolWrapper;

  var NATIVE_SYMBOL = String(NativeSymbol('test')) == 'Symbol(test)';
  var symbolToString = uncurryThis(SymbolPrototype.toString);
  var symbolValueOf = uncurryThis(SymbolPrototype.valueOf);
  var regexp = /^Symbol\((.*)\)[^)]+$/;
  var replace = uncurryThis(''.replace);
  var stringSlice = uncurryThis(''.slice);

  defineProperty(SymbolPrototype, 'description', {
    configurable: true,
    get: function description() {
      var symbol = symbolValueOf(this);
      var string = symbolToString(symbol);
      if (hasOwn(EmptyStringDescriptionStore, symbol)) return '';
      var desc = NATIVE_SYMBOL ? stringSlice(string, 7, -1) : replace(string, regexp, '$1');
      return desc === '' ? undefined : desc;
    }
  });

  $({ global: true, forced: true }, {
    Symbol: SymbolWrapper
  });
}


/***/ }),

/***/ "e021":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

/* eslint-disable*/

var _typeof = __webpack_require__("7037").default;

__webpack_require__("131a");

__webpack_require__("ac1f");

__webpack_require__("1276");

__webpack_require__("5319");

__webpack_require__("a15b");

__webpack_require__("00b4");

__webpack_require__("d3b7");

__webpack_require__("25f0");

__webpack_require__("a9e3");

__webpack_require__("99af");

__webpack_require__("fb6a");

__webpack_require__("498a");

__webpack_require__("466d");

__webpack_require__("4d63");

__webpack_require__("c607");

__webpack_require__("2c3e");

__webpack_require__("159b");

__webpack_require__("b0c0");

__webpack_require__("7db0");

__webpack_require__("e260");

__webpack_require__("ace4");

__webpack_require__("5cc6");

__webpack_require__("907a");

__webpack_require__("9a8c");

__webpack_require__("a975");

__webpack_require__("735e");

__webpack_require__("c1ac");

__webpack_require__("d139");

__webpack_require__("3a7b");

__webpack_require__("d5d6");

__webpack_require__("82f8");

__webpack_require__("e91f");

__webpack_require__("60bd");

__webpack_require__("5f96");

__webpack_require__("3280");

__webpack_require__("3fcc");

__webpack_require__("ca91");

__webpack_require__("25a1");

__webpack_require__("cd26");

__webpack_require__("3c5d");

__webpack_require__("2954");

__webpack_require__("649e");

__webpack_require__("219c");

__webpack_require__("170b");

__webpack_require__("b39a");

__webpack_require__("72f7");

__webpack_require__("e9c4");

__webpack_require__("cb29");

__webpack_require__("2ca0");

__webpack_require__("8a79");

__webpack_require__("8b09");

__webpack_require__("84c3");

__webpack_require__("143c");

__webpack_require__("fb2c");

__webpack_require__("cfc3");

__webpack_require__("b680");

__webpack_require__("b64b");

__webpack_require__("caad");

__webpack_require__("2532");

var JSZip = __webpack_require__("c4e3");

function _interopDefaultLegacy(e) {
  return e && _typeof(e) === 'object' && 'default' in e ? e : {
    default: e
  };
}

var JSZip__default = /*#__PURE__*/_interopDefaultLegacy(JSZip);
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */

/* global Reflect, Promise */


var _extendStatics = function extendStatics(d, b) {
  _extendStatics = Object.setPrototypeOf || {
    __proto__: []
  } instanceof Array && function (d, b) {
    d.__proto__ = b;
  } || function (d, b) {
    for (var p in b) {
      if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];
    }
  };

  return _extendStatics(d, b);
};

function __extends(d, b) {
  _extendStatics(d, b);

  function __() {
    this.constructor = d;
  }

  d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
}

var columeHeader_word = ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z'];
var columeHeader_word_index = {
  A: 0,
  B: 1,
  C: 2,
  D: 3,
  E: 4,
  F: 5,
  G: 6,
  H: 7,
  I: 8,
  J: 9,
  K: 10,
  L: 11,
  M: 12,
  N: 13,
  O: 14,
  P: 15,
  Q: 16,
  R: 17,
  S: 18,
  T: 19,
  U: 20,
  V: 21,
  W: 22,
  X: 23,
  Y: 24,
  Z: 25
};
var coreFile = 'docProps/core.xml';
var appFile = 'docProps/app.xml';
var workBookFile = 'xl/workbook.xml';
var calcChainFile = 'xl/calcChain.xml';
var stylesFile = 'xl/styles.xml';
var sharedStringsFile = 'xl/sharedStrings.xml';
var theme1File = 'xl/theme/theme1.xml';
var workbookRels = 'xl/_rels/workbook.xml.rels'; // xl/worksheets/_rels/sheet1.xml.rels
//Excel Built-In cell type

var ST_CellType = {
  Boolean: 'b',
  Date: 'd',
  Error: 'e',
  InlineString: 'inlineStr',
  Number: 'n',
  SharedString: 's',
  String: 'str'
};
var numFmtDefault = {
  '0': 'General',
  '1': '0',
  '2': '0.00',
  '3': '#,##0',
  '4': '#,##0.00',
  '9': '0%',
  '10': '0.00%',
  '11': '0.00E+00',
  '12': '# ?/?',
  '13': '# ??/??',
  '14': 'm/d/yy',
  '15': 'd-mmm-yy',
  '16': 'd-mmm',
  '17': 'mmm-yy',
  '18': 'h:mm AM/PM',
  '19': 'h:mm:ss AM/PM',
  '20': 'h:mm',
  '21': 'h:mm:ss',
  '22': 'm/d/yy h:mm',
  '37': '#,##0 ;(#,##0)',
  '38': '#,##0 ;[Red](#,##0)',
  '39': '#,##0.00;(#,##0.00)',
  '40': '#,##0.00;[Red](#,##0.00)',
  '45': 'mm:ss',
  '46': '[h]:mm:ss',
  '47': 'mmss.0',
  '48': '##0.0E+0',
  '49': '@'
};
var indexedColors = {
  '0': '00000000',
  '1': '00FFFFFF',
  '2': '00FF0000',
  '3': '0000FF00',
  '4': '000000FF',
  '5': '00FFFF00',
  '6': '00FF00FF',
  '7': '0000FFFF',
  '8': '00000000',
  '9': '00FFFFFF',
  '10': '00FF0000',
  '11': '0000FF00',
  '12': '000000FF',
  '13': '00FFFF00',
  '14': '00FF00FF',
  '15': '0000FFFF',
  '16': '00800000',
  '17': '00008000',
  '18': '00000080',
  '19': '00808000',
  '20': '00800080',
  '21': '00008080',
  '22': '00C0C0C0',
  '23': '00808080',
  '24': '009999FF',
  '25': '00993366',
  '26': '00FFFFCC',
  '27': '00CCFFFF',
  '28': '00660066',
  '29': '00FF8080',
  '30': '000066CC',
  '31': '00CCCCFF',
  '32': '00000080',
  '33': '00FF00FF',
  '34': '00FFFF00',
  '35': '0000FFFF',
  '36': '00800080',
  '37': '00800000',
  '38': '00008080',
  '39': '000000FF',
  '40': '0000CCFF',
  '41': '00CCFFFF',
  '42': '00CCFFCC',
  '43': '00FFFF99',
  '44': '0099CCFF',
  '45': '00FF99CC',
  '46': '00CC99FF',
  '47': '00FFCC99',
  '48': '003366FF',
  '49': '0033CCCC',
  '50': '0099CC00',
  '51': '00FFCC00',
  '52': '00FF9900',
  '53': '00FF6600',
  '54': '00666699',
  '55': '00969696',
  '56': '00003366',
  '57': '00339966',
  '58': '00003300',
  '59': '00333300',
  '60': '00993300',
  '61': '00993366',
  '62': '00333399',
  '63': '00333333',
  '64': null,
  '65': null
};
var borderTypes = {
  none: 0,
  thin: 1,
  hair: 2,
  dotted: 3,
  dashed: 4,
  dashDot: 5,
  dashDotDot: 6,
  double: 7,
  medium: 8,
  mediumDashed: 9,
  mediumDashDot: 10,
  mediumDashDotDot: 11,
  slantDashDot: 12,
  thick: 13
};
var fontFamilys = {
  '0': 'defualt',
  '1': 'Roman',
  '2': 'Swiss',
  '3': 'Modern',
  '4': 'Script',
  '5': 'Decorative'
};

function getcellrange(txt, sheets, sheetId) {
  if (sheets === void 0) {
    sheets = {};
  }

  if (sheetId === void 0) {
    sheetId = '1';
  }

  var val = txt.split('!');
  var sheettxt = '',
      rangetxt = '',
      sheetIndex = -1;

  if (val.length > 1) {
    sheettxt = val[0];
    rangetxt = val[1];
    var si = sheets[sheettxt];

    if (si == null) {
      sheetIndex = parseInt(sheetId);
    } else {
      sheetIndex = parseInt(si);
    }
  } else {
    sheetIndex = parseInt(sheetId);
    rangetxt = val[0];
  }

  if (rangetxt.indexOf(':') == -1) {
    var row = parseInt(rangetxt.replace(/[^0-9]/g, '')) - 1;
    var col = ABCatNum(rangetxt.replace(/[^A-Za-z]/g, ''));

    if (!isNaN(row) && !isNaN(col)) {
      return {
        row: [row, row],
        column: [col, col],
        sheetIndex: sheetIndex
      };
    } else {
      return null;
    }
  } else {
    var rangetxtArray = rangetxt.split(':');
    var row = [],
        col = [];
    row[0] = parseInt(rangetxtArray[0].replace(/[^0-9]/g, '')) - 1;
    row[1] = parseInt(rangetxtArray[1].replace(/[^0-9]/g, '')) - 1; // if (isNaN(row[0])) {
    //     row[0] = 0;
    // }
    // if (isNaN(row[1])) {
    //     row[1] = sheetdata.length - 1;
    // }

    if (row[0] > row[1]) {
      return null;
    }

    col[0] = ABCatNum(rangetxtArray[0].replace(/[^A-Za-z]/g, ''));
    col[1] = ABCatNum(rangetxtArray[1].replace(/[^A-Za-z]/g, '')); // if (isNaN(col[0])) {
    //     col[0] = 0;
    // }
    // if (isNaN(col[1])) {
    //     col[1] = sheetdata[0].length - 1;
    // }

    if (col[0] > col[1]) {
      return null;
    }

    return {
      row: row,
      column: col,
      sheetIndex: sheetIndex
    };
  }
} //列下标  字母转数字


function ABCatNum(abc) {
  abc = abc.toUpperCase();
  var abc_len = abc.length;

  if (abc_len == 0) {
    return NaN;
  }

  var abc_array = abc.split('');
  var wordlen = columeHeader_word.length;
  var ret = 0;

  for (var i = abc_len - 1; i >= 0; i--) {
    if (i == abc_len - 1) {
      ret += columeHeader_word_index[abc_array[i]];
    } else {
      ret += Math.pow(wordlen, abc_len - i - 1) * (columeHeader_word_index[abc_array[i]] + 1);
    }
  }

  return ret;
} //列下标  数字转字母


function chatatABC(index) {
  var wordlen = columeHeader_word.length;

  if (index < wordlen) {
    return columeHeader_word[index];
  } else {
    var last = 0,
        ret = '';
    var i = 1,
        n = 0;

    while (index >= wordlen / (wordlen - 1) * (Math.pow(wordlen, i++) - 1)) {
      n = i;
    }

    var index_ab = index - wordlen / (wordlen - 1) * (Math.pow(wordlen, n - 1) - 1); //970

    last = index_ab + 1;

    for (var x = n; x > 0; x--) {
      var last1 = last; //-702=268, 3

      if (x == 1) {
        last1 = last1 % wordlen;

        if (last1 == 0) {
          last1 = 26;
        }

        return ret + columeHeader_word[last1 - 1];
      }

      last1 = Math.ceil(last1 / Math.pow(wordlen, x - 1)); //last1 = last1 % wordlen;

      ret += columeHeader_word[last1 - 1];

      if (x > 1) {
        last = last - (last1 - 1) * wordlen;
      }
    }
  }
}
/**
 * @return ratio, default 0.75 1in = 2.54cm = 25.4mm = 72pt = 6pc,  pt = 1/72 In, px = 1/dpi In
 */


function getptToPxRatioByDPI() {
  return 72 / 96;
}
/**
 * @emus EMUs, Excel drawing unit
 * @return pixel
 */


function getPxByEMUs(emus) {
  if (emus == null) {
    return 0;
  }

  var inch = emus / 914400;
  var pt = inch * 72;
  var px = pt / getptToPxRatioByDPI();
  return px;
}
/**
 * @dom xml attribute object
 * @attr attribute name
 * @d if attribute is null, return default value
 * @return attribute value
 */


function getXmlAttibute(dom, attr, d) {
  var value = dom[attr];
  value = value == null ? d : value;
  return value;
}
/**
 * @columnWidth Excel column width
 * @return pixel column width
 */


function getColumnWidthPixel(columnWidth) {
  var pix = Math.round((columnWidth - 0.83) * 8 + 5);
  return pix;
}
/**
 * @rowHeight Excel row height
 * @return pixel row height
 */


function getRowHeightPixel(rowHeight) {
  var pix = Math.round(rowHeight / getptToPxRatioByDPI());
  return pix;
}

function LightenDarkenColor(sixColor, tint) {
  var hex = sixColor.substring(sixColor.length - 6, sixColor.length);
  var rgbArray = hexToRgbArray('#' + hex);
  var hslArray = rgbToHsl(rgbArray[0], rgbArray[1], rgbArray[2]);

  if (tint > 0) {
    hslArray[2] = hslArray[2] * (1.0 - tint) + tint;
  } else if (tint < 0) {
    hslArray[2] = hslArray[2] * (1.0 + tint);
  } else {
    return '#' + hex;
  }

  var newRgbArray = hslToRgb(hslArray[0], hslArray[1], hslArray[2]);
  return rgbToHex('RGB(' + newRgbArray.join(',') + ')');
}

function rgbToHex(rgb) {
  //十六进制颜色值的正则表达式
  var reg = /^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/; // 如果是rgb颜色表示

  if (/^(rgb|RGB)/.test(rgb)) {
    var aColor = rgb.replace(/(?:\(|\)|rgb|RGB)*/g, '').split(',');
    var strHex = '#';

    for (var i = 0; i < aColor.length; i++) {
      var hex = Number(aColor[i]).toString(16);

      if (hex.length < 2) {
        hex = '0' + hex;
      }

      strHex += hex;
    }

    if (strHex.length !== 7) {
      strHex = rgb;
    }

    return strHex;
  } else if (reg.test(rgb)) {
    var aNum = rgb.replace(/#/, '').split('');

    if (aNum.length === 6) {
      return rgb;
    } else if (aNum.length === 3) {
      var numHex = '#';

      for (var i = 0; i < aNum.length; i += 1) {
        numHex += aNum[i] + aNum[i];
      }

      return numHex;
    }
  }

  return rgb;
}

function hexToRgbArray(hex) {
  var sColor = hex.toLowerCase(); //十六进制颜色值的正则表达式

  var reg = /^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/; // 如果是16进制颜色

  if (sColor && reg.test(sColor)) {
    if (sColor.length === 4) {
      var sColorNew = '#';

      for (var i = 1; i < 4; i += 1) {
        sColorNew += sColor.slice(i, i + 1).concat(sColor.slice(i, i + 1));
      }

      sColor = sColorNew;
    } //处理六位的颜色值


    var sColorChange = [];

    for (var i = 1; i < 7; i += 2) {
      sColorChange.push(parseInt('0x' + sColor.slice(i, i + 2)));
    }

    return sColorChange;
  }

  return null;
}
/**
 * HSL颜色值转换为RGB.
 * 换算公式改编自 http://en.wikipedia.org/wiki/HSL_color_space.
 * h, s, 和 l 设定在 [0, 1] 之间
 * 返回的 r, g, 和 b 在 [0, 255]之间
 *
 * @param   Number  h       色相
 * @param   Number  s       饱和度
 * @param   Number  l       亮度
 * @return  Array           RGB色值数值
 */


function hslToRgb(h, s, l) {
  var r, g, b;

  if (s == 0) {
    r = g = b = l; // achromatic
  } else {
    var hue2rgb = function hue2rgb(p, q, t) {
      if (t < 0) t += 1;
      if (t > 1) t -= 1;
      if (t < 1 / 6) return p + (q - p) * 6 * t;
      if (t < 1 / 2) return q;
      if (t < 2 / 3) return p + (q - p) * (2 / 3 - t) * 6;
      return p;
    };

    var q = l < 0.5 ? l * (1 + s) : l + s - l * s;
    var p = 2 * l - q;
    r = hue2rgb(p, q, h + 1 / 3);
    g = hue2rgb(p, q, h);
    b = hue2rgb(p, q, h - 1 / 3);
  }

  return [Math.round(r * 255), Math.round(g * 255), Math.round(b * 255)];
}
/**
 * RGB 颜色值转换为 HSL.
 * 转换公式参考自 http://en.wikipedia.org/wiki/HSL_color_space.
 * r, g, 和 b 需要在 [0, 255] 范围内
 * 返回的 h, s, 和 l 在 [0, 1] 之间
 *
 * @param   Number  r       红色色值
 * @param   Number  g       绿色色值
 * @param   Number  b       蓝色色值
 * @return  Array           HSL各值数组
 */


function rgbToHsl(r, g, b) {
  r /= 255, g /= 255, b /= 255;
  var max = Math.max(r, g, b),
      min = Math.min(r, g, b);
  var h,
      s,
      l = (max + min) / 2;

  if (max == min) {
    h = s = 0; // achromatic
  } else {
    var d = max - min;
    s = l > 0.5 ? d / (2 - max - min) : d / (max + min);

    switch (max) {
      case r:
        h = (g - b) / d + (g < b ? 6 : 0);
        break;

      case g:
        h = (b - r) / d + 2;
        break;

      case b:
        h = (r - g) / d + 4;
        break;
    }

    h /= 6;
  }

  return [h, s, l];
}

function generateRandomIndex(prefix) {
  if (prefix == null) {
    prefix = 'Sheet';
  }

  var userAgent = window.navigator.userAgent.replace(/[^a-zA-Z0-9]/g, '').split('');
  var mid = '';

  for (var i = 0; i < 5; i++) {
    mid += userAgent[Math.round(Math.random() * (userAgent.length - 1))];
  }

  var time = new Date().getTime();
  return prefix + '_' + mid + '_' + time;
}

function escapeCharacter(str) {
  if (str == null || str.length == 0) {
    return str;
  }

  return str.replace(/&amp;/g, '&').replace(/&quot;/g, '"').replace(/&lt;/g, '<').replace(/&gt;/g, '>').replace(/&nbsp;/g, ' ').replace(/&apos;/g, "'").replace(/&iexcl;/g, '¡').replace(/&cent;/g, '¢').replace(/&pound;/g, '£').replace(/&curren;/g, '¤').replace(/&yen;/g, '¥').replace(/&brvbar;/g, '¦').replace(/&sect;/g, '§').replace(/&uml;/g, '¨').replace(/&copy;/g, '©').replace(/&ordf;/g, 'ª').replace(/&laquo;/g, '«').replace(/&not;/g, '¬').replace(/&shy;/g, '­').replace(/&reg;/g, '®').replace(/&macr;/g, '¯').replace(/&deg;/g, '°').replace(/&plusmn;/g, '±').replace(/&sup2;/g, '²').replace(/&sup3;/g, '³').replace(/&acute;/g, '´').replace(/&micro;/g, 'µ').replace(/&para;/g, '¶').replace(/&middot;/g, '·').replace(/&cedil;/g, '¸').replace(/&sup1;/g, '¹').replace(/&ordm;/g, 'º').replace(/&raquo;/g, '»').replace(/&frac14;/g, '¼').replace(/&frac12;/g, '½').replace(/&frac34;/g, '¾').replace(/&iquest;/g, '¿').replace(/&times;/g, '×').replace(/&divide;/g, '÷').replace(/&Agrave;/g, 'À').replace(/&Aacute;/g, 'Á').replace(/&Acirc;/g, 'Â').replace(/&Atilde;/g, 'Ã').replace(/&Auml;/g, 'Ä').replace(/&Aring;/g, 'Å').replace(/&AElig;/g, 'Æ').replace(/&Ccedil;/g, 'Ç').replace(/&Egrave;/g, 'È').replace(/&Eacute;/g, 'É').replace(/&Ecirc;/g, 'Ê').replace(/&Euml;/g, 'Ë').replace(/&Igrave;/g, 'Ì').replace(/&Iacute;/g, 'Í').replace(/&Icirc;/g, 'Î').replace(/&Iuml;/g, 'Ï').replace(/&ETH;/g, 'Ð').replace(/&Ntilde;/g, 'Ñ').replace(/&Ograve;/g, 'Ò').replace(/&Oacute;/g, 'Ó').replace(/&Ocirc;/g, 'Ô').replace(/&Otilde;/g, 'Õ').replace(/&Ouml;/g, 'Ö').replace(/&Oslash;/g, 'Ø').replace(/&Ugrave;/g, 'Ù').replace(/&Uacute;/g, 'Ú').replace(/&Ucirc;/g, 'Û').replace(/&Uuml;/g, 'Ü').replace(/&Yacute;/g, 'Ý').replace(/&THORN;/g, 'Þ').replace(/&szlig;/g, 'ß').replace(/&agrave;/g, 'à').replace(/&aacute;/g, 'á').replace(/&acirc;/g, 'â').replace(/&atilde;/g, 'ã').replace(/&auml;/g, 'ä').replace(/&aring;/g, 'å').replace(/&aelig;/g, 'æ').replace(/&ccedil;/g, 'ç').replace(/&egrave;/g, 'è').replace(/&eacute;/g, 'é').replace(/&ecirc;/g, 'ê').replace(/&euml;/g, 'ë').replace(/&igrave;/g, 'ì').replace(/&iacute;/g, 'í').replace(/&icirc;/g, 'î').replace(/&iuml;/g, 'ï').replace(/&eth;/g, 'ð').replace(/&ntilde;/g, 'ñ').replace(/&ograve;/g, 'ò').replace(/&oacute;/g, 'ó').replace(/&ocirc;/g, 'ô').replace(/&otilde;/g, 'õ').replace(/&ouml;/g, 'ö').replace(/&oslash;/g, 'ø').replace(/&ugrave;/g, 'ù').replace(/&uacute;/g, 'ú').replace(/&ucirc;/g, 'û').replace(/&uuml;/g, 'ü').replace(/&yacute;/g, 'ý').replace(/&thorn;/g, 'þ').replace(/&yuml;/g, 'ÿ');
}

var fromulaRef =
/** @class */
function () {
  function fromulaRef() {}

  fromulaRef.trim = function (str) {
    if (str == null) {
      str = '';
    }

    return str.replace(/(^\s*)|(\s*$)/g, '');
  };

  fromulaRef.functionCopy = function (txt, mode, step) {
    var _this = this;

    if (_this.operatorjson == null) {
      var arr = _this.operator.split('|'),
          op = {};

      for (var i_1 = 0; i_1 < arr.length; i_1++) {
        op[arr[i_1].toString()] = 1;
      }

      _this.operatorjson = op;
    }

    if (mode == null) {
      mode = 'down';
    }

    if (step == null) {
      step = 1;
    }

    if (txt.substr(0, 1) == '=') {
      txt = txt.substr(1);
    }

    var funcstack = txt.split('');
    var i = 0,
        str = '',
        function_str = '';
    var matchConfig = {
      bracket: 0,
      comma: 0,
      squote: 0,
      dquote: 0
    };

    while (i < funcstack.length) {
      var s = funcstack[i];

      if (s == '(' && matchConfig.dquote == 0) {
        matchConfig.bracket += 1;

        if (str.length > 0) {
          function_str += str + '(';
        } else {
          function_str += '(';
        }

        str = '';
      } else if (s == ')' && matchConfig.dquote == 0) {
        matchConfig.bracket -= 1;
        function_str += _this.functionCopy(str, mode, step) + ')';
        str = '';
      } else if (s == '"' && matchConfig.squote == 0) {
        if (matchConfig.dquote > 0) {
          function_str += str + '"';
          matchConfig.dquote -= 1;
          str = '';
        } else {
          matchConfig.dquote += 1;
          str += '"';
        }
      } else if (s == ',' && matchConfig.dquote == 0) {
        function_str += _this.functionCopy(str, mode, step) + ',';
        str = '';
      } else if (s == '&' && matchConfig.dquote == 0) {
        if (str.length > 0) {
          function_str += _this.functionCopy(str, mode, step) + '&';
          str = '';
        } else {
          function_str += '&';
        }
      } else if (s in _this.operatorjson && matchConfig.dquote == 0) {
        var s_next = '';

        if (i + 1 < funcstack.length) {
          s_next = funcstack[i + 1];
        }

        var p = i - 1,
            s_pre = null;

        if (p >= 0) {
          do {
            s_pre = funcstack[p--];
          } while (p >= 0 && s_pre == ' ');
        }

        if (s + s_next in _this.operatorjson) {
          if (str.length > 0) {
            function_str += _this.functionCopy(str, mode, step) + s + s_next;
            str = '';
          } else {
            function_str += s + s_next;
          }

          i++;
        } else if (!/[^0-9]/.test(s_next) && s == '-' && (s_pre == '(' || s_pre == null || s_pre == ',' || s_pre == ' ' || s_pre in _this.operatorjson)) {
          str += s;
        } else {
          if (str.length > 0) {
            function_str += _this.functionCopy(str, mode, step) + s;
            str = '';
          } else {
            function_str += s;
          }
        }
      } else {
        str += s;
      }

      if (i == funcstack.length - 1) {
        if (_this.iscelldata(_this.trim(str))) {
          if (mode == 'down') {
            function_str += _this.downparam(_this.trim(str), step);
          } else if (mode == 'up') {
            function_str += _this.upparam(_this.trim(str), step);
          } else if (mode == 'left') {
            function_str += _this.leftparam(_this.trim(str), step);
          } else if (mode == 'right') {
            function_str += _this.rightparam(_this.trim(str), step);
          }
        } else {
          function_str += _this.trim(str);
        }
      }

      i++;
    }

    return function_str;
  };

  fromulaRef.downparam = function (txt, step) {
    return this.updateparam('d', txt, step);
  };

  fromulaRef.upparam = function (txt, step) {
    return this.updateparam('u', txt, step);
  };

  fromulaRef.leftparam = function (txt, step) {
    return this.updateparam('l', txt, step);
  };

  fromulaRef.rightparam = function (txt, step) {
    return this.updateparam('r', txt, step);
  };

  fromulaRef.updateparam = function (orient, txt, step) {
    var _this = this;

    var val = txt.split('!'),
        rangetxt,
        prefix = '';

    if (val.length > 1) {
      rangetxt = val[1];
      prefix = val[0] + '!';
    } else {
      rangetxt = val[0];
    }

    if (rangetxt.indexOf(':') == -1) {
      var row = parseInt(rangetxt.replace(/[^0-9]/g, ''));
      var col = ABCatNum(rangetxt.replace(/[^A-Za-z]/g, ''));

      var freezonFuc = _this.isfreezonFuc(rangetxt);

      var $row = freezonFuc[0] ? '$' : '',
          $col = freezonFuc[1] ? '$' : '';

      if (orient == 'u' && !freezonFuc[0]) {
        row -= step;
      } else if (orient == 'r' && !freezonFuc[1]) {
        col += step;
      } else if (orient == 'l' && !freezonFuc[1]) {
        col -= step;
      } else if (!freezonFuc[0]) {
        row += step;
      }

      if (row < 0 || col < 0) {
        return _this.error.r;
      }

      if (!isNaN(row) && !isNaN(col)) {
        return prefix + $col + chatatABC(col) + $row + row;
      } else if (!isNaN(row)) {
        return prefix + $row + row;
      } else if (!isNaN(col)) {
        return prefix + $col + chatatABC(col);
      } else {
        return txt;
      }
    } else {
      rangetxt = rangetxt.split(':');
      var row = [],
          col = [];
      row[0] = parseInt(rangetxt[0].replace(/[^0-9]/g, ''));
      row[1] = parseInt(rangetxt[1].replace(/[^0-9]/g, ''));

      if (row[0] > row[1]) {
        return txt;
      }

      col[0] = ABCatNum(rangetxt[0].replace(/[^A-Za-z]/g, ''));
      col[1] = ABCatNum(rangetxt[1].replace(/[^A-Za-z]/g, ''));

      if (col[0] > col[1]) {
        return txt;
      }

      var freezonFuc0 = _this.isfreezonFuc(rangetxt[0]);

      var freezonFuc1 = _this.isfreezonFuc(rangetxt[1]);

      var $row0 = freezonFuc0[0] ? '$' : '',
          $col0 = freezonFuc0[1] ? '$' : '';
      var $row1 = freezonFuc1[0] ? '$' : '',
          $col1 = freezonFuc1[1] ? '$' : '';

      if (orient == 'u') {
        if (!freezonFuc0[0]) {
          row[0] -= step;
        }

        if (!freezonFuc1[0]) {
          row[1] -= step;
        }
      } else if (orient == 'r') {
        if (!freezonFuc0[1]) {
          col[0] += step;
        }

        if (!freezonFuc1[1]) {
          col[1] += step;
        }
      } else if (orient == 'l') {
        if (!freezonFuc0[1]) {
          col[0] -= step;
        }

        if (!freezonFuc1[1]) {
          col[1] -= step;
        }
      } else {
        if (!freezonFuc0[0]) {
          row[0] += step;
        }

        if (!freezonFuc1[0]) {
          row[1] += step;
        }
      }

      if (row[0] < 0 || col[0] < 0) {
        return _this.error.r;
      }

      if (isNaN(col[0]) && isNaN(col[1])) {
        return prefix + $row0 + row[0] + ':' + $row1 + row[1];
      } else if (isNaN(row[0]) && isNaN(row[1])) {
        return prefix + $col0 + chatatABC(col[0]) + ':' + $col1 + chatatABC(col[1]);
      } else {
        return prefix + $col0 + chatatABC(col[0]) + $row0 + row[0] + ':' + $col1 + chatatABC(col[1]) + $row1 + row[1];
      }
    }
  };

  fromulaRef.iscelldata = function (txt) {
    var val = txt.split('!'),
        rangetxt;

    if (val.length > 1) {
      rangetxt = val[1];
    } else {
      rangetxt = val[0];
    }

    var reg_cell = /^(([a-zA-Z]+)|([$][a-zA-Z]+))(([0-9]+)|([$][0-9]+))$/g; //增加正则判断单元格为字母+数字的格式：如 A1:B3

    var reg_cellRange = /^(((([a-zA-Z]+)|([$][a-zA-Z]+))(([0-9]+)|([$][0-9]+)))|((([a-zA-Z]+)|([$][a-zA-Z]+))))$/g; //增加正则判断单元格为字母+数字或字母的格式：如 A1:B3，A:A

    if (rangetxt.indexOf(':') == -1) {
      var row = parseInt(rangetxt.replace(/[^0-9]/g, '')) - 1;
      var col = ABCatNum(rangetxt.replace(/[^A-Za-z]/g, ''));

      if (!isNaN(row) && !isNaN(col) && rangetxt.toString().match(reg_cell)) {
        return true;
      } else if (!isNaN(row)) {
        return false;
      } else if (!isNaN(col)) {
        return false;
      } else {
        return false;
      }
    } else {
      reg_cellRange = /^(((([a-zA-Z]+)|([$][a-zA-Z]+))(([0-9]+)|([$][0-9]+)))|((([a-zA-Z]+)|([$][a-zA-Z]+)))|((([0-9]+)|([$][0-9]+s))))$/g;
      rangetxt = rangetxt.split(':');
      var row = [],
          col = [];
      row[0] = parseInt(rangetxt[0].replace(/[^0-9]/g, '')) - 1;
      row[1] = parseInt(rangetxt[1].replace(/[^0-9]/g, '')) - 1;

      if (row[0] > row[1]) {
        return false;
      }

      col[0] = ABCatNum(rangetxt[0].replace(/[^A-Za-z]/g, ''));
      col[1] = ABCatNum(rangetxt[1].replace(/[^A-Za-z]/g, ''));

      if (col[0] > col[1]) {
        return false;
      }

      if (rangetxt[0].toString().match(reg_cellRange) && rangetxt[1].toString().match(reg_cellRange)) {
        return true;
      } else {
        return false;
      }
    }
  };

  fromulaRef.isfreezonFuc = function (txt) {
    var row = txt.replace(/[^0-9]/g, '');
    var col = txt.replace(/[^A-Za-z]/g, '');
    var row$ = txt.substr(txt.indexOf(row) - 1, 1);
    var col$ = txt.substr(txt.indexOf(col) - 1, 1);
    var ret = [false, false];

    if (row$ == '$') {
      ret[0] = true;
    }

    if (col$ == '$') {
      ret[1] = true;
    }

    return ret;
  };

  fromulaRef.operator = '==|!=|<>|<=|>=|=|+|-|>|<|/|*|%|&|^';
  fromulaRef.error = {
    v: '#VALUE!',
    n: '#NAME?',
    na: '#N/A',
    r: '#REF!',
    d: '#DIV/0!',
    nm: '#NUM!',
    nl: '#NULL!',
    sp: '#SPILL!' //数组范围有其它值

  };
  fromulaRef.operatorjson = null;
  return fromulaRef;
}();

function isChinese(temp) {
  var re = /[^\u4e00-\u9fa5]/;
  var reg = /[\u3002|\uff1f|\uff01|\uff0c|\u3001|\uff1b|\uff1a|\u201c|\u201d|\u2018|\u2019|\uff08|\uff09|\u300a|\u300b|\u3008|\u3009|\u3010|\u3011|\u300e|\u300f|\u300c|\u300d|\ufe43|\ufe44|\u3014|\u3015|\u2026|\u2014|\uff5e|\ufe4f|\uffe5]/;
  if (reg.test(temp)) return true;
  if (re.test(temp)) return false;
  return true;
}

function isJapanese(temp) {
  var re = /[^\u0800-\u4e00]/;
  if (re.test(temp)) return false;
  return true;
}

function isKoera(chr) {
  if (chr > 0x3130 && chr < 0x318f || chr >= 0xac00 && chr <= 0xd7a3) {
    return true;
  }

  return false;
}

function getBinaryContent(path, options) {
  var promise, resolve, reject;
  var callback;

  if (!options) {
    options = {};
  } // taken from jQuery


  var createStandardXHR = function createStandardXHR() {
    try {
      return new window.XMLHttpRequest();
    } catch (e) {}
  };

  var createActiveXHR = function createActiveXHR() {
    try {
      return new window.ActiveXObject('Microsoft.XMLHTTP');
    } catch (e) {}
  }; // Create the request object


  var createXHR = typeof window !== 'undefined' && window.ActiveXObject ?
  /* Microsoft failed to properly
   * implement the XMLHttpRequest in IE7 (can't request local files),
   * so we use the ActiveXObject when it is available
   * Additionally XMLHttpRequest can be disabled in IE7/IE8 so
   * we need a fallback.
   */
  function () {
    return createStandardXHR() || createActiveXHR();
  } : // For all other browsers, use the standard XMLHttpRequest object
  createStandardXHR; // backward compatible callback

  if (typeof options === 'function') {
    callback = options;
    options = {};
  } else if (typeof options.callback === 'function') {
    // callback inside options object
    callback = options.callback;
  }

  resolve = function resolve(data) {
    callback(null, data);
  };

  reject = function reject(err) {
    callback(err, null);
  };

  try {
    var xhr = createXHR();
    xhr.open('GET', path, true); // recent browsers

    if ('responseType' in xhr) {
      xhr.responseType = 'arraybuffer';
    } // older browser


    if (xhr.overrideMimeType) {
      xhr.overrideMimeType('text/plain; charset=x-user-defined');
    }

    xhr.onreadystatechange = function (event) {
      // use `xhr` and not `this`... thanks IE
      if (xhr.readyState === 4) {
        if (xhr.status === 200 || xhr.status === 0) {
          try {
            resolve(function (xhr) {
              // for xhr.responseText, the 0xFF mask is applied by JSZip
              return xhr.response || xhr.responseText;
            }(xhr));
          } catch (err) {
            reject(new Error(err));
          }
        } else {
          reject(new Error('Ajax error for ' + path + ' : ' + this.status + ' ' + this.statusText));
        }
      }
    };

    if (options.progress) {
      xhr.onprogress = function (e) {
        options.progress({
          path: path,
          originalEvent: e,
          percent: e.loaded / e.total * 100,
          loaded: e.loaded,
          total: e.total
        });
      };
    }

    xhr.send();
  } catch (e) {
    reject(new Error(e), null);
  } // returns a promise or undefined depending on whether a callback was
  // provided


  return promise;
}

var xmloperation =
/** @class */
function () {
  function xmloperation() {}
  /**
   * @param tag Search xml tag name , div,title etc.
   * @param file Xml string
   * @return Xml element string
   */


  xmloperation.prototype.getElementsByOneTag = function (tag, file) {
    //<a:[^/>: ]+?>.*?</a:[^/>: ]+?>
    var readTagReg;

    if (tag.indexOf('|') > -1) {
      var tags = tag.split('|'),
          tagsRegTxt = '';

      for (var i = 0; i < tags.length; i++) {
        var t = tags[i];
        tagsRegTxt += '|<' + t + ' [^>]+?[^/]>[\\s\\S]*?</' + t + '>|<' + t + ' [^>]+?/>|<' + t + '>[\\s\\S]*?</' + t + '>|<' + t + '/>';
      }

      tagsRegTxt = tagsRegTxt.substr(1, tagsRegTxt.length);
      readTagReg = new RegExp(tagsRegTxt, 'g');
    } else {
      readTagReg = new RegExp('<' + tag + ' [^>]+?[^/]>[\\s\\S]*?</' + tag + '>|<' + tag + ' [^>]+?/>|<' + tag + '>[\\s\\S]*?</' + tag + '>|<' + tag + '/>', 'g');
    }

    var ret = file.match(readTagReg);

    if (ret == null) {
      return [];
    } else {
      return ret;
    }
  };

  return xmloperation;
}();

var ReadXml =
/** @class */
function (_super) {
  __extends(ReadXml, _super);

  function ReadXml(files) {
    var _this = _super.call(this) || this;

    _this.originFile = files;
    return _this;
  }
  /**
   * @param path Search xml tag group , div,title etc.
   * @param fileName One of uploadfileList, uploadfileList is file group, {key:value}
   * @return Xml element calss
   */


  ReadXml.prototype.getElementsByTagName = function (path, fileName) {
    var file = this.getFileByName(fileName);
    var pathArr = path.split('/'),
        ret;

    for (var key in pathArr) {
      var path_1 = pathArr[key];

      if (ret == undefined) {
        ret = this.getElementsByOneTag(path_1, file);
      } else {
        if (ret instanceof Array) {
          var items = [];

          for (var key_1 in ret) {
            var item = ret[key_1];
            items = items.concat(this.getElementsByOneTag(path_1, item));
          }

          ret = items;
        } else {
          ret = this.getElementsByOneTag(path_1, ret);
        }
      }
    }

    var elements = [];

    for (var i = 0; i < ret.length; i++) {
      var ele = new Element(ret[i]);
      elements.push(ele);
    }

    return elements;
  };
  /**
   * @param name One of uploadfileList's name, search for file by this parameter
   * @retrun Select a file from uploadfileList
   */


  ReadXml.prototype.getFileByName = function (name) {
    for (var fileKey in this.originFile) {
      if (fileKey.indexOf(name) > -1) {
        return this.originFile[fileKey];
      }
    }

    return '';
  };

  return ReadXml;
}(xmloperation);

var Element =
/** @class */
function (_super) {
  __extends(Element, _super);

  function Element(str) {
    var _this = _super.call(this) || this;

    _this.elementString = str;

    _this.setValue();

    var readAttrReg = new RegExp('[a-zA-Z0-9_:]*?=".*?"', 'g');

    var attrList = _this.container.match(readAttrReg);

    _this.attributeList = {};

    if (attrList != null) {
      for (var key in attrList) {
        var attrFull = attrList[key]; // let al= attrFull.split("=");

        if (attrFull.length == 0) {
          continue;
        }

        var attrKey = attrFull.substr(0, attrFull.indexOf('='));
        var attrValue = attrFull.substr(attrFull.indexOf('=') + 1);

        if (attrKey == null || attrValue == null || attrKey.length == 0 || attrValue.length == 0) {
          continue;
        }

        _this.attributeList[attrKey] = attrValue.substr(1, attrValue.length - 2);
      }
    }

    return _this;
  }
  /**
   * @param name Get attribute by key in element
   * @return Single attribute
   */


  Element.prototype.get = function (name) {
    return this.attributeList[name];
  };
  /**
   * @param tag Get elements by tag in elementString
   * @return Element group
   */


  Element.prototype.getInnerElements = function (tag) {
    var ret = this.getElementsByOneTag(tag, this.elementString);
    var elements = [];

    for (var i = 0; i < ret.length; i++) {
      var ele = new Element(ret[i]);
      elements.push(ele);
    }

    if (elements.length == 0) {
      return null;
    }

    return elements;
  };
  /**
   * @desc get xml dom value and container, <container>value</container>
   */


  Element.prototype.setValue = function () {
    var str = this.elementString;

    if (str.substr(str.length - 2, 2) == '/>') {
      this.value = '';
      this.container = str;
    } else {
      var firstTag = this.getFirstTag();
      var firstTagReg = new RegExp('(<' + firstTag + ' [^>]+?[^/]>)([\\s\\S]*?)</' + firstTag + '>|(<' + firstTag + '>)([\\s\\S]*?)</' + firstTag + '>', 'g');
      var result = firstTagReg.exec(str);

      if (result != null) {
        if (result[1] != null) {
          this.container = result[1];
          this.value = result[2];
        } else {
          this.container = result[3];
          this.value = result[4];
        }
      }
    }
  };
  /**
   * @desc get xml dom first tag, <a><b></b></a>, get a
   */


  Element.prototype.getFirstTag = function () {
    var str = this.elementString;
    var firstTag = str.substr(0, str.indexOf(' '));

    if (firstTag == '' || firstTag.indexOf('>') > -1) {
      firstTag = str.substr(0, str.indexOf('>'));
    }

    firstTag = firstTag.substr(1, firstTag.length);
    return firstTag;
  };

  return Element;
}(xmloperation);

function combineIndexedColor(indexedColorsInner, indexedColors) {
  var ret = {};

  if (indexedColorsInner == null || indexedColorsInner.length == 0) {
    return indexedColors;
  }

  for (var key in indexedColors) {
    var value = indexedColors[key],
        kn = parseInt(key);
    var inner = indexedColorsInner[kn];

    if (inner == null) {
      ret[key] = value;
    } else {
      var rgb = inner.attributeList.rgb;
      ret[key] = rgb;
    }
  }

  return ret;
} //clrScheme:Element[]


function getColor(color, styles, type) {
  var attrList = color.attributeList;
  var clrScheme = styles['clrScheme'];
  var indexedColorsInner = styles['indexedColors'];
  styles['mruColors'];
  var indexedColorsList = combineIndexedColor(indexedColorsInner, indexedColors);
  var indexed = attrList.indexed,
      rgb = attrList.rgb,
      theme = attrList.theme,
      tint = attrList.tint;
  var bg;

  if (indexed != null) {
    var indexedNum = parseInt(indexed);
    bg = indexedColorsList[indexedNum];

    if (bg != null) {
      bg = bg.substring(bg.length - 6, bg.length);
      bg = '#' + bg;
    }
  } else if (rgb != null) {
    rgb = rgb.substring(rgb.length - 6, rgb.length);
    bg = '#' + rgb;
  } else if (theme != null) {
    var themeNum = parseInt(theme);

    if (themeNum == 0) {
      themeNum = 1;
    } else if (themeNum == 1) {
      themeNum = 0;
    } else if (themeNum == 2) {
      themeNum = 3;
    } else if (themeNum == 3) {
      themeNum = 2;
    }

    var clrSchemeElement = clrScheme[themeNum];

    if (clrSchemeElement != null) {
      var clrs = clrSchemeElement.getInnerElements('a:sysClr|a:srgbClr');

      if (clrs != null) {
        var clr = clrs[0];
        var clrAttrList = clr.attributeList; // console.log(clr.container, );

        if (clr.container.indexOf('sysClr') > -1) {
          // if(type=="g" && clrAttrList.val=="windowText"){
          //     bg = null;
          // }
          // else if((type=="t" || type=="b") && clrAttrList.val=="window"){
          //     bg = null;
          // }
          // else
          if (clrAttrList.lastClr != null) {
            bg = '#' + clrAttrList.lastClr;
          } else if (clrAttrList.val != null) {
            bg = '#' + clrAttrList.val;
          }
        } else if (clr.container.indexOf('srgbClr') > -1) {
          // console.log(clrAttrList.val);
          bg = '#' + clrAttrList.val;
        }
      }
    }
  }

  if (tint != null) {
    var tintNum = parseFloat(tint);

    if (bg != null) {
      bg = LightenDarkenColor(bg, tintNum);
    }
  }

  return bg;
}
/**
 * @dom xml attribute object
 * @attr attribute name
 * @d if attribute is null, return default value
 * @return attribute value
 */


function getlineStringAttr(frpr, attr) {
  var attrEle = frpr.getInnerElements(attr),
      value;

  if (attrEle != null && attrEle.length > 0) {
    if (attr == 'b' || attr == 'i' || attr == 'strike') {
      value = '1';
    } else if (attr == 'u') {
      var v = attrEle[0].attributeList.val;

      if (v == 'double') {
        value = '2';
      } else if (v == 'singleAccounting') {
        value = '3';
      } else if (v == 'doubleAccounting') {
        value = '4';
      } else {
        value = '1';
      }
    } else if (attr == 'vertAlign') {
      var v = attrEle[0].attributeList.val;

      if (v == 'subscript') {
        value = '1';
      } else if (v == 'superscript') {
        value = '2';
      }
    } else {
      value = attrEle[0].attributeList.val;
    }
  }

  return value;
}

var LuckyFileBase =
/** @class */
function () {
  function LuckyFileBase() {}

  return LuckyFileBase;
}();

var LuckySheetBase =
/** @class */
function () {
  function LuckySheetBase() {}

  return LuckySheetBase;
}();

var LuckyFileInfo =
/** @class */
function () {
  function LuckyFileInfo() {}

  return LuckyFileInfo;
}();

var LuckySheetCelldataBase =
/** @class */
function () {
  function LuckySheetCelldataBase() {}

  return LuckySheetCelldataBase;
}();

var LuckySheetCelldataValue =
/** @class */
function () {
  function LuckySheetCelldataValue() {}

  return LuckySheetCelldataValue;
}();

var LuckySheetCellFormat =
/** @class */
function () {
  function LuckySheetCellFormat() {}

  return LuckySheetCellFormat;
}();

var LuckyInlineString =
/** @class */
function () {
  function LuckyInlineString() {}

  return LuckyInlineString;
}();

var LuckyConfig =
/** @class */
function () {
  function LuckyConfig() {}

  return LuckyConfig;
}();

var LuckySheetborderInfoCellForImp =
/** @class */
function () {
  function LuckySheetborderInfoCellForImp() {}

  return LuckySheetborderInfoCellForImp;
}();

var LuckySheetborderInfoCellValue =
/** @class */
function () {
  function LuckySheetborderInfoCellValue() {}

  return LuckySheetborderInfoCellValue;
}();

var LuckySheetborderInfoCellValueStyle =
/** @class */
function () {
  function LuckySheetborderInfoCellValueStyle() {}

  return LuckySheetborderInfoCellValueStyle;
}();

var LuckySheetConfigMerge =
/** @class */
function () {
  function LuckySheetConfigMerge() {}

  return LuckySheetConfigMerge;
}();

var LuckysheetCalcChain =
/** @class */
function () {
  function LuckysheetCalcChain() {}

  return LuckysheetCalcChain;
}();

var LuckyImageBase =
/** @class */
function () {
  function LuckyImageBase() {}

  return LuckyImageBase;
}();

var LuckySheetCelldata =
/** @class */
function (_super) {
  __extends(LuckySheetCelldata, _super);

  function LuckySheetCelldata(cell, styles, sharedStrings, mergeCells, sheetFile, ReadXml) {
    var _this = //Private
    _super.call(this) || this;

    _this.cell = cell;
    _this.sheetFile = sheetFile;
    _this.styles = styles;
    _this.sharedStrings = sharedStrings;
    _this.readXml = ReadXml;
    _this.mergeCells = mergeCells;
    var attrList = cell.attributeList;
    var r = attrList.r,
        s = attrList.s,
        t = attrList.t;
    var range = getcellrange(r);
    _this.r = range.row[0];
    _this.c = range.column[0];
    _this.v = _this.generateValue(s, t);
    return _this;
  }
  /**
   * @param s Style index ,start 1
   * @param t Cell type, Optional value is ST_CellType, it's found at constat.ts
   */


  LuckySheetCelldata.prototype.generateValue = function (s, t) {
    var _this = this;

    var v = this.cell.getInnerElements('v');
    var f = this.cell.getInnerElements('f');

    if (v == null) {
      v = this.cell.getInnerElements('t');
    }

    var cellXfs = this.styles['cellXfs'];
    var cellStyleXfs = this.styles['cellStyleXfs'];
    this.styles['cellStyles'];
    var fonts = this.styles['fonts'];
    var fills = this.styles['fills'];
    var borders = this.styles['borders'];
    var numfmts = this.styles['numfmts'];
    var clrScheme = this.styles['clrScheme'];
    var sharedStrings = this.sharedStrings;
    var cellValue = new LuckySheetCelldataValue();

    if (f != null) {
      var formula = f[0],
          attrList = formula.attributeList;
      var t_1 = attrList.t,
          ref = attrList.ref,
          si = attrList.si;
      var formulaValue = f[0].value;

      if (t_1 == 'shared') {
        this._fomulaRef = ref;
        this._formulaType = t_1;
        this._formulaSi = si;
      } // console.log(ref, t, si);


      if (ref != null || formulaValue != null && formulaValue.length > 0) {
        formulaValue = escapeCharacter(formulaValue);
        cellValue.f = '=' + formulaValue;
      }
    }

    var familyFont = null;
    var quotePrefix;

    if (s != null) {
      var sNum = parseInt(s);
      var cellXf = cellXfs[sNum];
      var xfId = cellXf.attributeList.xfId;
      var numFmtId = void 0,
          fontId = void 0,
          fillId = void 0,
          borderId = void 0;
      var horizontal = void 0,
          vertical = void 0,
          wrapText = void 0,
          textRotation = void 0;

      if (xfId != null) {
        var cellStyleXf = cellStyleXfs[parseInt(xfId)];
        var attrList = cellStyleXf.attributeList;
        var applyNumberFormat_1 = attrList.applyNumberFormat;
        var applyFont_1 = attrList.applyFont;
        var applyFill_1 = attrList.applyFill;
        var applyBorder_1 = attrList.applyBorder;
        var applyAlignment_1 = attrList.applyAlignment;
        quotePrefix = attrList.quotePrefix;

        if (applyNumberFormat_1 != '0' && attrList.numFmtId != null) {
          // if(attrList.numFmtId!="0"){
          numFmtId = attrList.numFmtId; // }
        }

        if (applyFont_1 != '0' && attrList.fontId != null) {
          fontId = attrList.fontId;
        }

        if (applyFill_1 != '0' && attrList.fillId != null) {
          fillId = attrList.fillId;
        }

        if (applyBorder_1 != '0' && attrList.borderId != null) {
          borderId = attrList.borderId;
        }

        if (applyAlignment_1 != null && applyAlignment_1 != '0') {
          var alignment = cellStyleXf.getInnerElements('alignment');

          if (alignment != null) {
            var attrList_1 = alignment[0].attributeList;

            if (attrList_1.horizontal != null) {
              horizontal = attrList_1.horizontal;
            }

            if (attrList_1.vertical != null) {
              vertical = attrList_1.vertical;
            }

            if (attrList_1.wrapText != null) {
              wrapText = attrList_1.wrapText;
            }

            if (attrList_1.textRotation != null) {
              textRotation = attrList_1.textRotation;
            }

            if (attrList_1.shrinkToFit != null) ;
            if (attrList_1.indent != null) ;
          }
        }
      }

      var applyNumberFormat = cellXf.attributeList.applyNumberFormat;
      var applyFont = cellXf.attributeList.applyFont;
      var applyFill = cellXf.attributeList.applyFill;
      var applyBorder = cellXf.attributeList.applyBorder;
      var applyAlignment = cellXf.attributeList.applyAlignment;

      if (cellXf.attributeList.applyProtection != null) {
        cellXf.attributeList.applyProtection;
      }

      if (cellXf.attributeList.quotePrefix != null) {
        quotePrefix = cellXf.attributeList.quotePrefix;
      }

      if (applyNumberFormat != '0' && cellXf.attributeList.numFmtId != null) {
        numFmtId = cellXf.attributeList.numFmtId;
      }

      if (applyFont != '0') {
        fontId = cellXf.attributeList.fontId;
      }

      if (applyFill != '0') {
        fillId = cellXf.attributeList.fillId;
      }

      if (applyBorder != '0') {
        borderId = cellXf.attributeList.borderId;
      }

      if (applyAlignment != '0') {
        var alignment = cellXf.getInnerElements('alignment');

        if (alignment != null && alignment.length > 0) {
          var attrList = alignment[0].attributeList;

          if (attrList.horizontal != null) {
            horizontal = attrList.horizontal;
          }

          if (attrList.vertical != null) {
            vertical = attrList.vertical;
          }

          if (attrList.wrapText != null) {
            wrapText = attrList.wrapText;
          }

          if (attrList.textRotation != null) {
            textRotation = attrList.textRotation;
          }

          if (attrList.shrinkToFit != null) ;
          if (attrList.indent != null) ;
        }
      }

      if (numFmtId != undefined) {
        var numf = numfmts[parseInt(numFmtId)];
        var cellFormat = new LuckySheetCellFormat();
        cellFormat.fa = escapeCharacter(numf); // console.log(numf, numFmtId, this.v);

        cellFormat.t = t;
        cellValue.ct = cellFormat;
      }

      if (fillId != undefined) {
        var fillIdNum = parseInt(fillId);
        var fill = fills[fillIdNum]; // console.log(cellValue.v);

        var bg = this.getBackgroundByFill(fill, clrScheme);

        if (bg != null) {
          cellValue.bg = bg;
        }
      }

      if (fontId != undefined) {
        var fontIdNum = parseInt(fontId);
        var font = fonts[fontIdNum];

        if (font != null) {
          var sz = font.getInnerElements('sz'); //font size

          var colors = font.getInnerElements('color'); //font color

          var family = font.getInnerElements('name'); //font family

          var familyOverrides = font.getInnerElements('family'); //font family will be overrided by name

          font.getInnerElements('charset'); //font charset

          var bolds = font.getInnerElements('b'); //font bold

          var italics = font.getInnerElements('i'); //font italic

          var strikes = font.getInnerElements('strike'); //font italic

          var underlines = font.getInnerElements('u'); //font italic

          if (sz != null && sz.length > 0) {
            var fs = sz[0].attributeList.val;

            if (fs != null) {
              cellValue.fs = parseInt(fs);
            }
          }

          if (colors != null && colors.length > 0) {
            var color = colors[0];
            var fc = getColor(color, this.styles);

            if (fc != null) {
              cellValue.fc = fc;
            }
          }

          if (familyOverrides != null && familyOverrides.length > 0) {
            var val = familyOverrides[0].attributeList.val;

            if (val != null) {
              familyFont = fontFamilys[val];
            }
          }

          if (family != null && family.length > 0) {
            var val = family[0].attributeList.val;

            if (val != null) {
              cellValue.ff = val;
            }
          }

          if (bolds != null && bolds.length > 0) {
            var bold = bolds[0].attributeList.val;

            if (bold == '0') {
              cellValue.bl = 0;
            } else {
              cellValue.bl = 1;
            }
          }

          if (italics != null && italics.length > 0) {
            var italic = italics[0].attributeList.val;

            if (italic == '0') {
              cellValue.it = 0;
            } else {
              cellValue.it = 1;
            }
          }

          if (strikes != null && strikes.length > 0) {
            var strike = strikes[0].attributeList.val;

            if (strike == '0') {
              cellValue.cl = 0;
            } else {
              cellValue.cl = 1;
            }
          }

          if (underlines != null && underlines.length > 0) {
            var underline = underlines[0].attributeList.val;

            if (underline == 'single') {
              cellValue.un = 1;
            } else if (underline == 'double') {
              cellValue.un = 2;
            } else if (underline == 'singleAccounting') {
              cellValue.un = 3;
            } else if (underline == 'doubleAccounting') {
              cellValue.un = 4;
            } else {
              cellValue.un = 0;
            }
          }
        }
      } // vt: number | undefined//Vertical alignment, 0 middle, 1 up, 2 down, alignment
      // ht: number | undefined//Horizontal alignment,0 center, 1 left, 2 right, alignment
      // tr: number | undefined //Text rotation,0: 0、1: 45 、2: -45、3 Vertical text、4: 90 、5: -90, alignment
      // tb: number | undefined //Text wrap,0 truncation, 1 overflow, 2 word wrap, alignment


      if (horizontal != undefined) {
        //Horizontal alignment
        if (horizontal == 'center') {
          cellValue.ht = 0;
        } else if (horizontal == 'centerContinuous') {
          cellValue.ht = 0; //luckysheet unsupport
        } else if (horizontal == 'left') {
          cellValue.ht = 1;
        } else if (horizontal == 'right') {
          cellValue.ht = 2;
        } else if (horizontal == 'distributed') {
          cellValue.ht = 0; //luckysheet unsupport
        } else if (horizontal == 'fill') {
          cellValue.ht = 1; //luckysheet unsupport
        } else if (horizontal == 'general') {
          cellValue.ht = 1; //luckysheet unsupport
        } else if (horizontal == 'justify') {
          cellValue.ht = 0; //luckysheet unsupport
        } else {
          cellValue.ht = 1;
        }
      }

      if (vertical != undefined) {
        //Vertical alignment
        if (vertical == 'bottom') {
          cellValue.vt = 2;
        } else if (vertical == 'center') {
          cellValue.vt = 0;
        } else if (vertical == 'distributed') {
          cellValue.vt = 0; //luckysheet unsupport
        } else if (vertical == 'justify') {
          cellValue.vt = 0; //luckysheet unsupport
        } else if (vertical == 'top') {
          cellValue.vt = 1;
        } else {
          cellValue.vt = 1;
        }
      }

      if (wrapText != undefined) {
        if (wrapText == '1') {
          cellValue.tb = 2;
        } else {
          cellValue.tb = 1;
        }
      } else {
        cellValue.tb = 1;
      }

      if (textRotation != undefined) {
        // tr: number | undefined //Text rotation,0: 0、1: 45 、2: -45、3 Vertical text、4: 90 、5: -90, alignment
        if (textRotation == '255') {
          cellValue.tr = 3;
        } // else if(textRotation=="45"){
        //     cellValue.tr = 1;
        // }
        // else if(textRotation=="90"){
        //     cellValue.tr = 4;
        // }
        // else if(textRotation=="135"){
        //     cellValue.tr = 2;
        // }
        // else if(textRotation=="180"){
        //     cellValue.tr = 5;
        // }
        else {
          cellValue.tr = 0;
          cellValue.rt = parseInt(textRotation);
        }
      }

      if (borderId != undefined) {
        var borderIdNum = parseInt(borderId);
        var border = borders[borderIdNum]; // this._borderId = borderIdNum;

        var borderObject = new LuckySheetborderInfoCellForImp();
        borderObject.rangeType = 'cell'; // borderObject.cells = [];

        var borderCellValue = new LuckySheetborderInfoCellValue();
        borderCellValue.row_index = this.r;
        borderCellValue.col_index = this.c;
        var lefts = border.getInnerElements('left');
        var rights = border.getInnerElements('right');
        var tops = border.getInnerElements('top');
        var bottoms = border.getInnerElements('bottom');
        var diagonals = border.getInnerElements('diagonal');
        var starts = border.getInnerElements('start');
        var ends = border.getInnerElements('end');
        var left = this.getBorderInfo(lefts);
        var right = this.getBorderInfo(rights);
        var top_1 = this.getBorderInfo(tops);
        var bottom = this.getBorderInfo(bottoms);
        this.getBorderInfo(diagonals);
        var start = this.getBorderInfo(starts);
        var end = this.getBorderInfo(ends);
        var isAdd = false;

        if (start != null && start.color != null) {
          borderCellValue.l = start;
          isAdd = true;
        }

        if (end != null && end.color != null) {
          borderCellValue.r = end;
          isAdd = true;
        }

        if (left != null && left.color != null) {
          borderCellValue.l = left;
          isAdd = true;
        }

        if (right != null && right.color != null) {
          borderCellValue.r = right;
          isAdd = true;
        }

        if (top_1 != null && top_1.color != null) {
          borderCellValue.t = top_1;
          isAdd = true;
        }

        if (bottom != null && bottom.color != null) {
          borderCellValue.b = bottom;
          isAdd = true;
        }

        if (isAdd) {
          borderObject.value = borderCellValue; // this.config._borderInfo[borderId] = borderObject;

          this._borderObject = borderObject;
        }
      }
    } else {
      cellValue.tb = 1;
    }

    if (v != null) {
      var value = v[0].value;

      if (/&#\d+;/.test(value)) {
        value = this.htmlDecode(value);
      }

      if (t == ST_CellType['SharedString']) {
        var siIndex = parseInt(v[0].value);
        var sharedSI = sharedStrings[siIndex];
        var rFlag = sharedSI.getInnerElements('r');

        if (rFlag == null) {
          var tFlag = sharedSI.getInnerElements('t');

          if (tFlag != null) {
            var text_1 = '';
            tFlag.forEach(function (t) {
              text_1 += t.value;
            });
            text_1 = escapeCharacter(text_1); //isContainMultiType(text) &&

            if (familyFont == 'Roman' && text_1.length > 0) {
              var textArray = text_1.split('');
              var preWordType = null,
                  wordText = '',
                  preWholef = null;
              var wholef = 'Times New Roman';

              if (cellValue.ff != null) {
                wholef = cellValue.ff;
              }

              var cellFormat = cellValue.ct;

              if (cellFormat == null) {
                cellFormat = new LuckySheetCellFormat();
              }

              if (cellFormat.s == null) {
                cellFormat.s = [];
              }

              for (var i = 0; i < textArray.length; i++) {
                var w = textArray[i];
                var type = null,
                    ff = wholef;

                if (isChinese(w)) {
                  type = 'c';
                  ff = '宋体';
                } else if (isJapanese(w)) {
                  type = 'j';
                  ff = 'Yu Gothic';
                } else if (isKoera(w)) {
                  type = 'k';
                  ff = 'Malgun Gothic';
                } else {
                  type = 'e';
                }

                if (type != preWordType && preWordType != null || i == textArray.length - 1) {
                  var InlineString = new LuckyInlineString();
                  InlineString.ff = preWholef;

                  if (cellValue.fc != null) {
                    InlineString.fc = cellValue.fc;
                  }

                  if (cellValue.fs != null) {
                    InlineString.fs = cellValue.fs;
                  }

                  if (cellValue.cl != null) {
                    InlineString.cl = cellValue.cl;
                  }

                  if (cellValue.un != null) {
                    InlineString.un = cellValue.un;
                  }

                  if (cellValue.bl != null) {
                    InlineString.bl = cellValue.bl;
                  }

                  if (cellValue.it != null) {
                    InlineString.it = cellValue.it;
                  }

                  if (i == textArray.length - 1) {
                    if (type == preWordType) {
                      InlineString.ff = ff;
                      InlineString.v = wordText + w;
                    } else {
                      InlineString.ff = preWholef;
                      InlineString.v = wordText;
                      cellFormat.s.push(InlineString);
                      var InlineStringLast = new LuckyInlineString();
                      InlineStringLast.ff = ff;
                      InlineStringLast.v = w;

                      if (cellValue.fc != null) {
                        InlineStringLast.fc = cellValue.fc;
                      }

                      if (cellValue.fs != null) {
                        InlineStringLast.fs = cellValue.fs;
                      }

                      if (cellValue.cl != null) {
                        InlineStringLast.cl = cellValue.cl;
                      }

                      if (cellValue.un != null) {
                        InlineStringLast.un = cellValue.un;
                      }

                      if (cellValue.bl != null) {
                        InlineStringLast.bl = cellValue.bl;
                      }

                      if (cellValue.it != null) {
                        InlineStringLast.it = cellValue.it;
                      }

                      cellFormat.s.push(InlineStringLast);
                      break;
                    }
                  } else {
                    InlineString.v = wordText;
                  }

                  cellFormat.s.push(InlineString);
                  wordText = w;
                } else {
                  wordText += w;
                }

                preWordType = type;
                preWholef = ff;
              }

              cellFormat.t = 'inlineStr'; // cellFormat.s = [InlineString];

              cellValue.ct = cellFormat; // console.log(cellValue);
            } else {
              text_1 = this.replaceSpecialWrap(text_1);

              if (text_1.indexOf('\r\n') > -1 || text_1.indexOf('\n') > -1) {
                var InlineString = new LuckyInlineString();
                InlineString.v = text_1;
                var cellFormat = cellValue.ct;

                if (cellFormat == null) {
                  cellFormat = new LuckySheetCellFormat();
                }

                if (cellValue.ff != null) {
                  InlineString.ff = cellValue.ff;
                }

                if (cellValue.fc != null) {
                  InlineString.fc = cellValue.fc;
                }

                if (cellValue.fs != null) {
                  InlineString.fs = cellValue.fs;
                }

                if (cellValue.cl != null) {
                  InlineString.cl = cellValue.cl;
                }

                if (cellValue.un != null) {
                  InlineString.un = cellValue.un;
                }

                if (cellValue.bl != null) {
                  InlineString.bl = cellValue.bl;
                }

                if (cellValue.it != null) {
                  InlineString.it = cellValue.it;
                }

                cellFormat.t = 'inlineStr';
                cellFormat.s = [InlineString];
                cellValue.ct = cellFormat;
              } else {
                cellValue.v = text_1;
                quotePrefix = '1';
              }
            }
          }
        } else {
          var styles_1 = [];
          rFlag.forEach(function (r) {
            var tFlag = r.getInnerElements('t');
            var rPr = r.getInnerElements('rPr');
            var InlineString = new LuckyInlineString();

            if (tFlag != null && tFlag.length > 0) {
              var text = tFlag[0].value;
              text = _this.replaceSpecialWrap(text);
              text = escapeCharacter(text);
              InlineString.v = text;
            }

            if (rPr != null && rPr.length > 0) {
              var frpr = rPr[0];
              var sz = getlineStringAttr(frpr, 'sz'),
                  rFont = getlineStringAttr(frpr, 'rFont');
              getlineStringAttr(frpr, 'family');
              getlineStringAttr(frpr, 'charset');
              getlineStringAttr(frpr, 'scheme');
              var b = getlineStringAttr(frpr, 'b'),
                  i = getlineStringAttr(frpr, 'i'),
                  u = getlineStringAttr(frpr, 'u'),
                  strike = getlineStringAttr(frpr, 'strike'),
                  vertAlign = getlineStringAttr(frpr, 'vertAlign'),
                  color = void 0;
              var cEle = frpr.getInnerElements('color');

              if (cEle != null && cEle.length > 0) {
                color = getColor(cEle[0], _this.styles);
              }

              var ff = void 0; // if(family!=null){
              //     ff = fontFamilys[family];
              // }

              if (rFont != null) {
                ff = rFont;
              }

              if (ff != null) {
                InlineString.ff = ff;
              } else if (cellValue.ff != null) {
                InlineString.ff = cellValue.ff;
              }

              if (color != null) {
                InlineString.fc = color;
              } else if (cellValue.fc != null) {
                InlineString.fc = cellValue.fc;
              }

              if (sz != null) {
                InlineString.fs = parseInt(sz);
              } else if (cellValue.fs != null) {
                InlineString.fs = cellValue.fs;
              }

              if (strike != null) {
                InlineString.cl = parseInt(strike);
              } else if (cellValue.cl != null) {
                InlineString.cl = cellValue.cl;
              }

              if (u != null) {
                InlineString.un = parseInt(u);
              } else if (cellValue.un != null) {
                InlineString.un = cellValue.un;
              }

              if (b != null) {
                InlineString.bl = parseInt(b);
              } else if (cellValue.bl != null) {
                InlineString.bl = cellValue.bl;
              }

              if (i != null) {
                InlineString.it = parseInt(i);
              } else if (cellValue.it != null) {
                InlineString.it = cellValue.it;
              }

              if (vertAlign != null) {
                InlineString.va = parseInt(vertAlign);
              } // ff:string | undefined //font family
              // fc:string | undefined//font color
              // fs:number | undefined//font size
              // cl:number | undefined//strike
              // un:number | undefined//underline
              // bl:number | undefined//blod
              // it:number | undefined//italic
              // v:string | undefined

            } else {
              if (InlineString.ff == null && cellValue.ff != null) {
                InlineString.ff = cellValue.ff;
              }

              if (InlineString.fc == null && cellValue.fc != null) {
                InlineString.fc = cellValue.fc;
              }

              if (InlineString.fs == null && cellValue.fs != null) {
                InlineString.fs = cellValue.fs;
              }

              if (InlineString.cl == null && cellValue.cl != null) {
                InlineString.cl = cellValue.cl;
              }

              if (InlineString.un == null && cellValue.un != null) {
                InlineString.un = cellValue.un;
              }

              if (InlineString.bl == null && cellValue.bl != null) {
                InlineString.bl = cellValue.bl;
              }

              if (InlineString.it == null && cellValue.it != null) {
                InlineString.it = cellValue.it;
              }
            }

            styles_1.push(InlineString);
          });
          var cellFormat = cellValue.ct;

          if (cellFormat == null) {
            cellFormat = new LuckySheetCellFormat();
          }

          cellFormat.t = 'inlineStr';
          cellFormat.s = styles_1;
          cellValue.ct = cellFormat;
        }
      } // else if(t==ST_CellType["InlineString"] && v!=null){
      // }
      else {
        value = escapeCharacter(value);
        cellValue.v = value;
      }
    }

    if (quotePrefix != null) {
      cellValue.qp = parseInt(quotePrefix);
    }

    return cellValue;
  };

  LuckySheetCelldata.prototype.replaceSpecialWrap = function (text) {
    text = text.replace(/_x000D_/g, '').replace(/&#13;&#10;/g, '\r\n').replace(/&#13;/g, '\r').replace(/&#10;/g, '\n');
    return text;
  };

  LuckySheetCelldata.prototype.getBackgroundByFill = function (fill, clrScheme) {
    var patternFills = fill.getInnerElements('patternFill');

    if (patternFills != null) {
      var patternFill = patternFills[0];
      var fgColors = patternFill.getInnerElements('fgColor');
      var bgColors = patternFill.getInnerElements('bgColor');
      var fg = void 0,
          bg = void 0;

      if (fgColors != null) {
        var fgColor = fgColors[0];
        fg = getColor(fgColor, this.styles);
      }

      if (bgColors != null) {
        var bgColor = bgColors[0];
        bg = getColor(bgColor, this.styles);
      } // console.log(fgColors,bgColors,clrScheme);


      if (fg != null) {
        return fg;
      } else if (bg != null) {
        return bg;
      }
    } else {
      var gradientfills = fill.getInnerElements('gradientFill');

      if (gradientfills != null) {
        //graient color fill handler
        return null;
      }
    }
  };

  LuckySheetCelldata.prototype.getBorderInfo = function (borders) {
    if (borders == null) {
      return null;
    }

    var border = borders[0],
        attrList = border.attributeList;
    this.styles['clrScheme'];
    var style = attrList.style;

    if (style == null || style == 'none') {
      return null;
    }

    var colors = border.getInnerElements('color');
    var colorRet = '#000000';

    if (colors != null) {
      var color = colors[0];
      colorRet = getColor(color, this.styles);

      if (colorRet == null) {
        colorRet = '#000000';
      }
    }

    var ret = new LuckySheetborderInfoCellValueStyle();
    ret.style = borderTypes[style];
    ret.color = colorRet;
    return ret;
  };

  LuckySheetCelldata.prototype.htmlDecode = function (str) {
    return str.replace(/&#(x)?([^&]{1,5});?/g, function ($, $1, $2) {
      return String.fromCharCode(parseInt($2, $1 ? 16 : 10));
    });
  };

  return LuckySheetCelldata;
}(LuckySheetCelldataBase);

var alphabets = ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z'];
/** index number 2 letters
 * @example stringAt(26) ==> 'AA'
 * @date 2019-10-10
 * @export
 * @param {number} index
 * @returns {string}
 */

function stringAt(index) {
  var str = '';
  var cindex = index;

  while (cindex >= alphabets.length) {
    cindex /= alphabets.length;
    cindex -= 1;
    str += alphabets[cindex % alphabets.length];
  }

  var last = index % alphabets.length;
  str += alphabets[last];
  return str;
}
/** translate XY-tag to A1-tag
 * @example x,y => B10
 * @date 2019-10-10
 * @export
 * @param {number} x
 * @param {number} y
 * @returns {tagA1}
 */


function xy2expr(x, y) {
  return '' + stringAt(x) + (y + 1);
}

var LuckySheet =
/** @class */
function (_super) {
  __extends(LuckySheet, _super);

  function LuckySheet(sheetName, sheetId, sheetOrder, isInitialCell, allFileOption) {
    if (isInitialCell === void 0) {
      isInitialCell = false;
    }

    var _this = //Private
    _super.call(this) || this;

    _this.isInitialCell = isInitialCell;
    _this.readXml = allFileOption.readXml;
    _this.sheetFile = allFileOption.sheetFile;
    _this.styles = allFileOption.styles;
    _this.sharedStrings = allFileOption.sharedStrings;
    _this.calcChainEles = allFileOption.calcChain;
    _this.sheetList = allFileOption.sheetList;
    _this.imageList = allFileOption.imageList; //Output

    _this.name = sheetName;
    _this.index = sheetId;
    _this.order = sheetOrder.toString();
    _this.config = new LuckyConfig();
    _this.celldata = [];
    _this.mergeCells = _this.readXml.getElementsByTagName('mergeCells/mergeCell', _this.sheetFile);
    _this.styles['clrScheme'];

    var sheetView = _this.readXml.getElementsByTagName('sheetViews/sheetView', _this.sheetFile);

    var showGridLines = '1',
        tabSelected = '0',
        zoomScale = '100',
        activeCell = 'A1',
        freeze = '';

    if (sheetView.length > 0) {
      var attrList = sheetView[0].attributeList;
      showGridLines = getXmlAttibute(attrList, 'showGridLines', '1');
      tabSelected = getXmlAttibute(attrList, 'tabSelected', '0');
      zoomScale = getXmlAttibute(attrList, 'zoomScale', '100'); // let colorId = getXmlAttibute(attrList, "colorId", "0");

      var selections = sheetView[0].getInnerElements('selection');

      if (selections != null && selections.length > 0) {
        activeCell = getXmlAttibute(selections[0].attributeList, 'activeCell', 'A1');
        var range = getcellrange(activeCell, _this.sheetList, sheetId);
        _this.luckysheet_select_save = [];

        _this.luckysheet_select_save.push(range);
      }

      var panes = sheetView[0].getInnerElements('pane');

      if (panes != null && panes.length > 0) {
        var xSplit = getXmlAttibute(panes[0].attributeList, 'xSplit', '0');
        var ySplit = getXmlAttibute(panes[0].attributeList, 'ySplit', '0');
        freeze = xy2expr(parseInt(xSplit), parseInt(ySplit));
      }
    }

    _this.showGridLines = showGridLines;
    _this.freeze = freeze;
    _this.status = tabSelected;
    _this.zoomRatio = parseInt(zoomScale) / 100;

    var tabColors = _this.readXml.getElementsByTagName('sheetPr/tabColor', _this.sheetFile);

    if (tabColors != null && tabColors.length > 0) {
      var tabColor = tabColors[0],
          attrList = tabColor.attributeList; // if(attrList.rgb!=null){

      var tc = getColor(tabColor, _this.styles);
      _this.color = tc; // }
    }

    var sheetFormatPr = _this.readXml.getElementsByTagName('sheetFormatPr', _this.sheetFile);

    var defaultColWidth, defaultRowHeight;

    if (sheetFormatPr.length > 0) {
      var attrList = sheetFormatPr[0].attributeList;
      defaultColWidth = getXmlAttibute(attrList, 'defaultColWidth', '9.21');
      defaultRowHeight = getXmlAttibute(attrList, 'defaultRowHeight', '19');
    }

    _this.defaultColWidth = getColumnWidthPixel(parseFloat(defaultColWidth));
    _this.defaultRowHeight = getRowHeightPixel(parseFloat(defaultRowHeight));

    _this.generateConfigColumnLenAndHidden();

    var cellOtherInfo = _this.generateConfigRowLenAndHiddenAddCell();

    if (_this.formulaRefList != null) {
      for (var key in _this.formulaRefList) {
        var funclist = _this.formulaRefList[key];
        var mainFunc = funclist['mainRef'],
            mainCellValue = mainFunc.cellValue;
        var formulaTxt = mainFunc.fv;
        var mainR = mainCellValue.r,
            mainC = mainCellValue.c; // let refRange = getcellrange(ref);

        for (var name_1 in funclist) {
          if (name_1 == 'mainRef') {
            continue;
          }

          var funcValue = funclist[name_1],
              cellValue = funcValue.cellValue;

          if (cellValue == null) {
            continue;
          }

          var r = cellValue.r,
              c = cellValue.c;
          var func = formulaTxt;
          var offsetRow = r - mainR,
              offsetCol = c - mainC;

          if (offsetRow > 0) {
            func = '=' + fromulaRef.functionCopy(func, 'down', offsetRow);
          } else if (offsetRow < 0) {
            func = '=' + fromulaRef.functionCopy(func, 'up', Math.abs(offsetRow));
          }

          if (offsetCol > 0) {
            func = '=' + fromulaRef.functionCopy(func, 'right', offsetCol);
          } else if (offsetCol < 0) {
            func = '=' + fromulaRef.functionCopy(func, 'left', Math.abs(offsetCol));
          } // console.log(offsetRow, offsetCol, func);


          cellValue.v.f = func;
        }
      }
    }

    if (_this.calcChain == null) {
      _this.calcChain = [];
    }

    var formulaListExist = {};

    for (var c = 0; c < _this.calcChainEles.length; c++) {
      var calcChainEle = _this.calcChainEles[c],
          attrList = calcChainEle.attributeList;

      if (attrList.i != sheetId) {
        continue;
      }

      var r = attrList.r,
          i = attrList.i;
      attrList.l;
      attrList.s;
      attrList.a;
      attrList.t;
      var range = getcellrange(r);
      var chain = new LuckysheetCalcChain();
      chain.r = range.row[0];
      chain.c = range.column[0];
      chain.index = _this.index;

      _this.calcChain.push(chain);

      formulaListExist['r' + r + 'c' + c] = null;
    } //There may be formulas that do not appear in calcChain


    for (var key in cellOtherInfo.formulaList) {
      if (!(key in formulaListExist)) {
        var formulaListItem = cellOtherInfo.formulaList[key];
        var chain = new LuckysheetCalcChain();
        chain.r = formulaListItem.r;
        chain.c = formulaListItem.c;
        chain.index = _this.index;

        _this.calcChain.push(chain);
      }
    }

    if (_this.mergeCells != null) {
      for (var i = 0; i < _this.mergeCells.length; i++) {
        var merge = _this.mergeCells[i],
            attrList = merge.attributeList;
        var ref = attrList.ref;

        if (ref == null) {
          continue;
        }

        var range = getcellrange(ref, _this.sheetList, sheetId);
        var mergeValue = new LuckySheetConfigMerge();
        mergeValue.r = range.row[0];
        mergeValue.c = range.column[0];
        mergeValue.rs = range.row[1] - range.row[0] + 1;
        mergeValue.cs = range.column[1] - range.column[0] + 1;

        if (_this.config.merge == null) {
          _this.config.merge = {};
        }

        _this.config.merge[range.row[0] + '_' + range.column[0]] = mergeValue;
      }
    }

    var file_name = _this.sheetFile.replace(/(.*\/)*([^.]+).*/gi, '$2');

    var sheetRelsPath = 'xl/worksheets/_rels/' + file_name + '.xml.rels';

    var sheetRels = _this.readXml.getElementsByTagName('Relationships/Relationship', sheetRelsPath);

    sheetRels.find(function (o) {
      var attrList = o.attributeList;
      var target = getXmlAttibute(attrList, 'Target', '');

      if (target.indexOf('comments') > -1) {
        var nPath = 'xl/' + target.replace('../', '');
        var comments_1 = [];

        var commentList = _this.readXml.getElementsByTagName('comments/commentList/comment', nPath);

        commentList.forEach(function (comment) {
          var attrList = comment.attributeList;
          var ref = getXmlAttibute(attrList, 'ref', '');
          var tempCooment = {
            ref: ref,
            rows: []
          };
          (comment.getInnerElements('text')[0].getInnerElements('r') || []).forEach(function (r) {
            var rpr = r.getInnerElements('rPr')[0];
            var row = {
              sz: '',
              rFont: '',
              charset: '',
              text: ''
            };
            row.sz = getXmlAttibute((rpr.getInnerElements('sz') || [{
              attributeList: {}
            }])[0].attributeList, 'val', '');
            row.rFont = getXmlAttibute((rpr.getInnerElements('rFont') || [{
              attributeList: {}
            }])[0].attributeList, 'val', '');
            row.charset = getXmlAttibute((rpr.getInnerElements('charset') || [{
              attributeList: {}
            }])[0].attributeList, 'val', '');
            row.text = r.getInnerElements('t')[0].value;
            tempCooment.rows.push(row);
          });
          comments_1.push(tempCooment);
        });
        _this.comments = comments_1;
      }
    });
    var drawingFile = allFileOption.drawingFile,
        drawingRelsFile = allFileOption.drawingRelsFile;

    if (drawingFile != null && drawingRelsFile != null) {
      var twoCellAnchors = _this.readXml.getElementsByTagName('xdr:twoCellAnchor', drawingFile);

      if (twoCellAnchors != null && twoCellAnchors.length > 0) {
        for (var i = 0; i < twoCellAnchors.length; i++) {
          var twoCellAnchor = twoCellAnchors[i];
          var editAs = getXmlAttibute(twoCellAnchor.attributeList, 'editAs', 'twoCell');
          var xdrFroms = twoCellAnchor.getInnerElements('xdr:from'),
              xdrTos = twoCellAnchor.getInnerElements('xdr:to');
          var xdr_blipfills = twoCellAnchor.getInnerElements('a:blip');

          if (xdrFroms != null && xdr_blipfills != null && xdrFroms.length > 0 && xdr_blipfills.length > 0) {
            var xdrFrom = xdrFroms[0],
                xdrTo = xdrTos[0],
                xdr_blipfill = xdr_blipfills[0];
            var rembed = getXmlAttibute(xdr_blipfill.attributeList, 'r:embed', null);

            var imageObject = _this.getBase64ByRid(rembed, drawingRelsFile); // let aoff = xdr_xfrm.getInnerElements("a:off"), aext = xdr_xfrm.getInnerElements("a:ext");
            // if(aoff!=null && aext!=null && aoff.length>0 && aext.length>0){
            //     let aoffAttribute = aoff[0].attributeList, aextAttribute = aext[0].attributeList;
            //     let x = getXmlAttibute(aoffAttribute, "x", null);
            //     let y = getXmlAttibute(aoffAttribute, "y", null);
            //     let cx = getXmlAttibute(aextAttribute, "cx", null);
            //     let cy = getXmlAttibute(aextAttribute, "cy", null);
            //     if(x!=null && y!=null && cx!=null && cy!=null && imageObject !=null){
            // let x_n = getPxByEMUs(parseInt(x), "c"),y_n = getPxByEMUs(parseInt(y));
            // let cx_n = getPxByEMUs(parseInt(cx), "c"),cy_n = getPxByEMUs(parseInt(cy));


            var x_n = 0,
                y_n = 0;
            var cx_n = 0,
                cy_n = 0;
            imageObject.fromCol = _this.getXdrValue(xdrFrom.getInnerElements('xdr:col'));
            imageObject.fromColOff = getPxByEMUs(_this.getXdrValue(xdrFrom.getInnerElements('xdr:colOff')));
            imageObject.fromRow = _this.getXdrValue(xdrFrom.getInnerElements('xdr:row'));
            imageObject.fromRowOff = getPxByEMUs(_this.getXdrValue(xdrFrom.getInnerElements('xdr:rowOff')));
            imageObject.toCol = _this.getXdrValue(xdrTo.getInnerElements('xdr:col'));
            imageObject.toColOff = getPxByEMUs(_this.getXdrValue(xdrTo.getInnerElements('xdr:colOff')));
            imageObject.toRow = _this.getXdrValue(xdrTo.getInnerElements('xdr:row'));
            imageObject.toRowOff = getPxByEMUs(_this.getXdrValue(xdrTo.getInnerElements('xdr:rowOff')));
            imageObject.originWidth = cx_n;
            imageObject.originHeight = cy_n;

            if (editAs == 'absolute') {
              imageObject.type = '3';
            } else if (editAs == 'oneCell') {
              imageObject.type = '2';
            } else {
              imageObject.type = '1';
            }

            imageObject.isFixedPos = false;
            imageObject.fixedLeft = 0;
            imageObject.fixedTop = 0;
            var imageBorder = {
              color: '#000',
              radius: 0,
              style: 'solid',
              width: 0
            };
            imageObject.border = imageBorder;
            var imageCrop = {
              height: cy_n,
              offsetLeft: 0,
              offsetTop: 0,
              width: cx_n
            };
            imageObject.crop = imageCrop;
            var imageDefault = {
              height: cy_n,
              left: x_n,
              top: y_n,
              width: cx_n
            };
            imageObject.default = imageDefault;

            if (_this.images == null) {
              _this.images = {};
            }

            _this.images[generateRandomIndex('image')] = imageObject; //     }
            // }
          }
        }
      }
    }

    return _this;
  }

  LuckySheet.prototype.getXdrValue = function (ele) {
    if (ele == null || ele.length == 0) {
      return null;
    }

    return parseInt(ele[0].value);
  };

  LuckySheet.prototype.getBase64ByRid = function (rid, drawingRelsFile) {
    var Relationships = this.readXml.getElementsByTagName('Relationships/Relationship', drawingRelsFile);

    if (Relationships != null && Relationships.length > 0) {
      for (var i = 0; i < Relationships.length; i++) {
        var Relationship = Relationships[i];
        var attrList = Relationship.attributeList;
        var Id = getXmlAttibute(attrList, 'Id', null);
        var src = getXmlAttibute(attrList, 'Target', null);

        if (Id == rid) {
          src = src.replace(/\.\.\//g, '');
          src = 'xl/' + src;
          var imgage = this.imageList.getImageByName(src);
          return imgage;
        }
      }
    }

    return null;
  };
  /**
   * @desc This will convert cols/col to luckysheet config of column'width
   */


  LuckySheet.prototype.generateConfigColumnLenAndHidden = function () {
    var cols = this.readXml.getElementsByTagName('cols/col', this.sheetFile);

    for (var i = 0; i < cols.length; i++) {
      var col = cols[i],
          attrList = col.attributeList;
      var min = getXmlAttibute(attrList, 'min', null);
      var max = getXmlAttibute(attrList, 'max', null);
      var width = getXmlAttibute(attrList, 'width', null);
      var hidden = getXmlAttibute(attrList, 'hidden', null);
      var customWidth = getXmlAttibute(attrList, 'customWidth', null);

      if (min == null || max == null) {
        continue;
      }

      var minNum = parseInt(min) - 1,
          maxNum = parseInt(max) - 1,
          widthNum = parseFloat(width);

      for (var m = minNum; m <= maxNum; m++) {
        if (width != null) {
          if (this.config.columnlen == null) {
            this.config.columnlen = {};
          }

          this.config.columnlen[m] = getColumnWidthPixel(widthNum);
        }

        if (hidden == '1') {
          if (this.config.colhidden == null) {
            this.config.colhidden = {};
          }

          this.config.colhidden[m] = 0;

          if (this.config.columnlen) {
            delete this.config.columnlen[m];
          }
        }

        if (customWidth != null) {
          if (this.config.customWidth == null) {
            this.config.customWidth = {};
          }

          this.config.customWidth[m] = 1;
        }
      }
    }
  };
  /**
   * @desc This will convert cols/col to luckysheet config of column'width
   */


  LuckySheet.prototype.generateConfigRowLenAndHiddenAddCell = function () {
    var rows = this.readXml.getElementsByTagName('sheetData/row', this.sheetFile);
    var cellOtherInfo = {};
    var formulaList = {};
    cellOtherInfo.formulaList = formulaList;

    for (var i = 0; i < rows.length; i++) {
      var row = rows[i],
          attrList = row.attributeList;
      var rowNo = getXmlAttibute(attrList, 'r', null);
      var height = getXmlAttibute(attrList, 'ht', null);
      var hidden = getXmlAttibute(attrList, 'hidden', null);
      var customHeight = getXmlAttibute(attrList, 'customHeight', null);

      if (rowNo == null) {
        continue;
      }

      var rowNoNum = parseInt(rowNo) - 1;

      if (height != null) {
        var heightNum = parseFloat(height);

        if (this.config.rowlen == null) {
          this.config.rowlen = {};
        }

        this.config.rowlen[rowNoNum] = getRowHeightPixel(heightNum);
      }

      if (hidden == '1') {
        if (this.config.rowhidden == null) {
          this.config.rowhidden = {};
        }

        this.config.rowhidden[rowNoNum] = 0;

        if (this.config.rowlen) {
          delete this.config.rowlen[rowNoNum];
        }
      }

      if (customHeight != null) {
        if (this.config.customHeight == null) {
          this.config.customHeight = {};
        }

        this.config.customHeight[rowNoNum] = 1;
      }

      if (this.isInitialCell) {
        var cells = row.getInnerElements('c');

        for (var key in cells) {
          var cell = cells[key];
          var cellValue = new LuckySheetCelldata(cell, this.styles, this.sharedStrings, this.mergeCells, this.sheetFile, this.readXml);

          if (cellValue._borderObject != null) {
            if (this.config.borderInfo == null) {
              this.config.borderInfo = [];
            }

            this.config.borderInfo.push(cellValue._borderObject);
            delete cellValue._borderObject;
          } // let borderId = cellValue._borderId;
          // if(borderId!=null){
          //     let borders = this.styles["borders"] as Element[];
          //     if(this.config._borderInfo==null){
          //         this.config._borderInfo = {};
          //     }
          //     if( borderId in this.config._borderInfo){
          //         this.config._borderInfo[borderId].cells.push(cellValue.r + "_" + cellValue.c);
          //     }
          //     else{
          //         let border = borders[borderId];
          //         let borderObject = new LuckySheetborderInfoCellForImp();
          //         borderObject.rangeType = "cellGroup";
          //         borderObject.cells = [];
          //         let borderCellValue = new LuckySheetborderInfoCellValue();
          //         let lefts = border.getInnerElements("left");
          //         let rights = border.getInnerElements("right");
          //         let tops = border.getInnerElements("top");
          //         let bottoms = border.getInnerElements("bottom");
          //         let diagonals = border.getInnerElements("diagonal");
          //         let left = this.getBorderInfo(lefts);
          //         let right = this.getBorderInfo(rights);
          //         let top = this.getBorderInfo(tops);
          //         let bottom = this.getBorderInfo(bottoms);
          //         let diagonal = this.getBorderInfo(diagonals);
          //         let isAdd = false;
          //         if(left!=null && left.color!=null){
          //             borderCellValue.l = left;
          //             isAdd = true;
          //         }
          //         if(right!=null && right.color!=null){
          //             borderCellValue.r = right;
          //             isAdd = true;
          //         }
          //         if(top!=null && top.color!=null){
          //             borderCellValue.t = top;
          //             isAdd = true;
          //         }
          //         if(bottom!=null && bottom.color!=null){
          //             borderCellValue.b = bottom;
          //             isAdd = true;
          //         }
          //         if(isAdd){
          //             borderObject.value = borderCellValue;
          //             this.config._borderInfo[borderId] = borderObject;
          //         }
          //     }
          // }


          if (cellValue._formulaType == 'shared') {
            if (this.formulaRefList == null) {
              this.formulaRefList = {};
            }

            if (this.formulaRefList[cellValue._formulaSi] == null) {
              this.formulaRefList[cellValue._formulaSi] = {};
            }

            var fv = void 0;

            if (cellValue.v != null) {
              fv = cellValue.v.f;
            }

            var refValue = {
              t: cellValue._formulaType,
              ref: cellValue._fomulaRef,
              si: cellValue._formulaSi,
              fv: fv,
              cellValue: cellValue
            };

            if (cellValue._fomulaRef != null) {
              this.formulaRefList[cellValue._formulaSi]['mainRef'] = refValue;
            } else {
              this.formulaRefList[cellValue._formulaSi][cellValue.r + '_' + cellValue.c] = refValue;
            } // console.log(refValue, this.formulaRefList);

          } //There may be formulas that do not appear in calcChain


          if (cellValue.v != null && cellValue.v.f != null) {
            var formulaCell = {
              r: cellValue.r,
              c: cellValue.c
            };
            cellOtherInfo.formulaList['r' + cellValue.r + 'c' + cellValue.c] = formulaCell;
          }

          this.celldata.push(cellValue);
        }
      }
    }

    return cellOtherInfo;
  };

  return LuckySheet;
}(LuckySheetBase);

var UDOC = {};
UDOC.G = {
  concat: function concat(p, r) {
    for (var i = 0; i < r.cmds.length; i++) {
      p.cmds.push(r.cmds[i]);
    }

    for (var i = 0; i < r.crds.length; i++) {
      p.crds.push(r.crds[i]);
    }
  },
  getBB: function getBB(ps) {
    var x0 = 1e99,
        y0 = 1e99,
        x1 = -x0,
        y1 = -y0;

    for (var i = 0; i < ps.length; i += 2) {
      var x = ps[i],
          y = ps[i + 1];
      if (x < x0) x0 = x;else if (x > x1) x1 = x;
      if (y < y0) y0 = y;else if (y > y1) y1 = y;
    }

    return [x0, y0, x1, y1];
  },
  rectToPath: function rectToPath(r) {
    return {
      cmds: ['M', 'L', 'L', 'L', 'Z'],
      crds: [r[0], r[1], r[2], r[1], r[2], r[3], r[0], r[3]]
    };
  },
  // a inside b
  insideBox: function insideBox(a, b) {
    return b[0] <= a[0] && b[1] <= a[1] && a[2] <= b[2] && a[3] <= b[3];
  },
  isBox: function isBox(p, bb) {
    var sameCrd8 = function sameCrd8(pcrd, crds) {
      for (var o = 0; o < 8; o += 2) {
        var eq = true;

        for (var j = 0; j < 8; j++) {
          if (Math.abs(crds[j] - pcrd[j + o & 7]) >= 2) {
            eq = false;
            break;
          }
        }

        if (eq) return true;
      }

      return false;
    };

    if (p.cmds.length > 10) return false;
    var cmds = p.cmds.join(''),
        crds = p.crds;
    var sameRect = false;

    if (cmds == 'MLLLZ' && crds.length == 8 || cmds == 'MLLLLZ' && crds.length == 10) {
      if (crds.length == 10) crds = crds.slice(0, 8);
      var x0 = bb[0],
          y0 = bb[1],
          x1 = bb[2],
          y1 = bb[3];
      if (!sameRect) sameRect = sameCrd8(crds, [x0, y0, x1, y0, x1, y1, x0, y1]);
      if (!sameRect) sameRect = sameCrd8(crds, [x0, y1, x1, y1, x1, y0, x0, y0]);
    }

    return sameRect;
  },
  boxArea: function boxArea(a) {
    var w = a[2] - a[0],
        h = a[3] - a[1];
    return w * h;
  },
  newPath: function newPath(gst) {
    gst.pth = {
      cmds: [],
      crds: []
    };
  },
  moveTo: function moveTo(gst, x, y) {
    var p = UDOC.M.multPoint(gst.ctm, [x, y]); //if(gst.cpos[0]==p[0] && gst.cpos[1]==p[1]) return;

    gst.pth.cmds.push('M');
    gst.pth.crds.push(p[0], p[1]);
    gst.cpos = p;
  },
  lineTo: function lineTo(gst, x, y) {
    var p = UDOC.M.multPoint(gst.ctm, [x, y]);
    if (gst.cpos[0] == p[0] && gst.cpos[1] == p[1]) return;
    gst.pth.cmds.push('L');
    gst.pth.crds.push(p[0], p[1]);
    gst.cpos = p;
  },
  curveTo: function curveTo(gst, x1, y1, x2, y2, x3, y3) {
    var p;
    p = UDOC.M.multPoint(gst.ctm, [x1, y1]);
    x1 = p[0];
    y1 = p[1];
    p = UDOC.M.multPoint(gst.ctm, [x2, y2]);
    x2 = p[0];
    y2 = p[1];
    p = UDOC.M.multPoint(gst.ctm, [x3, y3]);
    x3 = p[0];
    y3 = p[1];
    gst.cpos = p;
    gst.pth.cmds.push('C');
    gst.pth.crds.push(x1, y1, x2, y2, x3, y3);
  },
  closePath: function closePath(gst) {
    gst.pth.cmds.push('Z');
  },
  arc: function arc(gst, x, y, r, a0, a1, neg) {
    // circle from a0 counter-clock-wise to a1
    if (neg) while (a1 > a0) {
      a1 -= 2 * Math.PI;
    } else while (a1 < a0) {
      a1 += 2 * Math.PI;
    }
    var th = (a1 - a0) / 4;
    var x0 = Math.cos(th / 2),
        y0 = -Math.sin(th / 2);
    var x1 = (4 - x0) / 3,
        y1 = y0 == 0 ? y0 : (1 - x0) * (3 - x0) / (3 * y0);
    var x2 = x1,
        y2 = -y1;
    var x3 = x0,
        y3 = -y0;
    var p1 = [x1, y1],
        p2 = [x2, y2],
        p3 = [x3, y3];
    var pth = {
      cmds: [gst.pth.cmds.length == 0 ? 'M' : 'L', 'C', 'C', 'C', 'C'],
      crds: [x0, y0, x1, y1, x2, y2, x3, y3]
    };
    var rot = [1, 0, 0, 1, 0, 0];
    UDOC.M.rotate(rot, -th);

    for (var i = 0; i < 3; i++) {
      p1 = UDOC.M.multPoint(rot, p1);
      p2 = UDOC.M.multPoint(rot, p2);
      p3 = UDOC.M.multPoint(rot, p3);
      pth.crds.push(p1[0], p1[1], p2[0], p2[1], p3[0], p3[1]);
    }

    var sc = [r, 0, 0, r, x, y];
    UDOC.M.rotate(rot, -a0 + th / 2);
    UDOC.M.concat(rot, sc);
    UDOC.M.multArray(rot, pth.crds);
    UDOC.M.multArray(gst.ctm, pth.crds);
    UDOC.G.concat(gst.pth, pth);
    var y = pth.crds.pop();
    x = pth.crds.pop();
    gst.cpos = [x, y];
  },
  toPoly: function toPoly(p) {
    if (p.cmds[0] != 'M' || p.cmds[p.cmds.length - 1] != 'Z') return null;

    for (var i = 1; i < p.cmds.length - 1; i++) {
      if (p.cmds[i] != 'L') return null;
    }

    var out = [],
        cl = p.crds.length;
    if (p.crds[0] == p.crds[cl - 2] && p.crds[1] == p.crds[cl - 1]) cl -= 2;

    for (var i = 0; i < cl; i += 2) {
      out.push([p.crds[i], p.crds[i + 1]]);
    }

    if (UDOC.G.polyArea(p.crds) < 0) out.reverse();
    return out;
  },
  fromPoly: function fromPoly(p) {
    var o = {
      cmds: [],
      crds: []
    };

    for (var i = 0; i < p.length; i++) {
      o.crds.push(p[i][0], p[i][1]);
      o.cmds.push(i == 0 ? 'M' : 'L');
    }

    o.cmds.push('Z');
    return o;
  },
  polyArea: function polyArea(p) {
    if (p.length < 6) return 0;
    var l = p.length - 2;
    var sum = (p[0] - p[l]) * (p[l + 1] + p[1]);

    for (var i = 0; i < l; i += 2) {
      sum += (p[i + 2] - p[i]) * (p[i + 1] + p[i + 3]);
    }

    return -sum * 0.5;
  },
  polyClip: function polyClip(p0, p1) {
    var cp1, cp2, s, e;

    var inside = function inside(p) {
      return (cp2[0] - cp1[0]) * (p[1] - cp1[1]) > (cp2[1] - cp1[1]) * (p[0] - cp1[0]);
    };

    var isc = function isc() {
      var dc = [cp1[0] - cp2[0], cp1[1] - cp2[1]],
          dp = [s[0] - e[0], s[1] - e[1]],
          n1 = cp1[0] * cp2[1] - cp1[1] * cp2[0],
          n2 = s[0] * e[1] - s[1] * e[0],
          n3 = 1.0 / (dc[0] * dp[1] - dc[1] * dp[0]);
      return [(n1 * dp[0] - n2 * dc[0]) * n3, (n1 * dp[1] - n2 * dc[1]) * n3];
    };

    var out = p0;
    cp1 = p1[p1.length - 1];

    for (var j in p1) {
      var cp2 = p1[j];
      var inp = out;
      out = [];
      s = inp[inp.length - 1]; //last on the input list

      for (var i in inp) {
        var e = inp[i];

        if (inside(e)) {
          if (!inside(s)) {
            out.push(isc());
          }

          out.push(e);
        } else if (inside(s)) {
          out.push(isc());
        }

        s = e;
      }

      cp1 = cp2;
    }

    return out;
  }
};
UDOC.M = {
  getScale: function getScale(m) {
    return Math.sqrt(Math.abs(m[0] * m[3] - m[1] * m[2]));
  },
  translate: function translate(m, x, y) {
    UDOC.M.concat(m, [1, 0, 0, 1, x, y]);
  },
  rotate: function rotate(m, a) {
    UDOC.M.concat(m, [Math.cos(a), -Math.sin(a), Math.sin(a), Math.cos(a), 0, 0]);
  },
  scale: function scale(m, x, y) {
    UDOC.M.concat(m, [x, 0, 0, y, 0, 0]);
  },
  concat: function concat(m, w) {
    var a = m[0],
        b = m[1],
        c = m[2],
        d = m[3],
        tx = m[4],
        ty = m[5];
    m[0] = a * w[0] + b * w[2];
    m[1] = a * w[1] + b * w[3];
    m[2] = c * w[0] + d * w[2];
    m[3] = c * w[1] + d * w[3];
    m[4] = tx * w[0] + ty * w[2] + w[4];
    m[5] = tx * w[1] + ty * w[3] + w[5];
  },
  invert: function invert(m) {
    var a = m[0],
        b = m[1],
        c = m[2],
        d = m[3],
        tx = m[4],
        ty = m[5],
        adbc = a * d - b * c;
    m[0] = d / adbc;
    m[1] = -b / adbc;
    m[2] = -c / adbc;
    m[3] = a / adbc;
    m[4] = (c * ty - d * tx) / adbc;
    m[5] = (b * tx - a * ty) / adbc;
  },
  multPoint: function multPoint(m, p) {
    var x = p[0],
        y = p[1];
    return [x * m[0] + y * m[2] + m[4], x * m[1] + y * m[3] + m[5]];
  },
  multArray: function multArray(m, a) {
    for (var i = 0; i < a.length; i += 2) {
      var x = a[i],
          y = a[i + 1];
      a[i] = x * m[0] + y * m[2] + m[4];
      a[i + 1] = x * m[1] + y * m[3] + m[5];
    }
  }
};
UDOC.C = {
  srgbGamma: function srgbGamma(x) {
    return x < 0.0031308 ? 12.92 * x : 1.055 * Math.pow(x, 1.0 / 2.4) - 0.055;
  },
  cmykToRgb: function cmykToRgb(clr) {
    var c = clr[0],
        m = clr[1],
        y = clr[2],
        k = clr[3]; // return [1-Math.min(1,c+k), 1-Math.min(1, m+k), 1-Math.min(1,y+k)];

    var r = 255 + c * (-4.387332384609988 * c + 54.48615194189176 * m + 18.82290502165302 * y + 212.25662451639585 * k + -285.2331026137004) + m * (1.7149763477362134 * m - 5.6096736904047315 * y + -17.873870861415444 * k - 5.497006427196366) + y * (-2.5217340131683033 * y - 21.248923337353073 * k + 17.5119270841813) + k * (-21.86122147463605 * k - 189.48180835922747);
    var g = 255 + c * (8.841041422036149 * c + 60.118027045597366 * m + 6.871425592049007 * y + 31.159100130055922 * k + -79.2970844816548) + m * (-15.310361306967817 * m + 17.575251261109482 * y + 131.35250912493976 * k - 190.9453302588951) + y * (4.444339102852739 * y + 9.8632861493405 * k - 24.86741582555878) + k * (-20.737325471181034 * k - 187.80453709719578);
    var b = 255 + c * (0.8842522430003296 * c + 8.078677503112928 * m + 30.89978309703729 * y - 0.23883238689178934 * k + -14.183576799673286) + m * (10.49593273432072 * m + 63.02378494754052 * y + 50.606957656360734 * k - 112.23884253719248) + y * (0.03296041114873217 * y + 115.60384449646641 * k + -193.58209356861505) + k * (-22.33816807309886 * k - 180.12613974708367);
    return [Math.max(0, Math.min(1, r / 255)), Math.max(0, Math.min(1, g / 255)), Math.max(0, Math.min(1, b / 255))]; //var iK = 1-c[3];
    //return [(1-c[0])*iK, (1-c[1])*iK, (1-c[2])*iK];
  },
  labToRgb: function labToRgb(lab) {
    var k = 903.3,
        e = 0.008856,
        L = lab[0],
        a = lab[1],
        b = lab[2];
    var fy = (L + 16) / 116,
        fy3 = fy * fy * fy;
    var fz = fy - b / 200,
        fz3 = fz * fz * fz;
    var fx = a / 500 + fy,
        fx3 = fx * fx * fx;
    var zr = fz3 > e ? fz3 : (116 * fz - 16) / k;
    var yr = fy3 > e ? fy3 : (116 * fy - 16) / k;
    var xr = fx3 > e ? fx3 : (116 * fx - 16) / k;
    var X = xr * 96.72,
        Y = yr * 100,
        Z = zr * 81.427,
        xyz = [X / 100, Y / 100, Z / 100];
    var x2s = [3.1338561, -1.6168667, -0.4906146, -0.9787684, 1.9161415, 0.033454, 0.0719453, -0.2289914, 1.4052427];
    var rgb = [x2s[0] * xyz[0] + x2s[1] * xyz[1] + x2s[2] * xyz[2], x2s[3] * xyz[0] + x2s[4] * xyz[1] + x2s[5] * xyz[2], x2s[6] * xyz[0] + x2s[7] * xyz[1] + x2s[8] * xyz[2]];

    for (var i = 0; i < 3; i++) {
      rgb[i] = Math.max(0, Math.min(1, UDOC.C.srgbGamma(rgb[i])));
    }

    return rgb;
  }
};

UDOC.getState = function (crds) {
  return {
    font: UDOC.getFont(),
    dd: {
      flat: 1
    },
    space: '/DeviceGray',
    // fill
    ca: 1,
    colr: [0, 0, 0],
    sspace: '/DeviceGray',
    // stroke
    CA: 1,
    COLR: [0, 0, 0],
    bmode: '/Normal',
    SA: false,
    OPM: 0,
    AIS: false,
    OP: false,
    op: false,
    SMask: '/None',
    lwidth: 1,
    lcap: 0,
    ljoin: 0,
    mlimit: 10,
    SM: 0.1,
    doff: 0,
    dash: [],
    ctm: [1, 0, 0, 1, 0, 0],
    cpos: [0, 0],
    pth: {
      cmds: [],
      crds: []
    },
    cpth: crds ? UDOC.G.rectToPath(crds) : null // clipping path

  };
};

UDOC.getFont = function () {
  return {
    Tc: 0,
    Tw: 0,
    Th: 100,
    Tl: 0,
    Tf: 'Helvetica-Bold',
    Tfs: 1,
    Tmode: 0,
    Trise: 0,
    Tk: 0,
    Tal: 0,
    Tun: 0,
    Tm: [1, 0, 0, 1, 0, 0],
    Tlm: [1, 0, 0, 1, 0, 0],
    Trm: [1, 0, 0, 1, 0, 0]
  };
};

var FromEMF = function FromEMF() {};

FromEMF.Parse = function (buff, genv) {
  buff = new Uint8Array(buff);
  var off = 0; //console.log(buff.slice(0,32));

  var prms = {
    fill: false,
    strk: false,
    bb: [0, 0, 1, 1],
    wbb: [0, 0, 1, 1],
    fnt: {
      nam: 'Arial',
      hgh: 25,
      und: false,
      orn: 0
    },
    tclr: [0, 0, 0],
    talg: 0
  },
      gst,
      tab = [],
      sts = [];
  var rI = FromEMF.B.readShort,
      rU = FromEMF.B.readUshort,
      rI32 = FromEMF.B.readInt,
      rU32 = FromEMF.B.readUint,
      rF32 = FromEMF.B.readFloat;

  while (true) {
    var fnc = rU32(buff, off);
    off += 4;
    var fnm = FromEMF.K[fnc];
    var siz = rU32(buff, off);
    off += 4; //if(gst && isNaN(gst.ctm[0])) throw "e";
    //console.log(fnc,fnm,siz);

    var loff = off; //if(opn++==253) break;

    var obj = null,
        oid = 0; //console.log(fnm, siz);

    if (fnm == 'EOF') {
      break;
    } else if (fnm == 'HEADER') {
      prms.bb = FromEMF._readBox(buff, loff);
      loff += 16; //console.log(fnm, prms.bb);

      genv.StartPage(prms.bb[0], prms.bb[1], prms.bb[2], prms.bb[3]);
      gst = UDOC.getState(prms.bb);
    } else if (fnm == 'SAVEDC') sts.push(JSON.stringify(gst), JSON.stringify(prms));else if (fnm == 'RESTOREDC') {
      var dif = rI32(buff, loff);
      loff += 4;

      while (dif < -1) {
        sts.pop();
        sts.pop();
      }

      prms = JSON.parse(sts.pop());
      gst = JSON.parse(sts.pop());
    } else if (fnm == 'SELECTCLIPPATH') {
      gst.cpth = JSON.parse(JSON.stringify(gst.pth));
    } else if (['SETMAPMODE', 'SETPOLYFILLMODE', 'SETBKMODE'
    /*,"SETVIEWPORTEXTEX"*/
    , 'SETICMMODE', 'SETROP2', 'EXTSELECTCLIPRGN'].indexOf(fnm) != -1) ;else if (fnm == 'SETMITERLIMIT') //else if(fnm=="INTERSECTCLIPRECT") {  var r=prms.crct=FromEMF._readBox(buff, loff);  /*var y0=r[1],y1=r[3]; if(y0>y1){r[1]=y1; r[3]=y0;}*/ console.log(prms.crct);  }
      gst.mlimit = rU32(buff, loff);else if (fnm == 'SETTEXTCOLOR') prms.tclr = [buff[loff] / 255, buff[loff + 1] / 255, buff[loff + 2] / 255];else if (fnm == 'SETTEXTALIGN') prms.talg = rU32(buff, loff);else if (fnm == 'SETVIEWPORTEXTEX' || fnm == 'SETVIEWPORTORGEX') {
      if (prms.vbb == null) prms.vbb = [];
      var coff = fnm == 'SETVIEWPORTORGEX' ? 0 : 2;
      prms.vbb[coff] = rI32(buff, loff);
      loff += 4;
      prms.vbb[coff + 1] = rI32(buff, loff);
      loff += 4; //console.log(prms.vbb);

      if (fnm == 'SETVIEWPORTEXTEX') FromEMF._updateCtm(prms, gst);
    } else if (fnm == 'SETWINDOWEXTEX' || fnm == 'SETWINDOWORGEX') {
      var coff = fnm == 'SETWINDOWORGEX' ? 0 : 2;
      prms.wbb[coff] = rI32(buff, loff);
      loff += 4;
      prms.wbb[coff + 1] = rI32(buff, loff);
      loff += 4;
      if (fnm == 'SETWINDOWEXTEX') FromEMF._updateCtm(prms, gst);
    } //else if(fnm=="SETMETARGN") {}
    else if (fnm == 'COMMENT') {
      rU32(buff, loff);
      loff += 4;
    } else if (fnm == 'SELECTOBJECT') {
      var ind = rU32(buff, loff);
      loff += 4; //console.log(ind.toString(16), tab, tab[ind]);

      if (ind == 0x80000000) {
        prms.fill = true;
        gst.colr = [1, 1, 1];
      } // white brush
      else if (ind == 0x80000005) {
        prms.fill = false;
      } // null brush
      else if (ind == 0x80000007) {
        prms.strk = true;
        prms.lwidth = 1;
        gst.COLR = [0, 0, 0];
      } // black pen
      else if (ind == 0x80000008) {
        prms.strk = false;
      } // null  pen
      else if (ind == 0x8000000d) ;else if (ind == 0x8000000e) ;else {
        // device default font
        var co = tab[ind]; //console.log(ind, co);

        if (co.t == 'b') {
          prms.fill = co.stl != 1;
          if (co.stl == 0) ;else if (co.stl == 1) ;else throw co.stl + ' e';
          gst.colr = co.clr;
        } else if (co.t == 'p') {
          prms.strk = co.stl != 5;
          gst.lwidth = co.wid;
          gst.COLR = co.clr;
        } else if (co.t == 'f') {
          prms.fnt = co;
          gst.font.Tf = co.nam;
          gst.font.Tfs = Math.abs(co.hgh);
          gst.font.Tun = co.und;
        } else throw 'e';
      }
    } else if (fnm == 'DELETEOBJECT') {
      var ind = rU32(buff, loff);
      loff += 4;
      if (tab[ind] != null) tab[ind] = null;else throw 'e';
    } else if (fnm == 'CREATEBRUSHINDIRECT') {
      oid = rU32(buff, loff);
      loff += 4;
      obj = {
        t: 'b'
      };
      obj.stl = rU32(buff, loff);
      loff += 4;
      obj.clr = [buff[loff] / 255, buff[loff + 1] / 255, buff[loff + 2] / 255];
      loff += 4;
      obj.htc = rU32(buff, loff);
      loff += 4; //console.log(oid, obj);
    } else if (fnm == 'CREATEPEN' || fnm == 'EXTCREATEPEN') {
      oid = rU32(buff, loff);
      loff += 4;
      obj = {
        t: 'p'
      };

      if (fnm == 'EXTCREATEPEN') {
        loff += 16;
        obj.stl = rU32(buff, loff);
        loff += 4;
        obj.wid = rU32(buff, loff);
        loff += 4; //obj.stl = rU32(buff, loff);

        loff += 4;
      } else {
        obj.stl = rU32(buff, loff);
        loff += 4;
        obj.wid = rU32(buff, loff);
        loff += 4;
        loff += 4;
      }

      obj.clr = [buff[loff] / 255, buff[loff + 1] / 255, buff[loff + 2] / 255];
      loff += 4;
    } else if (fnm == 'EXTCREATEFONTINDIRECTW') {
      oid = rU32(buff, loff);
      loff += 4;
      obj = {
        t: 'f',
        nam: ''
      };
      obj.hgh = rI32(buff, loff);
      loff += 4;
      loff += 4 * 2;
      obj.orn = rI32(buff, loff) / 10;
      loff += 4;
      var wgh = rU32(buff, loff);
      loff += 4; //console.log(fnm, obj.orn, wgh);
      //console.log(rU32(buff,loff), rU32(buff,loff+4), buff.slice(loff,loff+8));

      obj.und = buff[loff + 1];
      obj.stk = buff[loff + 2];
      loff += 4 * 2;

      while (rU(buff, loff) != 0) {
        obj.nam += String.fromCharCode(rU(buff, loff));
        loff += 2;
      }

      if (wgh > 500) obj.nam += '-Bold'; //console.log(wgh, obj.nam);
    } else if (fnm == 'EXTTEXTOUTW') {
      //console.log(buff.slice(loff-8, loff-8+siz));
      loff += 16;
      var mod = rU32(buff, loff);
      loff += 4; //console.log(mod);

      rF32(buff, loff);
      loff += 4;
      rF32(buff, loff);
      loff += 4;
      var rfx = rI32(buff, loff);
      loff += 4;
      var rfy = rI32(buff, loff);
      loff += 4; //console.log(mod, scx, scy,rfx,rfy);

      gst.font.Tm = [1, 0, 0, -1, 0, 0];
      UDOC.M.rotate(gst.font.Tm, prms.fnt.orn * Math.PI / 180);
      UDOC.M.translate(gst.font.Tm, rfx, rfy);
      var alg = prms.talg; //console.log(alg.toString(2));

      if ((alg & 6) == 6) gst.font.Tal = 2;else if ((alg & 7) == 0) gst.font.Tal = 0;else throw alg + ' e';
      if ((alg & 24) == 24) ;else if ((alg & 24) == 0) // baseline
        UDOC.M.translate(gst.font.Tm, 0, gst.font.Tfs);else throw 'e';
      var crs = rU32(buff, loff);
      loff += 4;
      var ofs = rU32(buff, loff);
      loff += 4;
      rU32(buff, loff);
      loff += 4; //if(ops!=0) throw "e";
      //console.log(ofs,ops,crs);

      loff += 16;
      rU32(buff, loff);
      loff += 4; //console.log(ops, ofD, loff, ofs+off-8);

      ofs += off - 8; //console.log(crs, ops);

      var str = '';

      for (var i = 0; i < crs; i++) {
        var cc = rU(buff, ofs + i * 2);
        str += String.fromCharCode(cc);
      }

      var oclr = gst.colr;
      gst.colr = prms.tclr; //console.log(str, gst.colr, gst.font.Tm);
      //var otfs = gst.font.Tfs;  gst.font.Tfs *= 1/gst.ctm[0];

      genv.PutText(gst, str, str.length * gst.font.Tfs * 0.5);
      gst.colr = oclr; //gst.font.Tfs = otfs;
      //console.log(rfx, rfy, scx, ops, rcX, rcY, rcW, rcH, offDx, str);
    } else if (fnm == 'BEGINPATH') {
      UDOC.G.newPath(gst);
    } else if (fnm == 'ENDPATH') ;else if (fnm == 'CLOSEFIGURE') UDOC.G.closePath(gst);else if (fnm == 'MOVETOEX') {
      UDOC.G.moveTo(gst, rI32(buff, loff), rI32(buff, loff + 4));
    } else if (fnm == 'LINETO') {
      if (gst.pth.cmds.length == 0) {
        var im = gst.ctm.slice(0);
        UDOC.M.invert(im);
        var p = UDOC.M.multPoint(im, gst.cpos);
        UDOC.G.moveTo(gst, p[0], p[1]);
      }

      UDOC.G.lineTo(gst, rI32(buff, loff), rI32(buff, loff + 4));
    } else if (fnm == 'POLYGON' || fnm == 'POLYGON16' || fnm == 'POLYLINE' || fnm == 'POLYLINE16' || fnm == 'POLYLINETO' || fnm == 'POLYLINETO16') {
      loff += 16;
      var ndf = fnm.startsWith('POLYGON'),
          isTo = fnm.indexOf('TO') != -1;
      var cnt = rU32(buff, loff);
      loff += 4;
      if (!isTo) UDOC.G.newPath(gst);
      loff = FromEMF._drawPoly(buff, loff, cnt, gst, fnm.endsWith('16') ? 2 : 4, ndf, isTo);
      if (!isTo) FromEMF._draw(genv, gst, prms, ndf); //console.log(prms, gst.lwidth);
      //console.log(JSON.parse(JSON.stringify(gst.pth)));
    } else if (fnm == 'POLYPOLYGON16') {
      loff += 16;
      var ndf = fnm.startsWith('POLYPOLYGON'),
          isTo = fnm.indexOf('TO') != -1;
      var nop = rU32(buff, loff);
      loff += 4;
      loff += 4;
      var pi = loff;
      loff += nop * 4;
      if (!isTo) UDOC.G.newPath(gst);

      for (var i = 0; i < nop; i++) {
        var ppp = rU(buff, pi + i * 4);
        loff = FromEMF._drawPoly(buff, loff, ppp, gst, fnm.endsWith('16') ? 2 : 4, ndf, isTo);
      }

      if (!isTo) FromEMF._draw(genv, gst, prms, ndf);
    } else if (fnm == 'POLYBEZIER' || fnm == 'POLYBEZIER16' || fnm == 'POLYBEZIERTO' || fnm == 'POLYBEZIERTO16') {
      loff += 16;
      var is16 = fnm.endsWith('16'),
          rC = is16 ? rI : rI32,
          nl = is16 ? 2 : 4;
      var cnt = rU32(buff, loff);
      loff += 4;

      if (fnm.indexOf('TO') == -1) {
        UDOC.G.moveTo(gst, rC(buff, loff), rC(buff, loff + nl));
        loff += 2 * nl;
        cnt--;
      }

      while (cnt > 0) {
        UDOC.G.curveTo(gst, rC(buff, loff), rC(buff, loff + nl), rC(buff, loff + 2 * nl), rC(buff, loff + 3 * nl), rC(buff, loff + 4 * nl), rC(buff, loff + 5 * nl));
        loff += 6 * nl;
        cnt -= 3;
      } //console.log(JSON.parse(JSON.stringify(gst.pth)));

    } else if (fnm == 'RECTANGLE' || fnm == 'ELLIPSE') {
      UDOC.G.newPath(gst);

      var bx = FromEMF._readBox(buff, loff);

      if (fnm == 'RECTANGLE') {
        UDOC.G.moveTo(gst, bx[0], bx[1]);
        UDOC.G.lineTo(gst, bx[2], bx[1]);
        UDOC.G.lineTo(gst, bx[2], bx[3]);
        UDOC.G.lineTo(gst, bx[0], bx[3]);
      } else {
        var x = (bx[0] + bx[2]) / 2,
            y = (bx[1] + bx[3]) / 2;
        UDOC.G.arc(gst, x, y, (bx[2] - bx[0]) / 2, 0, 2 * Math.PI, false);
      }

      UDOC.G.closePath(gst);

      FromEMF._draw(genv, gst, prms, true); //console.log(prms, gst.lwidth);

    } else if (fnm == 'FILLPATH') genv.Fill(gst, false);else if (fnm == 'STROKEPATH') genv.Stroke(gst);else if (fnm == 'STROKEANDFILLPATH') {
      genv.Fill(gst, false);
      genv.Stroke(gst);
    } else if (fnm == 'SETWORLDTRANSFORM' || fnm == 'MODIFYWORLDTRANSFORM') {
      var mat = [];

      for (var i = 0; i < 6; i++) {
        mat.push(rF32(buff, loff + i * 4));
      }

      loff += 24; //console.log(fnm, gst.ctm.slice(0), mat);

      if (fnm == 'SETWORLDTRANSFORM') gst.ctm = mat;else {
        var mod = rU32(buff, loff);
        loff += 4;

        if (mod == 2) {
          var om = gst.ctm;
          gst.ctm = mat;
          UDOC.M.concat(gst.ctm, om);
        } else throw 'e';
      }
    } else if (fnm == 'SETSTRETCHBLTMODE') {
      rU32(buff, loff);
      loff += 4;
    } else if (fnm == 'STRETCHDIBITS') {
      var bx = FromEMF._readBox(buff, loff);

      loff += 16;
      var xD = rI32(buff, loff);
      loff += 4;
      var yD = rI32(buff, loff);
      loff += 4;
      rI32(buff, loff);
      loff += 4;
      rI32(buff, loff);
      loff += 4;
      var wS = rI32(buff, loff);
      loff += 4;
      var hS = rI32(buff, loff);
      loff += 4;
      var ofH = rU32(buff, loff) + off - 8;
      loff += 4;
      rU32(buff, loff);
      loff += 4;
      var ofB = rU32(buff, loff) + off - 8;
      loff += 4;
      rU32(buff, loff);
      loff += 4;
      var usg = rU32(buff, loff);
      loff += 4;
      if (usg != 0) throw 'e';
      rU32(buff, loff);
      loff += 4;
      var wD = rI32(buff, loff);
      loff += 4;
      var hD = rI32(buff, loff);
      loff += 4; //console.log(bop, wD, hD);
      //console.log(ofH, szH, ofB, szB, ofH+40);
      //console.log(bx, xD,yD,wD,hD);
      //console.log(xS,yS,wS,hS);
      //console.log(ofH,szH,ofB,szB,usg,bop);

      rU32(buff, ofH);
      ofH += 4;
      var w = rU32(buff, ofH);
      ofH += 4;
      var h = rU32(buff, ofH);
      ofH += 4;
      if (w != wS || h != hS) throw 'e';
      var ps = rU(buff, ofH);
      ofH += 2;
      var bc = rU(buff, ofH);
      ofH += 2;
      if (bc != 8 && bc != 24 && bc != 32) throw bc + ' e';
      var cpr = rU32(buff, ofH);
      ofH += 4;
      if (cpr != 0) throw cpr + ' e';
      rU32(buff, ofH);
      ofH += 4;
      rU32(buff, ofH);
      ofH += 4;
      rU32(buff, ofH);
      ofH += 4;
      rU32(buff, ofH);
      ofH += 4;
      rU32(buff, ofH);
      ofH += 4; //console.log(hl, w, h, ps, bc, cpr, sz, xpm, ypm, cu, ci);
      //console.log(hl,w,h,",",xS,yS,wS,hS,",",xD,yD,wD,hD,",",xpm,ypm);

      var rl = Math.floor((w * ps * bc + 31 & ~31) / 8);
      var img = new Uint8Array(w * h * 4);

      if (bc == 8) {
        for (var y = 0; y < h; y++) {
          for (var x = 0; x < w; x++) {
            var qi = y * w + x << 2,
                ind = buff[ofB + (h - 1 - y) * rl + x] << 2;
            img[qi] = buff[ofH + ind + 2];
            img[qi + 1] = buff[ofH + ind + 1];
            img[qi + 2] = buff[ofH + ind + 0];
            img[qi + 3] = 255;
          }
        }
      }

      if (bc == 24) {
        for (var y = 0; y < h; y++) {
          for (var x = 0; x < w; x++) {
            var qi = y * w + x << 2,
                ti = ofB + (h - 1 - y) * rl + x * 3;
            img[qi] = buff[ti + 2];
            img[qi + 1] = buff[ti + 1];
            img[qi + 2] = buff[ti + 0];
            img[qi + 3] = 255;
          }
        }
      }

      if (bc == 32) {
        for (var y = 0; y < h; y++) {
          for (var x = 0; x < w; x++) {
            var qi = y * w + x << 2,
                ti = ofB + (h - 1 - y) * rl + x * 4;
            img[qi] = buff[ti + 2];
            img[qi + 1] = buff[ti + 1];
            img[qi + 2] = buff[ti + 0];
            img[qi + 3] = buff[ti + 3];
          }
        }
      }

      var ctm = gst.ctm.slice(0);
      gst.ctm = [1, 0, 0, 1, 0, 0];
      UDOC.M.scale(gst.ctm, wD, -hD);
      UDOC.M.translate(gst.ctm, xD, yD + hD);
      UDOC.M.concat(gst.ctm, ctm);
      genv.PutImage(gst, img, w, h);
      gst.ctm = ctm;
    } else {
      console.log(fnm, siz);
    }

    if (obj != null) tab[oid] = obj;
    off += siz - 8;
  } //genv.Stroke(gst);


  genv.ShowPage();
  genv.Done();
};

FromEMF._readBox = function (buff, off) {
  var b = [];

  for (var i = 0; i < 4; i++) {
    b[i] = FromEMF.B.readInt(buff, off + i * 4);
  }

  return b;
};

FromEMF._updateCtm = function (prms, gst) {
  var mat = [1, 0, 0, 1, 0, 0];
  var wbb = prms.wbb;
  prms.bb;
  var vbb = prms.vbb && prms.vbb.length == 4 ? prms.vbb : prms.bb; //var y0 = bb[1], y1 = bb[3];  bb[1]=Math.min(y0,y1);  bb[3]=Math.max(y0,y1);

  UDOC.M.translate(mat, -wbb[0], -wbb[1]);
  UDOC.M.scale(mat, 1 / wbb[2], 1 / wbb[3]);
  UDOC.M.scale(mat, vbb[2], vbb[3]); //UDOC.M.scale(mat, vbb[2]/(bb[2]-bb[0]), vbb[3]/(bb[3]-bb[1]));
  //UDOC.M.scale(mat, bb[2]-bb[0],bb[3]-bb[1]);

  gst.ctm = mat;
};

FromEMF._draw = function (genv, gst, prms, needFill) {
  if (prms.fill && needFill) genv.Fill(gst, false);
  if (prms.strk && gst.lwidth != 0) genv.Stroke(gst);
};

FromEMF._drawPoly = function (buff, off, ppp, gst, nl, clos, justLine) {
  var rS = nl == 2 ? FromEMF.B.readShort : FromEMF.B.readInt;

  for (var j = 0; j < ppp; j++) {
    var px = rS(buff, off);
    off += nl;
    var py = rS(buff, off);
    off += nl;
    if (j == 0 && !justLine) UDOC.G.moveTo(gst, px, py);else UDOC.G.lineTo(gst, px, py);
  }

  if (clos) UDOC.G.closePath(gst);
  return off;
};

FromEMF.B = {
  uint8: new Uint8Array(4),
  readShort: function readShort(buff, p) {
    var u8 = FromEMF.B.uint8;
    u8[0] = buff[p];
    u8[1] = buff[p + 1];
    return FromEMF.B.int16[0];
  },
  readUshort: function readUshort(buff, p) {
    var u8 = FromEMF.B.uint8;
    u8[0] = buff[p];
    u8[1] = buff[p + 1];
    return FromEMF.B.uint16[0];
  },
  readInt: function readInt(buff, p) {
    var u8 = FromEMF.B.uint8;
    u8[0] = buff[p];
    u8[1] = buff[p + 1];
    u8[2] = buff[p + 2];
    u8[3] = buff[p + 3];
    return FromEMF.B.int32[0];
  },
  readUint: function readUint(buff, p) {
    var u8 = FromEMF.B.uint8;
    u8[0] = buff[p];
    u8[1] = buff[p + 1];
    u8[2] = buff[p + 2];
    u8[3] = buff[p + 3];
    return FromEMF.B.uint32[0];
  },
  readFloat: function readFloat(buff, p) {
    var u8 = FromEMF.B.uint8;
    u8[0] = buff[p];
    u8[1] = buff[p + 1];
    u8[2] = buff[p + 2];
    u8[3] = buff[p + 3];
    return FromEMF.B.flot32[0];
  },
  readASCII: function readASCII(buff, p, l) {
    var s = '';

    for (var i = 0; i < l; i++) {
      s += String.fromCharCode(buff[p + i]);
    }

    return s;
  }
};
FromEMF.B.int16 = new Int16Array(FromEMF.B.uint8.buffer);
FromEMF.B.uint16 = new Uint16Array(FromEMF.B.uint8.buffer);
FromEMF.B.int32 = new Int32Array(FromEMF.B.uint8.buffer);
FromEMF.B.uint32 = new Uint32Array(FromEMF.B.uint8.buffer);
FromEMF.B.flot32 = new Float32Array(FromEMF.B.uint8.buffer);
FromEMF.C = {
  EMR_HEADER: 0x00000001,
  EMR_POLYBEZIER: 0x00000002,
  EMR_POLYGON: 0x00000003,
  EMR_POLYLINE: 0x00000004,
  EMR_POLYBEZIERTO: 0x00000005,
  EMR_POLYLINETO: 0x00000006,
  EMR_POLYPOLYLINE: 0x00000007,
  EMR_POLYPOLYGON: 0x00000008,
  EMR_SETWINDOWEXTEX: 0x00000009,
  EMR_SETWINDOWORGEX: 0x0000000a,
  EMR_SETVIEWPORTEXTEX: 0x0000000b,
  EMR_SETVIEWPORTORGEX: 0x0000000c,
  EMR_SETBRUSHORGEX: 0x0000000d,
  EMR_EOF: 0x0000000e,
  EMR_SETPIXELV: 0x0000000f,
  EMR_SETMAPPERFLAGS: 0x00000010,
  EMR_SETMAPMODE: 0x00000011,
  EMR_SETBKMODE: 0x00000012,
  EMR_SETPOLYFILLMODE: 0x00000013,
  EMR_SETROP2: 0x00000014,
  EMR_SETSTRETCHBLTMODE: 0x00000015,
  EMR_SETTEXTALIGN: 0x00000016,
  EMR_SETCOLORADJUSTMENT: 0x00000017,
  EMR_SETTEXTCOLOR: 0x00000018,
  EMR_SETBKCOLOR: 0x00000019,
  EMR_OFFSETCLIPRGN: 0x0000001a,
  EMR_MOVETOEX: 0x0000001b,
  EMR_SETMETARGN: 0x0000001c,
  EMR_EXCLUDECLIPRECT: 0x0000001d,
  EMR_INTERSECTCLIPRECT: 0x0000001e,
  EMR_SCALEVIEWPORTEXTEX: 0x0000001f,
  EMR_SCALEWINDOWEXTEX: 0x00000020,
  EMR_SAVEDC: 0x00000021,
  EMR_RESTOREDC: 0x00000022,
  EMR_SETWORLDTRANSFORM: 0x00000023,
  EMR_MODIFYWORLDTRANSFORM: 0x00000024,
  EMR_SELECTOBJECT: 0x00000025,
  EMR_CREATEPEN: 0x00000026,
  EMR_CREATEBRUSHINDIRECT: 0x00000027,
  EMR_DELETEOBJECT: 0x00000028,
  EMR_ANGLEARC: 0x00000029,
  EMR_ELLIPSE: 0x0000002a,
  EMR_RECTANGLE: 0x0000002b,
  EMR_ROUNDRECT: 0x0000002c,
  EMR_ARC: 0x0000002d,
  EMR_CHORD: 0x0000002e,
  EMR_PIE: 0x0000002f,
  EMR_SELECTPALETTE: 0x00000030,
  EMR_CREATEPALETTE: 0x00000031,
  EMR_SETPALETTEENTRIES: 0x00000032,
  EMR_RESIZEPALETTE: 0x00000033,
  EMR_REALIZEPALETTE: 0x00000034,
  EMR_EXTFLOODFILL: 0x00000035,
  EMR_LINETO: 0x00000036,
  EMR_ARCTO: 0x00000037,
  EMR_POLYDRAW: 0x00000038,
  EMR_SETARCDIRECTION: 0x00000039,
  EMR_SETMITERLIMIT: 0x0000003a,
  EMR_BEGINPATH: 0x0000003b,
  EMR_ENDPATH: 0x0000003c,
  EMR_CLOSEFIGURE: 0x0000003d,
  EMR_FILLPATH: 0x0000003e,
  EMR_STROKEANDFILLPATH: 0x0000003f,
  EMR_STROKEPATH: 0x00000040,
  EMR_FLATTENPATH: 0x00000041,
  EMR_WIDENPATH: 0x00000042,
  EMR_SELECTCLIPPATH: 0x00000043,
  EMR_ABORTPATH: 0x00000044,
  EMR_COMMENT: 0x00000046,
  EMR_FILLRGN: 0x00000047,
  EMR_FRAMERGN: 0x00000048,
  EMR_INVERTRGN: 0x00000049,
  EMR_PAINTRGN: 0x0000004a,
  EMR_EXTSELECTCLIPRGN: 0x0000004b,
  EMR_BITBLT: 0x0000004c,
  EMR_STRETCHBLT: 0x0000004d,
  EMR_MASKBLT: 0x0000004e,
  EMR_PLGBLT: 0x0000004f,
  EMR_SETDIBITSTODEVICE: 0x00000050,
  EMR_STRETCHDIBITS: 0x00000051,
  EMR_EXTCREATEFONTINDIRECTW: 0x00000052,
  EMR_EXTTEXTOUTA: 0x00000053,
  EMR_EXTTEXTOUTW: 0x00000054,
  EMR_POLYBEZIER16: 0x00000055,
  EMR_POLYGON16: 0x00000056,
  EMR_POLYLINE16: 0x00000057,
  EMR_POLYBEZIERTO16: 0x00000058,
  EMR_POLYLINETO16: 0x00000059,
  EMR_POLYPOLYLINE16: 0x0000005a,
  EMR_POLYPOLYGON16: 0x0000005b,
  EMR_POLYDRAW16: 0x0000005c,
  EMR_CREATEMONOBRUSH: 0x0000005d,
  EMR_CREATEDIBPATTERNBRUSHPT: 0x0000005e,
  EMR_EXTCREATEPEN: 0x0000005f,
  EMR_POLYTEXTOUTA: 0x00000060,
  EMR_POLYTEXTOUTW: 0x00000061,
  EMR_SETICMMODE: 0x00000062,
  EMR_CREATECOLORSPACE: 0x00000063,
  EMR_SETCOLORSPACE: 0x00000064,
  EMR_DELETECOLORSPACE: 0x00000065,
  EMR_GLSRECORD: 0x00000066,
  EMR_GLSBOUNDEDRECORD: 0x00000067,
  EMR_PIXELFORMAT: 0x00000068,
  EMR_DRAWESCAPE: 0x00000069,
  EMR_EXTESCAPE: 0x0000006a,
  EMR_SMALLTEXTOUT: 0x0000006c,
  EMR_FORCEUFIMAPPING: 0x0000006d,
  EMR_NAMEDESCAPE: 0x0000006e,
  EMR_COLORCORRECTPALETTE: 0x0000006f,
  EMR_SETICMPROFILEA: 0x00000070,
  EMR_SETICMPROFILEW: 0x00000071,
  EMR_ALPHABLEND: 0x00000072,
  EMR_SETLAYOUT: 0x00000073,
  EMR_TRANSPARENTBLT: 0x00000074,
  EMR_GRADIENTFILL: 0x00000076,
  EMR_SETLINKEDUFIS: 0x00000077,
  EMR_SETTEXTJUSTIFICATION: 0x00000078,
  EMR_COLORMATCHTOTARGETW: 0x00000079,
  EMR_CREATECOLORSPACEW: 0x0000007a
};
FromEMF.K = []; // (function() {
//     var inp, out, stt;
//     inp = FromEMF.C;   out = FromEMF.K;   stt=4;
//     for(var p in inp) out[inp[p]] = p.slice(stt);
// }  )();

var ToContext2D = function ToContext2D(needPage, scale) {
  this.canvas = document.createElement('canvas');
  this.ctx = this.canvas.getContext('2d');
  this.bb = null;
  this.currPage = 0;
  this.needPage = needPage;
  this.scale = scale;
};

ToContext2D.prototype.StartPage = function (x, y, w, h) {
  if (this.currPage != this.needPage) return;
  this.bb = [x, y, w, h];
  var scl = this.scale,
      dpr = window.devicePixelRatio;
  var cnv = this.canvas,
      ctx = this.ctx;
  cnv.width = Math.round(w * scl);
  cnv.height = Math.round(h * scl);
  ctx.translate(0, h * scl);
  ctx.scale(scl, -scl);
  cnv.setAttribute('style', 'border:1px solid; width:' + cnv.width / dpr + 'px; height:' + cnv.height / dpr + 'px');
};

ToContext2D.prototype.Fill = function (gst, evenOdd) {
  if (this.currPage != this.needPage) return;
  var ctx = this.ctx;
  ctx.beginPath();

  this._setStyle(gst, ctx);

  this._draw(gst.pth, ctx);

  ctx.fill();
};

ToContext2D.prototype.Stroke = function (gst) {
  if (this.currPage != this.needPage) return;
  var ctx = this.ctx;
  ctx.beginPath();

  this._setStyle(gst, ctx);

  this._draw(gst.pth, ctx);

  ctx.stroke();
};

ToContext2D.prototype.PutText = function (gst, str, stw) {
  if (this.currPage != this.needPage) return;

  this._scale(gst.ctm);

  var ctx = this.ctx;

  this._setStyle(gst, ctx);

  ctx.save();
  var m = [1, 0, 0, -1, 0, 0];

  this._concat(m, gst.font.Tm);

  this._concat(m, gst.ctm); //console.log(str, m, gst);  throw "e";


  ctx.transform(m[0], m[1], m[2], m[3], m[4], m[5]);
  ctx.fillText(str, 0, 0);
  ctx.restore();
};

ToContext2D.prototype.PutImage = function (gst, buff, w, h, msk) {
  if (this.currPage != this.needPage) return;
  var ctx = this.ctx;

  if (buff.length == w * h * 4) {
    buff = buff.slice(0);
    if (msk && msk.length == w * h * 4) for (var i = 0; i < buff.length; i += 4) {
      buff[i + 3] = msk[i + 1];
    }
    var cnv = document.createElement('canvas'),
        cctx = cnv.getContext('2d');
    cnv.width = w;
    cnv.height = h;
    var imgd = cctx.createImageData(w, h);

    for (var i = 0; i < buff.length; i++) {
      imgd.data[i] = buff[i];
    }

    cctx.putImageData(imgd, 0, 0);
    ctx.save();
    var m = [1, 0, 0, 1, 0, 0];

    this._concat(m, [1 / w, 0, 0, -1 / h, 0, 1]);

    this._concat(m, gst.ctm);

    ctx.transform(m[0], m[1], m[2], m[3], m[4], m[5]);
    ctx.drawImage(cnv, 0, 0);
    ctx.restore();
  }
};

ToContext2D.prototype.ShowPage = function () {
  this.currPage++;
};

ToContext2D.prototype.Done = function () {};

function _flt(n) {
  return '' + parseFloat(n.toFixed(2));
}

ToContext2D.prototype._setStyle = function (gst, ctx) {
  var scl = this._scale(gst.ctm);

  ctx.fillStyle = this._getFill(gst.colr, gst.ca, ctx);
  ctx.strokeStyle = this._getFill(gst.COLR, gst.CA, ctx);
  ctx.lineCap = ['butt', 'round', 'square'][gst.lcap];
  ctx.lineJoin = ['miter', 'round', 'bevel'][gst.ljoin];
  ctx.lineWidth = gst.lwidth * scl;
  var dsh = gst.dash.slice(0);

  for (var i = 0; i < dsh.length; i++) {
    dsh[i] = _flt(dsh[i] * scl);
  }

  ctx.setLineDash(dsh);
  ctx.miterLimit = gst.mlimit * scl;
  var fn = gst.font.Tf,
      ln = fn.toLowerCase();
  var p0 = ln.indexOf('bold') != -1 ? 'bold ' : '';
  var p1 = ln.indexOf('italic') != -1 || ln.indexOf('oblique') != -1 ? 'italic ' : '';
  ctx.font = p0 + p1 + gst.font.Tfs + 'px "' + fn + '"';
};

ToContext2D.prototype._getFill = function (colr, ca, ctx) {
  if (colr.typ == null) return this._colr(colr, ca);else {
    var grd = colr,
        crd = grd.crds,
        mat = grd.mat,
        scl = this._scale(mat),
        gf;

    if (grd.typ == 'lin') {
      var p0 = this._multPoint(mat, crd.slice(0, 2)),
          p1 = this._multPoint(mat, crd.slice(2));

      gf = ctx.createLinearGradient(p0[0], p0[1], p1[0], p1[1]);
    } else if (grd.typ == 'rad') {
      var p0 = this._multPoint(mat, crd.slice(0, 2)),
          p1 = this._multPoint(mat, crd.slice(3));

      gf = ctx.createRadialGradient(p0[0], p0[1], crd[2] * scl, p1[0], p1[1], crd[5] * scl);
    }

    for (var i = 0; i < grd.grad.length; i++) {
      gf.addColorStop(grd.grad[i][0], this._colr(grd.grad[i][1], ca));
    }

    return gf;
  }
};

ToContext2D.prototype._colr = function (c, a) {
  return 'rgba(' + Math.round(c[0] * 255) + ',' + Math.round(c[1] * 255) + ',' + Math.round(c[2] * 255) + ',' + a + ')';
};

ToContext2D.prototype._scale = function (m) {
  return Math.sqrt(Math.abs(m[0] * m[3] - m[1] * m[2]));
};

ToContext2D.prototype._concat = function (m, w) {
  var a = m[0],
      b = m[1],
      c = m[2],
      d = m[3],
      tx = m[4],
      ty = m[5];
  m[0] = a * w[0] + b * w[2];
  m[1] = a * w[1] + b * w[3];
  m[2] = c * w[0] + d * w[2];
  m[3] = c * w[1] + d * w[3];
  m[4] = tx * w[0] + ty * w[2] + w[4];
  m[5] = tx * w[1] + ty * w[3] + w[5];
};

ToContext2D.prototype._multPoint = function (m, p) {
  var x = p[0],
      y = p[1];
  return [x * m[0] + y * m[2] + m[4], x * m[1] + y * m[3] + m[5]];
}, ToContext2D.prototype._draw = function (path, ctx) {
  var c = 0,
      crds = path.crds;

  for (var j = 0; j < path.cmds.length; j++) {
    var cmd = path.cmds[j];

    if (cmd == 'M') {
      ctx.moveTo(crds[c], crds[c + 1]);
      c += 2;
    } else if (cmd == 'L') {
      ctx.lineTo(crds[c], crds[c + 1]);
      c += 2;
    } else if (cmd == 'C') {
      ctx.bezierCurveTo(crds[c], crds[c + 1], crds[c + 2], crds[c + 3], crds[c + 4], crds[c + 5]);
      c += 6;
    } else if (cmd == 'Q') {
      ctx.quadraticCurveTo(crds[c], crds[c + 1], crds[c + 2], crds[c + 3]);
      c += 4;
    } else if (cmd == 'Z') {
      ctx.closePath();
    }
  }
};

var ImageList =
/** @class */
function () {
  function ImageList(files) {
    if (files == null) {
      return;
    }

    this.images = {};

    for (var fileKey in files) {
      // let reg = new RegExp("xl/media/image1.png", "g");
      if (fileKey.indexOf('xl/media/') > -1) {
        var fileNameArr = fileKey.split('.');
        var suffix = fileNameArr[fileNameArr.length - 1].toLowerCase();

        if (suffix in {
          png: 1,
          jpeg: 1,
          jpg: 1,
          gif: 1,
          bmp: 1,
          tif: 1,
          webp: 1,
          emf: 1
        }) {
          if (suffix == 'emf') {
            var pNum = 0; // number of the page, that you want to render

            var scale = 1; // the scale of the document

            var wrt = new ToContext2D(pNum, scale);
            var inp, out, stt;
            FromEMF.K = [];
            inp = FromEMF.C;
            out = FromEMF.K;
            stt = 4;

            for (var p in inp) {
              out[inp[p]] = p.slice(stt);
            }

            FromEMF.Parse(files[fileKey], wrt);
            this.images[fileKey] = wrt.canvas.toDataURL('image/png');
          } else {
            this.images[fileKey] = files[fileKey];
          }
        }
      }
    }
  }

  ImageList.prototype.getImageByName = function (pathName) {
    if (pathName in this.images) {
      var base64 = this.images[pathName];
      return new Image(pathName, base64);
    }

    return null;
  };

  return ImageList;
}();

var Image =
/** @class */
function (_super) {
  __extends(Image, _super);

  function Image(pathName, base64) {
    var _this = _super.call(this) || this;

    _this.src = base64;
    return _this;
  }

  Image.prototype.setDefault = function () {};

  return Image;
}(LuckyImageBase);

var LuckyFile =
/** @class */
function (_super) {
  __extends(LuckyFile, _super);

  function LuckyFile(files, fileName) {
    var _this = _super.call(this) || this;

    _this.columnWidthSet = [];
    _this.rowHeightSet = [];
    _this.files = files;
    _this.fileName = fileName;
    _this.readXml = new ReadXml(files);

    _this.getSheetNameList();

    _this.sharedStrings = _this.readXml.getElementsByTagName('sst/si', sharedStringsFile);
    _this.calcChain = _this.readXml.getElementsByTagName('calcChain/c', calcChainFile);
    _this.styles = {};
    _this.styles['cellXfs'] = _this.readXml.getElementsByTagName('cellXfs/xf', stylesFile);
    _this.styles['cellStyleXfs'] = _this.readXml.getElementsByTagName('cellStyleXfs/xf', stylesFile);
    _this.styles['cellStyles'] = _this.readXml.getElementsByTagName('cellStyles/cellStyle', stylesFile);
    _this.styles['fonts'] = _this.readXml.getElementsByTagName('fonts/font', stylesFile);
    _this.styles['fills'] = _this.readXml.getElementsByTagName('fills/fill', stylesFile);
    _this.styles['borders'] = _this.readXml.getElementsByTagName('borders/border', stylesFile);
    _this.styles['clrScheme'] = _this.readXml.getElementsByTagName('a:clrScheme/a:dk1|a:lt1|a:dk2|a:lt2|a:accent1|a:accent2|a:accent3|a:accent4|a:accent5|a:accent6|a:hlink|a:folHlink', theme1File);
    _this.styles['indexedColors'] = _this.readXml.getElementsByTagName('colors/indexedColors/rgbColor', stylesFile);
    _this.styles['mruColors'] = _this.readXml.getElementsByTagName('colors/mruColors/color', stylesFile);
    _this.imageList = new ImageList(files);

    var numfmts = _this.readXml.getElementsByTagName('numFmt/numFmt', stylesFile);

    var numFmtDefaultC = JSON.parse(JSON.stringify(numFmtDefault));

    for (var i = 0; i < numfmts.length; i++) {
      var attrList = numfmts[i].attributeList;
      var numfmtid = getXmlAttibute(attrList, 'numFmtId', '49');
      var formatcode = getXmlAttibute(attrList, 'formatCode', '@'); // console.log(numfmtid, formatcode);

      if (!(numfmtid in numFmtDefault)) {
        numFmtDefaultC[numfmtid] = formatcode;
      }
    } // console.log(JSON.stringify(numFmtDefaultC), numfmts);


    _this.styles['numfmts'] = numFmtDefaultC;
    return _this;
  }
  /**
   * @return All sheet name of workbook
   */


  LuckyFile.prototype.getSheetNameList = function () {
    var workbookRelList = this.readXml.getElementsByTagName('Relationships/Relationship', workbookRels);

    if (workbookRelList == null) {
      return;
    }

    var regex = new RegExp('worksheets/[^/]*?.xml');
    var sheetNames = {};

    for (var i = 0; i < workbookRelList.length; i++) {
      var rel = workbookRelList[i],
          attrList = rel.attributeList;
      var id = attrList['Id'],
          target = attrList['Target'];

      if (regex.test(target)) {
        if (target.startsWith('/xl')) {
          sheetNames[id] = target.substr(1);
        } else {
          sheetNames[id] = 'xl/' + target;
        }
      }
    }

    this.sheetNameList = sheetNames;
  };
  /**
   * @param sheetName WorkSheet'name
   * @return sheet file name and path in zip
   */


  LuckyFile.prototype.getSheetFileBysheetId = function (sheetId) {
    // for(let i=0;i<this.sheetNameList.length;i++){
    //     let sheetFileName = this.sheetNameList[i];
    //     if(sheetFileName.indexOf("sheet"+sheetId)>-1){
    //         return sheetFileName;
    //     }
    // }
    return this.sheetNameList[sheetId];
  };
  /**
   * @return workBook information
   */


  LuckyFile.prototype.getWorkBookInfo = function () {
    var Company = this.readXml.getElementsByTagName('Company', appFile);
    var AppVersion = this.readXml.getElementsByTagName('AppVersion', appFile);
    var creator = this.readXml.getElementsByTagName('dc:creator', coreFile);
    var lastModifiedBy = this.readXml.getElementsByTagName('cp:lastModifiedBy', coreFile);
    var created = this.readXml.getElementsByTagName('dcterms:created', coreFile);
    var modified = this.readXml.getElementsByTagName('dcterms:modified', coreFile);
    this.info = new LuckyFileInfo();
    this.info.name = this.fileName;
    this.info.creator = creator.length > 0 ? creator[0].value : '';
    this.info.lastmodifiedby = lastModifiedBy.length > 0 ? lastModifiedBy[0].value : '';
    this.info.createdTime = created.length > 0 ? created[0].value : '';
    this.info.modifiedTime = modified.length > 0 ? modified[0].value : '';
    this.info.company = Company.length > 0 ? Company[0].value : '';
    this.info.appversion = AppVersion.length > 0 ? AppVersion[0].value : '';
  };
  /**
   * @return All sheet , include whole information
   */


  LuckyFile.prototype.getSheetsFull = function (isInitialCell) {
    if (isInitialCell === void 0) {
      isInitialCell = true;
    }

    var sheets = this.readXml.getElementsByTagName('sheets/sheet', workBookFile);
    var sheetList = {};

    for (var key in sheets) {
      var sheet = sheets[key];
      sheetList[sheet.attributeList.name] = sheet.attributeList['sheetId'];
    }

    this.sheets = [];
    var order = 0;

    for (var key in sheets) {
      var sheet = sheets[key];
      var sheetName = sheet.attributeList.name;
      var sheetId = sheet.attributeList['sheetId'];
      var rid = sheet.attributeList['r:id'];
      var sheetFile = this.getSheetFileBysheetId(rid);
      var drawing = this.readXml.getElementsByTagName('worksheet/drawing', sheetFile),
          drawingFile = void 0,
          drawingRelsFile = void 0;

      if (drawing != null && drawing.length > 0) {
        var attrList = drawing[0].attributeList;
        var rid_1 = getXmlAttibute(attrList, 'r:id', null);

        if (rid_1 != null) {
          drawingFile = this.getDrawingFile(rid_1, sheetFile);
          drawingRelsFile = this.getDrawingRelsFile(drawingFile);
        }
      }

      if (sheetFile != null) {
        var sheet_1 = new LuckySheet(sheetName, sheetId, order, isInitialCell, {
          sheetFile: sheetFile,
          readXml: this.readXml,
          sheetList: sheetList,
          styles: this.styles,
          sharedStrings: this.sharedStrings,
          calcChain: this.calcChain,
          imageList: this.imageList,
          drawingFile: drawingFile,
          drawingRelsFile: drawingRelsFile
        });
        this.columnWidthSet = [];
        this.rowHeightSet = [];
        this.imagePositionCaculation(sheet_1);
        this.sheets.push(sheet_1);
        order++;
      }
    }
  };

  LuckyFile.prototype.extendArray = function (index, sets, def, hidden, lens) {
    if (index < sets.length) {
      return;
    }

    var startIndex = sets.length,
        endIndex = index;
    var allGap = 0;

    if (startIndex > 0) {
      allGap = sets[startIndex - 1];
    } // else{
    //     sets.push(0);
    // }


    for (var i = startIndex; i <= endIndex; i++) {
      var gap = def,
          istring = i.toString();

      if (istring in hidden) {
        gap = 0;
      } else if (istring in lens) {
        gap = lens[istring];
      }

      allGap += Math.round(gap + 1);
      sets.push(allGap);
    }
  };

  LuckyFile.prototype.imagePositionCaculation = function (sheet) {
    var images = sheet.images,
        defaultColWidth = sheet.defaultColWidth,
        defaultRowHeight = sheet.defaultRowHeight;
    var colhidden = {};

    if (sheet.config.colhidden) {
      colhidden = sheet.config.colhidden;
    }

    var columnlen = {};

    if (sheet.config.columnlen) {
      columnlen = sheet.config.columnlen;
    }

    var rowhidden = {};

    if (sheet.config.rowhidden) {
      rowhidden = sheet.config.rowhidden;
    }

    var rowlen = {};

    if (sheet.config.rowlen) {
      rowlen = sheet.config.rowlen;
    }

    for (var key in images) {
      var imageObject = images[key]; //Image, luckyImage

      var fromCol = imageObject.fromCol;
      var fromColOff = imageObject.fromColOff;
      var fromRow = imageObject.fromRow;
      var fromRowOff = imageObject.fromRowOff;
      var toCol = imageObject.toCol;
      var toColOff = imageObject.toColOff;
      var toRow = imageObject.toRow;
      var toRowOff = imageObject.toRowOff;
      var x_n = 0,
          y_n = 0;
      var cx_n = 0,
          cy_n = 0;

      if (fromCol >= this.columnWidthSet.length) {
        this.extendArray(fromCol, this.columnWidthSet, defaultColWidth, colhidden, columnlen);
      }

      if (fromCol == 0) {
        x_n = 0;
      } else {
        x_n = this.columnWidthSet[fromCol - 1];
      }

      x_n = x_n + fromColOff;

      if (fromRow >= this.rowHeightSet.length) {
        this.extendArray(fromRow, this.rowHeightSet, defaultRowHeight, rowhidden, rowlen);
      }

      if (fromRow == 0) {
        y_n = 0;
      } else {
        y_n = this.rowHeightSet[fromRow - 1];
      }

      y_n = y_n + fromRowOff;

      if (toCol >= this.columnWidthSet.length) {
        this.extendArray(toCol, this.columnWidthSet, defaultColWidth, colhidden, columnlen);
      }

      if (toCol == 0) {
        cx_n = 0;
      } else {
        cx_n = this.columnWidthSet[toCol - 1];
      }

      cx_n = cx_n + toColOff - x_n;

      if (toRow >= this.rowHeightSet.length) {
        this.extendArray(toRow, this.rowHeightSet, defaultRowHeight, rowhidden, rowlen);
      }

      if (toRow == 0) {
        cy_n = 0;
      } else {
        cy_n = this.rowHeightSet[toRow - 1];
      }

      cy_n = cy_n + toRowOff - y_n; // console.log(defaultColWidth, colhidden, columnlen);
      // console.log(fromCol, this.columnWidthSet[fromCol], fromColOff);
      // console.log(toCol, this.columnWidthSet[toCol], toColOff, JSON.stringify(this.columnWidthSet));

      imageObject.originWidth = cx_n;
      imageObject.originHeight = cy_n;
      imageObject.crop.height = cy_n;
      imageObject.crop.width = cx_n;
      imageObject.default.height = cy_n;
      imageObject.default.left = x_n;
      imageObject.default.top = y_n;
      imageObject.default.width = cx_n;
    } // console.log(this.columnWidthSet, this.rowHeightSet);

  };
  /**
   * @return drawing file string
   */


  LuckyFile.prototype.getDrawingFile = function (rid, sheetFile) {
    var sheetRelsPath = 'xl/worksheets/_rels/';
    var sheetFileArr = sheetFile.split('/');
    var sheetRelsName = sheetFileArr[sheetFileArr.length - 1];
    var sheetRelsFile = sheetRelsPath + sheetRelsName + '.rels';
    var drawing = this.readXml.getElementsByTagName('Relationships/Relationship', sheetRelsFile);

    if (drawing.length > 0) {
      for (var i = 0; i < drawing.length; i++) {
        var relationship = drawing[i];
        var attrList = relationship.attributeList;
        var relationshipId = getXmlAttibute(attrList, 'Id', null);

        if (relationshipId == rid) {
          var target = getXmlAttibute(attrList, 'Target', null);

          if (target != null) {
            return target.replace(/\.\.\//g, '');
          }
        }
      }
    }

    return null;
  };

  LuckyFile.prototype.getDrawingRelsFile = function (drawingFile) {
    var drawingRelsPath = 'xl/drawings/_rels/';
    var drawingFileArr = drawingFile.split('/');
    var drawingRelsName = drawingFileArr[drawingFileArr.length - 1];
    var drawingRelsFile = drawingRelsPath + drawingRelsName + '.rels';
    return drawingRelsFile;
  };
  /**
   * @return All sheet base information widthout cell and config
   */


  LuckyFile.prototype.getSheetsWithoutCell = function () {
    this.getSheetsFull(false);
  };
  /**
   * @return LuckySheet file json
   */


  LuckyFile.prototype.Parse = function () {
    // let xml = this.readXml;
    // for(let key in this.sheetNameList){
    //     let sheetName=this.sheetNameList[key];
    //     let sheetColumns = xml.getElementsByTagName("row/c/f", sheetName);
    //     console.log(sheetColumns);
    // }
    // return "";
    this.getWorkBookInfo();
    this.getSheetsFull(); // for(let i=0;i<this.sheets.length;i++){
    //     let sheet = this.sheets[i];
    //     let _borderInfo = sheet.config._borderInfo;
    //     if(_borderInfo==null){
    //         continue;
    //     }
    //     let _borderInfoKeys = Object.keys(_borderInfo);
    //     _borderInfoKeys.sort();
    //     for(let a=0;a<_borderInfoKeys.length;a++){
    //         let key = parseInt(_borderInfoKeys[a]);
    //         let b = _borderInfo[key];
    //         if(b.cells.length==0){
    //             continue;
    //         }
    //         if(sheet.config.borderInfo==null){
    //             sheet.config.borderInfo = [];
    //         }
    //         sheet.config.borderInfo.push(b);
    //     }
    // }

    return this.toJsonString(this);
  };

  LuckyFile.prototype.toJsonString = function (file) {
    var LuckyOutPutFile = new LuckyFileBase();
    LuckyOutPutFile.info = file.info;
    LuckyOutPutFile.sheets = [];
    file.sheets.forEach(function (sheet) {
      var sheetout = new LuckySheetBase(); //let attrName = ["name","color","config","index","status","order","row","column","luckysheet_select_save","scrollLeft","scrollTop","zoomRatio","showGridLines","defaultColWidth","defaultRowHeight","celldata","chart","isPivotTable","pivotTable","luckysheet_conditionformat_save","freezen","calcChain"];

      if (sheet.name != null) {
        sheetout.name = sheet.name;
      }

      if (sheet.color != null) {
        sheetout.color = sheet.color;
      }

      if (sheet.config != null) {
        sheetout.config = sheet.config; // if(sheetout.config._borderInfo!=null){
        //     delete sheetout.config._borderInfo;
        // }
      }

      if (sheet.index != null) {
        sheetout.index = sheet.index;
      }

      if (sheet.status != null) {
        sheetout.status = sheet.status;
      }

      if (sheet.order != null) {
        sheetout.order = sheet.order;
      }

      if (sheet.row != null) {
        sheetout.row = sheet.row;
      }

      if (sheet.column != null) {
        sheetout.column = sheet.column;
      }

      if (sheet.luckysheet_select_save != null) {
        sheetout.luckysheet_select_save = sheet.luckysheet_select_save;
      }

      if (sheet.scrollLeft != null) {
        sheetout.scrollLeft = sheet.scrollLeft;
      }

      if (sheet.scrollTop != null) {
        sheetout.scrollTop = sheet.scrollTop;
      }

      if (sheet.zoomRatio != null) {
        sheetout.zoomRatio = sheet.zoomRatio;
      }

      if (sheet.showGridLines != null) {
        sheetout.showGridLines = sheet.showGridLines;
      }

      if (sheet.freeze != null) {
        sheetout.freeze = sheet.freeze;
      }

      if (sheet.defaultColWidth != null) {
        sheetout.defaultColWidth = sheet.defaultColWidth;
      }

      if (sheet.defaultRowHeight != null) {
        sheetout.defaultRowHeight = sheet.defaultRowHeight;
      }

      if (sheet.celldata != null) {
        // sheetout.celldata = sheet.celldata;
        sheetout.celldata = [];
        sheet.celldata.forEach(function (cell) {
          var cellout = new LuckySheetCelldataBase();
          cellout.r = cell.r;
          cellout.c = cell.c;
          cellout.v = cell.v;
          sheetout.celldata.push(cellout);
        });
      }

      if (sheet.chart != null) {
        sheetout.chart = sheet.chart;
      }

      if (sheet.isPivotTable != null) {
        sheetout.isPivotTable = sheet.isPivotTable;
      }

      if (sheet.pivotTable != null) {
        sheetout.pivotTable = sheet.pivotTable;
      }

      if (sheet.luckysheet_conditionformat_save != null) {
        sheetout.luckysheet_conditionformat_save = sheet.luckysheet_conditionformat_save;
      }

      if (sheet.freezen != null) {
        sheetout.freezen = sheet.freezen;
      }

      if (sheet.calcChain != null) {
        sheetout.calcChain = sheet.calcChain;
      }

      if (sheet.images != null) {
        sheetout.images = sheet.images;
      }

      if (sheet.comments != null) {
        sheetout.comments = sheet.comments;
      }

      LuckyOutPutFile.sheets.push(sheetout);
    });
    return JSON.stringify(LuckyOutPutFile);
  };

  return LuckyFile;
}(LuckyFileBase);

var HandleZip =
/** @class */
function () {
  function HandleZip(file) {
    // Support nodejs fs to read files
    // if(file instanceof File){
    this.uploadFile = file; // }
  }

  HandleZip.prototype.unzipFile = function (successFunc, errorFunc) {
    // var new_zip:JSZip = new JSZip();
    JSZip__default['default'].loadAsync(this.uploadFile) // 1) read the Blob
    .then(function (zip) {
      var fileList = {},
          lastIndex = Object.keys(zip.files).length,
          index = 0;
      zip.forEach(function (relativePath, zipEntry) {
        var fileName = zipEntry.name;
        var fileNameArr = fileName.split('.');
        var suffix = fileNameArr[fileNameArr.length - 1].toLowerCase();
        var fileType = 'string';

        if (suffix in {
          png: 1,
          jpeg: 1,
          jpg: 1,
          gif: 1,
          bmp: 1,
          tif: 1,
          webp: 1
        }) {
          fileType = 'base64';
        } else if (suffix == 'emf') {
          fileType = 'arraybuffer';
        }

        zipEntry.async(fileType).then(function (data) {
          if (fileType == 'base64') {
            data = 'data:image/' + suffix + ';base64,' + data;
          }

          fileList[zipEntry.name] = data; // console.log(lastIndex, index);

          if (lastIndex == index + 1) {
            successFunc(fileList);
          }

          index++;
        });
      });
    }, function (e) {
      errorFunc(e);
    });
  };

  HandleZip.prototype.unzipFileByUrl = function (url, successFunc, errorFunc) {
    new JSZip__default['default']();
    getBinaryContent(url, function (err, data) {
      if (err) {
        throw err; // or handle err
      }

      JSZip__default['default'].loadAsync(data).then(function (zip) {
        var fileList = {},
            lastIndex = Object.keys(zip.files).length,
            index = 0;
        zip.forEach(function (relativePath, zipEntry) {
          var fileName = zipEntry.name;
          var fileNameArr = fileName.split('.');
          var suffix = fileNameArr[fileNameArr.length - 1].toLowerCase();
          var fileType = 'string';

          if (suffix in {
            png: 1,
            jpeg: 1,
            jpg: 1,
            gif: 1,
            bmp: 1,
            tif: 1,
            webp: 1
          }) {
            fileType = 'base64';
          } else if (suffix == 'emf') {
            fileType = 'arraybuffer';
          }

          zipEntry.async(fileType).then(function (data) {
            if (fileType == 'base64') {
              data = 'data:image/' + suffix + ';base64,' + data;
            }

            fileList[zipEntry.name] = data; // console.log(lastIndex, index);

            if (lastIndex == index + 1) {
              successFunc(fileList);
            }

            index++;
          });
        });
      }, function (e) {
        errorFunc(e);
      });
    });
  };

  HandleZip.prototype.newZipFile = function () {
    var zip = new JSZip__default['default']();
    this.workBook = zip;
  }; //title:"nested/hello.txt", content:"Hello Worldasdfasfasdfasfasfasfasfasdfas"


  HandleZip.prototype.addToZipFile = function (title, content) {
    if (this.workBook == null) {
      var zip = new JSZip__default['default']();
      this.workBook = zip;
    }

    this.workBook.file(title, content);
  };

  return HandleZip;
}(); // //demo
// function demoHandler(){
//     let upload = document.getElementById("Luckyexcel-demo-file");
//     let selectADemo = document.getElementById("Luckyexcel-select-demo");
//     let downlodDemo = document.getElementById("Luckyexcel-downlod-file");
//     let mask = document.getElementById("lucky-mask-demo");
//     if(upload){
//         window.onload = () => {
//             upload.addEventListener("change", function(evt){
//                 var files:FileList = (evt.target as any).files;
//                 if(files==null || files.length==0){
//                     alert("No files wait for import");
//                     return;
//                 }
//                 let name = files[0].name;
//                 let suffixArr = name.split("."), suffix = suffixArr[suffixArr.length-1];
//                 if(suffix!="xlsx"){
//                     alert("Currently only supports the import of xlsx files");
//                     return;
//                 }
//                 LuckyExcel.transformExcelToLucky(files[0], function(exportJson:any, luckysheetfile:string){
//                     if(exportJson.sheets==null || exportJson.sheets.length==0){
//                         alert("Failed to read the content of the excel file, currently does not support xls files!");
//                         return;
//                     }
//                     console.log(exportJson, luckysheetfile);
//                     window.luckysheet.destroy();
//                     window.luckysheet.create({
//                         container: 'luckysheet', //luckysheet is the container id
//                         showinfobar:false,
//                         data:exportJson.sheets,
//                         title:exportJson.info.name,
//                         userInfo:exportJson.info.name.creator
//                     });
//                 });
//             });
//             selectADemo.addEventListener("change", function(evt){
//                 var obj:any = selectADemo;
//                 var index = obj.selectedIndex;
//                 var value = obj.options[index].value;
//                 var name = obj.options[index].innerHTML;
//                 if(value==""){
//                     return;
//                 }
//                 mask.style.display = "flex";
//                 LuckyExcel.transformExcelToLuckyByUrl(value, name, function(exportJson:any, luckysheetfile:string){
//                     if(exportJson.sheets==null || exportJson.sheets.length==0){
//                         alert("Failed to read the content of the excel file, currently does not support xls files!");
//                         return;
//                     }
//                     console.log(exportJson, luckysheetfile);
//                     mask.style.display = "none";
//                     window.luckysheet.destroy();
//                     window.luckysheet.create({
//                         container: 'luckysheet', //luckysheet is the container id
//                         showinfobar:false,
//                         data:exportJson.sheets,
//                         title:exportJson.info.name,
//                         userInfo:exportJson.info.name.creator
//                     });
//                 });
//             });
//             downlodDemo.addEventListener("click", function(evt){
//                 var obj:any = selectADemo;
//                 var index = obj.selectedIndex;
//                 var value = obj.options[index].value;
//                 if(value.length==0){
//                     alert("Please select a demo file");
//                     return;
//                 }
//                 var elemIF:any = document.getElementById("Lucky-download-frame");
//                 if(elemIF==null){
//                     elemIF = document.createElement("iframe");
//                     elemIF.style.display = "none";
//                     elemIF.id = "Lucky-download-frame";
//                     document.body.appendChild(elemIF);
//                 }
//                 elemIF.src = value;
//                 // elemIF.parentNode.removeChild(elemIF);
//             });
//         }
//     }
// }
// demoHandler();
// api


var LuckyExcel =
/** @class */
function () {
  function LuckyExcel() {}

  LuckyExcel.transformExcelToLucky = function (excelFile, callBack) {
    var handleZip = new HandleZip(excelFile);
    handleZip.unzipFile(function (files) {
      var isClientImport = Object.keys(files).some(function (f) {
        return f.includes('.meta');
      });
      var luckyFile = new LuckyFile(files, excelFile.name);
      var luckysheetfile = luckyFile.Parse();
      var exportJson = JSON.parse(luckysheetfile);

      if (callBack != undefined) {
        callBack(exportJson, luckysheetfile, isClientImport);
      }
    }, function (err) {
      console.error(err);
    });
  };

  LuckyExcel.transformExcelToLuckyByUrl = function (url, name, callBack) {
    var handleZip = new HandleZip();
    handleZip.unzipFileByUrl(url, function (files) {
      var isClientImport = Object.keys(files).some(function (f) {
        return f.includes('.meta');
      });
      var luckyFile = new LuckyFile(files, name);
      var luckysheetfile = luckyFile.Parse();
      var exportJson = JSON.parse(luckysheetfile);

      if (callBack != undefined) {
        callBack(exportJson, luckysheetfile, isClientImport);
      }
    }, function (err) {
      console.error(err);
    });
  };

  LuckyExcel.transformLuckyToExcel = function (LuckyFile, callBack) {};

  return LuckyExcel;
}();

module.exports = LuckyExcel;

/***/ }),

/***/ "e163":
/***/ (function(module, exports, __webpack_require__) {

var global = __webpack_require__("da84");
var hasOwn = __webpack_require__("1a2d");
var isCallable = __webpack_require__("1626");
var toObject = __webpack_require__("7b0b");
var sharedKey = __webpack_require__("f772");
var CORRECT_PROTOTYPE_GETTER = __webpack_require__("e177");

var IE_PROTO = sharedKey('IE_PROTO');
var Object = global.Object;
var ObjectPrototype = Object.prototype;

// `Object.getPrototypeOf` method
// https://tc39.es/ecma262/#sec-object.getprototypeof
module.exports = CORRECT_PROTOTYPE_GETTER ? Object.getPrototypeOf : function (O) {
  var object = toObject(O);
  if (hasOwn(object, IE_PROTO)) return object[IE_PROTO];
  var constructor = object.constructor;
  if (isCallable(constructor) && object instanceof constructor) {
    return constructor.prototype;
  } return object instanceof Object ? ObjectPrototype : null;
};


/***/ }),

/***/ "e177":
/***/ (function(module, exports, __webpack_require__) {

var fails = __webpack_require__("d039");

module.exports = !fails(function () {
  function F() { /* empty */ }
  F.prototype.constructor = null;
  // eslint-disable-next-line es/no-object-getprototypeof -- required for testing
  return Object.getPrototypeOf(new F()) !== F.prototype;
});


/***/ }),

/***/ "e260":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var toIndexedObject = __webpack_require__("fc6a");
var addToUnscopables = __webpack_require__("44d2");
var Iterators = __webpack_require__("3f8c");
var InternalStateModule = __webpack_require__("69f3");
var defineIterator = __webpack_require__("7dd0");

var ARRAY_ITERATOR = 'Array Iterator';
var setInternalState = InternalStateModule.set;
var getInternalState = InternalStateModule.getterFor(ARRAY_ITERATOR);

// `Array.prototype.entries` method
// https://tc39.es/ecma262/#sec-array.prototype.entries
// `Array.prototype.keys` method
// https://tc39.es/ecma262/#sec-array.prototype.keys
// `Array.prototype.values` method
// https://tc39.es/ecma262/#sec-array.prototype.values
// `Array.prototype[@@iterator]` method
// https://tc39.es/ecma262/#sec-array.prototype-@@iterator
// `CreateArrayIterator` internal method
// https://tc39.es/ecma262/#sec-createarrayiterator
module.exports = defineIterator(Array, 'Array', function (iterated, kind) {
  setInternalState(this, {
    type: ARRAY_ITERATOR,
    target: toIndexedObject(iterated), // target
    index: 0,                          // next index
    kind: kind                         // kind
  });
// `%ArrayIteratorPrototype%.next` method
// https://tc39.es/ecma262/#sec-%arrayiteratorprototype%.next
}, function () {
  var state = getInternalState(this);
  var target = state.target;
  var kind = state.kind;
  var index = state.index++;
  if (!target || index >= target.length) {
    state.target = undefined;
    return { value: undefined, done: true };
  }
  if (kind == 'keys') return { value: index, done: false };
  if (kind == 'values') return { value: target[index], done: false };
  return { value: [index, target[index]], done: false };
}, 'values');

// argumentsList[@@iterator] is %ArrayProto_values%
// https://tc39.es/ecma262/#sec-createunmappedargumentsobject
// https://tc39.es/ecma262/#sec-createmappedargumentsobject
Iterators.Arguments = Iterators.Array;

// https://tc39.es/ecma262/#sec-array.prototype-@@unscopables
addToUnscopables('keys');
addToUnscopables('values');
addToUnscopables('entries');


/***/ }),

/***/ "e285":
/***/ (function(module, exports, __webpack_require__) {

var global = __webpack_require__("da84");

var globalIsFinite = global.isFinite;

// `Number.isFinite` method
// https://tc39.es/ecma262/#sec-number.isfinite
// eslint-disable-next-line es/no-number-isfinite -- safe
module.exports = Number.isFinite || function isFinite(it) {
  return typeof it == 'number' && globalIsFinite(it);
};


/***/ }),

/***/ "e2cc":
/***/ (function(module, exports, __webpack_require__) {

var redefine = __webpack_require__("6eeb");

module.exports = function (target, src, options) {
  for (var key in src) redefine(target, key, src[key], options);
  return target;
};


/***/ }),

/***/ "e330":
/***/ (function(module, exports) {

var FunctionPrototype = Function.prototype;
var bind = FunctionPrototype.bind;
var call = FunctionPrototype.call;
var callBind = bind && bind.bind(call);

module.exports = bind ? function (fn) {
  return fn && callBind(call, fn);
} : function (fn) {
  return fn && function () {
    return call.apply(fn, arguments);
  };
};


/***/ }),

/***/ "e3db":
/***/ (function(module, exports) {

var toString = {}.toString;

module.exports = Array.isArray || function (arr) {
  return toString.call(arr) == '[object Array]';
};


/***/ }),

/***/ "e439":
/***/ (function(module, exports, __webpack_require__) {

var $ = __webpack_require__("23e7");
var fails = __webpack_require__("d039");
var toIndexedObject = __webpack_require__("fc6a");
var nativeGetOwnPropertyDescriptor = __webpack_require__("06cf").f;
var DESCRIPTORS = __webpack_require__("83ab");

var FAILS_ON_PRIMITIVES = fails(function () { nativeGetOwnPropertyDescriptor(1); });
var FORCED = !DESCRIPTORS || FAILS_ON_PRIMITIVES;

// `Object.getOwnPropertyDescriptor` method
// https://tc39.es/ecma262/#sec-object.getownpropertydescriptor
$({ target: 'Object', stat: true, forced: FORCED, sham: !DESCRIPTORS }, {
  getOwnPropertyDescriptor: function getOwnPropertyDescriptor(it, key) {
    return nativeGetOwnPropertyDescriptor(toIndexedObject(it), key);
  }
});


/***/ }),

/***/ "e538":
/***/ (function(module, exports, __webpack_require__) {

var wellKnownSymbol = __webpack_require__("b622");

exports.f = wellKnownSymbol;


/***/ }),

/***/ "e58c":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

/* eslint-disable es/no-array-prototype-lastindexof -- safe */
var apply = __webpack_require__("2ba4");
var toIndexedObject = __webpack_require__("fc6a");
var toIntegerOrInfinity = __webpack_require__("5926");
var lengthOfArrayLike = __webpack_require__("07fa");
var arrayMethodIsStrict = __webpack_require__("a640");

var min = Math.min;
var $lastIndexOf = [].lastIndexOf;
var NEGATIVE_ZERO = !!$lastIndexOf && 1 / [1].lastIndexOf(1, -0) < 0;
var STRICT_METHOD = arrayMethodIsStrict('lastIndexOf');
var FORCED = NEGATIVE_ZERO || !STRICT_METHOD;

// `Array.prototype.lastIndexOf` method implementation
// https://tc39.es/ecma262/#sec-array.prototype.lastindexof
module.exports = FORCED ? function lastIndexOf(searchElement /* , fromIndex = @[*-1] */) {
  // convert -0 to +0
  if (NEGATIVE_ZERO) return apply($lastIndexOf, this, arguments) || 0;
  var O = toIndexedObject(this);
  var length = lengthOfArrayLike(O);
  var index = length - 1;
  if (arguments.length > 1) index = min(index, toIntegerOrInfinity(arguments[1]));
  if (index < 0) index = length + index;
  for (;index >= 0; index--) if (index in O && O[index] === searchElement) return index || 0;
  return -1;
} : $lastIndexOf;


/***/ }),

/***/ "e667":
/***/ (function(module, exports) {

module.exports = function (exec) {
  try {
    return { error: false, value: exec() };
  } catch (error) {
    return { error: true, value: error };
  }
};


/***/ }),

/***/ "e6cf":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var $ = __webpack_require__("23e7");
var IS_PURE = __webpack_require__("c430");
var global = __webpack_require__("da84");
var getBuiltIn = __webpack_require__("d066");
var call = __webpack_require__("c65b");
var NativePromise = __webpack_require__("fea9");
var redefine = __webpack_require__("6eeb");
var redefineAll = __webpack_require__("e2cc");
var setPrototypeOf = __webpack_require__("d2bb");
var setToStringTag = __webpack_require__("d44e");
var setSpecies = __webpack_require__("2626");
var aCallable = __webpack_require__("59ed");
var isCallable = __webpack_require__("1626");
var isObject = __webpack_require__("861d");
var anInstance = __webpack_require__("19aa");
var inspectSource = __webpack_require__("8925");
var iterate = __webpack_require__("2266");
var checkCorrectnessOfIteration = __webpack_require__("1c7e");
var speciesConstructor = __webpack_require__("4840");
var task = __webpack_require__("2cf4").set;
var microtask = __webpack_require__("b575");
var promiseResolve = __webpack_require__("cdf9");
var hostReportErrors = __webpack_require__("44de");
var newPromiseCapabilityModule = __webpack_require__("f069");
var perform = __webpack_require__("e667");
var InternalStateModule = __webpack_require__("69f3");
var isForced = __webpack_require__("94ca");
var wellKnownSymbol = __webpack_require__("b622");
var IS_BROWSER = __webpack_require__("6069");
var IS_NODE = __webpack_require__("605d");
var V8_VERSION = __webpack_require__("2d00");

var SPECIES = wellKnownSymbol('species');
var PROMISE = 'Promise';

var getInternalState = InternalStateModule.get;
var setInternalState = InternalStateModule.set;
var getInternalPromiseState = InternalStateModule.getterFor(PROMISE);
var NativePromisePrototype = NativePromise && NativePromise.prototype;
var PromiseConstructor = NativePromise;
var PromisePrototype = NativePromisePrototype;
var TypeError = global.TypeError;
var document = global.document;
var process = global.process;
var newPromiseCapability = newPromiseCapabilityModule.f;
var newGenericPromiseCapability = newPromiseCapability;

var DISPATCH_EVENT = !!(document && document.createEvent && global.dispatchEvent);
var NATIVE_REJECTION_EVENT = isCallable(global.PromiseRejectionEvent);
var UNHANDLED_REJECTION = 'unhandledrejection';
var REJECTION_HANDLED = 'rejectionhandled';
var PENDING = 0;
var FULFILLED = 1;
var REJECTED = 2;
var HANDLED = 1;
var UNHANDLED = 2;
var SUBCLASSING = false;

var Internal, OwnPromiseCapability, PromiseWrapper, nativeThen;

var FORCED = isForced(PROMISE, function () {
  var PROMISE_CONSTRUCTOR_SOURCE = inspectSource(PromiseConstructor);
  var GLOBAL_CORE_JS_PROMISE = PROMISE_CONSTRUCTOR_SOURCE !== String(PromiseConstructor);
  // V8 6.6 (Node 10 and Chrome 66) have a bug with resolving custom thenables
  // https://bugs.chromium.org/p/chromium/issues/detail?id=830565
  // We can't detect it synchronously, so just check versions
  if (!GLOBAL_CORE_JS_PROMISE && V8_VERSION === 66) return true;
  // We need Promise#finally in the pure version for preventing prototype pollution
  if (IS_PURE && !PromisePrototype['finally']) return true;
  // We can't use @@species feature detection in V8 since it causes
  // deoptimization and performance degradation
  // https://github.com/zloirock/core-js/issues/679
  if (V8_VERSION >= 51 && /native code/.test(PROMISE_CONSTRUCTOR_SOURCE)) return false;
  // Detect correctness of subclassing with @@species support
  var promise = new PromiseConstructor(function (resolve) { resolve(1); });
  var FakePromise = function (exec) {
    exec(function () { /* empty */ }, function () { /* empty */ });
  };
  var constructor = promise.constructor = {};
  constructor[SPECIES] = FakePromise;
  SUBCLASSING = promise.then(function () { /* empty */ }) instanceof FakePromise;
  if (!SUBCLASSING) return true;
  // Unhandled rejections tracking support, NodeJS Promise without it fails @@species test
  return !GLOBAL_CORE_JS_PROMISE && IS_BROWSER && !NATIVE_REJECTION_EVENT;
});

var INCORRECT_ITERATION = FORCED || !checkCorrectnessOfIteration(function (iterable) {
  PromiseConstructor.all(iterable)['catch'](function () { /* empty */ });
});

// helpers
var isThenable = function (it) {
  var then;
  return isObject(it) && isCallable(then = it.then) ? then : false;
};

var notify = function (state, isReject) {
  if (state.notified) return;
  state.notified = true;
  var chain = state.reactions;
  microtask(function () {
    var value = state.value;
    var ok = state.state == FULFILLED;
    var index = 0;
    // variable length - can't use forEach
    while (chain.length > index) {
      var reaction = chain[index++];
      var handler = ok ? reaction.ok : reaction.fail;
      var resolve = reaction.resolve;
      var reject = reaction.reject;
      var domain = reaction.domain;
      var result, then, exited;
      try {
        if (handler) {
          if (!ok) {
            if (state.rejection === UNHANDLED) onHandleUnhandled(state);
            state.rejection = HANDLED;
          }
          if (handler === true) result = value;
          else {
            if (domain) domain.enter();
            result = handler(value); // can throw
            if (domain) {
              domain.exit();
              exited = true;
            }
          }
          if (result === reaction.promise) {
            reject(TypeError('Promise-chain cycle'));
          } else if (then = isThenable(result)) {
            call(then, result, resolve, reject);
          } else resolve(result);
        } else reject(value);
      } catch (error) {
        if (domain && !exited) domain.exit();
        reject(error);
      }
    }
    state.reactions = [];
    state.notified = false;
    if (isReject && !state.rejection) onUnhandled(state);
  });
};

var dispatchEvent = function (name, promise, reason) {
  var event, handler;
  if (DISPATCH_EVENT) {
    event = document.createEvent('Event');
    event.promise = promise;
    event.reason = reason;
    event.initEvent(name, false, true);
    global.dispatchEvent(event);
  } else event = { promise: promise, reason: reason };
  if (!NATIVE_REJECTION_EVENT && (handler = global['on' + name])) handler(event);
  else if (name === UNHANDLED_REJECTION) hostReportErrors('Unhandled promise rejection', reason);
};

var onUnhandled = function (state) {
  call(task, global, function () {
    var promise = state.facade;
    var value = state.value;
    var IS_UNHANDLED = isUnhandled(state);
    var result;
    if (IS_UNHANDLED) {
      result = perform(function () {
        if (IS_NODE) {
          process.emit('unhandledRejection', value, promise);
        } else dispatchEvent(UNHANDLED_REJECTION, promise, value);
      });
      // Browsers should not trigger `rejectionHandled` event if it was handled here, NodeJS - should
      state.rejection = IS_NODE || isUnhandled(state) ? UNHANDLED : HANDLED;
      if (result.error) throw result.value;
    }
  });
};

var isUnhandled = function (state) {
  return state.rejection !== HANDLED && !state.parent;
};

var onHandleUnhandled = function (state) {
  call(task, global, function () {
    var promise = state.facade;
    if (IS_NODE) {
      process.emit('rejectionHandled', promise);
    } else dispatchEvent(REJECTION_HANDLED, promise, state.value);
  });
};

var bind = function (fn, state, unwrap) {
  return function (value) {
    fn(state, value, unwrap);
  };
};

var internalReject = function (state, value, unwrap) {
  if (state.done) return;
  state.done = true;
  if (unwrap) state = unwrap;
  state.value = value;
  state.state = REJECTED;
  notify(state, true);
};

var internalResolve = function (state, value, unwrap) {
  if (state.done) return;
  state.done = true;
  if (unwrap) state = unwrap;
  try {
    if (state.facade === value) throw TypeError("Promise can't be resolved itself");
    var then = isThenable(value);
    if (then) {
      microtask(function () {
        var wrapper = { done: false };
        try {
          call(then, value,
            bind(internalResolve, wrapper, state),
            bind(internalReject, wrapper, state)
          );
        } catch (error) {
          internalReject(wrapper, error, state);
        }
      });
    } else {
      state.value = value;
      state.state = FULFILLED;
      notify(state, false);
    }
  } catch (error) {
    internalReject({ done: false }, error, state);
  }
};

// constructor polyfill
if (FORCED) {
  // 25.4.3.1 Promise(executor)
  PromiseConstructor = function Promise(executor) {
    anInstance(this, PromisePrototype);
    aCallable(executor);
    call(Internal, this);
    var state = getInternalState(this);
    try {
      executor(bind(internalResolve, state), bind(internalReject, state));
    } catch (error) {
      internalReject(state, error);
    }
  };
  PromisePrototype = PromiseConstructor.prototype;
  // eslint-disable-next-line no-unused-vars -- required for `.length`
  Internal = function Promise(executor) {
    setInternalState(this, {
      type: PROMISE,
      done: false,
      notified: false,
      parent: false,
      reactions: [],
      rejection: false,
      state: PENDING,
      value: undefined
    });
  };
  Internal.prototype = redefineAll(PromisePrototype, {
    // `Promise.prototype.then` method
    // https://tc39.es/ecma262/#sec-promise.prototype.then
    then: function then(onFulfilled, onRejected) {
      var state = getInternalPromiseState(this);
      var reactions = state.reactions;
      var reaction = newPromiseCapability(speciesConstructor(this, PromiseConstructor));
      reaction.ok = isCallable(onFulfilled) ? onFulfilled : true;
      reaction.fail = isCallable(onRejected) && onRejected;
      reaction.domain = IS_NODE ? process.domain : undefined;
      state.parent = true;
      reactions[reactions.length] = reaction;
      if (state.state != PENDING) notify(state, false);
      return reaction.promise;
    },
    // `Promise.prototype.catch` method
    // https://tc39.es/ecma262/#sec-promise.prototype.catch
    'catch': function (onRejected) {
      return this.then(undefined, onRejected);
    }
  });
  OwnPromiseCapability = function () {
    var promise = new Internal();
    var state = getInternalState(promise);
    this.promise = promise;
    this.resolve = bind(internalResolve, state);
    this.reject = bind(internalReject, state);
  };
  newPromiseCapabilityModule.f = newPromiseCapability = function (C) {
    return C === PromiseConstructor || C === PromiseWrapper
      ? new OwnPromiseCapability(C)
      : newGenericPromiseCapability(C);
  };

  if (!IS_PURE && isCallable(NativePromise) && NativePromisePrototype !== Object.prototype) {
    nativeThen = NativePromisePrototype.then;

    if (!SUBCLASSING) {
      // make `Promise#then` return a polyfilled `Promise` for native promise-based APIs
      redefine(NativePromisePrototype, 'then', function then(onFulfilled, onRejected) {
        var that = this;
        return new PromiseConstructor(function (resolve, reject) {
          call(nativeThen, that, resolve, reject);
        }).then(onFulfilled, onRejected);
      // https://github.com/zloirock/core-js/issues/640
      }, { unsafe: true });

      // makes sure that native promise-based APIs `Promise#catch` properly works with patched `Promise#then`
      redefine(NativePromisePrototype, 'catch', PromisePrototype['catch'], { unsafe: true });
    }

    // make `.constructor === Promise` work for native promise-based APIs
    try {
      delete NativePromisePrototype.constructor;
    } catch (error) { /* empty */ }

    // make `instanceof Promise` work for native promise-based APIs
    if (setPrototypeOf) {
      setPrototypeOf(NativePromisePrototype, PromisePrototype);
    }
  }
}

$({ global: true, wrap: true, forced: FORCED }, {
  Promise: PromiseConstructor
});

setToStringTag(PromiseConstructor, PROMISE, false, true);
setSpecies(PROMISE);

PromiseWrapper = getBuiltIn(PROMISE);

// statics
$({ target: PROMISE, stat: true, forced: FORCED }, {
  // `Promise.reject` method
  // https://tc39.es/ecma262/#sec-promise.reject
  reject: function reject(r) {
    var capability = newPromiseCapability(this);
    call(capability.reject, undefined, r);
    return capability.promise;
  }
});

$({ target: PROMISE, stat: true, forced: IS_PURE || FORCED }, {
  // `Promise.resolve` method
  // https://tc39.es/ecma262/#sec-promise.resolve
  resolve: function resolve(x) {
    return promiseResolve(IS_PURE && this === PromiseWrapper ? PromiseConstructor : this, x);
  }
});

$({ target: PROMISE, stat: true, forced: INCORRECT_ITERATION }, {
  // `Promise.all` method
  // https://tc39.es/ecma262/#sec-promise.all
  all: function all(iterable) {
    var C = this;
    var capability = newPromiseCapability(C);
    var resolve = capability.resolve;
    var reject = capability.reject;
    var result = perform(function () {
      var $promiseResolve = aCallable(C.resolve);
      var values = [];
      var counter = 0;
      var remaining = 1;
      iterate(iterable, function (promise) {
        var index = counter++;
        var alreadyCalled = false;
        remaining++;
        call($promiseResolve, C, promise).then(function (value) {
          if (alreadyCalled) return;
          alreadyCalled = true;
          values[index] = value;
          --remaining || resolve(values);
        }, reject);
      });
      --remaining || resolve(values);
    });
    if (result.error) reject(result.value);
    return capability.promise;
  },
  // `Promise.race` method
  // https://tc39.es/ecma262/#sec-promise.race
  race: function race(iterable) {
    var C = this;
    var capability = newPromiseCapability(C);
    var reject = capability.reject;
    var result = perform(function () {
      var $promiseResolve = aCallable(C.resolve);
      iterate(iterable, function (promise) {
        call($promiseResolve, C, promise).then(capability.resolve, reject);
      });
    });
    if (result.error) reject(result.value);
    return capability.promise;
  }
});


/***/ }),

/***/ "e893":
/***/ (function(module, exports, __webpack_require__) {

var hasOwn = __webpack_require__("1a2d");
var ownKeys = __webpack_require__("56ef");
var getOwnPropertyDescriptorModule = __webpack_require__("06cf");
var definePropertyModule = __webpack_require__("9bf2");

module.exports = function (target, source) {
  var keys = ownKeys(source);
  var defineProperty = definePropertyModule.f;
  var getOwnPropertyDescriptor = getOwnPropertyDescriptorModule.f;
  for (var i = 0; i < keys.length; i++) {
    var key = keys[i];
    if (!hasOwn(target, key)) defineProperty(target, key, getOwnPropertyDescriptor(source, key));
  }
};


/***/ }),

/***/ "e8b5":
/***/ (function(module, exports, __webpack_require__) {

var classof = __webpack_require__("c6b6");

// `IsArray` abstract operation
// https://tc39.es/ecma262/#sec-isarray
// eslint-disable-next-line es/no-array-isarray -- safe
module.exports = Array.isArray || function isArray(argument) {
  return classof(argument) == 'Array';
};


/***/ }),

/***/ "e91f":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var ArrayBufferViewCore = __webpack_require__("ebb5");
var $indexOf = __webpack_require__("4d64").indexOf;

var aTypedArray = ArrayBufferViewCore.aTypedArray;
var exportTypedArrayMethod = ArrayBufferViewCore.exportTypedArrayMethod;

// `%TypedArray%.prototype.indexOf` method
// https://tc39.es/ecma262/#sec-%typedarray%.prototype.indexof
exportTypedArrayMethod('indexOf', function indexOf(searchElement /* , fromIndex */) {
  return $indexOf(aTypedArray(this), searchElement, arguments.length > 1 ? arguments[1] : undefined);
});


/***/ }),

/***/ "e95a":
/***/ (function(module, exports, __webpack_require__) {

var wellKnownSymbol = __webpack_require__("b622");
var Iterators = __webpack_require__("3f8c");

var ITERATOR = wellKnownSymbol('iterator');
var ArrayPrototype = Array.prototype;

// check on default Array iterator
module.exports = function (it) {
  return it !== undefined && (Iterators.Array === it || ArrayPrototype[ITERATOR] === it);
};


/***/ }),

/***/ "e9c4":
/***/ (function(module, exports, __webpack_require__) {

var $ = __webpack_require__("23e7");
var global = __webpack_require__("da84");
var getBuiltIn = __webpack_require__("d066");
var apply = __webpack_require__("2ba4");
var uncurryThis = __webpack_require__("e330");
var fails = __webpack_require__("d039");

var Array = global.Array;
var $stringify = getBuiltIn('JSON', 'stringify');
var exec = uncurryThis(/./.exec);
var charAt = uncurryThis(''.charAt);
var charCodeAt = uncurryThis(''.charCodeAt);
var replace = uncurryThis(''.replace);
var numberToString = uncurryThis(1.0.toString);

var tester = /[\uD800-\uDFFF]/g;
var low = /^[\uD800-\uDBFF]$/;
var hi = /^[\uDC00-\uDFFF]$/;

var fix = function (match, offset, string) {
  var prev = charAt(string, offset - 1);
  var next = charAt(string, offset + 1);
  if ((exec(low, match) && !exec(hi, next)) || (exec(hi, match) && !exec(low, prev))) {
    return '\\u' + numberToString(charCodeAt(match, 0), 16);
  } return match;
};

var FORCED = fails(function () {
  return $stringify('\uDF06\uD834') !== '"\\udf06\\ud834"'
    || $stringify('\uDEAD') !== '"\\udead"';
});

if ($stringify) {
  // `JSON.stringify` method
  // https://tc39.es/ecma262/#sec-json.stringify
  // https://github.com/tc39/proposal-well-formed-stringify
  $({ target: 'JSON', stat: true, forced: FORCED }, {
    // eslint-disable-next-line no-unused-vars -- required for `.length`
    stringify: function stringify(it, replacer, space) {
      for (var i = 0, l = arguments.length, args = Array(l); i < l; i++) args[i] = arguments[i];
      var result = apply($stringify, null, args);
      return typeof result == 'string' ? replace(result, tester, fix) : result;
    }
  });
}


/***/ }),

/***/ "eac5":
/***/ (function(module, exports, __webpack_require__) {

var isObject = __webpack_require__("861d");

var floor = Math.floor;

// `IsIntegralNumber` abstract operation
// https://tc39.es/ecma262/#sec-isintegralnumber
// eslint-disable-next-line es/no-number-isinteger -- safe
module.exports = Number.isInteger || function isInteger(it) {
  return !isObject(it) && isFinite(it) && floor(it) === it;
};


/***/ }),

/***/ "ebb5":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var NATIVE_ARRAY_BUFFER = __webpack_require__("a981");
var DESCRIPTORS = __webpack_require__("83ab");
var global = __webpack_require__("da84");
var isCallable = __webpack_require__("1626");
var isObject = __webpack_require__("861d");
var hasOwn = __webpack_require__("1a2d");
var classof = __webpack_require__("f5df");
var tryToString = __webpack_require__("0d51");
var createNonEnumerableProperty = __webpack_require__("9112");
var redefine = __webpack_require__("6eeb");
var defineProperty = __webpack_require__("9bf2").f;
var isPrototypeOf = __webpack_require__("3a9b");
var getPrototypeOf = __webpack_require__("e163");
var setPrototypeOf = __webpack_require__("d2bb");
var wellKnownSymbol = __webpack_require__("b622");
var uid = __webpack_require__("90e3");

var Int8Array = global.Int8Array;
var Int8ArrayPrototype = Int8Array && Int8Array.prototype;
var Uint8ClampedArray = global.Uint8ClampedArray;
var Uint8ClampedArrayPrototype = Uint8ClampedArray && Uint8ClampedArray.prototype;
var TypedArray = Int8Array && getPrototypeOf(Int8Array);
var TypedArrayPrototype = Int8ArrayPrototype && getPrototypeOf(Int8ArrayPrototype);
var ObjectPrototype = Object.prototype;
var TypeError = global.TypeError;

var TO_STRING_TAG = wellKnownSymbol('toStringTag');
var TYPED_ARRAY_TAG = uid('TYPED_ARRAY_TAG');
var TYPED_ARRAY_CONSTRUCTOR = uid('TYPED_ARRAY_CONSTRUCTOR');
// Fixing native typed arrays in Opera Presto crashes the browser, see #595
var NATIVE_ARRAY_BUFFER_VIEWS = NATIVE_ARRAY_BUFFER && !!setPrototypeOf && classof(global.opera) !== 'Opera';
var TYPED_ARRAY_TAG_REQIRED = false;
var NAME, Constructor, Prototype;

var TypedArrayConstructorsList = {
  Int8Array: 1,
  Uint8Array: 1,
  Uint8ClampedArray: 1,
  Int16Array: 2,
  Uint16Array: 2,
  Int32Array: 4,
  Uint32Array: 4,
  Float32Array: 4,
  Float64Array: 8
};

var BigIntArrayConstructorsList = {
  BigInt64Array: 8,
  BigUint64Array: 8
};

var isView = function isView(it) {
  if (!isObject(it)) return false;
  var klass = classof(it);
  return klass === 'DataView'
    || hasOwn(TypedArrayConstructorsList, klass)
    || hasOwn(BigIntArrayConstructorsList, klass);
};

var isTypedArray = function (it) {
  if (!isObject(it)) return false;
  var klass = classof(it);
  return hasOwn(TypedArrayConstructorsList, klass)
    || hasOwn(BigIntArrayConstructorsList, klass);
};

var aTypedArray = function (it) {
  if (isTypedArray(it)) return it;
  throw TypeError('Target is not a typed array');
};

var aTypedArrayConstructor = function (C) {
  if (isCallable(C) && (!setPrototypeOf || isPrototypeOf(TypedArray, C))) return C;
  throw TypeError(tryToString(C) + ' is not a typed array constructor');
};

var exportTypedArrayMethod = function (KEY, property, forced) {
  if (!DESCRIPTORS) return;
  if (forced) for (var ARRAY in TypedArrayConstructorsList) {
    var TypedArrayConstructor = global[ARRAY];
    if (TypedArrayConstructor && hasOwn(TypedArrayConstructor.prototype, KEY)) try {
      delete TypedArrayConstructor.prototype[KEY];
    } catch (error) { /* empty */ }
  }
  if (!TypedArrayPrototype[KEY] || forced) {
    redefine(TypedArrayPrototype, KEY, forced ? property
      : NATIVE_ARRAY_BUFFER_VIEWS && Int8ArrayPrototype[KEY] || property);
  }
};

var exportTypedArrayStaticMethod = function (KEY, property, forced) {
  var ARRAY, TypedArrayConstructor;
  if (!DESCRIPTORS) return;
  if (setPrototypeOf) {
    if (forced) for (ARRAY in TypedArrayConstructorsList) {
      TypedArrayConstructor = global[ARRAY];
      if (TypedArrayConstructor && hasOwn(TypedArrayConstructor, KEY)) try {
        delete TypedArrayConstructor[KEY];
      } catch (error) { /* empty */ }
    }
    if (!TypedArray[KEY] || forced) {
      // V8 ~ Chrome 49-50 `%TypedArray%` methods are non-writable non-configurable
      try {
        return redefine(TypedArray, KEY, forced ? property : NATIVE_ARRAY_BUFFER_VIEWS && TypedArray[KEY] || property);
      } catch (error) { /* empty */ }
    } else return;
  }
  for (ARRAY in TypedArrayConstructorsList) {
    TypedArrayConstructor = global[ARRAY];
    if (TypedArrayConstructor && (!TypedArrayConstructor[KEY] || forced)) {
      redefine(TypedArrayConstructor, KEY, property);
    }
  }
};

for (NAME in TypedArrayConstructorsList) {
  Constructor = global[NAME];
  Prototype = Constructor && Constructor.prototype;
  if (Prototype) createNonEnumerableProperty(Prototype, TYPED_ARRAY_CONSTRUCTOR, Constructor);
  else NATIVE_ARRAY_BUFFER_VIEWS = false;
}

for (NAME in BigIntArrayConstructorsList) {
  Constructor = global[NAME];
  Prototype = Constructor && Constructor.prototype;
  if (Prototype) createNonEnumerableProperty(Prototype, TYPED_ARRAY_CONSTRUCTOR, Constructor);
}

// WebKit bug - typed arrays constructors prototype is Object.prototype
if (!NATIVE_ARRAY_BUFFER_VIEWS || !isCallable(TypedArray) || TypedArray === Function.prototype) {
  // eslint-disable-next-line no-shadow -- safe
  TypedArray = function TypedArray() {
    throw TypeError('Incorrect invocation');
  };
  if (NATIVE_ARRAY_BUFFER_VIEWS) for (NAME in TypedArrayConstructorsList) {
    if (global[NAME]) setPrototypeOf(global[NAME], TypedArray);
  }
}

if (!NATIVE_ARRAY_BUFFER_VIEWS || !TypedArrayPrototype || TypedArrayPrototype === ObjectPrototype) {
  TypedArrayPrototype = TypedArray.prototype;
  if (NATIVE_ARRAY_BUFFER_VIEWS) for (NAME in TypedArrayConstructorsList) {
    if (global[NAME]) setPrototypeOf(global[NAME].prototype, TypedArrayPrototype);
  }
}

// WebKit bug - one more object in Uint8ClampedArray prototype chain
if (NATIVE_ARRAY_BUFFER_VIEWS && getPrototypeOf(Uint8ClampedArrayPrototype) !== TypedArrayPrototype) {
  setPrototypeOf(Uint8ClampedArrayPrototype, TypedArrayPrototype);
}

if (DESCRIPTORS && !hasOwn(TypedArrayPrototype, TO_STRING_TAG)) {
  TYPED_ARRAY_TAG_REQIRED = true;
  defineProperty(TypedArrayPrototype, TO_STRING_TAG, { get: function () {
    return isObject(this) ? this[TYPED_ARRAY_TAG] : undefined;
  } });
  for (NAME in TypedArrayConstructorsList) if (global[NAME]) {
    createNonEnumerableProperty(global[NAME], TYPED_ARRAY_TAG, NAME);
  }
}

module.exports = {
  NATIVE_ARRAY_BUFFER_VIEWS: NATIVE_ARRAY_BUFFER_VIEWS,
  TYPED_ARRAY_CONSTRUCTOR: TYPED_ARRAY_CONSTRUCTOR,
  TYPED_ARRAY_TAG: TYPED_ARRAY_TAG_REQIRED && TYPED_ARRAY_TAG,
  aTypedArray: aTypedArray,
  aTypedArrayConstructor: aTypedArrayConstructor,
  exportTypedArrayMethod: exportTypedArrayMethod,
  exportTypedArrayStaticMethod: exportTypedArrayStaticMethod,
  isView: isView,
  isTypedArray: isTypedArray,
  TypedArray: TypedArray,
  TypedArrayPrototype: TypedArrayPrototype
};


/***/ }),

/***/ "ee10":
/***/ (function(module, exports, __webpack_require__) {

// style-loader: Adds some css to the DOM by adding a <style> tag

// load the styles
var content = __webpack_require__("ddde");
if(content.__esModule) content = content.default;
if(typeof content === 'string') content = [[module.i, content, '']];
if(content.locals) module.exports = content.locals;
// add the styles to the DOM
var add = __webpack_require__("499e").default
var update = add("e3fd0f3c", content, true, {"sourceMap":false,"shadowMode":false});

/***/ }),

/***/ "f00c":
/***/ (function(module, exports, __webpack_require__) {

var $ = __webpack_require__("23e7");
var numberIsFinite = __webpack_require__("e285");

// `Number.isFinite` method
// https://tc39.es/ecma262/#sec-number.isfinite
$({ target: 'Number', stat: true }, { isFinite: numberIsFinite });


/***/ }),

/***/ "f069":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var aCallable = __webpack_require__("59ed");

var PromiseCapability = function (C) {
  var resolve, reject;
  this.promise = new C(function ($$resolve, $$reject) {
    if (resolve !== undefined || reject !== undefined) throw TypeError('Bad Promise constructor');
    resolve = $$resolve;
    reject = $$reject;
  });
  this.resolve = aCallable(resolve);
  this.reject = aCallable(reject);
};

// `NewPromiseCapability` abstract operation
// https://tc39.es/ecma262/#sec-newpromisecapability
module.exports.f = function (C) {
  return new PromiseCapability(C);
};


/***/ }),

/***/ "f183":
/***/ (function(module, exports, __webpack_require__) {

var $ = __webpack_require__("23e7");
var uncurryThis = __webpack_require__("e330");
var hiddenKeys = __webpack_require__("d012");
var isObject = __webpack_require__("861d");
var hasOwn = __webpack_require__("1a2d");
var defineProperty = __webpack_require__("9bf2").f;
var getOwnPropertyNamesModule = __webpack_require__("241c");
var getOwnPropertyNamesExternalModule = __webpack_require__("057f");
var isExtensible = __webpack_require__("4fadd");
var uid = __webpack_require__("90e3");
var FREEZING = __webpack_require__("bb2f");

var REQUIRED = false;
var METADATA = uid('meta');
var id = 0;

var setMetadata = function (it) {
  defineProperty(it, METADATA, { value: {
    objectID: 'O' + id++, // object ID
    weakData: {}          // weak collections IDs
  } });
};

var fastKey = function (it, create) {
  // return a primitive with prefix
  if (!isObject(it)) return typeof it == 'symbol' ? it : (typeof it == 'string' ? 'S' : 'P') + it;
  if (!hasOwn(it, METADATA)) {
    // can't set metadata to uncaught frozen object
    if (!isExtensible(it)) return 'F';
    // not necessary to add metadata
    if (!create) return 'E';
    // add missing metadata
    setMetadata(it);
  // return object ID
  } return it[METADATA].objectID;
};

var getWeakData = function (it, create) {
  if (!hasOwn(it, METADATA)) {
    // can't set metadata to uncaught frozen object
    if (!isExtensible(it)) return true;
    // not necessary to add metadata
    if (!create) return false;
    // add missing metadata
    setMetadata(it);
  // return the store of weak collections IDs
  } return it[METADATA].weakData;
};

// add metadata on freeze-family methods calling
var onFreeze = function (it) {
  if (FREEZING && REQUIRED && isExtensible(it) && !hasOwn(it, METADATA)) setMetadata(it);
  return it;
};

var enable = function () {
  meta.enable = function () { /* empty */ };
  REQUIRED = true;
  var getOwnPropertyNames = getOwnPropertyNamesModule.f;
  var splice = uncurryThis([].splice);
  var test = {};
  test[METADATA] = 1;

  // prevent exposing of metadata key
  if (getOwnPropertyNames(test).length) {
    getOwnPropertyNamesModule.f = function (it) {
      var result = getOwnPropertyNames(it);
      for (var i = 0, length = result.length; i < length; i++) {
        if (result[i] === METADATA) {
          splice(result, i, 1);
          break;
        }
      } return result;
    };

    $({ target: 'Object', stat: true, forced: true }, {
      getOwnPropertyNames: getOwnPropertyNamesExternalModule.f
    });
  }
};

var meta = module.exports = {
  enable: enable,
  fastKey: fastKey,
  getWeakData: getWeakData,
  onFreeze: onFreeze
};

hiddenKeys[METADATA] = true;


/***/ }),

/***/ "f36a":
/***/ (function(module, exports, __webpack_require__) {

var uncurryThis = __webpack_require__("e330");

module.exports = uncurryThis([].slice);


/***/ }),

/***/ "f3f9":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var _node_modules_vue_style_loader_index_js_ref_9_oneOf_1_0_node_modules_css_loader_dist_cjs_js_ref_9_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_9_oneOf_1_2_node_modules_postcss_loader_src_index_js_ref_9_oneOf_1_3_node_modules_sass_loader_dist_cjs_js_ref_9_oneOf_1_4_node_modules_cache_loader_dist_cjs_js_ref_1_0_node_modules_vue_loader_lib_index_js_vue_loader_options_index_vue_vue_type_style_index_0_id_018ee75b_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("4f27");
/* harmony import */ var _node_modules_vue_style_loader_index_js_ref_9_oneOf_1_0_node_modules_css_loader_dist_cjs_js_ref_9_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_9_oneOf_1_2_node_modules_postcss_loader_src_index_js_ref_9_oneOf_1_3_node_modules_sass_loader_dist_cjs_js_ref_9_oneOf_1_4_node_modules_cache_loader_dist_cjs_js_ref_1_0_node_modules_vue_loader_lib_index_js_vue_loader_options_index_vue_vue_type_style_index_0_id_018ee75b_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_node_modules_vue_style_loader_index_js_ref_9_oneOf_1_0_node_modules_css_loader_dist_cjs_js_ref_9_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_9_oneOf_1_2_node_modules_postcss_loader_src_index_js_ref_9_oneOf_1_3_node_modules_sass_loader_dist_cjs_js_ref_9_oneOf_1_4_node_modules_cache_loader_dist_cjs_js_ref_1_0_node_modules_vue_loader_lib_index_js_vue_loader_options_index_vue_vue_type_style_index_0_id_018ee75b_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0__);
/* unused harmony reexport * */


/***/ }),

/***/ "f47f":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var _node_modules_vue_style_loader_index_js_ref_9_oneOf_1_0_node_modules_css_loader_dist_cjs_js_ref_9_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_9_oneOf_1_2_node_modules_postcss_loader_src_index_js_ref_9_oneOf_1_3_node_modules_sass_loader_dist_cjs_js_ref_9_oneOf_1_4_node_modules_cache_loader_dist_cjs_js_ref_1_0_node_modules_vue_loader_lib_index_js_vue_loader_options_edit_vue_vue_type_style_index_0_lang_scss___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("ee10");
/* harmony import */ var _node_modules_vue_style_loader_index_js_ref_9_oneOf_1_0_node_modules_css_loader_dist_cjs_js_ref_9_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_9_oneOf_1_2_node_modules_postcss_loader_src_index_js_ref_9_oneOf_1_3_node_modules_sass_loader_dist_cjs_js_ref_9_oneOf_1_4_node_modules_cache_loader_dist_cjs_js_ref_1_0_node_modules_vue_loader_lib_index_js_vue_loader_options_edit_vue_vue_type_style_index_0_lang_scss___WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_node_modules_vue_style_loader_index_js_ref_9_oneOf_1_0_node_modules_css_loader_dist_cjs_js_ref_9_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_9_oneOf_1_2_node_modules_postcss_loader_src_index_js_ref_9_oneOf_1_3_node_modules_sass_loader_dist_cjs_js_ref_9_oneOf_1_4_node_modules_cache_loader_dist_cjs_js_ref_1_0_node_modules_vue_loader_lib_index_js_vue_loader_options_edit_vue_vue_type_style_index_0_lang_scss___WEBPACK_IMPORTED_MODULE_0__);
/* unused harmony reexport * */


/***/ }),

/***/ "f5df":
/***/ (function(module, exports, __webpack_require__) {

var global = __webpack_require__("da84");
var TO_STRING_TAG_SUPPORT = __webpack_require__("00ee");
var isCallable = __webpack_require__("1626");
var classofRaw = __webpack_require__("c6b6");
var wellKnownSymbol = __webpack_require__("b622");

var TO_STRING_TAG = wellKnownSymbol('toStringTag');
var Object = global.Object;

// ES3 wrong here
var CORRECT_ARGUMENTS = classofRaw(function () { return arguments; }()) == 'Arguments';

// fallback for IE11 Script Access Denied error
var tryGet = function (it, key) {
  try {
    return it[key];
  } catch (error) { /* empty */ }
};

// getting tag from ES6+ `Object.prototype.toString`
module.exports = TO_STRING_TAG_SUPPORT ? classofRaw : function (it) {
  var O, tag, result;
  return it === undefined ? 'Undefined' : it === null ? 'Null'
    // @@toStringTag case
    : typeof (tag = tryGet(O = Object(it), TO_STRING_TAG)) == 'string' ? tag
    // builtinTag case
    : CORRECT_ARGUMENTS ? classofRaw(O)
    // ES3 arguments fallback
    : (result = classofRaw(O)) == 'Object' && isCallable(O.callee) ? 'Arguments' : result;
};


/***/ }),

/***/ "f772":
/***/ (function(module, exports, __webpack_require__) {

var shared = __webpack_require__("5692");
var uid = __webpack_require__("90e3");

var keys = shared('keys');

module.exports = function (key) {
  return keys[key] || (keys[key] = uid(key));
};


/***/ }),

/***/ "f8c9":
/***/ (function(module, exports, __webpack_require__) {

var $ = __webpack_require__("23e7");
var global = __webpack_require__("da84");
var setToStringTag = __webpack_require__("d44e");

$({ global: true }, { Reflect: {} });

// Reflect[@@toStringTag] property
// https://tc39.es/ecma262/#sec-reflect-@@tostringtag
setToStringTag(global.Reflect, 'Reflect', true);


/***/ }),

/***/ "f8cd":
/***/ (function(module, exports, __webpack_require__) {

var global = __webpack_require__("da84");
var toIntegerOrInfinity = __webpack_require__("5926");

var RangeError = global.RangeError;

module.exports = function (it) {
  var result = toIntegerOrInfinity(it);
  if (result < 0) throw RangeError("The argument can't be less than 0");
  return result;
};


/***/ }),

/***/ "fb15":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__);

// EXPORTS
__webpack_require__.d(__webpack_exports__, "SpreadSheet", function() { return /* reexport */ src_0; });
__webpack_require__.d(__webpack_exports__, "transform", function() { return /* reexport */ transform; });
__webpack_require__.d(__webpack_exports__, "LuckyExcel", function() { return /* reexport */ luckyexcel_cjs_default.a; });
__webpack_require__.d(__webpack_exports__, "DataProxy", function() { return /* reexport */ data_proxy_DataProxy; });
__webpack_require__.d(__webpack_exports__, "CellRange", function() { return /* reexport */ cell_range; });
__webpack_require__.d(__webpack_exports__, "Print", function() { return /* reexport */ canvas_print; });
__webpack_require__.d(__webpack_exports__, "format", function() { return /* reexport */ core_format; });
__webpack_require__.d(__webpack_exports__, "nameEncode", function() { return /* reexport */ nameEncode; });
__webpack_require__.d(__webpack_exports__, "ERRORTYPES", function() { return /* reexport */ functions_error["a" /* ERRORTYPES */]; });
__webpack_require__.d(__webpack_exports__, "version", function() { return /* reexport */ version; });
__webpack_require__.d(__webpack_exports__, "BigNumber", function() { return /* reexport */ bignumber_default.a; });
__webpack_require__.d(__webpack_exports__, "Formula", function() { return /* reexport */ Formula; });

// NAMESPACE OBJECT: ./src/sheet/functions/functions.js
var functions_functions_namespaceObject = {};
__webpack_require__.r(functions_functions_namespaceObject);
__webpack_require__.d(functions_functions_namespaceObject, "ERROR", function() { return functions_error["b" /* default */]; });
__webpack_require__.d(functions_functions_namespaceObject, "ERRORTYPES", function() { return functions_error["a" /* ERRORTYPES */]; });
__webpack_require__.d(functions_functions_namespaceObject, "PARSE", function() { return functions_parser; });
__webpack_require__.d(functions_functions_namespaceObject, "parse", function() { return functions_parser; });
__webpack_require__.d(functions_functions_namespaceObject, "WALKER", function() { return walker_optimize; });
__webpack_require__.d(functions_functions_namespaceObject, "WALKERCONFIGDEFAULT", function() { return defaultConfig; });
__webpack_require__.d(functions_functions_namespaceObject, "WALKERCONFIGFP", function() { return fpConfig; });
__webpack_require__.d(functions_functions_namespaceObject, "WALKERCONFIGJS", function() { return jsConfig; });
__webpack_require__.d(functions_functions_namespaceObject, "COMPILE", function() { return compile; });
__webpack_require__.d(functions_functions_namespaceObject, "compile", function() { return compile; });
__webpack_require__.d(functions_functions_namespaceObject, "RUN", function() { return run; });
__webpack_require__.d(functions_functions_namespaceObject, "run", function() { return run; });
__webpack_require__.d(functions_functions_namespaceObject, "BRANCH", function() { return branch; });
__webpack_require__.d(functions_functions_namespaceObject, "IF", function() { return branch; });
__webpack_require__.d(functions_functions_namespaceObject, "IFS", function() { return branch; });
__webpack_require__.d(functions_functions_namespaceObject, "branch", function() { return branch; });
__webpack_require__.d(functions_functions_namespaceObject, "ifs", function() { return branch; });
__webpack_require__.d(functions_functions_namespaceObject, "if", function() { return branch; });
__webpack_require__.d(functions_functions_namespaceObject, "CHOOSE", function() { return choose; });
__webpack_require__.d(functions_functions_namespaceObject, "choose", function() { return choose; });
__webpack_require__.d(functions_functions_namespaceObject, "SWITCH", function() { return SWITCH; });
__webpack_require__.d(functions_functions_namespaceObject, "switch", function() { return SWITCH; });
__webpack_require__.d(functions_functions_namespaceObject, "AND", function() { return and; });
__webpack_require__.d(functions_functions_namespaceObject, "and", function() { return and; });
__webpack_require__.d(functions_functions_namespaceObject, "NAND", function() { return nand; });
__webpack_require__.d(functions_functions_namespaceObject, "nand", function() { return nand; });
__webpack_require__.d(functions_functions_namespaceObject, "OR", function() { return or; });
__webpack_require__.d(functions_functions_namespaceObject, "or", function() { return or; });
__webpack_require__.d(functions_functions_namespaceObject, "NOR", function() { return nor; });
__webpack_require__.d(functions_functions_namespaceObject, "nor", function() { return nor; });
__webpack_require__.d(functions_functions_namespaceObject, "XOR", function() { return xor; });
__webpack_require__.d(functions_functions_namespaceObject, "xor", function() { return xor; });
__webpack_require__.d(functions_functions_namespaceObject, "NOT", function() { return not; });
__webpack_require__.d(functions_functions_namespaceObject, "not", function() { return not; });
__webpack_require__.d(functions_functions_namespaceObject, "EQ", function() { return eq; });
__webpack_require__.d(functions_functions_namespaceObject, "eq", function() { return eq; });
__webpack_require__.d(functions_functions_namespaceObject, "NE", function() { return ne; });
__webpack_require__.d(functions_functions_namespaceObject, "ne", function() { return ne; });
__webpack_require__.d(functions_functions_namespaceObject, "GT", function() { return gt; });
__webpack_require__.d(functions_functions_namespaceObject, "gt", function() { return gt; });
__webpack_require__.d(functions_functions_namespaceObject, "GTE", function() { return gte; });
__webpack_require__.d(functions_functions_namespaceObject, "gte", function() { return gte; });
__webpack_require__.d(functions_functions_namespaceObject, "LT", function() { return lt; });
__webpack_require__.d(functions_functions_namespaceObject, "lt", function() { return lt; });
__webpack_require__.d(functions_functions_namespaceObject, "LTE", function() { return lte; });
__webpack_require__.d(functions_functions_namespaceObject, "lte", function() { return lte; });
__webpack_require__.d(functions_functions_namespaceObject, "IDENTITY", function() { return identity; });
__webpack_require__.d(functions_functions_namespaceObject, "identity", function() { return identity; });
__webpack_require__.d(functions_functions_namespaceObject, "IFBLANK", function() { return ifblank; });
__webpack_require__.d(functions_functions_namespaceObject, "ifBlank", function() { return ifblank; });
__webpack_require__.d(functions_functions_namespaceObject, "ifblank", function() { return ifblank; });
__webpack_require__.d(functions_functions_namespaceObject, "IFEMPTY", function() { return ifempty; });
__webpack_require__.d(functions_functions_namespaceObject, "ifEmpty", function() { return ifempty; });
__webpack_require__.d(functions_functions_namespaceObject, "ifempty", function() { return ifempty; });
__webpack_require__.d(functions_functions_namespaceObject, "IFERROR", function() { return iferror; });
__webpack_require__.d(functions_functions_namespaceObject, "ifError", function() { return iferror; });
__webpack_require__.d(functions_functions_namespaceObject, "iferror", function() { return iferror; });
__webpack_require__.d(functions_functions_namespaceObject, "IFNA", function() { return ifna; });
__webpack_require__.d(functions_functions_namespaceObject, "ifNA", function() { return ifna; });
__webpack_require__.d(functions_functions_namespaceObject, "ifna", function() { return ifna; });
__webpack_require__.d(functions_functions_namespaceObject, "ISARRAY", function() { return isarray; });
__webpack_require__.d(functions_functions_namespaceObject, "isArray", function() { return isarray; });
__webpack_require__.d(functions_functions_namespaceObject, "isarray", function() { return isarray; });
__webpack_require__.d(functions_functions_namespaceObject, "ISASYNCFUNCTION", function() { return isasyncfunction; });
__webpack_require__.d(functions_functions_namespaceObject, "isAsyncFunction", function() { return isasyncfunction; });
__webpack_require__.d(functions_functions_namespaceObject, "isasyncfunction", function() { return isasyncfunction; });
__webpack_require__.d(functions_functions_namespaceObject, "ISBLANK", function() { return isblank; });
__webpack_require__.d(functions_functions_namespaceObject, "isBlank", function() { return isblank; });
__webpack_require__.d(functions_functions_namespaceObject, "isblank", function() { return isblank; });
__webpack_require__.d(functions_functions_namespaceObject, "ISBOOLEAN", function() { return isboolean; });
__webpack_require__.d(functions_functions_namespaceObject, "isBoolean", function() { return isboolean; });
__webpack_require__.d(functions_functions_namespaceObject, "isboolean", function() { return isboolean; });
__webpack_require__.d(functions_functions_namespaceObject, "ISDATE", function() { return isdate; });
__webpack_require__.d(functions_functions_namespaceObject, "isDate", function() { return isdate; });
__webpack_require__.d(functions_functions_namespaceObject, "isdate", function() { return isdate; });
__webpack_require__.d(functions_functions_namespaceObject, "ISEMAIL", function() { return isemail; });
__webpack_require__.d(functions_functions_namespaceObject, "isEmail", function() { return isemail; });
__webpack_require__.d(functions_functions_namespaceObject, "isemail", function() { return isemail; });
__webpack_require__.d(functions_functions_namespaceObject, "ISEMPTY", function() { return isempty; });
__webpack_require__.d(functions_functions_namespaceObject, "isEmpty", function() { return isempty; });
__webpack_require__.d(functions_functions_namespaceObject, "isempty", function() { return isempty; });
__webpack_require__.d(functions_functions_namespaceObject, "ISERROR", function() { return iserror; });
__webpack_require__.d(functions_functions_namespaceObject, "isError", function() { return iserror; });
__webpack_require__.d(functions_functions_namespaceObject, "iserror", function() { return iserror; });
__webpack_require__.d(functions_functions_namespaceObject, "ISEVEN", function() { return iseven; });
__webpack_require__.d(functions_functions_namespaceObject, "isEven", function() { return iseven; });
__webpack_require__.d(functions_functions_namespaceObject, "iseven", function() { return iseven; });
__webpack_require__.d(functions_functions_namespaceObject, "ISFALSY", function() { return isfalsy; });
__webpack_require__.d(functions_functions_namespaceObject, "isFalsy", function() { return isfalsy; });
__webpack_require__.d(functions_functions_namespaceObject, "isfalsy", function() { return isfalsy; });
__webpack_require__.d(functions_functions_namespaceObject, "ISFUNCTION", function() { return isfunction; });
__webpack_require__.d(functions_functions_namespaceObject, "isFunction", function() { return isfunction; });
__webpack_require__.d(functions_functions_namespaceObject, "isfunction", function() { return isfunction; });
__webpack_require__.d(functions_functions_namespaceObject, "ISLEAPYEAR", function() { return isleapyear; });
__webpack_require__.d(functions_functions_namespaceObject, "isLeapYear", function() { return isleapyear; });
__webpack_require__.d(functions_functions_namespaceObject, "isleapyear", function() { return isleapyear; });
__webpack_require__.d(functions_functions_namespaceObject, "ISLOWERCASE", function() { return islowercase; });
__webpack_require__.d(functions_functions_namespaceObject, "isLowerCase", function() { return islowercase; });
__webpack_require__.d(functions_functions_namespaceObject, "islowercase", function() { return islowercase; });
__webpack_require__.d(functions_functions_namespaceObject, "ISOBJECT", function() { return isobject; });
__webpack_require__.d(functions_functions_namespaceObject, "isObject", function() { return isobject; });
__webpack_require__.d(functions_functions_namespaceObject, "ISNA", function() { return isna; });
__webpack_require__.d(functions_functions_namespaceObject, "isNA", function() { return isna; });
__webpack_require__.d(functions_functions_namespaceObject, "isna", function() { return isna; });
__webpack_require__.d(functions_functions_namespaceObject, "ISNAN", function() { return isnan; });
__webpack_require__.d(functions_functions_namespaceObject, "isNaN", function() { return isnan; });
__webpack_require__.d(functions_functions_namespaceObject, "isnan", function() { return isnan; });
__webpack_require__.d(functions_functions_namespaceObject, "ISNUMBER", function() { return functions_isDigit; });
__webpack_require__.d(functions_functions_namespaceObject, "isNumber", function() { return functions_isDigit; });
__webpack_require__.d(functions_functions_namespaceObject, "isnumber", function() { return functions_isDigit; });
__webpack_require__.d(functions_functions_namespaceObject, "ISODD", function() { return isodd; });
__webpack_require__.d(functions_functions_namespaceObject, "isOdd", function() { return isodd; });
__webpack_require__.d(functions_functions_namespaceObject, "isodd", function() { return isodd; });
__webpack_require__.d(functions_functions_namespaceObject, "ISOWEEKNUM", function() { return isoweeknum; });
__webpack_require__.d(functions_functions_namespaceObject, "ISOWeekNum", function() { return isoweeknum; });
__webpack_require__.d(functions_functions_namespaceObject, "isoweeknum", function() { return isoweeknum; });
__webpack_require__.d(functions_functions_namespaceObject, "ISPROMISE", function() { return ispromise; });
__webpack_require__.d(functions_functions_namespaceObject, "isPromise", function() { return ispromise; });
__webpack_require__.d(functions_functions_namespaceObject, "ispromise", function() { return ispromise; });
__webpack_require__.d(functions_functions_namespaceObject, "ISREF", function() { return isref; });
__webpack_require__.d(functions_functions_namespaceObject, "isRef", function() { return isref; });
__webpack_require__.d(functions_functions_namespaceObject, "isref", function() { return isref; });
__webpack_require__.d(functions_functions_namespaceObject, "ISTEXT", function() { return istext; });
__webpack_require__.d(functions_functions_namespaceObject, "isText", function() { return istext; });
__webpack_require__.d(functions_functions_namespaceObject, "ISTRUTHY", function() { return istruthy; });
__webpack_require__.d(functions_functions_namespaceObject, "isTruthy", function() { return istruthy; });
__webpack_require__.d(functions_functions_namespaceObject, "istruthy", function() { return istruthy; });
__webpack_require__.d(functions_functions_namespaceObject, "ISUPPERCASE", function() { return isuppercase; });
__webpack_require__.d(functions_functions_namespaceObject, "isUpperCase", function() { return isuppercase; });
__webpack_require__.d(functions_functions_namespaceObject, "isuppercase", function() { return isuppercase; });
__webpack_require__.d(functions_functions_namespaceObject, "ISURL", function() { return isurl; });
__webpack_require__.d(functions_functions_namespaceObject, "isURL", function() { return isurl; });
__webpack_require__.d(functions_functions_namespaceObject, "isurl", function() { return isurl; });
__webpack_require__.d(functions_functions_namespaceObject, "ISWHOLENUMBER", function() { return iswholenumber; });
__webpack_require__.d(functions_functions_namespaceObject, "isWholeNumber", function() { return iswholenumber; });
__webpack_require__.d(functions_functions_namespaceObject, "iswholenumber", function() { return iswholenumber; });
__webpack_require__.d(functions_functions_namespaceObject, "MINUS", function() { return minus; });
__webpack_require__.d(functions_functions_namespaceObject, "minus", function() { return minus; });
__webpack_require__.d(functions_functions_namespaceObject, "PLUS", function() { return plus; });
__webpack_require__.d(functions_functions_namespaceObject, "plus", function() { return plus; });
__webpack_require__.d(functions_functions_namespaceObject, "ADD", function() { return add_add; });
__webpack_require__.d(functions_functions_namespaceObject, "add", function() { return add_add; });
__webpack_require__.d(functions_functions_namespaceObject, "SUBTRACT", function() { return subtract; });
__webpack_require__.d(functions_functions_namespaceObject, "subtract", function() { return subtract; });
__webpack_require__.d(functions_functions_namespaceObject, "MULTIPLY", function() { return multiply; });
__webpack_require__.d(functions_functions_namespaceObject, "multiply", function() { return multiply; });
__webpack_require__.d(functions_functions_namespaceObject, "DIVIDE", function() { return divide_divide; });
__webpack_require__.d(functions_functions_namespaceObject, "divide", function() { return divide_divide; });
__webpack_require__.d(functions_functions_namespaceObject, "ABS", function() { return abs; });
__webpack_require__.d(functions_functions_namespaceObject, "abs", function() { return abs; });
__webpack_require__.d(functions_functions_namespaceObject, "ACOS", function() { return acos; });
__webpack_require__.d(functions_functions_namespaceObject, "acos", function() { return acos; });
__webpack_require__.d(functions_functions_namespaceObject, "ACOSH", function() { return acosh; });
__webpack_require__.d(functions_functions_namespaceObject, "acosh", function() { return acosh; });
__webpack_require__.d(functions_functions_namespaceObject, "ACOT", function() { return acot; });
__webpack_require__.d(functions_functions_namespaceObject, "acot", function() { return acot; });
__webpack_require__.d(functions_functions_namespaceObject, "ACOTH", function() { return acoth; });
__webpack_require__.d(functions_functions_namespaceObject, "acoth", function() { return acoth; });
__webpack_require__.d(functions_functions_namespaceObject, "ASIN", function() { return asin; });
__webpack_require__.d(functions_functions_namespaceObject, "asin", function() { return asin; });
__webpack_require__.d(functions_functions_namespaceObject, "ASINH", function() { return asinh; });
__webpack_require__.d(functions_functions_namespaceObject, "asinh", function() { return asinh; });
__webpack_require__.d(functions_functions_namespaceObject, "ATAN", function() { return atan; });
__webpack_require__.d(functions_functions_namespaceObject, "atan", function() { return atan; });
__webpack_require__.d(functions_functions_namespaceObject, "ATAN2", function() { return atan2; });
__webpack_require__.d(functions_functions_namespaceObject, "atan2", function() { return atan2; });
__webpack_require__.d(functions_functions_namespaceObject, "ATANH", function() { return atanh_atan; });
__webpack_require__.d(functions_functions_namespaceObject, "atanh", function() { return atanh_atan; });
__webpack_require__.d(functions_functions_namespaceObject, "COS", function() { return cos; });
__webpack_require__.d(functions_functions_namespaceObject, "cos", function() { return cos; });
__webpack_require__.d(functions_functions_namespaceObject, "DEGREES", function() { return degrees; });
__webpack_require__.d(functions_functions_namespaceObject, "degrees", function() { return degrees; });
__webpack_require__.d(functions_functions_namespaceObject, "MOD", function() { return mod; });
__webpack_require__.d(functions_functions_namespaceObject, "mod", function() { return mod; });
__webpack_require__.d(functions_functions_namespaceObject, "PI", function() { return pi_pi; });
__webpack_require__.d(functions_functions_namespaceObject, "pi", function() { return pi_pi; });
__webpack_require__.d(functions_functions_namespaceObject, "POWER", function() { return power; });
__webpack_require__.d(functions_functions_namespaceObject, "power", function() { return power; });
__webpack_require__.d(functions_functions_namespaceObject, "ROUND", function() { return round_round; });
__webpack_require__.d(functions_functions_namespaceObject, "round", function() { return round_round; });
__webpack_require__.d(functions_functions_namespaceObject, "ROUNDUP", function() { return roundup; });
__webpack_require__.d(functions_functions_namespaceObject, "roundUp", function() { return roundup; });
__webpack_require__.d(functions_functions_namespaceObject, "roundup", function() { return roundup; });
__webpack_require__.d(functions_functions_namespaceObject, "SIN", function() { return sin; });
__webpack_require__.d(functions_functions_namespaceObject, "sin", function() { return sin; });
__webpack_require__.d(functions_functions_namespaceObject, "TAN", function() { return tan; });
__webpack_require__.d(functions_functions_namespaceObject, "tan", function() { return tan; });
__webpack_require__.d(functions_functions_namespaceObject, "TAU", function() { return tau; });
__webpack_require__.d(functions_functions_namespaceObject, "tau", function() { return tau; });
__webpack_require__.d(functions_functions_namespaceObject, "TRUNC", function() { return trunc; });
__webpack_require__.d(functions_functions_namespaceObject, "trunc", function() { return trunc; });
__webpack_require__.d(functions_functions_namespaceObject, "WITHIN", function() { return within; });
__webpack_require__.d(functions_functions_namespaceObject, "withIn", function() { return within; });
__webpack_require__.d(functions_functions_namespaceObject, "within", function() { return within; });
__webpack_require__.d(functions_functions_namespaceObject, "CHAR", function() { return char_char; });
__webpack_require__.d(functions_functions_namespaceObject, "char", function() { return char_char; });
__webpack_require__.d(functions_functions_namespaceObject, "CAMELCASE", function() { return camelcase; });
__webpack_require__.d(functions_functions_namespaceObject, "camelCase", function() { return camelcase; });
__webpack_require__.d(functions_functions_namespaceObject, "camelcase", function() { return camelcase; });
__webpack_require__.d(functions_functions_namespaceObject, "CODE", function() { return code_code; });
__webpack_require__.d(functions_functions_namespaceObject, "code", function() { return code_code; });
__webpack_require__.d(functions_functions_namespaceObject, "CONCATENATE", function() { return concatenate; });
__webpack_require__.d(functions_functions_namespaceObject, "concatenate", function() { return concatenate; });
__webpack_require__.d(functions_functions_namespaceObject, "EXACT", function() { return exact; });
__webpack_require__.d(functions_functions_namespaceObject, "exact", function() { return exact; });
__webpack_require__.d(functions_functions_namespaceObject, "FIND", function() { return find; });
__webpack_require__.d(functions_functions_namespaceObject, "find", function() { return find; });
__webpack_require__.d(functions_functions_namespaceObject, "JOIN", function() { return join; });
__webpack_require__.d(functions_functions_namespaceObject, "join", function() { return join; });
__webpack_require__.d(functions_functions_namespaceObject, "LEFT", function() { return left_left; });
__webpack_require__.d(functions_functions_namespaceObject, "left", function() { return left_left; });
__webpack_require__.d(functions_functions_namespaceObject, "LEN", function() { return len_len; });
__webpack_require__.d(functions_functions_namespaceObject, "len", function() { return len_len; });
__webpack_require__.d(functions_functions_namespaceObject, "LOWER", function() { return lower; });
__webpack_require__.d(functions_functions_namespaceObject, "lower", function() { return lower; });
__webpack_require__.d(functions_functions_namespaceObject, "NUMBERVALUE", function() { return numbervalue; });
__webpack_require__.d(functions_functions_namespaceObject, "numberValue", function() { return numbervalue; });
__webpack_require__.d(functions_functions_namespaceObject, "numbervalue", function() { return numbervalue; });
__webpack_require__.d(functions_functions_namespaceObject, "PARSEBOOL", function() { return parsebool; });
__webpack_require__.d(functions_functions_namespaceObject, "parseBool", function() { return parsebool; });
__webpack_require__.d(functions_functions_namespaceObject, "parsebool", function() { return parsebool; });
__webpack_require__.d(functions_functions_namespaceObject, "PARSEDATE", function() { return parsedate; });
__webpack_require__.d(functions_functions_namespaceObject, "parseDate", function() { return parsedate; });
__webpack_require__.d(functions_functions_namespaceObject, "parsedate", function() { return parsedate; });
__webpack_require__.d(functions_functions_namespaceObject, "PARSEQUERY", function() { return parsequery; });
__webpack_require__.d(functions_functions_namespaceObject, "parseQuery", function() { return parsequery; });
__webpack_require__.d(functions_functions_namespaceObject, "parsequery", function() { return parsequery; });
__webpack_require__.d(functions_functions_namespaceObject, "PROPER", function() { return proper; });
__webpack_require__.d(functions_functions_namespaceObject, "proper", function() { return proper; });
__webpack_require__.d(functions_functions_namespaceObject, "REPLACE", function() { return replace; });
__webpack_require__.d(functions_functions_namespaceObject, "replace", function() { return replace; });
__webpack_require__.d(functions_functions_namespaceObject, "RIGHT", function() { return right; });
__webpack_require__.d(functions_functions_namespaceObject, "right", function() { return right; });
__webpack_require__.d(functions_functions_namespaceObject, "REPT", function() { return rept; });
__webpack_require__.d(functions_functions_namespaceObject, "rept", function() { return rept; });
__webpack_require__.d(functions_functions_namespaceObject, "SEARCH", function() { return search_search; });
__webpack_require__.d(functions_functions_namespaceObject, "search", function() { return search_search; });
__webpack_require__.d(functions_functions_namespaceObject, "SNAKECASE", function() { return snakecase; });
__webpack_require__.d(functions_functions_namespaceObject, "snakeCase", function() { return snakecase; });
__webpack_require__.d(functions_functions_namespaceObject, "snakecase", function() { return snakecase; });
__webpack_require__.d(functions_functions_namespaceObject, "SUBSTITUTE", function() { return substitute; });
__webpack_require__.d(functions_functions_namespaceObject, "substitute", function() { return substitute; });
__webpack_require__.d(functions_functions_namespaceObject, "SUBSTITUTEALL", function() { return substituteAll; });
__webpack_require__.d(functions_functions_namespaceObject, "substituteAll", function() { return substituteAll; });
__webpack_require__.d(functions_functions_namespaceObject, "substituteall", function() { return substituteAll; });
__webpack_require__.d(functions_functions_namespaceObject, "SURROUNDKEYS", function() { return surroundKeys; });
__webpack_require__.d(functions_functions_namespaceObject, "surroundKeys", function() { return surroundKeys; });
__webpack_require__.d(functions_functions_namespaceObject, "surroundkeys", function() { return surroundKeys; });
__webpack_require__.d(functions_functions_namespaceObject, "SPLIT", function() { return split; });
__webpack_require__.d(functions_functions_namespaceObject, "split", function() { return split; });
__webpack_require__.d(functions_functions_namespaceObject, "TEXT", function() { return text_text; });
__webpack_require__.d(functions_functions_namespaceObject, "text", function() { return text_text; });
__webpack_require__.d(functions_functions_namespaceObject, "TRIM", function() { return trim; });
__webpack_require__.d(functions_functions_namespaceObject, "trim", function() { return trim; });
__webpack_require__.d(functions_functions_namespaceObject, "UPPER", function() { return upper; });
__webpack_require__.d(functions_functions_namespaceObject, "upper", function() { return upper; });
__webpack_require__.d(functions_functions_namespaceObject, "HLOOKUP", function() { return hlookup; });
__webpack_require__.d(functions_functions_namespaceObject, "hlookup", function() { return hlookup; });
__webpack_require__.d(functions_functions_namespaceObject, "INCLUDES", function() { return includes_includes; });
__webpack_require__.d(functions_functions_namespaceObject, "includes", function() { return includes_includes; });
__webpack_require__.d(functions_functions_namespaceObject, "NOTINCLUDES", function() { return notincludes; });
__webpack_require__.d(functions_functions_namespaceObject, "notIncludes", function() { return notincludes; });
__webpack_require__.d(functions_functions_namespaceObject, "notincludes", function() { return notincludes; });
__webpack_require__.d(functions_functions_namespaceObject, "INDEX", function() { return functions_index; });
__webpack_require__.d(functions_functions_namespaceObject, "index", function() { return functions_index; });
__webpack_require__.d(functions_functions_namespaceObject, "LOOKUP", function() { return lookup; });
__webpack_require__.d(functions_functions_namespaceObject, "lookup", function() { return lookup; });
__webpack_require__.d(functions_functions_namespaceObject, "MATCH", function() { return match; });
__webpack_require__.d(functions_functions_namespaceObject, "match", function() { return match; });
__webpack_require__.d(functions_functions_namespaceObject, "VLOOKUP", function() { return vlookup; });
__webpack_require__.d(functions_functions_namespaceObject, "vlookup", function() { return vlookup; });
__webpack_require__.d(functions_functions_namespaceObject, "DATE", function() { return date_date; });
__webpack_require__.d(functions_functions_namespaceObject, "date", function() { return date_date; });
__webpack_require__.d(functions_functions_namespaceObject, "DATEVALUE", function() { return datevalue; });
__webpack_require__.d(functions_functions_namespaceObject, "datevalue", function() { return datevalue; });
__webpack_require__.d(functions_functions_namespaceObject, "DATEDIF", function() { return datedif; });
__webpack_require__.d(functions_functions_namespaceObject, "datedif", function() { return datedif; });
__webpack_require__.d(functions_functions_namespaceObject, "DAY", function() { return day_day; });
__webpack_require__.d(functions_functions_namespaceObject, "day", function() { return day_day; });
__webpack_require__.d(functions_functions_namespaceObject, "DAYS360", function() { return days360; });
__webpack_require__.d(functions_functions_namespaceObject, "days360", function() { return days360; });
__webpack_require__.d(functions_functions_namespaceObject, "EDATE", function() { return edate; });
__webpack_require__.d(functions_functions_namespaceObject, "edate", function() { return edate; });
__webpack_require__.d(functions_functions_namespaceObject, "EOMONTH", function() { return eomonth; });
__webpack_require__.d(functions_functions_namespaceObject, "eomonth", function() { return eomonth; });
__webpack_require__.d(functions_functions_namespaceObject, "HOUR", function() { return hour_hour; });
__webpack_require__.d(functions_functions_namespaceObject, "hour", function() { return hour_hour; });
__webpack_require__.d(functions_functions_namespaceObject, "MINUTE", function() { return minute_minute; });
__webpack_require__.d(functions_functions_namespaceObject, "minute", function() { return minute_minute; });
__webpack_require__.d(functions_functions_namespaceObject, "MONTH", function() { return month_month; });
__webpack_require__.d(functions_functions_namespaceObject, "month", function() { return month_month; });
__webpack_require__.d(functions_functions_namespaceObject, "NOW", function() { return now; });
__webpack_require__.d(functions_functions_namespaceObject, "now", function() { return now; });
__webpack_require__.d(functions_functions_namespaceObject, "SECOND", function() { return second_second; });
__webpack_require__.d(functions_functions_namespaceObject, "second", function() { return second_second; });
__webpack_require__.d(functions_functions_namespaceObject, "TODAY", function() { return today; });
__webpack_require__.d(functions_functions_namespaceObject, "today", function() { return today; });
__webpack_require__.d(functions_functions_namespaceObject, "TIME", function() { return time_time; });
__webpack_require__.d(functions_functions_namespaceObject, "time", function() { return time_time; });
__webpack_require__.d(functions_functions_namespaceObject, "TIMEVALUE", function() { return timevalue; });
__webpack_require__.d(functions_functions_namespaceObject, "timevalue", function() { return timevalue; });
__webpack_require__.d(functions_functions_namespaceObject, "YEAR", function() { return year_year; });
__webpack_require__.d(functions_functions_namespaceObject, "year", function() { return year_year; });
__webpack_require__.d(functions_functions_namespaceObject, "YEARFRAC", function() { return yearfrac; });
__webpack_require__.d(functions_functions_namespaceObject, "yearfrac", function() { return yearfrac; });
__webpack_require__.d(functions_functions_namespaceObject, "AVERAGE", function() { return average_average; });
__webpack_require__.d(functions_functions_namespaceObject, "average", function() { return average_average; });
__webpack_require__.d(functions_functions_namespaceObject, "MIN", function() { return min_min; });
__webpack_require__.d(functions_functions_namespaceObject, "min", function() { return min_min; });
__webpack_require__.d(functions_functions_namespaceObject, "MAX", function() { return max_max; });
__webpack_require__.d(functions_functions_namespaceObject, "max", function() { return max_max; });
__webpack_require__.d(functions_functions_namespaceObject, "QUERY", function() { return query_query; });
__webpack_require__.d(functions_functions_namespaceObject, "query", function() { return query_query; });
__webpack_require__.d(functions_functions_namespaceObject, "SUM", function() { return sum_sum; });
__webpack_require__.d(functions_functions_namespaceObject, "sum", function() { return sum_sum; });
__webpack_require__.d(functions_functions_namespaceObject, "ACCRINT", function() { return accrint; });
__webpack_require__.d(functions_functions_namespaceObject, "accrint", function() { return accrint; });
__webpack_require__.d(functions_functions_namespaceObject, "FV", function() { return fv_fv; });
__webpack_require__.d(functions_functions_namespaceObject, "fv", function() { return fv_fv; });
__webpack_require__.d(functions_functions_namespaceObject, "NPER", function() { return nper; });
__webpack_require__.d(functions_functions_namespaceObject, "nper", function() { return nper; });
__webpack_require__.d(functions_functions_namespaceObject, "NPV", function() { return npv; });
__webpack_require__.d(functions_functions_namespaceObject, "npv", function() { return npv; });
__webpack_require__.d(functions_functions_namespaceObject, "PMT", function() { return pmt_pmt; });
__webpack_require__.d(functions_functions_namespaceObject, "pmt", function() { return pmt_pmt; });
__webpack_require__.d(functions_functions_namespaceObject, "CUMIPMT", function() { return functions_cumipmt; });
__webpack_require__.d(functions_functions_namespaceObject, "cumipmt", function() { return functions_cumipmt; });
__webpack_require__.d(functions_functions_namespaceObject, "IPMT", function() { return functions_ipmt; });
__webpack_require__.d(functions_functions_namespaceObject, "ipmt", function() { return functions_ipmt; });
__webpack_require__.d(functions_functions_namespaceObject, "PV", function() { return pv_pv; });
__webpack_require__.d(functions_functions_namespaceObject, "pv", function() { return pv_pv; });
__webpack_require__.d(functions_functions_namespaceObject, "BIN2DEC", function() { return bin2dec; });
__webpack_require__.d(functions_functions_namespaceObject, "bin2dec", function() { return bin2dec; });
__webpack_require__.d(functions_functions_namespaceObject, "DEC2BIN", function() { return dec2bin; });
__webpack_require__.d(functions_functions_namespaceObject, "dec2bin", function() { return dec2bin; });
__webpack_require__.d(functions_functions_namespaceObject, "OCT2DEC", function() { return oct2dec; });
__webpack_require__.d(functions_functions_namespaceObject, "oct2dec", function() { return oct2dec; });
__webpack_require__.d(functions_functions_namespaceObject, "FILTER", function() { return filter_filter; });
__webpack_require__.d(functions_functions_namespaceObject, "filter", function() { return filter_filter; });
__webpack_require__.d(functions_functions_namespaceObject, "FLATTEN", function() { return flatten; });
__webpack_require__.d(functions_functions_namespaceObject, "flatten", function() { return flatten; });
__webpack_require__.d(functions_functions_namespaceObject, "MAP", function() { return map; });
__webpack_require__.d(functions_functions_namespaceObject, "map", function() { return map; });
__webpack_require__.d(functions_functions_namespaceObject, "PLUCK", function() { return pluck; });
__webpack_require__.d(functions_functions_namespaceObject, "pluck", function() { return pluck; });
__webpack_require__.d(functions_functions_namespaceObject, "REDUCE", function() { return reduce; });
__webpack_require__.d(functions_functions_namespaceObject, "reduce", function() { return reduce; });
__webpack_require__.d(functions_functions_namespaceObject, "SOME", function() { return some; });
__webpack_require__.d(functions_functions_namespaceObject, "some", function() { return some; });
__webpack_require__.d(functions_functions_namespaceObject, "SORT", function() { return sort; });
__webpack_require__.d(functions_functions_namespaceObject, "sort", function() { return sort; });
__webpack_require__.d(functions_functions_namespaceObject, "UNFLATTEN", function() { return unflatten; });
__webpack_require__.d(functions_functions_namespaceObject, "unFlatten", function() { return unflatten; });
__webpack_require__.d(functions_functions_namespaceObject, "unflatten", function() { return unflatten; });
__webpack_require__.d(functions_functions_namespaceObject, "UNIQUE", function() { return unique; });
__webpack_require__.d(functions_functions_namespaceObject, "unique", function() { return unique; });
__webpack_require__.d(functions_functions_namespaceObject, "CHANGED", function() { return changed; });
__webpack_require__.d(functions_functions_namespaceObject, "changed", function() { return changed; });
__webpack_require__.d(functions_functions_namespaceObject, "DIFF", function() { return diff_diff; });
__webpack_require__.d(functions_functions_namespaceObject, "diff", function() { return diff_diff; });
__webpack_require__.d(functions_functions_namespaceObject, "CLEAN", function() { return clean; });
__webpack_require__.d(functions_functions_namespaceObject, "clean", function() { return clean; });
__webpack_require__.d(functions_functions_namespaceObject, "GET", function() { return get; });
__webpack_require__.d(functions_functions_namespaceObject, "get", function() { return get; });
__webpack_require__.d(functions_functions_namespaceObject, "SELECT", function() { return select_select; });
__webpack_require__.d(functions_functions_namespaceObject, "select", function() { return select_select; });
__webpack_require__.d(functions_functions_namespaceObject, "KEYS", function() { return keys_keys; });
__webpack_require__.d(functions_functions_namespaceObject, "keys", function() { return keys_keys; });
__webpack_require__.d(functions_functions_namespaceObject, "ADDRESS", function() { return address; });
__webpack_require__.d(functions_functions_namespaceObject, "address", function() { return address; });
__webpack_require__.d(functions_functions_namespaceObject, "ASSIGN", function() { return functions_assign; });
__webpack_require__.d(functions_functions_namespaceObject, "assign", function() { return functions_assign; });
__webpack_require__.d(functions_functions_namespaceObject, "BASE", function() { return base_base; });
__webpack_require__.d(functions_functions_namespaceObject, "base", function() { return base_base; });
__webpack_require__.d(functions_functions_namespaceObject, "CELLINDEX", function() { return cellindex; });
__webpack_require__.d(functions_functions_namespaceObject, "cellIndex", function() { return cellindex; });
__webpack_require__.d(functions_functions_namespaceObject, "cellindex", function() { return cellindex; });
__webpack_require__.d(functions_functions_namespaceObject, "CEILING", function() { return ceiling; });
__webpack_require__.d(functions_functions_namespaceObject, "ceiling", function() { return ceiling; });
__webpack_require__.d(functions_functions_namespaceObject, "COLUMN", function() { return column_column; });
__webpack_require__.d(functions_functions_namespaceObject, "column", function() { return column_column; });
__webpack_require__.d(functions_functions_namespaceObject, "COLUMNLETTER", function() { return columnletter; });
__webpack_require__.d(functions_functions_namespaceObject, "columnLetter", function() { return columnletter; });
__webpack_require__.d(functions_functions_namespaceObject, "columnletter", function() { return columnletter; });
__webpack_require__.d(functions_functions_namespaceObject, "COLUMNNUMBER", function() { return columnnumber; });
__webpack_require__.d(functions_functions_namespaceObject, "columnNumber", function() { return columnnumber; });
__webpack_require__.d(functions_functions_namespaceObject, "columnnumber", function() { return columnnumber; });
__webpack_require__.d(functions_functions_namespaceObject, "DECODEBASE64", function() { return decodebase64["a" /* default */]; });
__webpack_require__.d(functions_functions_namespaceObject, "decodeBase64", function() { return decodebase64["a" /* default */]; });
__webpack_require__.d(functions_functions_namespaceObject, "decodebase64", function() { return decodebase64["a" /* default */]; });
__webpack_require__.d(functions_functions_namespaceObject, "DECODEJWT", function() { return decodejwt; });
__webpack_require__.d(functions_functions_namespaceObject, "decodeJWT", function() { return decodejwt; });
__webpack_require__.d(functions_functions_namespaceObject, "decodejwt", function() { return decodejwt; });
__webpack_require__.d(functions_functions_namespaceObject, "ENTRIES", function() { return entries; });
__webpack_require__.d(functions_functions_namespaceObject, "entries", function() { return entries; });
__webpack_require__.d(functions_functions_namespaceObject, "EVEN", function() { return even; });
__webpack_require__.d(functions_functions_namespaceObject, "even", function() { return even; });
__webpack_require__.d(functions_functions_namespaceObject, "FLOOR", function() { return floor; });
__webpack_require__.d(functions_functions_namespaceObject, "floor", function() { return floor; });
__webpack_require__.d(functions_functions_namespaceObject, "GROUP", function() { return group; });
__webpack_require__.d(functions_functions_namespaceObject, "group", function() { return group; });
__webpack_require__.d(functions_functions_namespaceObject, "GUID", function() { return guid; });
__webpack_require__.d(functions_functions_namespaceObject, "guid", function() { return guid; });
__webpack_require__.d(functions_functions_namespaceObject, "HASH", function() { return hash; });
__webpack_require__.d(functions_functions_namespaceObject, "hash", function() { return hash; });
__webpack_require__.d(functions_functions_namespaceObject, "INT", function() { return int_int; });
__webpack_require__.d(functions_functions_namespaceObject, "int", function() { return int_int; });
__webpack_require__.d(functions_functions_namespaceObject, "INDEX2COL", function() { return index2col; });
__webpack_require__.d(functions_functions_namespaceObject, "index2Col", function() { return index2col; });
__webpack_require__.d(functions_functions_namespaceObject, "index2col", function() { return index2col; });
__webpack_require__.d(functions_functions_namespaceObject, "INDEX2ROW", function() { return index2row; });
__webpack_require__.d(functions_functions_namespaceObject, "index2Row", function() { return index2row; });
__webpack_require__.d(functions_functions_namespaceObject, "index2row", function() { return index2row; });
__webpack_require__.d(functions_functions_namespaceObject, "INTERSECT", function() { return intersect; });
__webpack_require__.d(functions_functions_namespaceObject, "intersect", function() { return intersect; });
__webpack_require__.d(functions_functions_namespaceObject, "INTERPOLATE", function() { return interpolate; });
__webpack_require__.d(functions_functions_namespaceObject, "interpolate", function() { return interpolate; });
__webpack_require__.d(functions_functions_namespaceObject, "INTERPOLATOR", function() { return interpolator; });
__webpack_require__.d(functions_functions_namespaceObject, "interpolator", function() { return interpolator; });
__webpack_require__.d(functions_functions_namespaceObject, "N", function() { return n_n; });
__webpack_require__.d(functions_functions_namespaceObject, "n", function() { return n_n; });
__webpack_require__.d(functions_functions_namespaceObject, "NUMBERS", function() { return numbers_numbers; });
__webpack_require__.d(functions_functions_namespaceObject, "numbers", function() { return numbers_numbers; });
__webpack_require__.d(functions_functions_namespaceObject, "OVERLAP", function() { return overlap; });
__webpack_require__.d(functions_functions_namespaceObject, "overlap", function() { return overlap; });
__webpack_require__.d(functions_functions_namespaceObject, "REF", function() { return ref_ref; });
__webpack_require__.d(functions_functions_namespaceObject, "ref", function() { return ref_ref; });
__webpack_require__.d(functions_functions_namespaceObject, "SERIAL", function() { return serial; });
__webpack_require__.d(functions_functions_namespaceObject, "serial", function() { return serial; });
__webpack_require__.d(functions_functions_namespaceObject, "CONCAT", function() { return concat; });
__webpack_require__.d(functions_functions_namespaceObject, "concat", function() { return concat; });
__webpack_require__.d(functions_functions_namespaceObject, "MID", function() { return mid; });
__webpack_require__.d(functions_functions_namespaceObject, "mid", function() { return mid; });
__webpack_require__.d(functions_functions_namespaceObject, "NUMBERSTRING", function() { return numberstring; });
__webpack_require__.d(functions_functions_namespaceObject, "numberstring", function() { return numberstring; });
__webpack_require__.d(functions_functions_namespaceObject, "inlist", function() { return INLIST; });
__webpack_require__.d(functions_functions_namespaceObject, "INLIST", function() { return INLIST; });
__webpack_require__.d(functions_functions_namespaceObject, "startsWith", function() { return STARTSWITH; });
__webpack_require__.d(functions_functions_namespaceObject, "STARTSWITH", function() { return STARTSWITH; });
__webpack_require__.d(functions_functions_namespaceObject, "isNull", function() { return isNull; });
__webpack_require__.d(functions_functions_namespaceObject, "ISNULL", function() { return isNull; });
__webpack_require__.d(functions_functions_namespaceObject, "isDigit", function() { return functions_isDigit; });
__webpack_require__.d(functions_functions_namespaceObject, "ISDIGIT", function() { return functions_isDigit; });
__webpack_require__.d(functions_functions_namespaceObject, "checkMobile", function() { return mobile; });
__webpack_require__.d(functions_functions_namespaceObject, "CHECKMOBILE", function() { return mobile; });
__webpack_require__.d(functions_functions_namespaceObject, "isUSCI", function() { return isUSCI; });
__webpack_require__.d(functions_functions_namespaceObject, "ISUSCI", function() { return isUSCI; });
__webpack_require__.d(functions_functions_namespaceObject, "ISINT", function() { return functions_isInt; });
__webpack_require__.d(functions_functions_namespaceObject, "calcFormulaVal", function() { return calcFormulaVal; });
__webpack_require__.d(functions_functions_namespaceObject, "clearFormulaValCache", function() { return clearFormulaValCache; });

// CONCATENATED MODULE: ./node_modules/@vue/cli-service/lib/commands/build/setPublicPath.js
// This file is imported into lib/wc client bundles.

if (typeof window !== 'undefined') {
  var currentScript = window.document.currentScript
  if (true) {
    var getCurrentScript = __webpack_require__("8875")
    currentScript = getCurrentScript()

    // for backward compatibility, because previously we directly included the polyfill
    if (!('currentScript' in document)) {
      Object.defineProperty(document, 'currentScript', { get: getCurrentScript })
    }
  }

  var setPublicPath_src = currentScript && currentScript.src.match(/(.+\/)[^/]+\.js(\?.*)?$/)
  if (setPublicPath_src) {
    __webpack_require__.p = setPublicPath_src[1] // eslint-disable-line
  }
}

// Indicate to webpack that this file can be concatenated
/* harmony default export */ var setPublicPath = (null);

// EXTERNAL MODULE: ./node_modules/core-js/modules/es.array.concat.js
var es_array_concat = __webpack_require__("99af");

// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"7cdf87ba-vue-loader-template"}!./node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ref--1-0!./node_modules/vue-loader/lib??vue-loader-options!./src/index.vue?vue&type=template&id=4fb99c2a&scoped=true&
var lib_vue_loader_options_srcvue_type_template_id_4fb99c2a_scoped_true_render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:"sheet-edit"},[_c('sheet',_vm._g({ref:"sheet",style:({ 'margin-left': _vm.maxTreeWidth + 'px' }),on:{"sort-filter":_vm.sortFilter,"tool-selected":_vm.toolSelected,"open-functions":_vm.openFunctions,"validation":_vm.validation,"edit-format":_vm.editFormat,"set-cell-size":_vm.setCellSize,"cell-selected":_vm.selectCellItem}},_vm.$listeners)),(_vm.showInform)?_c('inform',{key:_vm.activeSheetName + _vm.renderKey,ref:"inform",attrs:{"activeSheetName":_vm.activeSheetName,"formConfig":_vm.formConfig,"getSpreadsheet":_vm.getSpreadsheet,"isEdit":_vm.isEdit,"showFieldName":_vm.showFieldName,"renderTime":_vm.renderTime},on:{"syncViewRange":_vm.syncViewRange,"setLayerConfig":_vm.setLayerConfig}}):_vm._e(),(_vm.showBackImg)?_c('backImg',{key:'backImg' + _vm.activeSheetName + _vm.renderKey,ref:"backImg",attrs:{"activeSheetName":_vm.activeSheetName,"getSpreadsheet":_vm.getSpreadsheet,"isEdit":_vm.isEdit}}):_vm._e(),(_vm.showRect)?_c('rectTable',{key:'rect' + _vm.activeSheetName + _vm.renderKey,ref:"rectTable",attrs:{"activeSheetName":_vm.activeSheetName,"rectConfig":_vm.rectConfig,"getSpreadsheet":_vm.getSpreadsheet,"showRectType":_vm.showRectType},on:{"update:rectConfig":function($event){_vm.rectConfig=$event},"update:rect-config":function($event){_vm.rectConfig=$event}}}):_vm._e(),(_vm.isFold)?_c('foldMap',{key:'treeMap' + _vm.activeSheetName,ref:"treeMap",attrs:{"foldData":_vm.foldConfig,"activeSheetName":_vm.activeSheetName,"getSpreadsheet":_vm.getSpreadsheet},on:{"setMaxWidth":_vm.setMaxWidth}}):_vm._e(),(_vm.showSlash)?_c('slash',{attrs:{"slashConfig":_vm.slashConfig,"getSpreadsheet":_vm.getSpreadsheet},on:{"cancelDialog":_vm.close}}):_vm._e(),_c('sheetDialog',{ref:"sheetDialog",attrs:{"getSpreadsheet":_vm.getSpreadsheet,"config":_vm.mergeConfig}})],1)}
var staticRenderFns = []


// CONCATENATED MODULE: ./src/index.vue?vue&type=template&id=4fb99c2a&scoped=true&

// CONCATENATED MODULE: ./node_modules/@babel/runtime/helpers/esm/arrayWithHoles.js
function _arrayWithHoles(arr) {
  if (Array.isArray(arr)) return arr;
}
// EXTERNAL MODULE: ./node_modules/core-js/modules/es.symbol.js
var es_symbol = __webpack_require__("a4d3");

// EXTERNAL MODULE: ./node_modules/core-js/modules/es.symbol.description.js
var es_symbol_description = __webpack_require__("e01a");

// EXTERNAL MODULE: ./node_modules/core-js/modules/es.object.to-string.js
var es_object_to_string = __webpack_require__("d3b7");

// EXTERNAL MODULE: ./node_modules/core-js/modules/es.symbol.iterator.js
var es_symbol_iterator = __webpack_require__("d28b");

// EXTERNAL MODULE: ./node_modules/core-js/modules/es.array.iterator.js
var es_array_iterator = __webpack_require__("e260");

// EXTERNAL MODULE: ./node_modules/core-js/modules/es.string.iterator.js
var es_string_iterator = __webpack_require__("3ca3");

// EXTERNAL MODULE: ./node_modules/core-js/modules/web.dom-collections.iterator.js
var web_dom_collections_iterator = __webpack_require__("ddb0");

// CONCATENATED MODULE: ./node_modules/@babel/runtime/helpers/esm/iterableToArrayLimit.js







function _iterableToArrayLimit(arr, i) {
  var _i = arr == null ? null : typeof Symbol !== "undefined" && arr[Symbol.iterator] || arr["@@iterator"];

  if (_i == null) return;
  var _arr = [];
  var _n = true;
  var _d = false;

  var _s, _e;

  try {
    for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) {
      _arr.push(_s.value);

      if (i && _arr.length === i) break;
    }
  } catch (err) {
    _d = true;
    _e = err;
  } finally {
    try {
      if (!_n && _i["return"] != null) _i["return"]();
    } finally {
      if (_d) throw _e;
    }
  }

  return _arr;
}
// EXTERNAL MODULE: ./node_modules/core-js/modules/es.array.slice.js
var es_array_slice = __webpack_require__("fb6a");

// EXTERNAL MODULE: ./node_modules/core-js/modules/es.function.name.js
var es_function_name = __webpack_require__("b0c0");

// EXTERNAL MODULE: ./node_modules/core-js/modules/es.array.from.js
var es_array_from = __webpack_require__("a630");

// EXTERNAL MODULE: ./node_modules/core-js/modules/es.regexp.exec.js
var es_regexp_exec = __webpack_require__("ac1f");

// EXTERNAL MODULE: ./node_modules/core-js/modules/es.regexp.test.js
var es_regexp_test = __webpack_require__("00b4");

// CONCATENATED MODULE: ./node_modules/@babel/runtime/helpers/esm/arrayLikeToArray.js
function _arrayLikeToArray(arr, len) {
  if (len == null || len > arr.length) len = arr.length;

  for (var i = 0, arr2 = new Array(len); i < len; i++) {
    arr2[i] = arr[i];
  }

  return arr2;
}
// CONCATENATED MODULE: ./node_modules/@babel/runtime/helpers/esm/unsupportedIterableToArray.js








function _unsupportedIterableToArray(o, minLen) {
  if (!o) return;
  if (typeof o === "string") return _arrayLikeToArray(o, minLen);
  var n = Object.prototype.toString.call(o).slice(8, -1);
  if (n === "Object" && o.constructor) n = o.constructor.name;
  if (n === "Map" || n === "Set") return Array.from(o);
  if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);
}
// CONCATENATED MODULE: ./node_modules/@babel/runtime/helpers/esm/nonIterableRest.js
function _nonIterableRest() {
  throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");
}
// CONCATENATED MODULE: ./node_modules/@babel/runtime/helpers/esm/slicedToArray.js




function _slicedToArray(arr, i) {
  return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest();
}
// CONCATENATED MODULE: ./node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js








function _createForOfIteratorHelper(o, allowArrayLike) {
  var it = typeof Symbol !== "undefined" && o[Symbol.iterator] || o["@@iterator"];

  if (!it) {
    if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === "number") {
      if (it) o = it;
      var i = 0;

      var F = function F() {};

      return {
        s: F,
        n: function n() {
          if (i >= o.length) return {
            done: true
          };
          return {
            done: false,
            value: o[i++]
          };
        },
        e: function e(_e) {
          throw _e;
        },
        f: F
      };
    }

    throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");
  }

  var normalCompletion = true,
      didErr = false,
      err;
  return {
    s: function s() {
      it = it.call(o);
    },
    n: function n() {
      var step = it.next();
      normalCompletion = step.done;
      return step;
    },
    e: function e(_e2) {
      didErr = true;
      err = _e2;
    },
    f: function f() {
      try {
        if (!normalCompletion && it["return"] != null) it["return"]();
      } finally {
        if (didErr) throw err;
      }
    }
  };
}
// EXTERNAL MODULE: ./node_modules/core-js/modules/es.object.keys.js
var es_object_keys = __webpack_require__("b64b");

// EXTERNAL MODULE: ./node_modules/core-js/modules/es.array.filter.js
var es_array_filter = __webpack_require__("4de4");

// EXTERNAL MODULE: ./node_modules/core-js/modules/es.object.get-own-property-descriptor.js
var es_object_get_own_property_descriptor = __webpack_require__("e439");

// EXTERNAL MODULE: ./node_modules/core-js/modules/web.dom-collections.for-each.js
var web_dom_collections_for_each = __webpack_require__("159b");

// EXTERNAL MODULE: ./node_modules/core-js/modules/es.object.get-own-property-descriptors.js
var es_object_get_own_property_descriptors = __webpack_require__("dbb4");

// CONCATENATED MODULE: ./node_modules/@babel/runtime/helpers/esm/defineProperty.js
function _defineProperty(obj, key, value) {
  if (key in obj) {
    Object.defineProperty(obj, key, {
      value: value,
      enumerable: true,
      configurable: true,
      writable: true
    });
  } else {
    obj[key] = value;
  }

  return obj;
}
// CONCATENATED MODULE: ./node_modules/@babel/runtime/helpers/esm/objectSpread2.js









function ownKeys(object, enumerableOnly) {
  var keys = Object.keys(object);

  if (Object.getOwnPropertySymbols) {
    var symbols = Object.getOwnPropertySymbols(object);

    if (enumerableOnly) {
      symbols = symbols.filter(function (sym) {
        return Object.getOwnPropertyDescriptor(object, sym).enumerable;
      });
    }

    keys.push.apply(keys, symbols);
  }

  return keys;
}

function _objectSpread2(target) {
  for (var i = 1; i < arguments.length; i++) {
    var source = arguments[i] != null ? arguments[i] : {};

    if (i % 2) {
      ownKeys(Object(source), true).forEach(function (key) {
        _defineProperty(target, key, source[key]);
      });
    } else if (Object.getOwnPropertyDescriptors) {
      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));
    } else {
      ownKeys(Object(source)).forEach(function (key) {
        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));
      });
    }
  }

  return target;
}
// EXTERNAL MODULE: ./node_modules/core-js/modules/es.json.stringify.js
var es_json_stringify = __webpack_require__("e9c4");

// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"7cdf87ba-vue-loader-template"}!./node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ref--1-0!./node_modules/vue-loader/lib??vue-loader-options!./src/sheet/index.vue?vue&type=template&id=018ee75b&scoped=true&
var sheetvue_type_template_id_018ee75b_scoped_true_render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:"spread-sheet"})}
var sheetvue_type_template_id_018ee75b_scoped_true_staticRenderFns = []


// CONCATENATED MODULE: ./src/sheet/index.vue?vue&type=template&id=018ee75b&scoped=true&

// CONCATENATED MODULE: ./node_modules/@babel/runtime/helpers/esm/classCallCheck.js
function _classCallCheck(instance, Constructor) {
  if (!(instance instanceof Constructor)) {
    throw new TypeError("Cannot call a class as a function");
  }
}
// CONCATENATED MODULE: ./node_modules/@babel/runtime/helpers/esm/createClass.js
function _defineProperties(target, props) {
  for (var i = 0; i < props.length; i++) {
    var descriptor = props[i];
    descriptor.enumerable = descriptor.enumerable || false;
    descriptor.configurable = true;
    if ("value" in descriptor) descriptor.writable = true;
    Object.defineProperty(target, descriptor.key, descriptor);
  }
}

function _createClass(Constructor, protoProps, staticProps) {
  if (protoProps) _defineProperties(Constructor.prototype, protoProps);
  if (staticProps) _defineProperties(Constructor, staticProps);
  return Constructor;
}
// EXTERNAL MODULE: ./node_modules/core-js/modules/es.array.splice.js
var es_array_splice = __webpack_require__("a434");

// EXTERNAL MODULE: ./node_modules/core-js/modules/es.regexp.constructor.js
var es_regexp_constructor = __webpack_require__("4d63");

// EXTERNAL MODULE: ./node_modules/core-js/modules/es.regexp.dot-all.js
var es_regexp_dot_all = __webpack_require__("c607");

// EXTERNAL MODULE: ./node_modules/core-js/modules/es.regexp.sticky.js
var es_regexp_sticky = __webpack_require__("2c3e");

// EXTERNAL MODULE: ./node_modules/core-js/modules/es.regexp.to-string.js
var es_regexp_to_string = __webpack_require__("25f0");

// EXTERNAL MODULE: ./node_modules/core-js/modules/es.string.match.js
var es_string_match = __webpack_require__("466d");

// EXTERNAL MODULE: ./node_modules/core-js/modules/es.array.find-index.js
var es_array_find_index = __webpack_require__("c740");

// EXTERNAL MODULE: ./node_modules/core-js/modules/es.array.map.js
var es_array_map = __webpack_require__("d81d");

// EXTERNAL MODULE: ./node_modules/core-js/modules/es.array.join.js
var es_array_join = __webpack_require__("a15b");

// EXTERNAL MODULE: ./node_modules/core-js/modules/es.array.includes.js
var es_array_includes = __webpack_require__("caad");

// EXTERNAL MODULE: ./node_modules/core-js/modules/es.string.includes.js
var es_string_includes = __webpack_require__("2532");

// EXTERNAL MODULE: ./node_modules/core-js/modules/es.string.split.js
var es_string_split = __webpack_require__("1276");

// EXTERNAL MODULE: ./node_modules/core-js/modules/es.string.replace.js
var es_string_replace = __webpack_require__("5319");

// CONCATENATED MODULE: ./node_modules/@babel/runtime/helpers/esm/iterableToArray.js








function _iterableToArray(iter) {
  if (typeof Symbol !== "undefined" && iter[Symbol.iterator] != null || iter["@@iterator"] != null) return Array.from(iter);
}
// CONCATENATED MODULE: ./node_modules/@babel/runtime/helpers/esm/toArray.js




function _toArray(arr) {
  return _arrayWithHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableRest();
}
// CONCATENATED MODULE: ./src/sheet/component/element.js











var element_Element = /*#__PURE__*/function () {
  function Element(tag) {
    var className = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';

    _classCallCheck(this, Element);

    if (typeof tag === 'string') {
      this.el = document.createElement(tag);
      this.el.className = className;
    } else {
      this.el = tag;
    }

    this.data = {};
  }

  _createClass(Element, [{
    key: "data",
    value: function data(key, value) {
      if (value !== undefined) {
        this.data[key] = value;
        return this;
      }

      return this.data[key];
    }
  }, {
    key: "on",
    value: function on(eventNames, handler) {
      var _eventNames$split = eventNames.split('.'),
          _eventNames$split2 = _toArray(_eventNames$split),
          fen = _eventNames$split2[0],
          oen = _eventNames$split2.slice(1);

      var eventName = fen;

      if (eventName === 'mousewheel' && /Firefox/i.test(window.navigator.userAgent)) {
        eventName = 'DOMMouseScroll';
      }

      this.el.addEventListener(eventName, function (evt) {
        handler(evt);

        for (var i = 0; i < oen.length; i += 1) {
          var k = oen[i];

          if (k === 'left' && evt.button !== 0) {
            return;
          }

          if (k === 'right' && evt.button !== 2) {
            return;
          }

          if (k === 'stop') {
            evt.stopPropagation();
          }
        }
      });
      return this;
    }
  }, {
    key: "offset",
    value: function offset(value) {
      var _this = this;

      if (value !== undefined) {
        Object.keys(value).forEach(function (k) {
          _this.css(k, "".concat(value[k], "px"));
        });
        return this;
      }

      var _this$el = this.el,
          offsetTop = _this$el.offsetTop,
          offsetLeft = _this$el.offsetLeft,
          offsetHeight = _this$el.offsetHeight,
          offsetWidth = _this$el.offsetWidth;
      return {
        top: offsetTop,
        left: offsetLeft,
        height: offsetHeight,
        width: offsetWidth
      };
    }
  }, {
    key: "scroll",
    value: function scroll(v) {
      var el = this.el;

      if (v !== undefined) {
        if (v.left !== undefined) {
          el.scrollLeft = v.left;
        }

        if (v.top !== undefined) {
          el.scrollTop = v.top;
        }
      }

      return {
        left: el.scrollLeft,
        top: el.scrollTop
      };
    }
  }, {
    key: "box",
    value: function box() {
      return this.el.getBoundingClientRect();
    }
  }, {
    key: "parent",
    value: function parent() {
      return new Element(this.el.parentNode);
    }
  }, {
    key: "children",
    value: function children() {
      var _this2 = this;

      for (var _len = arguments.length, eles = new Array(_len), _key = 0; _key < _len; _key++) {
        eles[_key] = arguments[_key];
      }

      if (arguments.length === 0) {
        return this.el.childNodes;
      }

      eles.forEach(function (ele) {
        return _this2.child(ele);
      });
      return this;
    }
  }, {
    key: "removeChild",
    value: function removeChild(el) {
      this.el.removeChild(el);
    }
    /*
    first() {
      return this.el.firstChild;
    }
     last() {
      return this.el.lastChild;
    }
     remove(ele) {
      return this.el.removeChild(ele);
    }
     prepend(ele) {
      const { el } = this;
      if (el.children.length > 0) {
        el.insertBefore(ele, el.firstChild);
      } else {
        el.appendChild(ele);
      }
      return this;
    }
     prev() {
      return this.el.previousSibling;
    }
     next() {
      return this.el.nextSibling;
    }
    */

  }, {
    key: "child",
    value: function child(arg) {
      var ele = arg;

      if (typeof arg === 'string') {
        ele = document.createTextNode(arg);
      } else if (arg instanceof Element) {
        ele = arg.el;
      } // try {


      this.el.appendChild(ele); // } catch (e) {
      //   debugger;
      //   console.log(e);
      // }

      return this;
    }
  }, {
    key: "contains",
    value: function contains(ele) {
      return this.el.contains(ele);
    }
  }, {
    key: "className",
    value: function className(v) {
      if (v !== undefined) {
        this.el.className = v;
        return this;
      }

      return this.el.className;
    }
  }, {
    key: "addClass",
    value: function addClass(name) {
      this.el.classList.add(name);
      return this;
    }
  }, {
    key: "hasClass",
    value: function hasClass(name) {
      return this.el.classList.contains(name);
    }
  }, {
    key: "removeClass",
    value: function removeClass(name) {
      this.el.classList.remove(name);
      return this;
    }
  }, {
    key: "toggle",
    value: function toggle() {
      var cls = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'active';
      return this.toggleClass(cls);
    }
  }, {
    key: "toggleClass",
    value: function toggleClass(name) {
      return this.el.classList.toggle(name);
    }
  }, {
    key: "active",
    value: function active() {
      var flag = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;
      var cls = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'active';
      if (flag) this.addClass(cls);else this.removeClass(cls);
      return this;
    }
  }, {
    key: "checked",
    value: function checked() {
      var flag = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;
      this.active(flag, 'checked');
      return this;
    }
  }, {
    key: "disabled",
    value: function disabled() {
      var flag = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;
      if (flag) this.addClass('disabled');else this.removeClass('disabled');
      return this;
    } // key, value
    // key
    // {k, v}...

  }, {
    key: "attr",
    value: function attr(key, value) {
      var _this3 = this;

      if (value !== undefined) {
        this.el.setAttribute(key, value);
      } else {
        if (typeof key === 'string') {
          return this.el.getAttribute(key);
        }

        Object.keys(key).forEach(function (k) {
          _this3.el.setAttribute(k, key[k]);
        });
      }

      return this;
    }
  }, {
    key: "removeAttr",
    value: function removeAttr(key) {
      this.el.removeAttribute(key);
      return this;
    }
  }, {
    key: "html",
    value: function html(content) {
      if (content !== undefined) {
        this.el.innerHTML = content;
        return this;
      }

      return this.el.innerHTML;
    }
  }, {
    key: "text",
    value: function text(content) {
      if (content !== undefined) {
        this.el.innerText = content;
        return this;
      }

      return this.el.innerText;
    }
  }, {
    key: "val",
    value: function val(v) {
      if (v !== undefined) {
        this.el.value = v;
        return this;
      }

      return this.el.value;
    }
  }, {
    key: "focus",
    value: function focus() {
      this.el.focus();
    }
  }, {
    key: "cssRemoveKeys",
    value: function cssRemoveKeys() {
      var _this4 = this;

      for (var _len2 = arguments.length, keys = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {
        keys[_key2] = arguments[_key2];
      }

      keys.forEach(function (k) {
        return _this4.el.style.removeProperty(k);
      });
      return this;
    } // css( propertyName )
    // css( propertyName, value )
    // css( properties )

  }, {
    key: "css",
    value: function css(name, value) {
      var _this5 = this;

      if (value === undefined && typeof name !== 'string') {
        Object.keys(name).forEach(function (k) {
          _this5.el.style[k] = name[k];
        });
        return this;
      }

      if (value !== undefined) {
        this.el.style[name] = value;
        return this;
      }

      return this.el.style[name];
    }
  }, {
    key: "computedStyle",
    value: function computedStyle() {
      return window.getComputedStyle(this.el, null);
    }
  }, {
    key: "show",
    value: function show() {
      this.css('display', 'block');
      return this;
    }
  }, {
    key: "showInline",
    value: function showInline() {
      this.css('display', 'inline-block');
      return this;
    }
  }, {
    key: "hide",
    value: function hide() {
      this.css('display', 'none');
      return this;
    }
  }]);

  return Element;
}();

var element_h = function h(tag) {
  var className = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';
  return new element_Element(tag, className);
};


// CONCATENATED MODULE: ./node_modules/@babel/runtime/helpers/esm/arrayWithoutHoles.js

function _arrayWithoutHoles(arr) {
  if (Array.isArray(arr)) return _arrayLikeToArray(arr);
}
// CONCATENATED MODULE: ./node_modules/@babel/runtime/helpers/esm/nonIterableSpread.js
function _nonIterableSpread() {
  throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");
}
// CONCATENATED MODULE: ./node_modules/@babel/runtime/helpers/esm/toConsumableArray.js




function _toConsumableArray(arr) {
  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();
}
// EXTERNAL MODULE: ./node_modules/core-js/modules/es.set.js
var es_set = __webpack_require__("6062");

// EXTERNAL MODULE: ./node_modules/core-js/modules/es.map.js
var es_map = __webpack_require__("4ec9");

// EXTERNAL MODULE: ./node_modules/core-js/modules/es.object.assign.js
var es_object_assign = __webpack_require__("cca6");

// EXTERNAL MODULE: ./node_modules/core-js/modules/es.array.sort.js
var es_array_sort = __webpack_require__("4e82");

// EXTERNAL MODULE: ./src/sheet/core/_.prototypes.js
var _prototypes = __webpack_require__("6483");

// CONCATENATED MODULE: ./src/sheet/core/alphabet.js




var alphabets = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';

function alphabet(index) {
  return alphabets.charAt(index % alphabets.length);
}
/** index number 2 letters
 * @example stringAt(26) ==> 'AA'
 * @date 2019-10-10
 * @export
 * @param {number} index
 * @returns {string}
 */


function stringAt(index) {
  var ary = [];

  while (index >= 0) {
    ary.push(alphabet(index));
    index = parseInt(index / alphabets.length + '', 10) - 1;
  }

  return ary.reverse().join('');
}
/** translate letter in A1-tag to number
 * @date 2019-10-10
 * @export
 * @param {string} str "AA" in A1-tag "AA1"
 * @returns {number}
 */

function indexAt(str) {
  var ret = 0;

  for (var i = 0; i !== str.length; ++i) {
    ret = 26 * ret + str.charCodeAt(i) - 64;
  }

  return ret - 1;
} // B10 => x,y

/** translate A1-tag to XY-tag
 * @date 2019-10-10
 * @export
 * @param {tagA1} src
 * @returns {tagXY}
 */

function alphabet_expr2xy(src) {
  var x = '';
  var y = '';

  for (var i = 0; i < src.length; i += 1) {
    if (src.charAt(i) >= '0' && src.charAt(i) <= '9') {
      y += src.charAt(i);
    } else {
      x += src.charAt(i);
    }
  }

  return [indexAt(x), parseInt(y, 10) - 1];
}
/** translate XY-tag to A1-tag
 * @example x,y => B10
 * @date 2019-10-10
 * @export
 * @param {number} x
 * @param {number} y
 * @returns {tagA1}
 */

function alphabet_xy2expr(x, y) {
  return "".concat(stringAt(x)).concat(y + 1);
}
/** translate A1-tag src by (xn, yn)
 * @date 2019-10-10
 * @export
 * @param {tagA1} src
 * @param {number} xn
 * @param {number} yn
 * @returns {tagA1}
 */

function expr2expr(src, xn, yn) {
  var condition = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : function () {
    return true;
  };
  if (xn === 0 && yn === 0) return src;

  var _expr2xy = alphabet_expr2xy(src),
      _expr2xy2 = _slicedToArray(_expr2xy, 2),
      x = _expr2xy2[0],
      y = _expr2xy2[1];

  if (!condition(x, y)) return src;
  return alphabet_xy2expr(x + xn, y + yn);
}
/* harmony default export */ var core_alphabet = ({
  stringAt: stringAt,
  indexAt: indexAt,
  expr2xy: alphabet_expr2xy,
  xy2expr: alphabet_xy2expr,
  expr2expr: expr2expr
});
// CONCATENATED MODULE: ./src/sheet/core/cell_range.js








var cell_range_CellRange = /*#__PURE__*/function () {
  function CellRange(sri, sci, eri, eci) {
    var w = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 0;
    var h = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : 0;

    _classCallCheck(this, CellRange);

    this.sri = sri;
    this.sci = sci;
    this.eri = eri;
    this.eci = eci;
    this.w = w;
    this.h = h;
  }

  _createClass(CellRange, [{
    key: "set",
    value: function set(sri, sci, eri, eci) {
      this.sri = sri;
      this.sci = sci;
      this.eri = eri;
      this.eci = eci;
    }
  }, {
    key: "multiple",
    value: function multiple() {
      return this.eri - this.sri > 0 || this.eci - this.sci > 0;
    } // cell-index: ri, ci
    // cell-ref: A10

  }, {
    key: "includes",
    value: function includes() {
      var ri = 0,
          ci = 0;

      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
        args[_key] = arguments[_key];
      }

      if (args.length === 1) {
        var _expr2xy = alphabet_expr2xy(args[0]);

        var _expr2xy2 = _slicedToArray(_expr2xy, 2);

        ci = _expr2xy2[0];
        ri = _expr2xy2[1];
      } else if (args.length === 2) {
        ri = args[0];
        ci = args[1];
      }

      var sri = this.sri,
          sci = this.sci,
          eri = this.eri,
          eci = this.eci;
      return sri <= ri && ri <= eri && sci <= ci && ci <= eci;
    }
  }, {
    key: "each",
    value: function each(cb) {
      var rowFilter = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : function () {
        return true;
      };
      var sri = this.sri,
          sci = this.sci,
          eri = this.eri,
          eci = this.eci;

      for (var i = sri; i <= eri; i += 1) {
        if (rowFilter(i)) {
          for (var j = sci; j <= eci; j += 1) {
            cb(i, j);
          }
        }
      }
    }
  }, {
    key: "eachRow",
    value: function eachRow(cb) {
      var sri = this.sri,
          eri = this.eri;

      for (var i = sri; i <= eri; i += 1) {
        cb(i);
      }
    }
  }, {
    key: "eachCol",
    value: function eachCol(cb) {
      var sci = this.sci,
          eci = this.eci;

      for (var j = sci; j <= eci; j += 1) {
        cb(j);
      }
    }
  }, {
    key: "contains",
    value: function contains(other) {
      return this.sri <= other.sri && this.sci <= other.sci && this.eri >= other.eri && this.eci >= other.eci;
    } // within

  }, {
    key: "within",
    value: function within(other) {
      return this.sri >= other.sri && this.sci >= other.sci && this.eri <= other.eri && this.eci <= other.eci;
    } // disjoint

  }, {
    key: "disjoint",
    value: function disjoint(other) {
      return this.sri > other.eri || this.sci > other.eci || other.sri > this.eri || other.sci > this.eci;
    } // intersects

  }, {
    key: "intersects",
    value: function intersects(other) {
      return this.sri <= other.eri && this.sci <= other.eci && other.sri <= this.eri && other.sci <= this.eci;
    } // union

  }, {
    key: "union",
    value: function union(other) {
      var sri = this.sri,
          sci = this.sci,
          eri = this.eri,
          eci = this.eci;
      return new CellRange(other.sri < sri ? other.sri : sri, other.sci < sci ? other.sci : sci, other.eri > eri ? other.eri : eri, other.eci > eci ? other.eci : eci);
    } // intersection
    // intersection(other) {}
    // Returns Array<CellRange> that represents that part of this that does not intersect with other
    // difference

  }, {
    key: "difference",
    value: function difference(other) {
      var ret = [];

      var addRet = function addRet(sri, sci, eri, eci) {
        ret.push(new CellRange(sri, sci, eri, eci));
      };

      var sri = this.sri,
          sci = this.sci,
          eri = this.eri,
          eci = this.eci;
      var dsr = other.sri - sri;
      var dsc = other.sci - sci;
      var der = eri - other.eri;
      var dec = eci - other.eci;

      if (dsr > 0) {
        addRet(sri, sci, other.sri - 1, eci);

        if (der > 0) {
          addRet(other.eri + 1, sci, eri, eci);

          if (dsc > 0) {
            addRet(other.sri, sci, other.eri, other.sci - 1);
          }

          if (dec > 0) {
            addRet(other.sri, other.eci + 1, other.eri, eci);
          }
        } else {
          if (dsc > 0) {
            addRet(other.sri, sci, eri, other.sci - 1);
          }

          if (dec > 0) {
            addRet(other.sri, other.eci + 1, eri, eci);
          }
        }
      } else if (der > 0) {
        addRet(other.eri + 1, sci, eri, eci);

        if (dsc > 0) {
          addRet(sri, sci, other.eri, other.sci - 1);
        }

        if (dec > 0) {
          addRet(sri, other.eci + 1, other.eri, eci);
        }
      }

      if (dsc > 0) {
        addRet(sri, sci, eri, other.sci - 1);

        if (dec > 0) {
          addRet(sri, other.eri + 1, eri, eci);

          if (dsr > 0) {
            addRet(sri, other.sci, other.sri - 1, other.eci);
          }

          if (der > 0) {
            addRet(other.sri + 1, other.sci, eri, other.eci);
          }
        } else {
          if (dsr > 0) {
            addRet(sri, other.sci, other.sri - 1, eci);
          }

          if (der > 0) {
            addRet(other.sri + 1, other.sci, eri, eci);
          }
        }
      } else if (dec > 0) {
        addRet(eri, other.eci + 1, eri, eci);

        if (dsr > 0) {
          addRet(sri, sci, other.sri - 1, other.eci);
        }

        if (der > 0) {
          addRet(other.eri + 1, sci, eri, other.eci);
        }
      }

      return ret;
    }
  }, {
    key: "size",
    value: function size() {
      return [this.eri - this.sri + 1, this.eci - this.sci + 1];
    }
  }, {
    key: "toString",
    value: function toString() {
      var sri = this.sri,
          sci = this.sci,
          eri = this.eri,
          eci = this.eci;
      var ref = alphabet_xy2expr(sci, sri);

      if (this.multiple()) {
        ref = "".concat(ref, ":").concat(alphabet_xy2expr(eci, eri));
      }

      return ref;
    }
  }, {
    key: "clone",
    value: function clone() {
      var sri = this.sri,
          sci = this.sci,
          eri = this.eri,
          eci = this.eci,
          w = this.w,
          h = this.h;
      return new CellRange(sri, sci, eri, eci, w, h);
    }
    /*
    toJSON() {
      return this.toString();
    }
    */

  }, {
    key: "equals",
    value: function equals(other) {
      return this.eri === other.eri && this.eci === other.eci && this.sri === other.sri && this.sci === other.sci;
    }
  }], [{
    key: "valueOf",
    value: function valueOf(ref) {
      // B1:B8, B1 => 1 x 1 cell range
      var refs = ref.split(':');

      var _expr2xy3 = alphabet_expr2xy(refs[0]),
          _expr2xy4 = _slicedToArray(_expr2xy3, 2),
          sci = _expr2xy4[0],
          sri = _expr2xy4[1];

      var eri = sri,
          eci = sci;

      if (refs.length > 1) {
        var _expr2xy5 = alphabet_expr2xy(refs[1]);

        var _expr2xy6 = _slicedToArray(_expr2xy5, 2);

        eci = _expr2xy6[0];
        eri = _expr2xy6[1];
      }

      return new CellRange(sri, sci, eri, eci);
    }
  }]);

  return CellRange;
}();

/* harmony default export */ var cell_range = (cell_range_CellRange);

// CONCATENATED MODULE: ./src/sheet/core/selector.js




var selector_Selector = /*#__PURE__*/function () {
  function Selector() {
    _classCallCheck(this, Selector);

    this.range = new cell_range_CellRange(0, 0, 0, 0);
    this.ri = 0;
    this.ci = 0;
  }

  _createClass(Selector, [{
    key: "multiple",
    value: function multiple() {
      return this.range.multiple();
    }
  }, {
    key: "setIndexes",
    value: function setIndexes(ri, ci) {
      this.ri = ri;
      this.ci = ci;
    }
  }, {
    key: "size",
    value: function size() {
      return this.range.size();
    }
  }]);

  return Selector;
}();


// CONCATENATED MODULE: ./src/sheet/core/scroll.js


var scroll_Scroll = function Scroll() {
  _classCallCheck(this, Scroll);

  this.x = 0; // left

  this.y = 0; // top

  this.ri = 0; // cell row-index

  this.ci = 0; // cell col-index
};


// CONCATENATED MODULE: ./node_modules/@babel/runtime/helpers/esm/objectWithoutPropertiesLoose.js

function _objectWithoutPropertiesLoose(source, excluded) {
  if (source == null) return {};
  var target = {};
  var sourceKeys = Object.keys(source);
  var key, i;

  for (i = 0; i < sourceKeys.length; i++) {
    key = sourceKeys[i];
    if (excluded.indexOf(key) >= 0) continue;
    target[key] = source[key];
  }

  return target;
}
// CONCATENATED MODULE: ./node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js


function _objectWithoutProperties(source, excluded) {
  if (source == null) return {};
  var target = _objectWithoutPropertiesLoose(source, excluded);
  var key, i;

  if (Object.getOwnPropertySymbols) {
    var sourceSymbolKeys = Object.getOwnPropertySymbols(source);

    for (i = 0; i < sourceSymbolKeys.length; i++) {
      key = sourceSymbolKeys[i];
      if (excluded.indexOf(key) >= 0) continue;
      if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;
      target[key] = source[key];
    }
  }

  return target;
}
// CONCATENATED MODULE: ./src/sheet/core/history.js



var _excluded = ["formConfig"];


// import helper from '../helper';
var history_History = /*#__PURE__*/function () {
  function History(isAddHistory) {
    _classCallCheck(this, History);

    this.undoItems = [];
    this.redoItems = [];
    this.isAddHistory = isAddHistory;
  }

  _createClass(History, [{
    key: "add",
    value: function add(data) {
      if (this.isAddHistory) {
        var formConfig = data.formConfig,
            filterData = _objectWithoutProperties(data, _excluded);

        formConfig;
        this.undoItems.push(JSON.stringify(filterData));
        this.redoItems = [];
      }
    }
  }, {
    key: "canUndo",
    value: function canUndo() {
      return this.undoItems.length > 0;
    }
  }, {
    key: "canRedo",
    value: function canRedo() {
      return this.redoItems.length > 0;
    }
  }, {
    key: "undo",
    value: function undo(currentd, cb) {
      var undoItems = this.undoItems,
          redoItems = this.redoItems;

      if (this.canUndo()) {
        redoItems.push(JSON.stringify(currentd));
        cb(JSON.parse(undoItems.pop()));
      }
    }
  }, {
    key: "redo",
    value: function redo(currentd, cb) {
      var undoItems = this.undoItems,
          redoItems = this.redoItems;

      if (this.canRedo()) {
        undoItems.push(JSON.stringify(currentd));
        cb(JSON.parse(redoItems.pop()));
      }
    }
  }]);

  return History;
}();


// CONCATENATED MODULE: ./src/sheet/core/clipboard.js





var clipboard_Clipboard = /*#__PURE__*/function () {
  function Clipboard() {
    _classCallCheck(this, Clipboard);

    this.range = null; // CellRange

    this.state = 'clear';
    this.content = null;
  }

  _createClass(Clipboard, [{
    key: "copy",
    value: function copy(cellRange) {
      this.range = cellRange;
      this.state = 'copy';
      return this;
    }
  }, {
    key: "cut",
    value: function cut(cellRange) {
      this.range = cellRange;
      this.state = 'cut';
      return this;
    }
  }, {
    key: "isCopy",
    value: function isCopy() {
      return this.state === 'copy';
    }
  }, {
    key: "isCut",
    value: function isCut() {
      return this.state === 'cut';
    }
  }, {
    key: "isClear",
    value: function isClear() {
      return this.state === 'clear';
    }
  }, {
    key: "clear",
    value: function clear() {
      this.range = null;
      this.state = 'clear';
    }
  }, {
    key: "setCopy",
    value: function setCopy(content) {
      this.content = content;
    }
  }, {
    key: "isSelf",
    value: function isSelf(other) {
      return this.content === other.replace(/\r/g, '');
    }
  }]);

  return Clipboard;
}();


// CONCATENATED MODULE: ./src/sheet/core/auto_filter.js













 // operator: all|eq|neq|gt|gte|lt|lte|in|be
// value:
//   in => []
//   be => [min, max]

var auto_filter_Filter = /*#__PURE__*/function () {
  function Filter(ci, operator, value) {
    _classCallCheck(this, Filter);

    this.ci = ci;
    this.operator = operator;
    this.value = value;
  }

  _createClass(Filter, [{
    key: "set",
    value: function set(operator, value) {
      this.operator = operator;
      this.value = value;
    }
  }, {
    key: "includes",
    value: function includes(v) {
      var operator = this.operator,
          value = this.value;

      if (operator === 'all') {
        return true;
      }

      if (operator === 'in') {
        return value.includes(v);
      }

      return false;
    }
  }, {
    key: "vlength",
    value: function vlength() {
      var operator = this.operator,
          value = this.value;

      if (operator === 'in') {
        return value.length;
      }

      return 0;
    }
  }, {
    key: "getData",
    value: function getData() {
      var ci = this.ci,
          operator = this.operator,
          value = this.value;
      return {
        ci: ci,
        operator: operator,
        value: value
      };
    }
  }]);

  return Filter;
}();

var auto_filter_Sort = /*#__PURE__*/function () {
  function Sort(ci, order) {
    _classCallCheck(this, Sort);

    this.ci = ci;
    this.order = order;
  }

  _createClass(Sort, [{
    key: "asc",
    value: function asc() {
      return this.order === 'asc';
    }
  }, {
    key: "desc",
    value: function desc() {
      return this.order === 'desc';
    }
  }]);

  return Sort;
}();

var auto_filter_AutoFilter = /*#__PURE__*/function () {
  function AutoFilter() {
    _classCallCheck(this, AutoFilter);

    this.ref = null;
    this.filters = [];
    this.sort = null;
  }

  _createClass(AutoFilter, [{
    key: "setData",
    value: function setData(_ref) {
      var ref = _ref.ref,
          filters = _ref.filters,
          sort = _ref.sort;

      if (ref != null) {
        this.ref = ref;
        this.filters = filters.map(function (it) {
          return new auto_filter_Filter(it.ci, it.operator, it.value);
        });

        if (sort) {
          this.sort = new auto_filter_Sort(sort.ci, sort.order);
        }
      }
    }
  }, {
    key: "getData",
    value: function getData() {
      if (this.active()) {
        var ref = this.ref,
            filters = this.filters,
            sort = this.sort;
        return {
          ref: ref,
          filters: filters.map(function (it) {
            return it.getData();
          }),
          sort: sort
        };
      }

      return {};
    }
  }, {
    key: "addFilter",
    value: function addFilter(ci, operator, value) {
      var filter = this.getFilter(ci);

      if (filter == null) {
        this.filters.push(new auto_filter_Filter(ci, operator, value));
      } else {
        filter.set(operator, value);
      }
    }
  }, {
    key: "setSort",
    value: function setSort(ci, order) {
      this.sort = order ? new auto_filter_Sort(ci, order) : null;
    }
  }, {
    key: "includes",
    value: function includes(ri, ci) {
      if (this.active()) {
        return this.hrange().includes(ri, ci);
      }

      return false;
    }
  }, {
    key: "getSort",
    value: function getSort(ci) {
      var sort = this.sort;

      if (sort && sort.ci === ci) {
        return sort;
      }

      return null;
    }
  }, {
    key: "getFilter",
    value: function getFilter(ci) {
      var filters = this.filters;

      for (var i = 0; i < filters.length; i += 1) {
        if (filters[i].ci === ci) {
          return filters[i];
        }
      }

      return null;
    }
  }, {
    key: "filteredRows",
    value: function filteredRows(getCell) {
      // const ary = [];
      // let lastri = 0;
      var rset = new Set();
      var fset = new Set();

      if (this.active()) {
        var _this$range = this.range(),
            sri = _this$range.sri,
            eri = _this$range.eri;

        var filters = this.filters;

        for (var ri = sri + 1; ri <= eri; ri += 1) {
          for (var i = 0; i < filters.length; i += 1) {
            var filter = filters[i];
            var cell = getCell(ri, filter.ci);
            var ctext = cell ? cell.text : '';

            if (!filter.includes(ctext)) {
              rset.add(ri);
              break;
            } else {
              fset.add({
                ri: ri,
                text: ctext
              });
            }
          }
        }
      }

      return {
        rset: rset,
        fset: fset
      };
    }
  }, {
    key: "items",
    value: function items(ci, getText) {
      var sri = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : -1;
      var eri = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : -1;
      var m = {};

      if (this.active()) {
        var range = this.range();
        sri === -1 && (sri = range.sri);
        eri === -1 && (eri = range.eri);

        for (var ri = sri + 1; ri <= eri; ri += 1) {
          // debugger;
          var text = getText(ri, ci);

          if (text !== 'undefined' && !/^\s*$/.test(text)) {
            var key = text;
            var cnt = (m[key] || 0) + 1;
            m[key] = cnt;
          } else {
            m[''] = (m[''] || 0) + 1;
          }
        }
      }

      return m;
    }
  }, {
    key: "range",
    value: function range() {
      return cell_range_CellRange.valueOf(this.ref);
    }
  }, {
    key: "hrange",
    value: function hrange() {
      var r = this.range();
      r.eri = r.sri;
      return r;
    }
  }, {
    key: "clear",
    value: function clear() {
      this.ref = null;
      this.filters = [];
      this.sort = null;
    }
  }, {
    key: "active",
    value: function active() {
      return this.ref !== null;
    }
  }]);

  return AutoFilter;
}();


// CONCATENATED MODULE: ./src/sheet/core/merge.js











var merge_Merges = /*#__PURE__*/function () {
  function Merges() {
    var d = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];

    _classCallCheck(this, Merges);

    this._ = d;
  }

  _createClass(Merges, [{
    key: "forEach",
    value: function forEach(cb) {
      this._.forEach(cb);
    }
  }, {
    key: "deleteWithin",
    value: function deleteWithin(cr) {
      this._ = this._.filter(function (it) {
        return !it.within(cr);
      });
    }
  }, {
    key: "getFirstIncludes",
    value: function getFirstIncludes(ri, ci) {
      for (var i = 0; i < this._.length; i += 1) {
        var it = this._[i];

        if (it.includes(ri, ci)) {
          return it;
        }
      }

      return null;
    }
  }, {
    key: "filterIntersects",
    value: function filterIntersects(cellRange) {
      return new Merges(this._.filter(function (it) {
        return it.intersects(cellRange);
      }));
    }
  }, {
    key: "intersects",
    value: function intersects(cellRange) {
      for (var i = 0; i < this._.length; i += 1) {
        var it = this._[i];

        if (it.intersects(cellRange)) {
          // console.log('intersects');
          return true;
        }
      }

      return false;
    }
  }, {
    key: "union",
    value: function union(cellRange) {
      var cr = cellRange;

      this._.forEach(function (it) {
        if (it.intersects(cr)) {
          cr = it.union(cr);
        }
      });

      return cr;
    }
  }, {
    key: "add",
    value: function add(cr) {
      this.deleteWithin(cr);

      this._.push(cr);
    } // type: row | column

  }, {
    key: "shift",
    value: function shift(type, index, n, cbWithin) {
      var _this = this;

      this._.forEach(function (cellRange) {
        var sri = cellRange.sri,
            sci = cellRange.sci,
            eri = cellRange.eri,
            eci = cellRange.eci;
        var range = cellRange;

        if (type === 'row') {
          if (sri >= index) {
            range.sri += n;
            range.eri += n;

            if (range.sri < 0) {
              _this.deleteWithin(range);
            }
          } else if (sri < index && index <= eri) {
            range.eri += n;
            cbWithin(sri, sci, n, 0);
          }
        } else if (type === 'column') {
          if (sci >= index) {
            range.sci += n;
            range.eci += n;

            if (range.sci < 0) {
              _this.deleteWithin(range);
            }
          } else if (sci < index && index <= eci) {
            range.eci += n;
            cbWithin(sri, sci, 0, n);
          }
        }
      });
    }
  }, {
    key: "move",
    value: function move(cellRange, rn, cn) {
      this._.forEach(function (it1) {
        var it = it1;

        if (it.within(cellRange)) {
          it.eri += rn;
          it.sri += rn;
          it.sci += cn;
          it.eci += cn;
        }
      });
    }
  }, {
    key: "setData",
    value: function setData(merges) {
      this._ = merges.map(function (merge) {
        return cell_range_CellRange.valueOf(merge);
      });
      return this;
    }
  }, {
    key: "getData",
    value: function getData() {
      return this._.map(function (merge) {
        return merge.toString();
      });
    }
  }]);

  return Merges;
}();

/* harmony default export */ var core_merge = ({});

// EXTERNAL MODULE: ./node_modules/core-js/modules/es.number.is-nan.js
var es_number_is_nan = __webpack_require__("9129");

// EXTERNAL MODULE: ./node_modules/core-js/modules/es.number.constructor.js
var es_number_constructor = __webpack_require__("a9e3");

// EXTERNAL MODULE: ./node_modules/core-js/modules/es.number.to-fixed.js
var es_number_to_fixed = __webpack_require__("b680");

// EXTERNAL MODULE: ./node_modules/js-md5/src/md5.js
var md5 = __webpack_require__("8237");
var md5_default = /*#__PURE__*/__webpack_require__.n(md5);

// CONCATENATED MODULE: ./src/sheet/core/helper.js













/* eslint-disable no-param-reassign */



function cloneDeep(obj) {
  return JSON.parse(JSON.stringify(obj));
}

var mergeDeep = function mergeDeep() {
  var object = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};

  for (var _len = arguments.length, sources = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
    sources[_key - 1] = arguments[_key];
  }

  sources.forEach(function (source) {
    Object.keys(source).forEach(function (key) {
      var v = source[key]; // console.log('k:', key, ', v:', source[key], typeof v, v instanceof Object);

      if (typeof v === 'string' || typeof v === 'number' || typeof v === 'boolean') {
        object[key] = v;
      } else if (typeof v !== 'function' && !Array.isArray(v) && v instanceof Object) {
        object[key] = object[key] || {};
        mergeDeep(object[key], v);
      } else {
        object[key] = v;
      }
    });
  }); // console.log('::', object);

  return object;
};

function helper_equals(obj1, obj2) {
  var keys = Object.keys(obj1);
  if (keys.length !== Object.keys(obj2).length) return false;

  for (var i = 0; i < keys.length; i += 1) {
    var k = keys[i];
    var v1 = obj1[k];
    var v2 = obj2[k];
    if (v2 === undefined) return false;

    if (typeof v1 === 'string' || typeof v1 === 'number' || typeof v1 === 'boolean') {
      if (v1 !== v2) return false;
    } else if (Array.isArray(v1)) {
      if (v1.length !== v2.length) return false;

      for (var ai = 0; ai < v1.length; ai += 1) {
        if (!helper_equals(v1[ai], v2[ai])) return false;
      }
    } else if (typeof v1 !== 'function' && !Array.isArray(v1) && v1 instanceof Object) {
      if (!helper_equals(v1, v2)) return false;
    }
  }

  return true;
}
/*
  objOrAry: obejct or Array
  cb: (value, index | key) => { return value }
*/


var helper_sum = function sum(objOrAry) {
  var cb = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : function (value) {
    return value;
  };
  var total = 0;
  var size = 0;
  Object.keys(objOrAry).forEach(function (key) {
    total += cb(objOrAry[key], key);
    size += 1;
  });
  return [total, size];
};

function deleteProperty(obj, property) {
  var oldv = obj["".concat(property)];
  delete obj["".concat(property)];
  return oldv;
}

function rangeReduceIf(min, max, inits, initv, ifv, getv) {
  var s = inits;
  var v = initv;
  var i = min;

  for (; i < max; i += 1) {
    if (s > ifv) break;
    v = getv(i);
    s += v;
  }

  return [i, s - v, v];
}

function rangeSum(min, max, getv) {
  var s = 0;

  for (var i = min; i < max; i += 1) {
    s += getv(i);
  }

  return s;
}

function rangeEach(min, max, cb) {
  for (var i = min; i < max; i += 1) {
    cb(i);
  }
}

function arrayEquals(a1, a2) {
  if (a1.length === a2.length) {
    for (var i = 0; i < a1.length; i += 1) {
      if (a1[i] !== a2[i]) return false;
    }
  } else return false;

  return true;
}

function digits(a) {
  var v = "".concat(a);
  var ret = 0;
  var flag = false;

  for (var i = 0; i < v.length; i += 1) {
    if (flag === true) ret += 1;
    if (v.charAt(i) === '.') flag = true;
  }

  return ret;
}

function numberCalc(type, a1, a2) {
  if (Number.isNaN(a1) || Number.isNaN(a2)) {
    return a1 + type + a2;
  }

  var al1 = digits(a1);
  var al2 = digits(a2);
  var num1 = Number(a1);
  var num2 = Number(a2);
  var ret = 0;

  if (type === '-') {
    ret = num1 - num2;
  } else if (type === '+') {
    ret = num1 + num2;
  } else if (type === '*') {
    ret = num1 * num2;
  } else if (type === '/') {
    ret = num1 / num2;
    if (digits(ret) > 5) return ret.toFixed(2);
    return ret;
  }

  return ret.toFixed(Math.max(al1, al2));
}
function swapArray(arr, index1, index2) {
  var l = arr.length;

  if (index1 > -1 && index2 > -1 && index1 < l && index2 < l) {
    var t = arr[index1];
    arr[index1] = arr[index2];
    arr[index2] = t;
    return true;
  } else {
    return false;
  }
} //编码

function nameEncode(s) {
  return 's' + md5_default()(s).substr(8, 16);
}
function regScapeStr(str) {
  if (/[\-\/\\\^\$\*\+\?\.\(\)\|\[\]\{\}]/g.test(str)) {
    str = "'".concat(str, "'");
  }

  return str.replace(/[\-\/\\\^\$\*\+\?\.\(\)\|\[\]\{\}]/g, '\\$&');
}
function rangeToRefs(start, end) {
  var _expr2xy = alphabet_expr2xy(start),
      _expr2xy2 = _slicedToArray(_expr2xy, 2),
      sx = _expr2xy2[0],
      sy = _expr2xy2[1];

  var _expr2xy3 = alphabet_expr2xy(end),
      _expr2xy4 = _slicedToArray(_expr2xy3, 2),
      ex = _expr2xy4[0],
      ey = _expr2xy4[1];

  var arr = [];

  for (var x = sx; x <= ex; x += 1) {
    for (var y = sy; y <= ey; y += 1) {
      arr.push(alphabet_xy2expr(x, y));
    }
  }

  return arr;
}
var isSeparator = /^-?(\d{1,3}(,\d{3})+(\.\d+)?|\.\d+)(e[+-]?\d+)?\s*$/i;
/* harmony default export */ var helper = ({
  cloneDeep: cloneDeep,
  merge: function merge() {
    for (var _len2 = arguments.length, sources = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {
      sources[_key2] = arguments[_key2];
    }

    return mergeDeep.apply(void 0, [{}].concat(sources));
  },
  equals: helper_equals,
  arrayEquals: arrayEquals,
  sum: helper_sum,
  rangeEach: rangeEach,
  rangeSum: rangeSum,
  rangeReduceIf: rangeReduceIf,
  deleteProperty: deleteProperty,
  numberCalc: numberCalc,
  swapArray: swapArray,
  regScapeStr: regScapeStr,
  nameEncode: nameEncode,
  isSeparator: isSeparator
});
// EXTERNAL MODULE: ./node_modules/core-js/modules/es.object.entries.js
var es_object_entries = __webpack_require__("4fad");

// CONCATENATED MODULE: ./src/sheet/core/row.js






















var row_Rows = /*#__PURE__*/function () {
  function Rows(_ref, showIdentifier) {
    var len = _ref.len,
        height = _ref.height,
        indexHeight = _ref.indexHeight,
        minHeight = _ref.minHeight;

    _classCallCheck(this, Rows);

    this._ = {};
    this.len = len; // default row height

    this.height = height;
    this.indexHeight = showIdentifier ? indexHeight : 0;
    this.minHeight = minHeight;
  }

  _createClass(Rows, [{
    key: "getHeight",
    value: function getHeight(ri) {
      if (this.isHide(ri)) return 0;
      var row = this.get(ri);

      if (row && row.height) {
        return row.height;
      }

      return this.height;
    }
  }, {
    key: "setHeight",
    value: function setHeight(ri, v) {
      var row = this.getOrNew(ri);
      row.height = v;
    }
  }, {
    key: "setProperty",
    value: function setProperty(ri, property, v) {
      var row = this.getOrNew(ri);
      row[property] = v;
    }
  }, {
    key: "unhide",
    value: function unhide(idx) {
      var index = idx;

      while (index > 0) {
        index -= 1;

        if (this.isHide(index)) {
          this.setHide(index, false);
        } else break;
      }

      if (this.isLast(idx)) {
        this.setHide(idx, false);
      }
    }
  }, {
    key: "isLast",
    value: function isLast(ri) {
      return this.len === ri + 1 && this.isHide(ri);
    }
  }, {
    key: "isHide",
    value: function isHide(ri) {
      var row = this.get(ri);
      return row && row.hide;
    }
  }, {
    key: "setHide",
    value: function setHide(ri, v) {
      var row = this.getOrNew(ri);
      if (v === true) row.hide = true;else delete row.hide;
    }
  }, {
    key: "setStyle",
    value: function setStyle(ri, style) {
      var row = this.getOrNew(ri);
      row.style = style;
    }
  }, {
    key: "sumHeight",
    value: function sumHeight(min, max, exceptSet) {
      var _this = this;

      return helper.rangeSum(min, max, function (i) {
        if (exceptSet && exceptSet.has(i)) return 0;
        return _this.getHeight(i);
      });
    }
  }, {
    key: "totalHeight",
    value: function totalHeight() {
      return this.sumHeight(0, this.len);
    }
  }, {
    key: "get",
    value: function get(ri) {
      return this._[ri];
    }
  }, {
    key: "getOrNew",
    value: function getOrNew(ri) {
      this._[ri] = this._[ri] || {
        cells: {}
      };
      return this._[ri];
    }
  }, {
    key: "getCell",
    value: function getCell(ri, ci) {
      var row = this.get(ri);

      if (row !== undefined && row.cells !== undefined && row.cells[ci] !== undefined) {
        return row.cells[ci];
      }

      return null;
    }
  }, {
    key: "getCellMerge",
    value: function getCellMerge(ri, ci) {
      var cell = this.getCell(ri, ci);
      if (cell && cell.merge) return cell.merge;
      return [0, 0];
    }
  }, {
    key: "getCellOrNew",
    value: function getCellOrNew(ri, ci) {
      var row = this.getOrNew(ri);
      row.cells[ci] = row.cells[ci] || {};
      return row.cells[ci];
    } // what: all | text | format

  }, {
    key: "setCell",
    value: function setCell(ri, ci, cell) {
      var what = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 'all';
      var forceUpdate = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : false;
      var row = this.getOrNew(ri);
      if (this.getUpdateOpt(row.cells[ci], forceUpdate)) return;

      if (what === 'all') {
        row.cells[ci] = cell;
      } else if (what === 'text') {
        row.cells[ci] = row.cells[ci] || {};
        row.cells[ci].text = cell.text;
      } else if (what === 'format') {
        row.cells[ci] = row.cells[ci] || {};
        row.cells[ci].style = cell.style;
        if (cell.merge) row.cells[ci].merge = cell.merge;
      }
    }
  }, {
    key: "setCellText",
    value: function setCellText(ri, ci, text) {
      var forceUpdate = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;
      var cell = this.getCellOrNew(ri, ci);
      if (this.getUpdateOpt(cell, forceUpdate)) return;
      cell.text = text;
    }
  }, {
    key: "getUpdateOpt",
    value: function getUpdateOpt(cell, forceUpdate) {
      return (cell === null || cell === void 0 ? void 0 : cell.editable) === false && !forceUpdate;
    }
  }, {
    key: "setCellEditable",
    value: function setCellEditable(ri, ci, editable) {
      var cell = this.getCellOrNew(ri, ci);
      cell.editable = editable;
    } // setCellProps(ri, ci, props) {
    //   const cell = this.getCellOrNew(ri, ci);
    //   if (cell.props) {
    //     cell.props = { ...cell.props, ...props };
    //   } else {
    //     cell.props = props;
    //   }
    // }
    // what: all | format | text

  }, {
    key: "copyPaste",
    value: function copyPaste(srcCellRange, dstCellRange, what) {
      var autofill = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;
      var cb = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : function () {};
      var sri = srcCellRange.sri,
          sci = srcCellRange.sci,
          eri = srcCellRange.eri,
          eci = srcCellRange.eci;
      var dsri = dstCellRange.sri;
      var dsci = dstCellRange.sci;
      var deri = dstCellRange.eri;
      var deci = dstCellRange.eci;

      var _srcCellRange$size = srcCellRange.size(),
          _srcCellRange$size2 = _slicedToArray(_srcCellRange$size, 2),
          rn = _srcCellRange$size2[0],
          cn = _srcCellRange$size2[1];

      var _dstCellRange$size = dstCellRange.size(),
          _dstCellRange$size2 = _slicedToArray(_dstCellRange$size, 2),
          drn = _dstCellRange$size2[0],
          dcn = _dstCellRange$size2[1]; // console.log(srcIndexes, dstIndexes);


      var isAdd = true;
      var dn = 0;

      if (deri < sri || deci < sci) {
        isAdd = false;
        if (deri < sri) dn = drn;else dn = dcn;
      }

      for (var i = sri; i <= eri; i += 1) {
        if (this._[i]) {
          for (var j = sci; j <= eci; j += 1) {
            if (this._[i].cells && this._[i].cells[j]) {
              for (var ii = dsri; ii <= deri; ii += rn) {
                for (var jj = dsci; jj <= deci; jj += cn) {
                  var _this$_$i;

                  var nri = ii + (i - sri);
                  var nci = jj + (j - sci);
                  var ncell = helper.cloneDeep(this._[i].cells[j]); // ncell.text

                  if (autofill && ncell && ncell.text && ncell.text.length > 0) {
                    (function () {
                      var text = ncell.text;
                      var n = jj - dsci + (ii - dsri) + 2;

                      if (!isAdd) {
                        n -= dn + 1;
                      }

                      if (text[0] === '=') {
                        ncell.text = text.replace(/[a-zA-Z]{1,3}\d+/g, function (word) {
                          var xn = 0,
                              yn = 0;

                          if (sri === dsri) {
                            xn = n - 1; // if (isAdd) xn -= 1;
                          } else {
                            yn = n - 1;
                          }

                          if (/^\d+$/.test(word)) return word;
                          return expr2expr(word, xn, yn);
                        });
                      } else if (rn <= 1 && cn > 1 && (dsri > eri || deri < sri) || cn <= 1 && rn > 1 && (dsci > eci || deci < sci) || rn <= 1 && cn <= 1) {
                        var result = /[\\.\d]+$/.exec(text); // console.log('result:', result);

                        if (result !== null) {
                          var index = Number(result[0]) + n - 1;
                          ncell.text = text.substring(0, result.index) + index;
                        }
                      }
                    })();
                  }

                  this.setCell(nri, nci, ncell, what);

                  if ((_this$_$i = this._[i]) !== null && _this$_$i !== void 0 && _this$_$i.height) {
                    var _this$_$i2;

                    this.setHeight(nri, (_this$_$i2 = this._[i]) === null || _this$_$i2 === void 0 ? void 0 : _this$_$i2.height);
                  }

                  cb(nri, nci, ncell);
                }
              }
            }
          }
        }
      }
    }
  }, {
    key: "cutPaste",
    value: function cutPaste(srcCellRange, dstCellRange) {
      var _this2 = this;

      var ncellmm = {};
      this.each(function (ri) {
        _this2.eachCells(ri, function (ci) {
          var _ncellmm$nri$cells$nc;

          var nri = parseInt(ri, 10);
          var nci = parseInt(ci, 10);

          if (srcCellRange.includes(ri, ci)) {
            nri = dstCellRange.sri + (nri - srcCellRange.sri);
            nci = dstCellRange.sci + (nci - srcCellRange.sci);
          }

          ncellmm[nri] = ncellmm[nri] || {
            cells: {}
          };
          if (((_ncellmm$nri$cells$nc = ncellmm[nri].cells[nci]) === null || _ncellmm$nri$cells$nc === void 0 ? void 0 : _ncellmm$nri$cells$nc.editable) === false) return;
          ncellmm[nri].cells[nci] = _this2._[ri].cells[ci];
        });
      });
      this._ = ncellmm;
    } // src: Array<Array<String>>

  }, {
    key: "paste",
    value: function paste(src, dstCellRange) {
      var _this3 = this;

      if (src.length <= 0) return;
      var sri = dstCellRange.sri,
          sci = dstCellRange.sci;
      src.forEach(function (row, i) {
        var ri = sri + i;
        row.forEach(function (txt, j) {
          var ci = sci + j;

          _this3.setCellText(ri, ci, _this3.fixValueType(ri, ci, txt));
        });
      });
    }
  }, {
    key: "fixValueType",
    value: function fixValueType(ri, ci, txt) {
      var cell = this.getCellOrNew(ri, ci);

      if ((cell === null || cell === void 0 ? void 0 : cell.format) === 'number') {
        txt = "".concat(txt).replace(/[^-0-9.]/gi, '');
        return txt;
      }

      return txt;
    }
  }, {
    key: "insert",
    value: function insert(sri) {
      var _this4 = this;

      var n = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;
      var ndata = {};
      this.each(function (ri, row) {
        var nri = parseInt(ri, 10);

        if (nri >= sri) {
          nri += n;
        }

        _this4.eachCells(ri, function (ci, cell) {
          if (cell.text && cell.text[0] === '=') {
            cell.text = cell.text.replace(/[a-zA-Z]{1,3}\d+/g, function (word) {
              return expr2expr(word, 0, n, function (x, y) {
                return y >= sri;
              });
            });
          }
        });

        ndata[nri] = row;
      });
      this._ = ndata;
      this.len += n;
    }
  }, {
    key: "delete",
    value: function _delete(sri, eri) {
      var _this5 = this;

      var n = eri - sri + 1;
      var ndata = {};
      this.each(function (ri, row) {
        var nri = parseInt(ri, 10);

        if (nri < sri) {
          ndata[nri] = row;
        } else if (ri > eri) {
          ndata[nri - n] = row;

          _this5.eachCells(ri, function (ci, cell) {
            if (cell.text && cell.text[0] === '=') {
              cell.text = cell.text.replace(/[a-zA-Z]{1,3}\d+/g, function (word) {
                return expr2expr(word, 0, -n, function (x, y) {
                  return y > eri;
                });
              });
            }
          });
        }
      });
      this._ = ndata;
      this.len -= n;
    }
  }, {
    key: "insertColumn",
    value: function insertColumn(sci) {
      var _this6 = this;

      var n = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;
      this.each(function (ri, row) {
        var rndata = {};

        _this6.eachCells(ri, function (ci, cell) {
          var nci = parseInt(ci, 10);

          if (nci >= sci) {
            nci += n;
          }

          if (cell.text && cell.text[0] === '=') {
            cell.text = cell.text.replace(/[a-zA-Z]{1,3}\d+/g, function (word) {
              return expr2expr(word, n, 0, function (x) {
                return x >= sci;
              });
            });
          }

          rndata[nci] = cell;
        });

        row.cells = rndata;
      });
    }
  }, {
    key: "deleteColumn",
    value: function deleteColumn(sci, eci) {
      var _this7 = this;

      var n = eci - sci + 1;
      this.each(function (ri, row) {
        var rndata = {};

        _this7.eachCells(ri, function (ci, cell) {
          var nci = parseInt(ci, 10);

          if (nci < sci) {
            rndata[nci] = cell;
          } else if (nci > eci) {
            rndata[nci - n] = cell;

            if (cell.text && cell.text[0] === '=') {
              cell.text = cell.text.replace(/[a-zA-Z]{1,3}\d+/g, function (word) {
                return expr2expr(word, -n, 0, function (x) {
                  return x > eci;
                });
              });
            }
          }
        });

        row.cells = rndata;
      });
    } // what: all | text | format | merge

  }, {
    key: "deleteCells",
    value: function deleteCells(cellRange) {
      var _this8 = this;

      var what = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'all';
      cellRange.each(function (i, j) {
        _this8.deleteCell(i, j, what);
      });
    } // what: all | text | format | merge

  }, {
    key: "deleteCell",
    value: function deleteCell(ri, ci) {
      var what = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 'all';
      var row = this.get(ri);

      if (row !== null) {
        var cell = this.getCell(ri, ci);

        if (cell !== null && cell.editable !== false) {
          if (what === 'all') {
            delete row.cells[ci];
          } else if (what === 'text') {
            if (cell.text) delete cell.text;
            if (cell.value) delete cell.value;
          } else if (what === 'format') {
            if (cell.style !== undefined) delete cell.style;
            if (cell.merge) delete cell.merge;
          } else if (what === 'merge') {
            if (cell.merge) delete cell.merge;
          } else if (what === 'onlyText') {
            var text = cell.text;
            row.cells[ci] = {
              text: text
            };
          }
        }
      }
    }
  }, {
    key: "maxCell",
    value: function maxCell() {
      var keys = Object.keys(this._);
      var ri = keys[keys.length - 1];
      var col = this._[ri];

      if (col) {
        var cells = col.cells;
        var ks = Object.keys(cells);
        var ci = ks[ks.length - 1];
        return [parseInt(ri, 10), parseInt(ci, 10)];
      }

      return [0, 0];
    }
  }, {
    key: "each",
    value: function each(cb) {
      Object.entries(this._).forEach(function (_ref2) {
        var _ref3 = _slicedToArray(_ref2, 2),
            ri = _ref3[0],
            row = _ref3[1];

        cb(ri, row);
      });
    }
  }, {
    key: "eachCells",
    value: function eachCells(ri, cb) {
      if (this._[ri] && this._[ri].cells) {
        Object.entries(this._[ri].cells).forEach(function (_ref4) {
          var _ref5 = _slicedToArray(_ref4, 2),
              ci = _ref5[0],
              cell = _ref5[1];

          cb(ci, cell);
        });
      }
    }
  }, {
    key: "setData",
    value: function setData(d) {
      if (d.len) {
        this.len = d.len;
        delete d.len;
      }

      this._ = d;
    }
  }, {
    key: "getData",
    value: function getData() {
      var len = this.len;
      return Object.assign({
        len: len
      }, this._);
    }
  }, {
    key: "lookUp",
    value: function lookUp(_lookUp, getIdentifierParseValue) {
      var _this9 = this;

      if (!_lookUp) return;
      var lookUps = new Set();
      this.each(function (ri) {
        _this9.eachCells(ri, function (ci, cell) {
          var text = cell.text || '';
          var formatText = '';

          if (text && text[0] === '=') {
            formatText = "".concat(getIdentifierParseValue(text));
          }

          if (text.includes(_lookUp) || formatText.includes(_lookUp)) {
            lookUps.add("".concat(ri, "_").concat(ci));
          }
        });
      });
      return lookUps;
    }
  }]);

  return Rows;
}();

/* harmony default export */ var core_row = ({});

// CONCATENATED MODULE: ./src/sheet/core/col.js









var col_Cols = /*#__PURE__*/function () {
  function Cols(_ref, showIdentifier) {
    var len = _ref.len,
        width = _ref.width,
        indexWidth = _ref.indexWidth,
        minWidth = _ref.minWidth;

    _classCallCheck(this, Cols);

    this._ = {};
    this.len = len;
    this.width = width;
    this.indexWidth = showIdentifier ? indexWidth : 0;
    this.minWidth = minWidth;
  }

  _createClass(Cols, [{
    key: "setData",
    value: function setData(d) {
      if (d.len) {
        this.len = d.len;
        delete d.len;
      }

      this._ = d;
    }
  }, {
    key: "get",
    value: function get(ci) {
      return this._[ci];
    }
  }, {
    key: "getData",
    value: function getData() {
      var len = this.len;
      return Object.assign({
        len: len
      }, this._);
    }
  }, {
    key: "getWidth",
    value: function getWidth(i) {
      if (this.isHide(i)) return 0;
      var col = this._[i];

      if (col && col.width) {
        return col.width;
      }

      return this.width;
    }
  }, {
    key: "getOrNew",
    value: function getOrNew(ci) {
      this._[ci] = this._[ci] || {};
      return this._[ci];
    }
  }, {
    key: "setWidth",
    value: function setWidth(ci, width) {
      var col = this.getOrNew(ci);
      col.width = width;
    }
  }, {
    key: "setProperty",
    value: function setProperty(ci, property, v) {
      var col = this.getOrNew(ci);
      col[property] = v;
    }
  }, {
    key: "unhide",
    value: function unhide(idx) {
      var index = idx;

      while (index > 0) {
        index -= 1;

        if (this.isHide(index)) {
          this.setHide(index, false);
        } else break;
      }

      if (this.isLast(idx)) {
        this.setHide(idx, false);
      }
    }
  }, {
    key: "isLast",
    value: function isLast(ci) {
      return this.len === ci + 1 && this.isHide(ci);
    }
  }, {
    key: "isHide",
    value: function isHide(ci) {
      var col = this._[ci];
      return col && col.hide;
    }
  }, {
    key: "setHide",
    value: function setHide(ci, v) {
      var col = this.getOrNew(ci);
      if (v === true) col.hide = true;else delete col.hide;
    }
  }, {
    key: "setStyle",
    value: function setStyle(ci, style) {
      var col = this.getOrNew(ci);
      col.style = style;
    }
  }, {
    key: "sumWidth",
    value: function sumWidth(min, max) {
      var _this = this;

      return helper.rangeSum(min, max, function (i) {
        return _this.getWidth(i);
      });
    }
  }, {
    key: "totalWidth",
    value: function totalWidth() {
      return this.sumWidth(0, this.len);
    }
  }, {
    key: "update",
    value: function update(sci, n) {
      var cols = {};

      if (n < 0) {
        for (var index = n; index < 0; index++) {
          var ci = sci - index - 1;
          delete this._[ci];
        }
      }

      for (var _ci in this._) {
        var col = this._[_ci];

        if (_ci >= sci) {
          cols[n + parseInt(_ci)] = col;
        } else {
          cols[_ci] = col;
        }
      }

      this.setData(cols);
    }
  }, {
    key: "each",
    value: function each(cb) {
      Object.entries(this._).forEach(function (_ref2) {
        var _ref3 = _slicedToArray(_ref2, 2),
            ci = _ref3[0],
            col = _ref3[1];

        cb(ci, col);
      });
    }
  }]);

  return Cols;
}();

/* harmony default export */ var core_col = ({});

// CONCATENATED MODULE: ./src/sheet/locale/zh-cn.js
/* harmony default export */ var zh_cn = ({
  toolbar: {
    undo: '撤销',
    redo: '恢复',
    preview: '预览',
    save: '保存',
    print: '打印',
    paintformat: '格式刷',
    clearformat: '清除格式',
    format: '数据格式',
    fontName: '字体',
    fontSize: '字号',
    fontBold: '加粗',
    fontItalic: '倾斜',
    underline: '下划线',
    strike: '删除线',
    color: '字体颜色',
    bgcolor: '填充颜色',
    border: '边框',
    merge: '合并单元格',
    align: '水平对齐',
    valign: '垂直对齐',
    textwrap: '自动换行',
    freeze: '冻结',
    autofilter: '自动筛选',
    formula: '函数',
    import: '导入',
    export: '导出',
    lookUp: '查找',
    slash: '交叉斜线',
    indentDec: '减少缩进',
    indentAdd: '增加缩进',
    more: '更多'
  },
  contextmenu: {
    copy: '复制',
    cut: '剪切',
    paste: '粘贴',
    pasteValue: '粘贴数据',
    pasteFormat: '粘贴格式',
    editFormat: '设置格式',
    hide: '隐藏',
    insertComment: '插批注',
    editComment: '编辑批注',
    delComment: '删除批注',
    insertRow: '插入行',
    insertColumn: '插入列',
    deleteSheet: '删除',
    copySheet: '复制',
    renameSheet: '重命名',
    colorSheet: '标签颜色',
    hideSheet: '隐藏',
    showSheet: '取消隐藏',
    leftMoveSheet: '向左移',
    rightMoveSheet: '向右移',
    deleteRow: '删除行',
    deleteColumn: '删除列',
    deleteCell: '删除',
    deleteCellText: '删除数据',
    validation: '数据验证',
    cellprintable: '可打印',
    cellnonprintable: '不可打印',
    celleditable: '可编辑',
    cellnoneditable: '不可编辑',
    setWidth: '设置列宽',
    setHeight: '设置行高'
  },
  print: {
    size: '纸张大小',
    orientation: '方向',
    orientations: ['横向', '纵向']
  },
  format: {
    normal: '常规',
    text: '文本',
    number: '数值',
    percent: '百分比',
    rmb: '人民币',
    usd: '美元',
    eur: '欧元',
    time: '时间',
    date: '短日期',
    datelong: '长日期',
    datetime: '日期+时间',
    duration: '持续时间',
    transparent: '隐藏'
  },
  formula: {
    sum: '求和',
    average: '求平均值',
    max: '求最大值',
    min: '求最小值',
    concat: '字符拼接',
    _if: '条件判断',
    and: '和',
    or: '或'
  },
  validation: {
    required: '此值必填',
    notMatch: '此值不匹配验证规则',
    between: '此值应在 {} 和 {} 之间',
    notBetween: '此值不应在 {} 和 {} 之间',
    notIn: '此值不在列表中',
    equal: '此值应该等于 {}',
    notEqual: '此值不应该等于 {}',
    lessThan: '此值应该小于 {}',
    lessThanEqual: '此值应该小于等于 {}',
    greaterThan: '此值应该大于 {}',
    greaterThanEqual: '此值应该大于等于 {}'
  },
  error: {
    pasteForMergedCell: '无法对合并的单元格执行此操作'
  },
  calendar: {
    weeks: ['日', '一', '二', '三', '四', '五', '六'],
    months: ['一月', '二月', '三月', '四月', '五月', '六月', '七月', '八月', '九月', '十月', '十一月', '十二月']
  },
  button: {
    next: '下一步',
    cancel: '取消',
    remove: '删除',
    save: '保存',
    ok: '确认'
  },
  sort: {
    desc: '降序',
    asc: '升序'
  },
  filter: {
    empty: '空白'
  },
  dataValidation: {
    mode: '模式',
    range: '单元区间',
    criteria: '条件',
    modeType: {
      cell: '单元格',
      column: '列模式',
      row: '行模式'
    },
    type: {
      list: '列表',
      number: '数字',
      date: '日期',
      phone: '手机号',
      email: '电子邮件'
    },
    operator: {
      be: '在区间',
      nbe: '不在区间',
      lt: '小于',
      lte: '小于等于',
      gt: '大于',
      gte: '大于等于',
      eq: '等于',
      neq: '不等于'
    }
  },
  borders: {
    none: '无',
    all: '所有',
    inside: '内侧',
    horizontal: '内侧横线',
    vertical: '内侧竖线',
    outside: '外侧',
    left: '左框线',
    top: '上框线',
    right: '右框线',
    bottom: '下框线',
    lineType: '边框样式',
    lineColor: '边框颜色'
  },
  valigns: {
    top: '顶端对齐',
    middle: '垂直居中',
    bottom: '底部对齐'
  },
  aligns: {
    left: '左对齐',
    center: '水平居中',
    right: '右对齐',
    dist: '分散对齐'
  },
  slashs: {
    slash0: '清除',
    slash1: '1 条',
    slash2: '2 条',
    slash3: '3 条'
  }
});
// CONCATENATED MODULE: ./src/sheet/locale/locale.js



 // Defines the fallback language as English

var $languages = ['cn'];
var $messages = {
  cn: zh_cn
};

function translate(key, messages) {
  if (messages) {
    // Return the translation from the first language in the languages array
    // that has a value for the provided key.
    var _iterator = _createForOfIteratorHelper($languages),
        _step;

    try {
      for (_iterator.s(); !(_step = _iterator.n()).done;) {
        var lang = _step.value;
        if (!messages[lang]) break;
        var message = messages[lang]; // Splits the key at '.' except where escaped as '\.'

        var keys = key.match(/(?:\\.|[^.])+/g);

        for (var i = 0; i < keys.length; i += 1) {
          var property = keys[i];
          var value = message[property]; // If value doesn't exist, try next language

          if (!value) break;
          if (i === keys.length - 1) return value; // Move down to the next level of the messages object

          message = value;
        }
      }
    } catch (err) {
      _iterator.e(err);
    } finally {
      _iterator.f();
    }
  }

  return undefined;
}

function locale_t(key) {
  var v = translate(key, $messages);

  if (!v && window && window.x_spreadsheet && window.x_spreadsheet.$messages) {
    v = translate(key, window.x_spreadsheet.$messages);
  }

  return v || '';
}

function tf(key) {
  return function () {
    return locale_t(key);
  };
} // If clearLangList is set to false, lang will be added to the front of the
// languages array. The languages in the language array are searched in order
// to find a translation. This allows the use of other languages as a fallback
// if lang is missing some keys. The language array is preloaded with English.
// To set the languages array to only include lang, set clearLangList to true.


function locale_locale(lang, message) {
  var clearLangList = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;

  if (clearLangList) {
    $languages = [lang];
  } else {
    // Append to front of array.
    // Translation method will use the first language in the list that has a
    // matching key.
    $languages.unshift(lang);
  }

  if (message) {
    $messages[lang] = message;
  }
}

/* harmony default export */ var sheet_locale_locale = ({
  t: locale_t
});

// CONCATENATED MODULE: ./src/sheet/core/validator.js

















var rules = {
  phone: /^[1-9]\d{10}$/,
  email: /w+([-+.]w+)*@w+([-.]w+)*.w+([-.]w+)*/
};

function returnMessage(flag, key) {
  var message = null;

  if (!flag) {
    for (var _len = arguments.length, arg = new Array(_len > 2 ? _len - 2 : 0), _key = 2; _key < _len; _key++) {
      arg[_key - 2] = arguments[_key];
    }

    message = locale_t.apply(void 0, ["validation.".concat(key)].concat(arg));

    for (var _i = 0, _arg = arg; _i < _arg.length; _i++) {
      var iterator = _arg[_i];
      message = message.replace(/{}/, iterator);
    }
  }

  return [flag, message];
}

var validator_Validator = /*#__PURE__*/function () {
  // operator: b|nb|eq|neq|lt|lte|gt|gte
  // type: date|number|list|phone|email
  function Validator(type, required, value, operator, tips) {
    _classCallCheck(this, Validator);

    this.required = required;
    this.value = value;
    this.type = type;
    this.operator = operator;
    this.message = '';
    this.tips = tips;
  }

  _createClass(Validator, [{
    key: "parseValue",
    value: function parseValue(v) {
      var type = this.type;

      if (type === 'date') {
        return new Date(v);
      }

      if (type === 'number') {
        return Number(v);
      }

      return v;
    }
  }, {
    key: "equals",
    value: function equals(other) {
      var flag = this.type === other.type && this.required === other.required && this.operator === other.operator && this.tips === other.tips;

      if (flag) {
        if (Array.isArray(this.value)) {
          flag = helper.arrayEquals(this.value, other.value);
        } else {
          flag = this.value === other.value;
        }
      }

      return flag;
    }
  }, {
    key: "values",
    value: function values() {
      return this.value.split(',');
    }
  }, {
    key: "validate",
    value: function validate(v, getIdentifierParseValue) {
      var required = this.required,
          operator = this.operator,
          value = this.value,
          type = this.type;

      if (required && /^\s*$/.test(v)) {
        return returnMessage(false, 'required');
      }

      if (/^\s*$/.test(v)) return [true];

      if (rules[type] && !rules[type].test(v)) {
        return returnMessage(false, 'notMatch');
      }

      if (type === 'list') {
        return returnMessage(this.values(getIdentifierParseValue).includes(getIdentifierParseValue(v).toString()), 'notIn');
      }

      if (operator) {
        var v1 = this.parseValue(v);

        if (operator === 'be') {
          var _value = value,
              _value2 = _slicedToArray(_value, 2),
              min = _value2[0],
              max = _value2[1];

          min = getIdentifierParseValue(min);
          max = getIdentifierParseValue(max);
          return returnMessage(v1 >= this.parseValue(min) && v1 <= this.parseValue(max), 'between', min, max);
        }

        if (operator === 'nbe') {
          var _value3 = value,
              _value4 = _slicedToArray(_value3, 2),
              _min = _value4[0],
              _max = _value4[1];

          _min = getIdentifierParseValue(_min);
          _max = getIdentifierParseValue(_max);
          return returnMessage(v1 < this.parseValue(_min) || v1 > this.parseValue(_max), 'notBetween', _min, _max);
        }

        value = getIdentifierParseValue(value);

        if (operator === 'eq') {
          return returnMessage(v1 === this.parseValue(value), 'equal', value);
        }

        if (operator === 'neq') {
          return returnMessage(v1 !== this.parseValue(value), 'notEqual', value);
        }

        if (operator === 'lt') {
          return returnMessage(v1 < this.parseValue(value), 'lessThan', value);
        }

        if (operator === 'lte') {
          return returnMessage(v1 <= this.parseValue(value), 'lessThanEqual', value);
        }

        if (operator === 'gt') {
          return returnMessage(v1 > this.parseValue(value), 'greaterThan', value);
        }

        if (operator === 'gte') {
          return returnMessage(v1 >= this.parseValue(value), 'greaterThanEqual', value);
        }
      }

      return [true];
    }
  }]);

  return Validator;
}();


// CONCATENATED MODULE: ./src/sheet/core/validation.js


















var validation_Validation = /*#__PURE__*/function () {
  function Validation(mode, refs, validator) {
    _classCallCheck(this, Validation);

    this.refs = refs;
    this.mode = mode; // cell

    this.validator = validator;
  }

  _createClass(Validation, [{
    key: "includes",
    value: function includes(ri, ci) {
      var refs = this.refs;

      for (var i = 0; i < refs.length; i += 1) {
        var cr = cell_range_CellRange.valueOf(refs[i]);
        if (cr.includes(ri, ci)) return true;
      }

      return false;
    }
  }, {
    key: "addRef",
    value: function addRef(ref) {
      this.remove(cell_range_CellRange.valueOf(ref));
      this.refs.push(ref);
    }
  }, {
    key: "remove",
    value: function remove(cellRange) {
      var nrefs = [];
      this.refs.forEach(function (it) {
        var cr = cell_range_CellRange.valueOf(it);

        if (cr.intersects(cellRange)) {
          var crs = cr.difference(cellRange);
          var max = crs.length;

          if (crs.length >= 4) {
            max = crs.length / 2;
          }

          crs.forEach(function (it1, index) {
            if (index < max) {
              nrefs.push(it1.toString());
            }
          });
        } else {
          nrefs.push(it);
        }
      });
      this.refs = nrefs;
    }
  }, {
    key: "getData",
    value: function getData() {
      var refs = this.refs,
          mode = this.mode,
          validator = this.validator;
      var type = validator.type,
          required = validator.required,
          operator = validator.operator,
          value = validator.value,
          tips = validator.tips;
      return {
        refs: refs,
        mode: mode,
        type: type,
        required: required,
        operator: operator,
        value: value,
        tips: tips
      };
    }
  }], [{
    key: "valueOf",
    value: function valueOf(_ref) {
      var refs = _ref.refs,
          mode = _ref.mode,
          type = _ref.type,
          required = _ref.required,
          operator = _ref.operator,
          value = _ref.value,
          tips = _ref.tips;
      return new Validation(mode, refs, new validator_Validator(type, required, value, operator, tips));
    }
  }]);

  return Validation;
}();

var validation_Validations = /*#__PURE__*/function () {
  function Validations(getCellParseValue, getIdentifierParseValue) {
    _classCallCheck(this, Validations);

    this._ = []; // ri_ci: errMessage

    this.errors = new Map();
    this.getCellParseValue = getCellParseValue;
    this.getIdentifierParseValue = getIdentifierParseValue;
  }

  _createClass(Validations, [{
    key: "getError",
    value: function getError(ri, ci) {
      return this.errors.get("".concat(ri, "_").concat(ci));
    }
  }, {
    key: "validate",
    value: function validate(ri, ci, text) {
      var v = this.get(ri, ci);
      var key = "".concat(ri, "_").concat(ci);
      var errors = this.errors;

      if (v !== null) {
        text = this.getCellParseValue(ri, ci);

        var _v$validator$validate = v.validator.validate(text, this.getIdentifierParseValue),
            _v$validator$validate2 = _slicedToArray(_v$validator$validate, 2),
            flag = _v$validator$validate2[0],
            message = _v$validator$validate2[1];

        v.validator.message = message;

        if (!flag) {
          errors.set(key, message);
        } else {
          errors.delete(key);
        }
      } else {
        errors.delete(key);
      }

      return true;
    } // type: date|number|phone|email|list
    // validator: { required, value, operator }

  }, {
    key: "add",
    value: function add(mode, ref, _ref2) {
      var type = _ref2.type,
          required = _ref2.required,
          value = _ref2.value,
          operator = _ref2.operator,
          tips = _ref2.tips;
      var validator = new validator_Validator(type, required, value, operator, tips);
      var v = this.getByValidator(validator);

      if (v !== null) {
        v.addRef(ref);
      } else {
        this._.push(new validation_Validation(mode, [ref], validator));
      }
    }
  }, {
    key: "getByValidator",
    value: function getByValidator(validator) {
      for (var i = 0; i < this._.length; i += 1) {
        var v = this._[i];

        if (v.validator.equals(validator)) {
          return v;
        }
      }

      return null;
    }
  }, {
    key: "get",
    value: function get(ri, ci) {
      for (var i = 0; i < this._.length; i += 1) {
        var v = this._[i];
        if (v.includes(ri, ci)) return v;
      }

      return null;
    }
  }, {
    key: "remove",
    value: function remove(cellRange) {
      this.each(function (it) {
        it.remove(cellRange);
      });
    }
  }, {
    key: "each",
    value: function each(cb) {
      this._.forEach(function (it) {
        return cb(it);
      });
    }
  }, {
    key: "getData",
    value: function getData() {
      return this._.filter(function (it) {
        return it.refs.length > 0;
      }).map(function (it) {
        return it.getData();
      });
    }
  }, {
    key: "setData",
    value: function setData(d) {
      this._ = d.map(function (it) {
        return validation_Validation.valueOf(it);
      });
    }
  }]);

  return Validations;
}();

/* harmony default export */ var core_validation = ({});

// EXTERNAL MODULE: ./node_modules/core-js/modules/es.array.find.js
var es_array_find = __webpack_require__("7db0");

// CONCATENATED MODULE: ./src/sheet/core/examine.js






























var examine_Examiner = /*#__PURE__*/function () {
  function Examiner(type, ruler, message, tips) {
    _classCallCheck(this, Examiner);

    this.ruler = ruler;
    this.type = type;
    this.message = message;
    this.tips = tips;
  }

  _createClass(Examiner, [{
    key: "equals",
    value: function equals() {
      return false;
    } // 校验

  }, {
    key: "validate",
    value: function validate(getIdentifierExamine) {
      var ref = this.ref,
          ruler = this.ruler,
          message = this.message;
      return [getIdentifierExamine("=".concat(ruler)), message, ruler, ref];
    }
  }]);

  return Examiner;
}();

var examine_Examine = /*#__PURE__*/function () {
  function Examine(mode, ref, examiner) {
    _classCallCheck(this, Examine);

    this.ref = ref;
    this.mode = mode; // fixed

    this.examiner = examiner;
  }

  _createClass(Examine, [{
    key: "getData",
    value: function getData() {
      var ref = this.ref,
          mode = this.mode,
          examiner = this.examiner;
      var type = examiner.type,
          ruler = examiner.ruler,
          message = examiner.message,
          tips = examiner.tips;
      return {
        ref: ref,
        mode: mode,
        type: type,
        ruler: ruler,
        message: message,
        tips: tips
      };
    }
  }], [{
    key: "valueOf",
    value: function valueOf(_ref) {
      var ref = _ref.ref,
          mode = _ref.mode,
          type = _ref.type,
          ruler = _ref.ruler,
          message = _ref.message,
          tips = _ref.tips;
      return new Examine(mode, ref, new examine_Examiner(type, ruler, message, tips));
    }
  }]);

  return Examine;
}();

var examine_Examines = /*#__PURE__*/function () {
  function Examines(getIdentifierExamine) {
    _classCallCheck(this, Examines);

    this._ = [];
    this.errors = new Map();
    this.errorRefs = new Set();
    this.warnRefs = new Set();
    this.getIdentifierExamine = getIdentifierExamine;
    this.occupyConfig = null;
  } // 新增


  _createClass(Examines, [{
    key: "add",
    value: function add(mode, ref, _ref2) {
      var type = _ref2.type,
          ruler = _ref2.ruler,
          message = _ref2.message,
          tips = _ref2.tips;
      var examiner = new examine_Examiner(type, ruler, message, tips);
      var v = this.getByExaminer(examiner);

      if (v == null) {
        this._.push(new examine_Examine(mode, ref, examiner));
      }

      return v == null;
    }
  }, {
    key: "fixInsertRow",
    value: function fixInsertRow(config, text, sri) {
      var _this = this;

      var n = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 1;
      var sheetListName = this.occupyConfig || this.getRegSheetListName(config);
      text = text.replace(sheetListName.reg, function (word, sheet, exp) {
        if (sheet) {
          return _this.handleOccupyCross(sheetListName, sheet, exp);
        } else {
          for (var _len = arguments.length, other = new Array(_len > 3 ? _len - 3 : 0), _key = 3; _key < _len; _key++) {
            other[_key - 3] = arguments[_key];
          }

          if (_this.getCross(other)) return word;
          return word.replace(/[A-Z]{1,3}\d+/g, function (exp) {
            return expr2expr(exp, 0, n, function (x, y) {
              return y >= sri;
            });
          });
        }
      });
      return text;
    }
  }, {
    key: "fixInsertCol",
    value: function fixInsertCol(config, text, sci) {
      var _this2 = this;

      var n = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 1;
      var sheetListName = this.occupyConfig || this.getRegSheetListName(config);
      text = text.replace(sheetListName.reg, function (word, sheet, exp) {
        if (sheet) {
          return _this2.handleOccupyCross(sheetListName, sheet, exp);
        } else {
          for (var _len2 = arguments.length, other = new Array(_len2 > 3 ? _len2 - 3 : 0), _key2 = 3; _key2 < _len2; _key2++) {
            other[_key2 - 3] = arguments[_key2];
          }

          if (_this2.getCross(other)) return word;
          return word.replace(/[A-Z]{1,3}\d+/g, function (exp) {
            return expr2expr(exp, n, 0, function (x) {
              return x >= sci;
            });
          });
        }
      });
      return text;
    }
  }, {
    key: "getEndRowCol",
    value: function getEndRowCol(s, n) {
      return s + n - 1;
    }
  }, {
    key: "fixDeleteRow",
    value: function fixDeleteRow(config, text, sri) {
      var _this3 = this;

      var n = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 1;
      var eri = this.getEndRowCol(sri, n);
      var sheetListName = this.occupyConfig || this.getRegSheetListName(config);
      text = text.replace(sheetListName.reg, function (word, sheet, exp) {
        if (sheet) {
          return _this3.handleOccupyCross(sheetListName, sheet, exp);
        } else {
          for (var _len3 = arguments.length, other = new Array(_len3 > 3 ? _len3 - 3 : 0), _key3 = 3; _key3 < _len3; _key3++) {
            other[_key3 - 3] = arguments[_key3];
          }

          if (_this3.getCross(other)) return word;
          return word.replace(/[A-Z]{1,3}\d+/g, function (exp) {
            return expr2expr(exp, 0, -n, function (x, y) {
              return y > eri;
            });
          });
        }
      });
      return text;
    }
  }, {
    key: "fixDeleteCol",
    value: function fixDeleteCol(config, text, sci) {
      var _this4 = this;

      var n = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 1;
      var eci = this.getEndRowCol(sci, n);
      var sheetListName = this.occupyConfig || this.getRegSheetListName(config);
      text = text.replace(sheetListName.reg, function (word, sheet, exp) {
        if (sheet) {
          return _this4.handleOccupyCross(sheetListName, sheet, exp);
        } else {
          for (var _len4 = arguments.length, other = new Array(_len4 > 3 ? _len4 - 3 : 0), _key4 = 3; _key4 < _len4; _key4++) {
            other[_key4 - 3] = arguments[_key4];
          }

          if (_this4.getCross(other)) return word;
          return word.replace(/[A-Z]{1,3}\d+/g, function (exp) {
            return expr2expr(exp, -n, 0, function (x) {
              return x > eci;
            });
          });
        }
      });
      return text;
    }
  }, {
    key: "handleOccupyCross",
    value: function handleOccupyCross(sheetListName, sheet, exp) {
      var _this5 = this;

      var _sheetListName$config = sheetListName.configChange[sheet],
          offsetNum = _sheetListName$config.offsetNum,
          basicPosNum = _sheetListName$config.basicPosNum,
          type = _sheetListName$config.type;

      if (type == 'fixDeleteCol') {
        return sheet + '!' + exp.replace(/[A-Z]{1,3}\d+/g, function (exp) {
          return expr2expr(exp, -offsetNum, 0, function (x) {
            return x > _this5.getEndRowCol(basicPosNum, offsetNum);
          });
        });
      }

      if (type == 'fixDeleteRow') {
        return sheet + '!' + exp.replace(/[A-Z]{1,3}\d+/g, function (exp) {
          var _sheetListName$config2 = sheetListName.configChange[sheet],
              offsetNum = _sheetListName$config2.offsetNum,
              basicPosNum = _sheetListName$config2.basicPosNum;
          return expr2expr(exp, 0, -offsetNum, function (x, y) {
            return y > _this5.getEndRowCol(basicPosNum, offsetNum);
          });
        });
      }

      if (type == 'fixInsertCol') {
        return sheet + '!' + exp.replace(/[A-Z]{1,3}\d+/g, function (exp) {
          var _sheetListName$config3 = sheetListName.configChange[sheet],
              offsetNum = _sheetListName$config3.offsetNum,
              basicPosNum = _sheetListName$config3.basicPosNum;
          return expr2expr(exp, offsetNum, 0, function (x) {
            return x >= basicPosNum;
          });
        });
      }

      if (type == 'fixInsertRow') {
        return sheet + '!' + exp.replace(/[A-Z]{1,3}\d+/g, function (exp) {
          var _sheetListName$config4 = sheetListName.configChange[sheet],
              offsetNum = _sheetListName$config4.offsetNum,
              basicPosNum = _sheetListName$config4.basicPosNum;
          return expr2expr(exp, 0, offsetNum, function (x, y) {
            return y >= basicPosNum;
          });
        });
      }
    }
  }, {
    key: "getRegSheetListName",
    value: function getRegSheetListName(config) {
      var sheetListName = [];
      var configChange = {};

      for (var item in config) {
        var key = item;

        if (/([A-Z]+[0-9]+)/g.test(item)) {
          key = "'".concat(item, "'");
        } else {
          key = regScapeStr(item);
        }

        sheetListName.push(key);
        configChange[key.replace(/\\(.)/g, '$1')] = config[item];
      }

      return {
        reg: new RegExp("(".concat(sheetListName.join('|'), ")+!([A-Z]+[0-9]+)|([A-Z]+[0-9]+)|(?:'((\\[(.+?)\\])([\\u4e00-\\u9fa5a-zA-Z0-9\u3010\u3011\uFF08\uFF09<>_]+)?\\'\\!)([A-Z]+[0-9]+))"), 'g'),
        configChange: configChange
      };
    }
  }, {
    key: "getCross",
    value: function getCross(other) {
      var len = other.length - 1;
      if (!other[0]) return true;
      return other[len][other[len - 1] - 1] === '!';
    }
  }, {
    key: "setSheetsConfig",
    value: function setSheetsConfig(config) {
      this.occupyConfig = this.getRegSheetListName(config);
    } // 删除

  }, {
    key: "remove",
    value: function remove(removeRef) {
      var examines = [];
      this.each(function (it) {
        var ref = it.ref;

        if (ref !== removeRef) {
          examines.push(it);
        }
      });
      this._ = examines;
    } // 清除

  }, {
    key: "clear",
    value: function clear() {
      this._ = [];
    }
  }, {
    key: "getErrorRef",
    value: function getErrorRef(expr) {
      return this.errorRefs.has(expr);
    }
  }, {
    key: "getWarnRef",
    value: function getWarnRef(expr) {
      return this.warnRefs.has(expr);
    }
  }, {
    key: "clearError",
    value: function clearError() {
      this.errors = new Map();
      this.errorRefs = new Set();
      this.warnRefs = new Set();
    }
  }, {
    key: "getByExaminer",
    value: function getByExaminer(examiner) {
      for (var i = 0; i < this._.length; i += 1) {
        var v = this._[i];

        if (v.examiner.equals(examiner)) {
          return v;
        }
      }

      return null;
    }
  }, {
    key: "setErrorPass",
    value: function setErrorPass(ref, isPass) {
      var examine = this.getRefError(ref);

      if (examine) {
        examine.isPass = isPass;
        return true;
      }

      return false;
    }
  }, {
    key: "getModeNum",
    value: function getModeNum() {
      var mode = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'error';
      var num = 0;
      this.errors.forEach(function (i) {
        if (i.mode == mode && !i.isPass) {
          num++;
        }
      });
      return num;
    }
  }, {
    key: "get",
    value: function get(outRef) {
      return this._.find(function (_ref3) {
        var ref = _ref3.ref;
        return ref == outRef;
      });
    }
  }, {
    key: "getRefError",
    value: function getRefError(outRef) {
      return this.errors.get(outRef);
    } // 获取错误

  }, {
    key: "getError",
    value: function getError() {
      return this.errors;
    }
  }, {
    key: "toSuffixExpr",
    value: function toSuffixExpr(src, sheetList, mode, cb) {
      var _this6 = this;

      var stack = new Set();
      src = src.replace(/([A-Z]+[0-9]+):([A-Z]+[0-9]+)/g, function (a, b, c) {
        var _expr2xy = alphabet_expr2xy(b),
            _expr2xy2 = _slicedToArray(_expr2xy, 2),
            sx = _expr2xy2[0],
            sy = _expr2xy2[1];

        var _expr2xy3 = alphabet_expr2xy(c),
            _expr2xy4 = _slicedToArray(_expr2xy3, 2),
            ex = _expr2xy4[0],
            ey = _expr2xy4[1];

        var arr = [];

        for (var x = sx; x <= ex; x += 1) {
          for (var y = sy; y <= ey; y += 1) {
            arr.push(alphabet_xy2expr(x, y));
          }
        }

        return arr.join(',');
      });
      src.replace(sheetList.regNames, function (exp) {
        if (exp.includes('!')) {
          cb(exp, mode);
        } else {
          _this6.setErrorRefs(exp, mode);

          stack.add(exp);
        }
      });
      return _toConsumableArray(stack);
    }
  }, {
    key: "getIdHtml",
    value: function getIdHtml(Id) {
      var t = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'span';
      return "<".concat(t, ">").concat(this.escapeHTML(Id), "</").concat(t, ">");
    }
  }, {
    key: "toHtml",
    value: function toHtml(src, sheetList) {
      var _this7 = this;

      var key = sheetList.regNames;
      src = src.replace(key, function (a) {
        return _this7.getIdHtml(a);
      });
      src = src.replace(/<\/span>:<span>/g, function () {
        return ':';
      });
      src = src.replace(/<\/span>!<span>/g, function () {
        return '!';
      });
      return src;
    }
  }, {
    key: "escapeHTML",
    value: function escapeHTML(str) {
      return str.replace(/[&<>"']/g, function (match) {
        switch (match) {
          case '&':
            return '&amp;';

          case '<':
            return '&lt;';

          case '>':
            return '&gt;';

          case '"':
            return '&quot;';

          case "'":
            return '&apos;';

          default:
            return match;
        }
      });
    }
  }, {
    key: "setErrorRefs",
    value: function setErrorRefs(exp, mode) {
      if (mode === 'error') {
        this.errorRefs.add(exp);
      } else {
        this.warnRefs.add(exp);
      }
    }
  }, {
    key: "reset",
    value: function reset(cb) {
      var _iterator = _createForOfIteratorHelper(this.errors.entries()),
          _step;

      try {
        for (_iterator.s(); !(_step = _iterator.n()).done;) {
          var _step$value = _slicedToArray(_step.value, 2),
              val = _step$value[1];

          var mode = val.mode,
              ruler = val.ruler,
              isPass = val.isPass;

          if (!isPass) {
            this.toSuffixExpr(ruler, this.sheetList, mode, cb);
          }
        }
      } catch (err) {
        _iterator.e(err);
      } finally {
        _iterator.f();
      }
    }
  }, {
    key: "clearErrorRefs",
    value: function clearErrorRefs() {
      this.errorRefs = new Set();
      this.warnRefs = new Set();
    }
  }, {
    key: "getCrossSheetPosition",
    value: function getCrossSheetPosition(expr) {
      return expr.split('!');
    }
  }, {
    key: "getCrossExcels",
    value: function getCrossExcels(ruler) {
      var stack = new Set();
      var stackCrossExcel = new Set();
      var crossExcel = ruler.match(/(?:'((\[(.+?)\])([\u4e00-\u9fa5a-zA-Z0-9【】（）<>_]+)?\'\!)([A-Z]+[0-9]+))/g) || [];
      crossExcel.map(function (item) {
        return stack.add(item);
      });

      for (var _i = 0, _arr = _toConsumableArray(stack); _i < _arr.length; _i++) {
        var iterator = _arr[_i];

        var _this$getCrossSheetPo = this.getCrossSheetPosition(iterator),
            _this$getCrossSheetPo2 = _slicedToArray(_this$getCrossSheetPo, 1),
            _crossExcel = _this$getCrossSheetPo2[0];

        stackCrossExcel.add(_crossExcel);
      }

      return _toConsumableArray(stackCrossExcel);
    }
  }, {
    key: "validate",
    value: function validate(modes, sheetList, cb) {
      var _this8 = this;

      this.sheetList = sheetList;
      this.errors = new Map();
      this.errorRefs = new Set();
      this.warnRefs = new Set();
      this.each(function (it) {
        var ref = it.ref,
            mode = it.mode;

        if (modes.includes(mode)) {
          var _it$examiner$validate = it.examiner.validate(_this8.getIdentifierExamine),
              _it$examiner$validate2 = _slicedToArray(_it$examiner$validate, 3),
              flag = _it$examiner$validate2[0],
              message = _it$examiner$validate2[1],
              ruler = _it$examiner$validate2[2];

          if (flag === false) {
            var errorRef = _this8.toSuffixExpr(ruler, sheetList, mode, cb);

            _this8.errors.set(ref, {
              mode: mode,
              message: message,
              errorRef: errorRef,
              isPass: false,
              ruler: ruler,
              html: _this8.toHtml(ruler, sheetList)
            });
          } else {
            _this8.errors.delete(ref);
          }
        }
      });
    }
  }, {
    key: "externalValidate",
    value: function externalValidate(modes, sheetList, cb) {
      var _this9 = this;

      this.sheetList = sheetList;
      this.errors = new Map();
      this.errorRefs = new Set();
      this.warnRefs = new Set();
      this.each(function (it) {
        var ref = it.ref,
            mode = it.mode;

        if (modes.includes(mode)) {
          var _it$examiner = it.examiner,
              message = _it$examiner.message,
              ruler = _it$examiner.ruler;

          var errorRef = _this9.toSuffixExpr(ruler, sheetList, mode, cb);

          _this9.errors.set(ref, {
            mode: mode,
            message: message,
            errorRef: errorRef,
            isPass: false,
            ruler: ruler,
            html: _this9.toHtml(ruler, sheetList)
          });
        }
      });
    }
  }, {
    key: "getRulerRef",
    value: function getRulerRef(ruler) {
      console.log(ruler);
      return [];
    }
  }, {
    key: "each",
    value: function each(cb) {
      this._.forEach(function (it) {
        return cb(it);
      });
    } // 获取规则

  }, {
    key: "getData",
    value: function getData() {
      return this._.map(function (it) {
        return it.getData();
      });
    } // 注入规则

  }, {
    key: "setData",
    value: function setData(d) {
      this._ = d.map(function (it) {
        return examine_Examine.valueOf(it);
      });
    }
  }]);

  return Examines;
}();


// CONCATENATED MODULE: ./src/sheet/core/subscript.js









var subscript_Subscript = /*#__PURE__*/function () {
  function Subscript() {
    _classCallCheck(this, Subscript);

    this._ = []; //lt/rt/rb/lb

    this.subs = new Map();
    this.type = {
      lt: 'error',
      rt: 'frozen',
      rb: 'rb',
      lb: 'lb'
    };
  }

  _createClass(Subscript, [{
    key: "getSub",
    value: function getSub(ri, ci) {
      var subscript = this.get(ri, ci);

      if (subscript) {
        var sub = this.type[subscript.local];
        return {
          color: subscript.color,
          sub: sub
        };
      }
    }
  }, {
    key: "get",
    value: function get(ri, ci) {
      return this.subs.get("".concat(ri, "_").concat(ci));
    }
  }, {
    key: "clear",
    value: function clear() {
      this.subs.clear();
    }
  }, {
    key: "add",
    value: function add(ri, ci, _ref) {
      var local = _ref.local,
          color = _ref.color;
      var key = "".concat(ri, "_").concat(ci);
      this.subs.set(key, {
        local: local,
        color: color
      });
      return true;
    }
  }, {
    key: "remove",
    value: function remove(ri, ci) {
      var key = "".concat(ri, "_").concat(ci);
      return this.subs.delete(key);
    }
  }]);

  return Subscript;
}();

/* harmony default export */ var core_subscript = ({});

// CONCATENATED MODULE: ./src/sheet/core/comments.js








var comments_Comments = /*#__PURE__*/function () {
  function Comments() {
    _classCallCheck(this, Comments);

    this._ = {};
  }

  _createClass(Comments, [{
    key: "setData",
    value: function setData(comments) {
      for (var key in comments) {
        var _expr2xy = alphabet_expr2xy(key),
            _expr2xy2 = _slicedToArray(_expr2xy, 2),
            ci = _expr2xy2[0],
            ri = _expr2xy2[1];

        this.setComment(ri, ci, comments[key]);
      }
    }
  }, {
    key: "setComment",
    value: function setComment(ri, ci, comment) {
      var row = this.getOrNew(ri);
      row.cells[ci] = comment;
    }
  }, {
    key: "delComment",
    value: function delComment(ri, ci) {
      if (this.getComment(ri, ci)) {
        var row = this.get(ri);
        delete row.cells[ci];
      }
    }
  }, {
    key: "getOrNew",
    value: function getOrNew(ri) {
      this._[ri] = this._[ri] || {
        cells: {}
      };
      return this._[ri];
    }
  }, {
    key: "get",
    value: function get(ri) {
      return this._[ri];
    }
  }, {
    key: "getComment",
    value: function getComment(ri, ci) {
      var row = this.get(ri);

      if (row !== undefined && row.cells !== undefined && row.cells[ci] !== undefined) {
        return row.cells[ci];
      }

      return null;
    }
  }, {
    key: "each",
    value: function each(cb) {
      Object.entries(this._).forEach(function (_ref) {
        var _ref2 = _slicedToArray(_ref, 2),
            ri = _ref2[0],
            row = _ref2[1];

        cb(ri, row);
      });
    }
  }, {
    key: "eachCells",
    value: function eachCells(ri, cb) {
      if (this._[ri] && this._[ri].cells) {
        Object.entries(this._[ri].cells).forEach(function (_ref3) {
          var _ref4 = _slicedToArray(_ref3, 2),
              ci = _ref4[0],
              cell = _ref4[1];

          cb(ci, cell);
        });
      }
    }
  }, {
    key: "getData",
    value: function getData() {
      var _this = this;

      var _ = {};
      this.each(function (ri) {
        _this.eachCells(ri, function (ci, cell) {
          _[alphabet_xy2expr(parseInt(ci), parseInt(ri))] = cell;
        });
      });
      return _;
    }
  }]);

  return Comments;
}();


// EXTERNAL MODULE: ./src/sheet/functions/error.js
var functions_error = __webpack_require__("94eb");

// EXTERNAL MODULE: ./node_modules/core-js/modules/es.object.get-prototype-of.js
var es_object_get_prototype_of = __webpack_require__("3410");

// CONCATENATED MODULE: ./src/sheet/functions/parser.js










/* parser generated by jison 0.4.18 */

/* eslint-disable */

/*
  Returns a Parser object of the following structure:

  Parser: {
    yy: {}
  }

  Parser.prototype: {
    yy: {},
    trace: function(),
    symbols_: {associative list: name ==> number},
    terminals_: {associative list: number ==> name},
    productions_: [...],
    performAction: function anonymous(yytext, yyleng, yylineno, yy, yystate, $$, _$),
    table: [...],
    defaultActions: {...},
    parseError: function(str, hash),
    parse: function(input),

    lexer: {
        EOF: 1,
        parseError: function(str, hash),
        setInput: function(input),
        input: function(),
        unput: function(str),
        more: function(),
        less: function(n),
        pastInput: function(),
        upcomingInput: function(),
        showPosition: function(),
        test_match: function(regex_match_array, rule_index),
        next: function(),
        lex: function(),
        begin: function(condition),
        popState: function(),
        _currentRules: function(),
        topState: function(),
        pushState: function(condition),

        options: {
            ranges: boolean           (optional: true ==> token location info will include a .range[] member)
            flex: boolean             (optional: true ==> flex-like lexing behaviour where the rules are tested exhaustively to find the longest match)
            backtrack_lexer: boolean  (optional: true ==> lexer regexes are tested in order and for each matching regex the action code is invoked; the lexer terminates the scan when a token is returned by the action code)
        },

        performAction: function(yy, yy_, $avoiding_name_collisions, YY_START),
        rules: [...],
        conditions: {associative list: name ==> set},
    }
  }

  token location info (@$, _$, etc.): {
    first_line: n,
    last_line: n,
    first_column: n,
    last_column: n,
    range: [start_number, end_number]       (where the numbers are indexes into the input string, regular zero-based)
  }

  the parseError function receives a 'hash' object with these members for lexer and parser errors: {
    text:        (matched text)
    token:       (the produced terminal token, if any)
    line:        (yylineno)
  }
  while parser (grammar) errors will also provide these members, i.e. parser errors deliver a superset of attributes: {
    loc:         (yylloc)
    expected:    (string describing the set of expected tokens)
    recoverable: (boolean: TRUE when the parser has a error recovery rule available for this particular error)
  }
*/
var parser = function () {
  var o = function o(k, v, _o, l) {
    for (_o = _o || {}, l = k.length; l--; _o[k[l]] = v) {
      ;
    }

    return _o;
  },
      $V0 = [1, 4],
      $V1 = [1, 5],
      $V2 = [1, 6],
      $V3 = [1, 7],
      $V4 = [1, 8],
      $V5 = [1, 11],
      $V6 = [1, 12],
      $V7 = [1, 13],
      $V8 = [1, 14],
      $V9 = [1, 15],
      $Va = [1, 16],
      $Vb = [1, 24],
      $Vc = [1, 18],
      $Vd = [1, 19],
      $Ve = [1, 20],
      $Vf = [1, 21],
      $Vg = [1, 22],
      $Vh = [1, 23],
      $Vi = [1, 25],
      $Vj = [1, 26],
      $Vk = [1, 27],
      $Vl = [1, 28],
      $Vm = [1, 29],
      $Vn = [1, 30],
      $Vo = [5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 20, 32, 33, 36],
      $Vp = [5, 6, 7, 8, 12, 13, 14, 15, 16, 17, 19, 32, 33, 36],
      $Vq = [1, 58],
      $Vr = [1, 59],
      $Vs = [19, 32, 33, 36],
      $Vt = [5, 6, 7, 8, 9, 10, 12, 13, 14, 15, 16, 17, 19, 32, 33, 36],
      $Vu = [5, 6, 12, 13, 14, 15, 16, 19, 32, 33, 36];

  var parser = {
    trace: function trace() {},
    yy: {},
    symbols_: {
      error: 2,
      expressions: 3,
      e: 4,
      EOF: 5,
      '=': 6,
      '+': 7,
      '-': 8,
      '*': 9,
      '/': 10,
      '^': 11,
      '<>': 12,
      '>': 13,
      '<': 14,
      '>=': 15,
      '<=': 16,
      '&': 17,
      '(': 18,
      ')': 19,
      ':': 20,
      IDENT: 21,
      SCOPE: 22,
      func: 23,
      array_literal: 24,
      TRUE: 25,
      FALSE: 26,
      STRING: 27,
      NUMBER: 28,
      '%': 29,
      range: 30,
      param_list: 31,
      ',': 32,
      ';': 33,
      FUNC: 34,
      '{': 35,
      '}': 36,
      $accept: 0,
      $end: 1
    },
    terminals_: {
      2: 'error',
      5: 'EOF',
      6: '=',
      7: '+',
      8: '-',
      9: '*',
      10: '/',
      11: '^',
      12: '<>',
      13: '>',
      14: '<',
      15: '>=',
      16: '<=',
      17: '&',
      18: '(',
      19: ')',
      20: ':',
      21: 'IDENT',
      22: 'SCOPE',
      25: 'TRUE',
      26: 'FALSE',
      27: 'STRING',
      28: 'NUMBER',
      29: '%',
      32: ',',
      33: ';',
      34: 'FUNC',
      35: '{',
      36: '}'
    },
    productions_: [0, [3, 2], [3, 3], [4, 3], [4, 3], [4, 3], [4, 3], [4, 3], [4, 3], [4, 3], [4, 3], [4, 3], [4, 3], [4, 3], [4, 2], [4, 3], [4, 2], [4, 3], [4, 3], [4, 1], [4, 2], [4, 1], [4, 1], [4, 1], [4, 1], [4, 1], [4, 2], [4, 1], [30, 3], [31, 1], [31, 3], [31, 3], [23, 4], [23, 3], [24, 3]],
    performAction: function anonymous(yytext, yyleng, yylineno, yy, yystate
    /* action[1] */
    , $$
    /* vstack */
    , _$
    /* lstack */
    ) {
      /* this == yyval */
      var $0 = $$.length - 1;

      switch (yystate) {
        case 1:
        case 2:
          return $$[$0 - 1];
          break;

        case 3:
          this.$ = {
            type: 'operator',
            subtype: 'infix-add',
            operands: [$$[$0 - 2], $$[$0]]
          };
          break;

        case 4:
          this.$ = {
            type: 'operator',
            subtype: 'infix-subtract',
            operands: [$$[$0 - 2], $$[$0]]
          };
          break;

        case 5:
          this.$ = {
            type: 'operator',
            subtype: 'infix-multiply',
            operands: [$$[$0 - 2], $$[$0]]
          };
          break;

        case 6:
          this.$ = {
            type: 'operator',
            subtype: 'infix-divide',
            operands: [$$[$0 - 2], $$[$0]]
          };
          break;

        case 7:
          this.$ = {
            type: 'operator',
            subtype: 'infix-power',
            operands: [$$[$0 - 2], $$[$0]]
          };
          break;

        case 8:
          this.$ = {
            type: 'operator',
            subtype: 'infix-ne',
            operands: [$$[$0 - 2], $$[$0]]
          };
          break;

        case 9:
          this.$ = {
            type: 'operator',
            subtype: 'infix-eq',
            operands: [$$[$0 - 2], $$[$0]]
          };
          break;

        case 10:
          this.$ = {
            type: 'operator',
            subtype: 'infix-gt',
            operands: [$$[$0 - 2], $$[$0]]
          };
          break;

        case 11:
          this.$ = {
            type: 'operator',
            subtype: 'infix-lt',
            operands: [$$[$0 - 2], $$[$0]]
          };
          break;

        case 12:
          this.$ = {
            type: 'operator',
            subtype: 'infix-gte',
            operands: [$$[$0 - 2], $$[$0]]
          };
          break;

        case 13:
          this.$ = {
            type: 'operator',
            subtype: 'infix-lte',
            operands: [$$[$0 - 2], $$[$0]]
          };
          break;

        case 14:
          this.$ = {
            type: 'operator',
            subtype: 'prefix-plus',
            operands: [$$[$0]]
          };
          break;

        case 15:
          this.$ = {
            type: 'operator',
            subtype: 'infix-concat',
            operands: [$$[$0 - 2], $$[$0]]
          };
          break;

        case 16:
          this.$ = {
            type: 'operator',
            subtype: 'prefix-minus',
            operands: [$$[$0]]
          };
          break;

        case 17:
          this.$ = {
            type: 'group',
            exp: $$[$0 - 1]
          };
          break;

        case 18:
          this.$ = {
            type: 'range',
            subtype: 'local',
            topLeft: $$[$0 - 2],
            bottomRight: $$[$0]
          };
          break;

        case 19:
          this.$ = {
            type: 'variable',
            name: $$[$0]
          };
          break;

        case 20:
          this.$ = {
            type: 'variable',
            scope: $$[$0 - 1],
            name: $$[$0]
          };
          break;

        case 21:
        case 22:
          this.$ = $$[$0];
          break;

        case 23:
          this.$ = {
            type: 'value',
            subtype: 'boolean',
            value: true
          };
          break;

        case 24:
          this.$ = {
            type: 'value',
            subtype: 'boolean',
            value: false
          };
          break;

        case 25:
          this.$ = {
            type: 'value',
            subtype: 'string',
            value: String(yytext)
          };
          break;

        case 26:
          this.$ = {
            type: 'value',
            subtype: 'number',
            value: $$[$0 - 1] / 100
          };
          break;

        case 27:
          this.$ = {
            type: 'value',
            subtype: 'number',
            value: Number(yytext)
          };
          break;

        case 29:
          this.$ = [$$[$0]];
          break;

        case 30:
          this.$ = $$[$0 - 2].concat([$$[$0]]);
          break;

        case 31:
          this.$ = $$[$0][0].subtype !== 'array' ? [{
            type: 'value',
            subtype: 'array',
            items: $$[$0 - 2]
          }, {
            type: 'value',
            subtype: 'array',
            items: $$[$0]
          }] : [{
            type: 'value',
            subtype: 'array',
            items: $$[$0 - 2]
          }].concat($$[$0]);
          break;

        case 32:
          this.$ = {
            type: 'function',
            name: $$[$0 - 3],
            args: $$[$0 - 1]
          };
          break;

        case 33:
          this.$ = {
            type: 'function',
            name: $$[$0 - 2],
            args: []
          };
          break;

        case 34:
          this.$ = {
            type: 'value',
            subtype: 'array',
            items: $$[$0 - 1]
          };
          break;
      }
    },
    table: [{
      3: 1,
      4: 2,
      6: [1, 3],
      7: $V0,
      8: $V1,
      18: $V2,
      21: $V3,
      22: $V4,
      23: 9,
      24: 10,
      25: $V5,
      26: $V6,
      27: $V7,
      28: $V8,
      34: $V9,
      35: $Va
    }, {
      1: [3]
    }, {
      5: [1, 17],
      6: $Vb,
      7: $Vc,
      8: $Vd,
      9: $Ve,
      10: $Vf,
      11: $Vg,
      12: $Vh,
      13: $Vi,
      14: $Vj,
      15: $Vk,
      16: $Vl,
      17: $Vm,
      20: $Vn
    }, {
      4: 31,
      7: $V0,
      8: $V1,
      18: $V2,
      21: $V3,
      22: $V4,
      23: 9,
      24: 10,
      25: $V5,
      26: $V6,
      27: $V7,
      28: $V8,
      34: $V9,
      35: $Va
    }, {
      4: 32,
      7: $V0,
      8: $V1,
      18: $V2,
      21: $V3,
      22: $V4,
      23: 9,
      24: 10,
      25: $V5,
      26: $V6,
      27: $V7,
      28: $V8,
      34: $V9,
      35: $Va
    }, {
      4: 33,
      7: $V0,
      8: $V1,
      18: $V2,
      21: $V3,
      22: $V4,
      23: 9,
      24: 10,
      25: $V5,
      26: $V6,
      27: $V7,
      28: $V8,
      34: $V9,
      35: $Va
    }, {
      4: 34,
      7: $V0,
      8: $V1,
      18: $V2,
      21: $V3,
      22: $V4,
      23: 9,
      24: 10,
      25: $V5,
      26: $V6,
      27: $V7,
      28: $V8,
      34: $V9,
      35: $Va
    }, o($Vo, [2, 19]), {
      21: [1, 35]
    }, o($Vo, [2, 21]), o($Vo, [2, 22]), o($Vo, [2, 23]), o($Vo, [2, 24]), o($Vo, [2, 25]), o($Vo, [2, 27], {
      29: [1, 36]
    }), {
      18: [1, 37]
    }, {
      4: 39,
      7: $V0,
      8: $V1,
      18: $V2,
      21: $V3,
      22: $V4,
      23: 9,
      24: 10,
      25: $V5,
      26: $V6,
      27: $V7,
      28: $V8,
      31: 38,
      34: $V9,
      35: $Va
    }, {
      1: [2, 1]
    }, {
      4: 40,
      7: $V0,
      8: $V1,
      18: $V2,
      21: $V3,
      22: $V4,
      23: 9,
      24: 10,
      25: $V5,
      26: $V6,
      27: $V7,
      28: $V8,
      34: $V9,
      35: $Va
    }, {
      4: 41,
      7: $V0,
      8: $V1,
      18: $V2,
      21: $V3,
      22: $V4,
      23: 9,
      24: 10,
      25: $V5,
      26: $V6,
      27: $V7,
      28: $V8,
      34: $V9,
      35: $Va
    }, {
      4: 42,
      7: $V0,
      8: $V1,
      18: $V2,
      21: $V3,
      22: $V4,
      23: 9,
      24: 10,
      25: $V5,
      26: $V6,
      27: $V7,
      28: $V8,
      34: $V9,
      35: $Va
    }, {
      4: 43,
      7: $V0,
      8: $V1,
      18: $V2,
      21: $V3,
      22: $V4,
      23: 9,
      24: 10,
      25: $V5,
      26: $V6,
      27: $V7,
      28: $V8,
      34: $V9,
      35: $Va
    }, {
      4: 44,
      7: $V0,
      8: $V1,
      18: $V2,
      21: $V3,
      22: $V4,
      23: 9,
      24: 10,
      25: $V5,
      26: $V6,
      27: $V7,
      28: $V8,
      34: $V9,
      35: $Va
    }, {
      4: 45,
      7: $V0,
      8: $V1,
      18: $V2,
      21: $V3,
      22: $V4,
      23: 9,
      24: 10,
      25: $V5,
      26: $V6,
      27: $V7,
      28: $V8,
      34: $V9,
      35: $Va
    }, {
      4: 46,
      7: $V0,
      8: $V1,
      18: $V2,
      21: $V3,
      22: $V4,
      23: 9,
      24: 10,
      25: $V5,
      26: $V6,
      27: $V7,
      28: $V8,
      34: $V9,
      35: $Va
    }, {
      4: 47,
      7: $V0,
      8: $V1,
      18: $V2,
      21: $V3,
      22: $V4,
      23: 9,
      24: 10,
      25: $V5,
      26: $V6,
      27: $V7,
      28: $V8,
      34: $V9,
      35: $Va
    }, {
      4: 48,
      7: $V0,
      8: $V1,
      18: $V2,
      21: $V3,
      22: $V4,
      23: 9,
      24: 10,
      25: $V5,
      26: $V6,
      27: $V7,
      28: $V8,
      34: $V9,
      35: $Va
    }, {
      4: 49,
      7: $V0,
      8: $V1,
      18: $V2,
      21: $V3,
      22: $V4,
      23: 9,
      24: 10,
      25: $V5,
      26: $V6,
      27: $V7,
      28: $V8,
      34: $V9,
      35: $Va
    }, {
      4: 50,
      7: $V0,
      8: $V1,
      18: $V2,
      21: $V3,
      22: $V4,
      23: 9,
      24: 10,
      25: $V5,
      26: $V6,
      27: $V7,
      28: $V8,
      34: $V9,
      35: $Va
    }, {
      4: 51,
      7: $V0,
      8: $V1,
      18: $V2,
      21: $V3,
      22: $V4,
      23: 9,
      24: 10,
      25: $V5,
      26: $V6,
      27: $V7,
      28: $V8,
      34: $V9,
      35: $Va
    }, {
      4: 52,
      7: $V0,
      8: $V1,
      18: $V2,
      21: $V3,
      22: $V4,
      23: 9,
      24: 10,
      25: $V5,
      26: $V6,
      27: $V7,
      28: $V8,
      34: $V9,
      35: $Va
    }, {
      5: [1, 53],
      6: $Vb,
      7: $Vc,
      8: $Vd,
      9: $Ve,
      10: $Vf,
      11: $Vg,
      12: $Vh,
      13: $Vi,
      14: $Vj,
      15: $Vk,
      16: $Vl,
      17: $Vm,
      20: $Vn
    }, o($Vp, [2, 14], {
      9: $Ve,
      10: $Vf,
      11: $Vg,
      20: $Vn
    }), o($Vp, [2, 16], {
      9: $Ve,
      10: $Vf,
      11: $Vg,
      20: $Vn
    }), {
      6: $Vb,
      7: $Vc,
      8: $Vd,
      9: $Ve,
      10: $Vf,
      11: $Vg,
      12: $Vh,
      13: $Vi,
      14: $Vj,
      15: $Vk,
      16: $Vl,
      17: $Vm,
      19: [1, 54],
      20: $Vn
    }, o($Vo, [2, 20]), o($Vo, [2, 26]), {
      4: 39,
      7: $V0,
      8: $V1,
      18: $V2,
      19: [1, 56],
      21: $V3,
      22: $V4,
      23: 9,
      24: 10,
      25: $V5,
      26: $V6,
      27: $V7,
      28: $V8,
      31: 55,
      34: $V9,
      35: $Va
    }, {
      32: $Vq,
      33: $Vr,
      36: [1, 57]
    }, o($Vs, [2, 29], {
      6: $Vb,
      7: $Vc,
      8: $Vd,
      9: $Ve,
      10: $Vf,
      11: $Vg,
      12: $Vh,
      13: $Vi,
      14: $Vj,
      15: $Vk,
      16: $Vl,
      17: $Vm,
      20: $Vn
    }), o($Vp, [2, 3], {
      9: $Ve,
      10: $Vf,
      11: $Vg,
      20: $Vn
    }), o($Vp, [2, 4], {
      9: $Ve,
      10: $Vf,
      11: $Vg,
      20: $Vn
    }), o($Vt, [2, 5], {
      11: $Vg,
      20: $Vn
    }), o($Vt, [2, 6], {
      11: $Vg,
      20: $Vn
    }), o([5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 32, 33, 36], [2, 7], {
      20: $Vn
    }), o($Vu, [2, 8], {
      7: $Vc,
      8: $Vd,
      9: $Ve,
      10: $Vf,
      11: $Vg,
      17: $Vm,
      20: $Vn
    }), o($Vu, [2, 9], {
      7: $Vc,
      8: $Vd,
      9: $Ve,
      10: $Vf,
      11: $Vg,
      17: $Vm,
      20: $Vn
    }), o($Vu, [2, 10], {
      7: $Vc,
      8: $Vd,
      9: $Ve,
      10: $Vf,
      11: $Vg,
      17: $Vm,
      20: $Vn
    }), o($Vu, [2, 11], {
      7: $Vc,
      8: $Vd,
      9: $Ve,
      10: $Vf,
      11: $Vg,
      17: $Vm,
      20: $Vn
    }), o($Vu, [2, 12], {
      7: $Vc,
      8: $Vd,
      9: $Ve,
      10: $Vf,
      11: $Vg,
      17: $Vm,
      20: $Vn
    }), o($Vu, [2, 13], {
      7: $Vc,
      8: $Vd,
      9: $Ve,
      10: $Vf,
      11: $Vg,
      17: $Vm,
      20: $Vn
    }), o([5, 6, 12, 13, 14, 15, 16, 17, 19, 32, 33, 36], [2, 15], {
      7: $Vc,
      8: $Vd,
      9: $Ve,
      10: $Vf,
      11: $Vg,
      20: $Vn
    }), o($Vo, [2, 18]), {
      1: [2, 2]
    }, o($Vo, [2, 17]), {
      19: [1, 60],
      32: $Vq,
      33: $Vr
    }, o($Vo, [2, 33]), o($Vo, [2, 34]), {
      4: 61,
      7: $V0,
      8: $V1,
      18: $V2,
      21: $V3,
      22: $V4,
      23: 9,
      24: 10,
      25: $V5,
      26: $V6,
      27: $V7,
      28: $V8,
      34: $V9,
      35: $Va
    }, {
      4: 39,
      7: $V0,
      8: $V1,
      18: $V2,
      21: $V3,
      22: $V4,
      23: 9,
      24: 10,
      25: $V5,
      26: $V6,
      27: $V7,
      28: $V8,
      31: 62,
      34: $V9,
      35: $Va
    }, o($Vo, [2, 32]), o($Vs, [2, 30], {
      6: $Vb,
      7: $Vc,
      8: $Vd,
      9: $Ve,
      10: $Vf,
      11: $Vg,
      12: $Vh,
      13: $Vi,
      14: $Vj,
      15: $Vk,
      16: $Vl,
      17: $Vm,
      20: $Vn
    }), o([19, 36], [2, 31], {
      32: $Vq,
      33: $Vr
    })],
    defaultActions: {
      17: [2, 1],
      53: [2, 2]
    },
    parseError: function parseError(str, hash) {
      if (hash.recoverable) {
        this.trace(str);
      } else {
        var error = new Error(str);
        error.hash = hash;
        throw error;
      }
    },
    parse: function parse(input) {
      var self = this,
          stack = [0],
          tstack = [],
          vstack = [null],
          lstack = [],
          table = this.table,
          yytext = '',
          yylineno = 0,
          yyleng = 0,
          recovering = 0,
          TERROR = 2,
          EOF = 1;
      var args = lstack.slice.call(arguments, 1);
      var lexer = Object.create(this.lexer);
      var sharedState = {
        yy: {}
      };

      for (var k in this.yy) {
        if (Object.prototype.hasOwnProperty.call(this.yy, k)) {
          sharedState.yy[k] = this.yy[k];
        }
      }

      lexer.setInput(input, sharedState.yy);
      sharedState.yy.lexer = lexer;
      sharedState.yy.parser = this;

      if (typeof lexer.yylloc == 'undefined') {
        lexer.yylloc = {};
      }

      var yyloc = lexer.yylloc;
      lstack.push(yyloc);
      var ranges = lexer.options && lexer.options.ranges;

      if (typeof sharedState.yy.parseError === 'function') {
        this.parseError = sharedState.yy.parseError;
      } else {
        this.parseError = Object.getPrototypeOf(this).parseError;
      }

      function popStack(n) {
        stack.length = stack.length - 2 * n;
        vstack.length = vstack.length - n;
        lstack.length = lstack.length - n;
      }

      var lex = function lex() {
        var token;
        token = lexer.lex() || EOF;

        if (typeof token !== 'number') {
          token = self.symbols_[token] || token;
        }

        return token;
      };

      var symbol,
          preErrorSymbol,
          state,
          action,
          a,
          r,
          yyval = {},
          p,
          len,
          newState,
          expected;

      while (true) {
        state = stack[stack.length - 1];

        if (this.defaultActions[state]) {
          action = this.defaultActions[state];
        } else {
          if (symbol === null || typeof symbol == 'undefined') {
            symbol = lex();
          }

          action = table[state] && table[state][symbol];
        }

        if (typeof action === 'undefined' || !action.length || !action[0]) {
          var errStr = '';
          expected = [];

          for (p in table[state]) {
            if (this.terminals_[p] && p > TERROR) {
              expected.push("'" + this.terminals_[p] + "'");
            }
          }

          if (lexer.showPosition) {
            errStr = 'Parse error on line ' + (yylineno + 1) + ':\n' + lexer.showPosition() + '\nExpecting ' + expected.join(', ') + ", got '" + (this.terminals_[symbol] || symbol) + "'";
          } else {
            errStr = 'Parse error on line ' + (yylineno + 1) + ': Unexpected ' + (symbol == EOF ? 'end of input' : "'" + (this.terminals_[symbol] || symbol) + "'");
          }

          this.parseError(errStr, {
            text: lexer.match,
            token: this.terminals_[symbol] || symbol,
            line: lexer.yylineno,
            loc: yyloc,
            expected: expected
          });
        }

        if (action[0] instanceof Array && action.length > 1) {
          throw new Error('Parse Error: multiple actions possible at state: ' + state + ', token: ' + symbol);
        }

        switch (action[0]) {
          case 1:
            stack.push(symbol);
            vstack.push(lexer.yytext);
            lstack.push(lexer.yylloc);
            stack.push(action[1]);
            symbol = null;

            if (!preErrorSymbol) {
              yyleng = lexer.yyleng;
              yytext = lexer.yytext;
              yylineno = lexer.yylineno;
              yyloc = lexer.yylloc;

              if (recovering > 0) {
                recovering--;
              }
            } else {
              symbol = preErrorSymbol;
              preErrorSymbol = null;
            }

            break;

          case 2:
            len = this.productions_[action[1]][1];
            yyval.$ = vstack[vstack.length - len];
            yyval._$ = {
              first_line: lstack[lstack.length - (len || 1)].first_line,
              last_line: lstack[lstack.length - 1].last_line,
              first_column: lstack[lstack.length - (len || 1)].first_column,
              last_column: lstack[lstack.length - 1].last_column
            };

            if (ranges) {
              yyval._$.range = [lstack[lstack.length - (len || 1)].range[0], lstack[lstack.length - 1].range[1]];
            }

            r = this.performAction.apply(yyval, [yytext, yyleng, yylineno, sharedState.yy, action[1], vstack, lstack].concat(args));

            if (typeof r !== 'undefined') {
              return r;
            }

            if (len) {
              stack = stack.slice(0, -1 * len * 2);
              vstack = vstack.slice(0, -1 * len);
              lstack = lstack.slice(0, -1 * len);
            }

            stack.push(this.productions_[action[1]][0]);
            vstack.push(yyval.$);
            lstack.push(yyval._$);
            newState = table[stack[stack.length - 2]][stack[stack.length - 1]];
            stack.push(newState);
            break;

          case 3:
            return true;
        }
      }

      return true;
    }
  };
  /* generated by jison-lex 0.3.4 */

  var lexer = function () {
    var lexer = {
      EOF: 1,
      parseError: function parseError(str, hash) {
        if (this.yy.parser) {
          this.yy.parser.parseError(str, hash);
        } else {
          throw new Error(str);
        }
      },
      // resets the lexer, sets new input
      setInput: function setInput(input, yy) {
        this.yy = yy || this.yy || {};
        this._input = input;
        this._more = this._backtrack = this.done = false;
        this.yylineno = this.yyleng = 0;
        this.yytext = this.matched = this.match = '';
        this.conditionStack = ['INITIAL'];
        this.yylloc = {
          first_line: 1,
          first_column: 0,
          last_line: 1,
          last_column: 0
        };

        if (this.options.ranges) {
          this.yylloc.range = [0, 0];
        }

        this.offset = 0;
        return this;
      },
      // consumes and returns one char from the input
      input: function input() {
        var ch = this._input[0];
        this.yytext += ch;
        this.yyleng++;
        this.offset++;
        this.match += ch;
        this.matched += ch;
        var lines = ch.match(/(?:\r\n?|\n).*/g);

        if (lines) {
          this.yylineno++;
          this.yylloc.last_line++;
        } else {
          this.yylloc.last_column++;
        }

        if (this.options.ranges) {
          this.yylloc.range[1]++;
        }

        this._input = this._input.slice(1);
        return ch;
      },
      // unshifts one char (or a string) into the input
      unput: function unput(ch) {
        var len = ch.length;
        var lines = ch.split(/(?:\r\n?|\n)/g);
        this._input = ch + this._input;
        this.yytext = this.yytext.substr(0, this.yytext.length - len); //this.yyleng -= len;

        this.offset -= len;
        var oldLines = this.match.split(/(?:\r\n?|\n)/g);
        this.match = this.match.substr(0, this.match.length - 1);
        this.matched = this.matched.substr(0, this.matched.length - 1);

        if (lines.length - 1) {
          this.yylineno -= lines.length - 1;
        }

        var r = this.yylloc.range;
        this.yylloc = {
          first_line: this.yylloc.first_line,
          last_line: this.yylineno + 1,
          first_column: this.yylloc.first_column,
          last_column: lines ? (lines.length === oldLines.length ? this.yylloc.first_column : 0) + oldLines[oldLines.length - lines.length].length - lines[0].length : this.yylloc.first_column - len
        };

        if (this.options.ranges) {
          this.yylloc.range = [r[0], r[0] + this.yyleng - len];
        }

        this.yyleng = this.yytext.length;
        return this;
      },
      // When called from action, caches matched text and appends it on next action
      more: function more() {
        this._more = true;
        return this;
      },
      // When called from action, signals the lexer that this rule fails to match the input, so the next matching rule (regex) should be tested instead.
      reject: function reject() {
        if (this.options.backtrack_lexer) {
          this._backtrack = true;
        } else {
          return this.parseError('Lexical error on line ' + (this.yylineno + 1) + '. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n' + this.showPosition(), {
            text: '',
            token: null,
            line: this.yylineno
          });
        }

        return this;
      },
      // retain first n characters of the match
      less: function less(n) {
        this.unput(this.match.slice(n));
      },
      // displays already matched input, i.e. for error messages
      pastInput: function pastInput() {
        var past = this.matched.substr(0, this.matched.length - this.match.length);
        return (past.length > 20 ? '...' : '') + past.substr(-20).replace(/\n/g, '');
      },
      // displays upcoming input, i.e. for error messages
      upcomingInput: function upcomingInput() {
        var next = this.match;

        if (next.length < 20) {
          next += this._input.substr(0, 20 - next.length);
        }

        return (next.substr(0, 20) + (next.length > 20 ? '...' : '')).replace(/\n/g, '');
      },
      // displays the character position where the lexing error occurred, i.e. for error messages
      showPosition: function showPosition() {
        var pre = this.pastInput();
        var c = new Array(pre.length + 1).join('-');
        return pre + this.upcomingInput() + '\n' + c + '^';
      },
      // test the lexed token: return FALSE when not a match, otherwise return token
      test_match: function test_match(match, indexed_rule) {
        var token, lines, backup;

        if (this.options.backtrack_lexer) {
          // save context
          backup = {
            yylineno: this.yylineno,
            yylloc: {
              first_line: this.yylloc.first_line,
              last_line: this.last_line,
              first_column: this.yylloc.first_column,
              last_column: this.yylloc.last_column
            },
            yytext: this.yytext,
            match: this.match,
            matches: this.matches,
            matched: this.matched,
            yyleng: this.yyleng,
            offset: this.offset,
            _more: this._more,
            _input: this._input,
            yy: this.yy,
            conditionStack: this.conditionStack.slice(0),
            done: this.done
          };

          if (this.options.ranges) {
            backup.yylloc.range = this.yylloc.range.slice(0);
          }
        }

        lines = match[0].match(/(?:\r\n?|\n).*/g);

        if (lines) {
          this.yylineno += lines.length;
        }

        this.yylloc = {
          first_line: this.yylloc.last_line,
          last_line: this.yylineno + 1,
          first_column: this.yylloc.last_column,
          last_column: lines ? lines[lines.length - 1].length - lines[lines.length - 1].match(/\r?\n?/)[0].length : this.yylloc.last_column + match[0].length
        };
        this.yytext += match[0];
        this.match += match[0];
        this.matches = match;
        this.yyleng = this.yytext.length;

        if (this.options.ranges) {
          this.yylloc.range = [this.offset, this.offset += this.yyleng];
        }

        this._more = false;
        this._backtrack = false;
        this._input = this._input.slice(match[0].length);
        this.matched += match[0];
        token = this.performAction.call(this, this.yy, this, indexed_rule, this.conditionStack[this.conditionStack.length - 1]);

        if (this.done && this._input) {
          this.done = false;
        }

        if (token) {
          return token;
        } else if (this._backtrack) {
          // recover context
          for (var k in backup) {
            this[k] = backup[k];
          }

          return false; // rule action called reject() implying the next rule should be tested instead.
        }

        return false;
      },
      // return next match in input
      next: function next() {
        if (this.done) {
          return this.EOF;
        }

        if (!this._input) {
          this.done = true;
        }

        var token, match, tempMatch, index;

        if (!this._more) {
          this.yytext = '';
          this.match = '';
        }

        var rules = this._currentRules();

        for (var i = 0; i < rules.length; i++) {
          tempMatch = this._input.match(this.rules[rules[i]]);

          if (tempMatch && (!match || tempMatch[0].length > match[0].length)) {
            match = tempMatch;
            index = i;

            if (this.options.backtrack_lexer) {
              token = this.test_match(tempMatch, rules[i]);

              if (token !== false) {
                return token;
              } else if (this._backtrack) {
                match = false;
                continue; // rule action called reject() implying a rule MISmatch.
              } else {
                // else: this is a lexer rule which consumes input without producing a token (e.g. whitespace)
                return false;
              }
            } else if (!this.options.flex) {
              break;
            }
          }
        }

        if (match) {
          token = this.test_match(match, rules[index]);

          if (token !== false) {
            return token;
          } // else: this is a lexer rule which consumes input without producing a token (e.g. whitespace)


          return false;
        }

        if (this._input === '') {
          return this.EOF;
        } else {
          return this.parseError('Lexical error on line ' + (this.yylineno + 1) + '. Unrecognized text.\n' + this.showPosition(), {
            text: '',
            token: null,
            line: this.yylineno
          });
        }
      },
      // return next match that has a token
      lex: function lex() {
        var r = this.next();

        if (r) {
          return r;
        } else {
          return this.lex();
        }
      },
      // activates a new lexer condition state (pushes the new lexer condition state onto the condition stack)
      begin: function begin(condition) {
        this.conditionStack.push(condition);
      },
      // pop the previously active lexer condition state off the condition stack
      popState: function popState() {
        var n = this.conditionStack.length - 1;

        if (n > 0) {
          return this.conditionStack.pop();
        } else {
          return this.conditionStack[0];
        }
      },
      // produce the lexer rule set which is active for the currently active lexer condition state
      _currentRules: function _currentRules() {
        if (this.conditionStack.length && this.conditionStack[this.conditionStack.length - 1]) {
          return this.conditions[this.conditionStack[this.conditionStack.length - 1]].rules;
        } else {
          return this.conditions['INITIAL'].rules;
        }
      },
      // return the currently active lexer condition state; when an index argument is provided it produces the N-th previous condition state, if available
      topState: function topState(n) {
        n = this.conditionStack.length - 1 - Math.abs(n || 0);

        if (n >= 0) {
          return this.conditionStack[n];
        } else {
          return 'INITIAL';
        }
      },
      // alias for begin(condition)
      pushState: function pushState(condition) {
        this.begin(condition);
      },
      // return the number of states currently on the stack
      stateStackSize: function stateStackSize() {
        return this.conditionStack.length;
      },
      options: {},
      performAction: function anonymous(yy, yy_, $avoiding_name_collisions, YY_START) {
        var YYSTATE = YY_START;

        switch ($avoiding_name_collisions) {
          case 0
          /* skip whitespace */
          :
            break;

          case 1:
            return 28;
            break;

          case 2:
            return 25;
            break;

          case 3:
            return 26;
            break;

          case 4:
            return 25;
            break;

          case 5:
            return 26;
            break;

          case 6:
            return 25;
            break;

          case 7:
            return 26;
            break;

          case 8:
            return 9;
            break;

          case 9:
            return 10;
            break;

          case 10:
            return 8;
            break;

          case 11:
            return 7;
            break;

          case 12:
            return 17;
            break;

          case 13:
            return 11;
            break;

          case 14:
            return 18;
            break;

          case 15:
            return 19;
            break;

          case 16:
            return '>=';
            break;

          case 17:
            return '<=';
            break;

          case 18:
            return '<>';
            break;

          case 19:
            return '=';
            break;

          case 20:
            return '>';
            break;

          case 21:
            return '<';
            break;

          case 22:
            return '{';
            break;

          case 23:
            return '}';
            break;

          case 24:
            return '!';
            break;

          case 25:
            return ',';
            break;

          case 26:
            return ':';
            break;

          case 27:
            return ';';
            break;

          case 28:
            return '%';
            break;

          case 29:
            return 34;
            break;

          case 30:
            return 34;
            break;

          case 31:
            yy_.yytext = yy_.yytext.substr(1, yy_.yyleng - 2).replace(/\"\"/g, '"');
            return 'STRING';
            break;

          case 32:
            yy_.yytext = yy_.yytext.substr(2, yy_.yyleng - 3).replace(/\"\"/g, '"');
            return 'SCOPE';
            break;

          case 33:
            yy_.yytext = yy_.yytext.substr(1, yy_.yyleng - 3).replace(/\"\"/g, '"');
            return 'SCOPE';
            break;

          case 34:
            yy_.yytext = yy_.yytext.slice(0, -1);
            return 'SCOPE';
            break;

          case 35:
            yy_.yytext = yy_.yytext.slice(1, -1);
            return 'SCOPE';
            break;

          case 36:
            return 21;
            break;

          case 37:
            return 5;
            break;

          case 38:
            return 'INVALID';
            break;
        }
      },
      rules: [/^(?:\s+)/, /^(?:[0-9]+(\.[0-9]+)?\b)/, /^(?:TRUE\b)/, /^(?:FALSE\b)/, /^(?:true\b)/, /^(?:false\b)/, /^(?:True\b)/, /^(?:False\b)/, /^(?:\*)/, /^(?:\/)/, /^(?:-)/, /^(?:\+)/, /^(?:&)/, /^(?:\^)/, /^(?:\()/, /^(?:\))/, /^(?:>=)/, /^(?:<=)/, /^(?:<>)/, /^(?:=)/, /^(?:>)/, /^(?:<)/, /^(?:\{)/, /^(?:\})/, /^(?:!)/, /^(?:,)/, /^(?::)/, /^(?:;)/, /^(?:%)/, /^(?:[A-Za-z](?=[(]))/, /^(?:[A-Za-z][A-Za-z0-9\.]+(?=[(]))/, /^(?:"(?:""|[^"])*")/, /^(?:\$'(?:''|[^'])*'!)/, /^(?:'(?:''|[^'])*'!)/, /^(?:((\[(.+?)\])[a-zA-Z]([a-zA-Z0-9_.$]+)?\!)|[a-zA-Z]([a-zA-Z0-9_.$]+)?\!)/, /^(?:\$([a-zA-Z])([a-zA-Z0-9_.$]+)?!)/, /^(?:([\[\]a-zA-Z0-9_.$^@\(]+))/, /^(?:$)/, /^(?:.)/],
      conditions: {
        INITIAL: {
          rules: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38],
          inclusive: true
        }
      }
    };
    return lexer;
  }();

  parser.lexer = lexer;

  function Parser() {
    this.yy = {};
  }

  Parser.prototype = parser;
  parser.Parser = Parser;
  return new Parser();
}();

/* harmony default export */ var functions_parser = (function () {
  return parser.parse.apply(parser, arguments);
});
// CONCATENATED MODULE: ./src/sheet/functions/isasyncfunction.js

// Copyright 2015-2018 FormBucket LLC
// ISFUNCTION returns true when `value` is a function.
function isasyncfunction(value) {
  return value && Object.prototype.toString.call(value) == '[object AsyncFunction]';
}
// CONCATENATED MODULE: ./src/sheet/functions/isfunction.js

// Copyright 2015-2018 FormBucket LLC
 // ISFUNCTION returns true when `value` is a function.

function isfunction(value) {
  return value && Object.prototype.toString.call(value) == '[object Function]' || isasyncfunction(value);
}
// CONCATENATED MODULE: ./src/sheet/functions/isnan.js


// Copyright 2015-2018 FormBucket LLC
// ISNA returns true when the value is `#NA!`
function isnan(value) {
  if (Number.isNaN) return Number.isNaN(value);
  return typeof value === 'number' && isNaN(value);
}
// CONCATENATED MODULE: ./src/sheet/functions/isfalsy.js
// Copyright 2015-2018 FormBucket LLC
 // Returns true when the value is a falsy value.
// https://developer.mozilla.org/en-US/docs/Glossary/Falsy

function isfalsy(value) {
  return value === false || value === 0 || value === '' || typeof value === 'undefined' || value === null || isnan(value);
}
// CONCATENATED MODULE: ./src/sheet/functions/istruthy.js
// Copyright 2015-2018 FormBucket LLC
 // Returns true when the value is not falsey
// https://developer.mozilla.org/en-US/docs/Glossary/Truthy

function istruthy(value) {
  return !isfalsy(value);
}
// CONCATENATED MODULE: ./src/sheet/functions/reduce.js


// Copyright 2015-2018 FormBucket LLC
// reduce an array to a value
function reduce(arr, func) {
  for (var _len = arguments.length, rest = new Array(_len > 2 ? _len - 2 : 0), _key = 2; _key < _len; _key++) {
    rest[_key - 2] = arguments[_key];
  }

  return arr.reduce.apply(arr, [func].concat(rest));
}
// CONCATENATED MODULE: ./src/sheet/functions/branch.js
// Copyright 2015-2018 FormBucket LLC


 // This function provides if-elseif-else.
// branch( test, result_if_true, [test2, result_if_true, default_result] ).

function branch() {
  for (var _len = arguments.length, cases = new Array(_len), _key = 0; _key < _len; _key++) {
    cases[_key] = arguments[_key];
  }

  var resolved = false; // Reduce all cases into a value.

  return reduce(cases, function (acc, item, index) {
    var val; // Return previously resolved result.

    if (resolved === true) return acc; // Handle default case.

    if (index === cases.length - 1) {
      // There is no last item.
      if (index % 2 === 1) return; // return the last item.

      return isfunction(item) ? item() : item;
    } // Check if condition is true.


    if (index % 2 === 0 && (isfunction(item) && istruthy(item()) || !isfunction(item) && istruthy(item))) {
      resolved = true;
      val = cases[index + 1];
      return isfunction(val) ? val() : val;
    }

    return acc;
  }, undefined);
}
// CONCATENATED MODULE: ./src/sheet/functions/istext.js
// Copyright 2015-2018 FormBucket LLC
// ISTEXT returns true when the value is a string.
function istext(value) {
  return 'string' === typeof value;
}
// CONCATENATED MODULE: ./src/sheet/functions/assign.js


// Copyright 2015-2018 FormBucket LLC
 // assign from https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/assign

function assign_assign(target) {
  // .length of function is 2
  'use strict';

  if (target == null) {
    return functions_error["a" /* ERRORTYPES */].nil;
  }

  var to = Object(target);

  for (var index = 1; index < arguments.length; index++) {
    var nextSource = arguments[index];

    if (nextSource != null) {
      // Skip over if undefined or null
      for (var nextKey in nextSource) {
        // Avoid bugs when hasOwnProperty is shadowed
        if (Object.prototype.hasOwnProperty.call(nextSource, nextKey)) {
          to[nextKey] = nextSource[nextKey];
        }
      }
    }
  }

  return to;
} // Ponyfill or Object.assign with empty initial object.


/* harmony default export */ var functions_assign = (function (initial) {
  var func = Object.assign || assign_assign;

  for (var _len = arguments.length, list = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
    list[_key - 1] = arguments[_key];
  }

  return func.apply(void 0, [{}, initial].concat(list));
});
// CONCATENATED MODULE: ./src/sheet/functions/walker_optimize.js










// Copyright 2015-2018 FormBucket LLC

/* eslint-disable*/





var isDateFunctions = ['DAY', 'MONTH', 'YEAR', 'DATE', 'DATEDIF'];
var isStringFunctions = ['CHAR', 'EXACT', 'LEFT', 'RIGHT', 'LEN', 'LOWER', 'UPPER', 'MID', 'PROPER', 'REPLACE', 'REPT', 'TRIM', 'CONCAT', 'IF', 'INLIST', 'STARTSWITH', 'ISNUMBER', 'ISUSCI'].concat(isDateFunctions);
var defaultConfig = {
  upCase: true,
  visit: function visit() {
    return undefined;
  },
  labelEQ: '=',
  labelNE: '<>',
  labelGT: '>',
  labelGTE: '>=',
  labelLT: '<',
  labelLTE: '<=',
  renderMINUS: function renderMINUS() {
    return '-';
  },
  renderPLUS: function renderPLUS() {
    return '+';
  },
  renderEQ: function renderEQ() {
    return ' = ';
  },
  renderNE: function renderNE() {
    return ' <> ';
  },
  renderGT: function renderGT() {
    return ' > ';
  },
  renderGTE: function renderGTE() {
    return ' >= ';
  },
  renderLT: function renderLT() {
    return ' < ';
  },
  renderLTE: function renderLTE() {
    return ' <= ';
  },
  renderADD: function renderADD() {
    return ' + ';
  },
  renderSUBTRACT: function renderSUBTRACT() {
    return ' - ';
  },
  renderMULTIPLY: function renderMULTIPLY() {
    return ' * ';
  },
  renderDIVIDE: function renderDIVIDE() {
    return ' / ';
  },
  renderPOWER: function renderPOWER() {
    return ' ^ ';
  },
  renderCONCAT: function renderCONCAT() {
    return ' & ';
  },
  renderGroupBegin: function renderGroupBegin() {
    return '(';
  },
  renderGroupEnd: function renderGroupEnd() {
    return ')';
  },
  renderGroup: function renderGroup(config, g, depth) {
    return "".concat(config.renderGroupBegin(config, g, depth)).concat(walk(config, g.exp, depth + 1)).concat(config.renderGroupEnd(config, g, depth));
  },
  renderRule: function renderRule(config, ast) {
    var depth = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;
    var varType = arguments.length > 3 ? arguments[3] : undefined;
    var type = ast.type;
    var renderGroup = config.renderGroup,
        renderFunction = config.renderFunction,
        renderOperator = config.renderOperator,
        renderVariable = config.renderVariable,
        renderValue = config.renderValue,
        renderRange = config.renderRange;
    config.visit(config, ast, depth);
    config.walk = walk;
    return branch(type === 'group', function () {
      return renderGroup(config, ast, depth);
    }, type === 'function', function () {
      return renderFunction(config, ast, depth);
    }, type === 'operator', function () {
      return renderOperator(config, ast, depth);
    }, type === 'variable', function () {
      return renderVariable(config, ast, depth, varType);
    }, type === 'value', function () {
      return renderValue(config, ast, config, depth);
    }, type === 'range', function () {
      return renderRange(config, ast, depth, varType);
    });
  },
  renderFunctionBegin: function renderFunctionBegin(config, f, depth) {
    return config.upCase ? f.name.toUpperCase() : f.name;
  },
  renderFunctionEnd: function renderFunctionEnd(config, f, depth) {
    return ')';
  },
  renderFunction: function renderFunction(config, f, depth) {
    return "".concat(config.renderFunctionBegin(config, f, depth), "(").concat(f.args.map(function (d) {
      return walk(config, d, depth + 1);
    }).join(', ')).concat(config.renderFunctionEnd(config, f, depth));
  },
  renderRangeBetween: function renderRangeBetween() {
    return ':';
  },
  renderRange: function renderRange(config, _ref, depth) {
    var topLeft = _ref.topLeft,
        bottomRight = _ref.bottomRight;
    return "".concat(walk(config, topLeft, depth)).concat(config.renderRangeBetween(config, {
      topLeft: topLeft,
      bottomRight: bottomRight
    }, depth)).concat(walk(config, bottomRight, depth));
  },
  renderVariable: function renderVariable(config, _ref2, depth) {
    var scope = _ref2.scope,
        name = _ref2.name;
    return "".concat(scope ? scope + '!' : '').concat(name);
  },
  renderString: function renderString(value) {
    return "\"".concat(value.replace(/\"/g, '""'), "\"");
  },
  renderNumber: function renderNumber(value) {
    return value.toString();
  },
  renderBoolean: function renderBoolean(value) {
    return value ? 'TRUE' : 'FALSE';
  },
  renderValue: function renderValue(config, _ref3, depth) {
    var subtype = _ref3.subtype,
        items = _ref3.items,
        value = _ref3.value;
    return branch(subtype === 'string', function () {
      return config.renderString(value);
    }, subtype === 'number', function () {
      return config.renderNumber(value);
    }, subtype === 'boolean', function () {
      return config.renderBoolean(value);
    }, subtype === 'array', function () {
      return "".concat(config.renderArray(config, {
        items: items
      }, depth));
    });
  },
  renderOperator: function renderOperator(config, _ref4, depth) {
    var subtype = _ref4.subtype,
        operands = _ref4.operands;
    return branch(operands.length == 1, function () {
      return "".concat(branch(subtype == 'prefix-minus', function () {
        return config.renderMINUS(config, depth);
      }, subtype == 'prefix-plus', function () {
        return config.renderPLUS(config, depth);
      })).concat(walk(config, operands[0], depth + 1));
    }, operands.length === 2, function () {
      return "".concat(walk(config, operands[0], depth + 1)).concat(branch(subtype == 'infix-eq', function () {
        return config.renderEQ(config, {
          operands: operands
        }, depth);
      }, subtype == 'infix-ne', function () {
        return config.renderNE(config, {
          operands: operands
        }, depth);
      }, subtype == 'infix-gt', function () {
        return config.renderGT(config, {
          operands: operands
        }, depth);
      }, subtype == 'infix-gte', function () {
        return config.renderGTE(config, {
          operands: operands
        }, depth);
      }, subtype == 'infix-lt', function () {
        return config.renderLT(config, {
          operands: operands
        }, depth);
      }, subtype == 'infix-lte', function () {
        return config.renderLTE(config, {
          operands: operands
        }, depth);
      }, subtype == 'infix-add', function () {
        return config.renderADD(config, {
          operands: operands
        }, depth);
      }, subtype == 'infix-subtract', function () {
        return config.renderSUBTRACT(config, {
          operands: operands
        }, depth);
      }, subtype == 'infix-multiply', function () {
        return config.renderMULTIPLY(config, {
          operands: operands
        }, depth);
      }, subtype == 'infix-divide', function () {
        return config.renderDIVIDE(config, {
          operands: operands
        }, depth);
      }, subtype == 'infix-power', function () {
        return config.renderPOWER(config, {
          operands: operands
        }, depth);
      }, subtype == 'infix-concat', function () {
        return config.renderCONCAT(config, {
          operands: operands
        }, depth);
      })).concat(walk(config, operands[1], depth + 1));
    });
  },
  renderArray: function renderArray(config, _ref5, depth) {
    var items = _ref5.items;
    return '{' + items.map(function (d) {
      return config.renderValue(config, d, depth + 1);
    }).join(',') + '}';
  }
};

function runFunc(name, config, _ref6, depth) {
  var operands = _ref6.operands,
      subtype = _ref6.subtype;
  return "".concat(name, "(").concat(walk(config, operands[0], depth + 1), ", ").concat(walk(config, operands[1], depth + 1), ")");
}

var fpConfig = functions_assign(defaultConfig, {
  renderOperator: function renderOperator(config, _ref7, depth) {
    var subtype = _ref7.subtype,
        operands = _ref7.operands;
    return branch(subtype == 'prefix-minus', function () {
      return "MINUS(".concat(walk(config, operands[0], depth + 1), ")");
    }, subtype == 'prefix-plus', function () {
      return "PLUS(".concat(walk(config, operands[0], depth + 1), ")");
    }, subtype == 'infix-eq', function () {
      return runFunc('EQ', config, {
        operands: operands,
        subtype: subtype
      }, depth);
    }, subtype == 'infix-ne', function () {
      return runFunc('NE', config, {
        operands: operands,
        subtype: subtype
      }, depth);
    }, subtype == 'infix-gt', function () {
      return runFunc('GT', config, {
        operands: operands,
        subtype: subtype
      }, depth);
    }, subtype == 'infix-gte', function () {
      return runFunc('GTE', config, {
        operands: operands,
        subtype: subtype
      }, depth);
    }, subtype == 'infix-lt', function () {
      return runFunc('LT', config, {
        operands: operands,
        subtype: subtype
      }, depth);
    }, subtype == 'infix-lte', function () {
      return runFunc('LTE', config, {
        operands: operands,
        subtype: subtype
      }, depth);
    }, subtype == 'infix-add', function () {
      return runFunc('ADD', config, {
        operands: operands,
        subtype: subtype
      }, depth);
    }, subtype == 'infix-subtract', function () {
      return runFunc('SUBTRACT', config, {
        operands: operands,
        subtype: subtype
      }, depth);
    }, subtype == 'infix-multiply', function () {
      return runFunc('MULTIPLY', config, {
        operands: operands,
        subtype: subtype
      }, depth);
    }, subtype == 'infix-divide', function () {
      return runFunc('DIVIDE', config, {
        operands: operands,
        subtype: subtype
      }, depth);
    }, subtype == 'infix-power', function () {
      return runFunc('POWER', config, {
        operands: operands,
        subtype: subtype
      }, depth);
    }, subtype == 'infix-concat', function () {
      return runFunc('CONCATENATE', config, {
        operands: operands,
        subtype: subtype
      }, depth);
    });
  },
  isGenType: function isGenType(depth, varType) {
    return depth == 0 || varType != 'number';
  }
});
var jsConfig = functions_assign(fpConfig, {
  renderVariable: function renderVariable(config, v, depth, varType) {
    if (varType === 'numberTs') {
      //强转数字
      return v.scope ? "context.toNumber(context.get(\"".concat(v.name, "\",  \"").concat(v.scope, "\"))") : "context.toNumber(context.get(\"".concat(v.name, "\"))");
    }

    if (varType === 'string') {
      //空时为‘’
      return v.scope ? "context.getString(\"".concat(v.name, "\",  \"").concat(v.scope, "\")") : "context.getString(\"".concat(v.name, "\")");
    }

    if (fpConfig.isGenType(depth, varType) || varType === 'general') {
      //不被外层函数引导，直接取值
      return v.scope ? "context.get(\"".concat(v.name, "\", \"").concat(v.scope, "\")") : "context.get(\"".concat(v.name, "\")");
    }

    return v.scope ? "context.parseNumber(context.get(\"".concat(v.name, "\",  \"").concat(v.scope, "\"))") : "context.parseNumber(context.get(\"".concat(v.name, "\"))");
  },
  renderRange: function renderRange(config, v, depth, varType) {
    var arr = rangeToRefs(v.topLeft.name, v.bottomRight.name);
    var formatString = arr.map(function (item) {
      return v.topLeft.scope ? "context.get(\"".concat(item, "\", \"").concat(v.topLeft.scope, "\")") : config.renderVariable(config, {
        scope: v.topLeft.scope,
        name: item
      }, depth, varType);
    });
    return formatString;
  },
  renderFunction: function renderFunction(config, f, depth) {
    var varType = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 'number';

    if (['SUM'].includes(f.name)) {
      varType = 'numberTs';
    }

    if (isStringFunctions.includes(f.name)) {
      varType = 'string';
    }

    if (['EQ', 'NE', 'GT', 'GTE', 'LT', 'LTE', 'ISNUMBER', 'ISNULL', 'ISDIGIT'].includes(f.name)) {
      varType = 'general';
    }

    return "".concat(config.renderFunctionBegin(config, f, depth), "(").concat(f.args.map(function (d) {
      return walk(config, d, depth + 1, varType);
    }).join(', ')).concat(config.renderFunctionEnd(config, f, depth));
  },
  renderFunctionBegin: function renderFunctionBegin(config, f) {
    return "Formula.".concat(fpConfig.renderFunctionBegin(config, f));
  },
  renderArray: function renderArray(config, items, depth) {
    return '[' + items.map(function (d) {
      return config.walk(config, d, depth + 1);
    }) + ']';
  },
  renderValue: function renderValue(config, _ref8, depth) {
    var subtype = _ref8.subtype,
        items = _ref8.items,
        value = _ref8.value;
    return branch(subtype === 'string', function () {
      return '"' + value.replace(/\"/g, '\\"') + '"';
    }, subtype === 'number', function () {
      return "".concat(value);
    }, subtype === 'boolean', function () {
      return value ? 'true' : 'false';
    }, subtype === 'array', function () {
      return config.renderArray(config, items, depth);
    });
  }
});

function walk(config, astOrExp) {
  var depth = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;
  var varType = arguments.length > 3 ? arguments[3] : undefined;
  var ast = astOrExp;

  if (!ast) {
    return;
  }

  if (istext(astOrExp)) {
    ast = functions_parser(astOrExp);
  }

  return config.renderRule(config, ast, depth, varType);
} // return builder


/* harmony default export */ var walker_optimize = (function () {
  var config = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : defaultConfig;
  return function (ast) {
    return walk(config, ast);
  };
});
// CONCATENATED MODULE: ./src/sheet/functions/unique.js
// Copyright 2015-2018 FormBucket LLC
 // UNIQUE reduces an `array` into an array without duplicate values.

function unique(array) {
  return reduce(array, function (p, c) {
    if (p.indexOf(c) < 0) p.push(c);
    return p;
  }, []);
}
// CONCATENATED MODULE: ./src/sheet/functions/compile.js



// Copyright 2015-2018 FormBucket LLC




var compiledNumber = 0;
function compile(exp) {
  var ast = exp,
      f,
      precedents = [],
      requires = []; // convert to AST when string provided

  if (typeof ast === 'string') {
    ast = functions_parser(exp);
  }

  var walk1 = walker_optimize(fpConfig);
  var walk2 = walker_optimize(functions_assign(jsConfig, {
    visit: function visit(config, node) {
      if (node.type === 'variable') {
        precedents.push(node);
      }

      if (node.type === 'function') {
        requires.push(node.name);
      }
    }
  })); // Walk the AST and convert operators to functions.

  var fpExp = walk1(ast); // Walk result and convert to JSCode.

  var code = walk2(fpExp);
  var id = compiledNumber++;
  precedents = unique(precedents.map(JSON.stringify)).map(JSON.parse);
  requires = unique(requires.map(JSON.stringify)).map(JSON.parse);
  f = new Function('context', 'Formula', "return ".concat(code, ";"));
  f.id = id;
  f.exp = exp;
  f.exp = fpExp;
  f.exp = exp;
  f.ast = ast;
  f.code = code;
  f.precedents = precedents;
  f.requires = requires;
  return f;
}
// EXTERNAL MODULE: ./node_modules/core-js/modules/es.number.is-finite.js
var es_number_is_finite = __webpack_require__("f00c");

// CONCATENATED MODULE: ./src/sheet/functions/tryToNumber.js










function isNumber(val) {
  if (val == null) {
    return false;
  }

  if (typeof val === 'number' && Number.isFinite(val) && !Number.isNaN(val)) {
    return true;
  }

  return false;
}

function tryToNumber() {
  var val = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;
  var bool = false;

  if (val.toString().includes('E') && val.toString().match(/^-?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i)) {
    bool = true;
  }

  if (val.toString().match(/^-?(0\.\d+|[0-9]+\.\d+|[1-9]\d{0,50}|[0-9])$/) || isNumber(val)) {
    bool = true;
  }

  return bool;
}
// CONCATENATED MODULE: ./src/sheet/functions/toNumber.js

/* eslint-disable*/

var toNumber_toNumber = function toNumber(val) {
  if (tryToNumber(val)) {
    return val * 1;
  } else {
    return 0;
  }
};

/* harmony default export */ var functions_toNumber = (toNumber_toNumber);
// CONCATENATED MODULE: ./src/sheet/functions/toString.js
var toString_toString = function toString(val) {
  return typeof val !== 'string' ? "".concat(val) : val;
};

/* harmony default export */ var functions_toString = (toString_toString);
// CONCATENATED MODULE: ./src/sheet/functions/run.js


// Copyright 2015-2018 FormBucket LLC

/* eslint-disable*/







 // m is a cache of compiled expressions.

var m = {}; // Execute a formula expression

function run(exp) {
  var params = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
  // if the exp is a function then return it immediately.
  var locals = functions_assign({}, params);

  var getParam = function getParam(name, scope) {
    var value = null;

    if (istext(scope)) {
      if (/\s*(\[(.+?)\])\s*/g.test(scope)) {
        var _locals$;

        value = (_locals$ = locals["'".concat(scope, "'")]) === null || _locals$ === void 0 ? void 0 : _locals$[name];
      } else {
        value = locals[scope] ? locals[scope][name] : null;
      }
    } else {
      value = locals[name];
    }

    return value;
  }; // Default get for plain object.


  if (locals.get !== 'function') {
    locals.get = function (name, scope) {
      var value = getParam(name, scope);
      return value === null ? 0 : value;
    };

    locals.getString = function (name, scope) {
      var value = getParam(name, scope);
      var val = value !== null && value !== void 0 ? value : '';
      return functions_toString(val);
    };

    locals.parseNumber = function (val) {
      return val * 1;
    };

    locals.toNumber = functions_toNumber;
  }

  if (isfunction(exp)) return exp(locals, functions_functions_namespaceObject);else if (!istext(exp)) return functions_error["a" /* ERRORTYPES */].na; // check cached and shortcut if appropriate.

  if (m.hasOwnProperty(exp)) {
    // reload the compiled function.
    compiled = m[exp];
  } else {
    // compile the expression.
    var compiled = compile(exp); // cache the compiled function.

    m[exp] = compiled;
  }

  return compiled(locals, functions_functions_namespaceObject);
}
// CONCATENATED MODULE: ./src/sheet/functions/choose.js
// Copyright 2015-2018 FormBucket LLC
 // CHOOSE accepts an index and a list of items. It returns the item that corresponds to the index.

function choose(index) {
  // Return `#NA!` if index or items are not provided.
  if (!index || (arguments.length <= 1 ? 0 : arguments.length - 1) === 0) {
    return functions_error["a" /* ERRORTYPES */].na;
  } // Return `#VALUE!` if index is less than 1 or greater than 254.


  if (index < 1 || index > 254) {
    return functions_error["a" /* ERRORTYPES */].value;
  } // Return `#VALUE!` if number of items is less than index.


  if ((arguments.length <= 1 ? 0 : arguments.length - 1) < index) {
    return functions_error["a" /* ERRORTYPES */].value;
  } // Return the item.


  return index - 1 + 1 < 1 || arguments.length <= index - 1 + 1 ? undefined : arguments[index - 1 + 1];
}
// CONCATENATED MODULE: ./src/sheet/functions/eq.js
// Copyright 2015-2018 FormBucket LLC
// EQ compares two values and returns a boolean value.
function eq(a, b) {
  if (typeof a === 'string' && typeof b === 'string') {
    // String comparisions are case-insensitive when both are string values.
    return a.toLowerCase() === b.toLowerCase();
  } else {
    // Strict equivalence as the default when non-string values are present.
    return a == b;
  }
}
// CONCATENATED MODULE: ./src/sheet/functions/switch.js
// Copyright 2015-2018 FormBucket LLC

 // Search the odd args and return even value when odd arg equals targetValue.

function SWITCH(targetValue) {
  var _ref;

  var result;
  var argc = arguments.length <= 1 ? 0 : arguments.length - 1;
  var switchCount = Math.floor(argc / 2);
  var defaultClause = argc % 2 === 0 ? null : (_ref = (arguments.length <= 1 ? 0 : arguments.length - 1) - 1 + 1, _ref < 1 || arguments.length <= _ref ? undefined : arguments[_ref]);

  if (switchCount) {
    for (var index = 0; index < switchCount; index++) {
      if (eq(targetValue, index * 2 + 1 < 1 || arguments.length <= index * 2 + 1 ? undefined : arguments[index * 2 + 1])) {
        result = index * 2 + 1 + 1 < 1 || arguments.length <= index * 2 + 1 + 1 ? undefined : arguments[index * 2 + 1 + 1];
        return result;
      }
    }
  }

  return defaultClause || functions_error["a" /* ERRORTYPES */].na;
}
// CONCATENATED MODULE: ./src/sheet/functions/iserror.js
// Copyright 2015-2018 FormBucket LLC

 // ISERROR returns true when any of the values is an error.

function iserror() {
  for (var _len = arguments.length, values = new Array(_len), _key = 0; _key < _len; _key++) {
    values[_key] = arguments[_key];
  }

  return reduce(values, function (p, v) {
    return p === true ? true : v instanceof Error;
  }, false);
}
// CONCATENATED MODULE: ./src/sheet/functions/isnumber.js
// Copyright 2015-2018 FormBucket LLC
// Returns true when the value is a finite number.
function isnumber(value) {
  return typeof value === 'number' && !isNaN(value) && isFinite(value);
}
// CONCATENATED MODULE: ./src/sheet/functions/and.js
// Copyright 2015-2018 FormBucket LLC




 // AND reduces list of truthy values into true or false value.

function and() {
  for (var _len = arguments.length, criteria = new Array(_len), _key = 0; _key < _len; _key++) {
    criteria[_key] = arguments[_key];
  }

  // Reduce criteria into boolean value.
  return reduce(criteria, function (acc, item) {
    // Once an error, always an error.
    if (iserror(acc)) return acc; // Once `false` or #error! is found always return previously value.

    if (acc === 0 || acc === false) return false; // find the value if a literal or deferred value.

    var val = isfunction(item) ? item() : item; //string return  `#VALUE!`

    if (!(val === true || val === false || isnumber(val))) {
      return functions_error["a" /* ERRORTYPES */].value;
    }

    return !!val;
  }, undefined);
}
// CONCATENATED MODULE: ./src/sheet/functions/not.js
// Copyright 2015-2018 FormBucket LLC
 // NOT negates a `value`

function not(value) {
  return value !== true && value !== false && value !== 1 && value !== 0 ? functions_error["a" /* ERRORTYPES */].value : !value;
}
// CONCATENATED MODULE: ./src/sheet/functions/nand.js
// Copyright 2015-2018 FormBucket LLC

 // Returns the composition of NOT(AND(...))

function nand() {
  return not(and.apply(void 0, arguments));
}
// CONCATENATED MODULE: ./src/sheet/functions/or.js
// Copyright 2015-2018 FormBucket LLC



 // Returns true when any of the criteria are true or 1, defaults to false.

function or() {
  for (var _len = arguments.length, criteria = new Array(_len), _key = 0; _key < _len; _key++) {
    criteria[_key] = arguments[_key];
  }

  return reduce(criteria, function (acc, item) {
    // If accumulator is already true then it's still true.
    if (acc === true) return true; // Determine the value by resolving thunks if needed.

    var value = isfunction(item) ? item() : item; //string return  `#VALUE!`

    if (!(value === true || value === false || isnumber(value))) {
      return functions_error["a" /* ERRORTYPES */].value;
    } // Return true when value is true or 1.


    return !!value;
  }, false);
}
// CONCATENATED MODULE: ./src/sheet/functions/nor.js
// Copyright 2015-2018 FormBucket LLC


function nor() {
  return not(or.apply(void 0, arguments));
}
// CONCATENATED MODULE: ./src/sheet/functions/isarray.js

// Copyright 2015-2018 FormBucket LLC
// ISARRAY returns true when the value is an array.
function isarray(value) {
  return Object.prototype.toString.call(value) === '[object Array]';
}
// CONCATENATED MODULE: ./src/sheet/functions/flatten.js

// Copyright 2015-2018 FormBucket LLC


 // FLATTEN converts a nested array into a flattened array.

function flatten(ref) {
  if (!isarray(ref)) {
    return functions_error["a" /* ERRORTYPES */].value;
  }

  return reduce(ref, function (a, b) {
    return a.concat(b);
  }, []);
}
// CONCATENATED MODULE: ./src/sheet/functions/xor.js
// Copyright 2015-2018 FormBucket LLC

 // XOR computes the exclusive or for a given set of `values`.

function xor() {
  for (var _len = arguments.length, values = new Array(_len), _key = 0; _key < _len; _key++) {
    values[_key] = arguments[_key];
  }

  return !!(reduce(flatten(values), function (a, b) {
    if (b) {
      return a + 1;
    }

    return a;
  }, 0) & 1);
}
// CONCATENATED MODULE: ./src/sheet/functions/ne.js
// Copyright 2015-2018 FormBucket LLC
 // NE returns true when a is not equal to b.

function ne(a, b) {
  return !eq(a, b);
}
// CONCATENATED MODULE: ./src/sheet/functions/isblank.js
// Copyright 2015-2018 FormBucket LLC
// ISBLANK returns true when the value is undefined or null.
function isblank(value) {
  return typeof value === 'undefined' || value === null;
}
// CONCATENATED MODULE: ./src/sheet/functions/isref.js
// Copyright 2015-2018 FormBucket LLC
 // ISREF returns true when the value is a reference.

function isref(value) {
  if (!value) return false;
  return value._isref === true;
}
// CONCATENATED MODULE: ./src/sheet/functions/map.js

// Copyright 2015-2018 FormBucket LLC
// map an array to a new array
function map(array, func) {
  return array.map(func);
}
// CONCATENATED MODULE: ./src/sheet/functions/getVal.js

/* eslint-disable*/

var getVal_getVal = function getVal(val) {
  if (tryToNumber(val)) {
    return val * 1;
  } else {
    return val;
  }
};

/* harmony default export */ var functions_getVal = (getVal_getVal);
// CONCATENATED MODULE: ./src/sheet/functions/gt.js
// Copyright 2015-2018 FormBucket LLC





function gt(a, b) {
  if (isref(a) && isref(b)) {
    return functions_error["a" /* ERRORTYPES */].na;
  } else if (isarray(a) && isarray(b)) {
    return functions_error["a" /* ERRORTYPES */].na;
  } else if (isref(a) || isarray(a)) {
    return map(a, function (d) {
      return d > b;
    });
  } else if (isref(b) || isarray(b)) {
    return map(a, function (d) {
      return d > a;
    });
  } else {
    return functions_getVal(a) > functions_getVal(b);
  }
}
// CONCATENATED MODULE: ./src/sheet/functions/gte.js
// Copyright 2015-2018 FormBucket LLC




function gte(a, b) {
  if (isref(a) && isref(b)) {
    return error.na;
  } else if (isarray(a) && isarray(b)) {
    return error.na;
  } else if (isref(a) || isarray(a)) {
    return map(a, function (d) {
      return d >= b;
    });
  } else if (isref(b) || isarray(b)) {
    return map(a, function (d) {
      return d >= a;
    });
  } else {
    return functions_getVal(a) >= functions_getVal(b);
  }
}
// CONCATENATED MODULE: ./src/sheet/functions/lt.js
// Copyright 2015-2018 FormBucket LLC



 // LT compares two values and returns true when a is less than b.

function lt(a, b) {
  if (isref(a) && isref(b)) {
    return error.na;
  } else if (isarray(a) && isarray(b)) {
    return error.na;
  } else if (isref(a) || isarray(a)) {
    return map(a, function (d) {
      return d < b;
    });
  } else if (isref(b) || isarray(b)) {
    return map(a, function (d) {
      return d < a;
    });
  } else {
    return functions_getVal(a) < functions_getVal(b);
  }
}
// CONCATENATED MODULE: ./src/sheet/functions/lte.js
// Copyright 2015-2018 FormBucket LLC



 // LT compares two values and returns true when a is less than or equal to b.

function lte(a, b) {
  if (isref(a) && isref(b)) {
    return error.na;
  } else if (isarray(a) && isarray(b)) {
    return error.na;
  } else if (isref(a) || isarray(a)) {
    return map(a, function (d) {
      return d <= b;
    });
  } else if (isref(b) || isarray(b)) {
    return map(a, function (d) {
      return d <= a;
    });
  } else {
    return functions_getVal(a) <= functions_getVal(b);
  }
}
// CONCATENATED MODULE: ./src/sheet/functions/identity.js
function identity(x) {
  return x;
}
// CONCATENATED MODULE: ./src/sheet/functions/ifblank.js
// Copyright 2015-2018 FormBucket LLC
 // IFBLANK return the `value` if non-blank, otherwise it returns `value_if_blank`.

function ifblank(value, value_if_blank) {
  return isblank(value) ? value_if_blank : value;
}
// CONCATENATED MODULE: ./src/sheet/functions/isempty.js
// Copyright 2015-2018 FormBucket LLC


 // ISEMPTY returns true when the value is blank, is an empty array or when it
// is an empty string.

function isempty(value) {
  return isblank(value) || isarray(value) && value.length === 0 || istext(value) && value === '';
}
// CONCATENATED MODULE: ./src/sheet/functions/ifempty.js
// Copyright 2015-2018 FormBucket LLC
 // IFBLANK return the `value` if empty, otherwise it returns `value_if_empty`.

function ifempty(value, value_if_empty) {
  return isempty(value) ? value_if_empty : value;
}
// CONCATENATED MODULE: ./src/sheet/functions/iferror.js
// Copyright 2015-2018 FormBucket LLC
 // IFBLANK return the `value` if error, otherwise it returns `value_if_error`.

function iferror(value) {
  var value_if_error = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;
  return iserror(value) ? value_if_error : value;
}
// CONCATENATED MODULE: ./src/sheet/functions/ifna.js
// Copyright 2015-2018 FormBucket LLC
 // IFBLANK return the `value` if `#NA!`, otherwise it returns `value_if_na`.

function ifna(value, value_if_na) {
  return value === functions_error["a" /* ERRORTYPES */].na ? value_if_na : value;
}
// CONCATENATED MODULE: ./src/sheet/functions/isboolean.js
// Copyright 2015-2018 FormBucket LLC
// returns true if true or false
function isboolean(val) {
  return val === true || val === false;
}
// CONCATENATED MODULE: ./src/sheet/functions/isdate.js

// Copyright 2015-2018 FormBucket LLC
// ISDATE returns true when the `value` is a JavaScript date object.
function isdate(value) {
  return value && Object.prototype.toString.call(value) == '[object Date]';
}
// CONCATENATED MODULE: ./src/sheet/functions/isemail.js


// Copyright 2015-2018 FormBucket LLC
// ISEMAIL returns true when the `value` matches the regex.
function isemail(value) {
  // credit to http://stackoverflow.com/questions/46155/validate-email-address-in-javascript
  var re = /^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
  return re.test(value);
}
// CONCATENATED MODULE: ./src/sheet/functions/iseven.js
// Copyright 2015-2018 FormBucket LLC
// ISEVEN returns true when the value is even.
function iseven(value) {
  return !(Math.floor(Math.abs(value)) & 1);
}
// CONCATENATED MODULE: ./src/sheet/functions/constants.js
// Copyright 2015-2018 FormBucket LLC
// Shared constants
var d1900 = new Date(1900, 0, 1),
    JulianOffset = 2415019,
    MinutesInHour = 60,
    MinutesInDay = 1440,
    SecondsInMinute = 60,
    SecondsInHour = 3600,
    SecondsInDay = 86400,
    DaysInYear = 365.25,
    MilliSecondsInDay = 86400000,
    AllowedDates = {
  H: 'h]',
  M: 'm]',
  MM: 'mm]',
  S: 's]',
  SS: 'ss]'
},
    DayNames = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'],
    DayNames3 = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'],
    MonthNames = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'],
    MonthNames3 = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
    AM = 'AM',
    AM1 = 'A',
    PM = 'PM',
    PM1 = 'P',
    // Circle Constants
τ = 6.28318530717958,
    // http://tauday.com/tau-manifesto
pi = 3.14159265358979,
    // Address System Constants
MaxCols = 16384,
    // 14 bits, 2^14
MaxRows = 1048576,
    // 20 bits, 2^20
// Formatting Constants
SeparatorChar = ',',
    DecimalChar = '.',
    DefaultCurrency = '$',
    // the currency string used if none specified
AllowedColors = {
  BLACK: '#000000',
  BLUE: '#0000FF',
  CYAN: '#00FFFF',
  GREEN: '#00FF00',
  MAGENTA: '#FF00FF',
  RED: '#FF0000',
  WHITE: '#FFFFFF',
  YELLOW: '#FFFF00'
};
// CONCATENATED MODULE: ./src/sheet/functions/parsedate.js
// Copyright 2015-2018 FormBucket LLC



 // PARSEDATE converts a value into a Date object.

function parsedate(val) {
  /* *******************
  Extracted from Social Calc
   convert_date_julian_to_gregorian(juliandate)
   ymd->{}
  .year
  .month
  .day
   From: http://aa.usno.navy.mil/faq/docs/JD_Formula.html
  Uses: Fliegel, H. F. and van Flandern, T. C. (1968). Communications of the ACM, Vol. 11, No. 10 (October, 1968).
  Translated from the FORTRAN
   ************************* */
  function convert_date_julian_to_gregorian(juliandate) {
    var L, N, I, J, K;
    L = juliandate + 68569;
    N = Math.floor(4 * L / 146097);
    L = L - Math.floor((146097 * N + 3) / 4);
    I = Math.floor(4000 * (L + 1) / 1461001);
    L = L - Math.floor(1461 * I / 4) + 31;
    J = Math.floor(80 * L / 2447);
    K = L - Math.floor(2447 * J / 80);
    L = Math.floor(J / 11);
    J = J + 2 - 12 * L;
    I = 100 * (N - 49) + I + L;
    return new Date(I, J - 1, K);
  }

  if (val instanceof Error) {
    return val;
  } else if (isdate(val)) {
    return val;
  } else if (typeof val === 'number') {
    // val is assumed to be serial number.
    return convert_date_julian_to_gregorian(Math.floor(val + JulianOffset));
  } else if (typeof val === 'string') {
    var timestamp = Date.parse(val);

    if (isnan(timestamp)) {
      return functions_error["a" /* ERRORTYPES */].value;
    }

    return new Date(timestamp);
  }

  return functions_error["a" /* ERRORTYPES */].value;
}
// CONCATENATED MODULE: ./src/sheet/functions/isleapyear.js
// Copyright 2015-2018 FormBucket LLC

function isleapyear(val) {
  var date = parsedate(val);
  var year = date.getFullYear();
  return year % 4 === 0 && year % 100 !== 0 || year % 400 === 0;
}
// CONCATENATED MODULE: ./src/sheet/functions/islowercase.js
// Copyright 2015-2018 FormBucket LLC
var aCode = 97;
var zCode = 122;

function isLowerCaseChar(ch) {
  var chCode = ch.charCodeAt();
  return chCode >= aCode && chCode <= zCode;
}

function islowercase(str) {
  for (var i in str) {
    if (!isLowerCaseChar(str[i])) return false;
  }

  return true;
}
// CONCATENATED MODULE: ./node_modules/@babel/runtime/helpers/esm/typeof.js







function _typeof(obj) {
  "@babel/helpers - typeof";

  if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") {
    _typeof = function _typeof(obj) {
      return typeof obj;
    };
  } else {
    _typeof = function _typeof(obj) {
      return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj;
    };
  }

  return _typeof(obj);
}
// CONCATENATED MODULE: ./src/sheet/functions/isobject.js

// Copyright 2015-2018 FormBucket LLC
// isobject returns true when `value` is an object or function.
function isobject(value) {
  var type = _typeof(value);

  return !!value && (type == 'object' || type == 'function');
}
// CONCATENATED MODULE: ./src/sheet/functions/isna.js
// Copyright 2015-2018 FormBucket LLC
 // ISNA returns true when the value is `#NA!`

function isna(value) {
  return value === functions_error["a" /* ERRORTYPES */].na;
}
// CONCATENATED MODULE: ./src/sheet/functions/isDigit.js

/* eslint-disable*/

var isDigit_isDigit = function isDigit(val) {
  if (val === undefined) {
    return false;
  }

  return tryToNumber(val);
};

/* harmony default export */ var functions_isDigit = (isDigit_isDigit);
// CONCATENATED MODULE: ./src/sheet/functions/isodd.js
// Copyright 2015-2018 FormBucket LLC
// ISODD returns true when the value is odd.
function isodd(value) {
  return !!(Math.floor(Math.abs(value)) & 1);
}
// CONCATENATED MODULE: ./src/sheet/functions/isoweeknum.js
// Copyright 2015-2018 FormBucket LLC


function isoweeknum(date) {
  date = parsedate(date);

  if (date instanceof Error) {
    return date;
  }

  date.setHours(0, 0, 0);
  date.setDate(date.getDate() + 4 - (date.getDay() || 7));
  var yearStart = new Date(date.getFullYear(), 0, 1);
  return Math.ceil(((date - yearStart) / MilliSecondsInDay + 1) / 7);
}
// CONCATENATED MODULE: ./src/sheet/functions/ispromise.js

function ispromise(value) {
  return value && _typeof(value) === 'object' && typeof value.then === 'function';
}
// CONCATENATED MODULE: ./src/sheet/functions/isuppercase.js
// Copyright 2015-2018 FormBucket LLC
var ACode = 65;
var ZCode = 90;

function isUpperCaseChar(ch) {
  var chCode = ch.charCodeAt();
  return chCode >= ACode && chCode <= ZCode;
}

function isuppercase(str) {
  for (var i in str) {
    if (!isUpperCaseChar(str[i])) return false;
  }

  return true;
}
// CONCATENATED MODULE: ./src/sheet/functions/isurl.js






// Copyright 2015-2018 FormBucket LLC
// ISURL returns true when the value matches the regex for a uniform resource locator.
function isurl(str) {
  // credit: http://stackoverflow.com/questions/5717093/check-if-a-javascript-string-is-an-url
  var pattern = new RegExp('^(https?:\\/\\/)?' + // protocol
  '((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.?)+[a-z]{2,}|' + // domain name
  '((\\d{1,3}\\.){3}\\d{1,3}))' + // OR ip (v4) address
  '(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*' + // port and path
  '(\\?[;&a-z\\d%_.~+=-]*)?' + // query string
  '(\\#[-a-z\\d_]*)?$', 'i'); // fragment locator

  return pattern.test(str);
}
// CONCATENATED MODULE: ./src/sheet/functions/iswholenumber.js
// Copyright 2015-2018 FormBucket LLC
 // Returns true when the value is a whole number

function iswholenumber(value) {
  return isnumber(value) && value % 1 === 0;
}
// CONCATENATED MODULE: ./src/sheet/functions/split.js


// Copyright 2015-2018 FormBucket LLC
// SPLIT `text` given a `delimiter`.
function split(text, delimiter) {
  return text.split(delimiter);
}
// CONCATENATED MODULE: ./src/sheet/functions/code.js
// Copyright 2015-2018 FormBucket LLC
 // CODE accepts text and optionally index (default 1) returning the character code.

function code_code() {
  var text = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';
  var index = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;
  if (index < 1) return functions_error["a" /* ERRORTYPES */].na;
  if (text.length < index) return functions_error["a" /* ERRORTYPES */].value;
  return text.charCodeAt(index - 1);
}
// CONCATENATED MODULE: ./src/sheet/functions/numbervalue.js


// Copyright 2015-2018 FormBucket LLC








/* eslint-disable*/
// Convert a text value into a number value.

function numbervalue(text) {
  var decimal_separator = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '.';
  var group_separator = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : ',';

  // Return error when text is error
  if (iserror(text)) {
    return text;
  }

  if (isarray(text)) {
    return text.join(',');
  } // Return `#VALUE!` when text is empty


  if (isempty(text)) {
    return functions_error["a" /* ERRORTYPES */].value;
  } // Return the value when it is already a number.


  if (isnumber(text)) {
    return text;
  }

  var foundDecimal = false,
      len = text.length - 1;

  if (text.length === 1) {
    if (code_code(text, 0) < 48 || code_code(text, 0) > 57) {
      return functions_error["a" /* ERRORTYPES */].value;
    }

    return +text;
  }

  return reduce(split(text, ''), function (acc, item, index) {
    if (acc === functions_error["a" /* ERRORTYPES */].value) {
      return functions_error["a" /* ERRORTYPES */].value;
    } else if (len === index) {
      if (item === '%') {
        return +acc / 100;
      }

      return +acc.concat(item);
    } else if (item === decimal_separator) {
      if (foundDecimal) return functions_error["a" /* ERRORTYPES */].value;
      foundDecimal = true;
      return acc.concat('.');
    } else if (item === group_separator) {
      return acc; // check if between 0 and 9 ascii codes
    } else if (item.charCodeAt(0) < 48 || item.charCodeAt(0) > 57) {
      return functions_error["a" /* ERRORTYPES */].value;
    }

    return acc.concat(item);
  });
}
// CONCATENATED MODULE: ./src/sheet/functions/minus.js
// Copyright 2015-2018 FormBucket LLC


 // Invert a value.

function minus(value) {
  // type casting.
  var val = numbervalue(value); // Return `#VALUE!` if either val is not a number.

  if (!isnumber(val)) {
    return functions_error["a" /* ERRORTYPES */].value;
  } // Return the number value.


  return -val;
}
// CONCATENATED MODULE: ./src/sheet/functions/plus.js
// Copyright 2015-2018 FormBucket LLC


 // Convert a value into a number.

function plus(value) {
  // type casting.
  var val = numbervalue(value); // Return `#VALUE!` if either val is not a number.

  if (!isnumber(val)) {
    return functions_error["a" /* ERRORTYPES */].value;
  } // Return the number value.


  return val;
}
// CONCATENATED MODULE: ./node_modules/number-precision/build/index.es.js
/**
 * @desc 解决浮动运算问题，避免小数点后产生多位数和计算精度损失。
 * 问题示例：2.3 + 2.4 = 4.699999999999999，1.0 - 0.9 = 0.09999999999999998
 */
/**
 * 把错误的数据转正
 * strip(0.09999999999999998)=0.1
 */
function strip(num, precision) {
    if (precision === void 0) { precision = 15; }
    return +parseFloat(Number(num).toPrecision(precision));
}
/**
 * Return digits length of a number
 * @param {*number} num Input number
 */
function digitLength(num) {
    // Get digit length of e
    var eSplit = num.toString().split(/[eE]/);
    var len = (eSplit[0].split('.')[1] || '').length - +(eSplit[1] || 0);
    return len > 0 ? len : 0;
}
/**
 * 把小数转成整数，支持科学计数法。如果是小数则放大成整数
 * @param {*number} num 输入数
 */
function float2Fixed(num) {
    if (num.toString().indexOf('e') === -1) {
        return Number(num.toString().replace('.', ''));
    }
    var dLen = digitLength(num);
    return dLen > 0 ? strip(Number(num) * Math.pow(10, dLen)) : Number(num);
}
/**
 * 检测数字是否越界，如果越界给出提示
 * @param {*number} num 输入数
 */
function checkBoundary(num) {
    if (_boundaryCheckingState) {
        if (num > Number.MAX_SAFE_INTEGER || num < Number.MIN_SAFE_INTEGER) {
            console.warn(num + " is beyond boundary when transfer to integer, the results may not be accurate");
        }
    }
}
/**
 * 迭代操作
 */
function iteratorOperation(arr, operation) {
    var num1 = arr[0], num2 = arr[1], others = arr.slice(2);
    var res = operation(num1, num2);
    others.forEach(function (num) {
        res = operation(res, num);
    });
    return res;
}
/**
 * 精确乘法
 */
function times() {
    var nums = [];
    for (var _i = 0; _i < arguments.length; _i++) {
        nums[_i] = arguments[_i];
    }
    if (nums.length > 2) {
        return iteratorOperation(nums, times);
    }
    var num1 = nums[0], num2 = nums[1];
    var num1Changed = float2Fixed(num1);
    var num2Changed = float2Fixed(num2);
    var baseNum = digitLength(num1) + digitLength(num2);
    var leftValue = num1Changed * num2Changed;
    checkBoundary(leftValue);
    return leftValue / Math.pow(10, baseNum);
}
/**
 * 精确加法
 */
function index_es_plus() {
    var nums = [];
    for (var _i = 0; _i < arguments.length; _i++) {
        nums[_i] = arguments[_i];
    }
    if (nums.length > 2) {
        return iteratorOperation(nums, index_es_plus);
    }
    var num1 = nums[0], num2 = nums[1];
    // 取最大的小数位
    var baseNum = Math.pow(10, Math.max(digitLength(num1), digitLength(num2)));
    // 把小数都转为整数然后再计算
    return (times(num1, baseNum) + times(num2, baseNum)) / baseNum;
}
/**
 * 精确减法
 */
function index_es_minus() {
    var nums = [];
    for (var _i = 0; _i < arguments.length; _i++) {
        nums[_i] = arguments[_i];
    }
    if (nums.length > 2) {
        return iteratorOperation(nums, index_es_minus);
    }
    var num1 = nums[0], num2 = nums[1];
    var baseNum = Math.pow(10, Math.max(digitLength(num1), digitLength(num2)));
    return (times(num1, baseNum) - times(num2, baseNum)) / baseNum;
}
/**
 * 精确除法
 */
function divide() {
    var nums = [];
    for (var _i = 0; _i < arguments.length; _i++) {
        nums[_i] = arguments[_i];
    }
    if (nums.length > 2) {
        return iteratorOperation(nums, divide);
    }
    var num1 = nums[0], num2 = nums[1];
    var num1Changed = float2Fixed(num1);
    var num2Changed = float2Fixed(num2);
    checkBoundary(num1Changed);
    checkBoundary(num2Changed);
    // fix: 类似 10 ** -4 为 0.00009999999999999999，strip 修正
    return times(num1Changed / num2Changed, strip(Math.pow(10, digitLength(num2) - digitLength(num1))));
}
/**
 * 四舍五入
 */
function round(num, ratio) {
    var base = Math.pow(10, ratio);
    var result = divide(Math.round(Math.abs(times(num, base))), base);
    if (num < 0 && result !== 0) {
        result = times(result, -1);
    }
    return result;
}
var _boundaryCheckingState = true;
/**
 * 是否进行边界检查，默认开启
 * @param flag 标记开关，true 为开启，false 为关闭，默认为 true
 */
function enableBoundaryChecking(flag) {
    if (flag === void 0) { flag = true; }
    _boundaryCheckingState = flag;
}
var index_es_index = {
    strip: strip,
    plus: index_es_plus,
    minus: index_es_minus,
    times: times,
    divide: divide,
    round: round,
    digitLength: digitLength,
    float2Fixed: float2Fixed,
    enableBoundaryChecking: enableBoundaryChecking,
};


/* harmony default export */ var index_es = (index_es_index);

// CONCATENATED MODULE: ./src/sheet/functions/add.js
// Copyright 2015-2018 FormBucket LLC


 // ADD calculates the sum of two numbers.

function add_add(a, b) {
  // Return `#NA!` if 2 arguments are not provided.
  if (arguments.length !== 2) {
    return functions_error["a" /* ERRORTYPES */].na;
  } // Return `#VALUE!` if either a or b is not a number.


  if (!isnumber(a) || !isnumber(b)) {
    return functions_error["a" /* ERRORTYPES */].value;
  } // Return the sum.


  return index_es.strip(a + b);
}
// EXTERNAL MODULE: ./node_modules/bignumber.js/bignumber.js
var bignumber = __webpack_require__("901e");
var bignumber_default = /*#__PURE__*/__webpack_require__.n(bignumber);

// CONCATENATED MODULE: ./src/sheet/functions/subtract.js
// Copyright 2015-2018 FormBucket LLC

/* eslint-disable */


 // SUBTRACT calculates the difference of two numbers.

function subtract(a, b) {
  // Return `#NA!` if 2 arguments are not provided.
  if (arguments.length !== 2) {
    return functions_error["a" /* ERRORTYPES */].na;
  } // Return `#VALUE!` if either a or b is not a number.


  if (!isnumber(a) || !isnumber(b)) {
    return functions_error["a" /* ERRORTYPES */].value;
  }

  return bignumber_default()(a).minus(b).toNumber();
}
// CONCATENATED MODULE: ./src/sheet/functions/multiply.js
// Copyright 2015-2018 FormBucket LLC

 // MULTIPLY calculates the product of two numbers.

function multiply(a, b) {
  // Return `#NA!` if 2 arguments are not provided.
  if (arguments.length !== 2) {
    return functions_error["a" /* ERRORTYPES */].na;
  } // Return `#VALUE!` if either a or b is not a number.


  if (!isnumber(a) || !isnumber(b)) {
    return functions_error["a" /* ERRORTYPES */].value;
  } // Return the product


  return a * b;
}
// CONCATENATED MODULE: ./src/sheet/functions/divide.js
// Copyright 2015-2018 FormBucket LLC

 // DIVIDE calculates the product of two numbers.

function divide_divide(a, b) {
  // Return `#NA!` if 2 arguments are not provided.
  if (arguments.length !== 2) {
    return functions_error["a" /* ERRORTYPES */].na;
  } // You cannot divide a number by 0.


  if (b === 0) {
    return functions_error["a" /* ERRORTYPES */].div0;
  } // Return `#VALUE!` if either a or b is not a number.


  if (!isnumber(a) || !isnumber(b)) {
    return functions_error["a" /* ERRORTYPES */].value;
  } // Return the product


  return a / b;
}
// CONCATENATED MODULE: ./src/sheet/functions/abs.js
// Copyright 2015-2018 FormBucket LLC

 // ABS computes absolute value of a number

function abs(value) {
  // Return `#VALUE!` if not number
  if (!isnumber(value)) {
    return functions_error["a" /* ERRORTYPES */].value;
  } // Use built-in Math.abs


  return Math.abs(value);
}
// CONCATENATED MODULE: ./src/sheet/functions/acos.js
// Copyright 2015-2018 FormBucket LLC

 // ACOS computes the inverse cosine of a number

function acos(value) {
  // Return `#VALUE!` if not number
  if (!isnumber(value)) {
    return functions_error["a" /* ERRORTYPES */].value;
  } // Use built-in Math.acos


  return Math.acos(value);
}
// CONCATENATED MODULE: ./src/sheet/functions/acosh.js
// Copyright 2015-2018 FormBucket LLC

 // Compute the hyperbolic inverse cosine of a value.

function acosh(value) {
  if (!isnumber(value)) {
    return functions_error["a" /* ERRORTYPES */].value;
  }

  return Math.log(value + Math.sqrt(value * value - 1));
}
// CONCATENATED MODULE: ./src/sheet/functions/acot.js
// Copyright 2015-2018 FormBucket LLC

 // Compute the arccotangent of a given number.

function acot(number) {
  // Ensure value is a number
  if (!isnumber(number)) {
    return functions_error["a" /* ERRORTYPES */].value;
  } // Compute value


  return Math.atan(1 / number);
}
// CONCATENATED MODULE: ./src/sheet/functions/acoth.js
// Copyright 2015-2018 FormBucket LLC

 // Compute the arccotangent of a given number.

function acoth(number) {
  // Ensure value is a number
  if (!isnumber(number)) {
    return functions_error["a" /* ERRORTYPES */].value;
  } // Compute value


  return 0.5 * Math.log((number + 1) / (number - 1));
}
// CONCATENATED MODULE: ./src/sheet/functions/asin.js
// Copyright 2015-2018 FormBucket LLC

 // Compute the inverse sin of a given number.

function asin(number) {
  // Ensure value is a number
  if (!isnumber(number)) {
    return functions_error["a" /* ERRORTYPES */].value;
  } // Compute result with built-in implementation.


  return Math.asin(number);
}
// CONCATENATED MODULE: ./src/sheet/functions/asinh.js
// Copyright 2015-2018 FormBucket LLC

 // Compute the inverse hyperbolic sin of a given number.

function asinh(number) {
  // Ensure value is a number
  if (!isnumber(number)) {
    return functions_error["a" /* ERRORTYPES */].value;
  } // Compute value


  return Math.log(number + Math.sqrt(number * number + 1));
}
// CONCATENATED MODULE: ./src/sheet/functions/atan.js
// Copyright 2015-2018 FormBucket LLC

 // Return the arctangent (in radians) of the given number

function atan(number) {
  // Ensure value is a number
  if (!isnumber(number)) {
    return functions_error["a" /* ERRORTYPES */].value;
  } // Compute value


  return Math.atan(number);
}
// CONCATENATED MODULE: ./src/sheet/functions/atan2.js
// Copyright 2015-2018 FormBucket LLC

 // Return the arctangent (in radians) of the given number

function atan2(x, y) {
  // Ensure value is a number
  if (!isnumber(x) || !isnumber(y)) {
    return functions_error["a" /* ERRORTYPES */].value;
  } // Compute value


  return Math.atan2(x, y);
}
// CONCATENATED MODULE: ./src/sheet/functions/atanh.js
// Copyright 2015-2018 FormBucket LLC

 // Compute the inverse arctangent (in radians) of the given number

function atanh_atan(x) {
  // Ensure value is a number
  if (!isnumber(x)) {
    return functions_error["a" /* ERRORTYPES */].value;
  } // Compute value


  return Math.log((1 + x) / (1 - x)) / 2;
}
// CONCATENATED MODULE: ./src/sheet/functions/cos.js
// Copyright 2015-2018 FormBucket LLC

 // COS returns the cosine of a value.

function cos(value) {
  // Return `#VALUE!` when value is not a number.
  if (!isnumber(value)) {
    return functions_error["a" /* ERRORTYPES */].value;
  }

  return Math.cos(value);
}
// CONCATENATED MODULE: ./src/sheet/functions/degrees.js
// Copyright 2015-2018 FormBucket LLC

 // Converts radians into degrees.

function degrees(radians) {
  // Ensure value is a radians
  if (!isnumber(radians)) {
    return functions_error["a" /* ERRORTYPES */].value;
  } // Compute value


  return radians * 180 / Math.PI;
}
// CONCATENATED MODULE: ./src/sheet/functions/mod.js
// Copyright 2015-2018 FormBucket LLC

 // MOD returns the remainder of a / b.

function mod(a, b) {
  if (!isnumber(a) || !isnumber(b)) return functions_error["a" /* ERRORTYPES */].value;
  return a % b;
}
// CONCATENATED MODULE: ./src/sheet/functions/pi.js
// Copyright 2015-2018 FormBucket LLC
 // PI returns half the universal circle constant

function pi_pi() {
  return τ / 2;
}
// CONCATENATED MODULE: ./src/sheet/functions/power.js
// Copyright 2015-2018 FormBucket LLC

 // POWER computes the power of a value and nth degree.

function power(val, nth) {
  // Return `#NA!` if 2 arguments are not provided.
  if (arguments.length !== 2) {
    return functions_error["a" /* ERRORTYPES */].na;
  } // Return `#VALUE!` if either a or b is not a number.


  if (!isnumber(val) || !isnumber(nth)) {
    return functions_error["a" /* ERRORTYPES */].value;
  } // Compute the power of val to the nth.


  return Math.pow(val, nth);
}
// CONCATENATED MODULE: ./src/sheet/functions/round.js

// Copyright 2015-2018 FormBucket LLC
// CONVERT a number to a fixed precision.
function round_round(number, precision) {
  return +number.toFixed(precision);
}
// CONCATENATED MODULE: ./src/sheet/functions/roundup.js
// Copyright 2015-2018 FormBucket LLC
// ROUNDUP converts a number to a fixed precision by rounding up.
function roundup(number, precision) {
  var factors = [1, 10, 100, 1000, 10000, 100000, 1000000, 10000000, 100000000, 1000000000];
  var factor = factors[precision];

  if (number > 0) {
    return Math.ceil(number * factor) / factor;
  } else {
    return Math.floor(number * factor) / factor;
  }
}
// CONCATENATED MODULE: ./src/sheet/functions/sin.js
// Copyright 2015-2018 FormBucket LLC

 // SIN calculates the sinine of a value.

function sin(value) {
  if (!isnumber(value)) {
    return functions_error["a" /* ERRORTYPES */].value;
  }

  return Math.sin(value);
}
// CONCATENATED MODULE: ./src/sheet/functions/tan.js
// Copyright 2015-2018 FormBucket LLC

 // TAN computes the tagent of a value.

function tan(value) {
  if (!isnumber(value)) {
    return functions_error["a" /* ERRORTYPES */].value;
  }

  return Math.tan(value);
}
// CONCATENATED MODULE: ./src/sheet/functions/tau.js
// Copyright 2015-2018 FormBucket LLC
 // TAU returns the universal circle constant

function tau() {
  return τ;
}
// CONCATENATED MODULE: ./src/sheet/functions/serial.js
// Copyright 2015-2018 FormBucket LLC


 // SERIAL convert a date object into a serial number.

function serial(date) {
  // Credit: https://github.com/sutoiku/formula.js/
  if (!isdate(date)) {
    return functions_error["a" /* ERRORTYPES */].na;
  }

  var diff = Math.ceil((date - d1900) / MilliSecondsInDay);
  return diff + (diff > 59 ? 2 : 1);
}
// CONCATENATED MODULE: ./src/sheet/functions/n.js
// Copyright 2015-2018 FormBucket LLC


 // N converts a `value` to a number. It supports numbers, true, false and dates.

function n_n(value) {
  // Pass numbers and errors back out.
  if (isnumber(value) || iserror(value)) {
    return value;
  } // Convert dates to serial number.


  if (value instanceof Date) {
    return serial(value);
  } // Convert true to 1


  if (value === true) {
    return 1;
  } // Convert false to 0


  if (value === false) {
    return 0;
  } // Return 0 in all other cases.


  return 0;
}
// CONCATENATED MODULE: ./src/sheet/functions/left.js
// Copyright 2015-2018 FormBucket LLC



function left_left(text, number) {
  // For blank text value, return empty string.
  if (isblank(text)) {
    return '';
  } // When number is invalid, return original value.


  if (!n_n(+number)) {
    return text;
  } // Return truncated string value.


  return text.substring(0, number);
}
// CONCATENATED MODULE: ./src/sheet/functions/trunc.js

// Copyright 2015-2018 FormBucket LLC
// remove decimal part of number



function trunc(val, precision) {
  if (!isnumber(val)) {
    return functions_error["a" /* ERRORTYPES */].value;
  }

  if (typeof precision === 'undefined') {
    return val | 0;
  } else {
    if (!isnumber(precision)) {
      return functions_error["a" /* ERRORTYPES */].value;
    }

    var bf = val + '';
    var index = bf.indexOf('.');
    var af;

    if (index === -1) {
      af = Number(bf);
    } else {
      af = Number(left_left(bf, index + precision + 1));
    }

    return af;
  }
}
// CONCATENATED MODULE: ./src/sheet/functions/within.js
function within(value, lowerBound, upperBound) {
  return lowerBound <= value && value <= upperBound;
}
// CONCATENATED MODULE: ./src/sheet/functions/char.js
// Copyright 2015-2018 FormBucket LLC
// CHAR convert number into character (e.g 65 => 'A')
function char_char(number) {
  return String.fromCharCode(number);
}
// CONCATENATED MODULE: ./src/sheet/functions/camelcase.js


// Copyright 2015-2018 FormBucket LLC

 // convert snakecase to camelcase.

function camelcase(value) {
  // Return `#VALUE!` if not text input.
  if (!istext(value)) {
    return functions_error["a" /* ERRORTYPES */].value;
  } // converts -c into C and _c in C for every matched character.


  return value.replace(/-+(.)?/g, function (match, chr) {
    return chr ? chr.toUpperCase() : '';
  }).replace(/_+(.)?/g, function (match, chr) {
    return chr ? chr.toUpperCase() : '';
  });
}
// CONCATENATED MODULE: ./src/sheet/functions/concatenate.js

// Copyright 2015-2018 FormBucket LLC
 // CONCATENATE reduces a list of values into a single string.

function concatenate() {
  for (var _len = arguments.length, values = new Array(_len), _key = 0; _key < _len; _key++) {
    values[_key] = arguments[_key];
  }

  // Combine into a single string value
  return reduce(values, function (acc, item) {
    return "".concat(acc).concat(item);
  }, '');
}
// CONCATENATED MODULE: ./src/sheet/functions/exact.js
// Copyright 2015-2018 FormBucket LLC
// Exact compares two values and only returns true if they meet strict equivalence.
function exact(a, b) {
  return a === b;
}
// CONCATENATED MODULE: ./src/sheet/functions/find.js
// Copyright 2015-2018 FormBucket LLC
 // FIND searches for text within a string

function find(find_text) {
  var within_text = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';
  var position = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1;
  // Find the position of the text
  position = within_text.indexOf(find_text, position - 1); // If found return the position as base 1.

  return position === -1 ? functions_error["a" /* ERRORTYPES */].value : position + 1;
}
// CONCATENATED MODULE: ./src/sheet/functions/join.js


// Copyright 2015-2018 FormBucket LLC
 // combine a array of strings/numbers into a single string

function join(list) {
  var delim = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : ', ';

  // all values must be string or number
  if (list.some(function (d) {
    return typeof d !== 'string' && typeof d !== 'number';
  })) {
    return functions_error["a" /* ERRORTYPES */].value;
  } // defer to JS implementation


  return list.join(delim);
}
// CONCATENATED MODULE: ./src/sheet/functions/len.js

// Copyright 2015-2018 FormBucket LLC
 // LEN returns the size of a string or array.

function len_len(value) {
  if (arguments.length === 0) {
    return functions_error["a" /* ERRORTYPES */].error;
  }

  if (_typeof(value) === 'object') {
    return value;
  }

  if (typeof value !== 'string') {
    return "".concat(value).length;
  }

  return value.length;
}
// CONCATENATED MODULE: ./src/sheet/functions/lower.js
// Copyright 2015-2018 FormBucket LLC

 // LOWER converts `value` to lower case

function lower(value) {
  if (!istext(value)) return functions_error["a" /* ERRORTYPES */].value;
  return value.toLowerCase();
}
// CONCATENATED MODULE: ./src/sheet/functions/parsebool.js
// Copyright 2015-2018 FormBucket LLC
 // PARSEBOOL converts a truthy value into a boolean value.

function parsebool(val) {
  if (val instanceof Error) {
    return val;
  } else if (typeof val === 'boolean') {
    return val;
  } else if (typeof val === 'number') {
    return val !== 0;
  } else if (typeof val === 'string') {
    var up = val.toUpperCase();

    if (up === 'TRUE' || up === 'FALSE') {
      return up === 'TRUE';
    }
  }

  return functions_error["a" /* ERRORTYPES */].value;
}
// CONCATENATED MODULE: ./src/sheet/functions/parsequery.js


// Copyright 2015-2018 FormBucket LLC

 // parse querystring into object

function parsequery() {
  var query = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';

  if (typeof query !== 'string') {
    return functions_error["a" /* ERRORTYPES */].na;
  }

  if (query.length === 0) {
    return {};
  }

  return reduce((query[0] === '?' ? query.substr(1) : query).split('&'), function (acc, item) {
    var n = item.split('=');
    var key = decodeURIComponent(n[0]);
    var value = decodeURIComponent(n[1] || '');
    acc[key] = value;
    return acc;
  }, {});
}
// CONCATENATED MODULE: ./src/sheet/functions/proper.js


// Copyright 2015-2018 FormBucket LLC

 // PROPER converts text into proper case.

function proper(text) {
  if (text === undefined || text.length === 0) {
    return functions_error["a" /* ERRORTYPES */].value;
  }

  if (text === true) {
    text = 'TRUE';
  }

  if (text === false) {
    text = 'FALSE';
  }

  if (isnan(text) && typeof text === 'number') {
    return functions_error["a" /* ERRORTYPES */].value;
  }

  if (typeof text === 'number') {
    text = '' + text;
  }

  return text.replace(/\w\S*/g, function (txt) {
    return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase();
  });
}
// CONCATENATED MODULE: ./src/sheet/functions/replace.js
// Copyright 2015-2018 FormBucket LLC

 // REPLACE returns a new string after replacing with `new_text`.

function replace(text, position, length, new_text) {
  if (iserror(position) || iserror(length) || typeof text !== 'string' || typeof new_text !== 'string') {
    return functions_error["a" /* ERRORTYPES */].value;
  }

  return text.substr(0, position - 1) + new_text + text.substr(position - 1 + length);
}
// CONCATENATED MODULE: ./src/sheet/functions/right.js
// Copyright 2015-2018 FormBucket LLC


 // RIGHT pulls a given number of character from the right side of `text`.

function right(text, number) {
  // For blank text value, return empty string.
  if (isblank(text)) {
    return '';
  } // When number is invalid, return original value.


  if (!n_n(+number)) {
    return text;
  } // Return truncated string value.


  return text.substring(text.length - number);
}
// CONCATENATED MODULE: ./src/sheet/functions/rept.js
// Copyright 2015-2018 FormBucket LLC
// REPT creates string by repeating text a given number of times.
function rept(text, number) {
  var r = '';

  for (var i = 0; i < number; i++) {
    r += text;
  }

  return r;
}
// CONCATENATED MODULE: ./src/sheet/functions/search.js






// Copyright 2015-2018 FormBucket LLC
 // SEARCH finds text using wildcards ?, *, ~?, and ~*.

function search_search(find_text, within_text, position) {
  if (!within_text) {
    return null;
  }

  position = typeof position === 'undefined' ? 1 : position; // The SEARCH function translated the find_text into a regex.

  var find_exp = find_text.replace(/([^~])\?/g, '$1.') // convert ? into .
  .replace(/([^~])\*/g, '$1.*') // convert * into .*
  .replace(/([~])\?/g, '\\?') // convert ~? into \?
  .replace(/([~])\*/g, '\\*'); // convert ~* into \*

  position = new RegExp(find_exp, 'i').exec(within_text);

  if (position) {
    return position.index + 1;
  }

  return functions_error["a" /* ERRORTYPES */].value;
}
// CONCATENATED MODULE: ./src/sheet/functions/snakecase.js


// Copyright 2015-2018 FormBucket LLC

 // convert camelcase to snakecase.

function snakecase(value) {
  // Return `#VALUE!` if not text input.
  if (!istext(value)) {
    return functions_error["a" /* ERRORTYPES */].value;
  } // credit: prototype.js


  return value.replace(/::/g, '/').replace(/([A-Z]+)([A-Z][a-z])/g, '$1_$2').replace(/([a-z\d])([A-Z])/g, '$1_$2').replace(/-/g, '_').toLowerCase();
}
// CONCATENATED MODULE: ./src/sheet/functions/substitute.js






// Copyright 2015-2018 FormBucket LLC
// SUBSTITUTE `old_text` with `new_text`, optionally only a selected occurence.
function substitute(text, old_text, new_text, occurrence) {
  if (!text || !old_text || !new_text) {
    return text;
  } else if (occurrence === undefined) {
    return text.replace(new RegExp(old_text, 'g'), new_text);
  } else {
    var index = 0;
    var i = 0;

    while (text.indexOf(old_text, index) > 0) {
      index = text.indexOf(old_text, index + 1);
      i++;

      if (i === occurrence) {
        return text.substring(0, index) + new_text + text.substring(index + old_text.length);
      }
    }
  }
}
// CONCATENATED MODULE: ./src/sheet/functions/keys.js

// Copyright 2015-2018 FormBucket LLC
function keys_keys(subject) {
  return Object.keys(subject);
}
// CONCATENATED MODULE: ./src/sheet/functions/substituteAll.js

// Copyright 2015-2018 FormBucket LLC


 // substituteAll is a lightweight "substitution tags" engine that implement a global substitute for multiple items.
//
// The key values in your locals object are replaced. Unlike other templating systems it doesn't specify characters that surround your tokens.
//
// The function does not encode HTML entities. Don't use this to generate HTML. There are plently of alternative like underscore.js that do that already.
//
// It is equivalent to:
// ```js
// locals = { '-first-': 'Joe', '-last-': 'Smith' }
// substitute( substitute("-first- -last", '-first-',  locals), '-last-', 'Smith', locals)
// ```

function substituteAll(content, locals) {
  var start = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : '-';
  var end = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : start;
  if (!locals) return content;
  return reduce(keys_keys(locals), function (p, v) {
    return substitute(p, "".concat(start).concat(v).concat(end), locals[v]);
  }, content);
}
// CONCATENATED MODULE: ./src/sheet/functions/surroundKeys.js

// Copyright 2015-2018 FormBucket LLC

 // Creates a new object where all of the keys are surrounded by
// start and end delimiters.

function surroundKeys(obj) {
  var start = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '-';
  var end = arguments.length > 2 ? arguments[2] : undefined;
  end = end || start;
  return reduce(keys_keys(obj), function (p, v) {
    p["".concat(start).concat(v).concat(end)] = obj[v];
    return p;
  }, {});
}
// CONCATENATED MODULE: ./src/sheet/functions/text.js
// Copyright 2015-2018 FormBucket LLC
// based heavily on code from socialcalc







var FormatNumber = {};
FormatNumber.format_definitions = {}; // Parsed formats are stored here globally
// Other constants

FormatNumber.commands = {
  copy: 1,
  color: 2,
  integer_placeholder: 3,
  fraction_placeholder: 4,
  decimal: 5,
  currency: 6,
  general: 7,
  separator: 8,
  date: 9,
  comparison: 10,
  section: 11,
  style: 12
};
/* *******************

result = FormatNumber.formatNumberWithFormat = function(rawvalue, format_string, currency_char)

************************* */

FormatNumber.formatNumberWithFormat = function (rawvalue, format_string, currency_char) {
  var scfn = FormatNumber;
  var op, operandstr, fromend, cval, operandstrlc;
  var startval, estartval;
  var hrs, mins, secs, ehrs, emins, esecs, ampmstr, ymd;
  var minOK, mpos, mspos;
  var result = '';
  var format;
  var section, gotcomparison, compop, compval, cpos, oppos;
  var sectioninfo;
  var i, decimalscale, scaledvalue, strvalue, strparts, integervalue, fractionvalue;
  var integerdigits2, integerpos, fractionpos, textcolor, textstyle, separatorchar, decimalchar;
  var value; // working copy to change sign, etc.

  rawvalue = rawvalue - 0; // make sure a number

  value = rawvalue;
  if (!isFinite(value)) return 'NaN';
  var negativevalue = value < 0 ? 1 : 0; // determine sign, etc.

  if (negativevalue) value = -value;
  var zerovalue = value == 0 ? 1 : 0;
  currency_char = currency_char || DefaultCurrency;
  FormatNumber.parse_format_string(scfn.format_definitions, format_string); // make sure format is parsed

  format = scfn.format_definitions[format_string]; // Get format structure

  if (!format) throw 'Format not parsed error.';
  section = format.sectioninfo.length - 1; // get number of sections - 1
  // has comparisons - determine which section

  if (format.hascomparison) {
    section = 0; // set to which section we will use

    gotcomparison = 0; // this section has no comparison

    for (cpos = 0;; cpos++) {
      // scan for comparisons
      op = format.operators[cpos];
      operandstr = format.operands[cpos]; // get next operator and operand
      // at end with no match

      if (!op) {
        // if comparison but no match
        if (gotcomparison) {
          format_string = 'General'; // use default of General

          scfn.parse_format_string(scfn.format_definitions, format_string);
          format = scfn.format_definitions[format_string];
          section = 0;
        }

        break; // if no comparision, matches on this section
      } // end of section


      if (op == scfn.commands.section) {
        if (!gotcomparison) {
          // no comparison, so it's a match
          break;
        }

        gotcomparison = 0;
        section++; // check out next one

        continue;
      } // found a comparison - do we meet it?


      if (op == scfn.commands.comparison) {
        i = operandstr.indexOf(':');
        compop = operandstr.substring(0, i);
        compval = operandstr.substring(i + 1) - 0;

        if (compop == '<' && rawvalue < compval || compop == '<=' && rawvalue <= compval || compop == '=' && rawvalue == compval || compop == '<>' && rawvalue != compval || compop == '>=' && rawvalue >= compval || compop == '>' && rawvalue > compval) {
          break;
        }

        gotcomparison = 1;
      }
    }
  } else if (section > 0) {
    // more than one section (separated by ";")
    // two sections
    if (section == 1) {
      if (negativevalue) {
        negativevalue = 0; // sign will provided by section, not automatically

        section = 1; // use second section for negative values
      } else {
        section = 0; // use first for all others
      }
    } else if (section == 2) {
      // three sections
      if (negativevalue) {
        negativevalue = 0; // sign will provided by section, not automatically

        section = 1; // use second section for negative values
      } else if (zerovalue) {
        section = 2; // use third section for zero values
      } else {
        section = 0; // use first for positive
      }
    }
  }

  sectioninfo = format.sectioninfo[section]; // look at values for our section

  if (sectioninfo.commas > 0) {
    // scale by thousands
    for (i = 0; i < sectioninfo.commas; i++) {
      value /= 1000;
    }
  }

  if (sectioninfo.percent > 0) {
    // do percent scaling
    for (i = 0; i < sectioninfo.percent; i++) {
      value *= 100;
    }
  }

  decimalscale = 1; // cut down to required number of decimal digits

  for (i = 0; i < sectioninfo.fractiondigits; i++) {
    decimalscale *= 10;
  }

  scaledvalue = Math.floor(value * decimalscale + 0.5);
  scaledvalue = scaledvalue / decimalscale;
  if (typeof scaledvalue != 'number') return 'NaN';
  if (!isFinite(scaledvalue)) return 'NaN';
  strvalue = scaledvalue + ''; // convert to string (Number.toFixed doesn't do all we need)
  //   strvalue = value.toFixed(sectioninfo.fractiondigits); // cut down to required number of decimal digits
  // and convert to string

  if (scaledvalue == 0 && (sectioninfo.fractiondigits || sectioninfo.integerdigits)) {
    negativevalue = 0; // no "-0" unless using multiple sections or General
  } // converted to scientific notation


  if (strvalue.indexOf('e') >= 0) {
    return rawvalue + ''; // Just return plain converted raw value
  }

  strparts = strvalue.match(/^\+{0,1}(\d*)(?:\.(\d*)){0,1}$/); // get integer and fraction parts

  if (!strparts) return 'NaN'; // if not a number

  integervalue = strparts[1];
  if (!integervalue || integervalue == '0') integervalue = '';
  fractionvalue = strparts[2];
  if (!fractionvalue) fractionvalue = ''; // there are date placeholders

  if (sectioninfo.hasdate) {
    // bad date
    if (rawvalue < 0) {
      return '??-???-?? ??:??:??';
    }

    startval = (rawvalue - Math.floor(rawvalue)) * SecondsInDay; // get date/time parts

    estartval = rawvalue * SecondsInDay; // do elapsed time version, too

    hrs = Math.floor(startval / SecondsInHour);
    ehrs = Math.floor(estartval / SecondsInHour);
    startval = startval - hrs * SecondsInHour;
    mins = Math.floor(startval / 60);
    emins = Math.floor(estartval / 60);
    secs = startval - mins * 60;
    decimalscale = 1; // round appropriately depending if there is ss.0

    for (i = 0; i < sectioninfo.fractiondigits; i++) {
      decimalscale *= 10;
    }

    secs = Math.floor(secs * decimalscale + 0.5);
    secs = secs / decimalscale;
    esecs = Math.floor(estartval * decimalscale + 0.5);
    esecs = esecs / decimalscale;

    if (secs >= 60) {
      // handle round up into next second, minute, etc.
      secs = 0;
      mins++;
      emins++;

      if (mins >= 60) {
        mins = 0;
        hrs++;
        ehrs++;

        if (hrs >= 24) {
          hrs = 0;
          rawvalue++;
        }
      }
    }

    fractionvalue = secs - Math.floor(secs) + ''; // for "hh:mm:ss.000"

    fractionvalue = fractionvalue.substring(2); // skip "0."

    ymd = parsedate(rawvalue);
    ymd = {
      year: ymd.getFullYear(),
      month: ymd.getMonth() + 1,
      day: ymd.getDate()
    };
    minOK = 0; // says "m" can be minutes if true

    mspos = sectioninfo.sectionstart; // m scan position in ops

    for (;; mspos++) {
      // scan for "m" and "mm" to see if any minutes fields, and am/pm
      op = format.operators[mspos];
      operandstr = format.operands[mspos]; // get next operator and operand

      if (!op) break; // don't go past end

      if (op == scfn.commands.section) break;

      if (op == scfn.commands.date) {
        if ((operandstr.toLowerCase() == 'am/pm' || operandstr.toLowerCase() == 'a/p') && !ampmstr) {
          if (hrs >= 12) {
            if (hrs > 12) hrs -= 12;
            ampmstr = operandstr.toLowerCase() == 'a/p' ? PM1 : PM; // "P" : "PM";
          } else {
            if (hrs === 0) hrs = 12;
            ampmstr = operandstr.toLowerCase() == 'a/p' ? AM1 : AM; // "A" : "AM";
          }

          if (operandstr.indexOf(ampmstr) < 0) ampmstr = ampmstr.toLowerCase(); // have case match case in format
        }

        if (minOK && (operandstr == 'm' || operandstr == 'mm')) {
          format.operands[mspos] += 'in'; // turn into "min" or "mmin"
        }

        if (operandstr.charAt(0) == 'h') {
          minOK = 1; // m following h or hh or [h] is minutes not months
        } else {
          minOK = 0;
        }
      } else if (op != scfn.commands.copy) {
        // copying chars can be between h and m
        minOK = 0;
      }
    }

    minOK = 0;

    for (--mspos;; mspos--) {
      // scan other way for s after m
      op = format.operators[mspos];
      operandstr = format.operands[mspos]; // get next operator and operand

      if (!op) break; // don't go past end

      if (op == scfn.commands.section) break;

      if (op == scfn.commands.date) {
        if (minOK && (operandstr == 'm' || operandstr == 'mm')) {
          format.operands[mspos] += 'in'; // turn into "min" or "mmin"
        }

        if (operandstr == 'ss') {
          minOK = 1; // m before ss is minutes not months
        } else {
          minOK = 0;
        }
      } else if (op != scfn.commands.copy) {
        // copying chars can be between ss and m
        minOK = 0;
      }
    }
  }

  integerdigits2 = 0; // init counters, etc.

  integerpos = 0;
  fractionpos = 0;
  textcolor = '';
  textstyle = '';
  separatorchar = SeparatorChar;
  if (separatorchar.indexOf(' ') >= 0) separatorchar = separatorchar.replace(/ /g, ' ');
  decimalchar = DecimalChar;
  if (decimalchar.indexOf(' ') >= 0) decimalchar = decimalchar.replace(/ /g, ' ');
  oppos = sectioninfo.sectionstart;

  while (op = format.operators[oppos]) {
    // execute format
    operandstr = format.operands[oppos++]; // get next operator and operand

    if (op == scfn.commands.copy) {
      // put char in result
      result += operandstr;
    } else if (op == scfn.commands.color) {
      // set color
      textcolor = operandstr;
    } else if (op == scfn.commands.style) {
      // set style
      textstyle = operandstr;
    } else if (op == scfn.commands.integer_placeholder) {
      // insert number part
      if (negativevalue) {
        result += '-';
        negativevalue = 0;
      }

      integerdigits2++;

      if (integerdigits2 == 1) {
        // first one
        if (integervalue.length > sectioninfo.integerdigits) {
          // see if integer wider than field
          for (; integerpos < integervalue.length - sectioninfo.integerdigits; integerpos++) {
            result += integervalue.charAt(integerpos);

            if (sectioninfo.thousandssep) {
              // see if this is a separator position
              fromend = integervalue.length - integerpos - 1;

              if (fromend > 2 && fromend % 3 == 0) {
                result += separatorchar;
              }
            }
          }
        }
      }

      if (integervalue.length < sectioninfo.integerdigits && integerdigits2 <= sectioninfo.integerdigits - integervalue.length) {
        // field is wider than value
        if (operandstr == '0' || operandstr == '?') {
          // fill with appropriate characters
          result += operandstr == '0' ? '0' : ' ';

          if (sectioninfo.thousandssep) {
            // see if this is a separator position
            fromend = sectioninfo.integerdigits - integerdigits2;

            if (fromend > 2 && fromend % 3 == 0) {
              result += separatorchar;
            }
          }
        }
      } else {
        // normal integer digit - add it
        result += integervalue.charAt(integerpos);

        if (sectioninfo.thousandssep) {
          // see if this is a separator position
          fromend = integervalue.length - integerpos - 1;

          if (fromend > 2 && fromend % 3 == 0) {
            result += separatorchar;
          }
        }

        integerpos++;
      }
    } else if (op == scfn.commands.fraction_placeholder) {
      // add fraction part of number
      if (fractionpos >= fractionvalue.length) {
        if (operandstr == '0' || operandstr == '?') {
          result += operandstr == '0' ? '0' : ' ';
        }
      } else {
        result += fractionvalue.charAt(fractionpos);
      }

      fractionpos++;
    } else if (op == scfn.commands.decimal) {
      // decimal point
      if (negativevalue) {
        result += '-';
        negativevalue = 0;
      }

      result += decimalchar;
    } else if (op == scfn.commands.currency) {
      // currency symbol
      if (negativevalue) {
        result += '-';
        negativevalue = 0;
      }

      result += operandstr;
    } else if (op == scfn.commands.general) {
      // insert "General" conversion
      // *** Cut down number of significant digits to avoid floating point artifacts:
      if (value != 0) {
        // only if non-zero
        var factor = Math.floor(Math.LOG10E * Math.log(value)); // get integer magnitude as a power of 10

        factor = Math.pow(10, 13 - factor); // turn into scaling factor

        value = Math.floor(factor * value + 0.5) / factor; // scale positive value, round, undo scaling

        if (!isFinite(value)) return 'NaN';
      }

      if (negativevalue) {
        result += '-';
      }

      strvalue = value + ''; // convert original value to string

      if (strvalue.indexOf('e') >= 0) {
        // converted to scientific notation
        result += strvalue;
        continue;
      }

      strparts = strvalue.match(/^\+{0,1}(\d*)(?:\.(\d*)){0,1}$/); // get integer and fraction parts

      integervalue = strparts[1];
      if (!integervalue || integervalue == '0') integervalue = '';
      fractionvalue = strparts[2];
      if (!fractionvalue) fractionvalue = '';
      integerpos = 0;
      fractionpos = 0;

      if (integervalue.length) {
        for (; integerpos < integervalue.length; integerpos++) {
          result += integervalue.charAt(integerpos);

          if (sectioninfo.thousandssep) {
            // see if this is a separator position
            fromend = integervalue.length - integerpos - 1;

            if (fromend > 2 && fromend % 3 == 0) {
              result += separatorchar;
            }
          }
        }
      } else {
        result += '0';
      }

      if (fractionvalue.length) {
        result += decimalchar;

        for (; fractionpos < fractionvalue.length; fractionpos++) {
          result += fractionvalue.charAt(fractionpos);
        }
      }
    } else if (op == scfn.commands.date) {
      // date placeholder
      operandstrlc = operandstr.toLowerCase();

      if (operandstrlc == 'y' || operandstrlc == 'yy') {
        result += (ymd.year + '').substring(2);
      } else if (operandstrlc == 'yyyy') {
        result += ymd.year + '';
      } else if (operandstrlc == 'd') {
        result += ymd.day + '';
      } else if (operandstrlc == 'dd') {
        cval = 1000 + ymd.day;
        result += (cval + '').substr(2);
      } else if (operandstrlc == 'ddd') {
        cval = Math.floor(rawvalue + 6) % 7;
        result += DayNames3[cval];
      } else if (operandstrlc == 'dddd') {
        cval = Math.floor(rawvalue + 6) % 7;
        result += DayNames[cval];
      } else if (operandstrlc == 'm') {
        result += ymd.month + '';
      } else if (operandstrlc == 'mm') {
        cval = 1000 + ymd.month;
        result += (cval + '').substr(2);
      } else if (operandstrlc == 'mmm') {
        result += MonthNames3[ymd.month - 1];
      } else if (operandstrlc == 'mmmm') {
        result += MonthNames[ymd.month - 1];
      } else if (operandstrlc == 'mmmmm') {
        result += MonthNames[ymd.month - 1].charAt(0);
      } else if (operandstrlc == 'h') {
        result += hrs + '';
      } else if (operandstrlc == 'h]') {
        result += ehrs + '';
      } else if (operandstrlc == 'mmin') {
        cval = 1000 + mins + '';
        result += cval.substr(2);
      } else if (operandstrlc == 'mm]') {
        if (emins < 100) {
          cval = 1000 + emins + '';
          result += cval.substr(2);
        } else {
          result += emins + '';
        }
      } else if (operandstrlc == 'min') {
        result += mins + '';
      } else if (operandstrlc == 'm]') {
        result += emins + '';
      } else if (operandstrlc == 'hh') {
        cval = 1000 + hrs + '';
        result += cval.substr(2);
      } else if (operandstrlc == 's') {
        cval = Math.floor(secs);
        result += cval + '';
      } else if (operandstrlc == 'ss') {
        cval = 1000 + Math.floor(secs) + '';
        result += cval.substr(2);
      } else if (operandstrlc == 'am/pm' || operandstrlc == 'a/p') {
        result += ampmstr;
      } else if (operandstrlc == 'ss]') {
        if (esecs < 100) {
          cval = 1000 + Math.floor(esecs) + '';
          result += cval.substr(2);
        } else {
          cval = Math.floor(esecs);
          result += cval + '';
        }
      }
    } else if (op == scfn.commands.section) {
      // end of section
      break;
    } else if (op == scfn.commands.comparison) {
      // ignore
      continue;
    } else {
      result += '!! Parse error.!!';
    }
  }

  if (textcolor) {
    result = '<span style="color:' + textcolor + ';">' + result + '</span>';
  }

  if (textstyle) {
    result = '<span style="' + textstyle + ';">' + result + '</span>';
  } //console.log(result)


  return result;
};
/* *******************

FormatNumber.parse_format_string(format_defs, format_string)

Takes a format string (e.g., "#,##0.00_);(#,##0.00)") and fills in format_defs with the parsed info

format_defs
["#,##0.0"]->{} - elements in the hash are one hash for each format
.operators->[] - array of operators from parsing the format string (each a number)
.operands->[] - array of corresponding operators (each usually a string)
.sectioninfo->[] - one hash for each section of the format
.start
.integerdigits
.fractiondigits
.commas
.percent
.thousandssep
.hasdates
.hascomparison - true if any section has [<100], etc.

************************* */


FormatNumber.parse_format_string = function (format_defs, format_string) {
  var scfn = FormatNumber;
  var format, section, sectioninfo;
  var integerpart = 1; // start out in integer part

  var lastwasinteger; // last char was an integer placeholder

  var lastwasslash; // last char was a backslash - escaping following character

  var lastwasasterisk; // repeat next char

  var lastwasunderscore; // last char was _ which picks up following char for width

  var inquote, quotestr; // processing a quoted string

  var inbracket, bracketstr, bracketdata; // processing a bracketed string

  var ingeneral, gpos; // checks for characters "General"

  var ampmstr, part; // checks for characters "A/P" and "AM/PM"

  var indate; // keeps track of date/time placeholders

  var chpos; // character position being looked at

  var ch; // character being looked at

  if (format_defs[format_string]) return; // already defined - nothing to do

  format = {
    operators: [],
    operands: [],
    sectioninfo: [{}]
  }; // create info structure for this format

  format_defs[format_string] = format; // add to other format definitions

  section = 0; // start with section 0

  sectioninfo = format.sectioninfo[section]; // get reference to info for current section

  sectioninfo.sectionstart = 0; // position in operands that starts this section

  sectioninfo.integerdigits = 0; // number of integer-part placeholders

  sectioninfo.fractiondigits = 0; // fraction placeholders

  sectioninfo.commas = 0; // commas encountered, to handle scaling

  sectioninfo.percent = 0; // times to scale by 100

  for (chpos = 0; chpos < format_string.length; chpos++) {
    // parse
    ch = format_string.charAt(chpos); // get next char to examine

    if (inquote) {
      if (ch == '"') {
        inquote = 0;
        format.operators.push(scfn.commands.copy);
        format.operands.push(quotestr);
        continue;
      }

      quotestr += ch;
      continue;
    }

    if (inbracket) {
      if (ch == ']') {
        inbracket = 0;
        bracketdata = FormatNumber.parse_format_bracket(bracketstr);

        if (bracketdata.operator == scfn.commands.separator) {
          sectioninfo.thousandssep = 1; // explicit [,]

          continue;
        }

        if (bracketdata.operator == scfn.commands.date) {
          sectioninfo.hasdate = 1;
        }

        if (bracketdata.operator == scfn.commands.comparison) {
          format.hascomparison = 1;
        }

        format.operators.push(bracketdata.operator);
        format.operands.push(bracketdata.operand);
        continue;
      }

      bracketstr += ch;
      continue;
    }

    if (lastwasslash) {
      format.operators.push(scfn.commands.copy);
      format.operands.push(ch);
      lastwasslash = false;
      continue;
    }

    if (lastwasasterisk) {
      format.operators.push(scfn.commands.copy);
      format.operands.push(ch + ch + ch + ch + ch); // do 5 of them since no real tabs

      lastwasasterisk = false;
      continue;
    }

    if (lastwasunderscore) {
      format.operators.push(scfn.commands.copy);
      format.operands.push(' ');
      lastwasunderscore = false;
      continue;
    }

    if (ingeneral) {
      if ('general'.charAt(ingeneral) == ch.toLowerCase()) {
        ingeneral++;

        if (ingeneral == 7) {
          format.operators.push(scfn.commands.general);
          format.operands.push(ch);
          ingeneral = 0;
        }

        continue;
      }

      ingeneral = 0;
    } // last char was part of a date placeholder


    if (indate) {
      if (indate.charAt(0) == ch) {
        // another of the same char
        indate += ch; // accumulate it

        continue;
      }

      format.operators.push(scfn.commands.date); // something else, save date info

      format.operands.push(indate);
      sectioninfo.hasdate = 1;
      indate = '';
    }

    if (ampmstr) {
      ampmstr += ch;
      part = ampmstr.toLowerCase();

      if (part != 'am/pm'.substring(0, part.length) && part != 'a/p'.substring(0, part.length)) {
        ampstr = '';
      } else if (part == 'am/pm' || part == 'a/p') {
        format.operators.push(scfn.commands.date);
        format.operands.push(ampmstr);
        ampmstr = '';
      }

      continue;
    }

    if (ch == '#' || ch == '0' || ch == '?') {
      // placeholder
      if (integerpart) {
        sectioninfo.integerdigits++;

        if (sectioninfo.commas) {
          // comma inside of integer placeholders
          sectioninfo.thousandssep = 1; // any number is thousands separator

          sectioninfo.commas = 0; // reset count of "thousand" factors
        }

        lastwasinteger = 1;
        format.operators.push(scfn.commands.integer_placeholder);
        format.operands.push(ch);
      } else {
        sectioninfo.fractiondigits++;
        format.operators.push(scfn.commands.fraction_placeholder);
        format.operands.push(ch);
      }
    } else if (ch == '.') {
      lastwasinteger = 0;
      format.operators.push(scfn.commands.decimal);
      format.operands.push(ch);
      integerpart = 0;
    } else if (ch === '$') {
      lastwasinteger = 0;
      format.operators.push(scfn.commands.currency);
      format.operands.push(ch);
    } else if (ch == ',') {
      if (lastwasinteger) {
        sectioninfo.commas++;
      } else {
        format.operators.push(scfn.commands.copy);
        format.operands.push(ch);
      }
    } else if (ch == '%') {
      lastwasinteger = 0;
      sectioninfo.percent++;
      format.operators.push(scfn.commands.copy);
      format.operands.push(ch);
    } else if (ch == '"') {
      lastwasinteger = 0;
      inquote = 1;
      quotestr = '';
    } else if (ch == '[') {
      lastwasinteger = 0;
      inbracket = 1;
      bracketstr = '';
    } else if (ch == '\\') {
      lastwasslash = 1;
      lastwasinteger = 0;
    } else if (ch == '*') {
      lastwasasterisk = 1;
      lastwasinteger = 0;
    } else if (ch == '_') {
      lastwasunderscore = 1;
      lastwasinteger = 0;
    } else if (ch == ';') {
      section++; // start next section

      format.sectioninfo[section] = {}; // create a new section

      sectioninfo = format.sectioninfo[section]; // get reference to info for current section

      sectioninfo.sectionstart = 1 + format.operators.length; // remember where it starts

      sectioninfo.integerdigits = 0; // number of integer-part placeholders

      sectioninfo.fractiondigits = 0; // fraction placeholders

      sectioninfo.commas = 0; // commas encountered, to handle scaling

      sectioninfo.percent = 0; // times to scale by 100

      integerpart = 1; // reset for new section

      lastwasinteger = 0;
      format.operators.push(scfn.commands.section);
      format.operands.push(ch);
    } else if (ch.toLowerCase() == 'g') {
      ingeneral = 1;
      lastwasinteger = 0;
    } else if (ch.toLowerCase() == 'a') {
      ampmstr = ch;
      lastwasinteger = 0;
    } else if ('dmyhHs'.indexOf(ch) >= 0) {
      indate = ch;
    } else {
      lastwasinteger = 0;
      format.operators.push(scfn.commands.copy);
      format.operands.push(ch);
    }
  } // last char was part of unsaved date placeholder


  if (indate) {
    format.operators.push(scfn.commands.date);
    format.operands.push(indate);
    sectioninfo.hasdate = 1;
  }

  return;
};
/* *******************

bracketdata = FormatNumber.parse_format_bracket(bracketstr)

Takes a bracket contents (e.g., "RED", ">10") and returns an operator and operand

bracketdata->{}
.operator
.operand

************************* */


FormatNumber.parse_format_bracket = function (bracketstr) {
  var scfn = FormatNumber;
  var bracketdata = {};
  var parts; // currency

  if (bracketstr.charAt(0) == '$') {
    bracketdata.operator = scfn.commands.currency;
    parts = bracketstr.match(/^\$(.+?)(\-.+?){0,1}$/);

    if (parts) {
      bracketdata.operand = parts[1] || DefaultCurrency || '$';
    } else {
      bracketdata.operand = bracketstr.substring(1) || DefaultCurrency || '$';
    }
  } else if (bracketstr == '?$') {
    bracketdata.operator = scfn.commands.currency;
    bracketdata.operand = '[?$]';
  } else if (AllowedColors[bracketstr.toUpperCase()]) {
    bracketdata.operator = scfn.commands.color;
    bracketdata.operand = AllowedColors[bracketstr.toUpperCase()];
  } else if (parts = bracketstr.match(/^style=([^']*)$/)) {
    // [style=...]
    bracketdata.operator = scfn.commands.style;
    bracketdata.operand = parts[1];
  } else if (bracketstr == ',') {
    bracketdata.operator = scfn.commands.separator;
    bracketdata.operand = bracketstr;
  } else if (AllowedDates[bracketstr.toUpperCase()]) {
    bracketdata.operator = scfn.commands.date;
    bracketdata.operand = AllowedDates[bracketstr.toUpperCase()];
  } else if (parts = bracketstr.match(/^[<>=]/)) {
    // comparison operator
    parts = bracketstr.match(/^([<>=]+)(.+)$/); // split operator and value

    bracketdata.operator = scfn.commands.comparison;
    bracketdata.operand = parts[1] + ':' + parts[2];
  } else {
    // unknown bracket
    bracketdata.operator = scfn.commands.copy;
    bracketdata.operand = '[' + bracketstr + ']';
  }

  return bracketdata;
};

function text_text(value, format, currency_char) {
  return FormatNumber.formatNumberWithFormat(value, format, currency_char);
}
// EXTERNAL MODULE: ./node_modules/core-js/modules/es.string.trim.js
var es_string_trim = __webpack_require__("498a");

// CONCATENATED MODULE: ./src/sheet/functions/trim.js

// Copyright 2015-2018 FormBucket LLC
// TRIMS returns a string without whitespace at the beginning or end.
function trim(text) {
  if (typeof text !== 'string') {
    text = "".concat(text);
  }

  return text.trim();
}
// CONCATENATED MODULE: ./src/sheet/functions/upper.js
// Copyright 2015-2018 FormBucket LLC
// UPPER converts a string to upper case
function upper(string) {
  return string.toUpperCase();
}
// CONCATENATED MODULE: ./src/sheet/functions/hlookup.js
// Copyright 2015-2018 FormBucket LLC

 // Find a needle in a table searching horizontally.

function hlookup(needle, table) {
  var index = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1;
  var exactmatch = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;

  if (typeof needle === 'undefined' || isblank(needle)) {
    return null;
  }

  if (index > table.length) {
    return functions_error["a" /* ERRORTYPES */].ref;
  }

  var needleLower = (needle + '').toLowerCase(),
      row = table[0];

  for (var i = 0; i < row.length; i++) {
    if (exactmatch && row[i] === needle || row[i] == needle || typeof row[i] === 'string' && row[i].toLowerCase().indexOf(needleLower) != -1) {
      return table[index - 1][i];
    }
  }

  return functions_error["a" /* ERRORTYPES */].na;
}
// CONCATENATED MODULE: ./src/sheet/functions/includes.js
// Copyright 2015-2018 FormBucket LLC
// from https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/includes?v=example
function includes_includes(searchElement, searchList, fromIndex) {
  // 1. Let O be ? ToObject(this value).
  if (searchList == null) {
    throw new TypeError('"searchList" is null or not defined');
  }

  var o = Object(searchList); // 2. Let len be ? ToLength(? Get(O, "length")).

  var len = o.length >>> 0; // 3. If len is 0, return false.

  if (len === 0) {
    return false;
  } // 4. Let n be ? ToInteger(fromIndex).
  //    (If fromIndex is undefined, this step produces the value 0.)


  var n = fromIndex | 0; // 5. If n ≥ 0, then
  //  a. Let k be n.
  // 6. Else n < 0,
  //  a. Let k be len + n.
  //  b. If k < 0, let k be 0.

  var k = Math.max(n >= 0 ? n : len - Math.abs(n), 0);

  function sameValueZero(x, y) {
    return x === y || typeof x === 'number' && typeof y === 'number' && isNaN(x) && isNaN(y);
  } // 7. Repeat, while k < len


  while (k < len) {
    // a. Let elementK be the result of ? Get(O, ! ToString(k)).
    // b. If SameValueZero(searchElement, elementK) is true, return true.
    // c. Increase k by 1.
    if (sameValueZero(o[k], searchElement)) {
      return true;
    }

    k++;
  } // 8. Return false


  return false;
}
// CONCATENATED MODULE: ./src/sheet/functions/notincludes.js
// Copyright 2015-2018 FormBucket LLC
 // notincludes returns true when the searchElement is not found in the searchList.

function notincludes(searchElement, searchList, fromIndex) {
  return !includes_includes(searchElement, searchList, fromIndex);
}
// CONCATENATED MODULE: ./src/sheet/functions/index.js
// Copyright 2015-2018 FormBucket LLC


 // index returns the value in a row and column from a 2d array

function functions_index(reference, row_num) {
  var column_num = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1;
  var row;

  if (!isarray(reference) || isblank(row_num)) {
    return functions_error["a" /* ERRORTYPES */].value;
  }

  if (reference.length < row_num) {
    return functions_error["a" /* ERRORTYPES */].ref;
  }

  row = reference[row_num - 1];

  if (!isarray(row)) {
    return functions_error["a" /* ERRORTYPES */].value;
  }

  if (row.length < column_num) {
    return functions_error["a" /* ERRORTYPES */].ref;
  }

  return row[column_num - 1];
}
// CONCATENATED MODULE: ./src/sheet/functions/lookup.js
// Copyright 2015-2018 FormBucket LLC
// LOOKUP find a value in an array.
function lookup() {
  var lookup_value, lookup_array, lookup_vector, results_vector;

  if (arguments.length === 2) {
    // array form
    var wide = false;
    lookup_value = arguments[0].valueOf();
    lookup_array = arguments[1];

    for (var i = 0; i < lookup_array.length; i++) {
      if (typeof lookup_array[i] !== 'undefined' && lookup_value === lookup_array[i].valueOf()) {
        return lookup_array[i];
      }
    }
  } else if (arguments.length === 3) {
    // vector form`
    lookup_value = arguments[0].valueOf();
    lookup_vector = arguments[1];
    results_vector = arguments[2];

    for (var i = 0; i < lookup_vector.length; i++) {
      if (typeof lookup_vector[i] !== 'undefined' && lookup_value === lookup_vector[i].valueOf()) {
        return results_vector[i];
      }
    }
  }

  return error.na;
}
// CONCATENATED MODULE: ./src/sheet/functions/match.js



// Copyright 2015-2018 FormBucket LLC

 // MATCH returns an index in `lookup_array` by searching for `lookup_reference`.

function match(lookup_value, lookup_array, matchType) {
  var lookupArray, lookupValue, index, indexValue; // Gotta have only 2 arguments folks!

  if (arguments.length === 2) {
    matchType = 1;
  } // Find the lookup value inside a worksheet cell, if needed.


  lookupValue = lookup_value; // Find the array inside a worksheet range, if needed.

  if (isarray(lookup_array)) {
    lookupArray = lookup_array;
  } else {
    return functions_error["a" /* ERRORTYPES */].na;
  } // Gotta have both lookup value and array


  if (!lookupValue && !lookupArray) {
    return functions_error["a" /* ERRORTYPES */].na;
  } // Bail on weird match types!


  if (matchType !== -1 && matchType !== 0 && matchType !== 1) {
    return functions_error["a" /* ERRORTYPES */].na;
  }

  for (var idx = 0; idx < lookupArray.length; idx++) {
    if (matchType === 1) {
      if (lookupArray[idx] === lookupValue) {
        return idx + 1;
      } else if (lookupArray[idx] < lookupValue) {
        if (!indexValue) {
          index = idx + 1;
          indexValue = lookupArray[idx];
        } else if (lookupArray[idx] > indexValue) {
          index = idx + 1;
          indexValue = lookupArray[idx];
        }
      }
    } else if (matchType === 0) {
      if (typeof lookupValue === 'string') {
        // '?' is mapped to the regex '.'
        // '*' is mapped to the regex '.*'
        // '~' is mapped to the regex '\?'
        if (idx === 0) {
          lookupValue = '^' + lookupValue.replace(/\?/g, '.').replace(/\*/g, '.*').replace(/~/g, '\\?') + '$';
        }

        if (typeof lookupArray[idx] !== 'undefined') {
          if (String(lookupArray[idx]).toLowerCase().match(String(lookupValue).toLowerCase())) {
            return idx + 1;
          }
        }
      } else {
        if (typeof lookupArray[idx] !== 'undefined' && lookupArray[idx] !== null && lookupArray[idx].valueOf() === lookupValue) {
          return idx + 1;
        }
      }
    } else if (matchType === -1) {
      if (lookupArray[idx] === lookupValue) {
        return idx + 1;
      } else if (lookupArray[idx] > lookupValue) {
        if (!indexValue) {
          index = idx + 1;
          indexValue = lookupArray[idx];
        } else if (lookupArray[idx] < indexValue) {
          index = idx + 1;
          indexValue = lookupArray[idx];
        }
      }
    }
  }

  return index ? index : functions_error["a" /* ERRORTYPES */].na;
}
// CONCATENATED MODULE: ./src/sheet/functions/vlookup.js
// Copyright 2015-2018 FormBucket LLC


 // VLOOKUP find a needle in a table searching vertically.

function vlookup(needle) {
  var table = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];
  var index = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1;
  var exactmatch = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;

  if (iserror(needle) || isblank(needle)) {
    return needle;
  }

  for (var i = 0; i < table.length; i++) {
    var row = table[i];

    if (index > row.length) {
      return functions_error["a" /* ERRORTYPES */].ref;
    }

    if (exactmatch && row[0] === needle || row[0] == needle || typeof row[0] === 'string' && row[0].toLowerCase().indexOf(needle.toLowerCase()) != -1) {
      return index < row.length + 1 ? row[index - 1] : row[0];
    }
  }

  return functions_error["a" /* ERRORTYPES */].na;
}
// CONCATENATED MODULE: ./src/sheet/functions/formatDate.js








var getDateInstance = function getDateInstance(value) {
  if (/^\d+(\.\d+)?$/.test(value)) return new Date(value);

  if (value.indexOf('-') >= 0) {
    value = value.replace(/-/g, '/');
  } else {
    for (var t = 0, n = ['年', '月', '日', '时', '分', '秒']; t < n.length; t++) {
      var i = n[t];
      value.indexOf(i) >= 0 && (value = value.replace(i, '/'));
    }
  }

  return new Date(value);
};

/* harmony default export */ var formatDate = (function (e, t) {
  function isValidDate(date) {
    return date instanceof Date && !isNaN(date.getTime());
  }

  if (e === '') return e;
  var n = e instanceof Date ? e : getDateInstance(e);
  if (!isValidDate(n)) return e;
  var i = {
    'M+': n.getMonth() + 1,
    'd+': n.getDate(),
    'h+': n.getHours(),
    'm+': n.getMinutes(),
    's+': n.getSeconds(),
    'q+': Math.floor((n.getMonth() + 3) / 3),
    S: n.getMilliseconds()
  };

  for (var r in /(y+)/.test(t) && (t = t.replace(RegExp.$1, (n.getFullYear() + '').substr(4 - RegExp.$1.length))), i) {
    new RegExp('(' + r + ')').test(t) && (t = t.replace(RegExp.$1, 1 === RegExp.$1.length ? i[r] : ('00' + i[r]).substr(('' + i[r]).length)));
  }

  return t;
});
// CONCATENATED MODULE: ./src/sheet/functions/date.js
// Copyright 2015-2018 FormBucket LLC
 // date returns a serial number given a year, month and day.

function date_date(year, month, day) {
  var format = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 'yyyy/MM/dd';
  return formatDate(new Date(year, month - 1, day), format);
}
// CONCATENATED MODULE: ./src/sheet/functions/datevalue.js
// Copyright 2015-2018 FormBucket LLC

 // DATEVALUE parses a date string and returns a serial number.

function datevalue(d) {
  return serial(parsedate(d));
}
// CONCATENATED MODULE: ./src/sheet/functions/datedif.js
// Copyright 2015-2018 FormBucket LLC

 // DATEDIF return the difference between two dates given a start date, end date and unit.

function datedif(start_date, end_date, unit) {
  var second = 1000,
      minute = second * 60,
      hour = minute * 60,
      day = hour * 24,
      week = day * 7;
  start_date = parsedate(start_date), end_date = parsedate(end_date);
  var timediff = end_date - start_date;
  if (isnan(timediff)) return NaN;

  switch (unit) {
    case 'Y':
      return end_date.getFullYear() - start_date.getFullYear();

    case 'M':
      return end_date.getFullYear() * 12 + end_date.getMonth() - (start_date.getFullYear() * 12 + start_date.getMonth());

    case 'W':
      return Math.floor(timediff / week);

    case 'D':
      return Math.floor(timediff / day);

    case 'MD':
      return end_date.getdate() - start_date.getdate();

    case 'YM':
      return end_date.getMonth() - start_date.getMonth();

    case 'YD':
      return new error('NOT IMPLEMENTED');

    default:
      return undefined;
  }
}
// CONCATENATED MODULE: ./src/sheet/functions/day.js
// Copyright 2015-2018 FormBucket LLC

 // DAY parses a date string and returns the day of the month.

function day_day(d) {
  var date = parsedate(d);

  if (isdate(date)) {
    return date.getDate();
  } else {
    return date;
  }
}
// CONCATENATED MODULE: ./src/sheet/functions/days360.js
// Copyright 2015-2018 FormBucket LLC


function days360(start_date, end_date, method) {
  method = parsebool(method);
  start_date = parsedate(start_date);
  end_date = parsedate(end_date);

  if (start_date instanceof Error) {
    return start_date;
  }

  if (end_date instanceof Error) {
    return end_date;
  }

  if (method instanceof Error) {
    return method;
  }

  var sm = start_date.getMonth();
  var em = end_date.getMonth();
  var sd, ed;

  if (method) {
    sd = start_date.getDate() === 31 ? 30 : start_date.getDate();
    ed = end_date.getDate() === 31 ? 30 : end_date.getDate();
  } else {
    var smd = new Date(start_date.getFullYear(), sm + 1, 0).getDate();
    var emd = new Date(end_date.getFullYear(), em + 1, 0).getDate();
    sd = start_date.getDate() === smd ? 30 : start_date.getDate();

    if (end_date.getDate() === emd) {
      if (sd < 30) {
        em++;
        ed = 1;
      } else {
        ed = 30;
      }
    } else {
      ed = end_date.getDate();
    }
  }

  return 360 * (end_date.getFullYear() - start_date.getFullYear()) + 30 * (em - sm) + (ed - sd);
}
// CONCATENATED MODULE: ./src/sheet/functions/edate.js
// Copyright 2015-2018 FormBucket LLC


function edate(start_date, months) {
  start_date = parsedate(start_date);

  if (start_date instanceof Error) {
    return start_date;
  }

  if (isNaN(months)) {
    return error.value;
  }

  months = parseInt(months, 10);
  start_date.setMonth(start_date.getMonth() + months);
  return serial(start_date);
}
// CONCATENATED MODULE: ./src/sheet/functions/eomonth.js
// Copyright 2015-2018 FormBucket LLC


function eomonth(start_date, months) {
  start_date = parsedate(start_date);

  if (start_date instanceof Error) {
    return start_date;
  }

  if (isNaN(months)) {
    return functions_error["a" /* ERRORTYPES */].value;
  }

  months = parseInt(months, 10);
  return new Date(start_date.getFullYear(), start_date.getMonth() + months + 1, 0);
}
// CONCATENATED MODULE: ./src/sheet/functions/hour.js
// Copyright 2015-2018 FormBucket LLC


function hour_hour(value) {
  if (isdate(value)) {
    return value.getHours();
  } // remove numbers before decimal place and convert fraction to 24 hour scale.


  return trunc((value - trunc(value)) * 24);
}
// CONCATENATED MODULE: ./src/sheet/functions/minute.js
// Copyright 2015-2018 FormBucket LLC



function minute_minute(value) {
  if (isdate(value)) {
    return value.getMinutes();
  } // calculate total seconds


  var totalSeconds = (value - trunc(value)) * SecondsInDay; // calculate number of seconds for hour components

  var hourSeconds = trunc(totalSeconds / SecondsInHour) * SecondsInHour; // calculate the number seconds after remove seconds from the hours and convert to minutes

  return trunc((totalSeconds - hourSeconds) / SecondsInMinute);
}
// CONCATENATED MODULE: ./src/sheet/functions/month.js
// Copyright 2015-2018 FormBucket LLC

 // MONTH parses a date value and returns the month of the year.

function month_month(d) {
  var date = parsedate(d);

  if (isdate(date)) {
    return date.getMonth() + 1;
  } else {
    return date;
  }
}
// CONCATENATED MODULE: ./src/sheet/functions/timevalue.js
// Copyright 2015-2018 FormBucket LLC

function timevalue(time_text) {
  // The JavaScript new Date() does not accept only time.
  // To workaround the issue we put 1/1/1900 at the front.
  var date = new Date('1/1/1900 ' + time_text);

  if (date instanceof Error) {
    return date;
  }

  return (SecondsInHour * date.getHours() + SecondsInMinute * date.getMinutes() + date.getSeconds()) / SecondsInDay;
}
// CONCATENATED MODULE: ./src/sheet/functions/now.js
// Copyright 2015-2018 FormBucket LLC


function now() {
  var d = new Date();
  return datevalue(d.toLocaleDateString()) + timevalue(d.toLocaleTimeString());
}
// CONCATENATED MODULE: ./src/sheet/functions/second.js
// Copyright 2015-2018 FormBucket LLC



function second_second(value) {
  if (isdate(value)) {
    return value.getSeconds();
  } // calculate total seconds


  var totalSeconds = (value - trunc(value)) * SecondsInDay; // calculate number of seconds for hour component

  var hourSeconds = trunc(totalSeconds / SecondsInHour) * SecondsInHour; // calculate number of seconds in minute component

  var minuteSeconds = trunc((totalSeconds - hourSeconds) / SecondsInMinute) * SecondsInMinute; // remove seconds for hours and minutes and round to nearest value

  return Math.round(totalSeconds - hourSeconds - minuteSeconds);
}
// CONCATENATED MODULE: ./src/sheet/functions/today.js
// Copyright 2015-2018 FormBucket LLC

function today() {
  var d = new Date();
  return datevalue(d.toLocaleDateString());
}
// CONCATENATED MODULE: ./src/sheet/functions/time.js

// Copyright 2015-2018 FormBucket LLC

function time_time(hour, minute, second) {
  return +((hour * 3600 + minute * 60 + second) / SecondsInDay).toFixed(15);
}
// CONCATENATED MODULE: ./src/sheet/functions/year.js
// Copyright 2015-2018 FormBucket LLC

 // YEAR parses a date value and returns the year of the year.

function year_year(d) {
  var date = parsedate(d);

  if (isdate(date)) {
    return date.getFullYear();
  } else {
    return date;
  }
}
// CONCATENATED MODULE: ./src/sheet/functions/yearfrac.js
// Copyright 2015-2018 FormBucket LLC



function yearfrac(start_date, end_date, basis) {
  start_date = parsedate(start_date);

  if (start_date instanceof Error) {
    return start_date;
  }

  end_date = parsedate(end_date);

  if (end_date instanceof Error) {
    return end_date;
  }

  basis = basis || 0;
  var sd = start_date.getDate();
  var sm = start_date.getMonth() + 1;
  var sy = start_date.getFullYear();
  var ed = end_date.getDate();
  var em = end_date.getMonth() + 1;
  var ey = end_date.getFullYear();

  function isLeapYear(year) {
    return year % 4 === 0 && year % 100 !== 0 || year % 400 === 0;
  }

  function daysBetween(a, b) {
    return serial(b) - serial(a);
  }

  switch (basis) {
    case 0:
      // US (NASD) 30/360
      if (sd === 31 && ed === 31) {
        sd = 30;
        ed = 30;
      } else if (sd === 31) {
        sd = 30;
      } else if (sd === 30 && ed === 31) {
        ed = 30;
      }

      return (ed + em * 30 + ey * 360 - (sd + sm * 30 + sy * 360)) / 360;

    case 1:
      // Actual/actual
      var feb29Between = function feb29Between(date1, date2) {
        var year1 = date1.getFullYear();
        var mar1year1 = new Date(year1, 2, 1);

        if (isLeapYear(year1) && date1 < mar1year1 && date2 >= mar1year1) {
          return true;
        }

        var year2 = date2.getFullYear();
        var mar1year2 = new Date(year2, 2, 1);
        return isLeapYear(year2) && date2 >= mar1year2 && date1 < mar1year2;
      };

      var ylength = 365;

      if (sy === ey || sy + 1 === ey && (sm > em || sm === em && sd >= ed)) {
        if (sy === ey && isLeapYear(sy) || feb29Between(start_date, end_date) || em === 1 && ed === 29) {
          ylength = 366;
        }

        return daysBetween(start_date, end_date) / ylength;
      }

      var years = ey - sy + 1;
      var days = (new Date(ey + 1, 0, 1) - new Date(sy, 0, 1)) / 1000 / 60 / 60 / 24;
      var average = days / years;
      return daysBetween(start_date, end_date) / average;

    case 2:
      // Actual/360
      return daysBetween(start_date, end_date) / 360;

    case 3:
      // Actual/365
      return daysBetween(start_date, end_date) / 365;

    case 4:
      // European 30/360
      return (ed + em * 30 + ey * 360 - (sd + sm * 30 + sy * 360)) / 360;
  }
}
// CONCATENATED MODULE: ./src/sheet/functions/sum.js


// Copyright 2015-2018 FormBucket LLC

/* eslint-disable */

 // SUM a given list of `numbers`

function sum_sum() {
  for (var _len = arguments.length, numbers = new Array(_len), _key = 0; _key < _len; _key++) {
    numbers[_key] = arguments[_key];
  }

  var sum = numbers.reduce(function (accumulator, currentValue) {
    return new bignumber_default.a(accumulator).plus(currentValue);
  }, new bignumber_default.a(0)).toNumber();

  if (isNaN(sum)) {
    var _iterator = _createForOfIteratorHelper(numbers),
        _step;

    try {
      for (_iterator.s(); !(_step = _iterator.n()).done;) {
        var iterator = _step.value;

        if (iserror(iterator)) {
          return iterator;
        }
      }
    } catch (err) {
      _iterator.e(err);
    } finally {
      _iterator.f();
    }
  }

  return sum;
}
// CONCATENATED MODULE: ./src/sheet/functions/average.js
// Copyright 2015-2018 FormBucket LLC

 // AVERAGE computes sum of items divided by number of items

function average_average() {
  // compute sum all of the items.
  var v = sum_sum.apply(void 0, arguments); // return sum when computed error.

  if (iserror(v)) {
    return v;
  } // return sum divided by item count


  return v / arguments.length;
}
// CONCATENATED MODULE: ./src/sheet/functions/min.js
// Copyright 2015-2018 FormBucket LLC



 // MIN returns the smallest number from a `list`.

function min_min() {
  for (var _len = arguments.length, list = new Array(_len), _key = 0; _key < _len; _key++) {
    list[_key] = arguments[_key];
  }

  var values = flatten(list);
  if (values.length === 0) return;
  return reduce(values, function (min, next) {
    if (isblank(min)) return next;else if (isnumber(next)) return Math.min(min, next);else return min;
  });
}
// CONCATENATED MODULE: ./src/sheet/functions/max.js
// Copyright 2015-2018 FormBucket LLC



 // MAX returns the largest number from a `list`.

function max_max() {
  for (var _len = arguments.length, list = new Array(_len), _key = 0; _key < _len; _key++) {
    list[_key] = arguments[_key];
  }

  var values = flatten(list);
  if (values.length === 0) return;
  return reduce(values, function (max, next) {
    if (isblank(max)) return next;else if (isnumber(next)) return Math.max(max, next);else return max;
  });
}
// CONCATENATED MODULE: ./src/sheet/functions/filter.js


// Copyright 2015-2018 FormBucket LLC






 // FILTER limits a range based on arrays of boolean values.

function filter_filter(range) {
  for (var _len = arguments.length, filters = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
    filters[_key - 1] = arguments[_key];
  }

  // A filter is an array of true/false values.
  // The filter may be for rows or for columns but not both.
  // A array filter may only filter a range that covers a single row or a single column.
  function makefilter() {
    return function (value, index) {
      return reduce(filters, function (previousValue, currentValue) {
        if (previousValue === false) {
          return false;
        } else {
          return branch(isarray(currentValue), function () {
            return currentValue[index];
          }, isfunction(currentValue), function () {
            return currentValue(value, index);
          }, istext(currentValue), function () {
            return run(currentValue, value);
          }, functions_error["a" /* ERRORTYPES */].na);
        }
      }, true);
    };
  }

  return range.filter(makefilter());
}
// CONCATENATED MODULE: ./src/sheet/functions/query.js



// Copyright 2015-2018 FormBucket LLC
//
// A minimal query engine with a mongodb like syntax.
//
// query([{ foo: 1}, {foo: 2}], { foo: 1 })
// query([{ foo: 1}, {foo: 2}], { foo: { $ne: 1 } })
//
// Supported operators:
//  - $and
//  - $or
//  - $eq
//  - $ne
//  - $gt
//  - $gte
//  - $lt
//  - $lte
//  - $exists
//  - $nin
//  - $in
//  - $text


















 // Functions for each operator.

var filterTypes = {
  $noop: function $noop() {
    return function () {
      return false;
    };
  },
  $eq: function $eq(queryVal) {
    return function (row, field) {
      return eq(row[field], queryVal);
    };
  },
  $ne: function $ne(queryVal) {
    return function (row, field) {
      return ne(row[field], queryVal);
    };
  },
  $gt: function $gt(queryVal) {
    return function (row, field) {
      return gt(row[field], queryVal);
    };
  },
  $gte: function $gte(queryVal) {
    return function (row, field) {
      return gte(row[field], queryVal);
    };
  },
  $lt: function $lt(queryVal) {
    return function (row, field) {
      return lt(row[field], queryVal);
    };
  },
  $lte: function $lte(queryVal) {
    return function (row, field) {
      return lte(row[field], queryVal);
    };
  },
  $in: function $in(queryVal) {
    return function (row, field) {
      return isarray(queryVal) && includes_includes(row[field], queryVal);
    };
  },
  $nin: function $nin(queryVal) {
    return function (row, field) {
      return isarray(queryVal) && !includes_includes(row[field], queryVal);
    };
  },
  $text: function $text(queryVal) {
    return function (row, field) {
      return search_search(queryVal, row[field]) > 0;
    };
  },
  $exists: function $exists(queryVal) {
    return function (row, field) {
      return istruthy(queryVal) ? row.hasOwnProperty(field) : !row.hasOwnProperty(field);
    };
  },
  $and: function $and(queryVal) {
    return function (row, field) {
      return true;
    };
  },
  $or: function $or(queryVal) {
    return function (row, field) {
      return true;
    };
  }
}; // Run the filter against the data with the settings.

function query_query(data, query) {
  var comparison = function comparison(field, op, value) {
    return function (row) {
      return (filterTypes[op] || filterTypes['$noop'])(value)(row, field);
    };
  };

  var comparator = function comparator(list, key) {
    return function (row) {
      return branch(isobject(list[key]), function () {
        return and.apply(void 0, _toConsumableArray(map(keys_keys(list[key]), function (d) {
          return comparison(key, d, list[key][d])(row);
        })));
      }, function () {
        return comparison(key, '$eq', list[key])(row);
      });
    };
  };

  var comparisonGroup = function comparisonGroup(row, list, key) {
    var op = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : and;

    if (!isarray(list[key])) {
      throw new Error("$".concat(op.name, " expects array!"));
    }

    return op.apply(void 0, _toConsumableArray(map(list[key], function (d) {
      return op.apply(void 0, _toConsumableArray(map(keys_keys(d), function (e) {
        return comparator(d, e)(row);
      })));
    })));
  };

  var composeQuery = function composeQuery(list) {
    return reduce(keys_keys(list), function (funcs, key) {
      return funcs.concat(function (row) {
        return branch(key === '$and', function () {
          return comparisonGroup(row, list, key, and);
        }, key === '$or', function () {
          return comparisonGroup(row, list, key, or);
        }, function () {
          return comparator(list, key)(row);
        });
      });
    }, []);
  }; // Compose a list of functions to filter each field.


  var funcs = composeQuery(query); // Execute the filter on the data.

  return filter_filter.apply(void 0, [data].concat(_toConsumableArray(map(funcs, function (filter) {
    return map(data, function (row) {
      return filter(row);
    });
  }))));
}
// CONCATENATED MODULE: ./src/sheet/functions/accrint.js
// Copyright 2015-2018 FormBucket LLC




 // Returns the accrued interest for a security that pays periodic interest.

function accrint(issue, first, settlement, rate, par, frequency) {
  var basis = arguments.length > 6 && arguments[6] !== undefined ? arguments[6] : 0;
  // Return error if either date is invalid
  var issueDate = parsedate(issue);
  var firstDate = parsedate(first);
  var settlementDate = parsedate(settlement);

  if (!isdate(issueDate) || !isdate(firstDate) || !isdate(settlementDate) || !isnumber(par)) {
    return functions_error["a" /* ERRORTYPES */].value;
  } // Return error if either rate or par are lower than or equal to zero


  if (rate <= 0 || par <= 0) {
    return functions_error["a" /* ERRORTYPES */].num;
  } // Return error if frequency is neither 1, 2, or 4


  if ([1, 2, 4].indexOf(frequency) === -1) {
    return functions_error["a" /* ERRORTYPES */].num;
  } // Return error if basis is neither 0, 1, 2, 3, or 4


  if ([0, 1, 2, 3, 4].indexOf(basis) === -1) {
    return functions_error["a" /* ERRORTYPES */].num;
  } // Return error if settlement is before or equal to issue


  if (settlementDate <= issueDate) {
    return functions_error["a" /* ERRORTYPES */].num;
  } // Compute accrued interest


  return par * rate * yearfrac(issue, settlement, basis);
}
// CONCATENATED MODULE: ./src/sheet/functions/fv.js
// Copyright 2015-2018 FormBucket LLC


function fv_fv(rate, periods, payment) {
  var value = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0;
  var type = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 0;
  // is this error code correct?
  if (isblank(rate)) return functions_error["a" /* ERRORTYPES */].na;
  if (isblank(periods)) return functions_error["a" /* ERRORTYPES */].na;
  if (isblank(payment)) return functions_error["a" /* ERRORTYPES */].na;
  var fv;

  if (rate === 0) {
    fv = value + payment * periods;
  } else {
    var term = Math.pow(1 + rate, periods);

    if (type === 1) {
      fv = value * term + payment * (1 + rate) * (term - 1) / rate;
    } else {
      fv = value * term + payment * (term - 1) / rate;
    }
  }

  return -fv;
}
// CONCATENATED MODULE: ./src/sheet/functions/nper.js
// Copyright 2015-2018 FormBucket LLC

function nper(rate, pmt, pv, fv, type) {
  var log, result;
  rate = parseFloat(rate || 0);
  pmt = parseFloat(pmt || 0);
  pv = parseFloat(pv || 0);
  fv = fv || 0;
  type = type || 0;

  log = function log(prim) {
    if (isnan(prim)) {
      return Math.log(0);
    }

    var num = Math.log(prim);
    return num;
  };

  if (rate == 0.0) {
    result = -(pv + fv) / pmt;
  } else if (type > 0.0) {
    result = log(-(rate * fv - pmt * (1.0 + rate)) / (rate * pv + pmt * (1.0 + rate))) / log(1.0 + rate);
  } else {
    result = log(-(rate * fv - pmt) / (rate * pv + pmt)) / log(1.0 + rate);
  }

  if (isnan(result)) {
    result = 0;
  }

  return result;
}
// CONCATENATED MODULE: ./src/sheet/functions/npv.js
// Copyright 2015-2018 FormBucket LLC
 // `npv` returns the net present value of an investment.

function npv(rate) {
  for (var _len = arguments.length, values = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
    values[_key - 1] = arguments[_key];
  }

  var result = reduce(values, function (p, v) {
    var factor = p.factor * (1 + rate);
    var sum = p.sum + +v / factor;
    return {
      factor: factor,
      sum: sum
    };
  }, {
    factor: 1,
    sum: 0
  });
  return result.sum;
}
// CONCATENATED MODULE: ./src/sheet/functions/pmt.js
// Copyright 2015-2018 FormBucket LLC

 // PMT returns a loan payment

function pmt_pmt(rate, periods, present) {
  var future = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0;
  var type = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 0;

  if (!isnumber(rate) || !isnumber(periods)) {
    return functions_error["a" /* ERRORTYPES */].value;
  }

  if (rate === 0) {
    return -((present + future) / periods);
  } else {
    var term = Math.pow(1 + rate, periods);

    if (type === 1) {
      return -((future * rate / (term - 1) + present * rate / (1 - 1 / term)) / (1 + rate));
    } else {
      return -(future * rate / (term - 1) + present * rate / (1 - 1 / term));
    }
  }
}
// CONCATENATED MODULE: ./src/sheet/functions/cumipmt.js
// Copyright 2015-2018 FormBucket LLC






function cumipmt(rate, periods, value, start, end, type) {
  // Credits: algorithm inspired by Apache OpenOffice
  // Credits: Hannes Stiebitzhofer for the translations of function and variable names
  rate = numbervalue(rate);
  periods = numbervalue(periods);
  value = numbervalue(value); // check if any inputs are errors.

  if (iserror(rate) || iserror(periods) || iserror(value)) {
    return functions_error["b" /* default */].value;
  } // Return error if either rate, periods, or value are lower than or equal to zero


  if (rate <= 0 || periods <= 0 || value <= 0) {
    return functions_error["b" /* default */].num;
  } // Return error if start < 1, end < 1, or start > end


  if (start < 1 || end < 1 || start > end) {
    return functions_error["b" /* default */].num;
  } // Return error if type is neither 0 nor 1


  if (type !== 0 && type !== 1) {
    return functions_error["b" /* default */].num;
  } // Compute cumulative interest


  var payment = pmt_pmt(rate, periods, value, 0, type);
  var interest = 0;

  if (start === 1) {
    if (type === 0) {
      interest = -value;
      start++;
    }
  }

  for (var i = start; i <= end; i++) {
    if (type === 1) {
      interest += fv_fv(rate, i - 2, payment, value, 1) - payment;
    } else {
      interest += fv_fv(rate, i - 1, payment, value, 0);
    }
  }

  interest *= rate; // Return cumulative interest

  return interest;
}

/* harmony default export */ var functions_cumipmt = (cumipmt);
// CONCATENATED MODULE: ./src/sheet/functions/ipmt.js
// Copyright 2015-2018 FormBucket LLC






function ipmt(rate, period, periods, present) {
  var future = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 0;
  var type = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : 0;
  // parse numbers from input.
  rate = numbervalue(rate);
  period = numbervalue(period);
  periods = numbervalue(periods);
  present = numbervalue(present);
  future = numbervalue(future);
  type = numbervalue(type);

  if (iserror(rate, period, periods, present, future, type)) {
    return functions_error["b" /* default */].value;
  } // Compute payment


  var payment = pmt_pmt(rate, periods, present, future, type); // Compute interest

  var interest;

  if (period === 1) {
    if (type === 1) {
      interest = 0;
    } else {
      interest = -present;
    }
  } else {
    if (type === 1) {
      interest = fv_fv(rate, period - 2, payment, present, 1) - payment;
    } else {
      interest = fv_fv(rate, period - 1, payment, present, 0);
    }
  } // Return interest


  return interest * rate;
}

/* harmony default export */ var functions_ipmt = (ipmt);
// CONCATENATED MODULE: ./src/sheet/functions/pv.js
// Copyright 2015-2018 FormBucket LLC


function pv_pv(rate, periods, payment) {
  var future = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0;
  var type = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 0;
  // is this error code correct?
  if (isblank(rate)) return functions_error["a" /* ERRORTYPES */].na;
  if (isblank(periods)) return functions_error["a" /* ERRORTYPES */].na;
  if (isblank(payment)) return functions_error["a" /* ERRORTYPES */].na;

  if (rate === 0) {
    return -payment * periods - future;
  } else {
    return ((1 - Math.pow(1 + rate, periods)) / rate * payment * (1 + rate * type) - future) / Math.pow(1 + rate, periods);
  }
}
// CONCATENATED MODULE: ./src/sheet/functions/bin2dec.js


// Copyright 2015-2018 FormBucket LLC
 // BIN2DEC converts binary string into decimal value

function bin2dec(value) {
  var valueAsString;

  if (typeof value === 'string') {
    valueAsString = value;
  } else if (typeof value !== 'undefined') {
    valueAsString = value.toString();
  } else {
    return functions_error["a" /* ERRORTYPES */].NA;
  }

  if (valueAsString.length > 10) return functions_error["a" /* ERRORTYPES */].NUM; // we subtract 512 when the leading number is 0.

  if (valueAsString.length === 10 && valueAsString[0] === '1') {
    return parseInt(valueAsString.substring(1), 2) - 512;
  } // Convert binary number to decimal with built-in facility


  return parseInt(valueAsString, 2);
}
// CONCATENATED MODULE: ./src/sheet/functions/dec2bin.js




// Copyright 2015-2018 FormBucket LLC


 // based on https://github.com/sutoiku/formula.js/blob/mast../src/engineering.js

function dec2bin(input, places) {
  // cast input to number
  var number = parseInt(input); // exit if input is an error

  if (input instanceof Error) {
    return number;
  }

  if (!/^-?[0-9]{1,3}$/.test(number) || isnan(number)) {
    return functions_error["a" /* ERRORTYPES */].value;
  } // Return error.if number is not decimal, is lower than -512, or is greater than 511


  if (number < -512 || number > 511) {
    return functions_error["a" /* ERRORTYPES */].num;
  } // Ignore places and return a 10-character binary number if number is negative


  if (number < 0) {
    return '1' + rept('0', 9 - (512 + number).toString(2).length) + (512 + number).toString(2);
  } // Convert decimal number to binary


  var result = parseInt(number, 10).toString(2); // Return binary number using the minimum number of characters necessary if places is undefined

  if (typeof places === 'undefined') {
    return result;
  } else {
    // Return error.if places is nonnumeric
    if (!/^-?[0-9]{1,3}$/.test(places) || isnan(places)) {
      return functions_error["a" /* ERRORTYPES */].value;
    } // Return error.if places is negative


    if (places < 0) {
      return functions_error["a" /* ERRORTYPES */].num;
    } // Truncate places in case it is not an integer


    places = Math.floor(places); // Pad return value with leading 0s (zeros) if necessary (using Underscore.string)

    return places >= result.length ? rept('0', places - result.length) + result : functions_error["a" /* ERRORTYPES */].num;
  }
}
// CONCATENATED MODULE: ./src/sheet/functions/oct2dec.js


// Copyright 2015-2018 FormBucket LLC
 // OCT2DEC converts an octal value into a decimal value.

function oct2dec(octalNumber) {
  // Credits: Based on implementation found in https://gist.github.com/ghalimi/4525876#file-oct2dec-js
  // Return error.when number passed in is not octal or has more than 10 digits
  if (!/^[0-7]{1,10}$/.test(octalNumber)) return functions_error["a" /* ERRORTYPES */].num; // Convert octal number to decimal number

  var nonNegativeDecimalNumber = parseInt(octalNumber, 8); // Returns the corresponding decimal number
  // Two's Complement Decimal Range: -(2^N-1) to (2^N-1 - 1) where N=30 (N = number of bits) and ^ means raised to the power of
  // 2^N-1 = 2^(30 - 1) = 2^29 = 536870912
  // 2^N-1 - 1 = 536870912 - 1 = 536870911
  // 2^N = 2^30 = 1073741824
  // Two's Complement Decimal Range: [-536870912,536870911]
  // Largest octal number allowed: 7777777777 which in decimal is 1073741823 = 2^N - 1
  // Case 1: Negative Range
  //  if nonNegativeDecimalNumber >= 2^N-1, then return (nonNegativeNumber - 2^N)
  //  Smallest Number: 2^N-1 - 2^N = 2^N-1 - 2*2^N-1 = 2^N-1 * (1 - 2) = 2^N-1 * (-1) = -2^N-1
  //  Largest Number: (2^N - 1) - (2^N) = (2^N - 2^N) - 1 = -1
  //  Range: [-2^N-1, -1] = [-536870912, -1]
  //
  // Smallest octal number allowed: 0 which in decimal is 0
  // Case 2: Non-Negative Range
  //   Range: [0, 2^N-1 - 1] = [0, 536870911]

  return nonNegativeDecimalNumber >= 536870912 ? nonNegativeDecimalNumber - 1073741824 : nonNegativeDecimalNumber;
}
// CONCATENATED MODULE: ./src/sheet/functions/pluck.js
// Copyright 2015-2018 FormBucket LLC


 // pluck a property from a list of objects.

function pluck(prop, list) {
  // Ensure that the list is an array.
  if (!isarray(list)) {
    return functions_error["a" /* ERRORTYPES */].na;
  } // Map the list to the property.


  return map(list, function (d) {
    return d[prop];
  });
}
// CONCATENATED MODULE: ./src/sheet/functions/some.js

// Copyright 2015-2018 FormBucket LLC



 // some returns true when a needle is found in a list.

function some(needle, list) {
  // Return `#NA!` when the needle and list are blank.
  if (isblank(needle) && isblank(list)) {
    return functions_error["a" /* ERRORTYPES */].na;
  } // Return `#NA!` when the list is not an array.


  if (!isarray(list)) {
    return functions_error["a" /* ERRORTYPES */].na;
  } // Return true when some of the values match the needle.


  return list.some(function (n) {
    return eq(n, needle);
  });
}
// CONCATENATED MODULE: ./src/sheet/functions/sort.js

// Copyright 2015-2018 FormBucket LLC

 // SORT an array of objects.
//
// sort(reference(reference: Array, ...criteria : List<string>)
//
// The list<string> will also be reduced into a single function which
// interprets the strings as pairs. The odd items are fields and the
// even ones are direction (ASC|DESC).

function sort(ref) {
  for (var _len = arguments.length, criteria = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
    criteria[_key - 1] = arguments[_key];
  }

  // reduce the criteria array into a function
  var makeComparer = function makeComparer() {
    return function (a, b) {
      var result = 0;

      for (var i = 0; i < criteria.length; i = i + 2) {
        if (result !== 0) continue;
        var field = typeof criteria[i] === 'string' ? criteria[i] : criteria[i] - 1,
            order = criteria[i + 1];

        if (a[field] < b[field]) {
          result = order ? -1 : 1;
        }

        if (a[field] > b[field]) {
          result = order ? 1 : -1;
        }
      }

      return result;
    };
  };

  if (!isarray(ref)) {
    return functions_error["a" /* ERRORTYPES */].na;
  }

  return ref.sort(makeComparer());
}
// CONCATENATED MODULE: ./src/sheet/functions/unflatten.js

// Copyright 2015-2018 FormBucket LLC


 // convert array into nested array.
// example: unflatten([1,2,3,4]) -> [[1,2], [3, 4]]

function unflatten(ref) {
  var len = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 2;

  // if the reference data is not an array then stop.
  if (!isarray(ref)) {
    return functions_error["a" /* ERRORTYPES */].value;
  } // use a reduction algorithm to convert data.


  return reduce(ref, function (p, v, i) {
    // The first iteration and every nth iteration.
    if (i === 0 || i % len === 0) {
      p = p.concat([[]]);
    } // determine last index in collected value (e.g. p).


    var lastIndex = p.length - 1; // add the value to the last available spot.

    p[lastIndex] = p[lastIndex].concat(v); // return the new collected value.

    return p;
  }, []);
}
// CONCATENATED MODULE: ./src/sheet/functions/changed.js



// Copyright 2015-2018 FormBucket LLC

 // Computes the list of keys that are different between two objects.

function changed(a, b) {
  // Compute the keys in object a and b.
  var keysA = keys_keys(a),
      keysB = keys_keys(b); // Find the unique set of properties comparing a to b and b to a.

  return unique(keysA.filter(function (n) {
    return a[n] !== b[n];
  }).concat(keysB.filter(function (n) {
    return a[n] !== b[n];
  })));
}
// CONCATENATED MODULE: ./src/sheet/functions/diff.js


// Copyright 2015-2018 FormBucket LLC



function diff_diff(a, b) {
  var keysA = keys_keys(a),
      keysB = keys_keys(b),
      InA = keysB.filter(function (n) {
    return keysA.indexOf(n) > -1;
  }),
      NotInA = keysB.filter(function (n) {
    return keysA.indexOf(n) === -1;
  }),
      NotInB = keysA.filter(function (n) {
    return keysB.indexOf(n) === -1;
  }),
      Diff = InA.filter(function (n) {
    return a[n] !== b[n];
  });
  return {
    unique_left: NotInA,
    unique_right: NotInB,
    diff: reduce(Diff, function (x, y) {
      var diff = {};
      diff[y] = {
        left: a[y],
        right: b[y]
      };
      return functions_assign({}, x, diff);
    }, {})
  };
}
// CONCATENATED MODULE: ./src/sheet/functions/select.js




// Copyright 2015-2018 FormBucket LLC

 // SELECT fields from o

function select_select(fields, o) {
  // non-json
  if (!o || 'object' != _typeof(o)) return; // check for fields

  if (!fields) return; // split

  if ('string' == typeof fields) fields = fields.split(/ *, */); // fields array

  if (isarray(o)) {
    return o.map(function (obj) {
      return reduce(fields, function (ret, key) {
        ret[key] = obj[key];
        return ret;
      }, {});
    });
    return;
  } // fields o


  return reduce(fields, function (ret, key) {
    ret[key] = o[key];
    return ret;
  }, {});
}
// CONCATENATED MODULE: ./src/sheet/functions/clean.js


// Copyright 2015-2018 FormBucket LLC


 // CLEAN accepts an object and remove properties that are blank.

function clean(obj) {
  // Compute keys where value is non blank.
  var keys = keys_keys(obj).filter(function (n) {
    return !isblank(obj[n]);
  }); // Compute object with only non-blank keys.

  return select_select(keys, obj);
}
// CONCATENATED MODULE: ./src/sheet/functions/get.js
// Copyright 2015-2018 FormBucket LLC
// get a property (p) from an object (o)
function get(p, o) {
  return o[p];
}
// CONCATENATED MODULE: ./src/sheet/functions/columnletter.js
// Copyright 2015-2018 FormBucket LLC

 // Convert index to letter (e.g 0 -> A)

function columnletter(index) {
  if (!isnumber(index)) {
    return functions_error["a" /* ERRORTYPES */].value;
  } // The column is determined by applying a modified Hexavigesimal algorithm.
  // Normally BA follows Z but spreadsheets count wrong and nobody cares.
  // Instead they do it in a way that makes sense to most people but
  // is mathmatically incorrect. So AA follows Z which in the base 10
  // system is like saying 01 follows 9.
  // In the least significant digit
  // A..Z is 0..25
  // For the second to nth significant digit
  // A..Z is 1..26


  var converted = '',
      secondPass = false,
      remainder,
      value = Math.abs(index);

  do {
    remainder = value % 26;

    if (secondPass) {
      remainder--;
    }

    converted = String.fromCharCode(remainder + 'A'.charCodeAt(0)) + converted;
    value = Math.floor((value - remainder) / 26);
    secondPass = true;
  } while (value > 0);

  return converted;
}
// CONCATENATED MODULE: ./src/sheet/functions/address.js


// Copyright 2015-2018 FormBucket LLC
 // ADDRESS converts a row and column into an address (e.g A1)

function address(row, col, absoluteRelativeMode) {
  // convert column number into letter
  var colLetter = columnletter(col - 1);

  switch (absoluteRelativeMode) {
    // Mode 0 returns `{column}{LETTER}`
    case 0:
      return colLetter + row.toString();
    // Mode 2 returns `{column}${LETTER}`

    case 2:
      return colLetter + '$' + row.toString();
    // Mode 3 returns `${column}{LETTER}`

    case 3:
      return '$' + colLetter + row.toString();
    // Default mode returns `${column}${LETTER}`

    default:
      return '$' + colLetter + '$' + row.toString();
  }
}
// CONCATENATED MODULE: ./src/sheet/functions/base.js



// Copyright 2015-2018 FormBucket LLC
 // Return a number into a text representation with the given radix

function base_base(number, radix) {
  var minLength = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;
  number = numbervalue(number);
  radix = numbervalue(radix);
  minLength = numbervalue(minLength); // if (fn.isAnyError(number, radix, minLength)) {
  //   return error.value;
  // }

  minLength = minLength === undefined ? 0 : minLength;
  var result = number.toString(radix);
  return new Array(Math.max(minLength + 1 - result.length, 0)).join('0') + result;
}
// CONCATENATED MODULE: ./src/sheet/functions/cellindex.js
// Copyright 2015-2018 FormBucket LLC
 // Computes the index for row and column in a 2 dimensional array.

function cellindex(row, col) {
  // Multiple row by maximum columns plus the col.
  return Math.floor(row * MaxCols + col);
}
// CONCATENATED MODULE: ./src/sheet/functions/ceiling.js
// Copyright 2015-2018 FormBucket LLC

 // Returns number rounded up, away from zero, to the nearest multiple of significance.

function ceiling(number, significance, mode) {
  significance = significance === undefined ? 1 : Math.abs(significance);
  mode = mode || 0;
  number = numbervalue(number);
  significance = numbervalue(significance);
  mode = numbervalue(mode); // if (utils.isAnyError(number, significance, mode)) {
  //   return error.value;
  // }

  if (significance === 0) {
    return 0;
  }

  var precision = -Math.floor(Math.log(significance) / Math.log(10));

  if (number >= 0) {
    return round_round(Math.ceil(number / significance) * significance, precision);
  } else {
    if (mode === 0) {
      return -round_round(Math.floor(Math.abs(number) / significance) * significance, precision);
    } else {
      return -round_round(Math.ceil(Math.abs(number) / significance) * significance, precision);
    }
  }
}
// CONCATENATED MODULE: ./src/sheet/functions/columnnumber.js
// Copyright 2015-2018 FormBucket LLC

 // Convert letter to number (e.g A -> 0)

function columnnumber(column) {
  if (!istext(column)) {
    return functions_error["a" /* ERRORTYPES */].value;
  } // see toColumn for rant on why this is sensible even though it is illogical.


  var s = 0,
      secondPass;

  if (column.length > 0) {
    s = column.charCodeAt(0) - 'A'.charCodeAt(0);

    for (var i = 1; i < column.length; i++) {
      // compensate for spreadsheet column naming
      s += 1;
      s *= 26;
      s += column.charCodeAt(i) - 'A'.charCodeAt(0);
      secondPass = true;
    }

    return s;
  }

  return functions_error["a" /* ERRORTYPES */].value;
}
// CONCATENATED MODULE: ./src/sheet/functions/column.js
// Copyright 2015-2018 FormBucket LLC


 // COLUMN return the column number that corresponds to the reference.

function column_column(value) {
  // Return `#VALUE!` when the value is not a reference.
  if (!isref(value)) {
    return functions_error["a" /* ERRORTYPES */].value;
  } // Run the COLUMNNUMBER and convert to base 1.


  return columnnumber(value.column) + 1;
}
// EXTERNAL MODULE: ./src/sheet/functions/decodebase64.js
var decodebase64 = __webpack_require__("9ff1");

// CONCATENATED MODULE: ./src/sheet/functions/decodejwt.js







// Copyright 2015-2018 FormBucket LLC

function decodejwt(token) {
  function b64DecodeUnicode(str) {
    return decodeURIComponent(Array.prototype.map.call(Object(decodebase64["a" /* default */])(str), function (c) {
      return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);
    }).join(''));
  }

  return JSON.parse(b64DecodeUnicode(token.split('.')[1]));
}
// CONCATENATED MODULE: ./src/sheet/functions/entries.js

 // convert an object in an array of entries.
// Example: { foo: 'bar' } -> [['foo', 'bar']]

function entries(obj) {
  // Run native function if available.
  if (Object.entries) return Object.entries(obj); // Execute polyfill.
  // credit: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/entries

  var ownProps = keys_keys(obj),
      i = ownProps.length,
      resArray = new Array(i); // preallocate the Array

  while (i--) {
    resArray[i] = [ownProps[i], obj[ownProps[i]]];
  }

  return resArray;
}
// CONCATENATED MODULE: ./src/sheet/functions/even.js
// Copyright 2015-2018 FormBucket LLC
 // Returns number rounded up to the nearest even integer.

function even(number) {
  // TBD: error cases
  return ceiling(number, -2, -1);
}
// CONCATENATED MODULE: ./src/sheet/functions/floor.js
// Copyright 2015-2018 FormBucket LLC

function floor(value, significance) {
  significance = significance || 1;

  if (value > 0 && significance < 0) {
    return functions_error["a" /* ERRORTYPES */].num;
  }

  if (value >= 0) {
    return Math.floor(value / significance) * significance;
  } else {
    return Math.ceil(value / significance) * significance;
  }
}
// CONCATENATED MODULE: ./src/sheet/functions/group.js


// Copyright 2015-2018 FormBucket LLC
 // Group a list of objects by one or more fields.

function group(list) {
  for (var _len = arguments.length, fields = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
    fields[_key - 1] = arguments[_key];
  }

  // Reduce the list into an object.
  return reduce(list, function (acc, item) {
    // Copyright @ 2015-2016 JC Fisher
    var parent = undefined,
        key; // Walk through each field and update the accumulator.

    fields.forEach(function (currentField, index) {
      // The key is the value of the current item.
      key = item[currentField]; // Handle the last field used to group.

      if (index === fields.length - 1) {
        if (!parent) {
          if (!acc[key]) {
            acc[key] = [];
          }

          acc[key].push(item);
        } else {
          if (!parent[key]) {
            parent[key] = [];
          }

          parent[key].push(item);
        } // Handle the first k fields before the last field

      } else {
        if (!parent) {
          acc[key] = acc[key] || {};
          parent = acc[key];
        } else {
          parent[key] = parent[key] || {};
          parent = parent[key];
        }
      }
    });
    return acc;
  }, {});
}
// CONCATENATED MODULE: ./src/sheet/functions/guid.js




// Copyright 2015-2018 FormBucket LLC
// credit to http://stackoverflow.com/questions/105034/create-guid-uuid-in-javascript
// rfc4122 version 4 compliant solution
// Generate a globally unique identifier
function guid() {
  var guid = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {
    var r = Math.random() * 16 | 0,
        v = c == 'x' ? r : r & 0x3 | 0x8;
    return v.toString(16);
  });
  return guid;
}
// CONCATENATED MODULE: ./src/sheet/functions/hash.js
//github.com/darkskyapp/string-hash/blob/master/index.js


function hash(str) {
  var hash = 5381,
      i = str.length;

  while (i) {
    hash = hash * 33 ^ str.charCodeAt(--i);
  }
  /* JavaScript does bitwise operations (like XOR, above) on 32-bit signed
   * integers. Since we want the results to be always positive, convert the
   * signed int to an unsigned by doing an unsigned bitshift. */


  return hash >>> 0;
}
// CONCATENATED MODULE: ./src/sheet/functions/int.js
// Copyright 2015-2018 FormBucket LLC
function int_int(value) {
  return Math.floor(value);
}
// CONCATENATED MODULE: ./src/sheet/functions/index2row.js
// Copyright 2015-2018 FormBucket LLC
 // INDEX2COL computes the row given a cell index

function index2row(index) {
  return Math.floor(index / MaxCols);
}
// CONCATENATED MODULE: ./src/sheet/functions/index2col.js
// Copyright 2015-2018 FormBucket LLC

 // INDEX2COL computes the column given a cell index

function index2col(index) {
  return index - index2row(index) * MaxCols;
}
// CONCATENATED MODULE: ./src/sheet/functions/intersect.js
// Computes true or false if two rectangles intersect.
// A rect is defined as having left, right, top and bottom.


function intersect(a, b) {
  if (!isobject(a)) return functions_error["b" /* default */].na;
  if (!isobject(b)) return functions_error["b" /* default */].na;
  return Math.max(a.left, b.left) < Math.min(a.right, b.right) && Math.max(a.top, b.top) < Math.min(a.bottom, b.bottom);
}
// CONCATENATED MODULE: ./src/sheet/functions/interpolator.js





 // Functor to create a function that runs the percentage between two values;
// Usage: interpolator(0, 100)(0.5) == 50
// Credit: https://github.com/sveltejs/svelte/blob/master/src/motion/tweened.ts

function interpolator(a, b) {
  if (a === b || a !== a) return function () {
    return a;
  };

  var type = _typeof(a);

  if (type !== _typeof(b) || Array.isArray(a) !== Array.isArray(b)) {
    throw new Error('Cannot interpolate values of different type');
  }

  if (Array.isArray(a)) {
    var arr = b.map(function (bi, i) {
      return interpolator(a[i], bi);
    });
    return function (t) {
      return arr.map(function (fn) {
        return fn(t);
      });
    };
  }

  if (type === 'object') {
    if (!a || !b) throw new Error('Object cannot be null');

    if (isdate(a) && isdate(b)) {
      a = a.getTime();
      b = b.getTime();
      var delta = b - a;
      return function (t) {
        return new Date(a + t * delta);
      };
    }

    var keys = Object.keys(b);
    var interpolators = {};
    keys.forEach(function (key) {
      interpolators[key] = interpolator(a[key], b[key]);
    });
    return function (t) {
      var result = {};
      keys.forEach(function (key) {
        result[key] = interpolators[key](t);
      });
      return result;
    };
  }

  if (type === 'number') {
    var _delta = b - a;

    return function (t) {
      return a + t * _delta;
    };
  }

  throw new Error("Cannot interpolate ".concat(type, " values"));
}
// CONCATENATED MODULE: ./src/sheet/functions/interpolate.js
 // Compute a number a percentage distance between a and b.
// Usage: interpolate(0, 100, 0.5) == 50
// Credit: https://github.com/sveltejs/svelte/blob/master/src/motion/tweened.ts

function interpolate(a, b, percentage) {
  return interpolator(a, b)(percentage);
}
// CONCATENATED MODULE: ./src/sheet/functions/numbers.js


// Copyright 2015-2018 FormBucket LLC
 // Filters non-numeric values from `values`.

function numbers_numbers() {
  for (var _len = arguments.length, values = new Array(_len), _key = 0; _key < _len; _key++) {
    values[_key] = arguments[_key];
  }

  return values.filter(isnumber);
}
// CONCATENATED MODULE: ./src/sheet/functions/overlap.js


function overlap(a, b) {
  if (!isobject(a)) return functions_error["b" /* default */].na;
  if (!isobject(b)) return functions_error["b" /* default */].na;
  return a.left >= b.left && a.right <= b.right && a.top >= b.top && a.bottom <= b.bottom;
}
// CONCATENATED MODULE: ./src/sheet/functions/ref.js

// Copyright 2015-2018 FormBucket LLC







 // REF accepts top and bottom and returns a reference object. It encapsulates a cell or a range.

function ref_ref(top, bottom) {
  // The index must be a number
  if (!isnumber(top) && !isfunction(top)) {
    return functions_error["a" /* ERRORTYPES */].value;
  }

  if (isblank(bottom)) {
    bottom = top;
  }

  var getTop = function getTop() {
    return isfunction(top) ? top() : top;
  };

  var getBottom = function getBottom() {
    return isfunction(bottom) ? bottom() : bottom;
  };

  return {
    get _isref() {
      return true;
    },

    get top() {
      return getTop();
    },

    get bottom() {
      return getBottom();
    },

    // Returns row (rowIndex plus 1)
    get row() {
      return index2row(getTop()) + 1;
    },

    // Returns rowIndex (base 0)
    get rowIndex() {
      return index2row(getTop());
    },

    // Returns column letter
    get column() {
      return columnletter(index2col(getTop()));
    },

    // Returns column index
    get columnIndex() {
      return index2col(getTop());
    },

    // Returns row (rowIndex plus 1)
    get bottomRow() {
      return index2row(getBottom()) + 1;
    },

    // Returns rowIndex (base 0)
    get bottomRowIndex() {
      return index2row(getBottom());
    },

    // Returns column letter
    get bottomColumn() {
      return columnletter(index2col(getBottom()));
    },

    // Returns column index
    get bottomColumnIndex() {
      return index2col(getBottom());
    },

    // The cell id puts the whole table into a single dimension. It simply needs to be between the topLeft and the bottomRight to qualify.
    hit: function hit(index) {
      // Return `#NA!` when index is negative.
      if (index < 0) return functions_error["a" /* ERRORTYPES */].na; // Check if value is inside range from top to bottom, inclusive.

      return index >= getTop() && index <= getBottom();
    },

    get size() {
      return 1 + (getBottom() - getTop());
    },

    // Return array with every cell index
    get cells() {
      return Array.apply(getTop(), Array(1 + (getBottom() - getTop()))).map(function (x, y) {
        return y + getTop();
      });
    },

    // Return array with every row
    get rows() {
      return unique(Array.apply(getTop(), Array(1 + (getBottom() - getTop()))).map(function (x, y) {
        return index2row(y + getTop());
      }));
    }

  };
}
// CONCATENATED MODULE: ./src/sheet/functions/concat.js

/* harmony default export */ var concat = (function () {
  for (var _len = arguments.length, params = new Array(_len), _key = 0; _key < _len; _key++) {
    params[_key] = arguments[_key];
  }

  return params.join('');
});
// CONCATENATED MODULE: ./src/sheet/functions/mid.js
/* harmony default export */ var mid = (function (text, startNum, numChars) {
  return "".concat(text).substr(startNum - 1, numChars);
});
// CONCATENATED MODULE: ./src/sheet/functions/numberstring.js








function numberstring(num) {
  if (!/^\d*(\.\d*)?$/.test(num)) {
    return '#NAME';
  }

  var aa = new Array('零', '一', '二', '三', '四', '五', '六', '七', '八', '九');
  var bb = new Array('', '十', '百', '千', '万', '亿', '点', '');
  var a = ('' + num).replace(/(^0*)/g, '').split('.'),
      k = 0,
      re = '';

  for (var i = a[0].length - 1; i >= 0; i--) {
    switch (k) {
      case 0:
        re = bb[7] + re;
        break;

      case 4:
        if (!new RegExp('0{4}\\d{' + (a[0].length - i - 1) + '}$').test(a[0])) re = bb[4] + re;
        break;

      case 8:
        re = bb[5] + re;
        bb[7] = bb[5];
        k = 0;
        break;

      default:
        break;
    }

    if (k % 4 == 2 && a[0].charAt(i + 2) != 0 && a[0].charAt(i + 1) == 0) re = aa[0] + re;
    if (a[0].charAt(i) != 0) re = aa[a[0].charAt(i)] + bb[k % 4] + re;
    k++;
  }

  if (a.length > 1) {
    //加上小数部分(如果有小数部分)
    re += bb[6];

    for (var _i = 0; _i < a[1].length; _i++) {
      re += aa[a[1].charAt(_i)];
    }
  }

  return re;
}
// CONCATENATED MODULE: ./src/sheet/functions/inlist.js






function INLIST() {
  for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
    args[_key] = arguments[_key];
  }

  var tryArgs = args.map(function (item) {
    return functions_toString(item);
  });

  var _tryArgs = _toArray(tryArgs),
      targetValue = _tryArgs[0],
      targetArgs = _tryArgs.slice(1);

  return targetArgs.includes(targetValue);
}
// EXTERNAL MODULE: ./node_modules/core-js/modules/es.string.starts-with.js
var es_string_starts_with = __webpack_require__("2ca0");

// CONCATENATED MODULE: ./src/sheet/functions/startsWith.js







function STARTSWITH() {
  for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
    args[_key] = arguments[_key];
  }

  var tryArgs = args.map(function (item) {
    return item.toString();
  });

  var _tryArgs = _toArray(tryArgs),
      targetValue = _tryArgs[0],
      targetArgs = _tryArgs.slice(1);

  return !!targetArgs.find(function (arg) {
    return targetValue.startsWith(arg);
  });
}
// CONCATENATED MODULE: ./src/sheet/functions/isNull.js
// Copyright 2015-2018 FormBucket LLC
/* harmony default export */ var isNull = (function (value) {
  return value == null || value == '';
});
// CONCATENATED MODULE: ./src/sheet/functions/check/mobile.js






function mobile(s) {
  var regu = /^1\d{10}$/; //【/^[1]([3][0-9]{1}|59|58|88|89)[0-9]{8}$/】

  var re = new RegExp(regu);

  if (re.test(s)) {
    return true;
  } else {
    return false;
  }
}
// CONCATENATED MODULE: ./src/sheet/functions/isUSCI.js





//检测统一社会信用代码
function isUSCI(value) {
  if (typeof value != 'string') {
    return false;
  } // 代码字符对应的值


  var valueMap = {
    '0': 0,
    '1': 1,
    '2': 2,
    '3': 3,
    '4': 4,
    '5': 5,
    '6': 6,
    '7': 7,
    '8': 8,
    '9': 9,
    A: 10,
    B: 11,
    C: 12,
    D: 13,
    E: 14,
    F: 15,
    G: 16,
    H: 17,
    J: 18,
    K: 19,
    L: 20,
    M: 21,
    N: 22,
    P: 23,
    Q: 24,
    R: 25,
    T: 26,
    U: 27,
    W: 28,
    X: 29,
    Y: 30
  };
  var usciStr = value.toUpperCase();
  var reg = /^[A-Z0-9]{18}$/;

  if (!reg.test(usciStr)) {
    return false;
  }

  var weight = 0,
      sum = 0,
      index = 0,
      c,
      v,
      usciStrRange = usciStr.slice(0, 17);

  for (index = 0; index < usciStrRange.length; index++) {
    c = usciStrRange.charAt(index);
    v = valueMap[c];
    weight = parseInt(Math.pow(3, parseFloat(index))) % 31; // 计算加权因子

    sum += v * weight;
  }

  var mod = sum % 31;
  var sign = 31 - mod;

  if (sign == 31) {
    sign = 0;
  }

  var signChar;

  for (var key in valueMap) {
    signChar = key;

    if (valueMap[key] == sign) {
      break;
    }
  }

  var lastStr = usciStr.slice(17, 18);
  var signStr = signChar.toString();
  return signStr == lastStr;
}
// CONCATENATED MODULE: ./src/sheet/functions/isInt.js





/* eslint-disable*/
var isInt = function isInt(val) {
  if (val === undefined) {
    return false;
  }

  return /^\d+$/.test(val.toString());
};

/* harmony default export */ var functions_isInt = (isInt);
// CONCATENATED MODULE: ./src/sheet/functions/calcFormulaVal.js



// Copyright 2015-2018 FormBucket LLC

/* eslint-disable*/








var caches = {};
function calcFormulaVal(exp) {
  var params = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
  var locals = functions_assign({}, params);
  var compiled = null;
  var noCache = true;
  var value;

  var getParam = function getParam(name, scope) {
    var _value;

    var value = null;

    if (istext(scope)) {
      if (/\s*(\[(.+?)\])\s*/g.test(scope)) {
        var _locals$;

        value = (_locals$ = locals["'".concat(scope, "'")]) === null || _locals$ === void 0 ? void 0 : _locals$[name];
      } else {
        value = locals[scope] ? locals[scope][name] : null;
      }
    } else {
      if (locals[name]) {
        value = locals[name];
      } else {
        locals[name] = value;
      }
    }

    if (((_value = value) === null || _value === void 0 ? void 0 : _value[0]) === '=') {
      return calcFormulaVal(value, locals);
    }

    return value;
  };

  if (locals.get !== 'function') {
    locals.get = function (name, scope) {
      var value = getParam(name, scope);
      return value === null ? 0 : value;
    };

    locals.getString = function (name, scope) {
      var value = getParam(name, scope);
      var val = value !== null && value !== void 0 ? value : '';
      return functions_toString(val);
    };

    locals.parseNumber = function (val) {
      return val * 1;
    };

    locals.toNumber = functions_toNumber;
  }

  if (isfunction(exp)) return exp(locals, functions_functions_namespaceObject);else if (!istext(exp)) return functions_error["a" /* ERRORTYPES */].na;

  if (caches.hasOwnProperty(exp)) {
    // noCache = false;
    // compiled = m[exp];
    // for (const key in compiled.params) {
    //   if (Object.hasOwnProperty.call(params, key)) {
    //     if (compiled.params[key] !== params[key]) {
    //       noCache = true;
    //       break;
    //     }
    //   }
    // }
    compiled = caches[exp];
    noCache = false;
  } else {
    compiled = compile(exp);
    caches[exp] = compiled;
  }

  if (noCache) {
    value = compiled(locals, functions_functions_namespaceObject);
    compiled.params = _objectSpread2({}, params);
    compiled.value = value;
  } else {
    value = compiled.value;
  }

  return value;
}
var clearFormulaValCache = function clearFormulaValCache() {
  caches = {};
};
// CONCATENATED MODULE: ./src/sheet/functions/functions.js
// Copyright 2015-2018 FormBucket LLC
// # Formula's Functions
// ## Functions
// The library includes functions for logic, math, text, lookup, date/time, aggregation, arrays, objects, finance, statistics and other utilities.
// ### Formula

 // #### [parser](./parser)
// `walker` converts an AST into a function.


 // #### [walker](./walker)
// `walker` converts an AST by walking and applying the config.




 // #### [compile](./compile)
// `compile` converts a formula expression into a runnable JavaScript function.


 // #### [run](./run)
// `run` execute a formula once.


 // ### LogicalRUN
// #### [branch](./branch)
// `branch` is equivalent to `if-elseif-else`.






 // #### [choose](./choose)
// `choose` returns value from index_value from argument list.


 // #### [Switch](./switch)
// `switch` is equivalent to `switch case`.


 // #### [and](./and)
// `and` returns true when all arguments are true or evaluates to true.


 // #### [nand](./nand)
// `nand` returns composition `not(and(...))`


 // #### [or](./or)
// `or` returns true when any argument is true or evaluates to true.


 // #### [nor](./nor)
// `nor` returns composition `not(or(...))`


 // #### [xor](./xor)
// `xor` returns the logical exclusive Or of all arguments.


 // #### [not](./not)
// `not` returns the inverse.


 // #### [eq](./eq)
// `eq` returns true when the first and second arguments are equivalent. String comparision is _case insensitive_.


 // #### [ne](./ne)
// `ne` returns true when the first and second arguments are not equivalent. String comparision is _case insensitive_.


 // #### [gt](./gt)
// `gt` returns true when first argument is greater than the second.


 // #### [gte](./gte)
// `gte` returns true when first argument is greater than or equal to the second.


 // #### [lt](./lt)
// `lt` returns true when first argument is less than the second.


 // #### [lte](./lte)
// `lte` returns true when first argument is less than or equal to the second.


 // #### [identity](./identity)
// `identity` returns the first argument.


 // #### [ifblank](./ifblank)
// `ifempty` returns the second argument when the first argument is blank or the third argument



 // #### [ifempty](./ifempty)
// `ifempty` returns the second argument when the first argument is empty or the third argument



 // #### [iferror](./iferror)
// `ifempty` returns the second argument when the first argument is an error or the third argument



 // #### [ifna](./ifna)
// `ifempty` returns the second argument when the first argument is #NA! or the third argument



 // #### [isarray](./isarray)
// `isarray` returns true when the value is an array.



 // #### [isasyncfunction](./isasyncfunction)
// `isasyncfunction` returns true when the value is a async function.



 // #### [isblank](./isblank)
// `isblank` returns true when the value is undefined or null.



 // #### [isboolean](./isboolean)
// `isboolean` returns true when the value is true or false.



 // #### [isdate](./isdate)
// `isdate` returns true when the value is a JavaScript Date object.



 // #### [isemail](./isemail)
// `isdate` returns true when the value matches the pattern for a valid email address.



 // #### [isempty](./isempty)
// `isempty` returns true when the value is blank or empty string.



 // #### [iserror](./iserror)
// `iserror` returns true when the value is an error value.



 // #### [iseven](./iseven)
// `iseven` returns true when the value is an even number.



 // #### [isfalsy](./isfalsy)
// `isfalsy` returns true when value is a string.



 // #### [isfunction](./isfunction)
// `isfunction` returns true when the value is a function or async function.



 // #### [isleapyear](./isleapyear)
// `isfunction` returns true when the value is a leap year.



 // #### [islowercase](./islowercase)
// `islowercase` returns true when the value is lower case.



 // #### [isobject](./isobject)
// `isobject` return true when object exists and is object or function.


 // #### [isna](./isna)
// `isna` returns true when the value is #NA!.



 // #### [isnan](./isnan)
// `isnan` returns true when the value is NaN.



 // #### [isnumber](./isnumber)
// `isnumber` returns true when the value is JavaScript number type and not NaN and not infinite.



 // #### [isodd](./isodd)
// `isodd` returns true when the value is an odd number.



 // #### [isoweeknum](./isoweeknum)
// `isoweeknum` returns number of the ISO week number of the year for a given date.



 // #### [ispromise](./ispromise)
// `ispromise` returns true when value is a ref object.



 // #### [isref](./isref)
// `isref` returns true when value is a ref object.



 // #### [istext](./istext)
// `istext` returns true when value is a string.


 // #### [istruthy](./istruthy)
// `istruthy` returns true when value is a string.



 // #### [isuppercase](./isuppercase)
// `isuppercase` returns true when the value is lower case.



 // #### [isurl](./isurl)
// `isurl` returns true when value matches a url pattern.



 // #### [iswholenumber](./iswholenumber)
// `iswholenumber` returns true when value is an integer.



 // ### Math functions
// #### [minus](./minus)
// `minus` negates a value.


 // #### [plus](./plus)
// `plus` converts value to number.


 // #### [add](./add)
// `add` sums the first and second arguments.


 // #### [subtract](./subtract)
// `subtract` returns the difference between the first and second arguments.


 // #### [multiply](./multiply)
// `multiply` returns the product of the first and second arguments.


 // #### [divide](./divide)
// `divide` returns the result of the first argument divided by the second.


 // #### [abs](./abs)
// `abs` returns the absolute value of the first argument.


 // #### [acos](./acos)
// `acos` returns the inverse cosine of a number.


 // #### [acosh](./acosh)
// `acosh` returns the hyperbolic inverse cosine of a number.


 // #### [acot](./acot)
/// `acot` returns the arccotangent of a given number.


 // #### [acoth](./acoth)
/// `acot` returns the hyperbolic arccotangent of a given number.


 // #### [asin](./asin)
/// `asin` returns the arccosin of a given number.


 // #### [asinh](./asinh)
/// `asinh` returns the hyperbolic arccosin of a given number.


 // #### [atan](./atan)
/// `atan` returns the arctangent of a given number.


 // #### [atan2](./atan2)
/// `atan2` returns the arctangent, or inverse tangent, of the specified x- and y-coordinates.


 // #### [atanh](./atanh)
/// `atanh` returns the arctangent (in radians) of the given number.


 // #### [cos](./cos)
/// `cos` returns the cosine of a number


 // #### [degrees](./degrees)
/// `degrees` returns radians converted to degrees.


 // #### [mod](./mod)


 // #### [pi](./pi)


 // #### [power](./power)
// `power` returns the nth power of a number.


 // #### [round](./round)
// `round` returns a number rounded to a precision.


 // #### [roundup](./roundup)
// `roundup` returns a number rounded up to a precision.



 // #### [sin](./sin)
// `sin` return the sinine of a number.


 // #### [tan](./tan)
// `tan` returns the tangent of a number.


 // #### [tau](./tau)


 // #### [trunc](./trunc)
// `trunc` returns a number truncated to a given precision.


 // #### [within](./within)
// `within(value, lower, upper)` returns true when value is between lower and upper.



 // ### Text
// #### [char](./char)
// `char` returns a character given an ASCII code.


 // #### [camelcase](./camelcase)
// `camelcase` returns text converted to camel case.



 // #### [code](./code)
// `code` returns the ASCII code for a given character.


 // #### [concatenate](./concatenate)
// `concatenate` combines multiple values into a string.


 // #### [exact](./exact)
// `exact` compares two values for strict equivalence.


 // #### [find](./find)
// `find` searches a string for a value and returns the index.


 // #### [join](./join)
// `join` combines an array of values into a string with a given delimiter.


 // #### [left](./left)
// `left` returns a given number of characters from the left side of a string.


 // #### [len](./len)
// `len` returns the size of a string of array.


 // #### [lower](./lower)
// `lower` converts text to lower case.


 // #### [numbervalue](./numbervalue)
// `numbervalue` converts text into a number.



 // #### [parsebool](./parsebool)
// `parsebool` converts text into a boolean value.



 // #### [parsedate](./parsedate)
// `parsedate` converts text into a JavaScript date object



 // #### [parsequery](./parsequery)
// `parsequery` returns a JSObject for a URL query string.



 // #### [proper](./proper)
// `proper` returns a string as a proper name.


 // #### [replace](./replace)
// `replace` returns a string where one value is replaced with a new value.


 // #### [right](./right)
// `right` returns a given number of characters from the right of a string.


 // #### [rept](./rept)
// `rept` returns a string with a given value repeated `n` times.


 // #### [search](./search)
// `search` returns the index of a value inside a string with wildcard support for single characters (?) and multiple characters (*).


 // #### [snakecase](./snakecase)
// `snakecase` returns text converted to snake case.



 // #### [substitute](./substitute)
// `substitute` returns a new string with every instance of value replaced.


 // #### [substituteAll](./substituteAll)
// `substituteAll` returns a new string with every instance of set of values replaced.



 // #### [surroundKeys](./surroundKeys)
// `surroundKeys` returns a new object where the keys have been wrapped with start and end strings.



 // #### [split](./split)
// `split` returns an array of strings from a given string separated by a delimiter.


 // #### [text](./text)
// `text` formats numbers and dates using a format code.


 // #### [trim](./trim)
// `trim` returns a value with the whitespace removed from the left and right.


 // #### [upper](./upper)
// `upper` returns a value in all upper case.


 // ### Lookup and reference
// #### [hlookup](./hlookup)
// `hlookup` searches the first row and returns the value from the found column at a given row.


 // #### [includes](./includes)
// `includes` searches an array and returns the true or false for exact matches.


 // #### [notincludes](./notincludes)
// `notincludes` searches an array and returns the true or false for exact matches.



 // #### [index](./index)
// `index` returns the value for a given row and column.


 // #### [lookup](./lookup)
// `lookup` searches an array and returns the value found or (optionally) the value at the same index in a second array.


 // #### [match](./match)
// `match` searches an array and returns the found index with support for wildcard and range queries.


 // #### [vlookup](./vlookup)
// `vlookup` searches the first column and returns the value from the found row at a given column.


 // ### Date manipulation
// #### [date](./date)
// `date` returns a serial number for a given year, month and day.


 // #### [datevalue](./datevalue)
// `datevalue` returns a serial number for a given date string.


 // #### [datedif](./datedif)
// `datedif` returns the difference between two dates with support for multiple units.


 // #### [day](./day)
// `day` returns the day part from a date or date string.


 // #### [days360](./days360)
// `days360` returns the days behind two dates using a 360 day year.


 // #### [edate](./edate)
// `edate` returns the serial number for a date that is a given number of months before or after a given date.


 // #### [eomonth](./eomonth)
// `eomonth` returns the last day of the month in future or past months.


 // #### [hour](./hour)
// `hour` returns the hour part of a time fraction value.


 // #### [minute](./minute)
// `minute` returns the minute part of a time fraction value.


 // #### [month](./month)
// `month` returns the month for a given date.


 // #### [now](./now)
// `now` returns the current date time in a serial number and time fraction.


 // #### [second](./second)
// `second` return the second part of a time fraction


 // #### [today](./today)
// `today` returns a serial number for the current date.


 // #### [time](./time)
// `time` returns a time fraction for an hour, minute and second.


 // #### [timevalue](./timevalue)
// `timevalue` returns a time fraction given a text value.


 // #### [year](./year)
// `year` return the year for a given date.


 // #### [yearfrac](./yearfrac)
// `yearfrac` calculates the fraction of a year between two dates.


 // ### Aggregation
// #### [average](./average)
// `average` returns the sum divided by the number of items.


 // #### [min](./min)
// `min` returns the smallest value in an array.


 // #### [max](./max)
// `min` returns the largest value in an array.


 // #### [query](./query)
// `min` returns the largest value in an array.


 // #### [sum](./sum)
// `sum` returns the value of all items in an array added together.


 // ### Finance
// #### [accrint](./accrint)
// `accrint` teturns the accrued interest for a security that pays periodic interest.


 // #### [fv](./fv)
// `fv` returns the future value of an investment.


 // #### [nper](./nper)
// `nper` returns the number of periods for an investment.


 // #### [npv](./npv)
// `npv` returns the net present value of an investment.


 // #### [pmt](./pmt)
// `pmt` returns the amortized payment for a loan.


 // #### [cumipmt](./cumipmt)
// `cumipmt` returns the cumulative interest on a loan between start and end period.


 // #### [ipmt](./ipmt)
// `ipmt` returns the portion of the periodic payment which is interest for a fixed rate loan or annuity.


 // #### [pv](./pv)
// `pv` returns the present value of an investment.


 // ### Engineering
// #### [bin2dec](./bin2dec)
// `bin2dec` converts a binary number into a decimal value.


 // #### [dec2bin](./dec2bin)
// `dec2bin` converts a decimal value to a binary string.


 // #### [oct2dec](./oct2dec)
// `oct2dec` converts an octal string to a decimal value.


 // ### Arrays
// #### [filter](./filter)
// `filter` limits a range based on arrays of true/false values.


 // #### [flatten](./flatten)
// `flatten` returns an array with values flatten into a single dimension.


 // #### [map](./map)
// `map` returns an array mapped to new values with a given function.


 // #### [pluck](./pluck)
// `pluck` returns an array with a property plucked from an array of objects.


 // #### [reduce](./reduce)
// `reduce` converts an array into a value.


 // #### [some](./some)
// `some` returns true if some of the values in an array match the criteria.


 // #### [sort](./sort)
// `sort` returns an array sorted by criteria.


 // #### [unflatten](./unflatten)
// `unflatten` returns an array with values unflattened into arrays of arrays.



 // #### [unique](./unique)
// `unique` returns the list of unique values from an array.


 // ### Objects
// #### [changed](./changed)
// `changed` computes the list of keys that are different between two objects.


 // #### [diff](./diff)
// `diff` computes the unique left, unique right and changed properties of two objects.


 // #### [clean](./clean)
// `clean` returns an object skipping properties with empty values.


 // #### [get](./get)
// `get` returns the value of a property from an object.


 // #### [select](./select)
// `select` returns an object with keys limited to a given set.


 // #### [keys](./keys)
// `keys` returns the list of properties in an object.


 // ### Utility
// #### [address](./address)
// `address` returns a row/column reference.


 // #### [assign](./assign)
// `assign` returns the result of merging two or more objects.


 // #### [base](./base)
// `base` returns a number into a text representation with the given radix.


 // #### [cellindex](./cellindex)
// `cellindex` computes the index of a row/column in a fixed size 1 dimensional space.



 // #### [ceiling](./ceiling)
// `ceiling` returns a number rounded up to a specified multiple.


 // #### [column](./column)
// `column` returns the column index from a cell index.


 // #### [columnletter](./columnletter)
// `column` returns the column letter from a cell index.



 // #### [columnnumber](./columnnumber)
// `columnnumber` converts a column letter into a number.



 // #### [decodebase64](./decodebase64)
// `decodeBase64` decodes the base 64 binary into string



 // #### [decodejwt](./decodejwt)
// `decodeJWT` decodes the payload from a JSON Web Token



 // #### [entries](./entries)
// `entries` returns returns an array of a given object's
//  own enumerable property [key, value] pairs.


 // #### [even](./even)
// `even` returns a number rounded up the nearest even integer.


 // #### [floor](./floor)
// `floor` returns a number rounded down to a specified multiple.


 // #### [group](./group)
// `group` returns data group by one or more fields.


 // #### [guid](./guid)
// `guid` returns a new globally unique identifier (version 4).


 // #### [hash](./hash)
// `hash` returns a new globally unique identifier (version 4).


 // #### [int](./int)
// `int` return the floor of a number.


 // #### [index2col](./index2col)
// `index2col` computes the column given a cell index.



 // #### [index2row](./index2row)
// `index2row` computes the row given a cell index.



 // #### [intersect](./intersect)
// `intersect` returns true if two rectangles intersect.


 // #### [interpolate](./interpolate)
// `interpolate` computes a number a percentage distance between a and b.


 // #### [interpolator](./interpolator)
// `interpolator` creates a function that accepts a percentage distance between a and b, used by interpolate.


 // #### [n](./n)
// `n` converts a `value` to a number. It supports numbers, true, false and dates.


 // #### [numbers](./numbers)
// `numbers` returns the numbers from an array.


 // #### [overlap](./overlap)
// `overlap` returns true if two rectangles overlap.


 // #### [ref](./ref)
// `ref` returns a ref object that represents a range.


 // #### [serial](./serial)
// `serial` converts a JS date into the number of days from 1/1/1900.








 //久其扩展公式















// CONCATENATED MODULE: ./src/sheet/core/expCache.js






var expCache_Exp = /*#__PURE__*/function () {
  function Exp() {
    _classCallCheck(this, Exp);

    this._ = {};
    this.linkExp = {};
  }

  _createClass(Exp, [{
    key: "set",
    value: function set(src, exp) {
      var stack = exp.stack,
          formatSrc = exp.formatSrc,
          sheetList = exp.sheetList,
          result = exp.result,
          crossExcelName = exp.crossExcelName;
      var activeName = sheetList.activeName;
      var expCache = (sheetList === null || sheetList === void 0 ? void 0 : sheetList.expCache) || {
        isValue: false,
        parserFormula: true
      };

      if (crossExcelName) {
        activeName = crossExcelName;
      }

      var o = {};

      if (expCache !== null && expCache !== void 0 && expCache.isValue) {
        o[activeName] = result;
      }

      if (expCache !== null && expCache !== void 0 && expCache.parserFormula) {
        this._[src] = {
          stack: stack,
          formatSrc: formatSrc,
          result: o
        };
      }
    }
  }, {
    key: "getVal",
    value: function getVal(src, sheetName, crossExcelName) {
      if (crossExcelName) {
        var _this$_$src, _this$_$src$result;

        return (_this$_$src = this._[src]) === null || _this$_$src === void 0 ? void 0 : (_this$_$src$result = _this$_$src.result) === null || _this$_$src$result === void 0 ? void 0 : _this$_$src$result[crossExcelName];
      } else {
        var _this$_$src2, _this$_$src2$result;

        return (_this$_$src2 = this._[src]) === null || _this$_$src2 === void 0 ? void 0 : (_this$_$src2$result = _this$_$src2.result) === null || _this$_$src2$result === void 0 ? void 0 : _this$_$src2$result[sheetName];
      }
    }
  }, {
    key: "get",
    value: function get(src) {
      return this._[src];
    }
  }, {
    key: "link",
    value: function link(identifier, idSets, src) {
      if (idSets.size === 0) {
        this.linkExp[identifier] = [src];
      } else {
        var _idSets = _slicedToArray(idSets, 1),
            id = _idSets[0];

        this.linkExp[id].push(src);
      }
    }
  }, {
    key: "clear",
    value: function clear() {
      this._ = {};
      this.linkExp = {};
    }
  }, {
    key: "clearVal",
    value: function clearVal(sheetName) {
      this.linkExp = {};

      for (var key in this._) {
        if (key.includes(sheetName)) {
          this._[key].result = {};
        } else {
          var _this$_$key, _this$_$key$result;

          (_this$_$key = this._[key]) === null || _this$_$key === void 0 ? true : (_this$_$key$result = _this$_$key.result) === null || _this$_$key$result === void 0 ? true : delete _this$_$key$result[sheetName];
        }
      }
    }
  }]);

  return Exp;
}();


// CONCATENATED MODULE: ./src/sheet/core/cell.js



















var expCache = new expCache_Exp();

var getCrossSheetPosition = function getCrossSheetPosition(expr) {
  return expr.split('!');
};

var cell_infixExprToSuffixExpr = function infixExprToSuffixExpr(src, sheetName, sheetList) {
  var o = expCache.get(src);
  if (o) return o;
  var stack = new Set();
  src.replace(/([A-Z]+[0-9]+):([A-Z]+[0-9]+)/g, function (a, b, c) {
    var _expr2xy = alphabet_expr2xy(b),
        _expr2xy2 = _slicedToArray(_expr2xy, 2),
        sx = _expr2xy2[0],
        sy = _expr2xy2[1];

    var _expr2xy3 = alphabet_expr2xy(c),
        _expr2xy4 = _slicedToArray(_expr2xy3, 2),
        ex = _expr2xy4[0],
        ey = _expr2xy4[1];

    for (var x = sx; x <= ex; x += 1) {
      for (var y = sy; y <= ey; y += 1) {
        var identifier = alphabet_xy2expr(x, y);

        if (sheetName) {
          var formatIdentifier = "".concat(sheetName, "!").concat(identifier);
          stack.add(formatIdentifier);
        } else {
          stack.add(identifier);
        }
      }
    }
  });
  var formatSrc = src.replace(sheetList.regNames, function (identifier) {
    if (identifier.includes('[')) {
      var _regScapeStr$match;

      var formatCrossSheet = (_regScapeStr$match = regScapeStr(identifier).match(/\]([\u4e00-\u9fa5a-zA-Z0-9【】（）<>_]+)?\'/g)) === null || _regScapeStr$match === void 0 ? void 0 : _regScapeStr$match[0];
      var sub = "'!";
      var CrossExcelSheet = formatCrossSheet.replace(/^(\s|\])+|(\s|\')$/g, '');
      var formatIdentifier = identifier.replace(CrossExcelSheet + sub, nameEncode(CrossExcelSheet) + sub);
      stack.add(formatIdentifier);
      return formatIdentifier;
    }

    if (sheetName && !identifier.includes('!')) {
      var _formatIdentifier = "".concat(sheetName, "!").concat(identifier);

      stack.add(_formatIdentifier);
      return _formatIdentifier;
    }

    if (identifier.includes('!')) {
      var _getCrossSheetPositio = getCrossSheetPosition(identifier),
          _getCrossSheetPositio2 = _slicedToArray(_getCrossSheetPositio, 2),
          crossSheet = _getCrossSheetPositio2[0],
          expr = _getCrossSheetPositio2[1];

      var _formatIdentifier2 = "".concat(nameEncode(crossSheet), "!").concat(expr);

      stack.add(_formatIdentifier2);
      return _formatIdentifier2;
    }

    stack.add(identifier);
    return identifier;
  });
  return {
    stack: _toConsumableArray(stack),
    formatSrc: formatSrc
  };
};

var cell_evalSubExpr = function evalSubExpr(expr, cellRender) {
  if (expr.includes('!')) {
    var _getCrossSheetPositio3 = getCrossSheetPosition(expr),
        _getCrossSheetPositio4 = _slicedToArray(_getCrossSheetPositio3, 2),
        s = _getCrossSheetPositio4[0],
        e = _getCrossSheetPositio4[1];

    var _expr2xy5 = alphabet_expr2xy(e),
        _expr2xy6 = _slicedToArray(_expr2xy5, 2),
        x = _expr2xy6[0],
        y = _expr2xy6[1];

    return cellRender(x, y, s, expr);
  } else {
    var _expr2xy7 = alphabet_expr2xy(expr),
        _expr2xy8 = _slicedToArray(_expr2xy7, 2),
        _x = _expr2xy8[0],
        _y = _expr2xy8[1];

    return cellRender(_x, _y, null, expr);
  }
};

var cell_evalSuffixExpr = function evalSuffixExpr(srcStack, formatSrc, cellRender) {
  var o = {};
  var p = {};

  for (var i = 0; i < srcStack.length; i += 1) {
    var expr = srcStack[i];

    if (expr.includes('!')) {
      var _getCrossSheetPositio5 = getCrossSheetPosition(expr),
          _getCrossSheetPositio6 = _slicedToArray(_getCrossSheetPositio5, 2),
          s = _getCrossSheetPositio6[0],
          e = _getCrossSheetPositio6[1];

      p[e] = cell_evalSubExpr(expr, cellRender);
      o[s] = JSON.parse(JSON.stringify(p));
    } else {
      o[expr] = cell_evalSubExpr(expr, cellRender);
    }
  }

  return run(formatSrc, o);
};

var cell_cellRender = function cellRender(src, getCellText, sheetName, sheetList, identifier, asyncFormula) {
  var idSets = arguments.length > 6 && arguments[6] !== undefined ? arguments[6] : new Set();

  if (src && src[0] === '=' && src.length > 1) {
    if (asyncFormula !== null && asyncFormula !== void 0 && asyncFormula.enable) return asyncFormula.text;
    var activeName = sheetList === null || sheetList === void 0 ? void 0 : sheetList.activeName;
    var crossExcelName = sheetList === null || sheetList === void 0 ? void 0 : sheetList.crossExcelName;
    var cacheVal = expCache.getVal(src, activeName, crossExcelName);
    if (cacheVal) return cacheVal;

    var _infixExprToSuffixExp = cell_infixExprToSuffixExpr(src.substring(1), sheetName, sheetList),
        stack = _infixExprToSuffixExp.stack,
        formatSrc = _infixExprToSuffixExp.formatSrc;

    var result = null;

    try {
      if (stack.length <= 0 && formatSrc) {
        result = run(formatSrc);
      } else {
        if (idSets.has(identifier)) return 0;
        idSets.add(identifier);

        var getRenderText = function getRenderText(x, y, sheetName, identifier) {
          return cellRender(getCellText(x, y, sheetName), getCellText, sheetName, sheetList, identifier, asyncFormula, idSets);
        };

        result = cell_evalSuffixExpr(stack, formatSrc, getRenderText);
      }

      expCache.set(src, {
        stack: stack,
        formatSrc: formatSrc,
        sheetList: sheetList,
        result: result,
        crossExcelName: crossExcelName
      });
      idSets.delete(identifier);
      return result;
    } catch (error) {
      console.log(error);
      return src;
    }
  }

  idSets.delete(identifier);
  return src;
};

var cell_parserRun = function parserRun(src, sheetList, sheetName) {
  var _infixExprToSuffixExp2 = cell_infixExprToSuffixExpr(src, sheetName, sheetList),
      formatSrc = _infixExprToSuffixExp2.formatSrc;

  run(formatSrc);
};

/* harmony default export */ var core_cell = ({
  render: cell_cellRender
});

// CONCATENATED MODULE: ./src/sheet/core/wildcard.js





















 //[*,*]*2=#{last_year_[*,*-2]}{1~2,3~4}{9}

var wildcard_Wildcard = /*#__PURE__*/function () {
  function Wildcard() {
    _classCallCheck(this, Wildcard);
  } //ruler：[*,*]*2=#{last_year_[*,*-2]}  rowColNum： [["1~2", "3~4"],["9"]]


  _createClass(Wildcard, [{
    key: "getRowNumColNum",
    value: function getRowNumColNum(str) {
      var rowColNum = [];
      var ruler = str.replace(/\s*(\{(.+?)\})\s*/g, function (a, b, c, e) {
        if (str[e - 1] == '#') {
          return a;
        }

        rowColNum.push(c.split(','));
        return '';
      });
      return {
        ruler: ruler,
        rowColNum: rowColNum
      };
    }
  }, {
    key: "getNumList",
    value: function getNumList(list) {
      var b = [];

      var _iterator = _createForOfIteratorHelper(list),
          _step;

      try {
        for (_iterator.s(); !(_step = _iterator.n()).done;) {
          var iterator = _step.value;

          if (iterator.includes('~')) {
            var _iterator$split = iterator.split('~'),
                _iterator$split2 = _slicedToArray(_iterator$split, 2),
                min = _iterator$split2[0],
                max = _iterator$split2[1];

            min = parseInt(min);
            max = parseInt(max);

            for (min; min <= max; min++) {
              b.push(min);
            }
          } else {
            b.push(iterator);
          }
        }
      } catch (err) {
        _iterator.e(err);
      } finally {
        _iterator.f();
      }

      return b;
    } //cols*rows

  }, {
    key: "getArrayPermutations",
    value: function getArrayPermutations(arr) {
      var result = [];

      function permute(currentArr, remainingArr) {
        if (remainingArr.length === 0) {
          result.push(currentArr);
        } else {
          for (var i = 0; i < remainingArr[0].length; i++) {
            permute(currentArr.concat(remainingArr[0][i]), remainingArr.slice(1));
          }
        }
      }

      permute([], arr);
      return result;
    } //["[1,9]*2=#{last_year_[1,7]}","[2,9]*2=#{last_year_[2,7]}","[3,9]*2=#{last_year_[3,7]}","[4,9]*2=#{last_year_[4,7]}"]

  }, {
    key: "getRulers",
    value: function getRulers(rowColNum, ruler) {
      var _this = this;

      var numList = [];
      var rulers = [];

      var _iterator2 = _createForOfIteratorHelper(rowColNum),
          _step2;

      try {
        for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {
          var iterator = _step2.value;
          numList.push(this.getNumList(iterator));
        }
      } catch (err) {
        _iterator2.e(err);
      } finally {
        _iterator2.f();
      }

      var oooo = this.getArrayPermutations(numList);

      var _iterator3 = _createForOfIteratorHelper(oooo),
          _step3;

      try {
        var _loop = function _loop() {
          var numbers = _step3.value;
          var index = 0;
          var z = ruler.replace(/\s*(\[(.+?)\])\s*/g, function (c1) {
            if (c1[1] == '#') return c1;

            var baseNumberArr = _this.extractNumbers(c1);

            var baseNumberIndex = 0;
            return c1.replace(/\*([-|+]\d+)?/g, function () {
              var areaNumber = parseInt(numbers[index++ % 2]);

              if (numList.length == 1) {
                areaNumber = parseInt(numbers[0]);
              }

              var basNumber = baseNumberArr[baseNumberIndex++] || 0;
              return areaNumber + basNumber;
            });
          });
          rulers.push(z);
        };

        for (_iterator3.s(); !(_step3 = _iterator3.n()).done;) {
          _loop();
        }
      } catch (err) {
        _iterator3.e(err);
      } finally {
        _iterator3.f();
      }

      return rulers;
    } //['A9*2=#{last_year_A7}', 'B9*2=#{last_year_B7}', 'C9*2=#{last_year_C7}', 'D9*2=#{last_year_D7}']

  }, {
    key: "getIdRulers",
    value: function getIdRulers(rulers) {
      var idRuler = [];

      var _iterator4 = _createForOfIteratorHelper(rulers),
          _step4;

      try {
        for (_iterator4.s(); !(_step4 = _iterator4.n()).done;) {
          var ruler = _step4.value;
          idRuler.push(ruler.replace(/\s*(\[(.+?)\])\s*/g, function (a, b, c) {
            if (a[1] == '#') return a;

            var _c$split = c.split(','),
                _c$split2 = _slicedToArray(_c$split, 2),
                x = _c$split2[0],
                y = _c$split2[1];

            return alphabet_xy2expr(parseInt(x - 1), parseInt(y - 1));
          }));
        }
      } catch (err) {
        _iterator4.e(err);
      } finally {
        _iterator4.f();
      }

      return idRuler;
    } //[0,-2]

  }, {
    key: "extractNumbers",
    value: function extractNumbers(string) {
      string = string.replace(/\*,/g, '*+0,');
      string = string.replace(/\*]/g, '*+0]');
      var nas = string.match(/\*[-+]?\d+/g);

      if (!nas) {
        return [0, 0];
      }

      return nas.map(function (na) {
        return na.replace(/\*/g, function () {
          return '';
        });
      }).map(Number);
    } //取占位符

  }, {
    key: "getPlaceholder",
    value: function getPlaceholder(rulers) {
      var placeholders = new Set();

      var _iterator5 = _createForOfIteratorHelper(rulers),
          _step5;

      try {
        for (_iterator5.s(); !(_step5 = _iterator5.n()).done;) {
          var ruler = _step5.value;
          ruler.replace(/\s*(#\{(.+?)\})\s*/g, function (a, b, c) {
            placeholders.add(c);
          });
        }
      } catch (err) {
        _iterator5.e(err);
      } finally {
        _iterator5.f();
      }

      return placeholders;
    } //是否为通配规则

  }, {
    key: "isWildcard",
    value: function isWildcard(ruler) {
      return /\s*(\[(.+?)\])\s*/g.test(ruler) && /\s*({(.+?)\})\s*/g.test(ruler);
    } //获取id

  }, {
    key: "getRef",
    value: function getRef(ruler) {
      return nameEncode(ruler, 8, 8);
    }
  }]);

  return Wildcard;
}();


// CONCATENATED MODULE: ./src/sheet/core/data_proxy.js
















































 // private methods

/*
 * {
 *  name: ''
 *  freeze: [0, 0],
 *  formats: [],
 *  styles: [
 *    {
 *      bgcolor: '',
 *      align: '',
 *      valign: '',
 *      textwrap: false,
 *      strike: false,
 *      underline: false,
 *      color: '',
 *      format: 1,
 *      border: {
 *        left: [style, color],
 *        right: [style, color],
 *        top: [style, color],
 *        bottom: [style, color],
 *      },
 *      font: {
 *        name: 'Helvetica',
 *        size: 10,
 *        bold: false,
 *        italic: false,
 *      }
 *    }
 *  ],
 *  merges: [
 *    'A1:F11',
 *    ...
 *  ],
 *  rows: {
 *    1: {
 *      height: 50,
 *      style: 1,
 *      cells: {
 *        1: {
 *          style: 2,
 *          type: 'string',
 *          text: '',
 *          value: '', // cal result
 *        }
 *      }
 *    },
 *    ...
 *  },
 *  cols: {
 *    2: { width: 100, style: 1 }
 *  }
 * }
 */

function getDefaultSettings() {
  var defaultSettings = {
    mode: 'edit',
    // edit | read
    isAddHistory: true,
    view: {
      height: function height() {
        return document.documentElement.clientHeight;
      },
      width: function width() {
        return document.documentElement.clientWidth;
      }
    },
    showGrid: true,
    showToolbar: true,
    showContextmenu: true,
    showIdentifier: true,
    //是否显示行列标识
    minContent: false,
    //最小内容显示
    showRowRenderType: 'none',
    //是否显示渲染行标识  operate //操作 icon//图标 none//不显示
    bottomBarOperate: true,
    hiddenOperate: true,
    cornerOperate: true,
    showBottombar: true,
    showFreezeLine: true,
    row: {
      len: 100,
      height: 18,
      indexHeight: 18,
      minHeight: 3
    },
    col: {
      len: 26,
      width: 100,
      indexWidth: 60,
      minWidth: 10
    },
    style: {
      bgcolor: '#FFFFFF',
      align: 'left',
      valign: 'middle',
      textwrap: false,
      strike: false,
      underline: false,
      color: '#0a0a0a',
      indent: 0,
      font: {
        name: '宋体',
        size: 10,
        bold: false,
        italic: false
      },
      format: 'normal'
    },
    expCache: {
      //缓存
      isValue: false,
      //公式值
      parserFormula: true //公式解析

    },
    asyncFormula: {
      enable: false,
      text: '计算中...'
    },
    permissionConfigs: {},
    queryConfigs: [],
    formConfig: {},
    rectConfig: {},
    filterCellText: function filterCellText(v) {
      return v;
    },
    pasteType: 'all',
    //text ,all ,format
    selectStyle: {
      background: 'rgba(75, 137, 255, 0.08)'
    }
  };
  return defaultSettings;
}

var toolbarHeight = 81;
var bottombarHeight = 41; // src: cellRange
// dst: cellRange

function canPaste(src, dst) {
  var error = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : function () {};
  var merges = this.merges;
  var cellRange = dst.clone();

  var _src$size = src.size(),
      _src$size2 = _slicedToArray(_src$size, 2),
      srn = _src$size2[0],
      scn = _src$size2[1];

  var _dst$size = dst.size(),
      _dst$size2 = _slicedToArray(_dst$size, 2),
      drn = _dst$size2[0],
      dcn = _dst$size2[1];

  if (srn > drn) {
    cellRange.eri = dst.sri + srn - 1;
  }

  if (scn > dcn) {
    cellRange.eci = dst.sci + scn - 1;
  }

  if (merges.intersects(cellRange)) {
    error(locale_t('error.pasteForMergedCell'));
    return false;
  }

  return true;
}

function data_proxy_copyPaste(srcCellRange, dstCellRange, what) {
  var autofill = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;
  var rows = this.rows,
      merges = this.merges;
  this.clearCache(); // delete dest merge

  if (what === 'all' || what === 'format') {
    rows.deleteCells(dstCellRange, what);
    merges.deleteWithin(dstCellRange);
  }

  rows.copyPaste(srcCellRange, dstCellRange, what, autofill, function (ri, ci, cell) {
    if (cell && cell.merge) {
      // console.log('cell:', ri, ci, cell);
      var _cell$merge = _slicedToArray(cell.merge, 2),
          rn = _cell$merge[0],
          cn = _cell$merge[1];

      if (rn <= 0 && cn <= 0) return;
      merges.add(new cell_range_CellRange(ri, ci, ri + rn, ci + cn));
    }
  });
}

function cutPaste(srcCellRange, dstCellRange) {
  var clipboard = this.clipboard,
      rows = this.rows,
      merges = this.merges;
  this.clearCache();
  rows.cutPaste(srcCellRange, dstCellRange);
  merges.move(srcCellRange, dstCellRange.sri - srcCellRange.sri, dstCellRange.sci - srcCellRange.sci);
  clipboard.clear();
} // bss: { top, bottom, left, right }


function setStyleBorder(ri, ci, bss) {
  var styles = this.styles,
      rows = this.rows;
  var cell = rows.getCellOrNew(ri, ci);
  var cstyle = {};

  if (cell.style !== undefined) {
    cstyle = helper.cloneDeep(styles[cell.style]);
  }

  cstyle = helper.merge(cstyle, {
    border: bss
  });
  cell.style = this.addStyle(cstyle);
}

function setStyleBorders(_ref) {
  var _this = this;

  var mode = _ref.mode,
      style = _ref.style,
      color = _ref.color;
  var styles = this.styles,
      selector = this.selector,
      rows = this.rows;
  var _selector$range = selector.range,
      sri = _selector$range.sri,
      sci = _selector$range.sci,
      eri = _selector$range.eri,
      eci = _selector$range.eci;
  var multiple = !this.isSignleSelected();

  if (!multiple) {
    if (mode === 'inside' || mode === 'horizontal' || mode === 'vertical') {
      return;
    }
  }

  if (mode === 'outside' && !multiple) {
    setStyleBorder.call(this, sri, sci, {
      top: [style, color],
      bottom: [style, color],
      left: [style, color],
      right: [style, color]
    });
  } else if (mode === 'none') {
    selector.range.each(function (ri, ci) {
      var cell = rows.getCell(ri, ci);

      if (cell && cell.style !== undefined) {
        var ns = helper.cloneDeep(styles[cell.style]);
        delete ns.border; // ['bottom', 'top', 'left', 'right'].forEach((prop) => {
        //   if (ns[prop]) delete ns[prop];
        // });

        cell.style = _this.addStyle(ns);
      }
    });
  } else if (mode === 'all' || mode === 'inside' || mode === 'outside' || mode === 'horizontal' || mode === 'vertical') {
    (function () {
      var merges = [];

      for (var ri = sri; ri <= eri; ri += 1) {
        for (var ci = sci; ci <= eci; ci += 1) {
          // jump merges -- start
          var mergeIndexes = [];

          for (var ii = 0; ii < merges.length; ii += 1) {
            var _merges$ii = _slicedToArray(merges[ii], 4),
                mri = _merges$ii[0],
                mci = _merges$ii[1],
                _rn = _merges$ii[2],
                _cn = _merges$ii[3];

            if (ri === mri + _rn + 1) mergeIndexes.push(ii);

            if (mri <= ri && ri <= mri + _rn) {
              if (ci === mci) {
                ci += _cn + 1;
                break;
              }
            }
          }

          mergeIndexes.forEach(function (it) {
            return merges.splice(it, 1);
          });
          if (ci > eci) break; // jump merges -- end

          var cell = rows.getCell(ri, ci);
          var rn = 0,
              cn = 0;

          if (cell && cell.merge) {
            var _cell$merge2 = _slicedToArray(cell.merge, 2);

            rn = _cell$merge2[0];
            cn = _cell$merge2[1];
            merges.push([ri, ci, rn, cn]);
          }

          var mrl = rn > 0 && ri + rn === eri;
          var mcl = cn > 0 && ci + cn === eci;
          var bss = {};

          if (mode === 'all') {
            bss = {
              bottom: [style, color],
              top: [style, color],
              left: [style, color],
              right: [style, color]
            };
          } else if (mode === 'inside') {
            if (!mcl && ci < eci) bss.right = [style, color];
            if (!mrl && ri < eri) bss.bottom = [style, color];
          } else if (mode === 'horizontal') {
            if (!mrl && ri < eri) bss.bottom = [style, color];
          } else if (mode === 'vertical') {
            if (!mcl && ci < eci) bss.right = [style, color];
          } else if (mode === 'outside' && multiple) {
            if (sri === ri) bss.top = [style, color];
            if (mrl || eri === ri) bss.bottom = [style, color];
            if (sci === ci) bss.left = [style, color];
            if (mcl || eci === ci) bss.right = [style, color];
          }

          if (Object.keys(bss).length > 0) {
            setStyleBorder.call(_this, ri, ci, bss);
          }

          ci += cn;
        }
      }
    })();
  } else if (mode === 'top' || mode === 'bottom') {
    for (var ci = sci; ci <= eci; ci += 1) {
      if (mode === 'top') {
        setStyleBorder.call(this, sri, ci, {
          top: [style, color]
        });
        ci += rows.getCellMerge(sri, ci)[1];
      }

      if (mode === 'bottom') {
        setStyleBorder.call(this, eri, ci, {
          bottom: [style, color]
        });
        ci += rows.getCellMerge(eri, ci)[1];
      }
    }
  } else if (mode === 'left' || mode === 'right') {
    for (var ri = sri; ri <= eri; ri += 1) {
      if (mode === 'left') {
        setStyleBorder.call(this, ri, sci, {
          left: [style, color]
        });
        ri += rows.getCellMerge(ri, sci)[0];
      }

      if (mode === 'right') {
        setStyleBorder.call(this, ri, eci, {
          right: [style, color]
        });
        ri += rows.getCellMerge(ri, eci)[0];
      }
    }
  }
}

function getCellRowByY(y, scrollOffsety) {
  var rows = this.rows;
  var fsh = this.freezeTotalHeight(); // console.log('y:', y, ', fsh:', fsh);

  var inits = rows.indexHeight;
  if (fsh + rows.indexHeight < y) inits -= scrollOffsety; // handle ri in autofilter

  var frset = this.exceptRowSet;
  var ri = 0;
  var top = inits;
  var height = rows.height;

  for (; ri < rows.len; ri += 1) {
    if (top > y) break;

    if (!frset.has(ri)) {
      height = rows.getHeight(ri);
      top += height;
    }
  }

  top -= height; // console.log('ri:', ri, ', top:', top, ', height:', height);

  if (top < 0) {
    return {
      ri: -1,
      top: 0,
      height: rows.indexHeight
    };
  }

  return {
    ri: ri - 1,
    top: top,
    height: height
  };
}

function getCellColByX(x, scrollOffsetx) {
  var cols = this.cols;
  var fsw = this.freezeTotalWidth();
  var inits = cols.indexWidth;
  if (fsw + cols.indexWidth < x) inits -= scrollOffsetx;

  var _helper$rangeReduceIf = helper.rangeReduceIf(0, cols.len, inits, cols.indexWidth, x, function (i) {
    return cols.getWidth(i);
  }),
      _helper$rangeReduceIf2 = _slicedToArray(_helper$rangeReduceIf, 3),
      ci = _helper$rangeReduceIf2[0],
      left = _helper$rangeReduceIf2[1],
      width = _helper$rangeReduceIf2[2];

  if (left < 0) {
    return {
      ci: -1,
      left: 0,
      width: cols.indexWidth
    };
  }

  return {
    ci: ci - 1,
    left: left,
    width: width
  };
}

var data_proxy_DataProxy = /*#__PURE__*/function () {
  function DataProxy(name, id, settings) {
    var _this2 = this;

    _classCallCheck(this, DataProxy);

    // debugger;
    this.settings = helper.merge(getDefaultSettings(), settings || {}); // save data begin

    this.name = name || 'sheet';
    this.id = id ? id : "".concat(helper.nameEncode(this.name)).concat(new Date().getTime());
    this.color = this.settings.color || '';
    this.freeze = [0, 0];
    this.styles = []; // Array<Style>

    this.merges = new merge_Merges(); // [CellRange, ...]

    this.rows = new row_Rows(this.settings.row, this.settings.showIdentifier);
    this.cols = new col_Cols(this.settings.col, this.settings.showIdentifier);
    this.row = this.settings.row;
    this.col = this.settings.col;
    this.filterCellText = this.settings.filterCellText;

    if (this.settings.minContent) {
      this.settings.view = {
        width: function width() {
          return Math.min(settings.view.width(), _this2.cols.sumWidth(0, _this2.cols.len) + 22);
        },
        height: function height() {
          var h = 0;

          if (_this2.settings.showBottombar) {
            h += bottombarHeight;
          }

          if (_this2.settings.showToolbar) {
            h += toolbarHeight;
          }

          return Math.min(settings.view.height(), _this2.rows.sumHeight(0, _this2.rows.len) + h + 12);
        }
      };
    }

    this.showGrid = this.settings.showGrid;
    this.permissionConfigs = this.settings.permissionConfigs;
    this.queryConfigs = this.settings.queryConfigs;
    this.formConfig = this.settings.formConfig;
    this.rectConfig = this.settings.rectConfig;
    this.validations = new validation_Validations(this.getCellParseValue.bind(this), this.getIdentifierParseValue.bind(this));
    this.subscript = new subscript_Subscript();
    this.hyperlinks = {};
    this.comments = new comments_Comments();
    this.examines = new examine_Examines(this.getIdentifierExamine.bind(this)); // save data end
    // don't save object

    this.names = [];
    this.selector = new selector_Selector();
    this.scroll = new scroll_Scroll();
    this.history = new history_History(this.settings.isAddHistory);
    this.clipboard = new clipboard_Clipboard();
    this.autoFilter = new auto_filter_AutoFilter();

    this.change = function () {};

    this.exceptRowSet = new Set();
    this.sortedRowMap = new Map();
    this.unsortedRowMap = new Map();

    this.getSheetCellText = function () {};

    this.getSheetNames = function () {};

    this.isHoldSelector = false;
    this.wildcard = new wildcard_Wildcard();
  }

  _createClass(DataProxy, [{
    key: "addValidation",
    value: function addValidation(mode, ref, validator) {
      var _this3 = this;

      // console.log('mode:', mode, ', ref:', ref, ', validator:', validator);
      this.changeData(function () {
        _this3.validations.add(mode, ref, validator);
      });
    }
  }, {
    key: "removeValidation",
    value: function removeValidation() {
      var _this4 = this;

      var range = this.selector.range;
      this.changeData(function () {
        _this4.validations.remove(range);
      });
    }
  }, {
    key: "getSelectedValidator",
    value: function getSelectedValidator() {
      var _this$selector = this.selector,
          ri = _this$selector.ri,
          ci = _this$selector.ci;
      var v = this.validations.get(ri, ci);
      return v ? v.validator : null;
    }
  }, {
    key: "getSelectedValidation",
    value: function getSelectedValidation() {
      var _this$selector2 = this.selector,
          ri = _this$selector2.ri,
          ci = _this$selector2.ci,
          range = _this$selector2.range;
      var v = this.validations.get(ri, ci);
      var ret = {
        ref: range.toString()
      };

      if (v !== null) {
        ret.mode = v.mode;
        ret.validator = v.validator;
      }

      return ret;
    }
  }, {
    key: "canUndo",
    value: function canUndo() {
      return this.history.canUndo();
    }
  }, {
    key: "canRedo",
    value: function canRedo() {
      return this.history.canRedo();
    }
  }, {
    key: "undo",
    value: function undo() {
      var _this5 = this;

      this.history.undo(this.getData(), function (d) {
        _this5.setData(d, ['formConfig']);
      });
    }
  }, {
    key: "redo",
    value: function redo() {
      var _this6 = this;

      this.history.redo(this.getData(), function (d) {
        _this6.setData(d, ['formConfig']);
      });
    }
  }, {
    key: "copy",
    value: function copy() {
      this.clipboard.copy(this.selector.range);
    }
  }, {
    key: "copyToClipboard",
    value: function copyToClipboard(text) {
      var textArea = document.createElement('textarea');
      textArea.value = text;
      document.body.appendChild(textArea);
      textArea.select();

      try {
        var successful = document.execCommand('copy');
        var msg = successful ? 'successful' : 'unsuccessful';
        console.log('Copying text command was ' + msg);
      } catch (err) {
        console.log('Oops, unable to copy');
      }

      document.body.removeChild(textArea);
    }
  }, {
    key: "getFormulaVal",
    value: function getFormulaVal(formula, values) {
      var isClear = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;

      if (isClear) {
        clearFormulaValCache();
      }

      return calcFormulaVal(formula, values);
    }
  }, {
    key: "copyToSystemClipboard",
    value: function copyToSystemClipboard() {
      var copyText = '';
      var rowData = this.rows.getData();

      for (var ri = this.selector.range.sri; ri <= this.selector.range.eri; ri++) {
        if (Object.prototype.hasOwnProperty.call(rowData, ri)) {
          for (var ci = this.selector.range.sci; ci <= this.selector.range.eci; ci++) {
            if (ci > this.selector.range.sci) {
              copyText += '\t';
            }

            if (Object.prototype.hasOwnProperty.call(rowData[ri].cells, ci)) {
              var cellText = String(rowData[ri].cells[ci].text);

              if (cellText.indexOf('\n') == -1 && cellText.indexOf('\t') == -1 && cellText.indexOf('"') == -1) {
                copyText += cellText;
              } else {
                copyText += '"' + cellText + '"';
              }
            }
          }
        } else {
          for (var _ci = this.selector.range.sci; _ci <= this.selector.range.eci; _ci++) {
            copyText += '\t';
          }
        }

        copyText += '\n';
      }

      this.clipboard.setCopy(copyText);

      if (navigator.clipboard == undefined) {
        this.copyToClipboard(copyText);
        return;
      }

      navigator.clipboard.writeText(copyText).then(function () {}, function (err) {
        console.log('text copy to the system clipboard error  ', copyText, err);
      });
    }
  }, {
    key: "cut",
    value: function cut() {
      this.clipboard.cut(this.selector.range);
    } // what: all | text | format

  }, {
    key: "paste",
    value: function paste() {
      var _this7 = this;

      var what = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'all';
      var error = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : function () {};
      var eventTrigger = arguments.length > 2 ? arguments[2] : undefined;
      // console.log('sIndexes:', sIndexes);
      var clipboard = this.clipboard,
          selector = this.selector;
      if (clipboard.isClear()) return false;
      this.clearCache();
      if (!canPaste.call(this, clipboard.range, selector.range, error)) return false;
      this.changeData(function () {
        if (clipboard.isCopy()) {
          data_proxy_copyPaste.call(_this7, clipboard.range, selector.range, what);
        } else if (clipboard.isCut()) {
          cutPaste.call(_this7, clipboard.range, selector.range);
        }

        eventTrigger(_this7.rows.getData());
      });
      return true;
    }
  }, {
    key: "pasteFromSystemClipboard",
    value: function pasteFromSystemClipboard(resetSheet, eventTrigger, cbCopy, cbClear) {
      var _this8 = this;

      var selector = this.selector,
          clipboard = this.clipboard;
      navigator.clipboard.readText().then(function (content) {
        if (!clipboard.isClear() && clipboard.isSelf(content)) {
          //是否spread-sheet内容
          cbCopy();
        } else {
          var contentToPaste = _this8.parseClipboardContent(content);

          var startRow = selector.ri;
          contentToPaste.forEach(function (row) {
            var startColumn = selector.ci;
            row.forEach(function (cellContent) {
              var txt = (cellContent === null || cellContent === void 0 ? void 0 : cellContent.replace(/\r/g, '').replace(/\s+$/, '')) || '';
              var ntxt = txt.replace(/\s+/, '');

              if (helper.isSeparator.test(ntxt)) {
                txt = ntxt.replace(/,/g, '') * 1;
              } else if (helper.isSeparator.test(txt)) {
                txt = txt.replace(/,/g, '') * 1;
              }

              _this8.setCellText(startRow, startColumn, "".concat(txt), 'input');

              startColumn += 1;
            });
            startRow += 1;
          });

          _this8.clearCache();

          resetSheet();
          eventTrigger(_this8.rows.getData());
          cbClear();
        }
      });
    }
  }, {
    key: "parseClipboardContent",
    value: function parseClipboardContent(clipboardContent) {
      var parsedData = [];
      var rows = clipboardContent.split('\n');
      var i = 0;
      var len = rows.length;
      if (rows[len - 1] === '') rows.pop();
      rows.forEach(function (row) {
        parsedData[i] = row.split('\t');
        i += 1;
      });
      return parsedData;
    }
  }, {
    key: "pasteHandel",
    value: function pasteHandel(clipboardRange, selectorRange) {
      data_proxy_copyPaste.call(this, clipboardRange, selectorRange, 'all');
    }
  }, {
    key: "pasteFromText",
    value: function pasteFromText(txt, eventTrigger) {
      var lines = [];
      if (/\r\n/.test(txt)) lines = txt.split('\r\n').map(function (it) {
        return it.replace(/"/g, '').split('\t');
      });else lines = txt.split('\n').map(function (it) {
        return it.replace(/"/g, '').split('\t');
      });

      if (lines.length) {
        for (var i = 0; i < lines.length; i++) {
          for (var j = 0; j < lines[i].length; j++) {
            var _txt = lines[i][j].replace(/\s+$/, '') || '';

            var ntxt = _txt.replace(/\s+/, '');

            if (helper.isSeparator.test(ntxt)) {
              _txt = ntxt.replace(/,/g, '') * 1;
            } else if (helper.isSeparator.test(_txt)) {
              _txt = _txt.replace(/,/g, '') * 1;
            }

            lines[i][j] = "".concat(_txt);
          }
        }

        if (lines.length) {
          var lastLine = lines[lines.length - 1];

          if (lastLine.length === 1 && lastLine[0] == '') {
            lines.pop();
          }
        }

        var rows = this.rows,
            selector = this.selector;
        this.changeData(function () {
          rows.paste(lines, selector.range);
          eventTrigger(rows.getData());
        });
      }
    }
  }, {
    key: "autofill",
    value: function autofill(cellRange, what) {
      var _this9 = this;

      var error = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : function () {};
      var srcRange = this.selector.range;
      if (!canPaste.call(this, srcRange, cellRange, error)) return false;
      this.changeData(function () {
        data_proxy_copyPaste.call(_this9, srcRange, cellRange, what, true);
      });
      return true;
    }
  }, {
    key: "clearClipboard",
    value: function clearClipboard() {
      this.clipboard.clear();
    }
  }, {
    key: "calSelectedRangeByEnd",
    value: function calSelectedRangeByEnd(ri, ci) {
      var selector = this.selector,
          rows = this.rows,
          cols = this.cols,
          merges = this.merges;
      var _selector$range2 = selector.range,
          sri = _selector$range2.sri,
          sci = _selector$range2.sci,
          eri = _selector$range2.eri,
          eci = _selector$range2.eci;
      var cri = selector.ri;
      var cci = selector.ci;
      var nri = ri,
          nci = ci;
      if (ri < 0) nri = rows.len - 1;
      if (ci < 0) nci = cols.len - 1;

      if (nri > cri) {
        sri = cri;
        eri = nri;
      } else {
        sri = nri;
        eri = cri;
      }

      if (nci > cci) {
        sci = cci;
        eci = nci;
      } else {
        sci = nci;
        eci = cci;
      }

      if (ri === -1 || ci === -1) {
        selector.range = new cell_range_CellRange(sri, sci, eri, eci);
      } else {
        selector.range = merges.union(new cell_range_CellRange(sri, sci, eri, eci));
        selector.range = merges.union(selector.range);
      } // console.log('selector.range:', selector.range);


      return selector.range;
    }
  }, {
    key: "calSelectedContains",
    value: function calSelectedContains(ri, ci) {
      var selector = this.selector,
          rows = this.rows,
          cols = this.cols,
          merges = this.merges;
      var cellRange = merges.getFirstIncludes(ri, ci); // console.log('cellRange:', cellRange, ri, ci, merges);

      if (cellRange === null) {
        cellRange = new cell_range_CellRange(ri, ci, ri, ci);

        if (ri === -1) {
          cellRange.sri = 0;
          cellRange.eri = rows.len - 1;
        }

        if (ci === -1) {
          cellRange.sci = 0;
          cellRange.eci = cols.len - 1;
        }
      }

      return selector.range.contains(cellRange);
    }
  }, {
    key: "calSelectedRangeByStart",
    value: function calSelectedRangeByStart(ri, ci) {
      var selector = this.selector,
          rows = this.rows,
          cols = this.cols,
          merges = this.merges;
      var cellRange = merges.getFirstIncludes(ri, ci); // console.log('cellRange:', cellRange, ri, ci, merges);

      if (cellRange === null) {
        cellRange = new cell_range_CellRange(ri, ci, ri, ci);

        if (ri === -1) {
          cellRange.sri = 0;
          cellRange.eri = rows.len - 1;
        }

        if (ci === -1) {
          cellRange.sci = 0;
          cellRange.eci = cols.len - 1;
        }
      }

      selector.range = cellRange;
      return cellRange;
    }
  }, {
    key: "setSelectedCellAttr",
    value: function setSelectedCellAttr(property, value) {
      var _this10 = this;

      this.changeData(function () {
        var selector = _this10.selector,
            rows = _this10.rows;

        if (property === 'merge') {
          _this10.clearCache();

          if (value) _this10.merge();else _this10.unmerge();
        } else if (property === 'border') {
          setStyleBorders.call(_this10, value);
        } else if (property === 'formula') {
          // console.log('>>>', selector.multiple());
          var ri = selector.ri,
              ci = selector.ci,
              range = selector.range;

          if (selector.multiple()) {
            var _selector$size = selector.size(),
                _selector$size2 = _slicedToArray(_selector$size, 2),
                rn = _selector$size2[0],
                cn = _selector$size2[1];

            var sri = range.sri,
                sci = range.sci,
                eri = range.eri,
                eci = range.eci;

            if (rn > 1) {
              for (var i = sci; i <= eci; i += 1) {
                var cell = rows.getCellOrNew(eri + 1, i);
                cell.text = "=".concat(value, "(").concat(alphabet_xy2expr(i, sri), ":").concat(alphabet_xy2expr(i, eri), ")");
              }
            } else if (cn > 1) {
              var _cell2 = rows.getCellOrNew(ri, eci + 1);

              _cell2.text = "=".concat(value, "(").concat(alphabet_xy2expr(sci, ri), ":").concat(alphabet_xy2expr(eci, ri), ")");
            }
          } else {
            var _cell3 = rows.getCellOrNew(ri, ci);

            _cell3.text = "=".concat(value, "()");
          }
        } else {
          selector.range.each(function (ri, ci) {
            return _this10.setCellStyle(property, value, ri, ci);
          });
        }
      });
    }
  }, {
    key: "setCellStyle",
    value: function setCellStyle(property, value, ri, ci) {
      var styles = this.styles,
          rows = this.rows;
      var cell = rows.getCellOrNew(ri, ci);
      var cstyle = {};

      if (cell.style !== undefined) {
        cstyle = helper.cloneDeep(styles[cell.style]);
      }

      if (property === 'format') {
        cstyle.format = value;
        cell.style = this.addStyle(cstyle);
      } else if (property === 'font-bold' || property === 'font-italic' || property === 'font-name' || property === 'font-size') {
        var nfont = {};
        nfont[property.split('-')[1]] = value;
        cstyle.font = Object.assign(cstyle.font || {}, nfont);
        cell.style = this.addStyle(cstyle);
      } else if (property === 'indent-dec' || property === 'indent-add') {
        var _cstyle;

        var flag = property.split('-')[1];
        var indent = ((_cstyle = cstyle) === null || _cstyle === void 0 ? void 0 : _cstyle.indent) || 0;

        if (flag === 'dec') {
          cstyle.indent = Math.max(indent - 1, 0);
        } else if (flag === 'add') {
          cstyle.indent = Math.min(indent + 1, 15);
        }

        cell.style = this.addStyle(cstyle);
      } else if (property === 'strike' || property === 'textwrap' || property === 'underline' || property === 'align' || property === 'valign' || property === 'color' || property === 'bgcolor') {
        cstyle[property] = value;
        cell.style = this.addStyle(cstyle);
      } else {
        cell[property] = value;
      }
    } // state: input | finished

  }, {
    key: "setSelectedCellText",
    value: function setSelectedCellText(text) {
      var state = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'input';
      var autoFilter = this.autoFilter,
          selector = this.selector,
          rows = this.rows;
      var ri = selector.ri,
          ci = selector.ci;
      var nri = ri;

      if (this.unsortedRowMap.has(ri)) {
        nri = this.unsortedRowMap.get(ri);
      }

      var oldCell = rows.getCell(nri, ci);
      var oldText = oldCell ? oldCell.text : '';
      this.setCellText(nri, ci, text, state); // replace filter.value

      if (autoFilter.active()) {
        var filter = autoFilter.getFilter(ci);

        if (filter) {
          var vIndex = filter.value.findIndex(function (v) {
            return v === oldText;
          });

          if (vIndex >= 0) {
            filter.value.splice(vIndex, 1, text);
          } // console.log('filter:', filter, oldCell);

        }
      } // this.resetAutoFilter();

    }
  }, {
    key: "getSelectedCell",
    value: function getSelectedCell() {
      var _this$selector3 = this.selector,
          ri = _this$selector3.ri,
          ci = _this$selector3.ci;
      var nri = ri;

      if (this.unsortedRowMap.has(ri)) {
        nri = this.unsortedRowMap.get(ri);
      }

      return this.rows.getCell(nri, ci);
    }
  }, {
    key: "xyInSelectedRect",
    value: function xyInSelectedRect(x, y) {
      var _this$getSelectedRect = this.getSelectedRect(),
          left = _this$getSelectedRect.left,
          top = _this$getSelectedRect.top,
          width = _this$getSelectedRect.width,
          height = _this$getSelectedRect.height;

      var x1 = x - this.cols.indexWidth;
      var y1 = y - this.rows.indexHeight; // console.log('x:', x, ',y:', y, 'left:', left, 'top:', top);

      return x1 > left && x1 < left + width && y1 > top && y1 < top + height;
    }
  }, {
    key: "getSelectedRect",
    value: function getSelectedRect() {
      return this.getRect(this.selector.range);
    }
  }, {
    key: "getClipboardRect",
    value: function getClipboardRect() {
      var clipboard = this.clipboard;

      if (!clipboard.isClear()) {
        return this.getRect(clipboard.range);
      }

      return {
        left: -100,
        top: -100
      };
    }
  }, {
    key: "getRect",
    value: function getRect(cellRange) {
      var scroll = this.scroll,
          rows = this.rows,
          cols = this.cols,
          exceptRowSet = this.exceptRowSet;
      var sri = cellRange.sri,
          sci = cellRange.sci,
          eri = cellRange.eri,
          eci = cellRange.eci; // console.log('sri:', sri, ',sci:', sci, ', eri:', eri, ', eci:', eci);
      // no selector

      if (sri < 0 && sci < 0) {
        return {
          left: 0,
          l: 0,
          top: 0,
          t: 0,
          scroll: scroll
        };
      }

      var left = cols.sumWidth(0, sci);
      var top = rows.sumHeight(0, sri, exceptRowSet);
      var height = rows.sumHeight(sri, eri + 1, exceptRowSet);
      var width = cols.sumWidth(sci, eci + 1); // console.log('sri:', sri, ', sci:', sci, ', eri:', eri, ', eci:', eci);

      var left0 = left - scroll.x;
      var top0 = top - scroll.y;
      var fsh = this.freezeTotalHeight();
      var fsw = this.freezeTotalWidth();

      if (fsw > 0 && fsw > left) {
        left0 = left;
      }

      if (fsh > 0 && fsh > top) {
        top0 = top;
      }

      return {
        l: left,
        t: top,
        left: left0,
        top: top0,
        height: height,
        width: width,
        scroll: scroll
      };
    }
  }, {
    key: "getCellRectByXY",
    value: function getCellRectByXY(x, y) {
      var scroll = this.scroll,
          merges = this.merges,
          rows = this.rows,
          cols = this.cols;

      var _getCellRowByY$call = getCellRowByY.call(this, y, scroll.y),
          ri = _getCellRowByY$call.ri,
          top = _getCellRowByY$call.top,
          height = _getCellRowByY$call.height;

      var _getCellColByX$call = getCellColByX.call(this, x, scroll.x),
          ci = _getCellColByX$call.ci,
          left = _getCellColByX$call.left,
          width = _getCellColByX$call.width;

      if (ci === -1) {
        width = cols.totalWidth();
      }

      if (ri === -1) {
        height = rows.totalHeight();
      }

      if (ri >= 0 || ci >= 0) {
        var merge = merges.getFirstIncludes(ri, ci);

        if (merge) {
          ri = merge.sri;
          ci = merge.sci;

          var _this$cellRect = this.cellRect(ri, ci);

          left = _this$cellRect.left;
          top = _this$cellRect.top;
          width = _this$cellRect.width;
          height = _this$cellRect.height;
          left = left + cols.indexWidth;
          top = top + rows.indexHeight;
        }
      }

      return {
        ri: ri,
        ci: ci,
        left: left,
        top: top,
        width: width,
        height: height
      };
    }
  }, {
    key: "isSignleSelected",
    value: function isSignleSelected() {
      var _this$selector$range = this.selector.range,
          sri = _this$selector$range.sri,
          sci = _this$selector$range.sci,
          eri = _this$selector$range.eri,
          eci = _this$selector$range.eci;
      var cell = this.getCell(sri, sci);

      if (cell && cell.merge) {
        var _cell$merge3 = _slicedToArray(cell.merge, 2),
            rn = _cell$merge3[0],
            cn = _cell$merge3[1];

        if (sri + rn === eri && sci + cn === eci) return true;
      }

      return !this.selector.multiple();
    }
  }, {
    key: "canUnmerge",
    value: function canUnmerge() {
      var _this$selector$range2 = this.selector.range,
          sri = _this$selector$range2.sri,
          sci = _this$selector$range2.sci,
          eri = _this$selector$range2.eri,
          eci = _this$selector$range2.eci;
      var cell = this.getCell(sri, sci);

      if (cell && cell.merge) {
        var _cell$merge4 = _slicedToArray(cell.merge, 2),
            rn = _cell$merge4[0],
            cn = _cell$merge4[1];

        if (sri + rn === eri && sci + cn === eci) return true;
      }

      return false;
    }
  }, {
    key: "merge",
    value: function merge(what) {
      var _this11 = this;

      var selector = this.selector,
          rows = this.rows;
      if (this.isSignleSelected()) return;

      var _selector$size3 = selector.size(),
          _selector$size4 = _slicedToArray(_selector$size3, 2),
          rn = _selector$size4[0],
          cn = _selector$size4[1]; // console.log('merge:', rn, cn);


      if (rn > 1 || cn > 1) {
        var _selector$range3 = selector.range,
            sri = _selector$range3.sri,
            sci = _selector$range3.sci;
        this.changeData(function () {
          var cell = rows.getCellOrNew(sri, sci);
          cell.merge = [rn - 1, cn - 1];

          _this11.merges.add(selector.range); // delete merge cells


          _this11.rows.deleteCells(selector.range, what); // console.log('cell:', cell, this.d);


          _this11.rows.setCell(sri, sci, cell);
        });
      }
    }
  }, {
    key: "unmerge",
    value: function unmerge() {
      var _this12 = this;

      var selector = this.selector;
      if (!this.isSignleSelected()) return;
      var _selector$range4 = selector.range,
          sri = _selector$range4.sri,
          sci = _selector$range4.sci;
      this.changeData(function () {
        _this12.rows.deleteCell(sri, sci, 'merge');

        _this12.merges.deleteWithin(selector.range);
      });
    }
  }, {
    key: "canAutofilter",
    value: function canAutofilter() {
      return !this.autoFilter.active();
    }
  }, {
    key: "autofilter",
    value: function autofilter() {
      var _this13 = this;

      // debugger;
      var autoFilter = this.autoFilter,
          selector = this.selector;
      var range = selector.range.clone();
      this.changeData(function () {
        if (autoFilter.active()) {
          autoFilter.clear();
          _this13.exceptRowSet = new Set();
          _this13.sortedRowMap = new Map();
          _this13.unsortedRowMap = new Map();
        } else {
          var data = _this13.getData(); //选择单个单元格过滤自动选择邻列


          if (range.sci === range.eci && range.sri === range.eri) {
            var i = range.sci,
                maxl = data.cols.len,
                minl = 0,
                startc = range.sci,
                endc = range.sci;

            while (maxl > i) {
              var findFlag = false;

              for (var key in data.rows) {
                var _data$rows$key, _data$rows$key$cells$;

                if (key === 'len') continue;

                if ((_data$rows$key = data.rows[key]) !== null && _data$rows$key !== void 0 && (_data$rows$key$cells$ = _data$rows$key.cells[i]) !== null && _data$rows$key$cells$ !== void 0 && _data$rows$key$cells$.text) {
                  endc = i;
                  findFlag = true;
                  i++;
                  break;
                }
              }

              if (findFlag === false) {
                break;
              }
            }

            i = range.sci;

            while (minl <= i) {
              var _findFlag = false;

              for (var _key in data.rows) {
                var _data$rows$_key, _data$rows$_key$cells;

                if (_key === 'len') continue;

                if ((_data$rows$_key = data.rows[_key]) !== null && _data$rows$_key !== void 0 && (_data$rows$_key$cells = _data$rows$_key.cells[i]) !== null && _data$rows$_key$cells !== void 0 && _data$rows$_key$cells.text) {
                  startc = i;
                  _findFlag = true;
                  i--;
                  break;
                }
              }

              if (_findFlag === false) {
                break;
              }
            }

            range.sci = startc;
            range.eci = endc;
          }

          if (range.sri == range.eri) {
            autoFilter.isSelectOneRow = true; // debugger;

            var rowsKeys = Object.keys(data.rows);
            rowsKeys.pop();
            var maxRow = Math.max.apply(Math, [0].concat(_toConsumableArray(rowsKeys.map(function (n) {
              return parseInt(n);
            }))));
            range.eri = maxRow;
          } // console.log(data,selector,range)


          autoFilter.ref = range.toString();
        }
      });
    }
  }, {
    key: "setAutoFilter",
    value: function setAutoFilter(ci, order, operator, value) {
      var autoFilter = this.autoFilter;
      autoFilter.addFilter(ci, operator, value);
      autoFilter.setSort(ci, order);
      this.resetAutoFilter();
    }
  }, {
    key: "resetAutoFilter",
    value: function resetAutoFilter() {
      var _this14 = this;

      var autoFilter = this.autoFilter,
          rows = this.rows;
      if (!autoFilter.active()) return;
      var sort = autoFilter.sort;

      var _autoFilter$filteredR = autoFilter.filteredRows(function (r, c) {
        return rows.getCell(r, c);
      }),
          rset = _autoFilter$filteredR.rset,
          fset = _autoFilter$filteredR.fset;

      var fary = Array.from(fset);
      var oldAry = Array.from(fary.map(function (o) {
        return o.ri;
      }));

      if (sort) {
        var hasNaN = fary.some(function (o) {
          return isNaN(o.text);
        });
        fary.sort(function (a, b) {
          var tempa = a.text,
              tempb = b.text;

          if (!hasNaN) {
            tempa = parseFloat(a.text);
            tempb = parseFloat(b.text);
            if (sort.order === 'asc') return tempa - tempb;
            if (sort.order === 'desc') return tempb - tempa;
          } else {
            if (sort.order === 'asc') return tempa > tempb ? 1 : -1;
            if (sort.order === 'desc') return tempb > tempa ? 1 : -1;
          }

          return 0;
        });
      }

      this.exceptRowSet = rset;
      this.sortedRowMap = new Map();
      this.unsortedRowMap = new Map();
      fary.map(function (o) {
        return o.ri;
      }).forEach(function (it, index) {
        _this14.sortedRowMap.set(oldAry[index], it);

        _this14.unsortedRowMap.set(it, oldAry[index]);
      });
    }
  }, {
    key: "deleteCell",
    value: function deleteCell() {
      var _this15 = this;

      var what = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'all';
      this.clearCache();
      var selector = this.selector;
      this.changeData(function () {
        _this15.rows.deleteCells(selector.range, what);

        if (what === 'all' || what === 'format') {
          _this15.merges.deleteWithin(selector.range);
        }
      });
    }
  }, {
    key: "handleDelete",
    value: function handleDelete(range) {
      var type = 'row';
      var rows = this.rows,
          merges = this.merges;
      var sri = range.sri,
          eri = range.eri;

      var _range$size = range.size(),
          _range$size2 = _slicedToArray(_range$size, 1),
          rsize = _range$size2[0];

      var si = sri;
      var size = rsize;

      if (type === 'row') {
        rows.delete(sri, eri);
      } // console.log('type:', type, ', si:', si, ', size:', size);


      merges.shift(type, si, -size, function (ri, ci, rn, cn) {
        // console.log('ri:', ri, ', ci:', ci, ', rn:', rn, ', cn:', cn);
        var cell = rows.getCell(ri, ci);
        cell.merge[0] += rn;
        cell.merge[1] += cn;

        if (cell.merge[0] === 0 && cell.merge[1] === 0) {
          delete cell.merge;
        }
      });
    } // type: row | column

  }, {
    key: "insert",
    value: function insert(type) {
      var _this16 = this;

      var n = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;
      this.clearCache();
      this.changeData(function () {
        var _this16$selector$rang = _this16.selector.range,
            sri = _this16$selector$rang.sri,
            sci = _this16$selector$rang.sci;

        _this16.insertHandler(type, n, sri, sci);
      });
    }
  }, {
    key: "insertHandler",
    value: function insertHandler(type, n, sri, sci) {
      var rows = this.rows,
          merges = this.merges,
          cols = this.cols;
      var si = sri;

      if (type === 'row') {
        rows.insert(sri, n);
      } else if (type === 'column') {
        rows.insertColumn(sci, n);
        cols.update(sci, n);
        si = sci;
        cols.len += n;
      }

      merges.shift(type, si, n, function (ri, ci, rn, cn) {
        var cell = rows.getCell(ri, ci);
        cell.merge[0] += rn;
        cell.merge[1] += cn;
      });
    }
  }, {
    key: "handlerComment",
    value: function handlerComment(handler, ri, ci, comment) {
      if (handler === 'edit') {
        this.comments.setComment(ri, ci, [{
          text: comment
        }]);
      } else if (handler === 'delete') {
        this.comments.delComment(ri, ci);
      }
    }
  }, {
    key: "getComment",
    value: function getComment(ri, ci) {
      return this.comments.getComment(ri, ci);
    } // type: row | column

  }, {
    key: "delete",
    value: function _delete(type) {
      var _this17 = this;

      this.clearCache();
      this.changeData(function () {
        var rows = _this17.rows,
            merges = _this17.merges,
            selector = _this17.selector,
            cols = _this17.cols;
        var range = selector.range;
        var _selector$range5 = selector.range,
            sri = _selector$range5.sri,
            sci = _selector$range5.sci,
            eri = _selector$range5.eri,
            eci = _selector$range5.eci;

        var _selector$range$size = selector.range.size(),
            _selector$range$size2 = _slicedToArray(_selector$range$size, 2),
            rsize = _selector$range$size2[0],
            csize = _selector$range$size2[1];

        var si = sri;
        var size = rsize;

        if (type === 'row') {
          rows.delete(sri, eri);
        } else if (type === 'column') {
          rows.deleteColumn(sci, eci);
          si = range.sci;
          size = csize;
          cols.len -= eci - sci + 1;
          cols.update(sci, -csize);
        } // console.log('type:', type, ', si:', si, ', size:', size);


        merges.shift(type, si, -size, function (ri, ci, rn, cn) {
          // console.log('ri:', ri, ', ci:', ci, ', rn:', rn, ', cn:', cn);
          var cell = rows.getCell(ri, ci);
          cell.merge[0] += rn;
          cell.merge[1] += cn;

          if (cell.merge[0] === 0 && cell.merge[1] === 0) {
            delete cell.merge;
          }
        });

        _this17.deleteAutoFilter();
      });
    }
    /**
     * 如果删除行列带有筛选头部一块去除
     */

  }, {
    key: "deleteAutoFilter",
    value: function deleteAutoFilter() {
      var autoFilter = this.autoFilter,
          selector = this.selector;
      var _selector$range6 = selector.range,
          sri = _selector$range6.sri,
          sci = _selector$range6.sci;

      if (!autoFilter.ref) {
        return;
      }

      var autoFilterRange = autoFilter.range();

      if (sri === autoFilterRange.sri) {
        autoFilter.clear();
        this.resetAutoFilter();
      } else if (sci <= autoFilterRange.eci && sci >= autoFilterRange.sci) {
        if (autoFilterRange.sci === autoFilterRange.eci) {
          autoFilter.clear();
        } else {
          autoFilterRange.eci--;
        }

        autoFilter.ref = autoFilterRange.toString();
        this.resetAutoFilter();
      }
    }
  }, {
    key: "scrollx",
    value: function scrollx(x, cb) {
      var scroll = this.scroll,
          freeze = this.freeze,
          cols = this.cols;

      var _freeze = _slicedToArray(freeze, 2),
          fci = _freeze[1];

      var _helper$rangeReduceIf3 = helper.rangeReduceIf(fci, cols.len, 0, 0, x, function (i) {
        return cols.getWidth(i);
      }),
          _helper$rangeReduceIf4 = _slicedToArray(_helper$rangeReduceIf3, 3),
          ci = _helper$rangeReduceIf4[0],
          left = _helper$rangeReduceIf4[1],
          width = _helper$rangeReduceIf4[2]; // console.log('fci:', fci, ', ci:', ci);


      var x1 = left;
      if (x > 0) x1 += width;

      if (scroll.x !== x1) {
        scroll.ci = x > 0 ? ci : 0;
        scroll.x = x1;
        cb();
      }
    }
  }, {
    key: "scrolly",
    value: function scrolly(y, cb) {
      var scroll = this.scroll,
          freeze = this.freeze,
          rows = this.rows;

      var _freeze2 = _slicedToArray(freeze, 1),
          fri = _freeze2[0];

      var _helper$rangeReduceIf5 = helper.rangeReduceIf(fri, rows.len, 0, 0, y, function (i) {
        return rows.getHeight(i);
      }),
          _helper$rangeReduceIf6 = _slicedToArray(_helper$rangeReduceIf5, 3),
          ri = _helper$rangeReduceIf6[0],
          top = _helper$rangeReduceIf6[1],
          height = _helper$rangeReduceIf6[2];

      var y1 = top;
      if (y > 0) y1 += height; // console.log('ri:', ri, ' ,y:', y1);

      if (scroll.y !== y1) {
        scroll.ri = y > 0 ? ri : 0;
        scroll.y = y1;
        cb();
      }
    }
  }, {
    key: "cellRect",
    value: function cellRect(ri, ci) {
      var rows = this.rows,
          cols = this.cols;
      var left = cols.sumWidth(0, ci);
      var top = rows.sumHeight(0, ri);
      var cell = rows.getCell(ri, ci);
      var width = cols.getWidth(ci);
      var height = rows.getHeight(ri);

      if (cell !== null) {
        if (cell.merge) {
          var _cell$merge5 = _slicedToArray(cell.merge, 2),
              rn = _cell$merge5[0],
              cn = _cell$merge5[1]; // console.log('cell.merge:', cell.merge);


          if (rn > 0) {
            for (var i = 1; i <= rn; i += 1) {
              height += rows.getHeight(ri + i);
            }
          }

          if (cn > 0) {
            for (var _i = 1; _i <= cn; _i += 1) {
              width += cols.getWidth(ci + _i);
            }
          }
        }
      } // console.log('data:', this.d);


      return {
        left: left,
        top: top,
        width: width,
        height: height,
        cell: cell
      };
    }
  }, {
    key: "getCell",
    value: function getCell(ri, ci) {
      return this.rows.getCell(ri, ci);
    }
  }, {
    key: "getCellParseValue",
    value: function getCellParseValue(ri, ci) {
      var _this18 = this;

      var cell = this.rows.getCell(ri, ci);
      var cellText = cell === null || cell === void 0 ? void 0 : cell.text;

      var identifier = alphabet_xy2expr(ci, ri);

      var names = this.getDatasSheetNames();

      var getRenderText = function getRenderText(y, x, sheetName) {
        return _this18.getCellTextOrDefault(x, y, sheetName);
      };

      return core_cell.render(cellText, getRenderText, null, names, identifier);
    }
  }, {
    key: "getIdentifierParseValue",
    value: function getIdentifierParseValue(cellText, identifier) {
      var _this19 = this;

      if (cellText) {
        var names = this.getDatasSheetNames();

        var getRenderText = function getRenderText(y, x, sheetName) {
          return _this19.getCellTextOrDefault(x, y, sheetName);
        };

        return core_cell.render(cellText, getRenderText, null, names, identifier);
      }

      return cellText;
    }
  }, {
    key: "getIdentifierExamine",
    value: function getIdentifierExamine(cellText, identifier) {
      var _this20 = this;

      if (cellText) {
        var names = this.getDatasSheetNames();
        names.activeName = this.name;

        var getRenderText = function getRenderText(y, x, sheetName) {
          return _this20.getCellTextOrDefault(x, y, sheetName);
        };

        return core_cell.render(cellText, getRenderText, null, names, identifier);
      }

      return cellText;
    }
  }, {
    key: "getCellTextOrDefault",
    value: function getCellTextOrDefault(ri, ci, sheetName) {
      if (sheetName) {
        return this.getSheetCellTextOrDefault(ri, ci, sheetName);
      }

      var cell = this.getCell(ri, ci);
      return cell && cell.text ? cell.text : null;
    }
  }, {
    key: "checkParse",
    value: function checkParse(cellText) {
      if (cellText) {
        var names = this.getDatasSheetNames();
        return cell_parserRun(cellText, names);
      }
    }
  }, {
    key: "getSheetCellTextOrDefault",
    value: function getSheetCellTextOrDefault(ri, ci, sheetName) {
      var cell = this.getSheetCellText(ri, ci, sheetName);
      return cell && cell.text ? cell.text : null;
    }
  }, {
    key: "getCellStyle",
    value: function getCellStyle(ri, ci) {
      var cell = this.getCell(ri, ci);

      if (cell && cell.style !== undefined) {
        return this.styles[cell.style];
      }

      return null;
    }
  }, {
    key: "getCellStyleOrDefault",
    value: function getCellStyleOrDefault(ri, ci) {
      var styles = this.styles,
          rows = this.rows;
      var cell = rows.getCell(ri, ci);
      var cellStyle = cell && cell.style !== undefined ? styles[cell.style] : {};
      return helper.merge(this.defaultStyle(), cellStyle);
    }
  }, {
    key: "getSelectedCellStyle",
    value: function getSelectedCellStyle() {
      var _this$selector4 = this.selector,
          ri = _this$selector4.ri,
          ci = _this$selector4.ci;
      return this.getCellStyleOrDefault(ri, ci);
    } // state: input | finished

  }, {
    key: "setCellText",
    value: function setCellText(ri, ci, text, state) {
      this.clearCache();
      var rows = this.rows,
          history = this.history;

      if (state === 'finished') {
        rows.setCellText(ri, ci, '');
        history.add(this.getData());
        rows.setCellText(ri, ci, text);
      } else {
        rows.setCellText(ri, ci, text);
        this.change(this.getData());
      }
    } // state: input | finished

  }, {
    key: "setCellObj",
    value: function setCellObj(ri, ci, ojb, state) {
      this.clearCache();
      var text = ojb.text,
          editable = ojb.editable;
      var rows = this.rows,
          history = this.history;

      if (state === 'finished') {
        rows.setCellText(ri, ci, '');
        rows.setCellEditable(ri, ci, true);
        history.add(this.getData());
        rows.setCellText(ri, ci, text);
        rows.setCellEditable(ri, ci, editable);
      } else {
        rows.setCellEditable(ri, ci, true);
        rows.setCellText(ri, ci, text);
        rows.setCellEditable(ri, ci, editable);
        this.change(this.getData());
      }
    }
  }, {
    key: "setCellEditable",
    value: function setCellEditable(ri, ci, editable) {
      var rows = this.rows;
      rows.setCellEditable(ri, ci, editable);
    }
  }, {
    key: "freezeIsActive",
    value: function freezeIsActive() {
      var _this$freeze = _slicedToArray(this.freeze, 2),
          ri = _this$freeze[0],
          ci = _this$freeze[1];

      return ri > 0 || ci > 0;
    }
  }, {
    key: "setFreeze",
    value: function setFreeze(ri, ci) {
      var _this21 = this;

      this.changeData(function () {
        _this21.freeze = [ri, ci];
      });
    }
  }, {
    key: "freezeTotalWidth",
    value: function freezeTotalWidth() {
      return this.cols.sumWidth(0, this.freeze[1]);
    }
  }, {
    key: "freezeTotalHeight",
    value: function freezeTotalHeight() {
      return this.rows.sumHeight(0, this.freeze[0]);
    }
  }, {
    key: "setRowHeight",
    value: function setRowHeight(ri, height) {
      var _this22 = this;

      this.changeData(function () {
        _this22.rows.setHeight(ri, height);
      });
    }
  }, {
    key: "setRowProperty",
    value: function setRowProperty(property, v) {
      var rows = this.rows,
          selector = this.selector;
      var _selector$range7 = selector.range,
          sri = _selector$range7.sri,
          eri = _selector$range7.eri;

      for (var ri = sri; ri <= eri; ri += 1) {
        rows.setProperty(ri, property, v);
      }
    }
  }, {
    key: "setColWidth",
    value: function setColWidth(ci, width) {
      var _this23 = this;

      this.changeData(function () {
        _this23.cols.setWidth(ci, width);
      });
    }
  }, {
    key: "viewHeight",
    value: function viewHeight() {
      var _this$settings = this.settings,
          view = _this$settings.view,
          showToolbar = _this$settings.showToolbar,
          showBottombar = _this$settings.showBottombar;
      var h = view.height();

      if (showBottombar) {
        h -= bottombarHeight;
      }

      if (showToolbar) {
        h -= toolbarHeight;
      }

      return h;
    }
  }, {
    key: "viewWidth",
    value: function viewWidth() {
      return this.settings.view.width();
    }
  }, {
    key: "freezeViewRange",
    value: function freezeViewRange() {
      var _this$freeze2 = _slicedToArray(this.freeze, 2),
          ri = _this$freeze2[0],
          ci = _this$freeze2[1];

      return new cell_range_CellRange(0, 0, ri - 1, ci - 1, this.freezeTotalWidth(), this.freezeTotalHeight());
    }
  }, {
    key: "contentRange",
    value: function contentRange() {
      var rows = this.rows,
          cols = this.cols;

      var _rows$maxCell = rows.maxCell(),
          _rows$maxCell2 = _slicedToArray(_rows$maxCell, 2),
          ri = _rows$maxCell2[0],
          ci = _rows$maxCell2[1];

      var h = rows.sumHeight(0, ri + 1);
      var w = cols.sumWidth(0, ci + 1);
      return new cell_range_CellRange(0, 0, ri, ci, w, h);
    }
  }, {
    key: "exceptRowTotalHeight",
    value: function exceptRowTotalHeight(sri, eri) {
      var exceptRowSet = this.exceptRowSet,
          rows = this.rows;
      var exceptRows = Array.from(exceptRowSet);
      var exceptRowTH = 0;
      exceptRows.forEach(function (ri) {
        if (ri < sri || ri > eri) {
          var height = rows.getHeight(ri);
          exceptRowTH += height;
        }
      });
      return exceptRowTH;
    }
  }, {
    key: "viewRange",
    value: function viewRange() {
      var scroll = this.scroll,
          rows = this.rows,
          cols = this.cols,
          freeze = this.freeze,
          exceptRowSet = this.exceptRowSet; // console.log('scroll:', scroll, ', freeze:', freeze)

      var ri = scroll.ri,
          ci = scroll.ci;

      if (ri <= 0) {
        var _freeze3 = _slicedToArray(freeze, 1);

        ri = _freeze3[0];
      }

      if (ci <= 0) {
        var _freeze4 = _slicedToArray(freeze, 2);

        ci = _freeze4[1];
      }

      var x = 0,
          y = 0;
      var _ref2 = [rows.len, cols.len],
          eri = _ref2[0],
          eci = _ref2[1];

      for (var i = ri; i < rows.len; i += 1) {
        if (!exceptRowSet.has(i)) {
          y += rows.getHeight(i);
          eri = i;
        }

        if (y > this.viewHeight()) break;
      }

      for (var j = ci; j < cols.len; j += 1) {
        x += cols.getWidth(j);
        eci = j;
        if (x > this.viewWidth()) break;
      } // console.log(ri, ci, eri, eci, x, y);


      return new cell_range_CellRange(ri, ci, eri, eci, x, y);
    }
  }, {
    key: "eachMergesInView",
    value: function eachMergesInView(viewRange, cb) {
      this.merges.filterIntersects(viewRange).forEach(function (it) {
        return cb(it);
      });
    }
  }, {
    key: "hideRowsOrCols",
    value: function hideRowsOrCols() {
      var rows = this.rows,
          cols = this.cols,
          selector = this.selector;

      var _selector$size5 = selector.size(),
          _selector$size6 = _slicedToArray(_selector$size5, 2),
          rlen = _selector$size6[0],
          clen = _selector$size6[1];

      var _selector$range8 = selector.range,
          sri = _selector$range8.sri,
          sci = _selector$range8.sci,
          eri = _selector$range8.eri,
          eci = _selector$range8.eci;

      if (rlen === rows.len) {
        for (var ci = sci; ci <= eci; ci += 1) {
          cols.setHide(ci, true);
        }
      } else if (clen === cols.len) {
        for (var ri = sri; ri <= eri; ri += 1) {
          rows.setHide(ri, true);
        }
      }
    } // type: row | col
    // index row-index | col-index

  }, {
    key: "unhideRowsOrCols",
    value: function unhideRowsOrCols(type, index) {
      this["".concat(type, "s")].unhide(index);
    }
  }, {
    key: "rowEach",
    value: function rowEach(min, max, cb) {
      var y = 0;
      var rows = this.rows;
      var frset = this.exceptRowSet;

      var frary = _toConsumableArray(frset);

      var offset = 0;

      for (var i = 0; i < frary.length; i += 1) {
        if (frary[i] < min) {
          offset += 1;
        }
      } // console.log('min:', min, ', max:', max, ', scroll:', scroll);


      for (var _i2 = min + offset; _i2 <= max + offset; _i2 += 1) {
        if (frset.has(_i2)) {
          offset += 1;
        } else {
          var rowHeight = rows.getHeight(_i2);

          if (rowHeight > 0) {
            cb(_i2, y, rowHeight);
            y += rowHeight;
            if (y > this.viewHeight()) break;
          }
        }
      }
    }
  }, {
    key: "colEach",
    value: function colEach(min, max, cb) {
      var x = 0;
      var cols = this.cols;

      for (var i = min; i <= max; i += 1) {
        var colWidth = cols.getWidth(i);

        if (colWidth > 0) {
          cb(i, x, colWidth);
          x += colWidth;
          if (x > this.viewWidth()) break;
        }
      }
    }
  }, {
    key: "defaultStyle",
    value: function defaultStyle() {
      return this.settings.style;
    }
  }, {
    key: "addStyle",
    value: function addStyle(nstyle) {
      var styles = this.styles; // console.log('old.styles:', styles, nstyle);

      for (var i = 0; i < styles.length; i += 1) {
        var style = styles[i];
        if (helper.equals(style, nstyle)) return i;
      }

      styles.push(nstyle);
      return styles.length - 1;
    }
  }, {
    key: "changeData",
    value: function changeData(cb) {
      this.history.add(this.getData());
      cb();
      this.change(this.getData());
    }
  }, {
    key: "setData",
    value: function setData(d) {
      var _this24 = this;

      var filter = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];
      Object.keys(d).forEach(function (property) {
        if (filter.includes(property)) return;

        if (property === 'merges' || property === 'rows' || property === 'cols' || property === 'validations' || property === 'examines' || property === 'comments') {
          _this24[property].setData(d[property]);
        } else if (property === 'freeze') {
          var _expr2xy2 = alphabet_expr2xy(d[property]),
              _expr2xy3 = _slicedToArray(_expr2xy2, 2),
              x = _expr2xy3[0],
              y = _expr2xy3[1];

          _this24.freeze = [y, x];
        } else if (property === 'autofilter') {
          _this24.autoFilter.setData(d[property]);
        } else if (d[property] !== undefined) {
          _this24[property] = d[property];
        }
      });
      return this;
    }
  }, {
    key: "clearCache",
    value: function clearCache() {
      expCache.clearVal(this.name);
    }
  }, {
    key: "getData",
    value: function getData() {
      var id = this.id,
          name = this.name,
          color = this.color,
          freeze = this.freeze,
          styles = this.styles,
          merges = this.merges,
          rows = this.rows,
          cols = this.cols,
          validations = this.validations,
          autoFilter = this.autoFilter,
          row = this.row,
          col = this.col,
          showGrid = this.showGrid,
          permissionConfigs = this.permissionConfigs,
          comments = this.comments,
          queryConfigs = this.queryConfigs,
          examines = this.examines,
          formConfig = this.formConfig,
          rectConfig = this.rectConfig,
          background = this.background; // debugger;

      return {
        id: id,
        name: name,
        color: color,
        freeze: alphabet_xy2expr(freeze[1], freeze[0]),
        styles: styles,
        merges: merges.getData(),
        rows: rows.getData(),
        cols: cols.getData(),
        validations: validations.getData(),
        examines: examines.getData(),
        autofilter: autoFilter.getData(),
        row: row,
        col: col,
        showGrid: showGrid,
        comments: comments.getData(),
        permissionConfigs: permissionConfigs,
        queryConfigs: queryConfigs,
        formConfig: formConfig,
        rectConfig: rectConfig,
        background: background
      };
    }
  }, {
    key: "getLayerConfig",
    value: function getLayerConfig() {
      return {
        formConfig: this.formConfig,
        rectConfig: this.rectConfig,
        foldConfig: this.foldConfig
      };
    }
  }, {
    key: "setLayerConfig",
    value: function setLayerConfig(type, config) {
      this[type] = config;
    }
  }, {
    key: "getDatasSheetNames",
    value: function getDatasSheetNames() {
      return this.getSheetNames();
    }
  }, {
    key: "validate",
    value: function validate() {
      var _this25 = this;

      var validations = this.validations;
      validations.errors = new Map();
      validations.each(function (item) {
        var refs = item.refs;

        for (var i = 0; i < refs.length; i += 1) {
          var cellRange = cell_range_CellRange.valueOf(refs[i]);
          cellRange.each(function (ri, ci) {
            var cell = _this25.getCell(ri, ci);

            if (cell !== null && cell !== void 0 && cell.text) {
              var cellText = cell.text || '';
              validations.validate(ri, ci, cellText);
              validations.getError(ri, ci);
            }
          });
        }
      });
      return validations.errors;
    }
  }, {
    key: "examine",
    value: function examine(modes, cb) {
      var isExternal = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;
      var examines = this.examines;

      if (isExternal) {
        examines.externalValidate(modes, this.getDatasSheetNames(), cb);
      } else {
        examines.validate(modes, this.getDatasSheetNames(), cb);
      }

      return examines.errors;
    }
  }, {
    key: "getCellValidate",
    value: function getCellValidate(ri, ci) {
      var validations = this.validations;
      return validations.get(ri, ci);
    }
  }, {
    key: "getSelectedValidatorInfo",
    value: function getSelectedValidatorInfo() {
      if (this.selector.multiple()) return null;
      var _this$selector5 = this.selector,
          ri = _this$selector5.ri,
          ci = _this$selector5.ci;
      var validations = this.validations;
      var message = validations.getError(ri, ci);
      var v = this.validations.get(ri, ci);
      var validator = v ? v.validator : null;
      return _objectSpread2(_objectSpread2({}, validator), {}, {
        message: message
      });
    }
  }, {
    key: "lookUp",
    value: function lookUp(_lookUp) {
      var _this26 = this;

      return this.rows.lookUp(_lookUp, function (cellText, identifier) {
        return _this26.getIdentifierParseValue(cellText, identifier);
      });
    }
  }, {
    key: "expr2xy",
    value: function expr2xy(src) {
      return alphabet_expr2xy(src);
    }
  }, {
    key: "xy2expr",
    value: function xy2expr(x, y) {
      return alphabet_xy2expr(x, y);
    }
  }, {
    key: "getRangeCells",
    value: function getRangeCells(range, startFlag) {
      var _this27 = this;

      var rowsData = {};
      var rows = this.rows;
      var sriSub = 0;
      var sciSub = 0;

      if (startFlag) {
        var sri = range.sri,
            sci = range.sci;
        sriSub = sri;
        sciSub = sci;
      }

      range.each(function (ri, ci) {
        var sri = ri - sriSub;
        var sci = ci - sciSub;
        rowsData[sri] = rowsData[sri] || {
          cells: {}
        };
        var cell = rows.getCellOrNew(ri, ci);

        if (cell) {
          var text = (cell === null || cell === void 0 ? void 0 : cell.text) || null;

          if (text && "".concat(text[0]) == '=') {
            text = "".concat(_this27.getCellParseValue(ri, ci));
          }

          rowsData[sri].cells[sci] = {
            text: text,
            expr: _this27.xy2expr(ci, ri),
            ci: ci,
            ri: ri
          };
        }
      });
      return rowsData;
    }
  }, {
    key: "getRows",
    value: function getRows(range) {
      var _this28 = this;

      var cb = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : function () {};
      var rowsData = {};
      var rows = this.rows;
      range.each(function (ri, ci) {
        var cell = rows.getCellOrNew(ri, ci);

        if (cell) {
          var text = (cell === null || cell === void 0 ? void 0 : cell.text) || null;
          var value = null;
          var formConfigKey = (cell === null || cell === void 0 ? void 0 : cell.formConfigKey) || null;

          if (text && "".concat(text[0]) == '=') {
            value = "".concat(_this28.getCellParseValue(ri, ci));
          }

          if (text != null || formConfigKey != null) {
            rowsData[ri] = rowsData[ri] || {
              cells: {}
            };
            rowsData[ri].cells[ci] = _objectSpread2({
              text: text,
              value: value,
              expr: _this28.xy2expr(ci, ri)
            }, cb(ri, ci, formConfigKey, cell));
          }
        }
      });
      return rowsData;
    }
  }, {
    key: "getExprCell",
    value: function getExprCell(expr) {
      var rows = this.rows;

      var _expr2xy4 = alphabet_expr2xy(expr),
          _expr2xy5 = _slicedToArray(_expr2xy4, 2),
          ci = _expr2xy5[0],
          ri = _expr2xy5[1];

      var cell = rows.getCellOrNew(ri, ci);

      if (cell) {
        var text = (cell === null || cell === void 0 ? void 0 : cell.text) || null;

        if (text && "".concat(text[0]) == '=') {
          text = "".concat(this.getCellParseValue(ri, ci));
        }

        return text;
      }
    }
  }, {
    key: "getCrossExcels",
    value: function getCrossExcels(ruler) {
      var isObj = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;
      var examines = this.examines;
      var excelNames = examines.getCrossExcels(ruler);
      if (!isObj) return excelNames;
      var objExcelNames = [];

      var _iterator = _createForOfIteratorHelper(excelNames),
          _step;

      try {
        for (_iterator.s(); !(_step = _iterator.n()).done;) {
          var _item$match, _excelNameAndSheet$ma;

          var item = _step.value;
          var classification = (_item$match = item.match(/(?:((\#(.+?)\#)?))/g)) === null || _item$match === void 0 ? void 0 : _item$match[2];
          var excelNameAndSheet = item.replace(classification, '');
          var excelName = (_excelNameAndSheet$ma = excelNameAndSheet.match(/(?:((\[(.+?)\])?))/g)) === null || _excelNameAndSheet$ma === void 0 ? void 0 : _excelNameAndSheet$ma[1];
          var sheetName = excelNameAndSheet.replace(excelName, '');
          classification = classification.replace(/^(\s|\#)+|(\s|\#)$/g, '');
          excelName = excelName.replace(/^(\s|\[)+|(\s|\])$/g, '');
          sheetName = sheetName.replace(/^(\s|\')+|(\s|\')$/g, '');
          objExcelNames.push({
            classification: classification,
            excelName: excelName,
            sheetName: sheetName
          });
        }
      } catch (err) {
        _iterator.e(err);
      } finally {
        _iterator.f();
      }

      return objExcelNames;
    }
  }, {
    key: "getMergeTxt",
    value: function getMergeTxt() {
      var selector = this.selector,
          merges = this.merges,
          rows = this.rows;
      var cols = {};
      selector.range.each(function (ri, ci) {
        var range = merges.getFirstIncludes(ri, ci);
        cols[ci] = cols[ci] || [];

        if (range) {
          var _rows$getCell;

          var text = ((_rows$getCell = rows.getCell(range.sri, range.sci)) === null || _rows$getCell === void 0 ? void 0 : _rows$getCell.text) || '';
          if (!cols[ci].includes(text)) cols[ci].push(text);
        } else {
          var _rows$getCell2;

          var _text = ((_rows$getCell2 = rows.getCell(ri, ci)) === null || _rows$getCell2 === void 0 ? void 0 : _rows$getCell2.text) || '';

          if (!cols[ci].includes(_text)) cols[ci].push(_text);
        }
      });
      return cols;
    }
  }, {
    key: "getInversionMergeTxt",
    value: function getInversionMergeTxt() {
      var selector = this.selector,
          merges = this.merges,
          rows = this.rows;
      var result = {};
      selector.range.each(function (ri, ci) {
        var range = merges.getFirstIncludes(ri, ci);
        result[ri] = result[ri] || [];

        if (range) {
          var _rows$getCell3;

          var text = ((_rows$getCell3 = rows.getCell(range.sri, range.sci)) === null || _rows$getCell3 === void 0 ? void 0 : _rows$getCell3.text) || '';
          if (!result[ri].includes(text)) result[ri].push(text);
        } else {
          var _rows$getCell4;

          var _text2 = ((_rows$getCell4 = rows.getCell(ri, ci)) === null || _rows$getCell4 === void 0 ? void 0 : _rows$getCell4.text) || '';

          if (!result[ri].includes(_text2)) result[ri].push(_text2);
        }
      });
      return result;
    }
    /** 获取ID标识
     * @param {String}  //'A9*2=#{last_year_[*,*-2]}{1~3}{9}'
     * @returns {Array}   //['A9*2=#{last_year_A7}', 'B9*2=#{last_year_B7}', 'C9*2=#{last_year_C7}', 'D9*2=#{last_year_D7}']
     */

  }, {
    key: "getFormulaWildcard",
    value: function getFormulaWildcard(wildcard) {
      var _this$wildcard$getRow = this.wildcard.getRowNumColNum(wildcard),
          ruler = _this$wildcard$getRow.ruler,
          rowColNum = _this$wildcard$getRow.rowColNum; //


      var rulers = this.wildcard.getRulers(rowColNum, ruler);
      return this.wildcard.getIdRulers(rulers);
    }
  }]);

  return DataProxy;
}();


// CONCATENATED MODULE: ./src/sheet/component/event.js










var bindListeners = [];
function bind(target, name, fn) {
  target.addEventListener(name, fn);
  bindListeners.push({
    target: target,
    name: name,
    fn: fn
  });
}
function unbind(target, name, fn) {
  target.removeEventListener(name, fn);
}
function unbindClickoutside(el) {
  if (el.xclickoutside) {
    unbind(window.document.body, 'click', el.xclickoutside);
    delete el.xclickoutside;
  }
}
function unbindAll() {
  var _iterator = _createForOfIteratorHelper(bindListeners),
      _step;

  try {
    for (_iterator.s(); !(_step = _iterator.n()).done;) {
      var iterator = _step.value;
      var target = iterator.target,
          name = iterator.name,
          fn = iterator.fn;
      unbind(target, name, fn);
    }
  } catch (err) {
    _iterator.e(err);
  } finally {
    _iterator.f();
  }

  bindListeners = [];
} // the left mouse button: mousedown → mouseup → click
// the right mouse button: mousedown → contenxtmenu → mouseup
// the right mouse button in firefox(>65.0): mousedown → contenxtmenu → mouseup → click on window

function bindClickoutside(el, cb) {
  el.xclickoutside = function (evt) {
    // ignore double click
    // console.log('evt:', evt);
    if (evt.detail === 2 || el.contains(evt.target)) return;
    if (cb) cb(el);else {
      el.hide();
      unbindClickoutside(el);
    }
  };

  bind(window.document.body, 'click', el.xclickoutside);
}
function mouseMoveUp(target, movefunc, upfunc) {
  bind(target, 'mousemove', movefunc);
  var t = target;

  t.xEvtUp = function (evt) {
    // console.log('mouseup>>>');
    unbind(target, 'mousemove', movefunc);
    unbind(target, 'mouseup', target.xEvtUp);
    upfunc(evt);
  };

  bind(target, 'mouseup', target.xEvtUp);
}

function calTouchDirection(spanx, spany, evt, cb) {
  var direction = ''; // console.log('spanx:', spanx, ', spany:', spany);

  if (Math.abs(spanx) > Math.abs(spany)) {
    // horizontal
    direction = spanx > 0 ? 'right' : 'left';
    cb(direction, spanx, evt);
  } else {
    // vertical
    direction = spany > 0 ? 'down' : 'up';
    cb(direction, spany, evt);
  }
} // cb = (direction, distance) => {}


function bindTouch(target, _ref) {
  var move = _ref.move,
      end = _ref.end;
  var startx = 0;
  var starty = 0;
  bind(target, 'touchstart', function (evt) {
    var _evt$touches$ = evt.touches[0],
        pageX = _evt$touches$.pageX,
        pageY = _evt$touches$.pageY;
    startx = pageX;
    starty = pageY;
  });
  bind(target, 'touchmove', function (evt) {
    if (!move) return;
    var _evt$changedTouches$ = evt.changedTouches[0],
        pageX = _evt$changedTouches$.pageX,
        pageY = _evt$changedTouches$.pageY;
    var spanx = pageX - startx;
    var spany = pageY - starty;

    if (Math.abs(spanx) > 10 || Math.abs(spany) > 10) {
      // console.log('spanx:', spanx, ', spany:', spany);
      calTouchDirection(spanx, spany, evt, move);
      startx = pageX;
      starty = pageY;
    }

    evt.preventDefault();
  });
  bind(target, 'touchend', function (evt) {
    if (!end) return;
    var _evt$changedTouches$2 = evt.changedTouches[0],
        pageX = _evt$changedTouches$2.pageX,
        pageY = _evt$changedTouches$2.pageY;
    var spanx = pageX - startx;
    var spany = pageY - starty;
    calTouchDirection(spanx, spany, evt, end);
  });
} // eventemiter

function createEventEmitter() {
  var listeners = new Map();

  function on(eventName, callback) {
    var push = function push() {
      var currentListener = listeners.get(eventName);
      return Array.isArray(currentListener) && currentListener.push(callback) || false;
    };

    var create = function create() {
      return listeners.set(eventName, [].concat(callback));
    };

    return listeners.has(eventName) && push() || create();
  }

  function fire(eventName, args) {
    var exec = function exec() {
      var currentListener = listeners.get(eventName);

      var _iterator2 = _createForOfIteratorHelper(currentListener),
          _step2;

      try {
        for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {
          var callback = _step2.value;
          callback.call.apply(callback, [null].concat(_toConsumableArray(args)));
        }
      } catch (err) {
        _iterator2.e(err);
      } finally {
        _iterator2.f();
      }
    };

    return listeners.has(eventName) && exec();
  }

  function removeListener(eventName, callback) {
    var remove = function remove() {
      var currentListener = listeners.get(eventName);
      var idx = currentListener.indexOf(callback);
      return idx >= 0 && currentListener.splice(idx, 1) && listeners.get(eventName).length === 0 && listeners.delete(eventName);
    };

    return listeners.has(eventName) && remove();
  }

  function once(eventName, callback) {
    var execCalllback = function execCalllback() {
      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
        args[_key] = arguments[_key];
      }

      callback.call.apply(callback, [null].concat(args));
      removeListener(eventName, execCalllback);
    };

    return on(eventName, execCalllback);
  }

  function removeAllListeners() {
    listeners.clear();
  }

  return {
    get current() {
      return listeners;
    },

    on: on,
    once: once,
    fire: fire,
    removeListener: removeListener,
    removeAllListeners: removeAllListeners
  };
}
// CONCATENATED MODULE: ./src/sheet/config.js
var cssPrefix = 'x-spreadsheet';
var config_dpr = window.devicePixelRatio || 1;
/* harmony default export */ var sheet_config = ({
  cssPrefix: cssPrefix,
  dpr: config_dpr
});
// CONCATENATED MODULE: ./src/sheet/component/resizer.js







var resizer_Resizer = /*#__PURE__*/function () {
  function Resizer() {
    var _this = this;

    var vertical = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;
    var minDistance = arguments.length > 1 ? arguments[1] : undefined;
    var hiddenOperate = arguments.length > 2 ? arguments[2] : undefined;

    _classCallCheck(this, Resizer);

    this.moving = false;
    this.hiddenOperate = hiddenOperate;
    this.vertical = vertical;
    this.el = element_h('div', "".concat(cssPrefix, "-resizer ").concat(vertical ? 'vertical' : 'horizontal')).children(this.unhideHoverEl = element_h('div', "".concat(cssPrefix, "-resizer-hover")).on('dblclick.stop', function (evt) {
      return _this.mousedblclickHandler(evt);
    }).css('position', 'absolute').hide(), this.hoverEl = element_h('div', "".concat(cssPrefix, "-resizer-hover")).on('mousedown.stop', function (evt) {
      return _this.mousedownHandler(evt);
    }), this.lineEl = element_h('div', "".concat(cssPrefix, "-resizer-line")).hide()).hide(); // cell rect

    this.cRect = null;
    this.finishedFn = null;
    this.minDistance = minDistance;

    this.unhideFn = function () {};
  }

  _createClass(Resizer, [{
    key: "showUnhide",
    value: function showUnhide(index) {
      if (!this.hiddenOperate) return;
      this.unhideIndex = index;
      this.unhideHoverEl.show();
    }
  }, {
    key: "hideUnhide",
    value: function hideUnhide() {
      this.unhideHoverEl.hide();
    } // rect : {top, left, width, height}
    // line : {width, height}

  }, {
    key: "show",
    value: function show(rect, line) {
      var moving = this.moving,
          vertical = this.vertical,
          hoverEl = this.hoverEl,
          lineEl = this.lineEl,
          el = this.el,
          unhideHoverEl = this.unhideHoverEl;
      if (moving) return;
      this.cRect = rect;
      var left = rect.left,
          top = rect.top,
          width = rect.width,
          height = rect.height;
      el.offset({
        left: vertical ? left + width - 5 : left,
        top: vertical ? top : top + height - 5
      }).show();
      hoverEl.offset({
        width: vertical ? 5 : width,
        height: vertical ? height : 5
      });
      lineEl.offset({
        width: vertical ? 0 : line.width,
        height: vertical ? line.height : 0
      });
      unhideHoverEl.offset({
        left: vertical ? 5 - width : left,
        top: vertical ? top : 5 - height,
        width: vertical ? 5 : width,
        height: vertical ? height : 5
      });
    }
  }, {
    key: "hide",
    value: function hide() {
      this.el.offset({
        left: 0,
        top: 0
      }).hide();
      this.hideUnhide();
    }
  }, {
    key: "mousedblclickHandler",
    value: function mousedblclickHandler() {
      if (this.unhideIndex) this.unhideFn(this.unhideIndex);
    }
  }, {
    key: "mousedownHandler",
    value: function mousedownHandler(evt) {
      var _this2 = this;

      var startEvt = evt;
      var el = this.el,
          lineEl = this.lineEl,
          cRect = this.cRect,
          vertical = this.vertical,
          minDistance = this.minDistance;
      var distance = vertical ? cRect.width : cRect.height; // console.log('distance:', distance);

      lineEl.show();
      mouseMoveUp(window, function (e) {
        _this2.moving = true;

        if (startEvt !== null && e.buttons === 1) {
          // console.log('top:', top, ', left:', top, ', cRect:', cRect);
          if (vertical) {
            distance += e.movementX;

            if (distance > minDistance) {
              el.css('left', "".concat(cRect.left + distance - 5, "px"));
            }
          } else {
            distance += e.movementY;

            if (distance > minDistance) {
              el.css('top', "".concat(cRect.top + distance - 5, "px"));
            }
          }

          startEvt = e;
        }
      }, function () {
        startEvt = null;
        lineEl.hide();
        _this2.moving = false;

        _this2.hide();

        if (_this2.finishedFn) {
          if (distance < minDistance) distance = minDistance;

          _this2.finishedFn(cRect, distance);
        }
      });
    }
  }]);

  return Resizer;
}();


// CONCATENATED MODULE: ./src/sheet/component/scrollbar.js






var scrollbar_Scrollbar = /*#__PURE__*/function () {
  function Scrollbar(vertical) {
    var _this = this;

    _classCallCheck(this, Scrollbar);

    this.vertical = vertical;
    this.moveFn = null;
    this.el = element_h('div', "".concat(cssPrefix, "-scrollbar ").concat(vertical ? 'vertical' : 'horizontal')).child(this.contentEl = element_h('div', '')).on('mousemove.stop', function () {}).on('scroll.stop', function (evt) {
      var _evt$target = evt.target,
          scrollTop = _evt$target.scrollTop,
          scrollLeft = _evt$target.scrollLeft; // console.log('scrollTop:', scrollTop);

      if (_this.moveFn) {
        _this.moveFn(_this.vertical ? scrollTop : scrollLeft, evt);
      } // console.log('evt:::', evt);

    });
  }

  _createClass(Scrollbar, [{
    key: "move",
    value: function move(v) {
      this.el.scroll(v);
      return this;
    }
  }, {
    key: "scroll",
    value: function scroll() {
      return this.el.scroll();
    }
  }, {
    key: "set",
    value: function set(distance, contentDistance, scroll) {
      var isLock = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;
      var d = distance - 1; // console.log('distance:', distance, ', contentDistance:', contentDistance);

      if (contentDistance > d) {
        var cssKey = this.vertical ? 'height' : 'width'; // console.log('d:', d);

        this.el.css(cssKey, "".concat(d - 15, "px")).show();
        this.contentEl.css(this.vertical ? 'width' : 'height', '1px').css(cssKey, "".concat(contentDistance, "px"));

        if (!isLock) {
          this.move({
            left: (scroll === null || scroll === void 0 ? void 0 : scroll.x) - 15 || 0,
            top: (scroll === null || scroll === void 0 ? void 0 : scroll.y) - 15 || 0
          });
        }
      } else {
        this.el.hide();
      }

      return this;
    }
  }]);

  return Scrollbar;
}();


// CONCATENATED MODULE: ./src/sheet/component/selector.js







var selectorHeightBorderWidth = 2 * 2 - 1;
var startZIndex = 10;

var selector_SelectorElement = /*#__PURE__*/function () {
  function SelectorElement(cornerOperate) {
    var _this = this;

    _classCallCheck(this, SelectorElement);

    this.inputChange = function () {};

    this.showList = function () {};

    this.cornerEl = element_h('div', cornerOperate ? "".concat(cssPrefix, "-selector-corner") : '');
    this.areaEl = element_h('div', "".concat(cssPrefix, "-selector-area")).child(this.cornerEl).hide();
    this.clipboardEl = element_h('div', "".concat(cssPrefix, "-selector-clipboard")).hide();
    this.dropdown = element_h('span', "".concat(cssPrefix, "-selector-dropdown icon spread-sheet icon-select")).hide();
    this.message = element_h('div', "".concat(cssPrefix, "-selector-message")).hide();
    this.tips = element_h('div', "".concat(cssPrefix, "-selector-tips")).hide();
    this.autofillEl = element_h('div', "".concat(cssPrefix, "-selector-autofill")).hide();
    this.el = element_h('div', "".concat(cssPrefix, "-selector")).css('z-index', "".concat(startZIndex)).children(this.areaEl, this.clipboardEl, this.autofillEl, this.dropdown, this.message, this.tips).hide();
    this.dropdown.on('click.stop', function () {
      _this.showList();
    });
    startZIndex += 1;
  }

  _createClass(SelectorElement, [{
    key: "setOffset",
    value: function setOffset(v) {
      this.el.offset(v).show();

      if ((v === null || v === void 0 ? void 0 : v.top) != undefined) {
        this.el.css('height', "calc(100% - ".concat(v === null || v === void 0 ? void 0 : v.top, "px)"));
      }

      return this;
    }
  }, {
    key: "hide",
    value: function hide() {
      this.el.hide();
      return this;
    }
  }, {
    key: "setAreaOffset",
    value: function setAreaOffset(v, validator) {
      var left = v.left,
          top = v.top,
          width = v.width,
          height = v.height;

      var _ref = validator || {},
          type = _ref.type,
          message = _ref.message,
          tips = _ref.tips;

      var of = {
        width: width - selectorHeightBorderWidth + 0.8,
        height: height - selectorHeightBorderWidth + 0.8,
        left: left - 0.8,
        top: top - 0.8
      };
      this.areaEl.offset(of).show();

      if (type === 'list') {
        this.dropdown.offset(_objectSpread2(_objectSpread2({}, of), {}, {
          left: of.left + of.width - 15,
          width: 16,
          height: 16
        })).show();
      } else {
        this.dropdown.hide();
      }

      this.message.html('').hide();
      this.showValidation(message, 'message', v);
      this.tips.html('').hide();
      this.showValidation(tips, 'tips', v);
    }
  }, {
    key: "showValidation",
    value: function showValidation(val, type, v) {
      // let icon = {
      //   message: 'error',
      //   tips: 'info'
      // };
      var left = v.left,
          top = v.top,
          height = v.height;

      if (val) {
        this[type].offset({
          left: left,
          width: 'inherit',
          top: top + height + 6
        }).child(element_h('span', "icon spread-sheet icon-info")).child(element_h('span').html(val)).showInline();
      }
    }
  }, {
    key: "setClipboardOffset",
    value: function setClipboardOffset(v) {
      var left = v.left,
          top = v.top,
          width = v.width,
          height = v.height;
      this.clipboardEl.offset({
        left: left,
        top: top,
        width: width - 5,
        height: height - 5
      });
    }
  }, {
    key: "showAutofill",
    value: function showAutofill(v) {
      var left = v.left,
          top = v.top,
          width = v.width,
          height = v.height;
      this.autofillEl.offset({
        width: width - selectorHeightBorderWidth,
        height: height - selectorHeightBorderWidth,
        left: left,
        top: top
      }).show();
    }
  }, {
    key: "hideAutofill",
    value: function hideAutofill() {
      this.autofillEl.hide();
    }
  }, {
    key: "showClipboard",
    value: function showClipboard() {
      this.clipboardEl.show();
    }
  }, {
    key: "hideClipboard",
    value: function hideClipboard() {
      this.clipboardEl.hide();
    }
  }]);

  return SelectorElement;
}();

function calBRAreaOffset(offset) {
  var data = this.data;
  var left = offset.left,
      top = offset.top,
      width = offset.width,
      height = offset.height,
      scroll = offset.scroll,
      l = offset.l,
      t = offset.t;
  var ftwidth = data.freezeTotalWidth();
  var ftheight = data.freezeTotalHeight();
  var left0 = left - ftwidth;
  if (ftwidth > l) left0 -= scroll.x;
  var top0 = top - ftheight;
  if (ftheight > t) top0 -= scroll.y;
  return {
    left: left0,
    top: top0,
    width: width,
    height: height
  };
}

function calTAreaOffset(offset) {
  var data = this.data;
  var left = offset.left,
      width = offset.width,
      height = offset.height,
      l = offset.l,
      t = offset.t,
      scroll = offset.scroll;
  var ftwidth = data.freezeTotalWidth();
  var left0 = left - ftwidth;
  if (ftwidth > l) left0 -= scroll.x;
  return {
    left: left0,
    top: t,
    width: width,
    height: height
  };
}

function calLAreaOffset(offset) {
  var data = this.data;
  var top = offset.top,
      width = offset.width,
      height = offset.height,
      l = offset.l,
      t = offset.t,
      scroll = offset.scroll;
  var ftheight = data.freezeTotalHeight();
  var top0 = top - ftheight; // console.log('ftheight:', ftheight, ', t:', t);

  if (ftheight > t) top0 -= scroll.y;
  return {
    left: l,
    top: top0,
    width: width,
    height: height
  };
}

function setBRAreaOffset(offset) {
  var br = this.br,
      data = this.data;
  var validator = data.getSelectedValidatorInfo();
  br.setAreaOffset(calBRAreaOffset.call(this, offset), validator);
}

function setTLAreaOffset(offset) {
  var tl = this.tl,
      data = this.data;
  var validator = data.getSelectedValidatorInfo();
  tl.setAreaOffset(offset, validator);
}

function setTAreaOffset(offset) {
  var t = this.t,
      data = this.data;
  var validator = data.getSelectedValidatorInfo();
  t.setAreaOffset(calTAreaOffset.call(this, offset), validator);
}

function setLAreaOffset(offset) {
  var l = this.l,
      data = this.data;
  var validator = data.getSelectedValidatorInfo();
  l.setAreaOffset(calLAreaOffset.call(this, offset), validator);
}

function setLClipboardOffset(offset) {
  var l = this.l;
  l.setClipboardOffset(calLAreaOffset.call(this, offset));
}

function setBRClipboardOffset(offset) {
  var br = this.br;
  br.setClipboardOffset(calBRAreaOffset.call(this, offset));
}

function setTLClipboardOffset(offset) {
  var tl = this.tl;
  tl.setClipboardOffset(offset);
}

function setTClipboardOffset(offset) {
  var t = this.t;
  t.setClipboardOffset(calTAreaOffset.call(this, offset));
}

function setAllAreaOffset(offset) {
  setBRAreaOffset.call(this, offset);
  setTLAreaOffset.call(this, offset);
  setTAreaOffset.call(this, offset);
  setLAreaOffset.call(this, offset);
}

function setAllClipboardOffset(offset) {
  setBRClipboardOffset.call(this, offset);
  setTLClipboardOffset.call(this, offset);
  setTClipboardOffset.call(this, offset);
  setLClipboardOffset.call(this, offset);
}

var component_selector_Selector = /*#__PURE__*/function () {
  function Selector(data) {
    var _this2 = this;

    _classCallCheck(this, Selector);

    startZIndex = 10;

    this.inputChange = function () {};

    this.showList = function () {};

    this.data = data;
    var cornerOperate = data.settings.cornerOperate;
    this.br = new selector_SelectorElement(cornerOperate);
    this.t = new selector_SelectorElement(cornerOperate);
    this.l = new selector_SelectorElement(cornerOperate);
    this.tl = new selector_SelectorElement(cornerOperate);

    this.br.inputChange = function (v) {
      _this2.inputChange(v);
    };

    this.br.showList = function (v) {
      _this2.showList(v);
    };

    this.br.el.show();
    this.offset = null;
    this.areaOffset = null;
    this.indexes = null;
    this.range = null;
    this.arange = null;
    this.el = element_h('div', "".concat(cssPrefix, "-selectors")).children(this.tl.el, this.t.el, this.l.el, this.br.el).hide(); // for performance

    this.lastri = -1;
    this.lastci = -1;
    startZIndex += 1;
    this.isAutofill = false;
  }

  _createClass(Selector, [{
    key: "resetData",
    value: function resetData(data) {
      this.data = data;
      this.range = data.selector.range;
      this.resetAreaOffset();
    }
  }, {
    key: "hide",
    value: function hide() {
      this.el.hide();
    }
  }, {
    key: "resetOffset",
    value: function resetOffset() {
      var data = this.data,
          tl = this.tl,
          t = this.t,
          l = this.l,
          br = this.br;
      var freezeHeight = data.freezeTotalHeight();
      var freezeWidth = data.freezeTotalWidth();

      if (freezeHeight > 0 || freezeWidth > 0) {
        tl.setOffset({
          width: freezeWidth,
          height: freezeHeight
        });
        t.setOffset({
          left: freezeWidth,
          height: freezeHeight
        });
        l.setOffset({
          top: freezeHeight,
          width: freezeWidth
        });
        br.setOffset({
          left: freezeWidth,
          top: freezeHeight
        });
      } else {
        tl.hide();
        t.hide();
        l.hide();
        br.setOffset({
          left: 0,
          top: 0
        });
      }
    }
  }, {
    key: "resetAreaOffset",
    value: function resetAreaOffset() {
      // console.log('offset:', offset);
      var offset = this.data.getSelectedRect();
      var coffset = this.data.getClipboardRect();
      setAllAreaOffset.call(this, offset);
      setAllClipboardOffset.call(this, coffset);
      this.resetOffset();
    }
  }, {
    key: "resetBRTAreaOffset",
    value: function resetBRTAreaOffset() {
      var offset = this.data.getSelectedRect();
      var coffset = this.data.getClipboardRect();
      setBRAreaOffset.call(this, offset);
      setTAreaOffset.call(this, offset);
      setBRClipboardOffset.call(this, coffset);
      setTClipboardOffset.call(this, coffset);
      this.resetOffset();
    }
  }, {
    key: "resetBRLAreaOffset",
    value: function resetBRLAreaOffset() {
      var offset = this.data.getSelectedRect();
      var coffset = this.data.getClipboardRect();
      setBRAreaOffset.call(this, offset);
      setLAreaOffset.call(this, offset);
      setBRClipboardOffset.call(this, coffset);
      setLClipboardOffset.call(this, coffset);
      this.resetOffset();
    }
  }, {
    key: "set",
    value: function set(ri, ci) {
      var indexesUpdated = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;
      var data = this.data;
      var cellRange = data.calSelectedRangeByStart(ri, ci);
      var sri = cellRange.sri,
          sci = cellRange.sci;

      if (indexesUpdated) {
        var cri = ri,
            cci = ci;
        if (ri < 0) cri = 0;
        if (ci < 0) cci = 0;
        data.selector.setIndexes(cri, cci);
        this.indexes = [cri, cci];
      }

      this.moveIndexes = [sri, sci]; // this.sIndexes = sIndexes;
      // this.eIndexes = eIndexes;

      this.range = cellRange;
      this.resetAreaOffset();
      this.el.show();
    }
  }, {
    key: "setEnd",
    value: function setEnd(ri, ci) {
      var moving = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;
      var data = this.data,
          lastri = this.lastri,
          lastci = this.lastci;

      if (moving) {
        if (ri === lastri && ci === lastci) return;
        this.lastri = ri;
        this.lastci = ci;
      }

      this.range = data.calSelectedRangeByEnd(ri, ci);
      setAllAreaOffset.call(this, this.data.getSelectedRect());
    }
  }, {
    key: "reset",
    value: function reset() {
      // console.log('::::', this.data);
      var _this$data$selector$r = this.data.selector.range,
          eri = _this$data$selector$r.eri,
          eci = _this$data$selector$r.eci;
      this.setEnd(eri, eci);
    }
  }, {
    key: "showAutofill",
    value: function showAutofill(ri, ci) {
      if (ri === -1 && ci === -1) return; // console.log('ri:', ri, ', ci:', ci);
      // const [sri, sci] = this.sIndexes;
      // const [eri, eci] = this.eIndexes;

      var _this$range = this.range,
          sri = _this$range.sri,
          sci = _this$range.sci,
          eri = _this$range.eri,
          eci = _this$range.eci;
      var nri = ri,
          nci = ci; // const rn = eri - sri;
      // const cn = eci - sci;

      var srn = sri - ri;
      var scn = sci - ci;
      var ern = eri - ri;
      var ecn = eci - ci;

      if (scn > 0) {
        // left
        // console.log('left');
        this.arange = new cell_range_CellRange(sri, nci, eri, sci - 1); // this.saIndexes = [sri, nci];
        // this.eaIndexes = [eri, sci - 1];
        // data.calRangeIndexes2(
      } else if (srn > 0) {
        // top
        // console.log('top');
        // nri = sri;
        this.arange = new cell_range_CellRange(nri, sci, sri - 1, eci); // this.saIndexes = [nri, sci];
        // this.eaIndexes = [sri - 1, eci];
      } else if (ecn < 0) {
        // right
        // console.log('right');
        // nci = eci;
        this.arange = new cell_range_CellRange(sri, eci + 1, eri, nci); // this.saIndexes = [sri, eci + 1];
        // this.eaIndexes = [eri, nci];
      } else if (ern < 0) {
        // bottom
        // console.log('bottom');
        // nri = eri;
        this.arange = new cell_range_CellRange(eri + 1, sci, nri, eci); // this.saIndexes = [eri + 1, sci];
        // this.eaIndexes = [nri, eci];
      } else {
        // console.log('else:');
        this.arange = null; // this.saIndexes = null;
        // this.eaIndexes = null;

        return;
      }

      if (this.arange !== null) {
        this.isAutofill = true; // console.log(this.saIndexes, ':', this.eaIndexes);

        var offset = this.data.getRect(this.arange);
        offset.width += 2;
        offset.height += 2;
        var br = this.br,
            l = this.l,
            t = this.t,
            tl = this.tl;
        br.showAutofill(calBRAreaOffset.call(this, offset));
        l.showAutofill(calLAreaOffset.call(this, offset));
        t.showAutofill(calTAreaOffset.call(this, offset));
        tl.showAutofill(offset);
      }
    }
  }, {
    key: "hideAutofill",
    value: function hideAutofill() {
      var _this3 = this;

      this.isAutofill = false;
      ['br', 'l', 't', 'tl'].forEach(function (property) {
        _this3[property].hideAutofill();
      });
    }
  }, {
    key: "showClipboard",
    value: function showClipboard() {
      var _this4 = this;

      var coffset = this.data.getClipboardRect();
      setAllClipboardOffset.call(this, coffset);
      ['br', 'l', 't', 'tl'].forEach(function (property) {
        _this4[property].showClipboard();
      });
    }
  }, {
    key: "hideClipboard",
    value: function hideClipboard() {
      var _this5 = this;

      ['br', 'l', 't', 'tl'].forEach(function (property) {
        _this5[property].hideClipboard();
      });
    }
  }]);

  return Selector;
}();


// EXTERNAL MODULE: ./node_modules/core-js/modules/es.string.search.js
var es_string_search = __webpack_require__("841c");

// CONCATENATED MODULE: ./src/sheet/component/suggest.js













function inputMovePrev(evt) {
  evt.preventDefault();
  evt.stopPropagation();
  var filterItems = this.filterItems;
  if (filterItems.length <= 0) return;
  if (this.itemIndex >= 0) filterItems[this.itemIndex].toggle();
  this.itemIndex -= 1;

  if (this.itemIndex < 0) {
    this.itemIndex = filterItems.length - 1;
  }

  filterItems[this.itemIndex].toggle();
}

function inputMoveNext(evt) {
  evt.stopPropagation();
  var filterItems = this.filterItems;
  if (filterItems.length <= 0) return;
  if (this.itemIndex >= 0) filterItems[this.itemIndex].toggle();
  this.itemIndex += 1;

  if (this.itemIndex > filterItems.length - 1) {
    this.itemIndex = 0;
  }

  filterItems[this.itemIndex].toggle();
}

function inputEnter(evt) {
  evt.preventDefault();
  var filterItems = this.filterItems;
  if (filterItems.length <= 0) return;
  evt.stopPropagation();
  if (this.itemIndex < 0) this.itemIndex = 0;
  filterItems[this.itemIndex].el.click();
  this.hide();
}

function inputKeydownHandler(evt) {
  var keyCode = evt.keyCode;

  if (evt.ctrlKey) {
    evt.stopPropagation();
  }

  switch (keyCode) {
    case 37:
      // left
      evt.stopPropagation();
      break;

    case 38:
      // up
      inputMovePrev.call(this, evt);
      break;

    case 39:
      // right
      evt.stopPropagation();
      break;

    case 40:
      // down
      inputMoveNext.call(this, evt);
      break;

    case 13:
      // enter
      inputEnter.call(this, evt);
      break;

    case 9:
      inputEnter.call(this, evt);
      break;

    default:
      evt.stopPropagation();
      break;
  }
}

var suggest_Suggest = /*#__PURE__*/function () {
  function Suggest(items, itemClick) {
    var width = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : '200px';

    _classCallCheck(this, Suggest);

    this.filterItems = [];
    this.items = items;
    this.el = element_h('div', "".concat(cssPrefix, "-suggest")).css('width', width).hide();
    this.itemClick = itemClick;
    this.itemIndex = -1;
  }

  _createClass(Suggest, [{
    key: "setOffset",
    value: function setOffset(v) {
      this.el.cssRemoveKeys('top', 'bottom').offset(v);
    }
  }, {
    key: "hide",
    value: function hide() {
      var el = this.el;
      this.filterItems = [];
      this.itemIndex = -1;
      el.hide();
      unbindClickoutside(this.el.parent());
    }
  }, {
    key: "setItems",
    value: function setItems(items) {
      this.items = items; // this.search('');
    }
  }, {
    key: "search",
    value: function search(word) {
      var _this = this,
          _el$html;

      var items = this.items;

      if (!/^\s*$/.test(word)) {
        items = items.filter(function (it) {
          return (it.key || it).startsWith(word.toUpperCase());
        });
      }

      items = items.map(function (it) {
        var title = it.title;

        if (title) {
          if (typeof title === 'function') {
            title = title();
          }
        } else {
          title = it;
        }

        var item = element_h('div', "".concat(cssPrefix, "-item")).child(title).on('click.stop', function () {
          _this.itemClick(it);

          _this.hide();
        });

        if (it.label) {
          item.child(element_h('div', 'label').html(it.label));
        }

        return item;
      });
      this.filterItems = items;

      if (items.length <= 0) {
        return;
      }

      var el = this.el; // items[0].toggle();

      (_el$html = el.html('')).children.apply(_el$html, _toConsumableArray(items)).show();

      bindClickoutside(el.parent(), function () {
        _this.hide();
      });
    }
  }, {
    key: "bindInputEvents",
    value: function bindInputEvents(input) {
      var _this2 = this;

      input.on('keydown', function (evt) {
        return inputKeydownHandler.call(_this2, evt);
      });
    }
  }]);

  return Suggest;
}();


// EXTERNAL MODULE: ./node_modules/core-js/modules/es.object.set-prototype-of.js
var es_object_set_prototype_of = __webpack_require__("131a");

// CONCATENATED MODULE: ./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js

function _setPrototypeOf(o, p) {
  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {
    o.__proto__ = p;
    return o;
  };

  return _setPrototypeOf(o, p);
}
// CONCATENATED MODULE: ./node_modules/@babel/runtime/helpers/esm/inherits.js

function _inherits(subClass, superClass) {
  if (typeof superClass !== "function" && superClass !== null) {
    throw new TypeError("Super expression must either be null or a function");
  }

  subClass.prototype = Object.create(superClass && superClass.prototype, {
    constructor: {
      value: subClass,
      writable: true,
      configurable: true
    }
  });
  if (superClass) _setPrototypeOf(subClass, superClass);
}
// EXTERNAL MODULE: ./node_modules/core-js/modules/es.reflect.construct.js
var es_reflect_construct = __webpack_require__("4ae1");

// EXTERNAL MODULE: ./node_modules/core-js/modules/es.reflect.to-string-tag.js
var es_reflect_to_string_tag = __webpack_require__("f8c9");

// CONCATENATED MODULE: ./node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js


function _getPrototypeOf(o) {
  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {
    return o.__proto__ || Object.getPrototypeOf(o);
  };
  return _getPrototypeOf(o);
}
// CONCATENATED MODULE: ./node_modules/@babel/runtime/helpers/esm/isNativeReflectConstruct.js



function _isNativeReflectConstruct() {
  if (typeof Reflect === "undefined" || !Reflect.construct) return false;
  if (Reflect.construct.sham) return false;
  if (typeof Proxy === "function") return true;

  try {
    Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));
    return true;
  } catch (e) {
    return false;
  }
}
// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/typeof.js
var helpers_typeof = __webpack_require__("7037");
var typeof_default = /*#__PURE__*/__webpack_require__.n(helpers_typeof);

// CONCATENATED MODULE: ./node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js
function _assertThisInitialized(self) {
  if (self === void 0) {
    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
  }

  return self;
}
// CONCATENATED MODULE: ./node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js


function _possibleConstructorReturn(self, call) {
  if (call && (typeof_default()(call) === "object" || typeof call === "function")) {
    return call;
  } else if (call !== void 0) {
    throw new TypeError("Derived constructors may only return object or undefined");
  }

  return _assertThisInitialized(self);
}
// CONCATENATED MODULE: ./node_modules/@babel/runtime/helpers/esm/createSuper.js






function _createSuper(Derived) {
  var hasNativeReflectConstruct = _isNativeReflectConstruct();
  return function _createSuperInternal() {
    var Super = _getPrototypeOf(Derived),
        result;

    if (hasNativeReflectConstruct) {
      var NewTarget = _getPrototypeOf(this).constructor;
      result = Reflect.construct(Super, arguments, NewTarget);
    } else {
      result = Super.apply(this, arguments);
    }

    return _possibleConstructorReturn(this, result);
  };
}
// CONCATENATED MODULE: ./src/sheet/component/icon.js








var icon_Icon = /*#__PURE__*/function (_Element) {
  _inherits(Icon, _Element);

  var _super = _createSuper(Icon);

  function Icon(name) {
    var _this;

    _classCallCheck(this, Icon);

    _this = _super.call(this, 'div', "".concat(cssPrefix, "-icon"));
    _this.iconNameEl = element_h('div', "".concat(cssPrefix, "-icon-img ").concat(name));

    _this.child(_this.iconNameEl);

    return _this;
  }

  _createClass(Icon, [{
    key: "setName",
    value: function setName(name) {
      this.iconNameEl.className("".concat(cssPrefix, "-icon-img ").concat(name));
    }
  }]);

  return Icon;
}(element_Element);


// CONCATENATED MODULE: ./src/sheet/component/calendar.js











function addMonth(date, step) {
  date.setMonth(date.getMonth() + step);
}

function weekday(date, index) {
  var d = new Date(date);
  d.setDate(index - date.getDay() + 1);
  return d;
}

function monthDays(year, month, cdate) {
  // the first day of month
  var startDate = new Date(year, month, 1, 23, 59, 59);
  var datess = [[], [], [], [], [], []];

  for (var i = 0; i < 6; i += 1) {
    for (var j = 0; j < 7; j += 1) {
      var index = i * 7 + j;
      var d = weekday(startDate, index);
      var disabled = d.getMonth() !== month; // console.log('d:', d, ', cdate:', cdate);

      var active = d.getMonth() === cdate.getMonth() && d.getDate() === cdate.getDate();
      datess[i][j] = {
        d: d,
        disabled: disabled,
        active: active
      };
    }
  }

  return datess;
}

var calendar_Calendar = /*#__PURE__*/function () {
  function Calendar(value) {
    var _this = this,
        _h;

    _classCallCheck(this, Calendar);

    this.value = value;
    this.cvalue = new Date(value);
    this.headerLeftEl = element_h('div', 'calendar-header-left');
    this.bodyEl = element_h('tbody', '');
    this.buildAll();
    this.el = element_h('div', 'x-spreadsheet-calendar').children(element_h('div', 'calendar-header').children(this.headerLeftEl, element_h('div', 'calendar-header-right').children(element_h('a', 'calendar-prev').on('click.stop', function () {
      return _this.prev();
    }).child(new icon_Icon('chevron-left')), element_h('a', 'calendar-next').on('click.stop', function () {
      return _this.next();
    }).child(new icon_Icon('chevron-right')))), element_h('table', 'calendar-body').children(element_h('thead', '').child((_h = element_h('tr', '')).children.apply(_h, _toConsumableArray(locale_t('calendar.weeks').map(function (week) {
      return element_h('th', 'cell').child(week);
    })))), this.bodyEl));

    this.selectChange = function () {};
  }

  _createClass(Calendar, [{
    key: "setValue",
    value: function setValue(value) {
      this.value = value;
      this.cvalue = new Date(value);
      this.buildAll();
    }
  }, {
    key: "prev",
    value: function prev() {
      var value = this.value;
      addMonth(value, -1);
      this.buildAll();
    }
  }, {
    key: "next",
    value: function next() {
      var value = this.value;
      addMonth(value, 1);
      this.buildAll();
    }
  }, {
    key: "buildAll",
    value: function buildAll() {
      this.buildHeaderLeft();
      this.buildBody();
    }
  }, {
    key: "buildHeaderLeft",
    value: function buildHeaderLeft() {
      var value = this.value;
      this.headerLeftEl.html("".concat(locale_t('calendar.months')[value.getMonth()], " ").concat(value.getFullYear()));
    }
  }, {
    key: "buildBody",
    value: function buildBody() {
      var _this2 = this,
          _bodyEl$html;

      var value = this.value,
          cvalue = this.cvalue,
          bodyEl = this.bodyEl;
      var mDays = monthDays(value.getFullYear(), value.getMonth(), cvalue);
      var trs = mDays.map(function (it) {
        var _h2;

        var tds = it.map(function (it1) {
          var cls = 'cell';
          if (it1.disabled) cls += ' disabled';
          if (it1.active) cls += ' active';
          return element_h('td', '').child(element_h('div', cls).on('click.stop', function () {
            _this2.selectChange(it1.d);
          }).child(it1.d.getDate().toString()));
        });
        return (_h2 = element_h('tr', '')).children.apply(_h2, _toConsumableArray(tds));
      });

      (_bodyEl$html = bodyEl.html('')).children.apply(_bodyEl$html, _toConsumableArray(trs));
    }
  }]);

  return Calendar;
}();


// CONCATENATED MODULE: ./src/sheet/component/datepicker.js













var datepicker_Datepicker = /*#__PURE__*/function () {
  function Datepicker() {
    _classCallCheck(this, Datepicker);

    this.calendar = new calendar_Calendar(new Date());
    this.el = element_h('div', "".concat(cssPrefix, "-datepicker")).child(this.calendar.el).hide();
  }

  _createClass(Datepicker, [{
    key: "setValue",
    value: function setValue(date) {
      // console.log(':::::::', date, typeof date, date instanceof string);
      var calendar = this.calendar;

      if (typeof date === 'string') {
        // console.log(/^\d{4}-\d{1,2}-\d{1,2}$/.test(date));
        if (/^\d{4}-\d{1,2}-\d{1,2}$/.test(date)) {
          calendar.setValue(new Date(date.replace(new RegExp('-', 'g'), '/')));
        }
      } else if (date instanceof Date) {
        calendar.setValue(date);
      }

      return this;
    }
  }, {
    key: "change",
    value: function change(cb) {
      var _this = this;

      this.calendar.selectChange = function (d) {
        cb(d);

        _this.hide();
      };
    }
  }, {
    key: "show",
    value: function show() {
      this.el.show();
    }
  }, {
    key: "hide",
    value: function hide() {
      this.el.hide();
    }
  }]);

  return Datepicker;
}();


// CONCATENATED MODULE: ./src/sheet/component/editor.js
















 // import { mouseMoveUp } from '../event';

function setDefulatTextArea() {
  var textEl = this.textEl,
      areaOffset = this.areaOffset;
  textEl.offset({
    width: areaOffset.width - 9 + 0.8,
    height: areaOffset.height - 3 + 0.8
  });
}

function resetTextareaSize() {
  var textlineEl = this.textlineEl,
      textEl = this.textEl,
      areaOffset = this.areaOffset,
      inputText = this.inputText;

  if (areaOffset) {
    if (!/^\s*$/.test(inputText)) {
      var txts = inputText.split('\n');
      var maxTxtSize = Math.max.apply(Math, _toConsumableArray(txts.map(function (it) {
        return it.length;
      })));
      var tlOffset = textlineEl.offset();
      var fontWidth = tlOffset.width / inputText.length;
      var tlineWidth = (maxTxtSize + 1) * fontWidth + 5;
      var maxWidth = this.viewFn().width - areaOffset.left - fontWidth;
      var h1 = txts.length;

      if (tlineWidth > areaOffset.width) {
        var twidth = tlineWidth;

        if (tlineWidth > maxWidth) {
          twidth = maxWidth;
          h1 += parseInt(tlineWidth / maxWidth, 10);
          h1 += tlineWidth % maxWidth > 0 ? 1 : 0;
        }

        textEl.css('width', "".concat(twidth, "px"));
      } else {
        setDefulatTextArea.call(this);
      }

      h1 *= this.rowHeight;

      if (h1 > areaOffset.height) {
        textEl.css('height', "".concat(h1, "px"));
      }
    } else {
      setDefulatTextArea.call(this);
    }
  }
}

function insertText(_ref, itxt) {
  var target = _ref.target;
  var value = target.value,
      selectionEnd = target.selectionEnd;
  var ntxt = "".concat(value.slice(0, selectionEnd)).concat(itxt).concat(value.slice(selectionEnd));
  target.value = ntxt;
  target.setSelectionRange(selectionEnd + 1, selectionEnd + 1);
  this.inputText = ntxt;
  this.textlineEl.html(ntxt);
  resetTextareaSize.call(this);
}

function keydownEventHandler(evt) {
  var keyCode = evt.keyCode,
      altKey = evt.altKey;
  if (keyCode !== 13 && keyCode !== 9) evt.stopPropagation();

  if (keyCode === 13 && altKey) {
    insertText.call(this, evt, '\n');
    evt.stopPropagation();
  }

  if (keyCode === 13 && !altKey) evt.preventDefault();
}

function inputEventHandler(evt) {
  var suggest = this.suggest,
      textlineEl = this.textlineEl,
      validator = this.validator,
      cell = this.cell;
  var v = evt.target.value; // console.log(evt, 'v:', v);

  if (cell !== null) {
    if ('editable' in cell && cell.editable === true || cell.editable === undefined) {
      this.inputText = v;

      if (validator) {
        if (validator.type === 'list') {
          suggest.search(v);
        } else {
          suggest.hide();
        }
      } else {
        var start = v.lastIndexOf('=');

        if (start !== -1) {
          suggest.search(v.substring(start + 1));
        } else {
          suggest.hide();
        }
      }

      textlineEl.html(v);
      resetTextareaSize.call(this);
      this.change('input', v);
    } else {
      evt.target.value = cell.text || '';
    }
  } else {
    this.inputText = v;

    if (validator) {
      if (validator.type === 'list') {
        suggest.search(v);
      } else {
        suggest.hide();
      }
    } else {
      var _start = v.lastIndexOf('=');

      if (_start !== -1) {
        suggest.search(v.substring(_start + 1));
      } else {
        suggest.hide();
      }
    }

    textlineEl.html(v);
    resetTextareaSize.call(this);
    this.change('input', v);
  }
}

function setTextareaRange(position) {
  var el = this.textEl.el;
  setTimeout(function () {
    el.focus();
    el.setSelectionRange(position, position);
  }, 0);
}

function _setText(text, position) {
  var textEl = this.textEl,
      textlineEl = this.textlineEl; // firefox bug

  textEl.el.blur();
  textEl.val(text);
  textlineEl.html(text);
  setTextareaRange.call(this, position);
}

function suggestItemClick(it) {
  var inputText = this.inputText,
      validator = this.validator;
  var position = 0;

  if (validator && validator.type === 'list') {
    this.inputText = it;
    position = this.inputText.length;
  } else {
    var start = inputText.lastIndexOf('=');
    var sit = inputText.substring(0, start + 1);
    var eit = inputText.substring(start + 1);

    if (eit.indexOf(')') !== -1) {
      eit = eit.substring(eit.indexOf(')'));
    } else {
      eit = '';
    }

    this.inputText = "".concat(sit + it.key, "("); // console.log('inputText:', this.inputText);

    position = this.inputText.length;
    this.inputText += ")".concat(eit);
  }

  _setText.call(this, this.inputText, position);
}

function resetSuggestItems() {
  this.suggest.setItems(this.formulas);
}

function dateFormat(d) {
  var month = d.getMonth() + 1;
  var date = d.getDate();
  if (month < 10) month = "0".concat(month);
  if (date < 10) date = "0".concat(date);
  return "".concat(d.getFullYear(), "-").concat(month, "-").concat(date);
}

var editor_Editor = /*#__PURE__*/function () {
  function Editor(formulas, viewFn, data) {
    var _this = this;

    _classCallCheck(this, Editor);

    this.viewFn = viewFn;
    this.rowHeight = data.rows.indexHeight;
    this.filterCellText = data.filterCellText;
    this.formulas = formulas;
    this.suggest = new suggest_Suggest(formulas, function (it) {
      suggestItemClick.call(_this, it);
    });
    this.datepicker = new datepicker_Datepicker();
    this.datepicker.change(function (d) {
      // console.log('d:', d);
      _this.setText(dateFormat(d));

      _this.clear();
    });
    this.areaEl = element_h('div', "".concat(cssPrefix, "-editor-area")).children(this.textEl = element_h('textarea', '').on('input', function (evt) {
      setTimeout(function () {
        evt.target.value = _this.filterCellText(evt.target.value, evt);
        inputEventHandler.call(_this, evt);
      });
    }).on('paste.stop', function () {}).on('keydown', function (evt) {
      return keydownEventHandler.call(_this, evt);
    }), this.textlineEl = element_h('div', 'textline'), this.suggest.el, this.datepicker.el).on('mousemove.stop', function () {}).on('mousedown.stop', function () {});
    this.el = element_h('div', "".concat(cssPrefix, "-editor")).child(this.areaEl).hide();
    this.suggest.bindInputEvents(this.textEl);
    this.areaOffset = null;
    this.freeze = {
      w: 0,
      h: 0
    };
    this.cell = null;
    this.inputText = '';

    this.change = function () {};
  }

  _createClass(Editor, [{
    key: "setFreezeLengths",
    value: function setFreezeLengths(width, height) {
      this.freeze.w = width;
      this.freeze.h = height;
    }
  }, {
    key: "clear",
    value: function clear() {
      // const { cell } = this;
      // const cellText = (cell && cell.text) || '';
      if (this.inputText !== '') {
        this.change('finished', this.inputText);
      }

      this.cell = null;
      this.areaOffset = null;
      this.inputText = '';
      this.el.hide();
      this.textEl.val('');
      this.textlineEl.html('');
      resetSuggestItems.call(this);
      this.datepicker.hide();
    }
  }, {
    key: "setOffset",
    value: function setOffset(offset) {
      var suggestPosition = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'top';
      var areaEl = this.areaEl,
          suggest = this.suggest,
          freeze = this.freeze,
          el = this.el;

      if (offset) {
        this.areaOffset = offset;
        var left = offset.left,
            top = offset.top,
            height = offset.height,
            l = offset.l,
            t = offset.t; // console.log('left:', left, ',top:', top, ', freeze:', freeze);

        var elOffset = {
          left: 0,
          top: 0
        }; // top left

        if (freeze.w > l && freeze.h > t) {//
        } else if (freeze.w < l && freeze.h < t) {
          elOffset.left = freeze.w;
          elOffset.top = freeze.h;
        } else if (freeze.w > l) {
          elOffset.top = freeze.h;
        } else if (freeze.h > t) {
          elOffset.left = freeze.w;
        }

        el.offset(elOffset);
        areaEl.offset({
          left: left - elOffset.left - 0.8,
          top: top - elOffset.top - 0.8
        });
        setDefulatTextArea.call(this);
        var sOffset = {
          left: 0
        };
        sOffset[suggestPosition] = height;
        suggest.setOffset(sOffset);
        suggest.hide();
      }
    }
  }, {
    key: "setCell",
    value: function setCell(cell, validator) {
      var el = this.el,
          datepicker = this.datepicker,
          suggest = this.suggest;
      el.show();
      this.cell = cell;
      var text = cell && cell.text || '';
      this.setText(text);
      this.validator = validator;

      if (validator) {
        var type = validator.type;

        if (type === 'date') {
          datepicker.show();

          if (!/^\s*$/.test(text)) {
            datepicker.setValue(text);
          }
        }

        if (type === 'list') {
          suggest.setItems(validator.values());
          suggest.search('');
        }
      }
    }
  }, {
    key: "setText",
    value: function setText(text) {
      this.inputText = text; // console.log('text>>:', text);

      _setText.call(this, text, text.length);

      resetTextareaSize.call(this);
    }
  }]);

  return Editor;
}();


// CONCATENATED MODULE: ./src/sheet/component/contextmenu.js









var menuItems = [{
  key: 'copy',
  title: tf('contextmenu.copy'),
  label: 'Ctrl+C'
}, {
  key: 'cut',
  title: tf('contextmenu.cut'),
  label: 'Ctrl+X'
}, {
  key: 'paste',
  title: tf('contextmenu.paste'),
  label: 'Ctrl+V'
}, {
  key: 'paste-value',
  title: tf('contextmenu.pasteValue'),
  label: 'Ctrl+Shift+V'
}, {
  key: 'paste-format',
  title: tf('contextmenu.pasteFormat'),
  label: 'Ctrl+Alt+V'
}, {
  key: 'edit-format',
  title: tf('contextmenu.editFormat')
}, {
  key: 'divider'
}, {
  key: 'insert-row',
  title: tf('contextmenu.insertRow')
}, {
  key: 'insert-column',
  title: tf('contextmenu.insertColumn')
}, {
  key: 'set-width',
  title: tf('contextmenu.setWidth')
}, {
  key: 'set-height',
  title: tf('contextmenu.setHeight')
}, {
  key: 'divider'
}, {
  key: 'delete-row',
  title: tf('contextmenu.deleteRow')
}, {
  key: 'delete-column',
  title: tf('contextmenu.deleteColumn')
}, {
  key: 'delete-cell-text',
  title: tf('contextmenu.deleteCellText')
}, {
  key: 'hide',
  title: tf('contextmenu.hide')
}, {
  key: 'divider'
}, {
  key: 'insert-comment',
  title: tf('contextmenu.insertComment')
}, {
  key: 'edit-comment',
  title: tf('contextmenu.editComment')
}, {
  key: 'del-comment',
  title: tf('contextmenu.delComment')
}, {
  key: 'validation',
  title: tf('contextmenu.validation')
}, {
  key: 'divider'
}, {
  key: 'cell-printable',
  title: tf('contextmenu.cellprintable')
}, {
  key: 'cell-non-printable',
  title: tf('contextmenu.cellnonprintable')
}, {
  key: 'divider'
}, {
  key: 'cell-editable',
  title: tf('contextmenu.celleditable')
}, {
  key: 'cell-non-editable',
  title: tf('contextmenu.cellnoneditable')
}];

function buildMenuItem(item) {
  var _this = this;

  var maxNum = 200;
  var minNum = 1;
  var insertNumInput = '';

  if (item.key === 'divider') {
    return element_h('div', "".concat(cssPrefix, "-item divider"));
  }

  if (item.key === 'insert-row' || item.key === 'insert-column') {
    insertNumInput = element_h('input', "".concat(cssPrefix, "-item-input")).attr('type', 'number').attr('max', maxNum).attr('min', minNum).val(1).on('input', function (t) {
      if (t.target.value === '') return;
      var value = t.target.value;
      t.target.value = Math.max(value, minNum);
      t.target.value = Math.min(value, maxNum);
      _this.insertNum[item.key] = t.target.value;
      t.target.focus();
    }).on('click', function (t) {
      t.stopPropagation();
    });
  }

  return element_h('div', "".concat(cssPrefix, "-item")).attr('key', item.key).on('click', function () {
    var _this$insertNum;

    _this.itemClick(item.key, parseInt((_this$insertNum = _this.insertNum) === null || _this$insertNum === void 0 ? void 0 : _this$insertNum[item.key]));

    _this.hide();
  }).children(item.title(), insertNumInput || element_h('div', 'label').child(item.label || ''));
}

function buildMenu() {
  var _this2 = this;

  return menuItems.map(function (it) {
    return buildMenuItem.call(_this2, it);
  });
}

var contextmenu_ContextMenu = /*#__PURE__*/function () {
  function ContextMenu(viewFn) {
    var _h;

    var isHide = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;

    _classCallCheck(this, ContextMenu);

    this.rowText = 1;
    this.menuItems = buildMenu.call(this);
    this.el = (_h = element_h('div', "".concat(cssPrefix, "-contextmenu"))).children.apply(_h, _toConsumableArray(this.menuItems)).hide();
    this.viewFn = viewFn;

    this.itemClick = function () {};

    this.isHide = isHide;
    this.setMode('range');
    this.insertNum = {
      'insert-row': 1,
      'insert-column': 1
    };
  } // row-col: the whole rows or the whole cols
  // range: select range


  _createClass(ContextMenu, [{
    key: "setMode",
    value: function setMode(mode, comment) {
      if (mode === 'row') {
        this.rest(['set-width', 'insert-column', 'delete-column', 'insert-comment', 'edit-comment', 'del-comment']);
      } else if (mode === 'col') {
        this.rest(['set-height', 'insert-row', 'delete-row', 'insert-comment', 'edit-comment', 'del-comment']);
      } else {
        if (comment) {
          this.rest(['hide', 'set-width', 'set-height', 'insert-comment']);
        } else {
          this.rest(['hide', 'set-width', 'set-height', 'edit-comment', 'del-comment']);
        }
      }
    }
  }, {
    key: "rest",
    value: function rest() {
      var hideArr = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : ['all'];

      var _iterator = _createForOfIteratorHelper(this.menuItems),
          _step;

      try {
        for (_iterator.s(); !(_step = _iterator.n()).done;) {
          var iterator = _step.value;
          iterator.show();
        }
      } catch (err) {
        _iterator.e(err);
      } finally {
        _iterator.f();
      }

      var _iterator2 = _createForOfIteratorHelper(this.menuItems),
          _step2;

      try {
        for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {
          var _iterator3 = _step2.value;

          var _iterator4 = _createForOfIteratorHelper(hideArr),
              _step3;

          try {
            for (_iterator4.s(); !(_step3 = _iterator4.n()).done;) {
              var hide = _step3.value;

              if (hide === _iterator3.el.getAttribute('key')) {
                _iterator3.hide();
              }
            }
          } catch (err) {
            _iterator4.e(err);
          } finally {
            _iterator4.f();
          }
        }
      } catch (err) {
        _iterator2.e(err);
      } finally {
        _iterator2.f();
      }
    }
  }, {
    key: "hide",
    value: function hide() {
      var el = this.el;
      el.hide();
      unbindClickoutside(el);
    }
  }, {
    key: "setPosition",
    value: function setPosition(x, y) {
      if (this.isHide) return;
      var el = this.el;

      var _el$show$offset = el.show().offset(),
          width = _el$show$offset.width;

      var view = this.viewFn();
      var vhf = view.height / 2;
      var left = x;

      if (view.width - x <= width) {
        left -= width;
      }

      el.css('left', "".concat(left, "px"));

      if (y > vhf) {
        el.css('bottom', "".concat(view.height - y, "px")).css('max-height', "".concat(y, "px")).css('top', 'auto');
      } else {
        el.css('top', "".concat(y, "px")).css('max-height', "".concat(view.height - y, "px")).css('bottom', 'auto');
      }

      bindClickoutside(el);
    }
  }]);

  return ContextMenu;
}();


// EXTERNAL MODULE: ./node_modules/core-js/modules/es.string.strike.js
var es_string_strike = __webpack_require__("2315");

// EXTERNAL MODULE: ./node_modules/core-js/modules/es.string.sub.js
var es_string_sub = __webpack_require__("4c53");

// CONCATENATED MODULE: ./src/sheet/core/font.js



// docs

/** default font list
 * @type {BaseFont[]}
 */

var baseFonts = [{
  key: '宋体',
  title: '宋体'
}, {
  key: '黑体',
  title: '黑体'
}, {
  key: '仿宋',
  title: '仿宋'
}, {
  key: '楷体',
  title: '楷体'
}, {
  key: '隶书',
  title: '隶书'
}, {
  key: '华文中宋',
  title: '华文中宋'
}, {
  key: '华文行楷',
  title: '华文行楷'
}, {
  key: 'Microsoft YaHei',
  title: 'Microsoft YaHei'
}, {
  key: 'Arial',
  title: 'Arial'
}, {
  key: 'Helvetica',
  title: 'Helvetica'
}, {
  key: 'Hiragino',
  title: 'Hiragino Sans GB'
}, {
  key: 'Source Sans Pro',
  title: 'Source Sans Pro'
}, {
  key: 'Comic Sans MS',
  title: 'Comic Sans MS'
}, {
  key: 'Courier New',
  title: 'Courier New'
}, {
  key: 'Verdana',
  title: 'Verdana'
}, {
  key: 'Lato',
  title: 'Lato'
}];
/** default fontSize list
 * @type {FontSize[]}
 */

var fontSizes = [{
  pt: 4,
  px: 5.3
}, {
  pt: 5,
  px: 6.6
}, {
  pt: 6,
  px: 8
}, {
  pt: 7,
  px: 9.3
}, {
  pt: 7.5,
  px: 10
}, {
  pt: 8,
  px: 11
}, {
  pt: 9,
  px: 12
}, {
  pt: 10,
  px: 13
}, {
  pt: 10.5,
  px: 14
}, {
  pt: 11,
  px: 15
}, {
  pt: 12,
  px: 16
}, {
  pt: 14,
  px: 18.7
}, {
  pt: 15,
  px: 20
}, {
  pt: 16,
  px: 21.3
}, {
  pt: 18,
  px: 24
}, {
  pt: 22,
  px: 29.3
}, {
  pt: 24,
  px: 32
}, {
  pt: 26,
  px: 34.7
}, {
  pt: 36,
  px: 48
}, {
  pt: 42,
  px: 56
} // { pt: 54, px: 71.7 },
// { pt: 63, px: 83.7 },
// { pt: 72, px: 95.6 },
];
/** map pt to px
 * @date 2019-10-10
 * @param {fontsizePT} pt
 * @returns {fontsizePX}
 */

function getFontSizePxByPt(pt) {
  for (var i = 0; i < fontSizes.length; i += 1) {
    var fontSize = fontSizes[i];

    if (fontSize.pt === pt) {
      return fontSize.px;
    }
  }

  return pt;
}
/** transform baseFonts to map
 * @date 2019-10-10
 * @param {BaseFont[]} [ary=[]]
 * @returns {object}
 */


function fonts() {
  var ary = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];
  var map = {};
  baseFonts.concat(ary).forEach(function (f) {
    map[f.key] = f;
  });
  return map;
}

/* harmony default export */ var core_font = ({});

// CONCATENATED MODULE: ./src/sheet/core/format.js









var formatStringRender = function formatStringRender(v) {
  return v;
};

var format_formatNumberRender = function formatNumberRender(v) {
  var s = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {
    is: false,
    iu: false,
    p: 2
  };
  var iu = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 10000;
  var fmt = {
    decimalSeparator: '.',
    groupSeparator: s.is ? ',' : '',
    groupSize: 3,
    secondaryGroupSize: 0,
    fractionGroupSeparator: '',
    fractionGroupSize: 0,
    suffix: s.iu ? s.u : ''
  };
  var div = s === null || s === void 0 ? void 0 : s.div;

  if (tryToNumber(v) && s) {
    return new bignumber_default.a(v).div(s.iu ? div || iu : 1).toFormat(s.p, fmt);
  }

  return v;
};

var dateTimeConfig = {
  date: 'yyyy/MM/dd',
  time: 'hh:mm:ss',
  datetime: 'yyyy/MM/dd hh:mm:ss',
  datelong: 'yyyy年MM月dd日'
};

var transparent = function transparent(v, s) {
  if (s && s.en) {
    var result = v;

    if (result == s.val) {
      result = '';
    }

    return result;
  }

  return '';
};

var defaultNumber = function defaultNumber(type, v, s) {
  var _s, _s2;

  if (s && (_s = s) !== null && _s !== void 0 && _s.en && v == ((_s2 = s) === null || _s2 === void 0 ? void 0 : _s2.val)) {
    return '';
  }

  if (type == 'percent') {
    s = {
      f: 'number',
      p: 2,
      is: false,
      u: '%',
      iu: true
    };
    return format_formatNumberRender(v, s, 0.01);
  }

  s = s || {
    f: 'number',
    p: 2,
    is: false,
    u: '',
    iu: false
  };
  return format_formatNumberRender(v, s, s.iu ? 10000 : 1);
};

var baseFormats = [{
  key: 'normal',
  title: tf('format.normal'),
  type: 'string',
  render: formatStringRender
}, {
  key: 'text',
  title: tf('format.text'),
  type: 'string',
  render: formatStringRender
}, {
  key: 'number',
  title: tf('format.number'),
  type: 'number',
  label: '1,000.12',
  render: function render(v, s) {
    return defaultNumber('number', v, s);
  }
}, {
  key: 'percent',
  title: tf('format.percent'),
  type: 'number',
  label: '10.12%',
  render: function render(v) {
    return defaultNumber('percent', v);
  }
}, {
  key: 'rmb',
  title: tf('format.rmb'),
  type: 'number',
  label: '￥10.00',
  render: function render(v, s) {
    return "\uFFE5".concat(format_formatNumberRender(v, s));
  }
}, {
  key: 'usd',
  title: tf('format.usd'),
  type: 'number',
  label: '$10.00',
  render: function render(v, s) {
    return "$".concat(format_formatNumberRender(v, s));
  }
}, {
  key: 'eur',
  title: tf('format.eur'),
  type: 'number',
  label: '€10.00',
  render: function render(v, s) {
    return "\u20AC".concat(format_formatNumberRender(v, s));
  }
}, {
  key: 'date',
  title: tf('format.date'),
  type: 'date',
  label: '2000/01/01',
  render: function render(v) {
    return formatDate(v, dateTimeConfig[this.key]);
  }
}, {
  key: 'datelong',
  title: tf('format.datelong'),
  type: 'date',
  label: '2000年01月01日',
  render: function render(v) {
    return formatDate(v, dateTimeConfig[this.key]);
  }
}, {
  key: 'time',
  title: tf('format.time'),
  type: 'date',
  label: '00:00:00',
  render: function render(v) {
    return formatDate(v, dateTimeConfig[this.key]);
  }
}, {
  key: 'datetime',
  title: tf('format.datetime'),
  type: 'date',
  label: '2000/01/01 00:00:00',
  render: function render(v) {
    return formatDate(v, dateTimeConfig[this.key]);
  }
}, {
  key: 'transparent',
  title: tf('format.transparent'),
  type: 'transparent',
  label: '显示为空',
  render: function render(v, s) {
    return "".concat(transparent(v, s));
  }
} // {
//   key: 'duration',
//   title: tf('format.duration'),
//   type: 'date',
//   label: '24:01:00',
//   render: formatStringRender
// }
]; // const formats = (ary = []) => {
//   const map = {};
//   baseFormats.concat(ary).forEach((f) => {
//     map[f.key] = f;
//   });
//   return map;
// };

var formatm = {};
baseFormats.forEach(function (f) {
  formatm[f.key] = f;
});
/* harmony default export */ var core_format = (function (v, format) {
  if (format.includes('{')) {
    format = JSON.parse(format);
    return formatm[format.f].render(v, format);
  } else {
    return formatm[format].render(v);
  }
});

// EXTERNAL MODULE: ./node_modules/core-js/modules/es.string.italics.js
var es_string_italics = __webpack_require__("c5d0");

// EXTERNAL MODULE: ./node_modules/core-js/modules/es.string.bold.js
var es_string_bold = __webpack_require__("cc71");

// EXTERNAL MODULE: ./node_modules/core-js/modules/es.array.fill.js
var es_array_fill = __webpack_require__("cb29");

// CONCATENATED MODULE: ./src/sheet/canvas/draw.js






















function draw_dpr() {
  return window.devicePixelRatio || 1;
}

function thinLineWidth() {
  return draw_dpr() - 0.5;
}

function npx(px) {
  return parseInt(px * draw_dpr(), 10);
}

function npxLine(px) {
  var n = npx(px);
  return n > 0 ? n - 0.5 : 0.5;
}

var draw_DrawBox = /*#__PURE__*/function () {
  function DrawBox(x, y, w, h) {
    var padding = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 0;

    _classCallCheck(this, DrawBox);

    this.x = x;
    this.y = y;
    this.width = w;
    this.height = h;
    this.padding = padding;
    this.bgcolor = '#ffffff'; // border: [width, style, color]

    this.borderTop = null;
    this.borderRight = null;
    this.borderBottom = null;
    this.borderLeft = null;
  }

  _createClass(DrawBox, [{
    key: "setBorders",
    value: function setBorders(_ref) {
      var top = _ref.top,
          bottom = _ref.bottom,
          left = _ref.left,
          right = _ref.right;
      if (top) this.borderTop = top;
      if (right) this.borderRight = right;
      if (bottom) this.borderBottom = bottom;
      if (left) this.borderLeft = left;
    }
  }, {
    key: "innerWidth",
    value: function innerWidth() {
      return this.width - this.padding * 2 - 2;
    }
  }, {
    key: "innerHeight",
    value: function innerHeight() {
      return this.height - this.padding * 2 - 2;
    }
  }, {
    key: "textx",
    value: function textx(align) {
      var width = this.width,
          padding = this.padding;
      var x = this.x;

      if (align === 'left') {
        x += padding;
      } else if (align === 'center') {
        x += width / 2;
      } else if (align === 'right') {
        x += width - padding;
      } else if (align === 'dist') {
        x += width / 2;
      }

      return x;
    }
  }, {
    key: "texty",
    value: function texty(align, h) {
      var height = this.height,
          padding = this.padding;
      var y = this.y;

      if (align === 'top') {
        y += padding;
      } else if (align === 'middle') {
        y += height / 2 - h / 2;
      } else if (align === 'bottom') {
        y += height - padding - h;
      }

      return y;
    }
  }, {
    key: "topxys",
    value: function topxys() {
      var x = this.x,
          y = this.y,
          width = this.width;
      return [[x, y], [x + width, y]];
    }
  }, {
    key: "rightxys",
    value: function rightxys() {
      var x = this.x,
          y = this.y,
          width = this.width,
          height = this.height;
      return [[x + width, y], [x + width, y + height]];
    }
  }, {
    key: "bottomxys",
    value: function bottomxys() {
      var x = this.x,
          y = this.y,
          width = this.width,
          height = this.height;
      return [[x, y + height], [x + width, y + height]];
    }
  }, {
    key: "leftxys",
    value: function leftxys() {
      var x = this.x,
          y = this.y,
          height = this.height;
      return [[x, y], [x, y + height]];
    }
  }]);

  return DrawBox;
}();

function drawFontLine(type, tx, ty, align, valign, blheight, blwidth) {
  var floffset = {
    x: 0,
    y: 0
  };

  if (type === 'underline') {
    if (valign === 'bottom') {
      floffset.y = 0;
    } else if (valign === 'top') {
      floffset.y = -(blheight + 2);
    } else {
      floffset.y = -blheight / 2;
    }
  } else if (type === 'strike') {
    if (valign === 'bottom') {
      floffset.y = blheight / 2;
    } else if (valign === 'top') {
      floffset.y = -(blheight / 2 + 2);
    }
  }

  if (align === 'center') {
    floffset.x = blwidth / 2;
  } else if (align === 'right') {
    floffset.x = blwidth;
  }

  this.line([tx - floffset.x, ty - floffset.y], [tx - floffset.x + blwidth, ty - floffset.y]);
}

var draw_Draw = /*#__PURE__*/function () {
  function Draw(el, width, height) {
    _classCallCheck(this, Draw);

    this.el = el;
    this.ctx = el.getContext('2d');
    this.resize(width, height);
    this.ctx.scale(draw_dpr(), draw_dpr());
    this.drawImageMap = new Map();
  }

  _createClass(Draw, [{
    key: "resize",
    value: function resize(width, height) {
      // console.log('dpr:', dpr);
      this.el.style.width = "".concat(width, "px");
      this.el.style.height = "".concat(height, "px");
      this.el.width = npx(width);
      this.el.height = npx(height);
    }
  }, {
    key: "clear",
    value: function clear() {
      var _this$el = this.el,
          width = _this$el.width,
          height = _this$el.height;
      this.ctx.clearRect(0, 0, width, height);
      this.drawImageMap = new Map();
      return this;
    }
  }, {
    key: "attr",
    value: function attr(options) {
      Object.assign(this.ctx, options);
      return this;
    }
  }, {
    key: "save",
    value: function save() {
      this.ctx.save();
      this.ctx.beginPath();
      return this;
    }
  }, {
    key: "restore",
    value: function restore() {
      this.ctx.restore();
      return this;
    }
  }, {
    key: "beginPath",
    value: function beginPath() {
      this.ctx.beginPath();
      return this;
    }
  }, {
    key: "translate",
    value: function translate(x, y) {
      this.ctx.translate(npx(x), npx(y));
      return this;
    }
  }, {
    key: "scale",
    value: function scale(x, y) {
      this.ctx.scale(x, y);
      return this;
    }
  }, {
    key: "clearRect",
    value: function clearRect(x, y, w, h) {
      this.ctx.clearRect(x, y, w, h);
      return this;
    }
  }, {
    key: "fillRect",
    value: function fillRect(x, y, w, h) {
      this.ctx.fillRect(npx(x) - 0.5, npx(y) - 0.5, npx(w), npx(h));
      return this;
    }
  }, {
    key: "fillText",
    value: function fillText(text, x, y) {
      this.ctx.fillText(text, npx(x), npx(y));
      return this;
    }
  }, {
    key: "getIndentWidth",
    value: function getIndentWidth(indent, align) {
      var size = 12;

      if (align == 'dist' || align == 'left') {
        return size * indent;
      }

      if (align == 'right') {
        return -size * indent;
      }

      return 0;
    }
    /*
      txt: render text
      box: DrawBox
      attr: {
        align: left | center | right
        valign: top | middle | bottom
        color: '#333333',
        strike: false,
        font: {
          name: 'Arial',
          size: 14,
          bold: false,
          italic: false,
        }
      }
      textWrap: text wrapping
    */

  }, {
    key: "text",
    value: function text(mtxt, box) {
      var _this = this;

      var attr = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};
      var textWrap = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : true;
      var indent = arguments.length > 4 ? arguments[4] : undefined;
      var ctx = this.ctx;
      var align = attr.align,
          valign = attr.valign,
          font = attr.font,
          color = attr.color,
          strike = attr.strike,
          underline = attr.underline;
      var indentw = this.getIndentWidth(indent, align);
      var tx = box.textx(align) + indentw;
      ctx.save();
      ctx.beginPath();
      var isDist = align === 'dist';
      this.attr({
        textAlign: isDist ? 'center' : align,
        textBaseline: valign,
        font: "".concat(font.italic ? 'italic' : '', " ").concat(font.bold ? 'bold' : '', " ").concat(npx(font.size), "px ").concat(font.name),
        fillStyle: color,
        strokeStyle: color
      });
      var txts = "".concat(mtxt).split('\n');
      var biw = box.innerWidth() - Math.abs(indentw);
      var ntxts = [];
      txts.forEach(function (it) {
        var txtWidth = ctx.measureText(it).width;

        if (textWrap && txtWidth > npx(biw)) {
          var textLine = {
            w: 0,
            len: 0,
            start: 0
          };

          for (var i = 0; i < it.length; i += 1) {
            if (textLine.w >= npx(biw)) {
              ntxts.push(it.substr(textLine.start, textLine.len));
              textLine = {
                w: 0,
                len: 0,
                start: i
              };
            }

            textLine.len += 1;
            textLine.w += ctx.measureText(it[i]).width + 1;
          }

          if (textLine.len > 0) {
            ntxts.push(it.substr(textLine.start, textLine.len));
          }
        } else {
          ntxts.push(it);
        }
      });
      var txtHeight = (ntxts.length - 1) * (font.size + 2);
      var ty = box.texty(valign, txtHeight);
      ntxts.forEach(function (txt) {
        var txtWidth = ctx.measureText(txt).width;

        if (txt.length && isDist) {
          var type = 'left';
          _this.ctx.textAlign = type;
          var startTx = box.textx(type) + indentw / 2;
          var distx = Math.max(biw - txtWidth, 0);
          var x = distx / (txt.length - 1);

          for (var i = 0; i < txt.length; i++) {
            var s = txt[i];
            var w = ctx.measureText(s).width;

            _this.fillText(s, startTx, ty);

            startTx = startTx + w + x;
          }

          txtWidth = biw;
        } else {
          _this.fillText(txt, tx, ty);
        }

        if (strike) {
          drawFontLine.call(_this, 'strike', tx, ty, align, valign, font.size, txtWidth);
        }

        if (underline) {
          drawFontLine.call(_this, 'underline', tx, ty, align, valign, font.size, txtWidth);
        }

        ty += font.size + 2;
      });
      ctx.restore();
      return this;
    }
  }, {
    key: "border",
    value: function border(style, color) {
      var ctx = this.ctx;
      ctx.lineWidth = thinLineWidth();
      ctx.setLineDash([0, 0]);
      ctx.strokeStyle = color; // console.log('style:', style);

      if (style === 'medium') {
        ctx.lineWidth = npx(2) - 0.5;
      } else if (style === 'thick') {
        ctx.lineWidth = npx(3);
      } else if (style === 'dashed') {
        ctx.setLineDash([npx(3), npx(2)]);
      } else if (style === 'dotted') {
        ctx.setLineDash([npx(2), npx(1)]);
      } else if (style === 'double') {
        ctx.setLineDash([npx(2), 0]);
      }

      return this;
    }
  }, {
    key: "line",
    value: function line() {
      var ctx = this.ctx;

      if (arguments.length > 1) {
        ctx.beginPath();

        var _ref2 = arguments.length <= 0 ? undefined : arguments[0],
            _ref3 = _slicedToArray(_ref2, 2),
            x = _ref3[0],
            y = _ref3[1];

        ctx.moveTo(npxLine(x), npxLine(y));

        for (var i = 1; i < arguments.length; i += 1) {
          var _ref4 = i < 0 || arguments.length <= i ? undefined : arguments[i],
              _ref5 = _slicedToArray(_ref4, 2),
              x1 = _ref5[0],
              y1 = _ref5[1];

          ctx.lineTo(npxLine(x1), npxLine(y1));
        }

        ctx.stroke();
      }

      return this;
    }
  }, {
    key: "strokeBorders",
    value: function strokeBorders(box) {
      var ctx = this.ctx;
      ctx.save(); // border

      var borderTop = box.borderTop,
          borderRight = box.borderRight,
          borderBottom = box.borderBottom,
          borderLeft = box.borderLeft;

      if (borderTop) {
        this.border.apply(this, _toConsumableArray(borderTop)); // console.log('box.topxys:', box.topxys());

        this.line.apply(this, _toConsumableArray(box.topxys()));
      }

      if (borderRight) {
        this.border.apply(this, _toConsumableArray(borderRight));
        this.line.apply(this, _toConsumableArray(box.rightxys()));
      }

      if (borderBottom) {
        this.border.apply(this, _toConsumableArray(borderBottom));
        this.line.apply(this, _toConsumableArray(box.bottomxys()));
      }

      if (borderLeft) {
        this.border.apply(this, _toConsumableArray(borderLeft));
        this.line.apply(this, _toConsumableArray(box.leftxys()));
      }

      ctx.restore();
    }
  }, {
    key: "dropupAndDown",
    value: function dropupAndDown(box) {
      this.dropup(box);
      this.dropdown(box);
    }
  }, {
    key: "dropup",
    value: function dropup(box) {
      var ctx = this.ctx;
      var x = box.x,
          y = box.y,
          width = box.width,
          height = box.height;
      var sx = x + width - 7;
      var sy = y + height - 12;
      ctx.save();
      ctx.beginPath();
      ctx.moveTo(npx(sx), npx(sy));
      ctx.lineTo(npx(sx - 8), npx(sy));
      ctx.lineTo(npx(sx - 4), npx(sy - 6));
      ctx.closePath();
      ctx.fillStyle = 'rgba(0, 0, 0, .45)';
      ctx.fill();
      ctx.restore();
    }
  }, {
    key: "dropdown",
    value: function dropdown(box) {
      var ctx = this.ctx;
      var x = box.x,
          y = box.y,
          width = box.width,
          height = box.height;
      var sx = x + width - 15;
      var sy = y + height - 10;
      ctx.save();
      ctx.beginPath();
      ctx.moveTo(npx(sx), npx(sy));
      ctx.lineTo(npx(sx + 8), npx(sy));
      ctx.lineTo(npx(sx + 4), npx(sy + 6));
      ctx.closePath();
      ctx.fillStyle = 'rgba(0, 0, 0, .45)';
      ctx.fill();
      ctx.restore();
    }
  }, {
    key: "error",
    value: function error(box, fillStyle) {
      var ctx = this.ctx;
      var x = box.x,
          y = box.y;
      var sx = x - 1;
      ctx.save();
      ctx.beginPath();
      ctx.moveTo(npx(sx + 10), npx(y - 1));
      ctx.lineTo(npx(sx), npx(y - 1));
      ctx.lineTo(npx(sx), npx(y + 10));
      ctx.closePath();
      ctx.fillStyle = fillStyle || 'rgba(255, 0, 0, .65)';
      ctx.fill();
      ctx.restore();
    }
  }, {
    key: "lb",
    value: function lb(box, fillStyle) {
      var ctx = this.ctx;
      var x = box.x,
          y = box.y,
          height = box.height;
      var sx = x - 1;
      var sy = y + height - 1;
      ctx.save();
      ctx.beginPath();
      ctx.moveTo(npx(sx + 9), npx(sy + 1));
      ctx.lineTo(npx(sx), npx(sy - 1));
      ctx.lineTo(npx(sx), npx(sy - 9));
      ctx.closePath();
      ctx.fillStyle = fillStyle || 'rgba(255, 0, 0, .65)';
      ctx.fill();
      ctx.restore();
    }
  }, {
    key: "rb",
    value: function rb(box) {
      var color = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'rgba(133, 133, 133, 1)';
      var ctx = this.ctx;
      var x = box.x,
          y = box.y,
          width = box.width,
          height = box.height;
      var sx = x + width - 1;
      var sy = y + height - 1;
      ctx.save();
      ctx.beginPath();
      ctx.moveTo(npx(sx - 8), npx(sy));
      ctx.lineTo(npx(sx), npx(sy));
      ctx.lineTo(npx(sx), npx(sy - 7));
      ctx.closePath();
      ctx.fillStyle = color;
      ctx.fill();
      ctx.restore();
    }
  }, {
    key: "frozen",
    value: function frozen(box) {
      var color = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'rgba(133, 133, 133, 1)';
      var ctx = this.ctx;
      var x = box.x,
          y = box.y,
          width = box.width;
      var sx = x + width - 1;
      ctx.save();
      ctx.beginPath();
      ctx.moveTo(npx(sx - 8), npx(y - 1));
      ctx.lineTo(npx(sx), npx(y - 1));
      ctx.lineTo(npx(sx), npx(y + 8));
      ctx.closePath();
      ctx.fillStyle = color;
      ctx.fill();
      ctx.restore();
    }
  }, {
    key: "comment",
    value: function comment(box) {
      var color = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '#e04040';
      var ctx = this.ctx;
      var x = box.x,
          y = box.y,
          width = box.width;
      var sx = x + width - 1;
      ctx.save();
      ctx.beginPath();
      ctx.moveTo(npx(sx - 6), npx(y - 1));
      ctx.lineTo(npx(sx), npx(y - 1));
      ctx.lineTo(npx(sx), npx(y + 6));
      ctx.closePath();
      ctx.fillStyle = color;
      ctx.fill();
      ctx.restore();
    }
  }, {
    key: "rect",
    value: function rect(box, dtextcb) {
      var ctx = this.ctx;
      var x = box.x,
          y = box.y,
          width = box.width,
          height = box.height,
          bgcolor = box.bgcolor;
      ctx.save();
      ctx.beginPath();
      ctx.fillStyle = bgcolor || '#fff';
      ctx.rect(npxLine(x + 1), npxLine(y + 1), npx(width - 2), npx(height - 2));
      ctx.clip();
      ctx.fill();
      dtextcb();
      ctx.restore();
    }
  }, {
    key: "clearTop",
    value: function clearTop(box) {
      var ctx = this.ctx;
      var x = box.x,
          y = box.y,
          width = box.width;
      ctx.clearRect(x, y, width, 2);
    }
  }, {
    key: "drawImage",
    value: function drawImage(box, url, w, h, loadedImgs) {
      var _this2 = this;

      var ctx = this.ctx;
      var x = box.x,
          y = box.y;
      var el = loadedImgs.get(url);

      if (el) {
        ctx.beginPath();
        ctx.save();
        ctx.drawImage(el, x, y);
        ctx.stroke();
        ctx.restore();
      } else {
        var img = new Image();
        img.crossOrigin = 'Anonymous';
        img.src = url;

        img.onload = function () {
          var _this2$drawImageMap$g;

          if ((_this2$drawImageMap$g = _this2.drawImageMap.get("".concat(x).concat(y))) !== null && _this2$drawImageMap$g !== void 0 && _this2$drawImageMap$g.includes(url)) return;

          _this2.drawImageMap.set("".concat(x).concat(y), url);

          loadedImgs.set(url, img);
          ctx.save();
          ctx.drawImage(img, x + w, y + h);
          ctx.stroke();
          ctx.restore();
        };
      }
    }
  }]);

  return Draw;
}();

/* harmony default export */ var canvas_draw = ({});

// CONCATENATED MODULE: ./src/sheet/component/table.js

















 // gobal var

var cellPaddingWidth = 5;
var tableFixedHeaderCleanStyle = {
  fillStyle: '#f4f5f8'
};
var tableGridStyle = {
  fillStyle: '#fff',
  lineWidth: thinLineWidth(),
  strokeStyle: '#c6c6c6'
};
var loadedImgs = new Map();

function tableFixedHeaderStyle() {
  return {
    textAlign: 'center',
    textBaseline: 'middle',
    font: "500 ".concat(npx(12), "px Source Sans Pro"),
    fillStyle: '#585757',
    lineWidth: thinLineWidth(),
    strokeStyle: '#e6e6e6'
  };
}

function getDrawBox(data, rindex, cindex) {
  var yoffset = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0;

  var _data$cellRect = data.cellRect(rindex, cindex),
      left = _data$cellRect.left,
      top = _data$cellRect.top,
      width = _data$cellRect.width,
      height = _data$cellRect.height;

  return new draw_DrawBox(left, top + yoffset, width, height, cellPaddingWidth);
}

function isSlash(cell) {
  var _cell$slash;

  return (cell === null || cell === void 0 ? void 0 : (_cell$slash = cell.slash) === null || _cell$slash === void 0 ? void 0 : _cell$slash.mode) > 0;
}
/*
function renderCellBorders(bboxes, translateFunc) {
  const { draw } = this;
  if (bboxes) {
    const rset = new Set();
    // console.log('bboxes:', bboxes);
    bboxes.forEach(({ ri, ci, box }) => {
      if (!rset.has(ri)) {
        rset.add(ri);
        translateFunc(ri);
      }
      draw.strokeBorders(box);
    });
  }
}
*/


function renderCell(draw, data, rindex, cindex) {
  var yoffset = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 0;
  var fixedTop = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : null;
  var sortedRowMap = data.sortedRowMap,
      rows = data.rows,
      cols = data.cols,
      names = data.names;
  if (rows.isHide(rindex) || cols.isHide(cindex)) return;
  var nrindex = rindex;

  if (sortedRowMap.has(rindex)) {
    nrindex = sortedRowMap.get(rindex);
  }

  var identifier = alphabet_xy2expr(cindex, nrindex);
  var cell = data.getCell(nrindex, cindex);
  var comment = data.getComment(nrindex, cindex);
  var examineError = data.examines.getErrorRef(identifier);
  var examineWarn = data.examines.getWarnRef(identifier);
  if (cell === null && comment === null && !examineWarn && !examineError) return;
  var frozen = false;

  if ((cell === null || cell === void 0 ? void 0 : cell.editable) === false) {
    frozen = true;
  }

  var style = data.getCellStyleOrDefault(nrindex, cindex);
  var dbox = getDrawBox(data, rindex, cindex, yoffset); // 分页表头表尾

  if (fixedTop) {
    dbox.y = fixedTop;
  }

  dbox.bgcolor = style.bgcolor;

  if (style.border !== undefined) {
    dbox.setBorders(style.border); // bboxes.push({ ri: rindex, ci: cindex, box: dbox });

    draw.strokeBorders(dbox);
  }

  draw.rect(dbox, function () {
    if (cell !== null) {
      var _data$formConfig, _data$formConfig$iden, _data$formConfig$iden2;

      // render text
      var cellText = '';
      var _data$settings = data.settings,
          asyncFormula = _data$settings.asyncFormula,
          evalPaused = _data$settings.evalPaused;

      if (!evalPaused) {
        var getRenderText = function getRenderText(y, x, sheetName) {
          return data.getCellTextOrDefault(x, y, sheetName);
        };

        cellText = core_cell.render(cell.text || '', getRenderText, null, names, identifier, asyncFormula);
      } else {
        cellText = cell.text || '';
      }

      if (style.format && cellText !== '') {
        // console.log(data.formatm, '>>', cell.format);
        cellText = core_format(cellText, style.format);
      }

      var font = Object.assign({}, style.font);
      font.size = getFontSizePxByPt(font.size); // console.log('style:', style);
      // debugger;

      var excelLink = (_data$formConfig = data.formConfig) === null || _data$formConfig === void 0 ? void 0 : (_data$formConfig$iden = _data$formConfig[identifier]) === null || _data$formConfig$iden === void 0 ? void 0 : (_data$formConfig$iden2 = _data$formConfig$iden.excelLink) === null || _data$formConfig$iden2 === void 0 ? void 0 : _data$formConfig$iden2.isLink;
      var fw = cols.indexWidth; // fixed height of header

      var fh = rows.indexHeight;

      if (isSlash(cell)) {
        draw.drawImage(dbox, cellText, fw, fh, loadedImgs);
      } else {
        draw.text(cellText, dbox, {
          align: style.align,
          valign: style.valign,
          font: font,
          color: excelLink ? 'blue' : style.color,
          strike: style.strike,
          underline: excelLink || style.underline
        }, style.textwrap, style.indent);
      }
    } // error


    var error = data.validations.getError(rindex, cindex);

    if (error) {
      // console.log('error:', rindex, cindex, error);
      draw.error(dbox);
    }

    var subscript = data.subscript.getSub(rindex, cindex);

    if (subscript) {
      draw[subscript.sub](dbox, subscript.color);
    }

    if (examineError) {
      draw.error(dbox, 'red');
    }

    if (examineWarn) {
      draw.error(dbox, 'yellow');
    }

    if (frozen && !data.hiddenFrozen) {
      // console.log(frozen);
      draw.frozen(dbox);
    }

    if (comment) {
      draw.comment(dbox);
    }
  });
}

function renderAutofilter(viewRange) {
  var data = this.data,
      draw = this.draw;

  if (viewRange) {
    var autoFilter = data.autoFilter;
    if (!autoFilter.active()) return;
    var afRange = autoFilter.hrange();

    if (viewRange.intersects(afRange)) {
      afRange.each(function (ri, ci) {
        var dbox = getDrawBox(data, ri, ci);

        if (autoFilter.sort && ci === autoFilter.sort.ci) {
          if (autoFilter.sort.order === 'desc') {
            draw.dropdown(dbox);
          } else {
            draw.dropup(dbox);
          }
        } else {
          draw.dropupAndDown(dbox);
        }
      });
    }
  }
}

function renderContent(viewRange, fw, fh, tx, ty) {
  var draw = this.draw,
      data = this.data;
  draw.save();
  draw.translate(fw, fh).translate(tx, ty);
  var exceptRowSet = data.exceptRowSet; // const exceptRows = Array.from(exceptRowSet);

  var filteredTranslateFunc = function filteredTranslateFunc(ri) {
    var ret = exceptRowSet.has(ri);

    if (ret) {
      var height = data.rows.getHeight(ri);
      draw.translate(0, -height);
    }

    return !ret;
  };

  var exceptRowTotalHeight = data.exceptRowTotalHeight(viewRange.sri, viewRange.eri); // 1 render cell

  draw.save();
  draw.translate(0, -exceptRowTotalHeight);
  viewRange.each(function (ri, ci) {
    renderCell(draw, data, ri, ci);
  }, function (ri) {
    return filteredTranslateFunc(ri);
  });
  draw.restore(); // 2 render mergeCell

  var rset = new Set();
  draw.save();
  draw.translate(0, -exceptRowTotalHeight);
  data.eachMergesInView(viewRange, function (_ref) {
    var sri = _ref.sri,
        sci = _ref.sci,
        eri = _ref.eri;

    if (!exceptRowSet.has(sri)) {
      renderCell(draw, data, sri, sci);
    } else if (!rset.has(sri)) {
      rset.add(sri);
      var height = data.rows.sumHeight(sri, eri + 1);
      draw.translate(0, -height);
    }
  });
  draw.restore(); // 3 render autofilter

  renderAutofilter.call(this, viewRange);
  draw.restore();
}

function renderSelectedHeaderCell(x, y, w, h) {
  var draw = this.draw,
      data = this.data;
  draw.save();
  draw.attr({
    fillStyle: data.settings.selectStyle.background
  }).fillRect(x, y, w, h);
  draw.restore();
} // viewRange
// type: all | left | top
// w: the fixed width of header
// h: the fixed height of header
// tx: moving distance on x-axis
// ty: moving distance on y-axis


function renderFixedHeaders(type, viewRange, w, h, tx, ty) {
  var _this = this;

  var draw = this.draw,
      data = this.data;

  if (data.settings.showIdentifier) {
    var sumHeight = viewRange.h; // rows.sumHeight(viewRange.sri, viewRange.eri + 1);

    var sumWidth = viewRange.w; // cols.sumWidth(viewRange.sci, viewRange.eci + 1);

    var nty = ty + h;
    var ntx = tx + w;
    draw.save(); // draw rect background

    draw.attr(tableFixedHeaderCleanStyle);
    if (type === 'all' || type === 'left') draw.fillRect(0, nty, w, sumHeight);
    if (type === 'all' || type === 'top') draw.fillRect(ntx, 0, sumWidth, h);
    var _data$selector$range = data.selector.range,
        sri = _data$selector$range.sri,
        sci = _data$selector$range.sci,
        eri = _data$selector$range.eri,
        eci = _data$selector$range.eci; // console.log(data.selectIndexes);
    // draw text
    // text font, align...

    draw.attr(tableFixedHeaderStyle()); // y-header-text

    if (type === 'all' || type === 'left') {
      data.rowEach(viewRange.sri, viewRange.eri, function (i, y1, rowHeight) {
        var y = nty + y1;
        var ii = i;
        draw.line([0, y], [w, y]);

        if (sri <= ii && ii < eri + 1) {
          renderSelectedHeaderCell.call(_this, 0, y, w, rowHeight);
        }

        draw.fillText(ii + 1, w / 2, y + rowHeight / 2);

        if (i > 0 && data.rows.isHide(i - 1)) {
          draw.save();
          draw.attr({
            strokeStyle: '#c6c6c6'
          });
          draw.line([5, y + 5], [w - 5, y + 5]);
          draw.restore();
        }
      });
      draw.line([0, sumHeight + nty], [w, sumHeight + nty]);
      draw.line([w, nty], [w, sumHeight + nty]);
    } // x-header-text


    if (type === 'all' || type === 'top') {
      data.colEach(viewRange.sci, viewRange.eci, function (i, x1, colWidth) {
        var x = ntx + x1;
        var ii = i;
        draw.line([x, 0], [x, h]);

        if (sci <= ii && ii < eci + 1) {
          renderSelectedHeaderCell.call(_this, x, 0, colWidth, h);
        }

        draw.fillText(stringAt(ii), x + colWidth / 2, h / 2);

        if (i > 0 && data.cols.isHide(i - 1)) {
          draw.save();
          draw.attr({
            strokeStyle: '#c6c6c6'
          });
          draw.line([x + 5, 5], [x + 5, h - 5]);
          draw.restore();
        }
      });
      draw.line([sumWidth + ntx, 0], [sumWidth + ntx, h]);
      draw.line([0, h], [sumWidth + ntx, h]);
    }

    draw.restore();
  }
}

function renderFixedLeftTopCell(fw, fh) {
  var draw = this.draw;
  draw.save(); // left-top-cell

  draw.attr({
    fillStyle: '#f4f5f8'
  }).fillRect(0, 0, fw, fh);
  draw.restore();
}

function renderContentGrid(_ref2, fw, fh, tx, ty) {
  var sri = _ref2.sri,
      sci = _ref2.sci,
      eri = _ref2.eri,
      eci = _ref2.eci,
      w = _ref2.w,
      h = _ref2.h;
  var draw = this.draw,
      data = this.data;
  var settings = data.settings;
  draw.save();
  draw.attr(tableGridStyle).translate(fw + tx, fh + ty); // const sumWidth = cols.sumWidth(sci, eci + 1);
  // const sumHeight = rows.sumHeight(sri, eri + 1);
  // console.log('sumWidth:', sumWidth);
  // draw.clearRect(0, 0, w, h);

  var showGrid = this.data.showGrid;

  if (typeof showGrid === 'undefined') {
    showGrid = settings.showGrid;
  }

  if (!showGrid) {
    draw.restore();
    return;
  } // console.log('rowStart:', rowStart, ', rowLen:', rowLen);


  data.rowEach(sri, eri, function (i, y, ch) {
    // console.log('y:', y);
    if (i !== sri || sri == 0) draw.line([0, y], [w, y]);
    if (i === eri) draw.line([0, y + ch], [w, y + ch]);
  });
  data.colEach(sci, eci, function (i, x, cw) {
    if (i !== sci || sci == 0) draw.line([x, 0], [x, h]);
    if (i === eci) draw.line([x + cw, 0], [x + cw, h]);
  });
  draw.restore();
}

function renderFreezeHighlightLine(fw, fh, ftw, fth) {
  var draw = this.draw,
      data = this.data;
  var twidth = data.viewWidth() - fw;
  var theight = data.viewHeight() - fh;
  draw.save().translate(fw, fh).attr({
    strokeStyle: 'rgba(75, 137, 255, .6)'
  });
  draw.line([0, fth], [twidth, fth]);
  draw.line([ftw, 0], [ftw, theight]);
  draw.restore();
}
/** end */


var table_Table = /*#__PURE__*/function () {
  function Table(el, data) {
    _classCallCheck(this, Table);

    this.el = el;
    this.draw = new draw_Draw(el, data.viewWidth(), data.viewHeight());
    this.data = data;
  }

  _createClass(Table, [{
    key: "resetData",
    value: function resetData(data) {
      this.data = data; // debugger

      this.render();
    }
  }, {
    key: "render",
    value: function render() {
      // resize canvas
      var data = this.data;
      var rows = data.rows,
          cols = data.cols,
          settings = data.settings; // fixed width of header

      var fw = cols.indexWidth; // fixed height of header

      var fh = rows.indexHeight;
      this.draw.resize(data.viewWidth(), data.viewHeight());
      data.names = this.data.getDatasSheetNames();
      data.validate();
      this.clear();
      var viewRange = data.viewRange(); // console.log("viewRange",viewRange)
      // renderAll.call(this, viewRange, data.scroll);

      var tx = data.freezeTotalWidth();
      var ty = data.freezeTotalHeight();
      var _data$scroll = data.scroll,
          x = _data$scroll.x,
          y = _data$scroll.y; // 1
      // debugger

      renderContentGrid.call(this, viewRange, fw, fh, tx, ty);
      renderContent.call(this, viewRange, fw, fh, -x, -y);
      renderFixedHeaders.call(this, 'all', viewRange, fw, fh, tx, ty);
      renderFixedLeftTopCell.call(this, fw, fh);

      var _data$freeze = _slicedToArray(data.freeze, 2),
          fri = _data$freeze[0],
          fci = _data$freeze[1];

      if (fri > 0 || fci > 0) {
        // 2
        if (fri > 0) {
          var vr = viewRange.clone();
          vr.sri = 0;
          vr.eri = fri - 1;
          vr.h = ty;
          renderContentGrid.call(this, vr, fw, fh, tx, 0);
          renderContent.call(this, vr, fw, fh, -x, 0);
          renderFixedHeaders.call(this, 'top', vr, fw, fh, tx, 0);
        } // 3


        if (fci > 0) {
          var _vr = viewRange.clone();

          _vr.sci = 0;
          _vr.eci = fci - 1;
          _vr.w = tx;
          renderContentGrid.call(this, _vr, fw, fh, 0, ty);
          renderFixedHeaders.call(this, 'left', _vr, fw, fh, 0, ty);
          renderContent.call(this, _vr, fw, fh, 0, -y);
        } // 4


        var freezeViewRange = data.freezeViewRange();
        renderContentGrid.call(this, freezeViewRange, fw, fh, 0, 0);
        renderFixedHeaders.call(this, 'all', freezeViewRange, fw, fh, 0, 0);
        renderContent.call(this, freezeViewRange, fw, fh, 0, 0); // 5

        if (settings.showFreezeLine) renderFreezeHighlightLine.call(this, fw, fh, tx, ty);
      }
    }
  }, {
    key: "clear",
    value: function clear() {
      this.draw.clear();
    }
  }]);

  return Table;
}();

/* harmony default export */ var component_table = (table_Table);
// EXTERNAL MODULE: ./node_modules/core-js/modules/es.reflect.get.js
var es_reflect_get = __webpack_require__("5d41");

// CONCATENATED MODULE: ./node_modules/@babel/runtime/helpers/esm/superPropBase.js

function _superPropBase(object, property) {
  while (!Object.prototype.hasOwnProperty.call(object, property)) {
    object = _getPrototypeOf(object);
    if (object === null) break;
  }

  return object;
}
// CONCATENATED MODULE: ./node_modules/@babel/runtime/helpers/esm/get.js





function get_get() {
  if (typeof Reflect !== "undefined" && Reflect.get) {
    get_get = Reflect.get;
  } else {
    get_get = function _get(target, property, receiver) {
      var base = _superPropBase(target, property);
      if (!base) return;
      var desc = Object.getOwnPropertyDescriptor(base, property);

      if (desc.get) {
        return desc.get.call(arguments.length < 3 ? target : receiver);
      }

      return desc.value;
    };
  }

  return get_get.apply(this, arguments);
}
// CONCATENATED MODULE: ./src/sheet/component/tooltip.js



function tooltip(html, target) {
  if (target.classList.contains('active')) {
    return;
  }

  var _target$getBoundingCl = target.getBoundingClientRect(),
      left = _target$getBoundingCl.left,
      top = _target$getBoundingCl.top,
      width = _target$getBoundingCl.width,
      height = _target$getBoundingCl.height;

  var el = element_h('div', "".concat(cssPrefix, "-tooltip")).html(html).show();
  document.body.appendChild(el.el);
  var elBox = el.box(); // console.log('elBox:', elBox);

  el.css('left', "".concat(left + width / 2 - elBox.width / 2, "px")).css('top', "".concat(top + height + 2, "px"));
  bind(target, 'mouseleave', function () {
    if (document.body.contains(el.el)) {
      unbind(target, 'click');
      document.body.removeChild(el.el);
    }
  });
  bind(target, 'click', function () {
    if (document.body.contains(el.el)) {
      document.body.removeChild(el.el);
    }
  });
}
// CONCATENATED MODULE: ./src/sheet/component/toolbar/item.js









var item_Item = /*#__PURE__*/function () {
  // tooltip
  // tag: the subclass type
  // shortcut: shortcut key
  function Item(tag, shortcut, value) {
    _classCallCheck(this, Item);

    this.tip = '';
    if (tag) this.tip = locale_t("toolbar.".concat(tag.replace(/-[a-z]/g, function (c) {
      return c[1].toUpperCase();
    })));
    if (shortcut) this.tip += " (".concat(shortcut, ")");
    this.tag = tag;
    this.shortcut = shortcut;
    this.value = value;
    this.el = this.element();

    this.change = function () {};
  }

  _createClass(Item, [{
    key: "element",
    value: function element() {
      var _this = this;

      var tip = this.tip;
      return element_h('div', "".concat(cssPrefix, "-toolbar-btn")).on('mouseenter', function (evt) {
        if (_this.tip) tooltip(_this.tip, evt.target);
      }).attr('data-tooltip', tip);
    }
  }, {
    key: "setState",
    value: function setState() {}
  }]);

  return Item;
}();


// CONCATENATED MODULE: ./src/sheet/component/toolbar/dropdown_item.js








var dropdown_item_DropdownItem = /*#__PURE__*/function (_Item) {
  _inherits(DropdownItem, _Item);

  var _super = _createSuper(DropdownItem);

  function DropdownItem() {
    _classCallCheck(this, DropdownItem);

    return _super.apply(this, arguments);
  }

  _createClass(DropdownItem, [{
    key: "dropdown",
    value: function dropdown() {}
  }, {
    key: "getValue",
    value: function getValue(v) {
      return v;
    }
  }, {
    key: "element",
    value: function element() {
      var _this = this;

      var tag = this.tag;
      this.dd = this.dropdown();

      this.dd.change = function (it) {
        return _this.change(tag, _this.getValue(it));
      };

      return get_get(_getPrototypeOf(DropdownItem.prototype), "element", this).call(this).child(this.dd);
    }
  }, {
    key: "setState",
    value: function setState(v) {
      if (v) {
        this.value = v;
        this.dd.setTitle(v);
      }
    }
  }]);

  return DropdownItem;
}(item_Item);


// CONCATENATED MODULE: ./src/sheet/component/dropdown.js









var dropdown_Dropdown = /*#__PURE__*/function (_Element) {
  _inherits(Dropdown, _Element);

  var _super = _createSuper(Dropdown);

  function Dropdown(title, label, width, showArrow, placement) {
    var _this2;

    var _this;

    _classCallCheck(this, Dropdown);

    _this = _super.call(this, 'div', "".concat(cssPrefix, "-dropdown ").concat(placement));
    _this.title = title;

    _this.change = function () {};

    _this.headerClick = function () {};

    if (typeof title === 'string') {
      _this.title = element_h('div', "".concat(cssPrefix, "-dropdown-title")).child(title);
    } else if (showArrow) {
      _this.title.addClass('arrow-left');
    }

    _this.contentEl = element_h('div', "".concat(cssPrefix, "-dropdown-content")).css('width', width).hide();

    for (var _len = arguments.length, children = new Array(_len > 5 ? _len - 5 : 0), _key = 5; _key < _len; _key++) {
      children[_key - 5] = arguments[_key];
    }

    (_this2 = _this).setContentChildren.apply(_this2, children);

    _this.headerEl = element_h('div', "".concat(cssPrefix, "-dropdown-header"));

    _this.headerEl.on('click', function () {
      if (_this.contentEl.css('display') !== 'block') {
        _this.show();
      } else {
        _this.hide();
      }
    }).children(_this.title, showArrow ? element_h('div', "".concat(cssPrefix, "-icon arrow-right")).child(element_h('div', "".concat(cssPrefix, "-icon-img arrow-down"))) : '', label ? element_h('div', 'label').html(label) : '');

    _this.children(_this.headerEl, _this.contentEl);

    return _this;
  }

  _createClass(Dropdown, [{
    key: "setContentChildren",
    value: function setContentChildren() {
      this.contentEl.html('');

      if (arguments.length > 0) {
        var _this$contentEl;

        (_this$contentEl = this.contentEl).children.apply(_this$contentEl, arguments);
      }
    }
  }, {
    key: "setMaxHeight",
    value: function setMaxHeight(height) {
      this.contentEl.css('max-height', "".concat(height, "px")).css('overflow', "auto");
    }
  }, {
    key: "setTitle",
    value: function setTitle(title) {
      this.title.html(title);
      this.hide();
    }
  }, {
    key: "show",
    value: function show() {
      var _this3 = this;

      var contentEl = this.contentEl;
      contentEl.show();
      this.parent().active();
      bindClickoutside(this.parent(), function () {
        _this3.hide();
      });
    }
  }, {
    key: "hide",
    value: function hide() {
      this.parent().active(false);
      this.contentEl.hide();
      unbindClickoutside(this.parent());
    }
  }]);

  return Dropdown;
}(element_Element);


// CONCATENATED MODULE: ./src/sheet/component/dropdown_align.js












function buildItemWithIcon(iconName, label) {
  return element_h('div', "".concat(cssPrefix, "-item")).child(new icon_Icon(iconName)).child(element_h('div', 'label').html(label));
}

var dropdown_align_DropdownAlign = /*#__PURE__*/function (_Dropdown) {
  _inherits(DropdownAlign, _Dropdown);

  var _super = _createSuper(DropdownAlign);

  function DropdownAlign(aligns, align) {
    var _this;

    _classCallCheck(this, DropdownAlign);

    var icon = new icon_Icon("align-".concat(align));
    var naligns = aligns.map(function (it) {
      return buildItemWithIcon("align-".concat(it.key), it.label()).on('click', function () {
        _this.setTitle(it.key);

        _this.change(it.key);
      });
    });
    return _this = _super.call.apply(_super, [this, icon, null, '120px', true, 'bottom-left'].concat(_toConsumableArray(naligns)));
  }

  _createClass(DropdownAlign, [{
    key: "setTitle",
    value: function setTitle(align) {
      this.title.setName("align-".concat(align));
      this.hide();
    }
  }]);

  return DropdownAlign;
}(dropdown_Dropdown);


// CONCATENATED MODULE: ./src/sheet/component/toolbar/align.js








var align_Align = /*#__PURE__*/function (_DropdownItem) {
  _inherits(Align, _DropdownItem);

  var _super = _createSuper(Align);

  function Align(value) {
    _classCallCheck(this, Align);

    return _super.call(this, 'align', '', value);
  }

  _createClass(Align, [{
    key: "dropdown",
    value: function dropdown() {
      var value = this.value;
      var aligns = [{
        key: 'left',
        label: tf('aligns.left')
      }, {
        key: 'center',
        label: tf('aligns.center')
      }, {
        key: 'right',
        label: tf('aligns.right')
      }, {
        key: 'dist',
        label: tf('aligns.dist')
      }];
      return new dropdown_align_DropdownAlign(aligns, value);
    }
  }]);

  return Align;
}(dropdown_item_DropdownItem);


// CONCATENATED MODULE: ./src/sheet/component/toolbar/valign.js








var valign_Valign = /*#__PURE__*/function (_DropdownItem) {
  _inherits(Valign, _DropdownItem);

  var _super = _createSuper(Valign);

  function Valign(value) {
    _classCallCheck(this, Valign);

    return _super.call(this, 'valign', '', value);
  }

  _createClass(Valign, [{
    key: "dropdown",
    value: function dropdown() {
      var valign = [{
        key: 'top',
        label: tf('valigns.top')
      }, {
        key: 'middle',
        label: tf('valigns.middle')
      }, {
        key: 'bottom',
        label: tf('valigns.bottom')
      }];
      var value = this.value;
      return new dropdown_align_DropdownAlign(valign, value);
    }
  }]);

  return Valign;
}(dropdown_item_DropdownItem);


// CONCATENATED MODULE: ./src/sheet/component/toolbar/toggle_item.js









var toggle_item_ToggleItem = /*#__PURE__*/function (_Item) {
  _inherits(ToggleItem, _Item);

  var _super = _createSuper(ToggleItem);

  function ToggleItem() {
    _classCallCheck(this, ToggleItem);

    return _super.apply(this, arguments);
  }

  _createClass(ToggleItem, [{
    key: "element",
    value: function element() {
      var _this = this;

      var tag = this.tag;
      return get_get(_getPrototypeOf(ToggleItem.prototype), "element", this).call(this).child(new icon_Icon(tag)).on('click', function () {
        return _this.click();
      });
    }
  }, {
    key: "click",
    value: function click() {
      this.change(this.tag, this.toggle());
    }
  }, {
    key: "setState",
    value: function setState(active) {
      this.el.active(active);
    }
  }, {
    key: "toggle",
    value: function toggle() {
      return this.el.toggle();
    }
  }, {
    key: "active",
    value: function active() {
      return this.el.hasClass('active');
    }
  }]);

  return ToggleItem;
}(item_Item);


// CONCATENATED MODULE: ./src/sheet/component/toolbar/autofilter.js






var autofilter_Autofilter = /*#__PURE__*/function (_ToggleItem) {
  _inherits(Autofilter, _ToggleItem);

  var _super = _createSuper(Autofilter);

  function Autofilter() {
    _classCallCheck(this, Autofilter);

    return _super.call(this, 'autofilter');
  }

  _createClass(Autofilter, [{
    key: "setState",
    value: function setState() {}
  }]);

  return Autofilter;
}(toggle_item_ToggleItem);


// CONCATENATED MODULE: ./src/sheet/component/toolbar/bold.js





var bold_Bold = /*#__PURE__*/function (_ToggleItem) {
  _inherits(Bold, _ToggleItem);

  var _super = _createSuper(Bold);

  function Bold() {
    _classCallCheck(this, Bold);

    return _super.call(this, 'font-bold', 'Ctrl+B');
  }

  return Bold;
}(toggle_item_ToggleItem);


// CONCATENATED MODULE: ./src/sheet/component/toolbar/italic.js





var italic_Italic = /*#__PURE__*/function (_ToggleItem) {
  _inherits(Italic, _ToggleItem);

  var _super = _createSuper(Italic);

  function Italic() {
    _classCallCheck(this, Italic);

    return _super.call(this, 'font-italic', 'Ctrl+I');
  }

  return Italic;
}(toggle_item_ToggleItem);


// CONCATENATED MODULE: ./src/sheet/component/toolbar/strike.js





var strike_Strike = /*#__PURE__*/function (_ToggleItem) {
  _inherits(Strike, _ToggleItem);

  var _super = _createSuper(Strike);

  function Strike() {
    _classCallCheck(this, Strike);

    return _super.call(this, 'strike', 'Ctrl+U');
  }

  return Strike;
}(toggle_item_ToggleItem);


// CONCATENATED MODULE: ./src/sheet/component/toolbar/underline.js





var underline_Underline = /*#__PURE__*/function (_ToggleItem) {
  _inherits(Underline, _ToggleItem);

  var _super = _createSuper(Underline);

  function Underline() {
    _classCallCheck(this, Underline);

    return _super.call(this, 'underline', 'Ctrl+U');
  }

  return Underline;
}(toggle_item_ToggleItem);


// CONCATENATED MODULE: ./src/sheet/component/color_palette.js







var themeColorPlaceHolders = ['#FFFFFF', '#000100', '#E7E5E6', '#445569', '#5B9CD6', '#ED7D31', '#A5A5A5', '#FFC001', '#4371C6', '#71AE47'];
var themeColors = [['#F2F2F2', '#7F7F7F', '#D0CECF', '#D5DCE4', '#DEEAF6', '#FCE5D5', '#EDEDED', '#FFF2CD', '#D9E2F3', '#E3EFD9'], ['#D8D8D8', '#595959', '#AFABAC', '#ADB8CA', '#BDD7EE', '#F7CCAC', '#DBDBDB', '#FFE59A', '#B3C6E7', '#C5E0B3'], ['#BFBFBF', '#3F3F3F', '#756F6F', '#8596B0', '#9CC2E6', '#F4B184', '#C9C9C9', '#FED964', '#8EAADA', '#A7D08C'], ['#A5A5A5', '#262626', '#3A3839', '#333F4F', '#2E75B5', '#C45A10', '#7B7B7B', '#BF8E01', '#2F5596', '#538136'], ['#7F7F7F', '#0C0C0C', '#171516', '#222A35', '#1F4E7A', '#843C0A', '#525252', '#7E6000', '#203864', '#365624']];
var standardColors = ['#C00000', '#FE0000', '#FDC101', '#FFFF01', '#93D051', '#00B04E', '#01B0F1', '#0170C1', '#012060', '#7030A0'];

function buildTd(bgcolor) {
  var _this = this;

  return element_h('td', '').child(element_h('div', "".concat(cssPrefix, "-color-palette-cell")).on('click.stop', function () {
    return _this.change(bgcolor);
  }).css('background-color', bgcolor));
}

var color_palette_ColorPalette = /*#__PURE__*/function () {
  function ColorPalette() {
    var _h,
        _h2,
        _this2 = this,
        _h4;

    _classCallCheck(this, ColorPalette);

    this.el = element_h('div', "".concat(cssPrefix, "-color-palette"));

    this.change = function () {};

    var table = element_h('table', '').children((_h = element_h('tbody', '')).children.apply(_h, [(_h2 = element_h('tr', "".concat(cssPrefix, "-theme-color-placeholders"))).children.apply(_h2, _toConsumableArray(themeColorPlaceHolders.map(function (color) {
      return buildTd.call(_this2, color);
    })))].concat(_toConsumableArray(themeColors.map(function (it) {
      var _h3;

      return (_h3 = element_h('tr', "".concat(cssPrefix, "-theme-colors"))).children.apply(_h3, _toConsumableArray(it.map(function (color) {
        return buildTd.call(_this2, color);
      })));
    })), [(_h4 = element_h('tr', "".concat(cssPrefix, "-standard-colors"))).children.apply(_h4, _toConsumableArray(standardColors.map(function (color) {
      return buildTd.call(_this2, color);
    })))])));
    this.el.child(table);
  }

  _createClass(ColorPalette, [{
    key: "destroyed",
    value: function destroyed() {
      this.el.el.remove();
      this.el = null;

      this.change = function () {};
    }
  }]);

  return ColorPalette;
}();


// CONCATENATED MODULE: ./src/sheet/component/customize_color.js





var customize_color_ColorPalette = /*#__PURE__*/function () {
  function ColorPalette() {
    var _this = this;

    _classCallCheck(this, ColorPalette);

    this.change = function () {};

    this.el = element_h('input', "".concat(cssPrefix, "-color-palette_input")).on('input', function (evt) {
      _this.change(evt.target.value, false);

      evt.target.focus();
      evt.preventDefault();
    }).attr('placeholder', '自定义颜色');
  }

  _createClass(ColorPalette, [{
    key: "setTitle",
    value: function setTitle(color) {
      this.el.val(color);
    }
  }]);

  return ColorPalette;
}();


// CONCATENATED MODULE: ./src/sheet/component/dropdown_color.js









var dropdown_color_DropdownColor = /*#__PURE__*/function (_Dropdown) {
  _inherits(DropdownColor, _Dropdown);

  var _super = _createSuper(DropdownColor);

  function DropdownColor(iconName, color, label) {
    var _this;

    var isShowCustomizeColor = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : true;

    _classCallCheck(this, DropdownColor);

    var icon = new icon_Icon(iconName).css('height', '16px').css('border-bottom', "3px solid ".concat(color));
    var colorPalette = new color_palette_ColorPalette();
    var customizeColor = new customize_color_ColorPalette();

    colorPalette.change = function (v, isHide) {
      _this.setTitle(v, isHide);

      _this.change(v);

      customizeColor.setTitle(v);

      _this.hide();
    };

    customizeColor.change = function (v) {
      return _this.change(v);
    };

    _this = _super.call(this, icon, label, 'auto', false, 'bottom-left', colorPalette.el, isShowCustomizeColor ? customizeColor.el : '');
    _this.customizeColor = customizeColor;
    return _this;
  }

  _createClass(DropdownColor, [{
    key: "setTitle",
    value: function setTitle(color) {
      this.title.css('border-color', color);
      this.customizeColor.setTitle(color);
    }
  }]);

  return DropdownColor;
}(dropdown_Dropdown);


// CONCATENATED MODULE: ./src/sheet/component/dropdown_linetype.js










var lineTypes = [['thin', '<svg xmlns="http://www.w3.org/2000/svg" width="50" height="1" style="user-select: none;"><line x1="0" y1="0.5" x2="50" y2="0.5" stroke-width="1" stroke="black" style="user-select: none;"></line></svg>'], ['medium', '<svg xmlns="http://www.w3.org/2000/svg" width="50" height="2" style="user-select: none;"><line x1="0" y1="1.0" x2="50" y2="1.0" stroke-width="2" stroke="black" style="user-select: none;"></line></svg>'], ['thick', '<svg xmlns="http://www.w3.org/2000/svg" width="50" height="3" style="user-select: none;"><line x1="0" y1="1.5" x2="50" y2="1.5" stroke-width="3" stroke="black" style="user-select: none;"></line></svg>'], ['dashed', '<svg xmlns="http://www.w3.org/2000/svg" width="50" height="1" style="user-select: none;"><line x1="0" y1="0.5" x2="50" y2="0.5" stroke-width="1" stroke="black" stroke-dasharray="2" style="user-select: none;"></line></svg>'], ['dotted', '<svg xmlns="http://www.w3.org/2000/svg" width="50" height="1" style="user-select: none;"><line x1="0" y1="0.5" x2="50" y2="0.5" stroke-width="1" stroke="black" stroke-dasharray="1" style="user-select: none;"></line></svg>'] // ['double', '<svg xmlns="http://www.w3.org/2000/svg" width="50" height="3" style="user-select: none;"><line x1="0" y1="0.5" x2="50" y2="0.5" stroke-width="1" stroke="black" style="user-select: none;"></line><line x1="0" y1="2.5" x2="50" y2="2.5" stroke-width="1" stroke="black" style="user-select: none;"></line></svg>'],
];

var dropdown_linetype_DropdownLineType = /*#__PURE__*/function (_Dropdown) {
  _inherits(DropdownLineType, _Dropdown);

  var _super = _createSuper(DropdownLineType);

  function DropdownLineType(type, label) {
    var _this;

    _classCallCheck(this, DropdownLineType);

    var icon = new icon_Icon('line-type');
    var beforei = 0;
    var lineTypeEls = lineTypes.map(function (it, iti) {
      return element_h('div', "".concat(cssPrefix, "-item state ").concat(type === it[0] ? 'checked' : '')).on('click', function () {
        lineTypeEls[beforei].toggle('checked');
        lineTypeEls[iti].toggle('checked');
        beforei = iti;

        _this.hide();

        _this.change(it);
      }).child(element_h('div', "".concat(cssPrefix, "-line-type")).html(it[1]));
    });
    return _this = _super.call.apply(_super, [this, icon, label, 'auto', false, 'bottom-left'].concat(_toConsumableArray(lineTypeEls)));
  }

  return DropdownLineType;
}(dropdown_Dropdown);


// CONCATENATED MODULE: ./src/sheet/component/border_palette.js












var baseBorders = [{
  key: 'none',
  label: tf('borders.none')
}, {
  key: 'outside',
  label: tf('borders.outside')
}, {
  key: 'all',
  label: tf('borders.all')
}, {
  key: 'divider'
}, {
  key: 'top',
  label: tf('borders.top')
}, {
  key: 'right',
  label: tf('borders.right')
}, {
  key: 'left',
  label: tf('borders.left')
}, {
  key: 'bottom',
  label: tf('borders.bottom')
}, {
  key: 'divider'
}, {
  key: 'inside',
  label: tf('borders.inside')
}, {
  key: 'horizontal',
  label: tf('borders.horizontal')
}, {
  key: 'vertical',
  label: tf('borders.vertical')
}, {
  key: 'divider'
}];

var border_palette_BorderPalette = function BorderPalette() {
  var _this = this,
      _this$el;

  _classCallCheck(this, BorderPalette);

  this.color = '#000';
  this.style = 'thin';
  this.mode = 'all';

  this.change = function () {};

  this.ddColor = new dropdown_color_DropdownColor('line-color', this.color, tf('borders.lineColor')(), false);

  this.ddColor.change = function (color) {
    _this.color = color;
  };

  this.ddType = new dropdown_linetype_DropdownLineType(this.style, tf('borders.lineType')());

  this.ddType.change = function (_ref) {
    var _ref2 = _slicedToArray(_ref, 1),
        s = _ref2[0];

    _this.style = s;
  };

  this.el = element_h('div', "".concat(cssPrefix, "-border-palette"));
  var borderTypes = baseBorders.slice(0);
  borderTypes = borderTypes.map(function (it) {
    var item = element_h('div', "".concat(cssPrefix, "-item"));

    if (it.key === 'divider') {
      item.addClass('divider');
    } else {
      item.child(new icon_Icon("border-".concat(it.key))).child(element_h('div', 'label').html(it.label())).on('click', function () {
        _this.mode = it.key;
        var mode = _this.mode,
            style = _this.style,
            color = _this.color;

        _this.change({
          mode: mode,
          style: style,
          color: color
        });
      });
    }

    return item;
  });

  (_this$el = this.el).children.apply(_this$el, _toConsumableArray(borderTypes).concat([element_h('div', "".concat(cssPrefix, "-item auto")).child(this.ddColor.el), element_h('div', "".concat(cssPrefix, "-item auto")).child(this.ddType.el)]));
};


// CONCATENATED MODULE: ./src/sheet/component/dropdown_border.js







var dropdown_border_DropdownBorder = /*#__PURE__*/function (_Dropdown) {
  _inherits(DropdownBorder, _Dropdown);

  var _super = _createSuper(DropdownBorder);

  function DropdownBorder() {
    var _this;

    _classCallCheck(this, DropdownBorder);

    var icon = new icon_Icon('border-all');
    var borderPalette = new border_palette_BorderPalette();

    borderPalette.change = function (v) {
      _this.change(v);

      _this.hide();
    };

    return _this = _super.call(this, icon, null, 'auto', false, 'bottom-left', borderPalette.el);
  }

  return DropdownBorder;
}(dropdown_Dropdown);


// CONCATENATED MODULE: ./src/sheet/component/toolbar/border.js







var border_Border = /*#__PURE__*/function (_DropdownItem) {
  _inherits(Border, _DropdownItem);

  var _super = _createSuper(Border);

  function Border() {
    _classCallCheck(this, Border);

    return _super.call(this, 'border');
  }

  _createClass(Border, [{
    key: "dropdown",
    value: function dropdown() {
      return new dropdown_border_DropdownBorder();
    }
  }]);

  return Border;
}(dropdown_item_DropdownItem);


// CONCATENATED MODULE: ./src/sheet/component/toolbar/icon_item.js









var icon_item_IconItem = /*#__PURE__*/function (_Item) {
  _inherits(IconItem, _Item);

  var _super = _createSuper(IconItem);

  function IconItem() {
    _classCallCheck(this, IconItem);

    return _super.apply(this, arguments);
  }

  _createClass(IconItem, [{
    key: "element",
    value: function element() {
      var _this = this;

      return get_get(_getPrototypeOf(IconItem.prototype), "element", this).call(this).child(new icon_Icon(this.tag)).on('click', function () {
        return _this.change(_this.tag);
      });
    }
  }, {
    key: "setState",
    value: function setState(disabled) {
      this.el.disabled(disabled);
    }
  }]);

  return IconItem;
}(item_Item);


// CONCATENATED MODULE: ./src/sheet/component/toolbar/clearformat.js





var clearformat_Clearformat = /*#__PURE__*/function (_IconItem) {
  _inherits(Clearformat, _IconItem);

  var _super = _createSuper(Clearformat);

  function Clearformat() {
    _classCallCheck(this, Clearformat);

    return _super.call(this, 'clearformat');
  }

  return Clearformat;
}(icon_item_IconItem);


// CONCATENATED MODULE: ./src/sheet/component/toolbar/paintformat.js






var paintformat_Paintformat = /*#__PURE__*/function (_ToggleItem) {
  _inherits(Paintformat, _ToggleItem);

  var _super = _createSuper(Paintformat);

  function Paintformat() {
    _classCallCheck(this, Paintformat);

    return _super.call(this, 'paintformat');
  }

  _createClass(Paintformat, [{
    key: "setState",
    value: function setState() {}
  }]);

  return Paintformat;
}(toggle_item_ToggleItem);


// CONCATENATED MODULE: ./src/sheet/component/toolbar/text_color.js







var text_color_TextColor = /*#__PURE__*/function (_DropdownItem) {
  _inherits(TextColor, _DropdownItem);

  var _super = _createSuper(TextColor);

  function TextColor(color) {
    _classCallCheck(this, TextColor);

    return _super.call(this, 'color', undefined, color);
  }

  _createClass(TextColor, [{
    key: "dropdown",
    value: function dropdown() {
      var tag = this.tag,
          value = this.value;
      return new dropdown_color_DropdownColor(tag, value);
    }
  }]);

  return TextColor;
}(dropdown_item_DropdownItem);


// CONCATENATED MODULE: ./src/sheet/component/toolbar/fill_color.js







var fill_color_FillColor = /*#__PURE__*/function (_DropdownItem) {
  _inherits(FillColor, _DropdownItem);

  var _super = _createSuper(FillColor);

  function FillColor(color) {
    _classCallCheck(this, FillColor);

    return _super.call(this, 'bgcolor', undefined, color);
  }

  _createClass(FillColor, [{
    key: "dropdown",
    value: function dropdown() {
      var tag = this.tag,
          value = this.value;
      return new dropdown_color_DropdownColor(tag, value);
    }
  }]);

  return FillColor;
}(dropdown_item_DropdownItem);


// CONCATENATED MODULE: ./src/sheet/component/dropdown_fontsize.js











var dropdown_fontsize_DropdownFontSize = /*#__PURE__*/function (_Dropdown) {
  _inherits(DropdownFontSize, _Dropdown);

  var _super = _createSuper(DropdownFontSize);

  function DropdownFontSize() {
    var _this;

    _classCallCheck(this, DropdownFontSize);

    var nfontSizes = fontSizes.map(function (it) {
      return element_h('div', "".concat(cssPrefix, "-item")).on('click', function () {
        _this.setTitle("".concat(it.pt));

        _this.change(it);
      }).child("".concat(it.pt));
    });
    return _this = _super.call.apply(_super, [this, '10', null, '60px', true, 'bottom-left'].concat(_toConsumableArray(nfontSizes)));
  }

  return DropdownFontSize;
}(dropdown_Dropdown);


// CONCATENATED MODULE: ./src/sheet/component/toolbar/font_size.js







var font_size_Format = /*#__PURE__*/function (_DropdownItem) {
  _inherits(Format, _DropdownItem);

  var _super = _createSuper(Format);

  function Format() {
    _classCallCheck(this, Format);

    return _super.call(this, 'font-size');
  }

  _createClass(Format, [{
    key: "getValue",
    value: function getValue(it) {
      return it.pt;
    }
  }, {
    key: "dropdown",
    value: function dropdown() {
      return new dropdown_fontsize_DropdownFontSize();
    }
  }]);

  return Format;
}(dropdown_item_DropdownItem);


// CONCATENATED MODULE: ./src/sheet/component/dropdown_font.js











var dropdown_font_DropdownFont = /*#__PURE__*/function (_Dropdown) {
  _inherits(DropdownFont, _Dropdown);

  var _super = _createSuper(DropdownFont);

  function DropdownFont() {
    var _this;

    _classCallCheck(this, DropdownFont);

    var nfonts = baseFonts.map(function (it) {
      return element_h('div', "".concat(cssPrefix, "-item")).on('click', function () {
        _this.setTitle(it.title);

        _this.change(it);
      }).child(it.title);
    });
    return _this = _super.call.apply(_super, [this, baseFonts[0].title, null, '160px', true, 'bottom-left'].concat(_toConsumableArray(nfonts)));
  }

  return DropdownFont;
}(dropdown_Dropdown);


// CONCATENATED MODULE: ./src/sheet/component/toolbar/font.js







var font_Font = /*#__PURE__*/function (_DropdownItem) {
  _inherits(Font, _DropdownItem);

  var _super = _createSuper(Font);

  function Font() {
    _classCallCheck(this, Font);

    return _super.call(this, 'font-name');
  }

  _createClass(Font, [{
    key: "getValue",
    value: function getValue(it) {
      return it.key;
    }
  }, {
    key: "dropdown",
    value: function dropdown() {
      return new dropdown_font_DropdownFont();
    }
  }]);

  return Font;
}(dropdown_item_DropdownItem);


// CONCATENATED MODULE: ./src/sheet/component/dropdown_format.js
















var dropdown_format_DropdownFormat = /*#__PURE__*/function (_Dropdown) {
  _inherits(DropdownFormat, _Dropdown);

  var _super = _createSuper(DropdownFormat);

  function DropdownFormat() {
    var _this;

    _classCallCheck(this, DropdownFormat);

    var nformats = baseFormats.slice(0);
    nformats.splice(2, 0, {
      key: 'divider'
    });
    nformats.splice(8, 0, {
      key: 'divider'
    });
    nformats = nformats.map(function (it) {
      var item = element_h('div', "".concat(cssPrefix, "-item"));

      if (it.key === 'divider') {
        item.addClass('divider');
      } else {
        item.child(it.title()).on('click', function () {
          _this.setTitle(it.title());

          _this.change(it);
        });
        if (it.label) item.child(element_h('div', 'label').html(it.label));
      }

      return item;
    });
    return _this = _super.call.apply(_super, [this, 'Normal', null, '220px', true, 'bottom-left'].concat(_toConsumableArray(nformats)));
  }

  _createClass(DropdownFormat, [{
    key: "setTitle",
    value: function setTitle(key) {
      for (var i = 0; i < baseFormats.length; i += 1) {
        if (baseFormats[i].key === key) {
          this.title.html(baseFormats[i].title());
        }

        if (key.includes('{')) {
          var format = JSON.parse(key);

          if (baseFormats[i].key === format.f) {
            this.title.html(baseFormats[i].title());
          }
        }
      }

      this.hide();
    }
  }]);

  return DropdownFormat;
}(dropdown_Dropdown);


// CONCATENATED MODULE: ./src/sheet/component/toolbar/format.js







var format_Format = /*#__PURE__*/function (_DropdownItem) {
  _inherits(Format, _DropdownItem);

  var _super = _createSuper(Format);

  function Format() {
    _classCallCheck(this, Format);

    return _super.call(this, 'format');
  }

  _createClass(Format, [{
    key: "getValue",
    value: function getValue(it) {
      return it.key;
    }
  }, {
    key: "dropdown",
    value: function dropdown() {
      return new dropdown_format_DropdownFormat();
    }
  }]);

  return Format;
}(dropdown_item_DropdownItem);


// CONCATENATED MODULE: ./src/sheet/core/formula.js



/**
  formula:
    key
    title
    render
*/

/**
 * @typedef {object} Formula
 * @property {string} key
 * @property {function} title
 * @property {function} render
 */

/** @type {Formula[]} */

var baseFormulas = [{
  key: 'SUM',
  title: tf('formula.sum')
}, {
  key: 'AVERAGE',
  title: tf('formula.average')
}, {
  key: 'MAX',
  title: tf('formula.max')
}, {
  key: 'MIN',
  title: tf('formula.min')
}, {
  key: 'IF',
  title: tf('formula._if')
}, {
  key: 'AND',
  title: tf('formula.and')
}, {
  key: 'OR',
  title: tf('formula.or')
}, {
  key: 'CONCAT',
  title: tf('formula.concat')
}];
var formula_formulas = baseFormulas;
var formulam = {};
baseFormulas.forEach(function (f) {
  formulam[f.key] = f;
});
/* harmony default export */ var core_formula = ({});

// CONCATENATED MODULE: ./src/sheet/component/dropdown_formula.js












var dropdown_formula_DropdownFormula = /*#__PURE__*/function (_Dropdown) {
  _inherits(DropdownFormula, _Dropdown);

  var _super = _createSuper(DropdownFormula);

  function DropdownFormula() {
    var _this;

    _classCallCheck(this, DropdownFormula);

    var nformulas = baseFormulas.map(function (it) {
      return element_h('div', "".concat(cssPrefix, "-item")).on('click', function () {
        _this.hide();

        _this.change(it);
      }).child(it.key);
    });
    return _this = _super.call.apply(_super, [this, new icon_Icon('formula'), null, '180px', true, 'bottom-left'].concat(_toConsumableArray(nformulas)));
  }

  return DropdownFormula;
}(dropdown_Dropdown);


// CONCATENATED MODULE: ./src/sheet/component/toolbar/formula.js







var formula_Format = /*#__PURE__*/function (_DropdownItem) {
  _inherits(Format, _DropdownItem);

  var _super = _createSuper(Format);

  function Format() {
    _classCallCheck(this, Format);

    return _super.call(this, 'formula');
  }

  _createClass(Format, [{
    key: "getValue",
    value: function getValue(it) {
      return it.key;
    }
  }, {
    key: "dropdown",
    value: function dropdown() {
      return new dropdown_formula_DropdownFormula();
    }
  }]);

  return Format;
}(dropdown_item_DropdownItem);


// CONCATENATED MODULE: ./src/sheet/component/toolbar/freeze.js





var freeze_Freeze = /*#__PURE__*/function (_ToggleItem) {
  _inherits(Freeze, _ToggleItem);

  var _super = _createSuper(Freeze);

  function Freeze() {
    _classCallCheck(this, Freeze);

    return _super.call(this, 'freeze');
  }

  return Freeze;
}(toggle_item_ToggleItem);


// CONCATENATED MODULE: ./src/sheet/component/iconfont.js







var iconfont_Iconfont = /*#__PURE__*/function (_Element) {
  _inherits(Iconfont, _Element);

  var _super = _createSuper(Iconfont);

  function Iconfont(name) {
    var _this;

    _classCallCheck(this, Iconfont);

    _this = _super.call(this, 'div', "".concat(cssPrefix, "-icon iconfont"));
    _this.iconNameEl = element_h('span', "icon spread-sheet icon-".concat(name));

    _this.child(_this.iconNameEl);

    return _this;
  }

  _createClass(Iconfont, [{
    key: "setName",
    value: function setName(name) {
      this.iconNameEl.className("icon spread-sheet icon-".concat(name));
    }
  }]);

  return Iconfont;
}(element_Element);


// CONCATENATED MODULE: ./src/sheet/component/dropdown_slash.js












var dropdown_slash_DropdownSlash = /*#__PURE__*/function (_Dropdown) {
  _inherits(DropdownSlash, _Dropdown);

  var _super = _createSuper(DropdownSlash);

  function DropdownSlash(slashs) {
    var _this;

    _classCallCheck(this, DropdownSlash);

    var icon = new iconfont_Iconfont('slash');
    slashs = slashs.map(function (it) {
      var item = element_h('div', "".concat(cssPrefix, "-item")).html(it.label()).on('click', function () {
        _this.mode = it.key;

        var _assertThisInitialize = _assertThisInitialized(_this),
            mode = _assertThisInitialize.mode;

        _this.change({
          mode: mode
        });

        _this.hide();
      });
      return item;
    });
    return _this = _super.call.apply(_super, [this, icon, null, '50px', true, 'bottom-left'].concat(_toConsumableArray(slashs)));
  }

  return DropdownSlash;
}(dropdown_Dropdown);


// CONCATENATED MODULE: ./src/sheet/component/toolbar/slash.js








var slash_Border = /*#__PURE__*/function (_DropdownItem) {
  _inherits(Border, _DropdownItem);

  var _super = _createSuper(Border);

  function Border() {
    _classCallCheck(this, Border);

    return _super.call(this, 'slash');
  }

  _createClass(Border, [{
    key: "dropdown",
    value: function dropdown() {
      var slashs = [{
        key: '0',
        label: tf('slashs.slash0')
      }, {
        key: '1',
        label: tf('slashs.slash1')
      }, {
        key: '2',
        label: tf('slashs.slash2')
      }, {
        key: '3',
        label: tf('slashs.slash3')
      }];
      return new dropdown_slash_DropdownSlash(slashs);
    }
  }, {
    key: "setState",
    value: function setState(active) {
      this.el.active((active === null || active === void 0 ? void 0 : active.mode) > 0, 'holdActive');
    }
  }]);

  return Border;
}(dropdown_item_DropdownItem);


// CONCATENATED MODULE: ./src/sheet/component/toolbar/merge.js






var merge_Merge = /*#__PURE__*/function (_ToggleItem) {
  _inherits(Merge, _ToggleItem);

  var _super = _createSuper(Merge);

  function Merge() {
    _classCallCheck(this, Merge);

    return _super.call(this, 'merge');
  }

  _createClass(Merge, [{
    key: "setState",
    value: function setState(active, disabled) {
      this.el.active(active).disabled(disabled);
    }
  }]);

  return Merge;
}(toggle_item_ToggleItem);


// CONCATENATED MODULE: ./src/sheet/component/toolbar/redo.js





var redo_Redo = /*#__PURE__*/function (_IconItem) {
  _inherits(Redo, _IconItem);

  var _super = _createSuper(Redo);

  function Redo() {
    _classCallCheck(this, Redo);

    return _super.call(this, 'redo', 'Ctrl+Y');
  }

  return Redo;
}(icon_item_IconItem);


// CONCATENATED MODULE: ./src/sheet/component/toolbar/undo.js





var undo_Undo = /*#__PURE__*/function (_IconItem) {
  _inherits(Undo, _IconItem);

  var _super = _createSuper(Undo);

  function Undo() {
    _classCallCheck(this, Undo);

    return _super.call(this, 'undo', 'Ctrl+Z');
  }

  return Undo;
}(icon_item_IconItem);


// CONCATENATED MODULE: ./src/sheet/component/toolbar/print.js





var print_Print = /*#__PURE__*/function (_IconItem) {
  _inherits(Print, _IconItem);

  var _super = _createSuper(Print);

  function Print() {
    _classCallCheck(this, Print);

    return _super.call(this, 'print', 'Ctrl+P');
  }

  return Print;
}(icon_item_IconItem);


// CONCATENATED MODULE: ./src/sheet/component/toolbar/textwrap.js





var textwrap_Textwrap = /*#__PURE__*/function (_ToggleItem) {
  _inherits(Textwrap, _ToggleItem);

  var _super = _createSuper(Textwrap);

  function Textwrap() {
    _classCallCheck(this, Textwrap);

    return _super.call(this, 'textwrap');
  }

  return Textwrap;
}(toggle_item_ToggleItem);


// CONCATENATED MODULE: ./src/sheet/component/file_item.js






var file_item_FileItem = /*#__PURE__*/function (_Element) {
  _inherits(FileItem, _Element);

  var _super = _createSuper(FileItem);

  function FileItem() {
    _classCallCheck(this, FileItem);

    return _super.call(this, 'input', "".concat(cssPrefix, "-input-file"));
  }

  return FileItem;
}(element_Element);


// EXTERNAL MODULE: ./src/luckyexcel.cjs.js
var luckyexcel_cjs = __webpack_require__("e021");
var luckyexcel_cjs_default = /*#__PURE__*/__webpack_require__.n(luckyexcel_cjs);

// CONCATENATED MODULE: ./src/sheet/transfrom/luckysheetTransfromToSpreadSheet.js

















// tr: number | undefined //Text rotation,0: 0、1: 45 、2: -45、3 Vertical text、4: 90 、5: -90, alignment
// tb: number | undefined //Text wrap,0 truncation, 1 overflow, 2 word wrap, alignment
var parseOther = function parseOther(style, cellStyle) {
  // 单元格背景
  if (cellStyle.bg) {
    style.bgcolor = cellStyle.bg;
  }

  if (cellStyle.tb) {
    style.textwrap = cellStyle.tb === 2 ? true : false;
  }

  if (cellStyle.fa) {
    style.format = cellStyle.fa;
  }

  if (cellStyle.cl) {
    style.strike = cellStyle.cl;
  }

  if (cellStyle.un) {
    style.underline = cellStyle.un;
  }
};

var parseFont = function parseFont(style, cellStyle) {
  // ff:string | undefined //font family
  // fc:string | undefined//font color
  // fs:number | undefined//font size
  // cl:number | undefined//strike
  // un:number | undefined//underline
  // bl:number | undefined//blod
  // it:number | undefined//italic
  if (cellStyle.fc) {
    style.color = cellStyle.fc;
  }

  if (cellStyle.ff) {
    var _style$font;

    var font = (_style$font = style.font) !== null && _style$font !== void 0 ? _style$font : {};
    style.font = font;
    font.name = cellStyle.ff;
  }

  if (cellStyle.fs) {
    var _style$font2;

    var _font = (_style$font2 = style.font) !== null && _style$font2 !== void 0 ? _style$font2 : {};

    style.font = _font;
    _font.size = cellStyle.fs;
  }

  if (cellStyle.it) {
    var _style$font3;

    var _font2 = (_style$font3 = style.font) !== null && _style$font3 !== void 0 ? _style$font3 : {};

    style.font = _font2;
    _font2.italic = cellStyle.it;
  }

  if (cellStyle.bl) {
    var _style$font4;

    var _font3 = (_style$font4 = style.font) !== null && _style$font4 !== void 0 ? _style$font4 : {};

    style.font = _font3;
    _font3.bold = cellStyle.bl;
  }
}; // vt: number | undefined//Vertical alignment, 0 middle, 1 up, 2 down, alignment
// ht: number | undefined//Horizontal alignment,0 center, 1 left, 2 right, alignment


var parseHorAlign = function parseHorAlign(style, cellStyle) {
  if (typeof cellStyle.ht !== 'undefined') {
    switch (cellStyle.ht) {
      case 0:
        style.align = 'center';
        break;

      case 1:
        style.align = 'left';
        break;

      case 2:
        style.align = 'right';
        break;

      default:
        style.align = 'left';
        break;
    }
  }
};

var parseVerAlign = function parseVerAlign(style, cellStyle) {
  if (typeof cellStyle.vt !== 'undefined') {
    switch (cellStyle.vt) {
      case 0:
        style.valign = 'middle';
        break;

      case 1:
        style.valign = 'top';
        break;

      default:
        style.valign = 'bottom';
        break;
    }
  } else {
    style.valign = 'bottom';
  }
};

var luckysheetTransfromToSpreadSheet_parseFormat = function parseFormat(style, cellStyle) {
  var _cellStyle$ct;

  if ((_cellStyle$ct = cellStyle.ct) !== null && _cellStyle$ct !== void 0 && _cellStyle$ct.fa) {
    var _cellStyle$ct2;

    var fa = (_cellStyle$ct2 = cellStyle.ct) === null || _cellStyle$ct2 === void 0 ? void 0 : _cellStyle$ct2.fa;

    if (fa.indexOf('0.00') === 0) {
      style.format = 'number';

      if (fa.indexOf('￥')) {
        style.format = 'rmb';
      }

      var nums = fa.match(/.(0){1,10}/g);
      style.precision = Math.max.apply(Math, _toConsumableArray(nums.map(function (o) {
        return o.length - 1;
      }))); // 精度设置

      if (fa.indexOf('0_') >= 0) {
        style.isSeparator = true;
      }
    } else if (fa.indexOf('年') > -1 && fa.indexOf('日') > -1) {
      style.format = 'datelong';
    } else if (fa.indexOf('yyyy/m/d') > -1 && fa.indexOf('h:mm:ss') > -1) {
      style.format = 'datetime';
    } else if (fa.indexOf('yyyy/m/d') > -1) {
      style.format = 'date';
    } else if (fa.indexOf('h:mm:ss') > -1) {
      style.format = 'time';
    } else if (fa.indexOf('?/?') > -1) {
      style.format = 'percent';
    } else {
      style.format = 'normal';
    }
  }
};

var parseBorder = function parseBorder(style, borderStyle) {
  if (!borderStyle) {
    return;
  }

  var border = {};
  var borderType = [{
    key: 'l',
    map: 'left'
  }, {
    key: 'r',
    map: 'right'
  }, {
    key: 't',
    map: 'top'
  }, {
    key: 'b',
    map: 'bottom'
  }];

  var borderMatch = function borderMatch(border) {
    if (!border) {
      return;
    } else if (border.style === 0) {
      return;
    } else if (border.style === 1 || border.style === 2) {
      return ['thin', border.color];
    } else if (border.style === 3 || border.style === 5) {
      return ['dotted', border.color];
    } else if (border.style === 4 || border.style === 12) {
      return ['dashed', border.color];
    } else if (border.style === 8 || border.style === 9 || border.style === 10 || border.style === 11) {
      return ['medium', border.color];
    } else if (border.style === 13) {
      return ['thick', border.color];
    } else if (border.style === 7) {
      return ['double', border.color];
    }
  };

  borderType.forEach(function (i) {
    var matchStyle = borderMatch(borderStyle[i.key]);

    if (matchStyle) {
      border[i.map] = matchStyle;
    }
  });

  if (JSON.stringify(border) !== '{}') {
    style.border = border;
  }
}; // const numFmtDefault = {
//   '0': 'General',
//   '1': '0',
//   '2': '0.00',
//   '3': '#,##0',
//   '4': '#,##0.00',
//   '9': '0%',
//   '10': '0.00%',
//   '11': '0.00E+00',
//   '12': '# ?/?',
//   '13': '# ??/??',
//   '14': 'm/d/yy',
//   '15': 'd-mmm-yy',
//   '16': 'd-mmm',
//   '17': 'mmm-yy',
//   '18': 'h:mm AM/PM',
//   '19': 'h:mm:ss AM/PM',
//   '20': 'h:mm',
//   '21': 'h:mm:ss',
//   '22': 'm/d/yy h:mm',
//   '37': '#,##0 ;(#,##0)',
//   '38': '#,##0 ;[Red](#,##0)',
//   '39': '#,##0.00;(#,##0.00)',
//   '40': '#,##0.00;[Red](#,##0.00)',
//   '45': 'mm:ss',
//   '46': '[h]:mm:ss',
//   '47': 'mmss.0',
//   '48': '##0.0E+0',
//   '49': '@'
// };
//
// function format(fmt, v, o) {
//   if (o == null) o = {};
//   var sfmt = '';
//   switch (typeof fmt) {
//     case 'string':
//       if (fmt == 'm/d/yy' && o.dateNF) sfmt = o.dateNF;
//       else sfmt = fmt;
//       break;
//     case 'number':
//       if (fmt == 14 && o.dateNF) sfmt = o.dateNF;
//       else sfmt = (o.table != null ? o.table : table_fmt)[fmt];
//       if (sfmt == null) sfmt = (o.table && o.table[default_map[fmt]]) || table_fmt[default_map[fmt]];
//       if (sfmt == null) sfmt = default_str[fmt] || 'General';
//       break;
//   }
//
//   //new runze 增加万 亿 格式
//   //注："w":2万2500  "w0":2万2500  "w0.0":2万2500.2  "w0.00":2万2500.23......自定义精确度
//   var reg = /^(w|W)((0?)|(0\.0+))$/;
//   if (sfmt.match(reg)) {
//     if (isNaN(v)) {
//       return v;
//     }
//
//     //var v =300101886.436;
//     var acc = sfmt.slice(1); //取得0/0.0/0.00
//     var isNegative = false;
//     if (!isNaN(v) && Number(v) < 0) {
//       isNegative = true;
//       v = Math.abs(v);
//     }
//     var vInt = parseInt(v);
//
//     var vlength = vInt.toString().length;
//     if (vlength > 4) {
//       if (vlength > 8) {
//         var y = parseInt(v / 100000000); //亿
//         var w = parseInt(parseFloat(v).subtract(y * 100000000) / 10000); //万
//         var q = parseFloat(v).subtract(y * 100000000 + w * 10000); //千以后
//         if (acc != '') {
//           q = numeral(q).format(acc); //处理精确度
//         }
//         v = y + '亿' + w + '万' + q;
//       } else {
//         var w = parseInt(v / 10000); //万
//         var q = parseFloat(v).subtract(w * 10000); //千以后
//         if (acc != '') {
//           q = numeral(q).format(acc); //处理精确度
//         }
//         v = w + '万' + q;
//       }
//
//       if (v.indexOf('亿0万0') != -1) {
//         v = v.replace('0万0', '');
//       } else if (v.indexOf('亿0万') != -1) {
//         v = v.replace('0万', '');
//       } else if (v.indexOf('万0') != -1) {
//         v = v.replace('万0', '万');
//       }
//
//       //舍弃正则后顾断言写法，旧浏览器不识别（360 V9）
//       if (v.indexOf('亿') != -1 && v.indexOf('万') == -1) {
//         //1亿/1亿111 => 1亿/1亿0111
//         var afterYi = v.substring(v.indexOf('亿') + 1);
//         if (afterYi.substring(0, 1) !== '.' && afterYi != '') {
//           switch ((parseInt(afterYi) + '').length) {
//             case 1:
//               afterYi = '000' + afterYi;
//               break;
//             case 2:
//               afterYi = '00' + afterYi;
//               break;
//             case 3:
//               afterYi = '0' + afterYi;
//               break;
//           }
//           v = v.substring(0, v.indexOf('亿') + 1) + afterYi;
//         }
//       } else if (v.indexOf('亿') == -1 && v.indexOf('万') != -1) {
//         //3万0011
//         var afterWan = v.substring(v.indexOf('万') + 1);
//         if (afterWan.substring(0, 1) !== '.' && afterWan != '') {
//           switch ((parseInt(afterWan) + '').length) {
//             case 1:
//               afterWan = '000' + afterWan;
//               break;
//             case 2:
//               afterWan = '00' + afterWan;
//               break;
//             case 3:
//               afterWan = '0' + afterWan;
//               break;
//           }
//           v = v.substring(0, v.indexOf('万') + 1) + afterWan;
//         }
//       } else if (v.indexOf('亿') != -1 && v.indexOf('万') != -1) {
//         //1亿0053万0611
//         var afterYi = v.substring(v.indexOf('亿') + 1, v.indexOf('万')),
//           afterWan = v.substring(v.indexOf('万') + 1);
//
//         switch ((parseInt(afterYi) + '').length) {
//           case 1:
//             afterYi = '000' + afterYi;
//             break;
//           case 2:
//             afterYi = '00' + afterYi;
//             break;
//           case 3:
//             afterYi = '0' + afterYi;
//             break;
//         }
//         v = v.substring(0, v.indexOf('亿') + 1) + afterYi + v.substring(v.indexOf('万'));
//
//         if (afterWan.substring(0, 1) !== '.' && afterWan != '') {
//           switch ((parseInt(afterWan) + '').length) {
//             case 1:
//               afterWan = '000' + afterWan;
//               break;
//             case 2:
//               afterWan = '00' + afterWan;
//               break;
//             case 3:
//               afterWan = '0' + afterWan;
//               break;
//           }
//           v = v.substring(0, v.indexOf('万') + 1) + afterWan;
//         }
//       }
//     } else {
//       if (acc != '') {
//         v = numeral(v).format(acc); //处理精确度
//       }
//     }
//     if (isNegative) {
//       return '-' + v;
//     } else {
//       return v;
//     }
//   }
//
//   if (isgeneral(sfmt, 0)) return general_fmt(v, o);
//   if (v instanceof Date) v = datenum_local(v, o.date1904);
//   var f = choose_fmt(sfmt, v);
//   if (isgeneral(f[1])) return general_fmt(v, o);
//   if (v === true) v = 'TRUE';
//   else if (v === false) v = 'FALSE';
//   else if (v === '' || v == null) return '';
//   return eval_fmt(f[1], v, o, f[0]);
// }
//
// const excelColStrToNum = function(colStr) {
//   let colIndex = 0;
//
//   for (let i = 0; i < colStr.length; i += 1) {
//     const index = colStr.charCodeAt(i);
//     colIndex = colIndex + (index - 64);
//   }
//
//   return colIndex;
// };


var excelColIndexToStr = function excelColIndexToStr(colIndex) {
  if (isNaN(colIndex) || colIndex < 0) {
    return null;
  }

  var ordA = 'A'.charCodeAt(0);
  var ordZ = 'Z'.charCodeAt(0);
  var len = ordZ - ordA + 1;
  var colStr = '';

  while (colIndex >= 0) {
    colStr = String.fromCharCode(colIndex % len + ordA) + colStr;
    colIndex = Math.floor(colIndex / len) - 1;
  }

  return colStr;
};

var sheetToConfig = function sheetToConfig(sheet) {
  var minRowLen = 100; // 默认最小行数

  var minColLen = 26; // 默认最小列数

  var maxRowLen = 5000; // 默认最大行数

  var maxColLen = 1000; // 默认最大列数

  var tempRow = {};
  var tempCol = {};
  var rowLen = 0;
  var colLen = 0;
  sheet.celldata.forEach(function (item) {
    var r = item.r + 1,
        c = item.c + 1;
    rowLen = r > rowLen ? r : rowLen;
    colLen = c > colLen ? c : colLen;
  });
  tempRow.height = sheet.defaultRowHeight;
  tempCol.width = sheet.defaultColWidth;

  if (rowLen >= minRowLen && rowLen <= maxRowLen) {
    tempRow.len = rowLen;
  } else if (rowLen < minRowLen) {
    tempRow.len = minRowLen;
  } else if (rowLen > maxRowLen) {
    tempRow.len = maxRowLen;
  }

  if (colLen >= minColLen && colLen <= maxColLen) {
    tempCol.len = colLen;
  } else if (colLen < minColLen) {
    tempCol.len = minColLen;
  } else if (colLen > maxColLen) {
    tempCol.len = maxColLen;
  }

  return {
    row: tempRow,
    col: tempCol
  };
};

var transMergeData = function transMergeData(sheet) {
  var _sheet$config;

  var merge = ((_sheet$config = sheet.config) === null || _sheet$config === void 0 ? void 0 : _sheet$config.merge) || {};
  var tempMerges = Object.keys(merge).map(function (key) {
    var item = merge[key];
    /**
     * 由于x-spreadsheet的merge字段的行和列的下标1开始，而luckyexcel读取的merge字段的行和列的下标是从0开始。
     *  同时colTrans将列的字母和下标相互转化时也从0开始。
     */

    return "".concat(excelColIndexToStr(item.c)).concat(item.r + 1, ":").concat(excelColIndexToStr(item.c + item.cs - 1)).concat(item.r + item.rs);
  });
  return tempMerges;
};

var transStyle = function transStyle() {
  var styles = [];
  var styleStrs = [];
  return {
    getStyles: function getStyles() {
      return styles;
    },
    getStylesIndex: function getStylesIndex(cellStyle, borderStyle) {
      var style = this.transStyle(cellStyle, borderStyle);
      var styleStr = JSON.stringify(style);
      var styleStrIndex = styleStrs.findIndex(function (item) {
        return item === styleStr;
      });

      if (styleStrIndex < 0) {
        this.setStyle(style);
      }

      styleStrIndex = styleStrs.findIndex(function (item) {
        return item === styleStr;
      });
      return styleStrIndex;
    },
    setStyle: function setStyle(style) {
      styles.push(style);
      styleStrs.push(JSON.stringify(style));
    },
    transStyle: function transStyle(cellStyle, borderStyle) {
      var style = {};
      parseOther(style, cellStyle);
      parseFont(style, cellStyle);
      parseHorAlign(style, cellStyle);
      parseVerAlign(style, cellStyle);
      luckysheetTransfromToSpreadSheet_parseFormat(style, cellStyle);
      parseBorder(style, borderStyle);
      return style;
    }
  };
};
/**
 * 将luckyexcel读取的数据格式转换为x-spreadsheet的数据格式。
 * x-spreadsheet的格式可以从data_proxy的getData()方法获取
 * @param {*} sheet
 */


var luckysheetTransfromToSpreadSheet_parseCellData = function parseCellData(sheet) {
  var _sheet$config2, _sheet$config3, _sheet$config4, _sheet$config5;

  var tempRows = {};
  var tempCols = {};
  var tempStyles = {};
  var styleOpea = transStyle();
  var cellData = sheet.celldata;
  var merge = ((_sheet$config2 = sheet.config) === null || _sheet$config2 === void 0 ? void 0 : _sheet$config2.merge) || {};
  var columnlen = ((_sheet$config3 = sheet.config) === null || _sheet$config3 === void 0 ? void 0 : _sheet$config3.columnlen) || {};
  var rowlen = ((_sheet$config4 = sheet.config) === null || _sheet$config4 === void 0 ? void 0 : _sheet$config4.rowlen) || {};
  var borderInfo = ((_sheet$config5 = sheet.config) === null || _sheet$config5 === void 0 ? void 0 : _sheet$config5.borderInfo) || [];
  var showGrid = sheet.showGridLines === '0' ? false : true;
  var freeze = sheet.freeze;
  var mark = {};

  for (var mergeKey in merge) {
    for (var i = merge[mergeKey].r; i <= merge[mergeKey].rs; i++) {
      for (var j = merge[mergeKey].c; j <= merge[mergeKey].cs; j++) {
        mark[i + '_' + j] = true;
      }
    }

    mark[merge[mergeKey].r + '_' + merge[mergeKey].c] = false;
  }

  var cellDataMark = {};
  cellData.forEach(function (item) {
    cellDataMark[item.r + '_' + item.c] = item;
    var row = tempRows[item.r] || {};
    tempRows[item.r] = row;
    /**
     * 获取行高度
     */

    if (rowlen[item.r] && !row.height) {
      row.height = rowlen[item.r];
    }

    var cells = row.cells || {};
    row.cells = cells;
    cells[item.c] = {}; // 富文本解析

    if (!item.v.v && item.v.ct) {
      var s = item.v.ct.s;

      if (s != null) {
        var text = '';

        for (var _i = 0; _i < s.length; _i++) {
          text += s[_i].v;
        }

        cells[item.c].text = text;
      }
    } // 公式


    if (item.v.f) {
      cells[item.c].text = item.v.f; // cells[item.c].value = item.v?.v || '';
    } else {
      if (typeof item.v.v !== 'undefined') cells[item.c].text = item.v.v;
    }
    /**
     * 获取单元格合并merge属性
     */


    var mergeKey = "".concat(item.r, "_").concat(item.c);

    if (mergeKey in merge) {
      var mergeData = merge[mergeKey];
      /**
       * x-spreadsheet的单元格的merge属性表示的是从单元格继续合并几个单元格；
       * 而luckyexcel单元格的merge表示的是当前单元格开始共合并了几个单元格；
       * 所以luckyexcel会比x-spreadsheet的行和列都多1。
       */

      cells[item.c].merge = [mergeData.rs - 1, mergeData.cs - 1];
    }
    /**
     * 获取style序号
     */


    var border = borderInfo.find(function (borderItem) {
      return borderItem.value.col_index === item.c && borderItem.value.row_index === item.r;
    });
    var styleIndx = styleOpea.getStylesIndex(item.v, border === null || border === void 0 ? void 0 : border.value);
    cells[item.c].style = styleIndx;
    /**
     * cols属性获取
     */

    if (columnlen[item.c]) {
      tempCols[item.c] = {
        width: columnlen[item.c]
      };
    }
  });
  /***
   * 导入样式差异
   */

  tempStyles = styleOpea.getStyles();

  for (var _mergeKey in merge) {
    for (var _i2 = merge[_mergeKey].r; _i2 < merge[_mergeKey].rs; _i2++) {
      for (var _j = merge[_mergeKey].c; _j < merge[_mergeKey].cs; _j++) {
        if (mark[merge[_mergeKey].r + '_' + merge[_mergeKey].c] === false) {
          var _tempRows$_i, _tempStyles$cells$_j$, _cells$_j;

          var originStyle = tempRows[merge[_mergeKey].r].cells[merge[_mergeKey].c].style;
          var cells = ((_tempRows$_i = tempRows[_i2]) === null || _tempRows$_i === void 0 ? void 0 : _tempRows$_i.cells) || {};
          tempStyles[originStyle].border = _objectSpread2(_objectSpread2({}, tempStyles[originStyle].border), ((_tempStyles$cells$_j$ = tempStyles[(_cells$_j = cells[_j]) === null || _cells$_j === void 0 ? void 0 : _cells$_j.style]) === null || _tempStyles$cells$_j$ === void 0 ? void 0 : _tempStyles$cells$_j$.border) || {});
        }
      }
    }
  }

  return {
    tempRows: tempRows,
    tempCols: tempCols,
    tempStyles: tempStyles,
    showGrid: showGrid,
    freeze: freeze
  };
};

var parseComments = function parseComments(comments) {
  var mark = {};

  if (comments) {
    comments.forEach(function (o) {
      mark["".concat(o.ref)] = o.rows;
    });
  }

  return mark;
};

function htmlDecode(text) {
  var temp = document.createElement('div');
  temp.innerHTML = text;
  var output = temp.innerText || temp.textContent;
  temp = null;
  return output;
}

var luckysheetTransfromToSpreadSheet_parse = function parse(luckyExcel) {
  var spreadData = luckyExcel.sheets.map(function (sheet) {
    var merges = transMergeData(sheet);
    var tempData = luckysheetTransfromToSpreadSheet_parseCellData(sheet);
    var comments = parseComments(sheet.comments);
    var config = sheetToConfig(sheet);
    tempData.tempCols.len = config.col.len;

    var sheetData = _objectSpread2({
      merges: merges,
      rows: tempData.tempRows,
      styles: tempData.tempStyles,
      cols: tempData.tempCols,
      showGrid: tempData.showGrid,
      freeze: tempData.freeze,
      name: htmlDecode(sheet.name),
      comments: comments
    }, config);

    if (!sheetData.freeze) {
      delete sheetData.freeze;
    }

    return sheetData;
  }); // console.log(spreadData);

  return spreadData;
};
/* harmony default export */ var luckysheetTransfromToSpreadSheet = ({
  parse: luckysheetTransfromToSpreadSheet_parse
});
// CONCATENATED MODULE: ./src/sheet/component/toolbar/import.js















var import_Import = /*#__PURE__*/function (_Item) {
  _inherits(Import, _Item);

  var _super = _createSuper(Import);

  function Import() {
    _classCallCheck(this, Import);

    return _super.call(this, 'import');
  }

  _createClass(Import, [{
    key: "element",
    value: function element() {
      var _this = this;

      var fileItem = new file_item_FileItem();
      fileItem.attr('type', 'file').on('change', function (evt) {
        var files = evt.target.files;

        if (files == null || files.length == 0) {
          alert('No files wait for import');
          return;
        }

        var name = files[0].name;
        var suffixArr = name.split('.'),
            suffix = suffixArr[suffixArr.length - 1];

        if (suffix != 'xlsx') {
          alert('Currently only supports the import of xlsx files');
          return;
        } // eslint-disable-next-line no-undef


        luckyexcel_cjs_default.a.transformExcelToLucky(files[0], function (exportJson) {
          if (exportJson.sheets == null || exportJson.sheets.length == 0) {
            alert('Failed to read the content of the excel file, currently does not support xls files!');
            return;
          } // debugger;


          var spreadData = luckysheetTransfromToSpreadSheet_parse(exportJson);

          _this.change(_this.tag, spreadData); // console.log(exportJson);
          // this.click(exportJson)

        });
      });
      return get_get(_getPrototypeOf(Import.prototype), "element", this).call(this).child(new icon_Icon(this.tag)).child(fileItem);
    }
  }, {
    key: "getValue",
    value: function getValue(it) {
      return it.key;
    }
  }]);

  return Import;
}(item_Item);


// CONCATENATED MODULE: ./src/sheet/component/toolbar/export.js






var export_Export = /*#__PURE__*/function (_ToggleItem) {
  _inherits(Export, _ToggleItem);

  var _super = _createSuper(Export);

  function Export() {
    _classCallCheck(this, Export);

    return _super.call(this, 'export');
  }

  _createClass(Export, [{
    key: "getValue",
    value: function getValue(it) {
      return it.key;
    }
  }]);

  return Export;
}(toggle_item_ToggleItem);


// CONCATENATED MODULE: ./src/sheet/component/toolbar/iconfont_item.js









var iconfont_item_IconfontItem = /*#__PURE__*/function (_Item) {
  _inherits(IconfontItem, _Item);

  var _super = _createSuper(IconfontItem);

  function IconfontItem() {
    _classCallCheck(this, IconfontItem);

    return _super.apply(this, arguments);
  }

  _createClass(IconfontItem, [{
    key: "element",
    value: function element() {
      var _this = this;

      return get_get(_getPrototypeOf(IconfontItem.prototype), "element", this).call(this).child(new iconfont_Iconfont(this.tag)).on('click', function () {
        return _this.change(_this.tag);
      });
    }
  }, {
    key: "click",
    value: function click() {
      this.change(this.tag);
    }
  }, {
    key: "setState",
    value: function setState(disabled) {
      this.el.disabled(disabled);
    }
  }]);

  return IconfontItem;
}(item_Item);


// CONCATENATED MODULE: ./src/sheet/component/toolbar/lookUp.js





var lookUp_LookUp = /*#__PURE__*/function (_IconfontItem) {
  _inherits(LookUp, _IconfontItem);

  var _super = _createSuper(LookUp);

  function LookUp() {
    _classCallCheck(this, LookUp);

    return _super.call(this, 'lookUp', 'Ctrl+F');
  }

  return LookUp;
}(iconfont_item_IconfontItem);


// CONCATENATED MODULE: ./src/sheet/component/toolbar/indentDec.js





var indentDec_IndentDec = /*#__PURE__*/function (_IconItem) {
  _inherits(IndentDec, _IconItem);

  var _super = _createSuper(IndentDec);

  function IndentDec() {
    _classCallCheck(this, IndentDec);

    return _super.call(this, 'indent-dec', '');
  }

  return IndentDec;
}(icon_item_IconItem);


// CONCATENATED MODULE: ./src/sheet/component/toolbar/indentAdd.js





var indentAdd_IndentAdd = /*#__PURE__*/function (_IconItem) {
  _inherits(IndentAdd, _IconItem);

  var _super = _createSuper(IndentAdd);

  function IndentAdd() {
    _classCallCheck(this, IndentAdd);

    return _super.call(this, 'indent-add', '');
  }

  return IndentAdd;
}(icon_item_IconItem);


// CONCATENATED MODULE: ./src/sheet/component/toolbar/more.js










var more_DropdownMore = /*#__PURE__*/function (_Dropdown) {
  _inherits(DropdownMore, _Dropdown);

  var _super = _createSuper(DropdownMore);

  function DropdownMore() {
    var _this;

    _classCallCheck(this, DropdownMore);

    var icon = new icon_Icon('ellipsis');
    var moreBtns = element_h('div', "".concat(cssPrefix, "-toolbar-more"));
    _this = _super.call(this, icon, null, 'auto', false, 'bottom-right', moreBtns);
    _this.moreBtns = moreBtns;

    _this.contentEl.css('max-width', '420px');

    return _this;
  }

  return DropdownMore;
}(dropdown_Dropdown);

var more_More = /*#__PURE__*/function (_DropdownItem) {
  _inherits(More, _DropdownItem);

  var _super2 = _createSuper(More);

  function More() {
    var _this2;

    _classCallCheck(this, More);

    _this2 = _super2.call(this, 'more');

    _this2.el.hide();

    return _this2;
  }

  _createClass(More, [{
    key: "dropdown",
    value: function dropdown() {
      return new more_DropdownMore();
    }
  }, {
    key: "show",
    value: function show() {
      this.el.show();
    }
  }, {
    key: "hide",
    value: function hide() {
      this.el.hide();
    }
  }]);

  return More;
}(dropdown_item_DropdownItem);


// CONCATENATED MODULE: ./src/sheet/component/toolbar/fn.js





var fn_Item = /*#__PURE__*/function () {
  function Item() {
    _classCallCheck(this, Item);

    this.el = this.element();

    this.change = function () {};

    this.confirm = function () {};

    this.openFunctions = function () {};

    this.bakText = null;
    this.newText = null;
  }

  _createClass(Item, [{
    key: "element",
    value: function element() {
      var _this = this;

      this.selectorInput = element_h('div', "".concat(cssPrefix, "-toolbar-selector formula-bar-item"));
      this.formulaInput = element_h('input', "".concat(cssPrefix, "-toolbar-formula formula-bar-item")).on('input', function (evt) {
        _this.newText = evt.target.value;

        _this.change(evt.target.value);

        _this.setDisable(false);
      });
      this.setState();
      this.confirms = element_h('span', "icon spread-sheet icon-confirm").on('click', function () {
        _this.change(_this.newText);

        _this.setText(_this.newText);

        _this.bakText = _this.newText;

        _this.setDisable(true);
      });
      this.cancel = element_h('span', "icon spread-sheet icon-cancel").on('click', function () {
        _this.change(_this.bakText);

        _this.setText(_this.bakText);

        _this.setDisable(true);
      });
      this.functions = element_h('span', "icon spread-sheet icon-function").on('click', function () {
        _this.openFunctions(_this.bakText);
      }).disabled(true);
      return element_h('div', "".concat(cssPrefix, "-toolbar-fn")).children(this.selectorInput, element_h('div', "".concat(cssPrefix, "-toolbar-fn-btns formula-bar-item")).children(this.confirms, this.cancel, this.functions), this.formulaInput);
    }
  }, {
    key: "setState",
    value: function setState() {
      var selector = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {
        ref: ''
      };
      var text = arguments.length > 1 ? arguments[1] : undefined;
      var ref = selector.ref;
      this.selectorInput.html(ref);
      this.setText(text, true);
      this.setDisable(true);
    }
  }, {
    key: "setText",
    value: function setText(text, init) {
      text = text === undefined ? null : text;

      if (!init) {
        this.setDisable(false);
      } else {
        this.bakText = text;
      }

      this.newText = text;
      this.formulaInput.val(text);
    }
  }, {
    key: "setDisable",
    value: function setDisable(disabled) {
      if (this.cancel) {
        this.cancel.disabled(disabled);
        this.confirms.disabled(disabled);
      }
    }
  }]);

  return Item;
}();


// CONCATENATED MODULE: ./src/sheet/component/toolbar/index.js













































function buildDivider() {
  return element_h('div', "".concat(cssPrefix, "-toolbar-divider"));
}

function initBtns2() {
  var _this = this;

  this.btns2 = [];
  this.items.forEach(function (it) {
    if (Array.isArray(it)) {
      it.forEach(function (_ref) {
        var el = _ref.el;
        var rect = el.box();

        var _el$computedStyle = el.computedStyle(),
            marginLeft = _el$computedStyle.marginLeft,
            marginRight = _el$computedStyle.marginRight;

        _this.btns2.push([el, rect.width + parseInt(marginLeft, 10) + parseInt(marginRight, 10)]);
      });
    } else {
      var rect = it.box();

      var _it$computedStyle = it.computedStyle(),
          marginLeft = _it$computedStyle.marginLeft,
          marginRight = _it$computedStyle.marginRight;

      _this.btns2.push([it, rect.width + parseInt(marginLeft, 10) + parseInt(marginRight, 10)]);
    }
  });
}

function moreResize() {
  var _btns$html, _moreBtns$html;

  var el = this.el,
      btns = this.btns,
      moreEl = this.moreEl,
      btns2 = this.btns2;
  var _moreEl$dd = moreEl.dd,
      moreBtns = _moreEl$dd.moreBtns,
      contentEl = _moreEl$dd.contentEl;
  el.css('width', "".concat(this.widthFn() - 60, "px"));
  var elBox = el.box();
  if (!btns2) return;
  var sumWidth = 160;
  var sumWidth2 = 12;
  var list1 = [];
  var list2 = [];
  btns2.forEach(function (_ref2, index) {
    var _ref3 = _slicedToArray(_ref2, 2),
        it = _ref3[0],
        w = _ref3[1];

    sumWidth += w;

    if (index === btns2.length - 1 || sumWidth < elBox.width) {
      list1.push(it);
    } else {
      sumWidth2 += w;
      list2.push(it);
    }
  });

  (_btns$html = btns.html('')).children.apply(_btns$html, list1);

  (_moreBtns$html = moreBtns.html('')).children.apply(_moreBtns$html, list2);

  contentEl.css('width', "".concat(sumWidth2, "px"));

  if (list2.length > 0) {
    moreEl.show();
  } else {
    moreEl.hide();
  }
}

function genBtn(it) {
  var _this2 = this;

  var btn = new item_Item();
  btn.el.on('click', function () {
    if (it.onClick) it.onClick(_this2.data.getData(), _this2.data);
  });
  btn.tip = it.tip || '';
  var el = it.el;

  if (it.icon) {
    el = element_h('img').attr('src', it.icon);
  }

  if (el) {
    var icon = element_h('div', "".concat(cssPrefix, "-icon"));
    icon.child(el);
    btn.el.child(icon);
  }

  if (it !== null && it !== void 0 && it.iconfont) {
    var _icon = new iconfont_Iconfont(it.iconfont);

    btn.el.child(_icon);
  }

  return btn;
}

var toolbar_Toolbar = /*#__PURE__*/function () {
  function Toolbar(data, widthFn) {
    var _this3 = this;

    var isHide = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;

    _classCallCheck(this, Toolbar);

    this.data = data;

    this.change = function () {};

    this.widthFn = widthFn;
    this.isHide = isHide;
    var style = data.defaultStyle();
    var tools = {
      Undo: this.undoEl = new undo_Undo(),
      Redo: this.redoEl = new redo_Redo(),
      Print: new print_Print(),
      Import: new import_Import(),
      Export: new export_Export(),
      Paintformat: this.paintformatEl = new paintformat_Paintformat(),
      Clearformat: this.clearformatEl = new clearformat_Clearformat(),
      Format: this.formatEl = new format_Format(),
      Font: this.fontEl = new font_Font(),
      FontSize: this.fontSizeEl = new font_size_Format(),
      Bold: this.boldEl = new bold_Bold(),
      Italic: this.italicEl = new italic_Italic(),
      Underline: this.underlineEl = new underline_Underline(),
      Strike: this.strikeEl = new strike_Strike(),
      TextColor: this.textColorEl = new text_color_TextColor(style.color),
      FillColor: this.fillColorEl = new fill_color_FillColor(style.bgcolor),
      Border: this.borderEl = new border_Border(),
      Merge: this.mergeEl = new merge_Merge(),
      IndentDec: this.indentDecEl = new indentDec_IndentDec(),
      IndentAdd: this.indentAddEl = new indentAdd_IndentAdd(),
      Align: this.alignEl = new align_Align(style.align),
      Valign: this.valignEl = new valign_Valign(style.valign),
      Textwrap: this.textwrapEl = new textwrap_Textwrap(),
      Freeze: this.freezeEl = new freeze_Freeze(),
      Autofilter: this.autofilterEl = new autofilter_Autofilter(),
      Formula: this.formulaEl = new formula_Format(),
      LookUp: this.lookUpEl = new lookUp_LookUp(),
      Slash: this.slashEl = new slash_Border(),
      buildDivider: buildDivider
    };
    var sortTools = ['Undo', 'Redo', 'Import', 'Export', 'Print', 'Paintformat', 'Clearformat', 'buildDivider', 'Format', 'buildDivider', 'Font', 'FontSize', 'buildDivider', 'Bold', 'Italic', 'Underline', 'Strike', 'TextColor', 'buildDivider', 'FillColor', 'Border', 'Merge', 'buildDivider', 'IndentDec', 'IndentAdd', 'buildDivider', 'Align', 'Valign', 'Textwrap', 'buildDivider', 'Freeze', 'Autofilter', 'Formula', 'buildDivider', 'LookUp', 'Slash'];
    var _data$settings$extend = data.settings.extendToolbar,
        extendToolbar = _data$settings$extend === void 0 ? {} : _data$settings$extend;

    for (var key in extendToolbar) {
      if (Object.hasOwnProperty.call(extendToolbar, key)) {
        var element = extendToolbar[key];

        if (key === 'sortTools') {
          sortTools = element;
        } else {
          tools[key] = genBtn.bind(this)(element);
        }
      }
    }

    this.items = sortTools.map(function (item) {
      if (item == 'buildDivider') {
        return tools[item]();
      }

      return [tools[item]];
    });
    this.items.push([this.moreEl = new more_More()]);
    this.el = element_h('div', "".concat(cssPrefix, "-toolbar"));
    this.btns = element_h('div', "".concat(cssPrefix, "-toolbar-btns"));
    this.fnTool = new fn_Item();
    this.items.forEach(function (it) {
      if (Array.isArray(it)) {
        it.forEach(function (i) {
          _this3.btns.child(i.el);

          i.change = function () {
            _this3.change.apply(_this3, arguments);
          };
        });
      } else {
        _this3.btns.child(it.el);
      }
    });
    this.el.children(this.btns, this.fnTool.el);

    if (isHide) {
      this.el.hide();
    } else {
      this.reset();
      setTimeout(function () {
        initBtns2.call(_this3);
        moreResize.call(_this3);
      }, 0);
    }

    this.moreResize = moreResize.bind(this);
  }

  _createClass(Toolbar, [{
    key: "paintformatActive",
    value: function paintformatActive() {
      return this.paintformatEl.active();
    }
  }, {
    key: "paintformatToggle",
    value: function paintformatToggle() {
      this.paintformatEl.toggle();
    }
  }, {
    key: "trigger",
    value: function trigger(type) {
      this["".concat(type, "El")].click();
    }
  }, {
    key: "resetData",
    value: function resetData(data) {
      this.data = data;
      this.reset();
    }
  }, {
    key: "reset",
    value: function reset() {
      if (this.isHide) return;
      var data = this.data;
      var style = data.getSelectedCellStyle();
      var selector = data.getSelectedValidation();
      var text = data.getSelectedCell(); // console.log('canUndo:', data.canUndo());

      this.undoEl.setState(!data.canUndo());
      this.redoEl.setState(!data.canRedo());
      this.mergeEl.setState(data.canUnmerge(), !data.selector.multiple());
      this.autofilterEl.setState(!data.canAutofilter()); // this.mergeEl.disabled();
      // console.log('selectedCell:', style, cell);

      var font = style.font,
          format = style.format;
      this.formatEl.setState(format);
      this.fontEl.setState(font.name);
      this.fontSizeEl.setState(font.size);
      this.boldEl.setState(font.bold);
      this.italicEl.setState(font.italic);
      this.underlineEl.setState(style.underline);
      this.strikeEl.setState(style.strike);
      this.textColorEl.setState(style.color);
      this.fillColorEl.setState(style.bgcolor);
      this.alignEl.setState(style.align);
      this.valignEl.setState(style.valign);
      this.textwrapEl.setState(style.textwrap);
      this.slashEl.setState(text && text.slash); // console.log('freeze is Active:', data.freezeIsActive());

      this.freezeEl.setState(data.freezeIsActive());
      this.fnTool.setState(selector, text && text.text);
    }
  }]);

  return Toolbar;
}();


// CONCATENATED MODULE: ./src/sheet/component/comment.js








 // import { bind } from './event';



function setFocus(el) {
  el.focus();
  var range = document.createRange();
  range.selectNodeContents(el);
  range.collapse(false);
  var sel = window.getSelection();

  if (sel.anchorOffset != 0) {
    return;
  }

  sel.removeAllRanges();
  sel.addRange(range);
}

var comment_Comment = /*#__PURE__*/function () {
  function Comment() {
    _classCallCheck(this, Comment);

    this.el = element_h('div', "".concat(cssPrefix, "-comment-container")).hide();
    this.arrow = element_h('div', "".concat(cssPrefix, "-comment-container__arrow ").concat(cssPrefix, "-comment-container__arrow--lc"));
    this.comment = element_h('div', "".concat(cssPrefix, "-comment-text"));
    this.editIng = false;

    this.change = function () {};
  }

  _createClass(Comment, [{
    key: "show",
    value: function show(data, cRect) {
      if (this.editIng) return;
      this.hide();
      this.clear();

      if (cRect.ri > -1 && cRect.ci >= 0) {
        var rows = data.getComment(cRect.ri, cRect.ci);

        if (rows) {
          this.comment.html(rows.map(function (it) {
            return it.text.replace(/\n/g, '<br/>');
          }).join('<br/>'));
          this.el.children(this.comment, this.arrow).show();
          this.setPosition(cRect);
        }
      }
    }
  }, {
    key: "hide",
    value: function hide() {
      this.el.hide();
    }
  }, {
    key: "setPosition",
    value: function setPosition(_ref) {
      var left = _ref.left,
          width = _ref.width,
          top = _ref.top;
      this.el.css('left', "".concat(left + width - 55, "px")).css('top', "".concat(top - 18, "px"));
    }
  }, {
    key: "clear",
    value: function clear() {
      this.comment.html('');
    }
  }, {
    key: "edit",
    value: function edit(data) {
      var _this = this;

      this.clear();
      this.editIng = true;
      var _data$selector$range = data.selector.range,
          sri = _data$selector$range.sri,
          sci = _data$selector$range.sci;
      var cRect = data.getRect(data.selector.range);
      var rows = data.getComment(sri, sci) || [{
        text: ''
      }];
      var editEl = this.comment.el;
      this.comment.html(rows.map(function (it) {
        return it.text.replace(/\n/g, '<br/>');
      }).join('<br/>')).attr('contenteditable', true);
      this.el.children(this.comment, this.arrow).show();
      this.setPosition(_objectSpread2(_objectSpread2({}, cRect), {}, {
        left: cRect.left + 60,
        top: cRect.top + 18
      }));
      setTimeout(function () {
        return setFocus(editEl);
      }, 10);

      editEl.onblur = function () {
        data.handlerComment('edit', sri, sci, editEl.innerText);
        _this.editIng = false;

        _this.comment.attr('contenteditable', false);

        _this.hide();
      };
    }
  }, {
    key: "delete",
    value: function _delete(data) {
      var _data$selector$range2 = data.selector.range,
          sri = _data$selector$range2.sri,
          sci = _data$selector$range2.sci;
      data.handlerComment('delete', sri, sci);
    }
  }]);

  return Comment;
}();


// CONCATENATED MODULE: ./src/sheet/component/button.js








var button_Button = /*#__PURE__*/function (_Element) {
  _inherits(Button, _Element);

  var _super = _createSuper(Button);

  // type: primary
  function Button(title) {
    var _this;

    var type = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';

    _classCallCheck(this, Button);

    _this = _super.call(this, 'div', "".concat(cssPrefix, "-button ").concat(type));

    _this.child(locale_t("button.".concat(title)));

    return _this;
  }

  return Button;
}(element_Element);


// CONCATENATED MODULE: ./src/sheet/component/sort_filter.js





















function sort_filter_buildMenu(clsName) {
  return element_h('div', "".concat(cssPrefix, "-item ").concat(clsName));
}

function buildSortItem(it) {
  var _this = this;

  return sort_filter_buildMenu('state').child(locale_t("sort.".concat(it))).on('click.stop', function () {
    return _this.itemClick(it);
  });
}

function buildFilterBody(items) {
  var _this2 = this;

  var filterbEl = this.filterbEl,
      filterValues = this.filterValues;
  filterbEl.html('');
  var itemKeys = Object.keys(items);
  itemKeys.forEach(function (it, index) {
    var cnt = items[it];
    var active = filterValues.includes(it) ? 'checked' : '';
    filterbEl.child(element_h('div', "".concat(cssPrefix, "-item state ").concat(active)).on('click.stop', function () {
      return _this2.filterClick(index, it);
    }).children(it === '' ? locale_t('filter.empty') : it, element_h('div', 'label').html("(".concat(cnt, ")"))));
  });
}

function resetFilterHeader() {
  var filterhEl = this.filterhEl,
      filterValues = this.filterValues,
      values = this.values;
  filterhEl.html("".concat(filterValues.length, " / ").concat(values.length));
  filterhEl.checked(filterValues.length === values.length);
}

var sort_filter_SortFilter = /*#__PURE__*/function () {
  function SortFilter() {
    var _this3 = this;

    _classCallCheck(this, SortFilter);

    this.filterbEl = element_h('div', "".concat(cssPrefix, "-body"));
    this.filterhEl = element_h('div', "".concat(cssPrefix, "-header state")).on('click.stop', function () {
      return _this3.filterClick(0, 'all');
    });
    this.el = element_h('div', "".concat(cssPrefix, "-sort-filter")).children(this.sortAscEl = buildSortItem.call(this, 'asc'), this.sortDescEl = buildSortItem.call(this, 'desc'), sort_filter_buildMenu('divider'), element_h('div', "".concat(cssPrefix, "-filter")).children(this.filterhEl, this.filterbEl), element_h('div', "".concat(cssPrefix, "-buttons")).children(new button_Button('cancel').on('click', function () {
      return _this3.btnClick('cancel');
    }), new button_Button('ok', 'primary').on('click', function () {
      return _this3.btnClick('ok');
    }))).hide(); // this.setFilters(['test1', 'test2', 'text3']);

    this.ci = null;
    this.sortDesc = null;
    this.values = null;
    this.filterValues = [];
  }

  _createClass(SortFilter, [{
    key: "btnClick",
    value: function btnClick(it) {
      if (it === 'ok') {
        var ci = this.ci,
            sort = this.sort,
            filterValues = this.filterValues;

        if (this.ok) {
          // console.log
          // debugger
          this.ok(ci, sort, 'in', filterValues);
        }
      }

      this.hide();
    }
  }, {
    key: "itemClick",
    value: function itemClick(it) {
      // console.log('it:', it);
      this.sort = it;
      var sortAscEl = this.sortAscEl,
          sortDescEl = this.sortDescEl;
      sortAscEl.checked(it === 'asc');
      sortDescEl.checked(it === 'desc');
    }
  }, {
    key: "filterClick",
    value: function filterClick(index, it) {
      // console.log('index:', index, it);
      var filterbEl = this.filterbEl,
          filterValues = this.filterValues,
          values = this.values;
      var children = filterbEl.children();

      if (it === 'all') {
        if (children.length === filterValues.length) {
          this.filterValues = [];
          children.forEach(function (i) {
            return element_h(i).checked(false);
          });
        } else {
          this.filterValues = Array.from(values);
          children.forEach(function (i) {
            return element_h(i).checked(true);
          });
        }
      } else {
        var checked = element_h(children[index]).toggle('checked');

        if (checked) {
          filterValues.push(it);
        } else {
          filterValues.splice(filterValues.findIndex(function (i) {
            return i === it;
          }), 1);
        }
      }

      resetFilterHeader.call(this);
    } // v: autoFilter
    // items: {value: cnt}
    // sort { ci, order }

  }, {
    key: "set",
    value: function set(ci, items, filter, sort) {
      this.ci = ci;
      var sortAscEl = this.sortAscEl,
          sortDescEl = this.sortDescEl;

      if (sort !== null) {
        this.sort = sort.order;
        sortAscEl.checked(sort.asc());
        sortDescEl.checked(sort.desc());
      } else {
        this.sortDesc = null;
        sortAscEl.checked(false);
        sortDescEl.checked(false);
      } // this.setFilters(items, filter);


      this.values = Object.keys(items);
      this.filterValues = filter ? Array.from(filter.value) : Object.keys(items);
      buildFilterBody.call(this, items, filter);
      resetFilterHeader.call(this);
    }
  }, {
    key: "setOffset",
    value: function setOffset() {
      var _this4 = this;

      // this.el.offset(v).show();
      var tindex = 1;
      bindClickoutside(this.el, function () {
        if (tindex <= 0) {
          _this4.hide();
        }

        tindex -= 1;
      });
    }
  }, {
    key: "show",
    value: function show() {
      this.el.show();
    }
  }, {
    key: "hide",
    value: function hide() {
      this.el.hide();
      unbindClickoutside(this.el);
      this.hideCallback();
    }
  }, {
    key: "hideCallback",
    value: function hideCallback() {}
  }]);

  return SortFilter;
}();


// CONCATENATED MODULE: ./src/sheet/component/message.js



function xtoast(title, content) {
  var el = element_h('div', "".concat(cssPrefix, "-toast"));
  var dimmer = element_h('div', "".concat(cssPrefix, "-dimmer active"));

  var remove = function remove() {
    document.body.removeChild(el.el);
    document.body.removeChild(dimmer.el);
  };

  el.children(element_h('div', "".concat(cssPrefix, "-toast-header")).children(new icon_Icon('close').on('click.stop', function () {
    return remove();
  }), title), element_h('div', "".concat(cssPrefix, "-toast-content")).html(content));
  document.body.appendChild(el.el);
  document.body.appendChild(dimmer.el); // set offset

  var _el$box = el.box(),
      width = _el$box.width,
      height = _el$box.height;

  var _document$documentEle = document.documentElement,
      clientHeight = _document$documentEle.clientHeight,
      clientWidth = _document$documentEle.clientWidth;
  el.offset({
    left: (clientWidth - width) / 2,
    top: (clientHeight - height) / 3
  });
}
/* harmony default export */ var component_message = ({});
// CONCATENATED MODULE: ./src/sheet/component/sheet.js



















 // import ModalValidation from './modal_validation';






/**
 * @desc throttle fn
 * @param func function
 * @param wait Delay in milliseconds
 */

function throttle(func, wait) {
  var _this = this;

  var timeout;
  return function () {
    var that = _this;

    for (var _len = arguments.length, arg = new Array(_len), _key = 0; _key < _len; _key++) {
      arg[_key] = arguments[_key];
    }

    var args = arg;

    if (!timeout) {
      timeout = setTimeout(function () {
        timeout = null;
        func.apply(that, args);
      }, wait);
    }
  };
}

function scrollbarMove() {
  var data = this.data,
      verticalScrollbar = this.verticalScrollbar,
      horizontalScrollbar = this.horizontalScrollbar;

  var _data$getSelectedRect = data.getSelectedRect(),
      l = _data$getSelectedRect.l,
      t = _data$getSelectedRect.t,
      left = _data$getSelectedRect.left,
      top = _data$getSelectedRect.top,
      width = _data$getSelectedRect.width,
      height = _data$getSelectedRect.height;

  var tableOffset = this.getTableOffset(); // console.log(',l:', l, ', left:', left, ', tOffset.left:', tableOffset.width);

  if (Math.abs(left) + width > tableOffset.width) {
    horizontalScrollbar.move({
      left: l + width - tableOffset.width
    });
  } else {
    var fsw = data.freezeTotalWidth();

    if (left < fsw) {
      horizontalScrollbar.move({
        left: l - 1 - fsw
      });
    }
  } // console.log('top:', top, ', height:', height, ', tof.height:', tableOffset.height);


  if (Math.abs(top) + height > tableOffset.height) {
    verticalScrollbar.move({
      top: t + height - tableOffset.height - 1
    });
  } else {
    var fsh = data.freezeTotalHeight();

    if (top < fsh) {
      verticalScrollbar.move({
        top: t - 1 - fsh
      });
    }
  }
}

function selectorSet(multiple, ri, ci) {
  var indexesUpdated = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : true;
  var moving = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : false;
  if (ri === -1 && ci === -1) return;
  var table = this.table,
      selector = this.selector,
      toolbar = this.toolbar,
      data = this.data,
      contextMenu = this.contextMenu;
  if (data.isHoldSelector) return;
  var cell = data.getCell(ri, ci);
  var range = selector.range;

  if (multiple) {
    selector.setEnd(ri, ci, moving);
    this.trigger('cells-selected', cell, selector.range);
  } else {
    // trigger click event
    selector.set(ri, ci, indexesUpdated);
    this.trigger('cell-selected', cell, ri, ci);
  }

  if (ri === -1) {
    contextMenu.setMode('col');
  } else if (ci === -1) {
    contextMenu.setMode('row');
  } else {
    contextMenu.setMode('range', data.comments.getComment(ri, ci));
    if (range.equals(selector.range)) return;
  }

  toolbar.reset();
  table.render();
} // multiple: boolean
// direction: left | right | up | down | row-first | row-last | col-first | col-last


function selectorMove(multiple, direction) {
  var selector = this.selector,
      data = this.data;
  var rows = data.rows,
      cols = data.cols;

  var _selector$indexes = _slicedToArray(selector.indexes, 2),
      ri = _selector$indexes[0],
      ci = _selector$indexes[1];

  var _selector$range = selector.range,
      eri = _selector$range.eri,
      eci = _selector$range.eci;

  if (multiple) {
    var _selector$moveIndexes = _slicedToArray(selector.moveIndexes, 2);

    ri = _selector$moveIndexes[0];
    ci = _selector$moveIndexes[1];
  } // console.log('selector.move:', ri, ci);


  if (direction === 'left') {
    if (ci > 0) ci -= 1;
  } else if (direction === 'right') {
    if (eci !== ci) ci = eci;
    if (ci < cols.len - 1) ci += 1;
  } else if (direction === 'up') {
    if (ri > 0) ri -= 1;
  } else if (direction === 'down') {
    if (eri !== ri) ri = eri;
    if (ri < rows.len - 1) ri += 1;
  } else if (direction === 'row-first') {
    ci = 0;
  } else if (direction === 'row-last') {
    ci = cols.len - 1;
  } else if (direction === 'col-first') {
    ri = 0;
  } else if (direction === 'col-last') {
    ri = rows.len - 1;
  }

  if (multiple) {
    selector.moveIndexes = [ri, ci];
  }

  selectorSet.call(this, multiple, ri, ci);
  scrollbarMove.call(this);
} // private methods


function overlayerMousemove(evt) {
  // console.log('x:', evt.offsetX, ', y:', evt.offsetY);
  if (evt.buttons !== 0) return;
  if (evt.target.className === "".concat(cssPrefix, "-resizer-hover")) return;
  var offsetX = evt.offsetX,
      offsetY = evt.offsetY;
  var rowResizer = this.rowResizer,
      colResizer = this.colResizer,
      tableEl = this.tableEl,
      data = this.data,
      comment = this.comment;
  var rows = data.rows,
      cols = data.cols;
  var tRect = tableEl.box();
  var cRect = data.getCellRectByXY(evt.offsetX, evt.offsetY);

  if (offsetX > cols.indexWidth && offsetY > rows.height) {
    rowResizer.hide();
    colResizer.hide();
    comment.show(data, cRect);
    return;
  }

  if (cRect.ri >= 0 && cRect.ci === -1) {
    cRect.width = cols.indexWidth;
    rowResizer.show(cRect, {
      width: tRect.width
    });

    if (rows.isHide(cRect.ri - 1) || rows.isLast(cRect.ri)) {
      rowResizer.showUnhide(cRect.ri);
    } else {
      rowResizer.hideUnhide();
    }
  } else {
    rowResizer.hide();
  }

  if (cRect.ri === -1 && cRect.ci >= 0) {
    cRect.height = rows.indexHeight;
    colResizer.show(cRect, {
      height: tRect.height
    });

    if (cols.isHide(cRect.ci - 1) || cols.isLast(cRect.ci)) {
      colResizer.showUnhide(cRect.ci);
    } else {
      colResizer.hideUnhide();
    }
  } else {
    colResizer.hide();
  }
} // let scrollThreshold = 15;


function overlayerMousescroll(evt) {
  // scrollThreshold -= 1;
  // if (scrollThreshold > 0) return;
  // scrollThreshold = 15;
  var verticalScrollbar = this.verticalScrollbar,
      horizontalScrollbar = this.horizontalScrollbar,
      data = this.data;

  var _verticalScrollbar$sc = verticalScrollbar.scroll(),
      top = _verticalScrollbar$sc.top;

  var _horizontalScrollbar$ = horizontalScrollbar.scroll(),
      left = _horizontalScrollbar$.left; // console.log('evt:::', evt.wheelDelta, evt.detail * 40);


  var rows = data.rows,
      cols = data.cols; // deltaY for vertical delta

  var deltaY = evt.deltaY,
      deltaX = evt.deltaX;

  var loopValue = function loopValue(ii, vFunc) {
    var i = ii;
    var v = 0;

    do {
      v = vFunc(i);
      i += 1;
    } while (v <= 0);

    return v;
  }; // console.log('deltaX', deltaX, 'evt.detail', evt.detail);
  // if (evt.detail) deltaY = evt.detail * 40;


  var moveY = function moveY(vertical) {
    if (vertical > 0) {
      // up
      var ri = data.scroll.ri + 1;

      if (ri < rows.len) {
        var rh = loopValue(ri, function (i) {
          return rows.getHeight(i);
        });
        verticalScrollbar.move({
          top: top + rh - 1
        });
      }
    } else {
      // down
      var _ri = data.scroll.ri - 1;

      if (_ri >= 0) {
        var _rh = loopValue(_ri, function (i) {
          return rows.getHeight(i);
        });

        verticalScrollbar.move({
          top: _ri === 0 ? 0 : top - _rh
        });
      }
    }
  }; // deltaX for Mac horizontal scroll


  var moveX = function moveX(horizontal) {
    if (horizontal > 0) {
      // left
      var ci = data.scroll.ci + 1;

      if (ci < cols.len) {
        var cw = loopValue(ci, function (i) {
          return cols.getWidth(i);
        });
        horizontalScrollbar.move({
          left: left + cw - 1
        });
      }
    } else {
      // right
      var _ci = data.scroll.ci - 1;

      if (_ci >= 0) {
        var _cw = loopValue(_ci, function (i) {
          return cols.getWidth(i);
        });

        horizontalScrollbar.move({
          left: _ci === 0 ? 0 : left - _cw
        });
      }
    }
  };

  var tempY = Math.abs(deltaY);
  var tempX = Math.abs(deltaX);
  var temp = Math.max(tempY, tempX); // console.log('event:', evt);
  // detail for windows/mac firefox vertical scroll

  if (/Firefox/i.test(window.navigator.userAgent)) throttle(moveY(evt.detail), 150);
  if (temp === tempX) throttle(moveX(deltaX), 150);
  if (temp === tempY) throttle(moveY(deltaY), 150);
}

function overlayerTouch(direction, distance) {
  var verticalScrollbar = this.verticalScrollbar,
      horizontalScrollbar = this.horizontalScrollbar;

  var _verticalScrollbar$sc2 = verticalScrollbar.scroll(),
      top = _verticalScrollbar$sc2.top;

  var _horizontalScrollbar$2 = horizontalScrollbar.scroll(),
      left = _horizontalScrollbar$2.left;

  if (direction === 'left' || direction === 'right') {
    horizontalScrollbar.move({
      left: left - distance
    });
  } else if (direction === 'up' || direction === 'down') {
    verticalScrollbar.move({
      top: top - distance
    });
  }
}

function _verticalScrollbarSet() {
  var data = this.data,
      verticalScrollbar = this.verticalScrollbar;

  var _this$getTableOffset = this.getTableOffset(),
      height = _this$getTableOffset.height;

  var erth = data.exceptRowTotalHeight(0, -1); // console.log('erth:', erth);

  verticalScrollbar.set(height, data.rows.totalHeight() - erth, data.scroll);
}

function horizontalScrollbarSet() {
  var data = this.data,
      horizontalScrollbar = this.horizontalScrollbar;

  var _this$getTableOffset2 = this.getTableOffset(),
      width = _this$getTableOffset2.width;

  if (data) {
    if (data.settings.minContent) {
      //最小化显示时滚动条不遮挡
      var minContentWidth = data.cols.sumWidth(0, data.cols.len) - data.settings.view.width();

      if (minContentWidth + 19 > 0) {
        minContentWidth = 20;
      }

      horizontalScrollbar.set(width, data.cols.totalWidth() + minContentWidth, data.scroll);
    } else {
      horizontalScrollbar.set(width, data.cols.totalWidth(), data.scroll);
    }
  }

  this.toolbar.moreResize();
}

function sheetFreeze() {
  var selector = this.selector,
      data = this.data,
      editor = this.editor;

  var _data$freeze = _slicedToArray(data.freeze, 2),
      ri = _data$freeze[0],
      ci = _data$freeze[1];

  if (ri >= 0 || ci >= 0) {
    var fwidth = data.freezeTotalWidth();
    var fheight = data.freezeTotalHeight();
    editor.setFreezeLengths(fwidth, fheight);
  }

  selector.resetAreaOffset();
}

function sheetReset() {
  var isRender = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;
  var tableEl = this.tableEl,
      overlayerEl = this.overlayerEl,
      overlayerCEl = this.overlayerCEl,
      table = this.table,
      toolbar = this.toolbar,
      selector = this.selector,
      el = this.el,
      data = this.data;
  var tOffset = this.getTableOffset();
  var vRect = this.getRect();
  tableEl.attr(vRect);
  overlayerEl.offset(vRect);
  overlayerCEl.offset(tOffset);
  el.css('width', "".concat(vRect.width, "px"));

  if (data.settings.minContent) {
    el.css('margin', "auto");
  }

  _verticalScrollbarSet.call(this);

  horizontalScrollbarSet.call(this);
  sheetFreeze.call(this);

  if (isRender) {
    table.render();
  }

  toolbar.reset();
  selector.reset();
}

function clearClipboard() {
  var data = this.data,
      selector = this.selector;
  data.clearClipboard();
  selector.hideClipboard();
}

function copy() {
  var data = this.data,
      selector = this.selector;
  data.copy();
  data.copyToSystemClipboard();
  selector.showClipboard();
}

function cut() {
  var data = this.data,
      selector = this.selector;
  data.cut();
  selector.showClipboard();
}

function paste(what, evt) {
  var _this2 = this,
      _navigator$clipboard;

  var eventTrigger = function eventTrigger(rows) {
    _this2.trigger('pasted-clipboard', rows);
  };

  var data = this.data;
  if (data.settings.mode === 'read') return;

  if ((_navigator$clipboard = navigator.clipboard) !== null && _navigator$clipboard !== void 0 && _navigator$clipboard.readText) {
    var resetSheet = function resetSheet() {
      return sheetReset.call(_this2);
    };

    data.pasteFromSystemClipboard(resetSheet, eventTrigger, function () {
      //是否spread-sheet内容
      data.paste(what, function (msg) {
        return xtoast('Tip', msg);
      }, eventTrigger);
      sheetReset.call(_this2);
    }, function () {
      return clearClipboard.call(_this2);
    });
  } else if (evt) {
    //兼容chrome 63
    var cdata = evt.clipboardData.getData('text/plain');

    if (data.clipboard.isSelf(cdata) && !data.clipboard.isClear()) {
      //是否spread-sheet内容
      data.paste(what, function (msg) {
        return xtoast('Tip', msg);
      }, eventTrigger);
      sheetReset.call(this);
    } else {
      clearClipboard.call(this);
      this.data.pasteFromText(cdata, eventTrigger);
      sheetReset.call(this);
    }
  }
}

function sheet_hideRowsOrCols() {
  this.data.hideRowsOrCols();
  sheetReset.call(this);
}

function unhideRowsOrCols(type, index) {
  this.data.unhideRowsOrCols(type, index);
  sheetReset.call(this);
}

function sheet_autofilter() {
  var data = this.data;
  data.autofilter();
  sheetReset.call(this);
}

function toolbarChangePaintformatPaste() {
  var toolbar = this.toolbar;

  if (toolbar.paintformatActive()) {
    paste.call(this, 'format');
    clearClipboard.call(this);
    toolbar.paintformatToggle();
  }
}

function overlayerMousedown(evt) {
  var _this3 = this;

  // console.log(':::::overlayer.mousedown:', evt.detail, evt.button, evt.buttons, evt.shiftKey);
  // console.log('evt.target.className:', evt.target.className);
  var selector = this.selector,
      data = this.data,
      table = this.table,
      sortFilter = this.sortFilter;
  var offsetX = evt.offsetX,
      offsetY = evt.offsetY;
  var isAutofillEl = evt.target.className === "".concat(cssPrefix, "-selector-corner");
  var cellRect = data.getCellRectByXY(offsetX, offsetY);
  var left = cellRect.left,
      top = cellRect.top,
      width = cellRect.width,
      height = cellRect.height;
  var ri = cellRect.ri,
      ci = cellRect.ci; // sort or filter

  var autoFilter = data.autoFilter; //isSelectOneRow
  // debugger

  if (autoFilter.includes(ri, ci)) {
    if (left + width - 20 < offsetX && top + height - 20 < offsetY) {
      var items = [];

      if (autoFilter.isSelectOneRow) {
        var range = cell_range_CellRange.valueOf(autoFilter.ref);
        var sri = range.sri,
            eri = range.eri; // debugger;

        var rowsData = data.rows.getData();
        var rowsKeys = Object.keys(rowsData);
        rowsKeys.pop();
        var maxl = Math.max.apply(Math, _toConsumableArray(rowsKeys.map(function (n) {
          return parseInt(n);
        }))); // console.log(rowsData)

        for (var i = sri; i <= maxl; i++) {
          if (rowsData[i]) {
            eri = i;
          } else {
            break;
          }
        }

        items = autoFilter.items(ci, function (r, c) {
          return data.getCellParseValue(r, c);
        }, sri, eri);
      } else {
        items = autoFilter.items(ci, function (r, c) {
          return data.getCellParseValue(r, c);
        });
      }

      sortFilter.hide();
      sortFilter.set(ci, items, autoFilter.getFilter(ci), autoFilter.getSort(ci));
      sortFilter.setOffset({
        left: left,
        top: top + height + 2
      }); //point,instance,data,Filter

      this.trigger('sort-filter', 'sort-filter', {
        position: {
          left: left,
          top: top + height + 2
        },
        sortFilter: sortFilter,
        items: items,
        xy: [ci, ri]
      });
      return;
    }
  } // console.log('ri:', ri, ', ci:', ci);


  if (!evt.shiftKey) {
    // console.log('selectorSetStart:::');
    if (isAutofillEl) {
      selector.showAutofill(ri, ci);
    } else {
      selectorSet.call(this, false, ri, ci);
    } // mouse move up


    mouseMoveUp(window, function (e) {
      var isOverlayer = e.target.className === "".concat(cssPrefix, "-overlayer");
      if (!isOverlayer) return;

      var _data$getCellRectByXY = data.getCellRectByXY(e.offsetX, e.offsetY);

      ri = _data$getCellRectByXY.ri;
      ci = _data$getCellRectByXY.ci;

      if (isAutofillEl) {
        selector.showAutofill(ri, ci);
      } else if (e.buttons === 1 && !e.shiftKey) {
        selectorSet.call(_this3, true, ri, ci, true, true);
      }
    }, function () {
      if (isAutofillEl && selector.isAutofill && selector.arange && data.settings.mode !== 'read') {
        if (data.autofill(selector.arange, 'all', function (msg) {
          return xtoast('Tip', msg);
        })) {
          table.render();
        }
      }

      selector.hideAutofill();
      toolbarChangePaintformatPaste.call(_this3);
    });
  }

  if (!isAutofillEl && evt.buttons === 1) {
    if (evt.shiftKey) {
      // console.log('shiftKey::::');
      selectorSet.call(this, true, ri, ci);
    }
  }
}

function editorSetOffset() {
  var editor = this.editor,
      data = this.data;
  var sOffset = data.getSelectedRect();
  var tOffset = this.getTableOffset();
  var sPosition = 'top'; // console.log('sOffset:', sOffset, ':', tOffset);

  if (sOffset.top > tOffset.height / 2) {
    sPosition = 'bottom';
  }

  editor.setOffset(sOffset, sPosition);
}

function editorSet() {
  var editor = this.editor,
      data = this.data;
  if (data.settings.mode === 'read') return;
  editorSetOffset.call(this);
  editor.setCell(data.getSelectedCell(), data.getSelectedValidator());
  clearClipboard.call(this);
}

function verticalScrollbarMove(distance) {
  var _this4 = this;

  var data = this.data,
      table = this.table,
      selector = this.selector;
  data.scrolly(distance, function () {
    selector.resetBRLAreaOffset();
    editorSetOffset.call(_this4);
    table.render();
  });
}

function horizontalScrollbarMove(distance) {
  var _this5 = this;

  var data = this.data,
      table = this.table,
      selector = this.selector;
  data.scrollx(distance, function () {
    selector.resetBRTAreaOffset();
    editorSetOffset.call(_this5);
    table.render();
  });
}

function rowResizerFinished(cRect, distance) {
  var ri = cRect.ri;
  var table = this.table,
      selector = this.selector,
      data = this.data;
  data.rows.setHeight(ri, distance);
  table.render();
  selector.resetAreaOffset();

  _verticalScrollbarSet.call(this);

  editorSetOffset.call(this);
}

function colResizerFinished(cRect, distance) {
  var ci = cRect.ci;
  var table = this.table,
      selector = this.selector,
      data = this.data;
  data.cols.setWidth(ci, distance); // console.log('data:', data);

  table.render();
  selector.resetAreaOffset();
  horizontalScrollbarSet.call(this);
  editorSetOffset.call(this);
}

function dataSetCellText(text) {
  var state = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'finished';
  var data = this.data,
      table = this.table; // const [ri, ci] = selector.indexes;

  if (data.settings.mode === 'read') return;
  text = data.filterCellText(text);
  data.setSelectedCellText(text, state);
  var _data$selector = data.selector,
      ri = _data$selector.ri,
      ci = _data$selector.ci;

  if (state === 'finished') {
    table.render();
  } else {
    this.trigger('cell-edited', text, ri, ci);
  }
}

function insertDeleteRowColumn(type, n) {
  var data = this.data;
  if (data.settings.mode === 'read') return;
  this.trigger('insert-delete', type, n);

  if (type === 'insert-row') {
    data.insert('row', n);
  } else if (type === 'delete-row') {
    data.delete('row');
  } else if (type === 'insert-column') {
    data.insert('column', n);
  } else if (type === 'delete-column') {
    data.delete('column');
  } else if (type === 'delete-cell') {
    data.deleteCell();
  } else if (type === 'delete-cell-format') {
    data.deleteCell('format');
  } else if (type === 'delete-cell-text') {
    data.deleteCell('text');
  } else if (type === 'cell-printable') {
    data.setSelectedCellAttr('printable', true);
  } else if (type === 'cell-non-printable') {
    data.setSelectedCellAttr('printable', false);
  } else if (type === 'cell-editable') {
    data.setSelectedCellAttr('editable', true);
  } else if (type === 'cell-non-editable') {
    data.setSelectedCellAttr('editable', false);
  }

  clearClipboard.call(this);
  sheetReset.call(this);
}

function toolbarChange(type, value) {
  var data = this.data; // if (type === 'priview') {
  //   this.priview();
  // } else if (type === 'save') {
  //   this.save();
  // } else

  if (type === 'undo') {
    this.undo();
  } else if (type === 'redo') {
    this.redo();
  } else if (type === 'print') {// this.print.preview();
  } else if (type === 'paintformat') {
    if (value === true) copy.call(this);else clearClipboard.call(this);
  } else if (type === 'clearformat') {
    insertDeleteRowColumn.call(this, 'delete-cell-format');
  } else if (type === 'link') {// link
  } else if (type === 'chart') {// chart
  } else if (type === 'autofilter') {
    // filter
    sheet_autofilter.call(this);
  } else if (type === 'freeze') {
    if (value) {
      var _data$selector2 = data.selector,
          ri = _data$selector2.ri,
          ci = _data$selector2.ci;
      this.freeze(ri, ci);
    } else {
      this.freeze(0, 0);
    }
  } else if (type === 'import') {
    this.import(value);
  } else if (type === 'export') {// alert('export');
  } else if (type === 'lookUp') {//
  } else if (type === 'slash') {//
  } else {
    data.setSelectedCellAttr(type, value);

    if (type === 'formula' && !data.selector.multiple()) {
      editorSet.call(this);
    }

    sheetReset.call(this);
  }

  this.trigger('tool-selected', type, value);
}

function sortFilterChange(ci, order, operator, value) {
  // console.log('sort:', sortDesc, operator, value);
  this.data.setAutoFilter(ci, order, operator, value);
  sheetReset.call(this);
}

function showContextMenu(evt) {
  this.focusing = false;
  this.contextMenu.setPosition(evt.offsetX, evt.offsetY);
}

function sheetInitEvents() {
  var _this6 = this;

  var selector = this.selector,
      overlayerEl = this.overlayerEl,
      rowResizer = this.rowResizer,
      colResizer = this.colResizer,
      verticalScrollbar = this.verticalScrollbar,
      horizontalScrollbar = this.horizontalScrollbar,
      editor = this.editor,
      contextMenu = this.contextMenu,
      toolbar = this.toolbar,
      sortFilter = this.sortFilter; // overlayer

  overlayerEl.on('mousemove', function (evt) {
    overlayerMousemove.call(_this6, evt);
  }).on('mousedown', function (evt) {
    editor.clear();
    contextMenu.hide(); // the left mouse button: mousedown → mouseup → click
    // the right mouse button: mousedown → contenxtmenu → mouseup

    var isXyInSelectedRect = _this6.data.xyInSelectedRect(evt.offsetX, evt.offsetY);

    if (evt.buttons === 2) {
      if (isXyInSelectedRect) {
        showContextMenu.call(_this6, evt);
      } else {
        var cellRect = _this6.data.getCellRectByXY(evt.offsetX, evt.offsetY);

        var ri = cellRect.ri,
            ci = cellRect.ci;

        if (!_this6.data.calSelectedContains(ri, ci)) {
          overlayerMousedown.call(_this6, evt);
        }

        showContextMenu.call(_this6, evt);
      }

      evt.stopPropagation();
    } else if (evt.detail === 2) {
      if (isXyInSelectedRect) {
        editorSet.call(_this6);
      }
    } else {
      overlayerMousedown.call(_this6, evt);
    }
  }) // .on('mouseup', evt => {
  //   let isXyInSelectedRect = this.data.xyInSelectedRect(evt.offsetX, evt.offsetY);
  //   console.log(isXyInSelectedRect);
  //   if (isXyInSelectedRect) {
  //     // editorSet.call(this);
  //   }
  // })
  .on('mousewheel.stop', function (evt) {
    overlayerMousescroll.call(_this6, evt);
  }).on('mouseout', function (evt) {
    var offsetX = evt.offsetX,
        offsetY = evt.offsetY;
    if (offsetY <= 0) colResizer.hide();
    if (offsetX <= 0) rowResizer.hide();
  });

  selector.showList = function () {
    editorSet.call(_this6);
  };

  selector.inputChange = function (v) {
    dataSetCellText.call(_this6, v, 'input');
    editorSet.call(_this6);
  }; // slide on mobile


  bindTouch(overlayerEl.el, {
    move: function move(direction, d) {
      overlayerTouch.call(_this6, direction, d);
    }
  }); // toolbar change

  toolbar.change = function (type, value) {
    return toolbarChange.call(_this6, type, value);
  }; // sort filter ok


  sortFilter.ok = function (ci, order, o, v) {
    return sortFilterChange.call(_this6, ci, order, o, v);
  }; // resizer finished callback


  rowResizer.finishedFn = function (cRect, distance) {
    rowResizerFinished.call(_this6, cRect, distance);
  };

  colResizer.finishedFn = function (cRect, distance) {
    colResizerFinished.call(_this6, cRect, distance);
  }; // resizer unhide callback


  rowResizer.unhideFn = function (index) {
    unhideRowsOrCols.call(_this6, 'row', index);
  };

  colResizer.unhideFn = function (index) {
    unhideRowsOrCols.call(_this6, 'col', index);
  }; // scrollbar move callback


  verticalScrollbar.moveFn = function (distance, evt) {
    verticalScrollbarMove.call(_this6, distance, evt);
  };

  horizontalScrollbar.moveFn = function (distance, evt) {
    horizontalScrollbarMove.call(_this6, distance, evt);
  }; // editor


  editor.change = function (state, itext) {
    toolbar.fnTool.setText(itext);
    dataSetCellText.call(_this6, itext, state);
  };

  toolbar.fnTool.change = function (itext) {
    var table = _this6.table;
    dataSetCellText.call(_this6, itext, 'input');
    table.render();
    editor.setText(itext || '');
  };

  toolbar.fnTool.openFunctions = function (itext) {
    _this6.trigger('open-functions', 'open-functions', itext);
  }; // modal validation
  // modalValidation.change = (action, ...args) => {
  //   if (action === 'save') {
  //     this.data.addValidation(...args);
  //   } else {
  //     this.data.removeValidation();
  //   }
  // };
  // contextmenu


  contextMenu.itemClick = function (type, n) {
    if (type === 'edit-format') {
      _this6.trigger('edit-format', type, _this6.data.selector);
    } else if (type === 'validation') {
      _this6.trigger('validation', type, _this6.data.getSelectedValidation());
    } else if (type === 'set-width' || type === 'set-height') {
      _this6.trigger('set-cell-size', 'set-cell-size', type);
    } else if (type === 'copy') {
      copy.call(_this6);
    } else if (type === 'cut') {
      cut.call(_this6);
    } else if (type === 'paste') {
      paste.call(_this6, 'all');
    } else if (type === 'paste-value') {
      paste.call(_this6, 'text');
    } else if (type === 'paste-format') {
      paste.call(_this6, 'format');
    } else if (type === 'hide') {
      sheet_hideRowsOrCols.call(_this6);
    } else if (type === 'insert-comment' || type === 'edit-comment') {
      _this6.comment.edit(_this6.data);
    } else if (type === 'del-comment') {
      _this6.comment.delete(_this6.data);

      contextMenu.setMode('range');

      _this6.table.render();
    } else {
      insertDeleteRowColumn.call(_this6, type, n);
    }
  };

  function getFocusingSelf() {
    var target = document.querySelector(':focus');
    return overlayerEl.contains(target) || target === null;
  }

  bind(window, 'click', function (evt) {
    _this6.focusing = overlayerEl.contains(evt.target);
  });
  bind(window, 'paste', function (evt) {
    if (!_this6.focusing) return;
    paste.call(_this6, _this6.data.settings.pasteType, evt);
    evt.preventDefault();
  }); // for selector

  bind(window, 'keydown', function (evt) {
    if (!_this6.focusing) return;
    var keyCode = evt.keyCode || evt.which;
    var key = evt.key,
        ctrlKey = evt.ctrlKey,
        shiftKey = evt.shiftKey,
        metaKey = evt.metaKey; // console.log('keydown.evt: ', keyCode);

    if (ctrlKey || metaKey) {
      // const { sIndexes, eIndexes } = selector;
      // let what = 'all';
      // if (shiftKey) what = 'text';
      // if (altKey) what = 'format';
      switch (keyCode) {
        case 90:
          // undo: ctrl + z
          _this6.undo();

          evt.preventDefault();
          break;

        case 89:
          // redo: ctrl + y
          _this6.redo();

          evt.preventDefault();
          break;

        case 67:
          // ctrl + c
          copy.call(_this6);
          evt.preventDefault();
          break;

        case 88:
          // ctrl + x
          cut.call(_this6);
          evt.preventDefault();
          break;

        case 85:
          // ctrl + u
          toolbar.trigger('underline');
          evt.preventDefault();
          break;

        case 86:
          //clearClipboard.call(this);
          // ctrl + v
          // => paste
          // evt.preventDefault();
          break;

        case 37:
          // ctrl + left
          selectorMove.call(_this6, shiftKey, 'row-first');
          evt.preventDefault();
          break;

        case 38:
          // ctrl + up
          selectorMove.call(_this6, shiftKey, 'col-first');
          evt.preventDefault();
          break;

        case 39:
          // ctrl + right
          selectorMove.call(_this6, shiftKey, 'row-last');
          evt.preventDefault();
          break;

        case 40:
          // ctrl + down
          selectorMove.call(_this6, shiftKey, 'col-last');
          evt.preventDefault();
          break;

        case 32:
          // ctrl + space, all cells in col
          selectorSet.call(_this6, false, -1, _this6.data.selector.ci, false);
          evt.preventDefault();
          break;

        case 66:
          // ctrl + B
          toolbar.trigger('bold');
          break;

        case 73:
          // ctrl + I
          toolbar.trigger('italic');
          break;

        case 70:
          // ctrl + F
          toolbar.trigger('lookUp');
          evt.preventDefault();
          break;

        default:
          break;
      }
    } else {
      // console.log('evt.keyCode:', evt.keyCode);
      switch (keyCode) {
        case 32:
          if (shiftKey) {
            // shift + space, all cells in row
            selectorSet.call(_this6, false, _this6.data.selector.ri, -1, false);
          }

          break;

        case 27:
          // esc
          contextMenu.hide();
          clearClipboard.call(_this6);
          break;

        case 37:
          // left
          selectorMove.call(_this6, shiftKey, 'left');
          evt.preventDefault();
          break;

        case 38:
          // up
          selectorMove.call(_this6, shiftKey, 'up');
          evt.preventDefault();
          break;

        case 39:
          // right
          selectorMove.call(_this6, shiftKey, 'right');
          evt.preventDefault();
          break;

        case 40:
          // down
          selectorMove.call(_this6, shiftKey, 'down');
          evt.preventDefault();
          break;

        case 9:
          // tab
          editor.clear(); // shift + tab => move left
          // tab => move right

          selectorMove.call(_this6, false, shiftKey ? 'left' : 'right');
          evt.preventDefault();
          break;

        case 13:
          // enter
          editor.clear(); // shift + enter => move up
          // enter => move down

          selectorMove.call(_this6, false, shiftKey ? 'up' : 'down');
          evt.preventDefault();
          break;

        case 8:
          // backspace
          insertDeleteRowColumn.call(_this6, 'delete-cell-text');
          evt.preventDefault();
          break;

        default:
          break;
      }

      if (key === 'Delete') {
        insertDeleteRowColumn.call(_this6, 'delete-cell-text');
        evt.preventDefault();
      } else if ((keyCode >= 65 && keyCode <= 90 || keyCode >= 48 && keyCode <= 57 || keyCode >= 96 && keyCode <= 105 || evt.key === '=') && getFocusingSelf()) {
        dataSetCellText.call(_this6, evt.key, 'input');
        editorSet.call(_this6);
      } else if (keyCode === 113) {
        // F2
        editorSet.call(_this6);
      }
    }
  });
}

var sheet_Sheet = /*#__PURE__*/function () {
  function Sheet(targetEl, data) {
    var _this7 = this;

    var loadDataFunc = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : function () {};

    _classCallCheck(this, Sheet);

    this.loadDataFunc = loadDataFunc;
    this.eventMap = createEventEmitter();
    var _data$settings = data.settings,
        view = _data$settings.view,
        showToolbar = _data$settings.showToolbar,
        showContextmenu = _data$settings.showContextmenu;
    this.el = element_h('div', "".concat(cssPrefix, "-sheet"));
    this.toolbar = new toolbar_Toolbar(data, view.width, !showToolbar); // this.print = new Print(data);

    targetEl.children(this.toolbar.el, this.el);
    this.data = data; // table

    this.tableEl = element_h('canvas', "".concat(cssPrefix, "-table")); // resizer

    this.rowResizer = new resizer_Resizer(false, data.rows.minHeight, data.settings.hiddenOperate);
    this.colResizer = new resizer_Resizer(true, data.cols.minWidth, data.settings.hiddenOperate); // scrollbar

    this.verticalScrollbar = new scrollbar_Scrollbar(true);
    this.horizontalScrollbar = new scrollbar_Scrollbar(false); // editor

    this.editor = new editor_Editor(formula_formulas, function () {
      return _this7.getTableOffset();
    }, data); // contextMenu

    this.contextMenu = new contextmenu_ContextMenu(function () {
      return _this7.getRect();
    }, !showContextmenu); // selector

    this.selector = new component_selector_Selector(data);
    this.comment = new comment_Comment();
    this.overlayerCEl = element_h('div', "".concat(cssPrefix, "-overlayer-content")).children(this.editor.el, this.selector.el, this.comment.el);
    this.overlayerEl = element_h('div', "".concat(cssPrefix, "-overlayer")).child(this.overlayerCEl); // sortFilter

    this.sortFilter = new sort_filter_SortFilter(); // root element

    this.el.children(this.tableEl, this.overlayerEl.el, this.rowResizer.el, this.colResizer.el, this.verticalScrollbar.el, this.horizontalScrollbar.el, this.contextMenu.el, this.sortFilter.el, this.sortFilter.el); // table

    this.table = new component_table(this.tableEl.el, data);
    sheetInitEvents.call(this);
    sheetReset.call(this, false); // init selector [0, 0]

    selectorSet.call(this, false, 0, 0);
  }

  _createClass(Sheet, [{
    key: "verticalScrollbarSet",
    value: function verticalScrollbarSet(top, left) {
      var _this$getRect = this.getRect(),
          width = _this$getRect.width,
          height = _this$getRect.height;

      this.data.scrolly(top - height, function () {});
      this.data.scrollx(left - width, function () {});
      horizontalScrollbarSet.call(this);

      _verticalScrollbarSet.call(this);
    }
  }, {
    key: "on",
    value: function on(eventName, func) {
      this.eventMap.on(eventName, func);
      return this;
    }
  }, {
    key: "off",
    value: function off(eventName, func) {
      this.eventMap.removeListener(eventName, func);
      return this;
    }
  }, {
    key: "trigger",
    value: function trigger(eventName) {
      var eventMap = this.eventMap;

      for (var _len2 = arguments.length, args = new Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {
        args[_key2 - 1] = arguments[_key2];
      }

      eventMap.fire(eventName, args);
    }
  }, {
    key: "destroyed",
    value: function destroyed() {
      this.eventMap.removeAllListeners();
      unbindAll();
    }
  }, {
    key: "resetData",
    value: function resetData(data) {
      // before
      this.editor.clear(); // after

      this.data = data;

      _verticalScrollbarSet.call(this);

      horizontalScrollbarSet.call(this);
      sheetFreeze.call(this);
      this.toolbar.resetData(data); //this.print.resetData(data);

      this.selector.resetData(data);
      this.table.resetData(data);
      this.trigger('reset-data', data);
    }
  }, {
    key: "loadData",
    value: function loadData(data) {
      this.data.setData(data);
      sheetReset.call(this);
      return this;
    } // freeze rows or cols

  }, {
    key: "freeze",
    value: function freeze(ri, ci) {
      var data = this.data;
      data.setFreeze(ri, ci);
      sheetReset.call(this);
      return this;
    }
  }, {
    key: "undo",
    value: function undo() {
      this.data.undo();
      sheetReset.call(this);
    }
  }, {
    key: "redo",
    value: function redo() {
      this.data.redo();
      sheetReset.call(this);
    }
  }, {
    key: "import",
    value: function _import(spreadsheets) {
      this.loadDataFunc(spreadsheets);
      return this;
    }
  }, {
    key: "export",
    value: function _export() {}
  }, {
    key: "reload",
    value: function reload() {
      sheetReset.call(this);
      return this;
    }
  }, {
    key: "getRect",
    value: function getRect() {
      var data = this.data;
      return {
        width: data.viewWidth(),
        height: data.viewHeight()
      };
    }
  }, {
    key: "getTableOffset",
    value: function getTableOffset() {
      var _this$data = this.data,
          rows = _this$data.rows,
          cols = _this$data.cols;

      var _this$getRect2 = this.getRect(),
          width = _this$getRect2.width,
          height = _this$getRect2.height;

      return {
        width: width - cols.indexWidth,
        height: height - rows.indexHeight,
        left: cols.indexWidth,
        top: rows.indexHeight
      };
    }
  }, {
    key: "gotoxy",
    value: function gotoxy(ri, ci) {
      var data = this.data;

      var _data$cellRect = data.cellRect(Math.min(data.rows.len, ri + 3), Math.min(data.cols.len - 1, ci + 3)),
          top = _data$cellRect.top,
          left = _data$cellRect.left;

      this.editor.clear();
      this.verticalScrollbarSet(top, left);
      this.selector.set(ri, ci);
      this.toolbar.reset();
      this.table.render();
    }
  }]);

  return Sheet;
}();


// CONCATENATED MODULE: ./src/sheet/component/form_input.js





var form_input_FormInput = /*#__PURE__*/function () {
  function FormInput(width, hint) {
    var _this = this;

    _classCallCheck(this, FormInput);

    this.vchange = function () {};

    this.el = element_h('div', "".concat(cssPrefix, "-form-input"));
    this.input = element_h('input', '').css('width', width).on('input', function (evt) {
      return _this.vchange(evt);
    }).attr('placeholder', hint);
    this.el.child(this.input);
  }

  _createClass(FormInput, [{
    key: "focus",
    value: function focus() {
      var _this2 = this;

      setTimeout(function () {
        _this2.input.el.focus();
      }, 10);
    }
  }, {
    key: "hint",
    value: function hint(v) {
      this.input.attr('placeholder', v);
    }
  }, {
    key: "val",
    value: function val(v) {
      return this.input.val(v);
    }
  }]);

  return FormInput;
}();


// CONCATENATED MODULE: ./src/sheet/component/bottombar.js


























var bottombar_DropdownMore = /*#__PURE__*/function (_Dropdown) {
  _inherits(DropdownMore, _Dropdown);

  var _super = _createSuper(DropdownMore);

  function DropdownMore(click, height) {
    var _this;

    _classCallCheck(this, DropdownMore);

    var icon = new icon_Icon('ellipsis');
    _this = _super.call(this, icon, null, null, false, 'top-left');

    _this.setMaxHeight(height());

    _this.contentClick = click;
    return _this;
  }

  _createClass(DropdownMore, [{
    key: "reset",
    value: function reset(items) {
      var _this2 = this;

      var eles = items.map(function (it) {
        return element_h('div', "".concat(cssPrefix, "-item")).css('font-weight', 'normal').on('click', function () {
          _this2.contentClick(it);

          _this2.hide();
        }).child(it);
      });
      this.setContentChildren.apply(this, _toConsumableArray(eles));
    }
  }, {
    key: "setTitle",
    value: function setTitle() {}
  }]);

  return DropdownMore;
}(dropdown_Dropdown);

var bottombar_menuItems = [{
  key: 'delete',
  title: tf('contextmenu.deleteSheet')
}, {
  key: 'copy',
  title: tf('contextmenu.copySheet')
}, {
  key: 'rename',
  title: tf('contextmenu.renameSheet')
}, {
  key: 'colorSheet',
  title: tf('contextmenu.colorSheet')
}, {
  key: 'hideSheet',
  title: tf('contextmenu.hideSheet')
}, {
  key: 'showSheet',
  title: tf('contextmenu.showSheet')
}, {
  key: 'leftMoveSheet',
  title: tf('contextmenu.leftMoveSheet')
}, {
  key: 'rightMoveSheet',
  title: tf('contextmenu.rightMoveSheet')
}];

function bottombar_buildMenuItem(item) {
  var _this3 = this;

  return element_h('div', "".concat(cssPrefix, "-item")).child(item.title()).on('click', function (event) {
    _this3.itemClick(event, item.key);
  });
}

function bottombar_buildMenu() {
  var _this4 = this;

  return bottombar_menuItems.map(function (it) {
    return bottombar_buildMenuItem.call(_this4, it);
  });
}

var bottombar_ContextMenu = /*#__PURE__*/function () {
  function ContextMenu() {
    var _h$css;

    _classCallCheck(this, ContextMenu);

    this.el = (_h$css = element_h('div', "".concat(cssPrefix, "-contextmenu")).css('width', '160px')).children.apply(_h$css, _toConsumableArray(bottombar_buildMenu.call(this))).hide();

    this.itemClick = function () {};
  }

  _createClass(ContextMenu, [{
    key: "hide",
    value: function hide() {
      var el = this.el;
      el.hide();
      unbindClickoutside(el);
    }
  }, {
    key: "setOffset",
    value: function setOffset(offset) {
      var el = this.el;
      el.offset(offset);
      el.show();
      bindClickoutside(el);
    }
  }]);

  return ContextMenu;
}(); // let dragElement = null;


var bottombar_Bottombar = /*#__PURE__*/function () {
  function Bottombar() {
    var _this5 = this;

    var addFunc = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : function () {};
    var swapFunc = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : function () {};
    var rightClickFunc = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : function () {};
    var updateFunc = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : function () {};
    var swapDataFunc = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : function () {};
    var options = arguments.length > 5 ? arguments[5] : undefined;

    _classCallCheck(this, Bottombar);

    this.swapFunc = swapFunc;
    this.updateFunc = updateFunc;
    this.rightClickFunc = rightClickFunc;
    this.swapDataFunc = swapDataFunc;
    this.dataNames = []; // this.dragElement = null;

    this.activeEl = null;
    this.deleteEl = null;
    this.items = [];
    this.showNames = [];
    this.showBottombar = options.showBottombar;
    this.bottomBarOperate = options.bottomBarOperate;
    this.moreEl = new bottombar_DropdownMore(function (name) {
      _this5.clickSwap2(_this5.items.find(function (it) {
        return it.text() === name;
      }));
    }, options.view.height);
    this.moreEl.contentEl.css('min-width', '180px');
    this.contextMenu = new bottombar_ContextMenu();
    this.contextMenu.itemClick = this.rightClick.bind(this);

    if (this.bottomBarOperate) {
      this.el = element_h('div', "".concat(cssPrefix, "-bottombar")).children(this.contextMenu.el, element_h('div', "".concat(cssPrefix, "-menu-oper")).children(new icon_Icon('add').on('click', function () {
        addFunc();
      }), element_h('span', '').child(this.moreEl)), this.menuEl = element_h('ul', "".concat(cssPrefix, "-menu")));
    } else {
      this.el = element_h('div', "".concat(cssPrefix, "-bottombar")).children(element_h('div', "".concat(cssPrefix, "-menu-oper")).children(element_h('span', '').child(this.moreEl)), this.menuEl = element_h('ul', "".concat(cssPrefix, "-menu")));
    }

    document.ondragover = function (e) {
      e.preventDefault();
    };

    if (this.showBottombar) {
      this.show();
    } else {
      this.hide();
    }
  }

  _createClass(Bottombar, [{
    key: "rightClick",
    value: function rightClick(event, key) {
      var _this6 = this;

      var index = this.items.findIndex(function (it) {
        return it === _this6.activeEl;
      });
      var length = this.items.length;

      if (['delete', 'hideSheet'].indexOf(key) > -1 && length <= 1) {
        xtoast('提示', '至少显示一个sheet');
      } else {
        if (key === 'rename') {
          this.renameEdit(this.activeEl);
        } else if (key === 'hideSheet') {
          var nextIndex = index + 1 <= length - 1 ? index + 1 : index - 1;

          if (nextIndex > -1) {
            this.activeEl.hide();
            this.clickSwap2(this.items[nextIndex]);
          }
        } else if (key === 'colorSheet') {
          // console.log('colorSheet');
          var colorPalette = new color_palette_ColorPalette();
          var _this$contextMenu$el$ = this.contextMenu.el.el,
              offsetLeft = _this$contextMenu$el$.offsetLeft,
              offsetWidth = _this$contextMenu$el$.offsetWidth;
          colorPalette.el.css('position', 'absolute');
          colorPalette.el.css('left', offsetLeft + offsetWidth + 'px');
          colorPalette.el.css('top', '-224px');
          colorPalette.el.css('z-index', '100');

          colorPalette.change = function (v) {
            _this6.changeSheetColor(v);

            _this6.contextMenu.hide();

            colorPalette.destroyed();
          }; // debugger;


          this.el.children(colorPalette.el);
        } else if (key === 'showSheet') {
          this.items.forEach(function (item) {
            return item.show();
          });
        } else if (key === 'leftMoveSheet') {
          if (swapArray(this.items, index, index - 1)) {
            this.items[index].el.parentElement.insertBefore(this.activeEl.el, this.items[index].el);
          }
        } else if (key === 'rightMoveSheet') {
          swapArray(this.items, index, index + 1);
          this.items[index].el.parentElement.insertBefore(this.activeEl.el, this.items[index].el.nextSibling);
        }

        this.rightClickFunc(key, index);
        var lazyHideCollection = ['colorSheet'];

        if (lazyHideCollection.indexOf(key) < 0) {
          this.contextMenu.hide();
        }
      }
    }
  }, {
    key: "changeSheetColor",
    value: function changeSheetColor(color) {
      var _this7 = this;

      if (color) {
        this.activeEl.css('border-bottom', "2px solid ".concat(color));
        var index = this.items.findIndex(function (it) {
          return it === _this7.activeEl;
        });
        this.updateFunc(index, {
          color: color
        });
      }
    }
  }, {
    key: "addItem",
    value: function addItem(name, active, data) {
      var _this8 = this;

      this.dataNames.push(name); // let dragElement = this.dragElement;

      var item = element_h('li', active ? 'active' : '').child(name);
      item.addClass("".concat(cssPrefix, "-menu-item"));

      if (data.color) {
        item.css('border-bottom', "2px solid ".concat(data.color));
      }

      item.on('click', function () {
        _this8.clickSwap2(item);
      });

      if (this.bottomBarOperate) {
        item.attr('draggable', 'true');
        item.on('contextmenu', function (evt) {
          _this8.clickSwap2(item);

          var _evt$target = evt.target,
              offsetLeft = _evt$target.offsetLeft,
              offsetHeight = _evt$target.offsetHeight;

          _this8.contextMenu.setOffset({
            left: Math.max(10, offsetLeft - _this8.menuEl.el.scrollLeft - 90),
            bottom: offsetHeight + 1
          });

          _this8.deleteEl = item;
        }).on('dblclick', function () {
          _this8.renameEdit(item);
        });
        var startIndex, endIndex;
        item.el.addEventListener('drag', function (event) {
          var selectedItem = event.target,
              list = selectedItem.parentNode,
              x = event.clientX,
              y = event.clientY;
          var swapItem = document.elementFromPoint(x, y) === null ? selectedItem : document.elementFromPoint(x, y);

          if (swapItem.getAttribute('class').indexOf("".concat(cssPrefix, "-menu-item")) > -1 && selectedItem !== swapItem) {
            if (list === swapItem.parentNode) {
              swapItem = swapItem !== selectedItem.nextSibling ? swapItem : swapItem.nextSibling;
              list.insertBefore(selectedItem, swapItem);
              startIndex = _this8.items.findIndex(function (it) {
                return it.el === selectedItem;
              });
              endIndex = _this8.items.findIndex(function (it) {
                return it.el === swapItem;
              });
              return true;
            }
          }

          event.preventDefault();
          return false;
        }, false);
        item.el.addEventListener('dragend', function (event) {
          if (event.target.getAttribute('class').indexOf("".concat(cssPrefix, "-menu-item")) > -1) {
            var temp = _this8.items.splice(startIndex, 1);

            _this8.items.splice(endIndex, 0, temp[0]);

            _this8.swapDataFunc(startIndex, endIndex); // clickSwap2(items[startIndex]);


            event.preventDefault();

            _this8.resetSheetNames();

            return true;
          }

          return false;
        }, false);
      }

      if (active) {
        this.clickSwap(item);
      }

      this.items.push(item);
      this.menuEl.child(item);
      this.moreEl.reset(this.dataNames);
    }
  }, {
    key: "renameEdit",
    value: function renameEdit(item) {
      var _this9 = this;

      item.attr('draggable', 'false');
      var v = item.text();
      var input = new form_input_FormInput('auto', '');
      input.val(v);
      input.input.on('blur', function (_ref) {
        var target = _ref.target;
        var value = target.value;

        var nindex = _this9.dataNames.findIndex(function (it) {
          return it === v;
        });

        if (!_this9.dataNames.includes(value)) {
          _this9.renameItem(nindex, value);
        } else if (v === value) {
          _this9.renameItem(nindex, value);
        } else {
          xtoast('提示', '重命名错误，请查看是否存在相同名称！');
        }

        item.attr('draggable', 'true');
      });
      item.html('').child(input.el);
      input.focus();
    }
  }, {
    key: "renameItem",
    value: function renameItem(index, value) {
      this.dataNames.splice(index, 1, value);
      this.moreEl.reset(this.dataNames);
      this.items[index].html('').child(value);
      this.updateFunc(index, {
        name: value
      });
    }
  }, {
    key: "clear",
    value: function clear() {
      var _this10 = this;

      if (this.showBottombar) {
        this.show();
        this.items.forEach(function (it) {
          _this10.menuEl.removeChild(it.el);
        });
        this.items = [];
        this.dataNames = [];
        this.moreEl.reset(this.dataNames);
      } else {
        this.hide();
      }
    }
  }, {
    key: "hide",
    value: function hide() {
      this.el.hide();
    }
  }, {
    key: "show",
    value: function show() {
      this.el.css('display', 'flex');
    }
  }, {
    key: "deleteItem",
    value: function deleteItem() {
      var activeEl = this.activeEl,
          deleteEl = this.deleteEl;

      if (this.items.length > 1) {
        var index = this.items.findIndex(function (it) {
          return it === deleteEl;
        });
        this.items.splice(index, 1);
        this.dataNames.splice(index, 1);
        this.menuEl.removeChild(deleteEl.el);
        this.moreEl.reset(this.dataNames);

        if (activeEl === deleteEl) {
          var _this$items = _slicedToArray(this.items, 1),
              f = _this$items[0];

          this.activeEl = f;
          this.activeEl.toggle();
          return [index, 0];
        }

        return [index, -1];
      }

      return [-1];
    }
  }, {
    key: "clickSwap2",
    value: function clickSwap2(item) {
      var index = this.items.findIndex(function (it) {
        return it === item;
      });
      this.clickSwap(item);
      this.activeEl.toggle();
      this.swapFunc(index);
    }
  }, {
    key: "clickSwap",
    value: function clickSwap(item) {
      if (this.activeEl !== null) {
        this.activeEl.toggle();
      }

      this.activeEl = item;

      if (this.menuEl.el.scrollWidth > this.menuEl.el.clientWidth) {
        this.activeEl.el.scrollIntoView(false);
      }
    }
  }, {
    key: "getNameActive",
    value: function getNameActive() {
      return this.activeEl.text();
    }
  }, {
    key: "hideSheet",
    value: function hideSheet(sheetNames, cb) {
      this.showNames = _toConsumableArray(this.dataNames);

      var _iterator = _createForOfIteratorHelper(this.items),
          _step;

      try {
        for (_iterator.s(); !(_step = _iterator.n()).done;) {
          var item = _step.value;

          var _iterator2 = _createForOfIteratorHelper(sheetNames),
              _step2;

          try {
            for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {
              var name = _step2.value;

              if (item.text() === name) {
                item.hide();
                var index = this.showNames.indexOf(name);
                this.showNames.splice(index, 1);
              }
            }
          } catch (err) {
            _iterator2.e(err);
          } finally {
            _iterator2.f();
          }
        }
      } catch (err) {
        _iterator.e(err);
      } finally {
        _iterator.f();
      }

      this.moreEl.reset(this.showNames);
      cb(this.showNames[0]);
    }
  }, {
    key: "getSheetNames",
    value: function getSheetNames() {
      return this.dataNames;
    }
  }, {
    key: "resetSheetNames",
    value: function resetSheetNames() {
      this.dataNames = [];

      var _iterator3 = _createForOfIteratorHelper(this.menuEl.el.children),
          _step3;

      try {
        for (_iterator3.s(); !(_step3 = _iterator3.n()).done;) {
          var item = _step3.value;
          this.dataNames.push(item.innerText);
        }
      } catch (err) {
        _iterator3.e(err);
      } finally {
        _iterator3.f();
      }

      this.moreEl.reset(this.dataNames);
    }
  }]);

  return Bottombar;
}();


// EXTERNAL MODULE: ./src/sheet/index.scss
var src_sheet = __webpack_require__("ac1b");

// CONCATENATED MODULE: ./node_modules/resize-detector/esm/index.js
var raf = null;
function requestAnimationFrame (callback) {
  if (!raf) {
    raf = (
      window.requestAnimationFrame ||
      window.webkitRequestAnimationFrame ||
      window.mozRequestAnimationFrame ||
      function (callback) {
        return setTimeout(callback, 16)
      }
    ).bind(window);
  }
  return raf(callback)
}

var caf = null;
function cancelAnimationFrame (id) {
  if (!caf) {
    caf = (
      window.cancelAnimationFrame ||
      window.webkitCancelAnimationFrame ||
      window.mozCancelAnimationFrame ||
      function (id) {
        clearTimeout(id);
      }
    ).bind(window);
  }

  caf(id);
}

function createStyles (styleText) {
  var style = document.createElement('style');

  if (style.styleSheet) {
    style.styleSheet.cssText = styleText;
  } else {
    style.appendChild(document.createTextNode(styleText));
  }
  (document.querySelector('head') || document.body).appendChild(style);
  return style
}

function createElement (tagName, props) {
  if ( props === void 0 ) props = {};

  var elem = document.createElement(tagName);
  Object.keys(props).forEach(function (key) {
    elem[key] = props[key];
  });
  return elem
}

function esm_getComputedStyle (elem, prop, pseudo) {
  // for older versions of Firefox, `getComputedStyle` required
  // the second argument and may return `null` for some elements
  // when `display: none`
  var computedStyle = window.getComputedStyle(elem, pseudo || null) || {
    display: 'none'
  };

  return computedStyle[prop]
}

function getRenderInfo (elem) {
  if (!document.documentElement.contains(elem)) {
    return {
      detached: true,
      rendered: false
    }
  }

  var current = elem;
  while (current !== document) {
    if (esm_getComputedStyle(current, 'display') === 'none') {
      return {
        detached: false,
        rendered: false
      }
    }
    current = current.parentNode;
  }

  return {
    detached: false,
    rendered: true
  }
}

var css_248z = ".resize-triggers{visibility:hidden;opacity:0;pointer-events:none}.resize-contract-trigger,.resize-contract-trigger:before,.resize-expand-trigger,.resize-triggers{content:\"\";position:absolute;top:0;left:0;height:100%;width:100%;overflow:hidden}.resize-contract-trigger,.resize-expand-trigger{background:#eee;overflow:auto}.resize-contract-trigger:before{width:200%;height:200%}";

var esm_total = 0;
var esm_style = null;

function addListener (elem, callback) {
  if (!elem.__resize_mutation_handler__) {
    elem.__resize_mutation_handler__ = handleMutation.bind(elem);
  }

  var listeners = elem.__resize_listeners__;

  if (!listeners) {
    elem.__resize_listeners__ = [];
    if (window.ResizeObserver) {
      var offsetWidth = elem.offsetWidth;
      var offsetHeight = elem.offsetHeight;
      var ro = new ResizeObserver(function () {
        if (!elem.__resize_observer_triggered__) {
          elem.__resize_observer_triggered__ = true;
          if (elem.offsetWidth === offsetWidth && elem.offsetHeight === offsetHeight) {
            return
          }
        }
        runCallbacks(elem);
      });

      // initially display none won't trigger ResizeObserver callback
      var ref = getRenderInfo(elem);
      var detached = ref.detached;
      var rendered = ref.rendered;
      elem.__resize_observer_triggered__ = detached === false && rendered === false;
      elem.__resize_observer__ = ro;
      ro.observe(elem);
    } else if (elem.attachEvent && elem.addEventListener) {
      // targeting IE9/10
      elem.__resize_legacy_resize_handler__ = function handleLegacyResize () {
        runCallbacks(elem);
      };
      elem.attachEvent('onresize', elem.__resize_legacy_resize_handler__);
      document.addEventListener('DOMSubtreeModified', elem.__resize_mutation_handler__);
    } else {
      if (!esm_total) {
        esm_style = createStyles(css_248z);
      }
      initTriggers(elem);

      elem.__resize_rendered__ = getRenderInfo(elem).rendered;
      if (window.MutationObserver) {
        var mo = new MutationObserver(elem.__resize_mutation_handler__);
        mo.observe(document, {
          attributes: true,
          childList: true,
          characterData: true,
          subtree: true
        });
        elem.__resize_mutation_observer__ = mo;
      }
    }
  }

  elem.__resize_listeners__.push(callback);
  esm_total++;
}

function esm_removeListener (elem, callback) {
  var listeners = elem.__resize_listeners__;
  if (!listeners) {
    return
  }

  if (callback) {
    listeners.splice(listeners.indexOf(callback), 1);
  }

  // no listeners exist, or removing all listeners
  if (!listeners.length || !callback) {
    // targeting IE9/10
    if (elem.detachEvent && elem.removeEventListener) {
      elem.detachEvent('onresize', elem.__resize_legacy_resize_handler__);
      document.removeEventListener('DOMSubtreeModified', elem.__resize_mutation_handler__);
      return
    }

    if (elem.__resize_observer__) {
      elem.__resize_observer__.unobserve(elem);
      elem.__resize_observer__.disconnect();
      elem.__resize_observer__ = null;
    } else {
      if (elem.__resize_mutation_observer__) {
        elem.__resize_mutation_observer__.disconnect();
        elem.__resize_mutation_observer__ = null;
      }
      elem.removeEventListener('scroll', handleScroll);
      elem.removeChild(elem.__resize_triggers__.triggers);
      elem.__resize_triggers__ = null;
    }
    elem.__resize_listeners__ = null;
  }

  if (!--esm_total && esm_style) {
    esm_style.parentNode.removeChild(esm_style);
  }
}

function getUpdatedSize (elem) {
  var ref = elem.__resize_last__;
  var width = ref.width;
  var height = ref.height;
  var offsetWidth = elem.offsetWidth;
  var offsetHeight = elem.offsetHeight;
  if (offsetWidth !== width || offsetHeight !== height) {
    return {
      width: offsetWidth,
      height: offsetHeight
    }
  }
  return null
}

function handleMutation () {
  // `this` denotes the scrolling element
  var ref = getRenderInfo(this);
  var rendered = ref.rendered;
  var detached = ref.detached;
  if (rendered !== this.__resize_rendered__) {
    if (!detached && this.__resize_triggers__) {
      resetTriggers(this);
      this.addEventListener('scroll', handleScroll, true);
    }
    this.__resize_rendered__ = rendered;
    runCallbacks(this);
  }
}

function handleScroll () {
  var this$1 = this;

  // `this` denotes the scrolling element
  resetTriggers(this);
  if (this.__resize_raf__) {
    cancelAnimationFrame(this.__resize_raf__);
  }
  this.__resize_raf__ = requestAnimationFrame(function () {
    var updated = getUpdatedSize(this$1);
    if (updated) {
      this$1.__resize_last__ = updated;
      runCallbacks(this$1);
    }
  });
}

function runCallbacks (elem) {
  if (!elem || !elem.__resize_listeners__) {
    return
  }
  elem.__resize_listeners__.forEach(function (callback) {
    callback.call(elem, elem);
  });
}

function initTriggers (elem) {
  var position = esm_getComputedStyle(elem, 'position');
  if (!position || position === 'static') {
    elem.style.position = 'relative';
  }

  elem.__resize_old_position__ = position;
  elem.__resize_last__ = {};

  var triggers = createElement('div', {
    className: 'resize-triggers'
  });
  var expand = createElement('div', {
    className: 'resize-expand-trigger'
  });
  var expandChild = createElement('div');
  var contract = createElement('div', {
    className: 'resize-contract-trigger'
  });
  expand.appendChild(expandChild);
  triggers.appendChild(expand);
  triggers.appendChild(contract);
  elem.appendChild(triggers);

  elem.__resize_triggers__ = {
    triggers: triggers,
    expand: expand,
    expandChild: expandChild,
    contract: contract
  };

  resetTriggers(elem);
  elem.addEventListener('scroll', handleScroll, true);

  elem.__resize_last__ = {
    width: elem.offsetWidth,
    height: elem.offsetHeight
  };
}

function resetTriggers (elem) {
  var ref = elem.__resize_triggers__;
  var expand = ref.expand;
  var expandChild = ref.expandChild;
  var contract = ref.contract;

  // batch read
  var csw = contract.scrollWidth;
  var csh = contract.scrollHeight;
  var eow = expand.offsetWidth;
  var eoh = expand.offsetHeight;
  var esw = expand.scrollWidth;
  var esh = expand.scrollHeight;

  // batch write
  contract.scrollLeft = csw;
  contract.scrollTop = csh;
  expandChild.style.width = eow + 1 + 'px';
  expandChild.style.height = eoh + 1 + 'px';
  expand.scrollLeft = esw;
  expand.scrollTop = esh;
}



// CONCATENATED MODULE: ./src/sheet/index.js



































var sheet_Spreadsheet = /*#__PURE__*/function () {
  function Spreadsheet(selectors) {
    var _this = this;

    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};

    _classCallCheck(this, Spreadsheet);

    this.targetEl = selectors;
    this.options = _objectSpread2({}, options);
    this.sheetIndex = 1;
    this.datas = [];

    if (typeof selectors === 'string') {
      this.targetEl = document.querySelector(selectors);
    }

    this.crossExcel = function () {};

    this.bottombar = new bottombar_Bottombar(function () {
      var d = _this.addSheet();

      _this.sheet.resetData(d);
    }, function (index) {
      _this.swapSheetDataByIndex(index);

      _this.sheet.trigger('change-sheet', _this.activeSheetName);
    }, // eslint-disable-next-line no-unused-vars
    function (key, index) {
      if (key === 'delete') {
        _this.deleteSheet();
      } else if (key === 'copy') {
        var name = _this.datas[index].name + '(副本)';
        var cData = _this.datas[index];

        var d = _this.addSheet(name, true);

        d.setData(JSON.parse(JSON.stringify(cData.getData())));

        _this.sheet.resetData(d);
      } else if (key === 'leftMoveSheet') {
        swapArray(_this.datas, index, index - 1);
      } else if (key === 'rightMoveSheet') {
        swapArray(_this.datas, index, index + 1);
      }
    }, function (index, data) {
      mergeDeep(_this.datas[index], data);
    }, function (sIndex, eIndex) {
      var temp = _this.datas.splice(sIndex, 1);

      _this.datas.splice(eIndex, 0, temp[0]);
    }, this.options);
  }
  /**
   * opts.showGrid解决根据不同sheet分页数据是否显示底图的grid
   * @param name
   * @param active
   * @param opts
   * @returns {DataProxy}
   */


  _createClass(Spreadsheet, [{
    key: "addSheet",
    value: function addSheet(name) {
      var _this2 = this;

      var active = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;
      var data = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};
      // debugger;
      var n = name || this.getNewName();
      var setting = {};
      data.showGrid && (setting.showGrid = data.showGrid);
      data.color && (setting.color = data.color);
      data.row && (setting.row = data.row);
      data.col && (setting.col = data.col);
      var d = new data_proxy_DataProxy(n, data.id, _objectSpread2(_objectSpread2({}, this.options), setting));

      d.change = function () {
        var _this2$sheet;

        for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
          args[_key] = arguments[_key];
        }

        (_this2$sheet = _this2.sheet).trigger.apply(_this2$sheet, ['change'].concat(args));
      };

      this.datas.push(d); // console.log('d:', n, d, this.datas);

      d.getSheetCellText = function (ri, ci) {
        var sheetName = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;

        if (new RegExp('\\s*(\\[(.+?)\\])\\s*').test(sheetName)) {
          return _this2.crossExcel(ri, ci, sheetName);
        }

        return _this2.getBySheetNameCell(ri, ci, sheetName);
      };

      d.getSheetNames = function () {
        return {
          names: _this2.bottombar.dataNames,
          activeName: _this2.bottombar.getNameActive(),
          regNames: _this2.getRegSheetListName(_this2.bottombar.dataNames),
          expCache: d.settings.expCache
        };
      };

      this.bottombar.addItem(n, active, d);
      return d;
    }
  }, {
    key: "getNewName",
    value: function getNewName() {
      var dataNames = this.bottombar.dataNames.filter(function (name) {
        return /^Sheet\d+$/.test(name);
      });
      var arr = [1];

      var _iterator = _createForOfIteratorHelper(dataNames),
          _step;

      try {
        for (_iterator.s(); !(_step = _iterator.n()).done;) {
          var name = _step.value;
          var regex = /\d+/g; // 匹配数字的正则表达式

          var matches = name.match(regex); // 使用正则表达式匹配字符串

          if (matches) {
            var number = parseInt(matches[0]); // 将匹配到的字符串转换为整数

            arr.push(number);
          }
        }
      } catch (err) {
        _iterator.e(err);
      } finally {
        _iterator.f();
      }

      var maxNum = Math.max.apply(Math, arr);
      return "Sheet".concat(maxNum + 1);
    }
  }, {
    key: "deleteSheet",
    value: function deleteSheet() {
      var _this$bottombar$delet = this.bottombar.deleteItem(),
          _this$bottombar$delet2 = _slicedToArray(_this$bottombar$delet, 2),
          oldIndex = _this$bottombar$delet2[0],
          nindex = _this$bottombar$delet2[1];

      if (oldIndex >= 0) {
        this.datas.splice(oldIndex, 1);
        if (nindex >= 0) this.sheet.resetData(this.datas[nindex]);
      }
    }
  }, {
    key: "getActiveSheetName",
    value: function getActiveSheetName() {
      return this.bottombar.getNameActive();
    }
  }, {
    key: "swapSheetByName",
    value: function swapSheetByName(name) {
      var index = this.datas.findIndex(function (o) {
        return o.name === name;
      });
      this.swapSheetByIndex(index);
    }
  }, {
    key: "swapSheetByIndex",
    value: function swapSheetByIndex(index) {
      var item = this.bottombar.items[index];

      if (item) {
        item.el.click();
      } // const name = this.datas[index].name;
      // this.swapSheetByName(name);

    }
  }, {
    key: "swapSheetDataByIndex",
    value: function swapSheetDataByIndex(index) {
      var d = this.datas[index];

      if (d) {
        this.activeSheetName = d.name;
        this.sheet.resetData(d);
      }
    }
  }, {
    key: "loadData",
    value: function loadData(data) {
      this.resetExcelData(data, false);
      this.init();
      return this;
    }
  }, {
    key: "resetExcelData",
    value: function resetExcelData(data) {
      var reset = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;
      var ds = Array.isArray(data) ? data : [data];
      this.bottombar.clear();
      this.datas = [];

      if (ds.length > 0) {
        for (var i = 0; i < ds.length; i += 1) {
          var it = ds[i];
          var nd = this.addSheet(it === null || it === void 0 ? void 0 : it.name, (it === null || it === void 0 ? void 0 : it.active) || 0 === i, it);
          nd.setData(it);

          if (i === 0) {
            this.data = nd;

            if (reset) {
              this.sheet.resetData(this.data);
            }
          }
        }
      }
    }
  }, {
    key: "getRegSheetListName",
    value: function getRegSheetListName(names) {
      var sheetListName = names.map(function (item) {
        if (/([A-Z]+[0-9]+)/g.test(item)) {
          return "'".concat(item, "'");
        }

        return regScapeStr(item);
      });
      return new RegExp("(".concat(sheetListName.join('|'), ")+!([A-Z]+[0-9]+)|([A-Z]+[0-9]+)|(?:'((\\[(.+?)\\])([\\u4e00-\\u9fa5a-zA-Z0-9\u3010\u3011\uFF08\uFF09<>_]+)?\\'\\!)([A-Z]+[0-9]+))"), 'g');
    }
  }, {
    key: "resetSheet",
    value: function resetSheet(options, data) {
      this.options = _objectSpread2(_objectSpread2({}, this.options), options);
      this.resetExcelData(data ? data : this.getData());
    }
  }, {
    key: "destroyed",
    value: function destroyed() {
      this.targetEl.innerHTML = '';
      esm_removeListener(this.targetEl, this.resize.bind(this));
      this.sheet.destroyed();
      this.sheet = null;
      this.datas = [];
    }
  }, {
    key: "init",
    value: function init() {
      var _this3 = this;

      var rootEl = element_h('div', "".concat(cssPrefix)).on('contextmenu', function (evt) {
        return evt.preventDefault();
      });
      this.targetEl.appendChild(rootEl.el);
      this.sheet = new sheet_Sheet(rootEl, this.data, function (d) {
        _this3.resetExcelData(d, true);
      });
      rootEl.child(this.bottombar.el);
      this.clearCache();
      this.sheet.resetData(this.data);
      esm_removeListener(this.targetEl, this.resize.bind(this));
      addListener(this.targetEl, this.resize.bind(this));
    }
  }, {
    key: "resize",
    value: function resize() {
      this.sheet.editor.clear();
      this.sheet.data.scroll.ci = 0;
      this.sheet.data.scroll.ri = 0;
      this.sheet.data.scroll.x = 0;
      this.sheet.data.scroll.y = 0;
      this.sheet.reload();
    }
  }, {
    key: "getData",
    value: function getData() {
      return this.datas.map(function (it) {
        return it.getData();
      });
    }
  }, {
    key: "cellText",
    value: function cellText(ri, ci, text) {
      var sheetIndex = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0;
      this.datas[sheetIndex].setCellText(ri, ci, text, '');
      return this;
    }
  }, {
    key: "cell",
    value: function cell(ri, ci) {
      var sheetIndex = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;
      return this.datas[sheetIndex].getCell(ri, ci);
    }
  }, {
    key: "getBySheetNameCell",
    value: function getBySheetNameCell(ri, ci, sheetName) {
      var instant = null;

      var _iterator2 = _createForOfIteratorHelper(this.datas),
          _step2;

      try {
        for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {
          var data = _step2.value;
          var name = data.name;

          if (/([A-Z]+[0-9]+)/g.test(name) || /[\-\/\\\^\$\*\+\?\.\(\)\|\[\]\{\}]/g.test(name)) {
            name = "'".concat(name, "'");
          }

          if (nameEncode(name) === sheetName) {
            instant = data;
            break;
          }
        }
      } catch (err) {
        _iterator2.e(err);
      } finally {
        _iterator2.f();
      }

      return instant && instant.getCell(ri, ci);
    }
  }, {
    key: "getBySheetNameCellVal",
    value: function getBySheetNameCellVal(ri, ci, sheetName) {
      var instant = null;

      var _iterator3 = _createForOfIteratorHelper(this.datas),
          _step3;

      try {
        for (_iterator3.s(); !(_step3 = _iterator3.n()).done;) {
          var data = _step3.value;
          var name = data.name;

          if ("'".concat(name, "'") === sheetName) {
            instant = data;
            break;
          }
        }
      } catch (err) {
        _iterator3.e(err);
      } finally {
        _iterator3.f();
      }

      return instant && {
        text: instant.getCellParseValue(ri, ci, sheetName)
      };
    }
  }, {
    key: "cellStyle",
    value: function cellStyle(ri, ci) {
      var sheetIndex = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;
      return this.datas[sheetIndex].getCellStyle(ri, ci);
    }
  }, {
    key: "reRender",
    value: function reRender() {
      this.sheet.table.render();
      return this;
    }
  }, {
    key: "on",
    value: function on(eventName, func) {
      this.sheet.on(eventName, func);
      return this;
    }
  }, {
    key: "off",
    value: function off(eventName, func) {
      this.sheet.off(eventName, func);
      return this;
    }
  }, {
    key: "validate",
    value: function validate() {
      var validations = this.data.validations;
      return validations.errors.size <= 0;
    }
  }, {
    key: "change",
    value: function change(cb) {
      this.sheet.on('change', cb);
      return this;
    }
  }, {
    key: "getSheetNames",
    value: function getSheetNames() {
      return this.bottombar.getSheetNames();
    }
  }, {
    key: "hideSheet",
    value: function hideSheet() {
      var _this4 = this;

      var sheetNames = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];
      this.bottombar.hideSheet(sheetNames, function (name) {
        _this4.swapSheetByName(name);
      });
    }
  }, {
    key: "examine",
    value: function examine() {
      var sheets = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];
      var modes = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : ['error', 'warn'];
      var cb = arguments.length > 2 ? arguments[2] : undefined;
      var isExternal = arguments.length > 3 ? arguments[3] : undefined;
      var examines = [];
      var crossSheetExp = [];

      var _iterator4 = _createForOfIteratorHelper(this.datas),
          _step4;

      try {
        for (_iterator4.s(); !(_step4 = _iterator4.n()).done;) {
          var _data = _step4.value;

          _data.examines.clearError();
        }
      } catch (err) {
        _iterator4.e(err);
      } finally {
        _iterator4.f();
      }

      var _iterator5 = _createForOfIteratorHelper(this.datas),
          _step5;

      try {
        for (_iterator5.s(); !(_step5 = _iterator5.n()).done;) {
          var _data2 = _step5.value;
          var _name = _data2.name;

          if (sheets.includes(_name)) {
            var errors = _data2.examine(modes, function (expr, mode) {
              var _expr$split = expr.split('!'),
                  _expr$split2 = _slicedToArray(_expr$split, 2),
                  sheetName = _expr$split2[0],
                  exp = _expr$split2[1];

              sheetName = sheetName.replace(/\'/g, '');
              crossSheetExp.push({
                sheetName: sheetName,
                exp: exp,
                mode: mode
              });
            }, isExternal);

            var errorsNum = _data2.examines.getModeNum('error');

            var warnsNum = _data2.examines.getModeNum('warn');

            examines.push({
              name: _name,
              errors: errors,
              errorsNum: errorsNum,
              warnsNum: warnsNum
            });

            if (cb) {
              cb(_data2);
            }
          }
        }
      } catch (err) {
        _iterator5.e(err);
      } finally {
        _iterator5.f();
      }

      for (var _i = 0, _crossSheetExp = crossSheetExp; _i < _crossSheetExp.length; _i++) {
        var _crossSheetExp$_i = _crossSheetExp[_i],
            sheetName = _crossSheetExp$_i.sheetName,
            exp = _crossSheetExp$_i.exp,
            mode = _crossSheetExp$_i.mode;

        var _iterator6 = _createForOfIteratorHelper(this.datas),
            _step6;

        try {
          for (_iterator6.s(); !(_step6 = _iterator6.n()).done;) {
            var data = _step6.value;
            var name = data.name;

            if (sheetName === name) {
              data.examines.setErrorRefs(exp, mode);
            }
          }
        } catch (err) {
          _iterator6.e(err);
        } finally {
          _iterator6.f();
        }
      }

      return examines;
    }
  }, {
    key: "resetExamine",
    value: function resetExamine() {
      var crossSheetExp = [];

      var _iterator7 = _createForOfIteratorHelper(this.datas),
          _step7;

      try {
        for (_iterator7.s(); !(_step7 = _iterator7.n()).done;) {
          var _data3 = _step7.value;

          _data3.examines.clearErrorRefs();
        }
      } catch (err) {
        _iterator7.e(err);
      } finally {
        _iterator7.f();
      }

      var _iterator8 = _createForOfIteratorHelper(this.datas),
          _step8;

      try {
        for (_iterator8.s(); !(_step8 = _iterator8.n()).done;) {
          var _data4 = _step8.value;

          _data4.examines.reset(function (expr, mode) {
            var _expr$split3 = expr.split('!'),
                _expr$split4 = _slicedToArray(_expr$split3, 2),
                sheetName = _expr$split4[0],
                exp = _expr$split4[1];

            sheetName = sheetName.replace(/\'/g, '');
            crossSheetExp.push({
              sheetName: sheetName,
              exp: exp,
              mode: mode
            });
          });
        }
      } catch (err) {
        _iterator8.e(err);
      } finally {
        _iterator8.f();
      }

      for (var _i2 = 0, _crossSheetExp2 = crossSheetExp; _i2 < _crossSheetExp2.length; _i2++) {
        var _crossSheetExp2$_i = _crossSheetExp2[_i2],
            sheetName = _crossSheetExp2$_i.sheetName,
            exp = _crossSheetExp2$_i.exp,
            mode = _crossSheetExp2$_i.mode;

        var _iterator9 = _createForOfIteratorHelper(this.datas),
            _step9;

        try {
          for (_iterator9.s(); !(_step9 = _iterator9.n()).done;) {
            var data = _step9.value;
            var name = data.name;

            if (sheetName === name) {
              data.examines.setErrorRefs(exp, mode);
            }
          }
        } catch (err) {
          _iterator9.e(err);
        } finally {
          _iterator9.f();
        }
      }
    }
  }, {
    key: "setErrorPass",
    value: function setErrorPass(sheet, ref, isPass) {
      var _iterator10 = _createForOfIteratorHelper(this.datas),
          _step10;

      try {
        for (_iterator10.s(); !(_step10 = _iterator10.n()).done;) {
          var data = _step10.value;
          var name = data.name;

          if (name == sheet) {
            return data.examines.setErrorPass(ref, isPass);
          }
        }
      } catch (err) {
        _iterator10.e(err);
      } finally {
        _iterator10.f();
      }

      return false;
    }
  }, {
    key: "getExamineInfo",
    value: function getExamineInfo() {
      var sheets = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];
      var examines = [];

      var _iterator11 = _createForOfIteratorHelper(this.datas),
          _step11;

      try {
        for (_iterator11.s(); !(_step11 = _iterator11.n()).done;) {
          var data = _step11.value;
          var name = data.name;

          if (sheets.includes(name)) {
            var errors = data.examines.errors;
            var errorsNum = data.examines.getModeNum('error');
            var warnsNum = data.examines.getModeNum('warn');
            examines.push({
              name: name,
              errors: errors,
              errorsNum: errorsNum,
              warnsNum: warnsNum
            });
          }
        }
      } catch (err) {
        _iterator11.e(err);
      } finally {
        _iterator11.f();
      }

      return examines;
    }
  }, {
    key: "gotoxy",
    value: function gotoxy(sheet, ri, ci) {
      this.swapSheetByName(sheet);

      var _iterator12 = _createForOfIteratorHelper(this.datas),
          _step12;

      try {
        for (_iterator12.s(); !(_step12 = _iterator12.n()).done;) {
          var data = _step12.value;
          var name = data.name;

          if (name == sheet) {
            return this.sheet.gotoxy(ri, ci);
          }
        }
      } catch (err) {
        _iterator12.e(err);
      } finally {
        _iterator12.f();
      }

      return false;
    }
  }, {
    key: "setCellEditable",
    value: function setCellEditable(sheet, ri, ci, editable) {
      var _iterator13 = _createForOfIteratorHelper(this.datas),
          _step13;

      try {
        for (_iterator13.s(); !(_step13 = _iterator13.n()).done;) {
          var data = _step13.value;
          var name = data.name;

          if (name == sheet) {
            return data.setCellEditable(ri, ci, editable);
          }
        }
      } catch (err) {
        _iterator13.e(err);
      } finally {
        _iterator13.f();
      }
    }
  }, {
    key: "clearCache",
    value: function clearCache() {
      var _iterator14 = _createForOfIteratorHelper(this.datas),
          _step14;

      try {
        for (_iterator14.s(); !(_step14 = _iterator14.n()).done;) {
          var data = _step14.value;
          data.clearCache();
        }
      } catch (err) {
        _iterator14.e(err);
      } finally {
        _iterator14.f();
      }
    }
  }], [{
    key: "locale",
    value: function locale(lang, message) {
      locale_locale(lang, message);
    }
  }]);

  return Spreadsheet;
}();

var spreadsheet = function spreadsheet(el) {
  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
  return new sheet_Spreadsheet(el, options);
};

if (window) {
  window.x_spreadsheet = spreadsheet;

  window.x_spreadsheet.locale = function (lang, message) {
    return locale_locale(lang, message);
  };
}

/* harmony default export */ var src_sheet_0 = (sheet_Spreadsheet);

// EXTERNAL MODULE: ./src/sheet/assets/font/iconfont.css
var iconfont = __webpack_require__("d7fe");

// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js??ref--13-0!./node_modules/thread-loader/dist/cjs.js!./node_modules/babel-loader/lib!./node_modules/cache-loader/dist/cjs.js??ref--1-0!./node_modules/vue-loader/lib??vue-loader-options!./src/sheet/index.vue?vue&type=script&lang=js&

//
//
//


/* harmony default export */ var sheetvue_type_script_lang_js_ = ({
  name: 'spreadsheet',
  components: {},
  props: {
    sheetData: [Array]
  },
  methods: {
    init: function init(config, sheetData) {
      this.spreadsheet = new src_sheet_0(this.$el, config);
      this.spreadsheet.loadData(sheetData);
      this.eventInit(this.spreadsheet);
      return this.spreadsheet;
    },
    resetExcelData: function resetExcelData(sheetData) {
      this.spreadsheet.resetExcelData(sheetData || this.sheetData);
    },
    eventInit: function eventInit(spreadsheet) {
      var _this = this;

      spreadsheet.change(function () {
        for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
          args[_key] = arguments[_key];
        }

        return _this.$emit('change', args);
      });
      spreadsheet.on('cell-selected', function () {
        for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {
          args[_key2] = arguments[_key2];
        }

        return _this.$emit.apply(_this, ['cell-selected', _this.spreadsheet].concat(args));
      });
      spreadsheet.on('cell-edited', function () {
        for (var _len3 = arguments.length, args = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {
          args[_key3] = arguments[_key3];
        }

        return _this.$emit.apply(_this, ['cell-edited', _this.spreadsheet].concat(args));
      });
      spreadsheet.on('cells-selected', function () {
        for (var _len4 = arguments.length, args = new Array(_len4), _key4 = 0; _key4 < _len4; _key4++) {
          args[_key4] = arguments[_key4];
        }

        return _this.$emit.apply(_this, ['cells-selected', _this.spreadsheet].concat(args));
      });
      spreadsheet.on('tool-selected', function () {
        for (var _len5 = arguments.length, args = new Array(_len5), _key5 = 0; _key5 < _len5; _key5++) {
          args[_key5] = arguments[_key5];
        }

        return _this.$emit.apply(_this, ['tool-selected', _this.spreadsheet].concat(args));
      });
      spreadsheet.on('sort-filter', function () {
        for (var _len6 = arguments.length, args = new Array(_len6), _key6 = 0; _key6 < _len6; _key6++) {
          args[_key6] = arguments[_key6];
        }

        return _this.$emit.apply(_this, ['sort-filter', _this.spreadsheet].concat(args));
      });
      spreadsheet.on('open-functions', function () {
        for (var _len7 = arguments.length, args = new Array(_len7), _key7 = 0; _key7 < _len7; _key7++) {
          args[_key7] = arguments[_key7];
        }

        return _this.$emit.apply(_this, ['open-functions', _this.spreadsheet].concat(args));
      });
      spreadsheet.on('validation', function () {
        for (var _len8 = arguments.length, args = new Array(_len8), _key8 = 0; _key8 < _len8; _key8++) {
          args[_key8] = arguments[_key8];
        }

        return _this.$emit.apply(_this, ['validation', _this.spreadsheet].concat(args));
      });
      spreadsheet.on('edit-format', function () {
        for (var _len9 = arguments.length, args = new Array(_len9), _key9 = 0; _key9 < _len9; _key9++) {
          args[_key9] = arguments[_key9];
        }

        return _this.$emit.apply(_this, ['edit-format', _this.spreadsheet].concat(args));
      });
      spreadsheet.on('set-cell-size', function () {
        for (var _len10 = arguments.length, args = new Array(_len10), _key10 = 0; _key10 < _len10; _key10++) {
          args[_key10] = arguments[_key10];
        }

        return _this.$emit.apply(_this, ['set-cell-size', _this.spreadsheet].concat(args));
      });
    }
  },
  beforeDestroy: function beforeDestroy() {
    var _this$spreadsheet;

    // debugger;
    (_this$spreadsheet = this.spreadsheet) === null || _this$spreadsheet === void 0 ? void 0 : _this$spreadsheet.destroyed();
  }
});
// CONCATENATED MODULE: ./src/sheet/index.vue?vue&type=script&lang=js&
 /* harmony default export */ var src_sheetvue_type_script_lang_js_ = (sheetvue_type_script_lang_js_); 
// EXTERNAL MODULE: ./src/sheet/index.vue?vue&type=style&index=0&id=018ee75b&lang=scss&scoped=true&
var sheetvue_type_style_index_0_id_018ee75b_lang_scss_scoped_true_ = __webpack_require__("f3f9");

// CONCATENATED MODULE: ./node_modules/vue-loader/lib/runtime/componentNormalizer.js
/* globals __VUE_SSR_CONTEXT__ */

// IMPORTANT: Do NOT use ES2015 features in this file (except for modules).
// This module is a runtime utility for cleaner component module output and will
// be included in the final webpack user bundle.

function normalizeComponent (
  scriptExports,
  render,
  staticRenderFns,
  functionalTemplate,
  injectStyles,
  scopeId,
  moduleIdentifier, /* server only */
  shadowMode /* vue-cli only */
) {
  // Vue.extend constructor export interop
  var options = typeof scriptExports === 'function'
    ? scriptExports.options
    : scriptExports

  // render functions
  if (render) {
    options.render = render
    options.staticRenderFns = staticRenderFns
    options._compiled = true
  }

  // functional template
  if (functionalTemplate) {
    options.functional = true
  }

  // scopedId
  if (scopeId) {
    options._scopeId = 'data-v-' + scopeId
  }

  var hook
  if (moduleIdentifier) { // server build
    hook = function (context) {
      // 2.3 injection
      context =
        context || // cached call
        (this.$vnode && this.$vnode.ssrContext) || // stateful
        (this.parent && this.parent.$vnode && this.parent.$vnode.ssrContext) // functional
      // 2.2 with runInNewContext: true
      if (!context && typeof __VUE_SSR_CONTEXT__ !== 'undefined') {
        context = __VUE_SSR_CONTEXT__
      }
      // inject component styles
      if (injectStyles) {
        injectStyles.call(this, context)
      }
      // register component module identifier for async chunk inferrence
      if (context && context._registeredComponents) {
        context._registeredComponents.add(moduleIdentifier)
      }
    }
    // used by ssr in case component is cached and beforeCreate
    // never gets called
    options._ssrRegister = hook
  } else if (injectStyles) {
    hook = shadowMode
      ? function () {
        injectStyles.call(
          this,
          (options.functional ? this.parent : this).$root.$options.shadowRoot
        )
      }
      : injectStyles
  }

  if (hook) {
    if (options.functional) {
      // for template-only hot-reload because in that case the render fn doesn't
      // go through the normalizer
      options._injectStyles = hook
      // register for functional component in vue file
      var originalRender = options.render
      options.render = function renderWithStyleInjection (h, context) {
        hook.call(context)
        return originalRender(h, context)
      }
    } else {
      // inject component registration as beforeCreate hook
      var existing = options.beforeCreate
      options.beforeCreate = existing
        ? [].concat(existing, hook)
        : [hook]
    }
  }

  return {
    exports: scriptExports,
    options: options
  }
}

// CONCATENATED MODULE: ./src/sheet/index.vue






/* normalize component */

var component = normalizeComponent(
  src_sheetvue_type_script_lang_js_,
  sheetvue_type_template_id_018ee75b_scoped_true_render,
  sheetvue_type_template_id_018ee75b_scoped_true_staticRenderFns,
  false,
  null,
  "018ee75b",
  null
  
)

/* harmony default export */ var src_sheet_1 = (component.exports);
// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"7cdf87ba-vue-loader-template"}!./node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ref--1-0!./node_modules/vue-loader/lib??vue-loader-options!./src/dialog/index.vue?vue&type=template&id=567349bb&
var dialogvue_type_template_id_567349bb_render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:"dialog-content"},[(_vm.type === 'print')?_c('print',{attrs:{"getSpreadsheet":_vm.getSpreadsheet},on:{"cancelDialog":_vm.cancelDialog}}):_vm._e(),(_vm.type === 'sort-filter')?_c('filter-seletor',{ref:"sortFilter",attrs:{"config":_vm.config,"getSpreadsheet":_vm.getSpreadsheet,"getOptions":_vm.getOptions},on:{"cancelDialog":_vm.cancelDialog}}):_vm._e(),(_vm.type === 'validation')?_c('validation',{attrs:{"getSpreadsheet":_vm.getSpreadsheet,"getOptions":_vm.getOptions},on:{"cancelDialog":_vm.cancelDialog}}):_vm._e(),(_vm.type === 'lookUp')?_c('lookUp',{attrs:{"getSpreadsheet":_vm.getSpreadsheet,"getOptions":_vm.getOptions},on:{"cancelDialog":_vm.cancelDialog}}):_vm._e(),(_vm.type === 'edit-format')?_c('editFormat',{attrs:{"getSpreadsheet":_vm.getSpreadsheet,"getOptions":_vm.getOptions},on:{"cancelDialog":_vm.cancelDialog}}):_vm._e(),(_vm.type === 'set-cell-size')?_c('setCellSize',{attrs:{"getSpreadsheet":_vm.getSpreadsheet,"getOptions":_vm.getOptions},on:{"cancelDialog":_vm.cancelDialog}}):_vm._e()],1)}
var dialogvue_type_template_id_567349bb_staticRenderFns = []


// CONCATENATED MODULE: ./src/dialog/index.vue?vue&type=template&id=567349bb&

// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"7cdf87ba-vue-loader-template"}!./node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ref--1-0!./node_modules/vue-loader/lib??vue-loader-options!./src/dialog/print/index.vue?vue&type=template&id=23791342&scoped=true&
var printvue_type_template_id_23791342_scoped_true_render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:"x-spreadsheet-print",staticStyle:{"display":"block"}},[_c('div',{staticClass:"x-spreadsheet-print-bar"},[_c('div',{staticClass:"-title"},[_vm._v("打印预览")]),_c('div',{staticClass:"-right"},[_c('div',{staticClass:"x-spreadsheet-buttons"},[_c('el-button',{on:{"click":_vm.goBack}},[_vm._v("取消")]),_c('el-button',{on:{"click":_vm.toPrint}},[_vm._v("下一步")])],1)])]),_c('div',{staticClass:"x-spreadsheet-print-content"},[_c('div',{staticClass:"-content"},[_c('div',{ref:"canvasWrap",staticClass:"x-spreadsheet-canvas-card-wrap"})]),_c('div',{staticClass:"-sider"},[_c('el-form',{staticStyle:{"padding-top":"20px"},attrs:{"label-width":"80px"},nativeOn:{"submit":function($event){$event.preventDefault();}}},[_c('el-form-item',{attrs:{"label":"纸张大小"}},[_c('el-select',{attrs:{"placeholder":"请选择"},on:{"change":_vm.initPreview},model:{value:(_vm.printType),callback:function ($$v) {_vm.printType=$$v},expression:"printType"}},_vm._l((_vm.getPageSizes()),function(item){return _c('el-option',{key:item.key,attrs:{"label":((item.key) + "(" + (item.value) + ")"),"value":item.key}})}),1)],1),_c('el-form-item',{attrs:{"label":"方向"}},[_c('el-select',{attrs:{"placeholder":"请选择"},on:{"change":_vm.initPreview},model:{value:(_vm.orientation),callback:function ($$v) {_vm.orientation=$$v},expression:"orientation"}},_vm._l((_vm.getPageOrientations()),function(item){return _c('el-option',{key:item.value,attrs:{"label":item.name,"value":item.value}})}),1)],1)],1)],1)])])}
var printvue_type_template_id_23791342_scoped_true_staticRenderFns = []


// CONCATENATED MODULE: ./src/dialog/print/index.vue?vue&type=template&id=23791342&scoped=true&

// CONCATENATED MODULE: ./src/sheet/canvas/preview.js























function NoToChinese(num) {
  if (!/^\d*(\.\d*)?$/.test(num)) {
    alert('Number is wrong!');
    return 'Number is wrong!';
  }

  var aa = new Array('零', '一', '二', '三', '四', '五', '六', '七', '八', '九');
  var bb = new Array('', '十', '百', '千', '万', '亿', '点', '');
  var a = ('' + num).replace(/(^0*)/g, '').split('.'),
      k = 0,
      re = '';

  for (var i = a[0].length - 1; i >= 0; i--) {
    switch (k) {
      case 0:
        re = bb[7] + re;
        break;

      case 4:
        if (!new RegExp('0{4}\\d{' + (a[0].length - i - 1) + '}$').test(a[0])) re = bb[4] + re;
        break;

      case 8:
        re = bb[5] + re;
        bb[7] = bb[5];
        k = 0;
        break;

      default:
        break;
    }

    if (k % 4 == 2 && a[0].charAt(i + 2) != 0 && a[0].charAt(i + 1) == 0) re = aa[0] + re;
    if (a[0].charAt(i) != 0) re = aa[a[0].charAt(i)] + bb[k % 4] + re;
    k++;
  }

  if (a.length > 1) {
    //加上小数部分(如果有小数部分)
    re += bb[6];

    for (var _i = 0; _i < a[1].length; _i++) {
      re += aa[a[1].charAt(_i)];
    }
  }

  return re;
}
/**
 * 清除脏数据
 */


function clearDeatData(proxyData) {
  /**
   * 清除空数据
   */
  var maxRowLen = 0,
      maxColumnLen = 0;
  Object.keys(proxyData.rows._).forEach(function (rowIndex) {
    var row = proxyData.rows._[rowIndex];
    Object.keys(row.cells).forEach(function (cellIndex) {
      if (typeof row.cells[cellIndex].text !== 'undefined' && row.cells[cellIndex].text !== '') {
        maxRowLen < parseInt(rowIndex) && (maxRowLen = parseInt(rowIndex));
        maxColumnLen < parseInt(cellIndex) && (maxColumnLen = parseInt(cellIndex));
      }
    });
  });
  proxyData.cols.len = maxColumnLen + 1;
  proxyData.rows.len = maxRowLen + 1;
  /**
   * 清除空数据---end
   */
}
/**
 * return {
 *  pages:[
 *    {
 *      index:1,
 *      rows:[1,2,3]
 *    }
 *  ],
 *  headRowIndexs:[],
 *  footerRowIndexs:[],
 *  left: 0,
 *  top: 0
 * }
 * @param {*} dataProxy
 * @param {*} paper
 */


function getPagesConfig(dataProxy, paper, isCenter) {
  var width = paper.width,
      height = paper.height,
      padding = paper.padding;
  var left = padding;
  var top = padding;

  if (isCenter) {
    var colsWidth = dataProxy.cols.sumWidth(0, dataProxy.cols.len);

    if (colsWidth < width) {
      left = (width - colsWidth) / 2;
    }
  }

  var headRowIndexs = Object.keys(dataProxy.rows._).map(function (n) {
    return parseInt(n);
  }).filter(function (index) {
    return dataProxy.rows._[index].renderType === '2';
  });
  var footerRowIndexs = Object.keys(dataProxy.rows._).map(function (n) {
    return parseInt(n);
  }).filter(function (index) {
    return dataProxy.rows._[index].renderType === '4';
  });
  var headHeight = 0;
  headRowIndexs.forEach(function (index) {
    headHeight += dataProxy.rows._[index].height || dataProxy.rows.height;
  });
  var footerHeight = 0;
  footerRowIndexs.forEach(function (index) {
    footerHeight += dataProxy.rows._[index].height || dataProxy.rows.height;
  });
  var contentHeight = height - padding * 2;

  if (paper.showHeader) {
    contentHeight -= headHeight;
  }

  if (paper.showFooter) {
    contentHeight -= footerHeight;
  }

  var cr = dataProxy.contentRange();
  cr.eri = dataProxy.rows.len - 1;
  cr.eci = dataProxy.cols.len - 1;
  var th = 0,
      curHeight = 0;
  var pages = [];
  var footerOffset = 0;

  for (var ri = 0, pageIndex = 0; ri <= cr.eri; ri += 1) {
    var rh = dataProxy.rows.getHeight(ri);

    if (paper.showHeader) {
      if (headRowIndexs.indexOf(ri) > -1) {
        continue;
      }
    }

    if (paper.showFooter) {
      if (footerRowIndexs.indexOf(ri) > -1) {
        continue;
      }
    }

    th += rh;
    curHeight += rh;

    if (contentHeight >= curHeight) {
      footerOffset += rh;

      if (!pages[pageIndex]) {
        pages[pageIndex] = {
          index: pageIndex + 1,
          rows: [],
          drawOffset: -(th - rh + (paper.showHeader ? headHeight : 0))
        };
      }

      pages[pageIndex].pageHeight = curHeight;
      pages[pageIndex].rows.push(ri);
    } else {
      pageIndex++;
      curHeight = rh;
      pages[pageIndex] = {
        index: pageIndex + 1,
        rows: [ri],
        drawOffset: -(th - rh + (paper.showHeader ? headHeight : 0))
      };
    }
  }

  return {
    pages: pages,
    headRowIndexs: headRowIndexs,
    headHeight: headHeight,
    footerRowIndexs: footerRowIndexs,
    footerHeight: footerHeight,
    footerOffset: footerOffset,
    left: left,
    top: top,
    contentHeight: contentHeight
  };
}

function mergeData(dataProxy, pagesConfig) {
  var _merges = JSON.parse(JSON.stringify(dataProxy.merges._));

  pagesConfig.pages.forEach(function (page) {
    // let pageStartRow = page.rows[0];
    var pageEndRow = page.rows[page.rows.length - 1];

    _merges.forEach(function (merge) {
      if (merge.eri > pageEndRow && merge.sri <= pageEndRow) {
        dataProxy.selector.range = new cell_range(merge.sri, merge.sci, merge.eri, merge.eci);
        dataProxy.unmerge();

        var tempMerge = _objectSpread2({}, merge);

        tempMerge.sri = pageEndRow + 1;
        tempMerge.eri = merge.eri;
        merge.eri = pageEndRow;
        var tempCell = dataProxy.getCell(merge.sri, merge.sci);
        dataProxy.rows._[tempMerge.sri].cells[tempMerge.sci] = {
          text: tempCell.text,
          style: tempCell.style
        };
        dataProxy.selector.range = new cell_range(merge.sri, merge.sci, merge.eri, merge.eci);
        dataProxy.merge();
        dataProxy.selector.range = new cell_range(tempMerge.sri, tempMerge.sci, tempMerge.eri, tempMerge.eci);
        dataProxy.merge();
      }
    }); // let mergesTemp = [];
    // _merges.forEach(merge => {
    //   if (merge.eri > pageEndRow && merge.sri <= pageEndRow) {
    //     dataProxy.selector.range = new CellRange(merge.sri, merge.sci, merge.eri, merge.eci);
    //     dataProxy.unmerge();
    //     let tempMerge = { ...merge };
    //     tempMerge.sri = pageEndRow + 1;
    //     tempMerge.eri = merge.eri;
    //     merge.eri = pageEndRow;
    //     let tempCell = dataProxy.getCell(merge.sri, merge.sci);
    //     dataProxy.rows._[tempMerge.sri].cells[tempMerge.sci] = { text: tempCell.text, style: tempCell.style };
    //     mergesTemp.push(merge);
    //     mergesTemp.push(tempMerge);
    //   }
    // });
    // let tempMergers = mergesTemp
    //   .filter(o => o.eri < pageEndRow && o.sri >= pageStartRow)
    //   .map(o => {
    //     let cellRange = new CellRange(o.sri, o.sci, o.eri, o.eci);
    //     dataProxy.selector.range = cellRange;
    //     dataProxy.merge();
    //     let cellRangeTemp = new CellRange(o.sri, o.sci, o.eri, o.eci);
    //     return cellRangeTemp;
    //   });
    // dataProxy.merges._ = tempMergers;

  }); // return mergesTemp;
}

function drawContent(dataProxy, paper, pagesConfig, appendTarget) {
  var width = paper.width,
      height = paper.height;
  var pages = pagesConfig.pages;
  var canvases = [];
  var printPageNum = pagesConfig.pageNumber;
  var cr = dataProxy.contentRange();
  cr.eri = dataProxy.rows.len - 1;
  cr.eci = dataProxy.cols.len - 1;
  pages.forEach(function (page) {
    var wrap = element_h('div', "x-spreadsheet-canvas-card");
    wrap.css({
      width: "".concat(width, "px"),
      height: "".concat(height, "px")
    });
    var canvas = element_h('canvas', "x-spreadsheet-canvas");
    canvases.push(canvas.el);
    var draw = new draw_Draw(canvas.el, width, height);
    var dpr = window.devicePixelRatio || 1;
    draw.ctx.scale(1 / dpr, 1 / dpr);
    var mViewRange = {
      sri: 0,
      sci: 0,
      eri: 0,
      eci: 0
    };
    mViewRange.sri = page.rows[0];
    mViewRange.eri = page.rows[page.rows.length - 1];
    var top = pagesConfig.top;

    if (paper.showHeader) {
      top += pagesConfig.headHeight;
    } // draw.restore();
    // draw.save();
    // draw.translate(pagesConfig.left, pagesConfig.top);
    // dataProxy.eachMergesInView(mViewRange, ({ sri, sci }) => {
    //   renderCell(draw, dataProxy, sri, sci, page.drawOffset);
    // });


    mergeData(dataProxy, pagesConfig);
    draw.restore();
    draw.save();
    draw.translate(pagesConfig.left, top);
    page.rows.forEach(function (rowIndex) {
      for (var ci = 0; ci <= cr.eci; ci++) {
        renderCell(draw, dataProxy, rowIndex, ci, page.drawOffset);
        mViewRange.eci = ci;
      }
    });
    dataProxy.eachMergesInView(mViewRange, function (_ref) {
      var sri = _ref.sri,
          sci = _ref.sci;
      renderCell(draw, dataProxy, sri, sci, page.drawOffset);
    });

    if (paper.showHeader) {
      draw.restore();
      draw.save();
      draw.translate(pagesConfig.left, pagesConfig.top + 1);
      pagesConfig.headRowIndexs.forEach(function (rowIndex) {
        for (var ci = 0; ci <= cr.eci; ci++) {
          renderCell(draw, dataProxy, rowIndex, ci, 0);
        }
      });
      mViewRange.sri = pagesConfig.headRowIndexs[0];
      mViewRange.eri = pagesConfig.headRowIndexs[pagesConfig.headRowIndexs.length - 1];
      dataProxy.eachMergesInView(mViewRange, function (_ref2) {
        var sri = _ref2.sri,
            sci = _ref2.sci;
        renderCell(draw, dataProxy, sri, sci, 0);
      });
    }

    if (paper.showFooter) {
      draw.restore();
      draw.save();
      var lastPage = pages[pages.length - 1];

      if (page.index === lastPage.index) {
        draw.translate(pagesConfig.left, top + 0);
      } else {
        draw.translate(pagesConfig.left, top + 0 + page.pageHeight - lastPage.pageHeight);
      }

      pagesConfig.footerRowIndexs.forEach(function (rowIndex) {
        for (var ci = 0; ci <= cr.eci; ci++) {
          renderCell(draw, dataProxy, rowIndex, ci, lastPage.drawOffset);
        }
      });
      mViewRange.sri = pagesConfig.footerRowIndexs[0];
      mViewRange.eri = pagesConfig.footerRowIndexs[pagesConfig.footerRowIndexs.length - 1];
      dataProxy.eachMergesInView(mViewRange, function (_ref3) {
        var sri = _ref3.sri,
            sci = _ref3.sci;
        renderCell(draw, dataProxy, sri, sci, lastPage.drawOffset);
      });
    }

    draw.restore();
    var typeMap = {
      '10': {
        template: '${num}'
      },
      '20': {
        template: '- ${num} -'
      },
      '30': {
        template: '${num}',
        transfrom: NoToChinese
      },
      '40': {
        template: '第${num}页'
      },
      '50': {
        template: '第${num}页',
        transfrom: NoToChinese
      }
    };
    var typeObj = typeMap[paper.paginationType || '10'];
    var template = '';
    var totalPage = pagesConfig.totalNumber;

    if (paper.showTotalPage) {
      var totalTemp = typeObj.transfrom ? typeObj.transfrom(totalPage) : totalPage;
      template += "\u5171".concat(totalTemp, "\u9875");
    }

    if (paper.paginationType) {
      var num = typeObj.transfrom ? typeObj.transfrom(printPageNum) : printPageNum;
      template = typeObj.template.replace('${num}', num);

      if (paper.showTotalPage) {
        totalPage = typeObj.transfrom ? typeObj.transfrom(totalPage) : totalPage;
        template += "   \u5171".concat(totalPage, "\u9875");
      }
    }

    var offset = draw.ctx.measureText(template).width;
    offset = offset / 2;
    var leftMap = {
      left: 50,
      center: width / 2 - offset,
      right: width - 50 - offset
    };
    draw.restore();
    draw.save();
    draw.translate(0, 0);
    draw.ctx.font = '16px Arial';
    draw.fillText(template, leftMap[paper.paginationPosition], height - 20);
    draw.ctx.restore();
    printPageNum++;
    var wraperHcreated = element_h('div', "x-spreadsheet-canvas-card-wraper").child(wrap.child(canvas));
    appendTarget.appendChild(wraperHcreated.el);
  });
  return canvases;
}
/**
 * pages
 * @param {*} param0
 * @returns
 */


function preview_preview(_ref4) {
  var appendTarget = _ref4.appendTarget,
      printDatas = _ref4.printDatas,
      paper = _ref4.paper,
      _ref4$isCenter = _ref4.isCenter,
      isCenter = _ref4$isCenter === void 0 ? true : _ref4$isCenter;
  var canvases = [];
  appendTarget.innerHTML = '';
  var pageNumber = 1;
  var totalNumber = 0;
  printDatas.forEach(function (printData) {
    var data = printData.getData();
    var dataProxy = new data_proxy_DataProxy();
    dataProxy.setData(JSON.parse(JSON.stringify(data)));
    clearDeatData(dataProxy);
    printData.pagesConfig = getPagesConfig(dataProxy, paper, isCenter);
    totalNumber += printData.pagesConfig.pages.length;
  });
  printDatas.forEach(function (printData) {
    // printData = f1(printData, paper);
    var data = printData.getData();
    var dataProxy = new data_proxy_DataProxy();
    dataProxy.setData(JSON.parse(JSON.stringify(data)));
    clearDeatData(dataProxy);
    dataProxy.names = printData.names;
    var pagesConfig = printData.pagesConfig;
    var canvasesTemp = drawContent(dataProxy, paper, _objectSpread2(_objectSpread2({}, pagesConfig), {}, {
      pageNumber: pageNumber,
      totalNumber: totalNumber
    }), appendTarget);
    pageNumber += pagesConfig.pages.length;
    canvases = [].concat(_toConsumableArray(canvases), _toConsumableArray(canvasesTemp));
  });
  return {
    canvases: canvases
  };
}
// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js??ref--13-0!./node_modules/thread-loader/dist/cjs.js!./node_modules/babel-loader/lib!./node_modules/cache-loader/dist/cjs.js??ref--1-0!./node_modules/vue-loader/lib??vue-loader-options!./src/dialog/print/index.vue?vue&type=script&lang=js&




//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//


var PAGER_SIZES = [{
  key: 'A3',
  value: [11.69, 16.54]
}, {
  key: 'A4',
  value: [8.27, 11.69]
}, {
  key: 'A5',
  value: [5.83, 8.27]
}, {
  key: 'A6',
  value: [9.84, 13.9]
}, {
  key: 'A7',
  value: [6.93, 9.84]
}];
var PAGER_ORIENTATIONS = [{
  value: 'landscape',
  name: '横向'
}, {
  value: 'portrait',
  name: '纵向'
}];

function inches2px(inc) {
  return parseInt(96 * inc, 10);
}

/* harmony default export */ var printvue_type_script_lang_js_ = ({
  props: {
    getSpreadsheet: [Function]
  },
  data: function data() {
    return {
      paper: {
        width: inches2px(PAGER_SIZES[0].value[0]),
        height: inches2px(PAGER_SIZES[0].value[1])
      },
      printType: 'A4',
      orientation: PAGER_ORIENTATIONS[0].value
    };
  },
  methods: {
    goBack: function goBack() {
      this.$emit('cancelDialog');
    },
    initPreview: function initPreview(printDatas) {
      var _this = this;

      var pageSize = PAGER_SIZES.find(function (o) {
        return o.key === _this.printType;
      });
      this.paper = {
        width: inches2px(pageSize.value[0]),
        height: inches2px(pageSize.value[1]),
        padding: 50,
        orientation: this.orientation
      };

      if (this.orientation === 'portrait') {
        var t = this.paper.width;
        this.paper.width = this.paper.height;
        this.paper.height = t;
      }

      this.printData = this.spreadsheet.sheet.data;
      this.preview({
        appendTarget: this.$refs.canvasWrap,
        printDatas: printDatas,
        paper: this.paper
      });
    },
    preview: function preview(_ref) {
      var appendTarget = _ref.appendTarget,
          printDatas = _ref.printDatas,
          paper = _ref.paper;

      var result = preview_preview({
        appendTarget: appendTarget,
        printDatas: printDatas,
        paper: paper
      });

      this.canvases = result.canvases;
    },
    toPrint: function toPrint() {
      // this.$el.hide();
      var paper = this.paper;
      var iframe = element_h('iframe', '').hide();
      var el = iframe.el;
      window.document.body.appendChild(el);
      var contentWindow = el.contentWindow;
      var idoc = contentWindow.document;
      var style = document.createElement('style');
      style.innerHTML = "\n      @page { size: ".concat(paper.width, "px ").concat(paper.height, "px; };\n      canvas {\n        page-break-before: auto;\n        page-break-after: always;\n        image-rendering: pixelated;\n      };\n    ");
      idoc.head.appendChild(style);
      this.canvases.forEach(function (it) {
        var cn = it.cloneNode(false);
        var ctx = cn.getContext('2d'); // ctx.imageSmoothingEnabled = true;

        ctx.drawImage(it, 0, 0);
        idoc.body.appendChild(cn);
      });
      contentWindow.print();
    },
    getPageSizes: function getPageSizes() {
      return PAGER_SIZES;
    },
    getPageOrientations: function getPageOrientations() {
      return PAGER_ORIENTATIONS;
    }
  },
  mounted: function mounted() {
    this.spreadsheet = this.getSpreadsheet();
    var printDatas = this.spreadsheet.datas;
    this.initPreview(printDatas);
  }
});
// CONCATENATED MODULE: ./src/dialog/print/index.vue?vue&type=script&lang=js&
 /* harmony default export */ var dialog_printvue_type_script_lang_js_ = (printvue_type_script_lang_js_); 
// CONCATENATED MODULE: ./src/dialog/print/index.vue





/* normalize component */

var print_component = normalizeComponent(
  dialog_printvue_type_script_lang_js_,
  printvue_type_template_id_23791342_scoped_true_render,
  printvue_type_template_id_23791342_scoped_true_staticRenderFns,
  false,
  null,
  "23791342",
  null
  
)

/* harmony default export */ var print = (print_component.exports);
// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"7cdf87ba-vue-loader-template"}!./node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ref--1-0!./node_modules/vue-loader/lib??vue-loader-options!./src/dialog/AutoFilterDialog/filterSeletor.vue?vue&type=template&id=4adca92e&scoped=true&
var filterSeletorvue_type_template_id_4adca92e_scoped_true_render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:"_spreadsheet-sort-filter-wraper",style:(_vm.contentStyle)},[_c('div',{staticClass:"_spreadsheet-sort-filter",style:(("left:" + (_vm.position.left) + "px;top:" + (_vm.position.top) + "px"))},[_c('div',{}),_c('el-card',{ref:"_sort-filter",staticClass:"box-card"},[_c('el-radio-group',{model:{value:(_vm.orderType),callback:function ($$v) {_vm.orderType=$$v},expression:"orderType"}},[_c('el-radio',{staticStyle:{"margin-bottom":"10px"},attrs:{"label":'asc'}},[_vm._v("升序")]),_c('br'),_c('el-radio',{attrs:{"label":'desc'}},[_vm._v("降序")])],1),_c('el-divider'),_c('div',{staticClass:"_x-spreadsheet-filter"},[_c('div',{staticClass:"_x-spreadsheet-header"},[_c('el-checkbox',{attrs:{"indeterminate":_vm.isIndeterminate},on:{"change":_vm.handleCheckAllChange},model:{value:(_vm.checkAll),callback:function ($$v) {_vm.checkAll=$$v},expression:"checkAll"}},[_vm._v(" 全选 "),_c('span',[_vm._v(_vm._s(_vm.checkTotal)+" / "+_vm._s(_vm.total))])])],1),_c('div',{staticClass:"_x-spreadsheet-body"},[_c('div',{staticStyle:{"margin":"15px 0"}}),_c('el-checkbox-group',{on:{"change":_vm.handleCheckedChange},model:{value:(_vm.checkedItems),callback:function ($$v) {_vm.checkedItems=$$v},expression:"checkedItems"}},_vm._l((_vm.items),function(value,key){return _c('el-checkbox',{key:key,attrs:{"label":key}},[_c('span',[_vm._v(_vm._s(key))]),_c('span',{staticStyle:{"display":"inline-block","width":"150px","text-align":"right"}},[_vm._v("("+_vm._s(_vm.items[key])+")")])])}),1)],1)]),_c('div',{staticStyle:{"text-align":"right"}},[_c('el-button',{on:{"click":_vm.goBack}},[_vm._v("取消")]),_c('el-button',{on:{"click":_vm.ok}},[_vm._v("确认")])],1)],1)],1)])}
var filterSeletorvue_type_template_id_4adca92e_scoped_true_staticRenderFns = []


// CONCATENATED MODULE: ./src/dialog/AutoFilterDialog/filterSeletor.vue?vue&type=template&id=4adca92e&scoped=true&

// EXTERNAL MODULE: ./node_modules/core-js/modules/es.object.values.js
var es_object_values = __webpack_require__("07ac");

// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js??ref--13-0!./node_modules/thread-loader/dist/cjs.js!./node_modules/babel-loader/lib!./node_modules/cache-loader/dist/cjs.js??ref--1-0!./node_modules/vue-loader/lib??vue-loader-options!./src/dialog/AutoFilterDialog/filterSeletor.vue?vue&type=script&lang=js&







//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
/* harmony default export */ var filterSeletorvue_type_script_lang_js_ = ({
  props: {
    getSpreadsheet: [Function],
    getOptions: [Function],
    config: [Object]
  },
  data: function data() {
    return {
      position: {
        left: 0,
        top: 0
      },
      items: [],
      orderType: '',
      checkedItems: [],
      checkAll: false,
      isIndeterminate: true
    };
  },
  computed: {
    total: function total() {
      return [0, 0].concat(_toConsumableArray(Object.values(this.items))).reduce(function (s, v) {
        return s + v;
      });
    },
    checkTotal: function checkTotal() {
      var _this = this;

      // debugger
      return [0, 0].concat(_toConsumableArray(this.checkedItems.map(function (o) {
        return _this.items[o];
      }))).reduce(function (s, v) {
        return s + v;
      });
    },
    contentStyle: function contentStyle() {
      var _this$config;

      if ((_this$config = this.config) !== null && _this$config !== void 0 && _this$config.minContent) {
        var tableOffset = this.tableOffset;
        return {
          width: tableOffset.width + 'px',
          height: tableOffset.height + 'px',
          left: '50%',
          top: '0',
          // 'z-index': 999,
          position: 'absolute',
          'margin-left': -tableOffset.width / 2 + 'px'
        };
      } else {
        return {};
      }
    }
  },
  methods: {
    goBack: function goBack() {
      this.$emit('cancelDialog');
    },
    handleCheckAllChange: function handleCheckAllChange(val) {
      this.checkedItems = val ? Object.keys(this.items) : [];
      this.isIndeterminate = false;
    },
    handleCheckedChange: function handleCheckedChange(value) {
      var checkedCount = value.length;
      this.checkAll = checkedCount === Object.keys(this.items).length;
      this.isIndeterminate = checkedCount > 0 && checkedCount < Object.keys(this.items).length;
    },
    ok: function ok() {
      var ci = this.options.sortFilter.ci; // let cell = this.spreadsheet.data.getCell(...this.options.xy);

      var orderType;

      if (this.orderType) {
        orderType = this.orderType;
      } else {
        var _this$spreadsheet$dat;

        orderType = ((_this$spreadsheet$dat = this.spreadsheet.data.autoFilter.sort) === null || _this$spreadsheet$dat === void 0 ? void 0 : _this$spreadsheet$dat.order) || '';

        if (this.options.xy[0] === ci) {
          if (!orderType) {
            orderType = 'asc';
          } else if (orderType === 'asc') {
            orderType = 'desc';
          } else if (orderType === 'desc') {
            orderType = '';
          }
        } else {
          orderType = 'asc';
        }
      }

      this.options.sortFilter.ok(ci, orderType, 'in', _toConsumableArray(this.checkedItems));
      this.spreadsheet.data.autoFilter.filters = [];
      this.goBack();
    }
  },
  created: function created() {
    this._sheet = this.getSpreadsheet().sheet;
    this.tableOffset = this._sheet.getTableOffset(); // console.log(this.tableOffset);
    // console.log('222', this.tableOffset);
  },
  mounted: function mounted() {
    var _this2 = this;

    this.spreadsheet = this.getSpreadsheet();
    this.options = this.getOptions();
    this.position = this.options.position;
    this.items = this.options.items;
    this.checkedItems = _toConsumableArray(this.options.sortFilter.filterValues);
    this.spreadsheet.on('reset-data', function () {
      _this2.tableOffset = _this2._sheet.getTableOffset();
    });
    window.addEventListener('resize', function () {
      _this2.tableOffset = _this2.spreadsheet.sheet.getTableOffset();
    }); // console.log(this.options);
  },
  beforeDestroy: function beforeDestroy() {}
});
// CONCATENATED MODULE: ./src/dialog/AutoFilterDialog/filterSeletor.vue?vue&type=script&lang=js&
 /* harmony default export */ var AutoFilterDialog_filterSeletorvue_type_script_lang_js_ = (filterSeletorvue_type_script_lang_js_); 
// EXTERNAL MODULE: ./src/dialog/AutoFilterDialog/filterSeletor.vue?vue&type=style&index=0&id=4adca92e&lang=scss&scoped=true&
var filterSeletorvue_type_style_index_0_id_4adca92e_lang_scss_scoped_true_ = __webpack_require__("d7f8");

// CONCATENATED MODULE: ./src/dialog/AutoFilterDialog/filterSeletor.vue






/* normalize component */

var filterSeletor_component = normalizeComponent(
  AutoFilterDialog_filterSeletorvue_type_script_lang_js_,
  filterSeletorvue_type_template_id_4adca92e_scoped_true_render,
  filterSeletorvue_type_template_id_4adca92e_scoped_true_staticRenderFns,
  false,
  null,
  "4adca92e",
  null
  
)

/* harmony default export */ var filterSeletor = (filterSeletor_component.exports);
// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"7cdf87ba-vue-loader-template"}!./node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ref--1-0!./node_modules/vue-loader/lib??vue-loader-options!./src/dialog/validation/index.vue?vue&type=template&id=a5f6fe54&scoped=true&
var validationvue_type_template_id_a5f6fe54_scoped_true_render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('el-dialog',{attrs:{"title":"数据有效性","visible":_vm.dialogVisible,"before-close":_vm.handleClose,"append-to-body":"","close-on-click-modal":false},nativeOn:{"submit":function($event){$event.preventDefault();}}},[_c('el-form',{ref:"form",attrs:{"model":_vm.validation,"label-width":"130px"},nativeOn:{"submit":function($event){$event.preventDefault();}}},[_c('el-tabs',{model:{value:(_vm.activeName),callback:function ($$v) {_vm.activeName=$$v},expression:"activeName"}},[_c('el-tab-pane',{attrs:{"label":"设置","name":"first"}},[_c('el-form-item',{attrs:{"label":"单元格"}},[_c('el-input',{attrs:{"disabled":""},model:{value:(_vm.ref),callback:function ($$v) {_vm.ref=$$v},expression:"ref"}})],1),_c('el-form-item',{attrs:{"label":"验证条件","prop":"type"}},[_c('el-select',{attrs:{"value-key":"value"},model:{value:(_vm.validation.type),callback:function ($$v) {_vm.$set(_vm.validation, "type", $$v)},expression:"validation.type"}},[_c('el-option',{attrs:{"label":"数字","value":"number"}}),_c('el-option',{attrs:{"label":"列表","value":"list"}})],1)],1),(_vm.validation.type === 'number')?_c('el-form-item',{attrs:{"label":"数据"}},[_c('el-select',{on:{"change":_vm.changeNumberType},model:{value:(_vm.validation.operator),callback:function ($$v) {_vm.$set(_vm.validation, "operator", $$v)},expression:"validation.operator"}},_vm._l((_vm.operator),function(label,value){return _c('el-option',{key:value,attrs:{"label":label,"value":value}})}),1)],1):_vm._e(),(_vm.values.includes(_vm.validation.operator) && _vm.validation.type === 'number')?_c('div',[_c('el-form-item',{attrs:{"label":"最小值","prop":"min","rules":{
              required: true,
              message: '最小值不能为空'
            }}},[_c('el-input',{attrs:{"placeholder":"请输入最小值"},model:{value:(_vm.validation.min),callback:function ($$v) {_vm.$set(_vm.validation, "min", $$v)},expression:"validation.min"}})],1),_c('el-form-item',{attrs:{"label":"最大值","prop":"max","rules":{
              required: true,
              message: '最大值不能为空'
            }}},[_c('el-input',{attrs:{"placeholder":"请输入最大值"},model:{value:(_vm.validation.max),callback:function ($$v) {_vm.$set(_vm.validation, "max", $$v)},expression:"validation.max"}})],1)],1):_c('el-form-item',{attrs:{"prop":"value","label":"数值","rules":{
            required: true,
            message: '数值不能为空'
          }}},[_c('el-input',{attrs:{"placeholder":_vm.validation.type === 'list' ? '选项1,选项2' : '请输入数值'},model:{value:(_vm.validation.value),callback:function ($$v) {_vm.$set(_vm.validation, "value", $$v)},expression:"validation.value"}})],1)],1),_c('el-tab-pane',{attrs:{"label":"输入信息","name":"second"}},[_c('el-form-item',{attrs:{"label":"输入提示","prop":"tips"}},[_c('el-input',{model:{value:(_vm.validation.tips),callback:function ($$v) {_vm.$set(_vm.validation, "tips", $$v)},expression:"validation.tips"}})],1)],1)],1)],1),_c('span',{staticClass:"dialog-footer",attrs:{"slot":"footer"},slot:"footer"},[_c('el-button',{on:{"click":_vm.remove}},[_vm._v("删 除")]),_c('el-button',{attrs:{"type":"primary"},on:{"click":_vm.save}},[_vm._v("确 定")])],1)],1)}
var validationvue_type_template_id_a5f6fe54_scoped_true_staticRenderFns = []


// CONCATENATED MODULE: ./src/dialog/validation/index.vue?vue&type=template&id=a5f6fe54&scoped=true&

// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js??ref--13-0!./node_modules/thread-loader/dist/cjs.js!./node_modules/babel-loader/lib!./node_modules/cache-loader/dist/cjs.js??ref--1-0!./node_modules/vue-loader/lib??vue-loader-options!./src/dialog/validation/index.vue?vue&type=script&lang=js&








//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
/* harmony default export */ var validationvue_type_script_lang_js_ = ({
  name: 'validation',
  components: {},
  data: function data() {
    return {
      activeName: 'first',
      dialogVisible: true,
      operator: {
        be: '在区间',
        nbe: '不在区间',
        lt: '小于',
        lte: '小于等于',
        gt: '大于',
        gte: '大于等于',
        eq: '等于',
        neq: '不等于'
      },
      values: ['be', 'nbe'],
      ref: '',
      validation: {
        operator: 'be',
        required: true,
        type: 'number',
        value: '',
        tips: '',
        max: '',
        min: ''
      }
    };
  },
  props: {
    getSpreadsheet: [Function],
    getOptions: [Function]
  },
  computed: {},
  created: function created() {
    this._sheet = this.getSpreadsheet().sheet;
    this.ref = this.getOptions().ref;

    var validation = _objectSpread2({}, this.getOptions().validator);

    if (Object.keys(validation).length) {
      this.validation = _objectSpread2(_objectSpread2({}, this.validation), validation);
      this.setParams(validation);
    }
  },
  methods: {
    handleClose: function handleClose() {
      this.close();
    },
    close: function close() {
      this.$emit('cancelDialog');
    },
    save: function save() {
      var _this = this;

      this.$refs.form.validate(function (valid) {
        if (valid) {
          _this.remove();

          _this.setParams(_this.validation, true);

          _this._sheet.data.addValidation('cell', _this.ref, _this.validation);

          _this._sheet.table.render();

          _this.close();
        } else {
          _this.activeName = 'first';
        }
      });
    },
    setParams: function setParams(validation, flag) {
      var operator = validation.operator;

      if (this.values.includes(operator) && validation.type === 'number') {
        if (flag) {
          validation.value = [this.validation.min, this.validation.max];
        } else {
          var _validation$value = _slicedToArray(validation.value, 2);

          this.validation.min = _validation$value[0];
          this.validation.max = _validation$value[1];
        }
      }
    },
    remove: function remove() {
      this._sheet.data.removeValidation();

      this._sheet.table.render();

      this.close();
    },
    changeNumberType: function changeNumberType() {
      this.validation.value = '';
    }
  }
});
// CONCATENATED MODULE: ./src/dialog/validation/index.vue?vue&type=script&lang=js&
 /* harmony default export */ var dialog_validationvue_type_script_lang_js_ = (validationvue_type_script_lang_js_); 
// CONCATENATED MODULE: ./src/dialog/validation/index.vue





/* normalize component */

var validation_component = normalizeComponent(
  dialog_validationvue_type_script_lang_js_,
  validationvue_type_template_id_a5f6fe54_scoped_true_render,
  validationvue_type_template_id_a5f6fe54_scoped_true_staticRenderFns,
  false,
  null,
  "a5f6fe54",
  null
  
)

/* harmony default export */ var dialog_validation = (validation_component.exports);
// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"7cdf87ba-vue-loader-template"}!./node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ref--1-0!./node_modules/vue-loader/lib??vue-loader-options!./src/dialog/editFormat/index.vue?vue&type=template&id=544d9ff4&scoped=true&
var editFormatvue_type_template_id_544d9ff4_scoped_true_render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('el-dialog',{attrs:{"title":"单元格格式","visible":_vm.dialogVisible,"before-close":_vm.handleClose,"append-to-body":"","close-on-click-modal":false}},[_c('el-form',{ref:"form",staticStyle:{"width":"450px"},attrs:{"label-width":"130px"},nativeOn:{"submit":function($event){$event.preventDefault();}}},[_c('el-tabs',{ref:"formatTabs",staticStyle:{"height":"430px"},attrs:{"tab-position":"left"},model:{value:(_vm.list.f),callback:function ($$v) {_vm.$set(_vm.list, "f", $$v)},expression:"list.f"}},_vm._l((_vm.formatList),function(item){return _c('el-tab-pane',{key:item.key,attrs:{"name":item.key,"label":item.title()}},[_c('div',{staticClass:"label"},[_c('p',[_vm._v("示例：")]),_c('div',{staticClass:"label-tip"},[_vm._v(" "+_vm._s(_vm.label || item.label || '无')+" ")])]),(['rmb', 'usd', 'eur', 'number'].includes(_vm.list.f))?_c('div',[_c('el-form-item',{staticStyle:{"margin-top":"15px"},attrs:{"label":"小数点位数"}},[_c('el-input-number',{attrs:{"min":0,"max":10},model:{value:(_vm.list.p),callback:function ($$v) {_vm.$set(_vm.list, "p", $$v)},expression:"list.p"}})],1),_c('el-form-item',{attrs:{"label":"千分符"}},[_c('el-checkbox',{model:{value:(_vm.list.is),callback:function ($$v) {_vm.$set(_vm.list, "is", $$v)},expression:"list.is"}},[_vm._v("是否使用千分符")])],1),_c('el-form-item',{attrs:{"label":"单位类型"}},[_c('el-checkbox',{attrs:{"border":""},model:{value:(_vm.list.iu),callback:function ($$v) {_vm.$set(_vm.list, "iu", $$v)},expression:"list.iu"}}),_c('el-select',{staticStyle:{"width":"91px"},attrs:{"placeholder":"请选择"},model:{value:(_vm.list.div),callback:function ($$v) {_vm.$set(_vm.list, "div", $$v)},expression:"list.div"}},_vm._l((_vm.options),function(item){return _c('el-option',{key:item.value,attrs:{"label":item.label,"value":item.value}})}),1)],1),_c('el-form-item',{attrs:{"label":"单位"}},[_c('el-input',{staticStyle:{"width":"130px"},attrs:{"disabled":!_vm.list.iu,"placeholder":"万元，亿元"},model:{value:(_vm.list.u),callback:function ($$v) {_vm.$set(_vm.list, "u", $$v)},expression:"list.u"}})],1),_c('el-form-item',{attrs:{"label":" “0”时显示空"}},[_c('el-checkbox',{attrs:{"border":""},model:{value:(_vm.list.en),callback:function ($$v) {_vm.$set(_vm.list, "en", $$v)},expression:"list.en"}})],1)],1):_vm._e()])}),1)],1),_c('span',{staticClass:"dialog-footer",attrs:{"slot":"footer"},slot:"footer"},[_c('el-button',{attrs:{"type":"primary"},on:{"click":_vm.save}},[_vm._v("确 定")]),_c('el-button',{on:{"click":_vm.handleClose}},[_vm._v("取消")])],1)],1)}
var editFormatvue_type_template_id_544d9ff4_scoped_true_staticRenderFns = []


// CONCATENATED MODULE: ./src/dialog/editFormat/index.vue?vue&type=template&id=544d9ff4&scoped=true&

// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js??ref--13-0!./node_modules/thread-loader/dist/cjs.js!./node_modules/babel-loader/lib!./node_modules/cache-loader/dist/cjs.js??ref--1-0!./node_modules/vue-loader/lib??vue-loader-options!./src/dialog/editFormat/index.vue?vue&type=script&lang=js&


var editFormatvue_type_script_lang_js_excluded = ["en", "val", "f"],
    _excluded2 = ["en", "val", "f"];




//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//


/* harmony default export */ var editFormatvue_type_script_lang_js_ = ({
  name: 'editFormat',
  data: function data() {
    return {
      dialogVisible: true,
      formatList: baseFormats.slice(0),
      list: {
        f: 'normal',
        //format
        p: 2,
        //precision
        is: false,
        //isSeparator
        u: '',
        //unit
        iu: false,
        //isUnit
        div: 10000,
        val: 0,
        // f:transparent
        en: false // f:transparent

      },
      label: '',
      options: [{
        value: 1,
        label: '无'
      }, {
        value: 10000,
        label: '万元'
      }, {
        value: 100000000,
        label: '亿元'
      }]
    };
  },
  computed: {
    isShowNUM: function isShowNUM() {
      return ['rmb', 'usd', 'eur', 'number'].includes(this.list.f);
    }
  },
  props: {
    getSpreadsheet: [Function],
    getOptions: [Function]
  },
  watch: {
    list: {
      deep: true,
      immediate: true,
      handler: function handler() {
        if (!this._dataCell) {
          return this.label = '';
        }

        var _this$list = this.list,
            en = _this$list.en,
            val = _this$list.val,
            f = _this$list.f,
            list = _objectWithoutProperties(_this$list, editFormatvue_type_script_lang_js_excluded);

        if (this.isShowNUM) {
          this.label = core_format(this._dataCell, JSON.stringify(_objectSpread2(_objectSpread2(_objectSpread2({}, list), {}, {
            f: f
          }, this.getReal()), {}, {
            en: en,
            val: val
          })));
        } else {
          this.label = core_format(this._dataCell, f);
        }
      }
    }
  },
  created: function created() {
    this._sheet = this.getSpreadsheet().sheet;
    var selector = this._sheet.data.selector;
    var _selector$range = selector.range,
        sri = _selector$range.sri,
        sci = _selector$range.sci;

    var style = this._sheet.data.getCellStyleOrDefault(sri, sci);

    this._dataCell = this._sheet.data.getCellParseValue(sri, sci);
    var format = style['format'];
    this.list.f = format;

    if (format.includes('{')) {
      style = JSON.parse(format);
      this.list.f = style.f;
    }

    if (this.isShowNUM) {
      var _style$p, _style, _style2, _style3, _style4, _style5;

      this.list.p = (_style$p = (_style = style) === null || _style === void 0 ? void 0 : _style.p) !== null && _style$p !== void 0 ? _style$p : 2;
      this.list.is = ((_style2 = style) === null || _style2 === void 0 ? void 0 : _style2.is) || false;
      this.list.u = ((_style3 = style) === null || _style3 === void 0 ? void 0 : _style3.u) || '';
      this.list.iu = ((_style4 = style) === null || _style4 === void 0 ? void 0 : _style4.iu) || false;
      this.list.div = style.div || 10000;
      this.list.en = ((_style5 = style) === null || _style5 === void 0 ? void 0 : _style5.en) || false;
    }
  },
  methods: {
    handleClose: function handleClose() {
      this.close();
    },
    close: function close() {
      this.$emit('cancelDialog');
    },
    save: function save() {
      var _this$list2 = this.list,
          en = _this$list2.en,
          val = _this$list2.val,
          f = _this$list2.f,
          list = _objectWithoutProperties(_this$list2, _excluded2);

      if (this.isShowNUM) {
        this._sheet.data.setSelectedCellAttr('format', JSON.stringify(_objectSpread2(_objectSpread2(_objectSpread2({}, list), {}, {
          f: f
        }, this.getReal()), {}, {
          en: en,
          val: val
        })));
      } else {
        this._sheet.data.setSelectedCellAttr('format', f);
      }

      this.render();
    },
    getReal: function getReal() {
      var o = {};

      if (!this.list.iu) {
        o = {
          u: '',
          iu: false
        };
      }

      return o;
    },
    render: function render() {
      this._sheet.table.render();

      this._sheet.toolbar.reset();

      this.close();
    }
  }
});
// CONCATENATED MODULE: ./src/dialog/editFormat/index.vue?vue&type=script&lang=js&
 /* harmony default export */ var dialog_editFormatvue_type_script_lang_js_ = (editFormatvue_type_script_lang_js_); 
// EXTERNAL MODULE: ./src/dialog/editFormat/index.vue?vue&type=style&index=0&id=544d9ff4&lang=scss&scoped=true&
var editFormatvue_type_style_index_0_id_544d9ff4_lang_scss_scoped_true_ = __webpack_require__("9e67");

// CONCATENATED MODULE: ./src/dialog/editFormat/index.vue






/* normalize component */

var editFormat_component = normalizeComponent(
  dialog_editFormatvue_type_script_lang_js_,
  editFormatvue_type_template_id_544d9ff4_scoped_true_render,
  editFormatvue_type_template_id_544d9ff4_scoped_true_staticRenderFns,
  false,
  null,
  "544d9ff4",
  null
  
)

/* harmony default export */ var editFormat = (editFormat_component.exports);
// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"7cdf87ba-vue-loader-template"}!./node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ref--1-0!./node_modules/vue-loader/lib??vue-loader-options!./src/dialog/lookUp/index.vue?vue&type=template&id=bda99834&
var lookUpvue_type_template_id_bda99834_render = function () {
var this$1 = this;
var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('el-dialog',{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],staticClass:"el-dialog__lookUp",attrs:{"title":"查找","append-to-body":true,"width":"382px","visible":_vm.dialogVisible,"before-close":_vm.close,"modal":false,"close-on-click-modal":false},on:{"keyup":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,"esc",27,$event.key,["Esc","Escape"])){ return null; }return _vm.close.apply(null, arguments)}}},[_c('el-form',{ref:"form",attrs:{"autocomplete":"on"},nativeOn:{"submit":function($event){$event.preventDefault();}}},[_c('el-form-item',{attrs:{"label":"查找内容"}},[_c('el-autocomplete',{staticStyle:{"width":"260px"},attrs:{"fetch-suggestions":_vm.querySearch,"clearable":true,"placeholder":"请输入内容"},on:{"select":function (v) { return (this$1.lookUp = v); }},nativeOn:{"keyup":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,"enter",13,$event.key,"Enter")){ return null; }return _vm.search.apply(null, arguments)}},scopedSlots:_vm._u([{key:"default",fn:function(ref){
var item = ref.item;
return [_c('div',[_vm._v(_vm._s(item))])]}}]),model:{value:(_vm.lookUp),callback:function ($$v) {_vm.lookUp=$$v},expression:"lookUp"}},[(!_vm.disabled)?_c('template',{slot:"append"},[_vm._v(" "+_vm._s(_vm.selectorIndex)+" ")]):_vm._e()],2)],1)],1),_c('span',{staticClass:"dialog-footer",attrs:{"slot":"footer"},slot:"footer"},[_c('el-button',{attrs:{"type":"primary"},on:{"click":_vm.search}},[_vm._v("查找")]),_c('el-button',{attrs:{"disabled":_vm.disabled},on:{"click":_vm.before}},[_vm._v("上一项")]),_c('el-button',{attrs:{"disabled":_vm.disabled},on:{"click":_vm.after}},[_vm._v("下一项")])],1)],1)}
var lookUpvue_type_template_id_bda99834_staticRenderFns = []


// CONCATENATED MODULE: ./src/dialog/lookUp/index.vue?vue&type=template&id=bda99834&

// CONCATENATED MODULE: ./src/dialog/dialogDrag.js





/* harmony default export */ var dialogDrag = ({
  bind: function bind(el) {
    var dialogHeaderEl = el.querySelector('.el-dialog__header');
    var dragDom = el.querySelector('.el-dialog');
    dialogHeaderEl.style.cssText += ';cursor:move;';
    dragDom.style.cssText += ';top:0px;'; // 获取原有属性 ie dom元素.currentStyle 火狐谷歌 window.getComputedStyle(dom元素, null);

    var sty = function () {
      if (window.document.currentStyle) {
        return function (dom, attr) {
          return dom.currentStyle[attr];
        };
      } else {
        return function (dom, attr) {
          return getComputedStyle(dom, false)[attr];
        };
      }
    }();

    dialogHeaderEl.onmousedown = function (e) {
      // 鼠标按下，计算当前元素距离可视区的距离
      var disX = e.clientX - dialogHeaderEl.offsetLeft;
      var disY = e.clientY - dialogHeaderEl.offsetTop;
      var screenWidth = document.body.clientWidth; // body当前宽度

      var screenHeight = document.documentElement.clientHeight; // 可见区域高度(应为body高度，可某些环境下无法获取)

      var dragDomWidth = dragDom.offsetWidth; // 对话框宽度

      var dragDomheight = dragDom.offsetHeight; // 对话框高度

      var minDragDomLeft = dragDom.offsetLeft;
      var maxDragDomLeft = screenWidth - dragDom.offsetLeft - dragDomWidth;
      var minDragDomTop = dragDom.offsetTop;
      var maxDragDomTop = screenHeight - dragDom.offsetTop - dragDomheight; // 获取到的值带px 正则匹配替换

      var styL = sty(dragDom, 'left');
      var styT = sty(dragDom, 'top'); // 注意在ie中 第一次获取到的值为组件自带50% 移动之后赋值为px

      if (styL.includes('%')) {
        styL = +document.body.clientWidth * (+styL.replace(/\%/g, '') / 100);
        styT = +document.body.clientHeight * (+styT.replace(/\%/g, '') / 100);
      } else {
        styL = +styL.replace(/\px/g, '');
        styT = +styT.replace(/\px/g, '');
      }

      document.onmousemove = function (e) {
        // 通过事件委托，计算移动的距离
        var left = e.clientX - disX;
        var top = e.clientY - disY; // 边界处理

        if (-left > minDragDomLeft) {
          left = -minDragDomLeft;
        } else if (left > maxDragDomLeft) {
          left = maxDragDomLeft;
        }

        if (-top > minDragDomTop) {
          top = -minDragDomTop;
        } else if (top > maxDragDomTop) {
          top = maxDragDomTop;
        } // 移动当前元素


        dragDom.style.cssText += ";left:".concat(left + styL, "px;top:").concat(top + styT, "px;");
      };

      document.onmouseup = function () {
        document.onmousemove = null;
        document.onmouseup = null;
      };
    };
  }
});
// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js??ref--13-0!./node_modules/thread-loader/dist/cjs.js!./node_modules/babel-loader/lib!./node_modules/cache-loader/dist/cjs.js??ref--1-0!./node_modules/vue-loader/lib??vue-loader-options!./src/dialog/lookUp/index.vue?vue&type=script&lang=js&













//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//

/* harmony default export */ var lookUpvue_type_script_lang_js_ = ({
  name: 'lookUp',
  components: {},
  data: function data() {
    return {
      lookUp: '',
      i: -1,
      dialogVisible: true,
      lookUps: [],
      restaurants: new Set()
    };
  },
  directives: {
    dialogDrag: dialogDrag
  },
  props: {
    getSpreadsheet: [Function],
    getOptions: [Function]
  },
  computed: {
    disabled: function disabled() {
      return this.lookUps.length === 0;
    },
    beforeDisabled: function beforeDisabled() {
      return this.i === 0;
    },
    afterDisabled: function afterDisabled() {
      return this.lookUps.length - 1 === this.i;
    },
    selectorIndex: function selectorIndex() {
      return "".concat(this.i + 1, "/").concat(this.lookUps.length);
    }
  },
  created: function created() {
    this._spreadsheet = this.getSpreadsheet();
  },
  methods: {
    querySearch: function querySearch(queryString, cb) {
      var restaurants = _toConsumableArray(this.restaurants);

      var results = queryString ? restaurants.filter(function (restaurant) {
        return restaurant.toLowerCase().indexOf(queryString.toLowerCase()) === 0;
      }) : restaurants;
      cb(results);
    },
    close: function close() {
      this.$emit('cancelDialog');
    },
    search: function search() {
      this.i = -1;
      this.lookUps = _toConsumableArray(this._spreadsheet.sheet.data.lookUp(this.lookUp) || []);
      this.restaurants.add(this.lookUp);

      if (!this.disabled) {
        this.after();
      } else {
        this.$message.warning('查找不到相关内容！');
      }
    },
    before: function before() {
      if (this.beforeDisabled) this.i = this.lookUps.length;
      var lookUps = this.lookUps;
      this.i = Math.max(0, --this.i);
      this.setLookUp(this.i, lookUps);
    },
    after: function after() {
      if (this.afterDisabled) return this.search();
      var lookUps = this.lookUps;
      this.i = Math.min(lookUps.length - 1, ++this.i);
      this.setLookUp(this.i, lookUps);
    },
    setLookUp: function setLookUp(i, lookUps) {
      var data = this._spreadsheet.sheet.data;

      var _lookUps$i$split$map = lookUps[i].split('_').map(function (i) {
        return i * 1;
      }),
          _lookUps$i$split$map2 = _slicedToArray(_lookUps$i$split$map, 2),
          eri = _lookUps$i$split$map2[0],
          eci = _lookUps$i$split$map2[1];

      var _data$cellRect = data.cellRect(Math.min(data.rows.len, eri + 3), Math.min(data.cols.len - 1, eci + 3)),
          top = _data$cellRect.top,
          left = _data$cellRect.left;

      this._spreadsheet.sheet.editor.clear();

      this._spreadsheet.sheet.verticalScrollbarSet(top, left);

      this._spreadsheet.sheet.selector.set(eri, eci);

      this._spreadsheet.sheet.toolbar.reset();

      this._spreadsheet.sheet.table.render();
    }
  }
});
// CONCATENATED MODULE: ./src/dialog/lookUp/index.vue?vue&type=script&lang=js&
 /* harmony default export */ var dialog_lookUpvue_type_script_lang_js_ = (lookUpvue_type_script_lang_js_); 
// EXTERNAL MODULE: ./src/dialog/lookUp/index.vue?vue&type=style&index=0&lang=scss&
var lookUpvue_type_style_index_0_lang_scss_ = __webpack_require__("756d");

// CONCATENATED MODULE: ./src/dialog/lookUp/index.vue






/* normalize component */

var lookUp_component = normalizeComponent(
  dialog_lookUpvue_type_script_lang_js_,
  lookUpvue_type_template_id_bda99834_render,
  lookUpvue_type_template_id_bda99834_staticRenderFns,
  false,
  null,
  null,
  null
  
)

/* harmony default export */ var lookUp = (lookUp_component.exports);
// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"7cdf87ba-vue-loader-template"}!./node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ref--1-0!./node_modules/vue-loader/lib??vue-loader-options!./src/dialog/setCellSize/index.vue?vue&type=template&id=e297f4de&
var setCellSizevue_type_template_id_e297f4de_render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('el-dialog',{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],staticClass:"el-dialog__setCellSize",attrs:{"title":"设置大小","append-to-body":"","visible":_vm.dialogVisible,"width":"360px","before-close":_vm.cancel,"modal":true,"close-on-click-modal":false},on:{"keyup":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,"esc",27,$event.key,["Esc","Escape"])){ return null; }return _vm.cancel.apply(null, arguments)}}},[_c('el-form',{ref:"form",attrs:{"label-width":"90px","autocomplete":"on"},nativeOn:{"submit":function($event){$event.preventDefault();}}},[_c('el-form-item',{attrs:{"label":_vm.title.label}},[_c('el-input-number',{staticStyle:{"width":"150px"},attrs:{"min":_vm.min,"max":1000,"controls-position":"right"},model:{value:(_vm.size),callback:function ($$v) {_vm.size=$$v},expression:"size"}})],1)],1),_c('span',{staticClass:"dialog-footer",attrs:{"slot":"footer"},slot:"footer"},[_c('el-button',{on:{"click":_vm.cancel}},[_vm._v("取消")]),_c('el-button',{attrs:{"type":"primary"},on:{"click":_vm.setSize}},[_vm._v("确定")])],1)],1)}
var setCellSizevue_type_template_id_e297f4de_staticRenderFns = []


// CONCATENATED MODULE: ./src/dialog/setCellSize/index.vue?vue&type=template&id=e297f4de&

// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js??ref--13-0!./node_modules/thread-loader/dist/cjs.js!./node_modules/babel-loader/lib!./node_modules/cache-loader/dist/cjs.js??ref--1-0!./node_modules/vue-loader/lib??vue-loader-options!./src/dialog/setCellSize/index.vue?vue&type=script&lang=js&
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//

/* harmony default export */ var setCellSizevue_type_script_lang_js_ = ({
  name: 'setCellSize',
  components: {},
  data: function data() {
    return {
      size: 100,
      type: '',
      dialogVisible: true,
      min: 3
    };
  },
  directives: {
    dialogDrag: dialogDrag
  },
  props: {
    getSpreadsheet: [Function],
    getOptions: [Function]
  },
  computed: {
    title: function title() {
      return {
        'set-width': {
          label: '列宽'
        },
        'set-height': {
          label: '行高'
        }
      }[this.type];
    }
  },
  created: function created() {
    this._spreadsheet = this.getSpreadsheet();
    this._sheet = this._spreadsheet.sheet;
    this.type = this.getOptions();
    this.getSize();
  },
  methods: {
    cancel: function cancel() {
      this.$emit('cancelDialog');
    },
    getSize: function getSize() {
      var _this$_sheet$data = this._sheet.data,
          selector = _this$_sheet$data.selector,
          cols = _this$_sheet$data.cols,
          rows = _this$_sheet$data.rows;
      var _selector$range = selector.range,
          sri = _selector$range.sri,
          sci = _selector$range.sci;

      if (this.type === 'set-width') {
        this.size = cols.getWidth(sci);
        this.min = cols.minWidth;
      } else {
        this.size = rows.getHeight(sri);
        this.min = rows.minHeight;
      }
    },
    setSize: function setSize() {
      var _this = this;

      var selector = this._sheet.data.selector;
      var _selector$range2 = selector.range,
          sri = _selector$range2.sri,
          sci = _selector$range2.sci;

      if (this.type === 'set-width') {
        selector.range.eachCol(function (ci) {
          _this._sheet.data.setColWidth(ci, _this.size);
        });
      } else {
        selector.range.eachRow(function (ri) {
          _this._sheet.data.setRowHeight(ri, _this.size);
        });
      }

      this._sheet.selector.resetAreaOffset();

      var _this$_sheet$data$cel = this._sheet.data.cellRect(sri, sci),
          top = _this$_sheet$data$cel.top,
          left = _this$_sheet$data$cel.left;

      this._sheet.verticalScrollbarSet(top, left);

      this._sheet.table.render();

      this.cancel();
    }
  }
});
// CONCATENATED MODULE: ./src/dialog/setCellSize/index.vue?vue&type=script&lang=js&
 /* harmony default export */ var dialog_setCellSizevue_type_script_lang_js_ = (setCellSizevue_type_script_lang_js_); 
// EXTERNAL MODULE: ./src/dialog/setCellSize/index.vue?vue&type=style&index=0&lang=scss&
var setCellSizevue_type_style_index_0_lang_scss_ = __webpack_require__("7936");

// CONCATENATED MODULE: ./src/dialog/setCellSize/index.vue






/* normalize component */

var setCellSize_component = normalizeComponent(
  dialog_setCellSizevue_type_script_lang_js_,
  setCellSizevue_type_template_id_e297f4de_render,
  setCellSizevue_type_template_id_e297f4de_staticRenderFns,
  false,
  null,
  null,
  null
  
)

/* harmony default export */ var setCellSize = (setCellSize_component.exports);
// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js??ref--13-0!./node_modules/thread-loader/dist/cjs.js!./node_modules/babel-loader/lib!./node_modules/cache-loader/dist/cjs.js??ref--1-0!./node_modules/vue-loader/lib??vue-loader-options!./src/dialog/index.vue?vue&type=script&lang=js&
//
//
//
//
//
//
//
//
//
//






/* harmony default export */ var dialogvue_type_script_lang_js_ = ({
  name: 'sheetDialog',
  components: {
    Print: print,
    FilterSeletor: filterSeletor,
    validation: dialog_validation,
    lookUp: lookUp,
    editFormat: editFormat,
    setCellSize: setCellSize
  },
  props: {
    config: [Object],
    getSpreadsheet: [Function]
  },
  data: function data() {
    return {
      type: '-1',
      isLoadInstall: false
    };
  },
  methods: {
    selectType: function selectType(spreadsheet, type, val) {
      this.type = type;
      var needShowDialog = ['print', 'sort-filter', 'preview', 'validation', 'open-functions', 'lookUp', 'edit-format', 'set-cell-size'];

      if (needShowDialog.indexOf(this.type) > -1) {
        this.spreadsheet = spreadsheet;
        this.options = val;

        if (type === 'sort-filter') {
          this.initClickOutSide();
        }
      }
    },
    getOptions: function getOptions() {
      return this.options;
    },
    cancelDialog: function cancelDialog() {
      this.type = -1;
    },
    initClickOutSide: function initClickOutSide() {
      var _this = this;

      if (!this.isLoadInstall) {
        this.spreadsheet.on('cells-selected', function () {
          return _this.cancelDialog();
        });
        this.isLoadInstall = true;
      }

      document.body.addEventListener('click', this.clickOutSide);
    },
    clickOutSide: function clickOutSide(e) {
      var target = e.target;

      if (!this.spreadsheet.sheet.el.contains(target) && !this.$el.contains(target)) {
        this.cancelDialog();
        document.body.removeEventListener('click', this.clickOutSide);
      }
    }
  },
  beforeDestroy: function beforeDestroy() {
    document.body.removeEventListener('click', this.clickOutSide);
  }
});
// CONCATENATED MODULE: ./src/dialog/index.vue?vue&type=script&lang=js&
 /* harmony default export */ var src_dialogvue_type_script_lang_js_ = (dialogvue_type_script_lang_js_); 
// CONCATENATED MODULE: ./src/dialog/index.vue





/* normalize component */

var dialog_component = normalizeComponent(
  src_dialogvue_type_script_lang_js_,
  dialogvue_type_template_id_567349bb_render,
  dialogvue_type_template_id_567349bb_staticRenderFns,
  false,
  null,
  null,
  null
  
)

/* harmony default export */ var dialog = (dialog_component.exports);
// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"7cdf87ba-vue-loader-template"}!./node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ref--1-0!./node_modules/vue-loader/lib??vue-loader-options!./src/inform/index.vue?vue&type=template&id=04b2b68d&scoped=true&
var informvue_type_template_id_04b2b68d_scoped_true_render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:"inform-content",style:(_vm.contentStyle)},_vm._l((_vm.formConfig),function(item,key){return _c('fieldName',{key:key + 'isPlaceholder',attrs:{"showFieldName":_vm.showFieldName,"item":item,"formStyle":_vm.formStyle[key]}})}),1)}
var informvue_type_template_id_04b2b68d_scoped_true_staticRenderFns = []


// CONCATENATED MODULE: ./src/inform/index.vue?vue&type=template&id=04b2b68d&scoped=true&

// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"7cdf87ba-vue-loader-template"}!./node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ref--1-0!./node_modules/vue-loader/lib??vue-loader-options!./src/inform/fieldName.vue?vue&type=template&id=be6ea5a4&scoped=true&
var fieldNamevue_type_template_id_be6ea5a4_scoped_true_render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:"placeholder-item",class:_vm.getFieldNameClass(_vm.item),style:(_vm.formStyle)},[(_vm.showFieldName)?_c('span',{staticClass:"label",domProps:{"innerHTML":_vm._s(_vm.getFieldName(_vm.item))}}):_vm._e()])}
var fieldNamevue_type_template_id_be6ea5a4_scoped_true_staticRenderFns = []


// CONCATENATED MODULE: ./src/inform/fieldName.vue?vue&type=template&id=be6ea5a4&scoped=true&

// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js??ref--13-0!./node_modules/thread-loader/dist/cjs.js!./node_modules/babel-loader/lib!./node_modules/cache-loader/dist/cjs.js??ref--1-0!./node_modules/vue-loader/lib??vue-loader-options!./src/inform/fieldName.vue?vue&type=script&lang=js&

//
//
//
//
//
/* harmony default export */ var fieldNamevue_type_script_lang_js_ = ({
  name: 'fieldName',
  props: {
    item: Object,
    showFieldName: {
      type: Boolean,
      default: false
    },
    id: String,
    formStyle: Object
  },
  methods: {
    //显示 字段名称
    getFieldName: function getFieldName(item) {
      var _item$sourceConfig, _item$sourceConfig$ho, _item$sourceConfig2, _item$sourceConfig2$a;

      if ((_item$sourceConfig = item.sourceConfig) !== null && _item$sourceConfig !== void 0 && (_item$sourceConfig$ho = _item$sourceConfig.horizontalAggregate) !== null && _item$sourceConfig$ho !== void 0 && _item$sourceConfig$ho.enable || (_item$sourceConfig2 = item.sourceConfig) !== null && _item$sourceConfig2 !== void 0 && (_item$sourceConfig2$a = _item$sourceConfig2.aggregate) !== null && _item$sourceConfig2$a !== void 0 && _item$sourceConfig2$a.enable) {
        return this.getStr(item);
      } else if ((item === null || item === void 0 ? void 0 : item.sourceConfigType) === 'hierarchy') {
        return item.levelSourceConfig.fieldName;
      } else if (item.isLevel) {
        if (item.levelConfig.isField) {
          return "<span class=\"level_label\" style=\"background-color:".concat(item.levelConfig.type === 'levelField' ? '#6b8fea' : '#aa61c2', "\">").concat(item.levelConfig.level, "</span>").concat(item.levelConfig.levelName);
        } else {
          return "<span class=\"level_label\">".concat(item.levelConfig.level, "</span>").concat(item.levelConfig.levelName);
        }
      } else {
        return item.sourceConfig.fieldName;
      }
    },
    getStr: function getStr(item) {
      var _item$sourceConfig3, _item$sourceConfig3$h, _item$sourceConfig4, _item$sourceConfig4$a;

      var str = '';

      if ((_item$sourceConfig3 = item.sourceConfig) !== null && _item$sourceConfig3 !== void 0 && (_item$sourceConfig3$h = _item$sourceConfig3.horizontalAggregate) !== null && _item$sourceConfig3$h !== void 0 && _item$sourceConfig3$h.enable) {
        if (item.sourceConfig.horizontalAggregate.hierarchyId) {
          str = "<span class=\"level_label\">".concat(item.sourceConfig.horizontalAggregate.level, "</span>").concat(item.sourceConfig.horizontalAggregate.levelName);
        } else {
          str = "".concat(item.sourceConfig.horizontalAggregate.levelName);
        }
      }

      if ((_item$sourceConfig4 = item.sourceConfig) !== null && _item$sourceConfig4 !== void 0 && (_item$sourceConfig4$a = _item$sourceConfig4.aggregate) !== null && _item$sourceConfig4$a !== void 0 && _item$sourceConfig4$a.enable) {
        if (item.sourceConfig.aggregate.hierarchyId) {
          str = str + "<span class=\"level_label\">".concat(item.sourceConfig.aggregate.level, "</span>").concat(item.sourceConfig.aggregate.levelName);
        } else {
          str = str + "".concat(item.sourceConfig.aggregate.levelName);
        }
      }

      return str = str + "[".concat(item.sourceConfig.fieldName, "]");
    },
    getFieldNameClass: function getFieldNameClass(item) {
      var _item$sourceConfig5, _item$sourceConfig5$h, _item$sourceConfig6, _item$sourceConfig6$a;

      if ((_item$sourceConfig5 = item.sourceConfig) !== null && _item$sourceConfig5 !== void 0 && (_item$sourceConfig5$h = _item$sourceConfig5.horizontalAggregate) !== null && _item$sourceConfig5$h !== void 0 && _item$sourceConfig5$h.enable) {
        return 'level aggregate';
      } else if ((_item$sourceConfig6 = item.sourceConfig) !== null && _item$sourceConfig6 !== void 0 && (_item$sourceConfig6$a = _item$sourceConfig6.aggregate) !== null && _item$sourceConfig6$a !== void 0 && _item$sourceConfig6$a.enable) {
        return 'level aggregate';
      } else if (item.isLevel) {
        return "".concat(item['direction'], " level");
      } else if ((item === null || item === void 0 ? void 0 : item.sourceConfigType) === 'hierarchy') {
        return "".concat(item['direction'], " level");
      } else {
        return "".concat(item['direction']);
      }
    }
  }
});
// CONCATENATED MODULE: ./src/inform/fieldName.vue?vue&type=script&lang=js&
 /* harmony default export */ var inform_fieldNamevue_type_script_lang_js_ = (fieldNamevue_type_script_lang_js_); 
// EXTERNAL MODULE: ./src/inform/fieldName.vue?vue&type=style&index=0&id=be6ea5a4&lang=scss&scoped=true&
var fieldNamevue_type_style_index_0_id_be6ea5a4_lang_scss_scoped_true_ = __webpack_require__("2188");

// CONCATENATED MODULE: ./src/inform/fieldName.vue






/* normalize component */

var fieldName_component = normalizeComponent(
  inform_fieldNamevue_type_script_lang_js_,
  fieldNamevue_type_template_id_be6ea5a4_scoped_true_render,
  fieldNamevue_type_template_id_be6ea5a4_scoped_true_staticRenderFns,
  false,
  null,
  "be6ea5a4",
  null
  
)

/* harmony default export */ var fieldName = (fieldName_component.exports);
// CONCATENATED MODULE: ./node_modules/lodash-es/isObject.js
/**
 * Checks if `value` is the
 * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)
 * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is an object, else `false`.
 * @example
 *
 * _.isObject({});
 * // => true
 *
 * _.isObject([1, 2, 3]);
 * // => true
 *
 * _.isObject(_.noop);
 * // => true
 *
 * _.isObject(null);
 * // => false
 */
function isObject(value) {
  var type = typeof value;
  return value != null && (type == 'object' || type == 'function');
}

/* harmony default export */ var lodash_es_isObject = (isObject);

// EXTERNAL MODULE: ./node_modules/lodash-es/_freeGlobal.js
var _freeGlobal = __webpack_require__("5ea3");

// CONCATENATED MODULE: ./node_modules/lodash-es/_root.js


/** Detect free variable `self`. */
var freeSelf = typeof self == 'object' && self && self.Object === Object && self;

/** Used as a reference to the global object. */
var root = _freeGlobal["a" /* default */] || freeSelf || Function('return this')();

/* harmony default export */ var _root = (root);

// CONCATENATED MODULE: ./node_modules/lodash-es/now.js


/**
 * Gets the timestamp of the number of milliseconds that have elapsed since
 * the Unix epoch (1 January 1970 00:00:00 UTC).
 *
 * @static
 * @memberOf _
 * @since 2.4.0
 * @category Date
 * @returns {number} Returns the timestamp.
 * @example
 *
 * _.defer(function(stamp) {
 *   console.log(_.now() - stamp);
 * }, _.now());
 * // => Logs the number of milliseconds it took for the deferred invocation.
 */
var now_now = function() {
  return _root.Date.now();
};

/* harmony default export */ var lodash_es_now = (now_now);

// CONCATENATED MODULE: ./node_modules/lodash-es/_trimmedEndIndex.js
/** Used to match a single whitespace character. */
var reWhitespace = /\s/;

/**
 * Used by `_.trim` and `_.trimEnd` to get the index of the last non-whitespace
 * character of `string`.
 *
 * @private
 * @param {string} string The string to inspect.
 * @returns {number} Returns the index of the last non-whitespace character.
 */
function trimmedEndIndex(string) {
  var index = string.length;

  while (index-- && reWhitespace.test(string.charAt(index))) {}
  return index;
}

/* harmony default export */ var _trimmedEndIndex = (trimmedEndIndex);

// CONCATENATED MODULE: ./node_modules/lodash-es/_baseTrim.js


/** Used to match leading whitespace. */
var reTrimStart = /^\s+/;

/**
 * The base implementation of `_.trim`.
 *
 * @private
 * @param {string} string The string to trim.
 * @returns {string} Returns the trimmed string.
 */
function baseTrim(string) {
  return string
    ? string.slice(0, _trimmedEndIndex(string) + 1).replace(reTrimStart, '')
    : string;
}

/* harmony default export */ var _baseTrim = (baseTrim);

// CONCATENATED MODULE: ./node_modules/lodash-es/_Symbol.js


/** Built-in value references. */
var _Symbol_Symbol = _root.Symbol;

/* harmony default export */ var _Symbol = (_Symbol_Symbol);

// CONCATENATED MODULE: ./node_modules/lodash-es/_getRawTag.js


/** Used for built-in method references. */
var objectProto = Object.prototype;

/** Used to check objects for own properties. */
var _getRawTag_hasOwnProperty = objectProto.hasOwnProperty;

/**
 * Used to resolve the
 * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)
 * of values.
 */
var nativeObjectToString = objectProto.toString;

/** Built-in value references. */
var symToStringTag = _Symbol ? _Symbol.toStringTag : undefined;

/**
 * A specialized version of `baseGetTag` which ignores `Symbol.toStringTag` values.
 *
 * @private
 * @param {*} value The value to query.
 * @returns {string} Returns the raw `toStringTag`.
 */
function getRawTag(value) {
  var isOwn = _getRawTag_hasOwnProperty.call(value, symToStringTag),
      tag = value[symToStringTag];

  try {
    value[symToStringTag] = undefined;
    var unmasked = true;
  } catch (e) {}

  var result = nativeObjectToString.call(value);
  if (unmasked) {
    if (isOwn) {
      value[symToStringTag] = tag;
    } else {
      delete value[symToStringTag];
    }
  }
  return result;
}

/* harmony default export */ var _getRawTag = (getRawTag);

// CONCATENATED MODULE: ./node_modules/lodash-es/_objectToString.js
/** Used for built-in method references. */
var _objectToString_objectProto = Object.prototype;

/**
 * Used to resolve the
 * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)
 * of values.
 */
var _objectToString_nativeObjectToString = _objectToString_objectProto.toString;

/**
 * Converts `value` to a string using `Object.prototype.toString`.
 *
 * @private
 * @param {*} value The value to convert.
 * @returns {string} Returns the converted string.
 */
function objectToString(value) {
  return _objectToString_nativeObjectToString.call(value);
}

/* harmony default export */ var _objectToString = (objectToString);

// CONCATENATED MODULE: ./node_modules/lodash-es/_baseGetTag.js




/** `Object#toString` result references. */
var nullTag = '[object Null]',
    undefinedTag = '[object Undefined]';

/** Built-in value references. */
var _baseGetTag_symToStringTag = _Symbol ? _Symbol.toStringTag : undefined;

/**
 * The base implementation of `getTag` without fallbacks for buggy environments.
 *
 * @private
 * @param {*} value The value to query.
 * @returns {string} Returns the `toStringTag`.
 */
function baseGetTag(value) {
  if (value == null) {
    return value === undefined ? undefinedTag : nullTag;
  }
  return (_baseGetTag_symToStringTag && _baseGetTag_symToStringTag in Object(value))
    ? _getRawTag(value)
    : _objectToString(value);
}

/* harmony default export */ var _baseGetTag = (baseGetTag);

// CONCATENATED MODULE: ./node_modules/lodash-es/isObjectLike.js
/**
 * Checks if `value` is object-like. A value is object-like if it's not `null`
 * and has a `typeof` result of "object".
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is object-like, else `false`.
 * @example
 *
 * _.isObjectLike({});
 * // => true
 *
 * _.isObjectLike([1, 2, 3]);
 * // => true
 *
 * _.isObjectLike(_.noop);
 * // => false
 *
 * _.isObjectLike(null);
 * // => false
 */
function isObjectLike(value) {
  return value != null && typeof value == 'object';
}

/* harmony default export */ var lodash_es_isObjectLike = (isObjectLike);

// CONCATENATED MODULE: ./node_modules/lodash-es/isSymbol.js



/** `Object#toString` result references. */
var symbolTag = '[object Symbol]';

/**
 * Checks if `value` is classified as a `Symbol` primitive or object.
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.
 * @example
 *
 * _.isSymbol(Symbol.iterator);
 * // => true
 *
 * _.isSymbol('abc');
 * // => false
 */
function isSymbol(value) {
  return typeof value == 'symbol' ||
    (lodash_es_isObjectLike(value) && _baseGetTag(value) == symbolTag);
}

/* harmony default export */ var lodash_es_isSymbol = (isSymbol);

// CONCATENATED MODULE: ./node_modules/lodash-es/toNumber.js




/** Used as references for various `Number` constants. */
var NAN = 0 / 0;

/** Used to detect bad signed hexadecimal string values. */
var reIsBadHex = /^[-+]0x[0-9a-f]+$/i;

/** Used to detect binary string values. */
var reIsBinary = /^0b[01]+$/i;

/** Used to detect octal string values. */
var reIsOctal = /^0o[0-7]+$/i;

/** Built-in method references without a dependency on `root`. */
var freeParseInt = parseInt;

/**
 * Converts `value` to a number.
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Lang
 * @param {*} value The value to process.
 * @returns {number} Returns the number.
 * @example
 *
 * _.toNumber(3.2);
 * // => 3.2
 *
 * _.toNumber(Number.MIN_VALUE);
 * // => 5e-324
 *
 * _.toNumber(Infinity);
 * // => Infinity
 *
 * _.toNumber('3.2');
 * // => 3.2
 */
function lodash_es_toNumber_toNumber(value) {
  if (typeof value == 'number') {
    return value;
  }
  if (lodash_es_isSymbol(value)) {
    return NAN;
  }
  if (lodash_es_isObject(value)) {
    var other = typeof value.valueOf == 'function' ? value.valueOf() : value;
    value = lodash_es_isObject(other) ? (other + '') : other;
  }
  if (typeof value != 'string') {
    return value === 0 ? value : +value;
  }
  value = _baseTrim(value);
  var isBinary = reIsBinary.test(value);
  return (isBinary || reIsOctal.test(value))
    ? freeParseInt(value.slice(2), isBinary ? 2 : 8)
    : (reIsBadHex.test(value) ? NAN : +value);
}

/* harmony default export */ var lodash_es_toNumber = (lodash_es_toNumber_toNumber);

// CONCATENATED MODULE: ./node_modules/lodash-es/debounce.js




/** Error message constants. */
var FUNC_ERROR_TEXT = 'Expected a function';

/* Built-in method references for those with the same name as other `lodash` methods. */
var nativeMax = Math.max,
    nativeMin = Math.min;

/**
 * Creates a debounced function that delays invoking `func` until after `wait`
 * milliseconds have elapsed since the last time the debounced function was
 * invoked. The debounced function comes with a `cancel` method to cancel
 * delayed `func` invocations and a `flush` method to immediately invoke them.
 * Provide `options` to indicate whether `func` should be invoked on the
 * leading and/or trailing edge of the `wait` timeout. The `func` is invoked
 * with the last arguments provided to the debounced function. Subsequent
 * calls to the debounced function return the result of the last `func`
 * invocation.
 *
 * **Note:** If `leading` and `trailing` options are `true`, `func` is
 * invoked on the trailing edge of the timeout only if the debounced function
 * is invoked more than once during the `wait` timeout.
 *
 * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred
 * until to the next tick, similar to `setTimeout` with a timeout of `0`.
 *
 * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)
 * for details over the differences between `_.debounce` and `_.throttle`.
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Function
 * @param {Function} func The function to debounce.
 * @param {number} [wait=0] The number of milliseconds to delay.
 * @param {Object} [options={}] The options object.
 * @param {boolean} [options.leading=false]
 *  Specify invoking on the leading edge of the timeout.
 * @param {number} [options.maxWait]
 *  The maximum time `func` is allowed to be delayed before it's invoked.
 * @param {boolean} [options.trailing=true]
 *  Specify invoking on the trailing edge of the timeout.
 * @returns {Function} Returns the new debounced function.
 * @example
 *
 * // Avoid costly calculations while the window size is in flux.
 * jQuery(window).on('resize', _.debounce(calculateLayout, 150));
 *
 * // Invoke `sendMail` when clicked, debouncing subsequent calls.
 * jQuery(element).on('click', _.debounce(sendMail, 300, {
 *   'leading': true,
 *   'trailing': false
 * }));
 *
 * // Ensure `batchLog` is invoked once after 1 second of debounced calls.
 * var debounced = _.debounce(batchLog, 250, { 'maxWait': 1000 });
 * var source = new EventSource('/stream');
 * jQuery(source).on('message', debounced);
 *
 * // Cancel the trailing debounced invocation.
 * jQuery(window).on('popstate', debounced.cancel);
 */
function debounce(func, wait, options) {
  var lastArgs,
      lastThis,
      maxWait,
      result,
      timerId,
      lastCallTime,
      lastInvokeTime = 0,
      leading = false,
      maxing = false,
      trailing = true;

  if (typeof func != 'function') {
    throw new TypeError(FUNC_ERROR_TEXT);
  }
  wait = lodash_es_toNumber(wait) || 0;
  if (lodash_es_isObject(options)) {
    leading = !!options.leading;
    maxing = 'maxWait' in options;
    maxWait = maxing ? nativeMax(lodash_es_toNumber(options.maxWait) || 0, wait) : maxWait;
    trailing = 'trailing' in options ? !!options.trailing : trailing;
  }

  function invokeFunc(time) {
    var args = lastArgs,
        thisArg = lastThis;

    lastArgs = lastThis = undefined;
    lastInvokeTime = time;
    result = func.apply(thisArg, args);
    return result;
  }

  function leadingEdge(time) {
    // Reset any `maxWait` timer.
    lastInvokeTime = time;
    // Start the timer for the trailing edge.
    timerId = setTimeout(timerExpired, wait);
    // Invoke the leading edge.
    return leading ? invokeFunc(time) : result;
  }

  function remainingWait(time) {
    var timeSinceLastCall = time - lastCallTime,
        timeSinceLastInvoke = time - lastInvokeTime,
        timeWaiting = wait - timeSinceLastCall;

    return maxing
      ? nativeMin(timeWaiting, maxWait - timeSinceLastInvoke)
      : timeWaiting;
  }

  function shouldInvoke(time) {
    var timeSinceLastCall = time - lastCallTime,
        timeSinceLastInvoke = time - lastInvokeTime;

    // Either this is the first call, activity has stopped and we're at the
    // trailing edge, the system time has gone backwards and we're treating
    // it as the trailing edge, or we've hit the `maxWait` limit.
    return (lastCallTime === undefined || (timeSinceLastCall >= wait) ||
      (timeSinceLastCall < 0) || (maxing && timeSinceLastInvoke >= maxWait));
  }

  function timerExpired() {
    var time = lodash_es_now();
    if (shouldInvoke(time)) {
      return trailingEdge(time);
    }
    // Restart the timer.
    timerId = setTimeout(timerExpired, remainingWait(time));
  }

  function trailingEdge(time) {
    timerId = undefined;

    // Only invoke if we have `lastArgs` which means `func` has been
    // debounced at least once.
    if (trailing && lastArgs) {
      return invokeFunc(time);
    }
    lastArgs = lastThis = undefined;
    return result;
  }

  function cancel() {
    if (timerId !== undefined) {
      clearTimeout(timerId);
    }
    lastInvokeTime = 0;
    lastArgs = lastCallTime = lastThis = timerId = undefined;
  }

  function flush() {
    return timerId === undefined ? result : trailingEdge(lodash_es_now());
  }

  function debounced() {
    var time = lodash_es_now(),
        isInvoking = shouldInvoke(time);

    lastArgs = arguments;
    lastThis = this;
    lastCallTime = time;

    if (isInvoking) {
      if (timerId === undefined) {
        return leadingEdge(lastCallTime);
      }
      if (maxing) {
        // Handle invocations in a tight loop.
        clearTimeout(timerId);
        timerId = setTimeout(timerExpired, wait);
        return invokeFunc(lastCallTime);
      }
    }
    if (timerId === undefined) {
      timerId = setTimeout(timerExpired, wait);
    }
    return result;
  }
  debounced.cancel = cancel;
  debounced.flush = flush;
  return debounced;
}

/* harmony default export */ var lodash_es_debounce = (debounce);

// CONCATENATED MODULE: ./src/inform/tool.js



var tool_insertDeleteRowColumn = {
  insert: function insert(sri) {
    var n = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;

    var cb = function cb(item) {
      return item.replace(/[A-Z]{1,3}\d+/g, function (word) {
        return expr2expr(word, 0, n, function (x, y) {
          return y >= sri;
        });
      });
    };

    return cb;
  },
  insertColumn: function insertColumn(sci) {
    var n = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;

    var cb = function cb(item) {
      return item.replace(/[A-Z]{1,3}\d+/g, function (word) {
        return expr2expr(word, n, 0, function (x) {
          return x >= sci;
        });
      });
    };

    return cb;
  },
  delete: function _delete(sri, eri) {
    var n = eri - sri + 1;

    var cb = function cb(item) {
      return item.replace(/[A-Z]{1,3}\d+/g, function (word) {
        return expr2expr(word, 0, -n, function (x, y) {
          return y > eri;
        });
      });
    };

    return cb;
  },
  deleteColumn: function deleteColumn(sci, eci) {
    var n = eci - sci + 1;

    var cb = function cb(item) {
      return item.replace(/[A-Z]{1,3}\d+/g, function (word) {
        return expr2expr(word, -n, 0, function (x) {
          return x > eci;
        });
      });
    };

    return cb;
  }
};
// EXTERNAL MODULE: ./node_modules/core-js/modules/es.promise.js
var es_promise = __webpack_require__("e6cf");

// CONCATENATED MODULE: ./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js



function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {
  try {
    var info = gen[key](arg);
    var value = info.value;
  } catch (error) {
    reject(error);
    return;
  }

  if (info.done) {
    resolve(value);
  } else {
    Promise.resolve(value).then(_next, _throw);
  }
}

function _asyncToGenerator(fn) {
  return function () {
    var self = this,
        args = arguments;
    return new Promise(function (resolve, reject) {
      var gen = fn.apply(self, args);

      function _next(value) {
        asyncGeneratorStep(gen, resolve, reject, _next, _throw, "next", value);
      }

      function _throw(err) {
        asyncGeneratorStep(gen, resolve, reject, _next, _throw, "throw", err);
      }

      _next(undefined);
    });
  };
}
// EXTERNAL MODULE: ./node_modules/regenerator-runtime/runtime.js
var runtime = __webpack_require__("96cf");

// CONCATENATED MODULE: ./src/inform/mixins/dynamicRow.js









var MAX_INSET = 100;
/* harmony default export */ var dynamicRow = ({
  name: 'dynamicRow',
  created: function created() {
    var _this = this;

    this._dynamicRow = function (type, rect, renderType) {
      var num = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 1;
      if (num > MAX_INSET || num <= 0) return _this.$message.error("\u4E00\u6B21\uFF0C\u53EA\u80FD\u8FDE\u7EED\u63D2\u51651-".concat(MAX_INSET, "\u884C\uFF01"));
      var range = new cell_range_CellRange(rect.ri, 0, rect.ri, _this._sheet.data.cols.len);

      if (type === 'add') {
        _this.addFormRow(range, num);
      }

      if (type === 'delete') {
        _this.deleteFormRow(range);
      }
    };
  },
  methods: {
    //copy Config
    copyPasteHandel: function copyPasteHandel(clipboard, num) {
      var _this2 = this;

      var rn = 2;
      var formConfig = JSON.parse(JSON.stringify(this.formConfig));
      var sri = clipboard.range.sri;
      clipboard.range.each(function (ri, ci) {
        var key = _this2._sheet.data.xy2expr(ci, sri);

        var id = key.replace(/[^a-zA-Z]/g, '');
        var item = formConfig[key];

        if (item) {
          var newKey = null;

          for (var index = 0; index < num; index++) {
            newKey = "".concat(id).concat(ri + rn + index);
            formConfig[newKey] = item;
          }
        }
      });
      this.$emit('update:formConfig', formConfig);
    },
    addFormRowReset: function addFormRowReset(ri, ci) {
      this.aggregate();
      this.resetSelector(ri, ci);
      this.renderSheet();
    },
    //新增行 hide -> add (insert->copy)
    addFormRow: function addFormRow(range, num) {
      var _this$_sheet$data$row;

      var _range = range,
          sri = _range.sri,
          sci = _range.sci;
      var copyFrom = (_this$_sheet$data$row = this._sheet.data.rows.getOrNew(sri)) === null || _this$_sheet$data$row === void 0 ? void 0 : _this$_sheet$data$row.copyFrom;

      if (copyFrom === undefined) {
        //首次添加
        if (sri > 0) {
          copyFrom = new Date().getTime();
          var copyRi = sri - 1;

          this._sheet.data.rows.setProperty(copyRi, 'copyFrom', copyFrom);

          this._sheet.data.rows.setProperty(copyRi, 'operateType', 'add');

          this._sheet.data.unhideRowsOrCols('row', sri);

          this.addFormRowReset(copyRi, sci);

          if (num > 1) {
            range = new cell_range_CellRange(copyRi, 0, copyRi, this._sheet.data.cols.len);
            this.addRowData(range, copyFrom, num - 1);
          }
        }

        return;
      }

      this.addRowData(range, copyFrom, num);
    },
    addRowData: function addRowData(range, copyFrom, num) {
      var _this3 = this;

      var sri = range.sri,
          sci = range.sci,
          eri = range.eri,
          eci = range.eci;
      var endRange = new cell_range_CellRange(sri + 1, sci, eri + 1, eci);
      this.handleInsertDeleteRowColumn('insert-row', num, endRange);

      this._sheet.data.insertHandler('row', num, sri + 1, sci);

      this.$nextTick(function () {
        _this3.copyPasteHandel({
          range: range
        }, num);

        for (var index = 0; index < num; index++) {
          var _endRange = new cell_range_CellRange(sri + 1 + index, sci, eri + 1 + index, eci);

          _this3._sheet.data.rows.setProperty(_endRange.sri, 'renderType', 'dynamic-row');

          _this3._sheet.data.rows.setProperty(_endRange.sri, 'copyFrom', copyFrom);

          _this3._sheet.data.rows.setProperty(_endRange.sri, 'operateType', 'add');

          _this3._sheet.data.pasteHandel(range, _endRange, 'all');
        }

        _this3.$nextTick(function () {
          _this3.addFormRowReset(endRange.sri, sci);
        });
      });
    },
    //删除行 delete->hide
    deleteFormRow: function deleteFormRow(range) {
      var _this4 = this;

      return _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee() {
        var _this4$_sheet$data$ro;

        var resetRi, copyFrom, arr, index, row, _this4$_sheet$data$ro2;

        return regeneratorRuntime.wrap(function _callee$(_context) {
          while (1) {
            switch (_context.prev = _context.next) {
              case 0:
                resetRi = range.sri;
                copyFrom = (_this4$_sheet$data$ro = _this4._sheet.data.rows.get(range.sri)) === null || _this4$_sheet$data$ro === void 0 ? void 0 : _this4$_sheet$data$ro.copyFrom;
                arr = [];
                index = 0;

              case 4:
                if (!(index < _this4._sheet.data.rows.len - 1)) {
                  _context.next = 13;
                  break;
                }

                row = _this4._sheet.data.rows.get(index) || {};

                if (!Object.hasOwnProperty.call(row, 'copyFrom')) {
                  _context.next = 10;
                  break;
                }

                if (copyFrom === row.copyFrom) {
                  arr.push(index);
                }

                if (!(arr.length == 2)) {
                  _context.next = 10;
                  break;
                }

                return _context.abrupt("break", 13);

              case 10:
                index++;
                _context.next = 4;
                break;

              case 13:
                if (arr.length !== 1 && copyFrom !== undefined) {
                  _this4.handleInsertDeleteRowColumn('delete-row', 1, range);

                  _this4._sheet.data.handleDelete(range);
                } else {
                  //末行删除
                  _this4._sheet.data.rows.setHide(range.sri, true);

                  (_this4$_sheet$data$ro2 = _this4._sheet.data.rows.get(range.sri)) === null || _this4$_sheet$data$ro2 === void 0 ? true : delete _this4$_sheet$data$ro2.copyFrom;

                  _this4.renderItem(true);

                  resetRi = range.sri + 1;
                }

                _context.next = 16;
                return _this4.$nextTick();

              case 16:
                _this4.addFormRowReset(resetRi, range.sci);

              case 17:
              case "end":
                return _context.stop();
            }
          }
        }, _callee);
      }))();
    },
    resetSelector: function resetSelector(sri, sci) {
      this._sheet.editor.clear();

      this._sheet.selector.set(sri, sci);

      this._sheet.reload();
    },
    aggregate: function aggregate() {
      var aggregateRef = {};

      for (var key in this.formConfig) {
        if (Object.hasOwnProperty.call(this.formConfig, key)) {
          var _item$sourceConfig, _item$sourceConfig$ag, _item$sourceConfig2, _item$sourceConfig2$a;

          var item = this.formConfig[key];

          if ((_item$sourceConfig = item.sourceConfig) !== null && _item$sourceConfig !== void 0 && (_item$sourceConfig$ag = _item$sourceConfig.aggregate) !== null && _item$sourceConfig$ag !== void 0 && _item$sourceConfig$ag.enable && !((_item$sourceConfig2 = item.sourceConfig) !== null && _item$sourceConfig2 !== void 0 && (_item$sourceConfig2$a = _item$sourceConfig2.aggregate) !== null && _item$sourceConfig2$a !== void 0 && _item$sourceConfig2$a.hierarchyId)) {
            aggregateRef[key] = item;
          }
        }
      }

      var refs = {};

      for (var ref in aggregateRef) {
        var _aggregateRef$ref$sou = aggregateRef[ref].sourceConfig,
            fieldId = _aggregateRef$ref$sou.fieldId,
            aggregate = _aggregateRef$ref$sou.aggregate;
        refs[ref] = [];

        for (var _key in this.formConfig) {
          if (Object.hasOwnProperty.call(this.formConfig, _key)) {
            var _item$sourceConfig3, _item$sourceConfig3$a;

            var _item = this.formConfig[_key];

            if (!((_item$sourceConfig3 = _item.sourceConfig) !== null && _item$sourceConfig3 !== void 0 && (_item$sourceConfig3$a = _item$sourceConfig3.aggregate) !== null && _item$sourceConfig3$a !== void 0 && _item$sourceConfig3$a.enable) && _item.sourceConfig.fieldId == fieldId) {
              var _this$_sheet$data$row2;

              var _this$getRange = this.getRange(_key),
                  _range2 = _this$getRange.range;

              if (((_this$_sheet$data$row2 = this._sheet.data.rows.get(_range2.sri)) === null || _this$_sheet$data$row2 === void 0 ? void 0 : _this$_sheet$data$row2.hide) !== true) {
                refs[ref].push(_key);
              }
            }
          }
        }

        var _this$getRange2 = this.getRange(ref),
            range = _this$getRange2.range;

        var sri = range.sri,
            sci = range.sci;

        if (refs[ref].length > 0) {
          this._sheet.data.rows.setCellText(sri, sci, "=".concat(aggregate.type, "(").concat(refs[ref].sort().join(','), ")"));
        }

        if (refs[ref].length === 0) {
          this._sheet.data.rows.setCellText(sri, sci, "=".concat(aggregate.type, "(0)"));
        }
      }
    }
  }
});
// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js??ref--13-0!./node_modules/thread-loader/dist/cjs.js!./node_modules/babel-loader/lib!./node_modules/cache-loader/dist/cjs.js??ref--1-0!./node_modules/vue-loader/lib??vue-loader-options!./src/inform/index.vue?vue&type=script&lang=js&




var informvue_type_script_lang_js_excluded = ["cell"];










//
//
//
//
//






/* harmony default export */ var informvue_type_script_lang_js_ = ({
  name: 'inform',
  mixins: [dynamicRow],
  components: {
    fieldName: fieldName
  },
  data: function data() {
    return {
      tableOffset: {},
      formData: {},
      formStyle: {},
      focusItem: '',
      dpr: window.devicePixelRatio || 1
    };
  },
  computed: {
    //form容器计算
    contentStyle: function contentStyle() {
      var top = this.tableOffset.top;
      var v = {};
      var _this$_sheet$data$set = this._sheet.data.settings,
          minContent = _this$_sheet$data$set.minContent,
          showToolbar = _this$_sheet$data$set.showToolbar;

      if (minContent) {
        v = {
          left: '50%',
          transform: 'translate(-50%, 0)'
        };
      }

      return _objectSpread2(_objectSpread2({}, this.getStyle(_objectSpread2(_objectSpread2({}, this.tableOffset), {}, {
        top: showToolbar ? top + 81 : top
      }))), v);
    }
  },
  watch: {
    //formConfig -> formData
    formConfig: {
      deep: true,
      handler: function handler() {
        this.renderItem();
      }
    }
  },
  props: {
    formConfig: Object,
    getSpreadsheet: [Function],
    activeSheetName: String,
    isEdit: {
      type: Boolean,
      default: true
    },
    showFieldName: {
      type: Boolean,
      default: false
    },
    renderTime: Number
  },
  created: function created() {
    this._ = this.getSpreadsheet();
    this._sheet = this.getSpreadsheet().sheet;
    this.resizeContent();
    this.renderItem();
  },
  mounted: function mounted() {
    var _this = this;

    this._cellsSelected = function (cell, range) {
      if (range.multiple()) {
        _this.focusItem = '';
      }
    };

    this._.on('cells-selected', this._cellsSelected);

    this._.on('dynamic-row', this._dynamicRow);

    this.insertDeleteRowColumn();
    this.onChangeScrollResize();
  },
  methods: {
    resizeContent: function resizeContent() {
      this.tableOffset = this._sheet.getTableOffset();
    },
    //滚动条响应
    onChangeScrollResize: function onChangeScrollResize() {
      var _this2 = this;

      this._verticalScrollbar = this._sheet.verticalScrollbar.el.el;
      this._horizontalScrollbar = this._sheet.horizontalScrollbar.el.el;
      this._scroll = this.renderTime < 28 ? function () {
        return window.requestAnimationFrame(function () {
          return _this2.$emit('syncViewRange');
        });
      } : lodash_es_debounce(function () {
        return _this2.$emit('syncViewRange');
      }, this.renderTime);
      addListener(this._verticalScrollbar.firstChild, this._scroll);
      addListener(this._horizontalScrollbar.firstChild, this._scroll);

      this._verticalScrollbar.addEventListener('scroll', this._scroll, true);

      this._horizontalScrollbar.addEventListener('scroll', this._scroll, true);

      window.addEventListener('resize', function () {
        _this2.resizeContent();

        _this2.$emit('syncViewRange');
      });
    },
    renderItem: function renderItem() {
      this.formStyle = {};

      for (var key in this.formConfig) {
        if (Object.hasOwnProperty.call(this.formConfig, key)) {
          var item = this.formConfig[key];
          this.setItemStyle(item, key);
        }
      }
    },
    initForm: function initForm(item, key) {
      var _cell$text;

      var _this$getRange = this.getRange(key),
          range = _this$getRange.range;

      var sri = range.sri,
          sci = range.sci;

      var cell = this._sheet.data.getCell(sri, sci);

      var text = (_cell$text = cell === null || cell === void 0 ? void 0 : cell.text) !== null && _cell$text !== void 0 ? _cell$text : '';
      this.$set(this.formData, key, this.formatVal(item, text));
    },
    clickItem: function clickItem(key, item) {
      var _this$getRange2 = this.getRange(key),
          range = _this$getRange2.range;

      var sri = range.sri,
          sci = range.sci;
      this.setItemStyle(item, key);

      this._sheet.selector.set(sri, sci);

      this._sheet.toolbar.reset();
    },
    // PUBLIC获取提交值
    getFormData: function getFormData() {
      var formData = {};

      var _iterator = _createForOfIteratorHelper(this._.datas),
          _step;

      try {
        for (_iterator.s(); !(_step = _iterator.n()).done;) {
          var iterator = _step.value;
          formData[iterator.name] = {};

          for (var key in iterator.formConfig) {
            if (Object.hasOwnProperty.call(iterator.formConfig, key)) {
              var _this$getRange3 = this.getRange(key),
                  range = _this$getRange3.range;

              var sci = range.sci,
                  sri = range.sri;

              var row = this._sheet.data.rows.get(sri);

              if (!((row === null || row === void 0 ? void 0 : row.hide) === true && (row === null || row === void 0 ? void 0 : row.renderType) === 'dynamic-row')) {
                var _cell$text2;

                var dataCell = iterator.cellRect(sri, sci);
                var cell = dataCell.cell;
                var text = (_cell$text2 = cell === null || cell === void 0 ? void 0 : cell.text) !== null && _cell$text2 !== void 0 ? _cell$text2 : null;
                var sourceConfig = iterator.formConfig[key].sourceConfig;
                formData[iterator.name][key] = {
                  sourceConfig: sourceConfig,
                  value: this.formatVal(iterator.formConfig[key], text)
                };
              }
            }
          }
        }
      } catch (err) {
        _iterator.e(err);
      } finally {
        _iterator.f();
      }

      return formData;
    },
    // number -> `number`px
    getStyle: function getStyle(Offset, dpr) {
      var contentStyle = {};

      for (var key in Offset) {
        if (['height', 'left', 'top', 'width'].includes(key)) {
          if (Object.hasOwnProperty.call(Offset, key)) {
            var element = Offset[key];
            var dprOffset = (dpr === null || dpr === void 0 ? void 0 : dpr[key]) || 0;
            contentStyle[key] = "".concat(element + dprOffset, "px");

            if (key == 'top' && Offset[key] == 0 || key == 'left' && Offset[key] == 0) {
              contentStyle["border-".concat(key)] = '1px transparent solid';
            }
          }
        }
      }

      return contentStyle;
    },
    //form Item偏移量计算
    setItemStyle: function setItemStyle(item, key) {
      var type = item === null || item === void 0 ? void 0 : item.type;
      if (type.includes('ExcelInput') && !this.isEdit) return;

      var _this$getRange4 = this.getRange(key),
          range = _this$getRange4.range;

      var sri = range.sri,
          sci = range.sci;

      var dataCell = this._sheet.data.cellRect(sri, sci);

      var cell = dataCell.cell,
          style = _objectWithoutProperties(dataCell, informvue_type_script_lang_js_excluded);

      cell;
      style = this._sheet.data.getRect(range);
      this.getFreezeOffset(style, key);
      this.$set(this.formStyle, key, this.getStyle(style, {
        height: this.dpr > 1 ? -1 : 0
      }));

      switch (type) {
        case 'ExcelCheckboxGroup':
        case 'ExcelRadioGroup':
        case 'ExcelRate':
        case 'ExcelUpload':
          this._sheet.data.setCellStyle('format', 'transparent', sri, sci);

          break;

        default:
          break;
      }
    },
    //冻结 cell-style操作
    getFreezeOffset: function getFreezeOffset(style, key) {
      var fsh = this._sheet.data.freezeTotalHeight();

      var fsw = this._sheet.data.freezeTotalWidth();

      var _this$_sheet$data$fre = _slicedToArray(this._sheet.data.freeze, 2),
          sri = _this$_sheet$data$fre[0],
          sci = _this$_sheet$data$fre[1];

      var _this$_sheet$data$exp = this._sheet.data.expr2xy(key),
          _this$_sheet$data$exp2 = _slicedToArray(_this$_sheet$data$exp, 2),
          ci = _this$_sheet$data$exp2[0],
          ri = _this$_sheet$data$exp2[1];

      var isRiOver = ri >= sri;
      var isCiOver = ci >= sci;

      if (isRiOver) {
        if (fsh - style.top > 0) {
          style.top = style.top - fsh;
        }
      }

      if (isCiOver) {
        if (fsw - style.left > 0) {
          style.left = style.left - fsw;
        }
      }
    },
    //ref A1 -> range
    getRange: function getRange(expr) {
      var merge = expr.includes(':');
      var s, e;

      if (merge) {
        var _expr$split = expr.split(':');

        var _expr$split2 = _slicedToArray(_expr$split, 2);

        s = _expr$split2[0];
        e = _expr$split2[1];
      } else {
        s = expr;
        e = expr;
      }

      var _this$_sheet$data$exp3 = this._sheet.data.expr2xy(s),
          _this$_sheet$data$exp4 = _slicedToArray(_this$_sheet$data$exp3, 2),
          sci = _this$_sheet$data$exp4[0],
          sri = _this$_sheet$data$exp4[1];

      var _this$_sheet$data$exp5 = this._sheet.data.expr2xy(e),
          _this$_sheet$data$exp6 = _slicedToArray(_this$_sheet$data$exp5, 2),
          eci = _this$_sheet$data$exp6[0],
          eri = _this$_sheet$data$exp6[1];

      return {
        merge: merge,
        range: {
          sri: sri,
          sci: sci,
          eri: eri,
          eci: eci
        }
      };
    },
    getItemClass: function getItemClass(item, key) {
      return "inform-item ".concat(item.type, " ").concat(this.focusItem === key ? 'focusItem' : '');
    },
    //value ——> label
    formatText: function formatText(item, element) {
      var _item$config;

      var isArray = Array.isArray(element);
      var text = isArray ? [] : '';
      var options = item === null || item === void 0 ? void 0 : (_item$config = item.config) === null || _item$config === void 0 ? void 0 : _item$config.options;

      if (options) {
        var _iterator2 = _createForOfIteratorHelper(options),
            _step2;

        try {
          for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {
            var iterator = _step2.value;

            if (isArray) {
              var _iterator3 = _createForOfIteratorHelper(element),
                  _step3;

              try {
                for (_iterator3.s(); !(_step3 = _iterator3.n()).done;) {
                  var _item = _step3.value;

                  if (iterator.value == _item) {
                    text.push(iterator.label);
                  }
                }
              } catch (err) {
                _iterator3.e(err);
              } finally {
                _iterator3.f();
              }
            } else {
              if (iterator.value == element) {
                text = iterator.label;
              }
            }
          }
        } catch (err) {
          _iterator2.e(err);
        } finally {
          _iterator2.f();
        }
      } else {
        text = element;
      }

      return text;
    },
    //label ——> value
    formatVal: function formatVal(item, element) {
      var _item$config2;

      var isArray = Array.isArray(element);
      var value = isArray ? [] : '';
      var options = item === null || item === void 0 ? void 0 : (_item$config2 = item.config) === null || _item$config2 === void 0 ? void 0 : _item$config2.options;

      if (options) {
        var _iterator4 = _createForOfIteratorHelper(options),
            _step4;

        try {
          for (_iterator4.s(); !(_step4 = _iterator4.n()).done;) {
            var iterator = _step4.value;

            if (isArray) {
              var _iterator5 = _createForOfIteratorHelper(element),
                  _step5;

              try {
                for (_iterator5.s(); !(_step5 = _iterator5.n()).done;) {
                  var _item2 = _step5.value;

                  if (_item2 == iterator.label) {
                    value.push(iterator.value);
                  }
                }
              } catch (err) {
                _iterator5.e(err);
              } finally {
                _iterator5.f();
              }
            } else {
              if (iterator.label == element) {
                value = iterator.value;
              }
            }
          }
        } catch (err) {
          _iterator4.e(err);
        } finally {
          _iterator4.f();
        }
      } else {
        value = element;
      }

      return this.getDefaultValue(item, value);
    },
    getDefaultValue: function getDefaultValue(_ref, element) {
      var type = _ref.type;

      if (type === 'ExcelCheckboxGroup') {
        //array
        if (Array.isArray(element)) {
          return element;
        } else if (element == '' || !element) {
          return [];
        }

        return [element];
      } else if (type === 'ExcelRate') {
        if (element == '' || !element) {
          return 0;
        } //number


        return Number(element);
      } else {
        //string
        return element;
      }
    },
    //新增删除行 formConfig操作
    insertDeleteRowColumn: function insertDeleteRowColumn() {
      var _this3 = this;

      this._insertDelete = function (type, n) {
        _this3.handleInsertDeleteRowColumn(type, n);
      };

      this._.on('insert-delete', this._insertDelete);
    },
    handleInsertDeleteRowColumn: function handleInsertDeleteRowColumn(type) {
      var n = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;
      var range = arguments.length > 2 ? arguments[2] : undefined;
      var cb = null;

      if (!range) {
        range = this._sheet.data.selector.range;
      }

      var _range = range,
          sri = _range.sri,
          sci = _range.sci,
          eri = _range.eri,
          eci = _range.eci;

      if (type === 'insert-row') {
        cb = tool_insertDeleteRowColumn.insert(sri, n);
      } else if (type === 'delete-row') {
        cb = tool_insertDeleteRowColumn.delete(sri, eri);
        range = new cell_range_CellRange(sri, 0, eri, this._sheet.data.cols.len);
      } else if (type === 'insert-column') {
        cb = tool_insertDeleteRowColumn.insertColumn(sci, n);
      } else if (type === 'delete-column') {
        cb = tool_insertDeleteRowColumn.deleteColumn(sci, eci);
        range = new cell_range_CellRange(0, sci, this._sheet.data.rows.len, eci);
      }

      var formConfig = JSON.parse(JSON.stringify(this._sheet.data.formConfig));
      var newFormConfig = {};

      if (['insert-row', 'insert-column'].includes(type)) {
        for (var key in formConfig) {
          if (Object.hasOwnProperty.call(formConfig, key)) {
            newFormConfig[cb(key)] = formConfig[key];
          }
        }

        this.$emit('setLayerConfig', newFormConfig);
      }

      if (['delete-row', 'delete-column'].includes(type)) {
        for (var _key in formConfig) {
          if (Object.hasOwnProperty.call(formConfig, _key)) {
            if (!range.includes(_key)) {
              newFormConfig[cb(_key)] = formConfig[_key];
            }
          }
        }

        this.$emit('setLayerConfig', newFormConfig);
      }
    },
    deleteConfig: function deleteConfig() {
      var _this$_sheet$data = this._sheet.data,
          selector = _this$_sheet$data.selector,
          xy2expr = _this$_sheet$data.xy2expr;
      var formConfig = JSON.parse(JSON.stringify(this._sheet.data.formConfig));
      selector.range.each(function (ri, ci) {
        var expr = xy2expr(ci, ri);
        delete formConfig[expr];
        Object.keys(formConfig).map(function (key) {
          if (key.includes("".concat(expr, ":"))) {
            delete formConfig[key];
          }
        });
      });
      this.$emit('setLayerConfig', formConfig);
    },
    renderSheet: function renderSheet() {
      this._sheet.toolbar.reset();

      this._sheet.table.render();
    }
  },
  beforeDestroy: function beforeDestroy() {
    window.removeEventListener('resize', this.resizeContent);
    esm_removeListener(this._verticalScrollbar.firstChild, this._scroll);
    esm_removeListener(this._horizontalScrollbar.firstChild, this._scroll);

    this._sheet.off('cells-selected', this._cellsSelected);

    this._sheet.off('dynamic-row', this._dynamicRow);

    this._sheet.off('insert-delete', this._insertDelete);
  }
});
// CONCATENATED MODULE: ./src/inform/index.vue?vue&type=script&lang=js&
 /* harmony default export */ var src_informvue_type_script_lang_js_ = (informvue_type_script_lang_js_); 
// EXTERNAL MODULE: ./src/inform/index.vue?vue&type=style&index=0&id=04b2b68d&lang=scss&scoped=true&
var informvue_type_style_index_0_id_04b2b68d_lang_scss_scoped_true_ = __webpack_require__("b3bd");

// CONCATENATED MODULE: ./src/inform/index.vue






/* normalize component */

var inform_component = normalizeComponent(
  src_informvue_type_script_lang_js_,
  informvue_type_template_id_04b2b68d_scoped_true_render,
  informvue_type_template_id_04b2b68d_scoped_true_staticRenderFns,
  false,
  null,
  "04b2b68d",
  null
  
)

/* harmony default export */ var inform = (inform_component.exports);
// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"7cdf87ba-vue-loader-template"}!./node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ref--1-0!./node_modules/vue-loader/lib??vue-loader-options!./src/rectTable/index.vue?vue&type=template&id=d7e4c994&scoped=true&
var rectTablevue_type_template_id_d7e4c994_scoped_true_render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('div',{staticClass:"rect-content",style:(_vm.contentRectStyle)},_vm._l((_vm.showrectConfig),function(item,key){return _c('div',{key:key,staticClass:"rect-item",style:(_vm.rectStyle[key])},[_c('span',{style:({ 'background-color': _vm.rectStyle[key]['border-color'] })},[_vm._v(_vm._s(key))])])}),0),(_vm.showRectType)?_c('div',{staticClass:"rect-content",style:(_vm.contentStyle)},[_vm._l((_vm.rectRowType),function(item,key){return _c('div',{key:'rowType' + key,staticClass:"rect-row-item row-io",style:(item.style)},[(item.type == 'header')?_c('span',{staticClass:"icon spread-sheet"},[_vm._v("")]):(item.type == 'dataRegion')?_c('span',{staticClass:"icon spread-sheet"},[_vm._v("")]):(item.type == 'dynamic-row')?_c('span',{staticClass:"icon spread-sheet"},[_vm._v("")]):(item.type == 'footer')?_c('span',{staticClass:"icon spread-sheet"},[_vm._v("")]):_vm._e()])}),_vm._l((_vm.rectColType),function(item,key){return _c('div',{key:'colType' + key,staticClass:"rect-row-item",style:(item.style)},[(item.type == 'header')?_c('span',{staticClass:"icon spread-sheet"},[_vm._v("")]):(item.type == 'dataRegion')?_c('span',{staticClass:"icon spread-sheet"},[_vm._v("")]):(item.type == 'dynamic-row')?_c('span',{staticClass:"icon spread-sheet"},[_vm._v("")]):(item.type == 'footer')?_c('span',{staticClass:"icon spread-sheet"},[_vm._v("")]):_vm._e()])})],2):_vm._e()])}
var rectTablevue_type_template_id_d7e4c994_scoped_true_staticRenderFns = []


// CONCATENATED MODULE: ./src/rectTable/index.vue?vue&type=template&id=d7e4c994&scoped=true&

// CONCATENATED MODULE: ./src/mixins/rectUnit.js









/* harmony default export */ var rectUnit = ({
  name: 'rectUnit',
  methods: {
    //getRange
    getRange: function getRange(expr) {
      var merge = expr.includes(':');
      var s, e;

      if (merge) {
        var _expr$split = expr.split(':');

        var _expr$split2 = _slicedToArray(_expr$split, 2);

        s = _expr$split2[0];
        e = _expr$split2[1];
      } else {
        s = expr;
        e = expr;
      }

      var _expr2xy = alphabet_expr2xy(s),
          _expr2xy2 = _slicedToArray(_expr2xy, 2),
          sci = _expr2xy2[0],
          sri = _expr2xy2[1];

      var _expr2xy3 = alphabet_expr2xy(e),
          _expr2xy4 = _slicedToArray(_expr2xy3, 2),
          eci = _expr2xy4[0],
          eri = _expr2xy4[1];

      return {
        merge: merge,
        range: {
          sri: sri,
          sci: sci,
          eri: eri,
          eci: eci
        }
      };
    },
    getFormConfig: function getFormConfig(formConfig, rectConfig) {
      var o = {};
      rectConfig = rectConfig || this.rectConfig;

      for (var key in rectConfig) {
        var c = {};

        if (Object.hasOwnProperty.call(rectConfig, key)) {
          for (var ref in formConfig) {
            if (Object.hasOwnProperty.call(formConfig, ref)) {
              var selectRange = this.getCellRange(ref);
              var rectRange = this.getCellRange(key);

              if (rectRange.contains(selectRange)) {
                c[ref] = formConfig[ref];
                o[key] = c;
              }
            }
          }
        }

        if (!Object.hasOwnProperty.call(o, key)) {
          o[key] = {};
        }
      }

      return o;
    },
    getRowType: function getRowType(rectConfig) {
      var result = {};
      rectConfig = rectConfig || this.rectConfig;

      for (var key in rectConfig) {
        if (Object.hasOwnProperty.call(rectConfig, key)) {
          var _rectConfig$key;

          var ROWS = (_rectConfig$key = rectConfig[key]) === null || _rectConfig$key === void 0 ? void 0 : _rectConfig$key.ROWS;

          if (ROWS) {
            result[key] = ROWS;
          }
        }
      }

      return result;
    },
    getRefRowType: function getRefRowType(ref) {
      var rectConfig = this.rectConfig;

      var _this$getRange = this.getRange(ref),
          range = _this$getRange.range;

      var renderType = null;

      if (Object.keys(this.rectConfig).length !== 0) {
        for (var key in rectConfig) {
          if (Object.hasOwnProperty.call(rectConfig, key)) {
            var selectRange = this.getCellRange(ref);
            var rectRange = this.getCellRange(key);

            if (rectRange.contains(selectRange)) {
              var _rectConfig$key2, _rectConfig$key2$ROWS;

              renderType = (_rectConfig$key2 = rectConfig[key]) === null || _rectConfig$key2 === void 0 ? void 0 : (_rectConfig$key2$ROWS = _rectConfig$key2.ROWS) === null || _rectConfig$key2$ROWS === void 0 ? void 0 : _rectConfig$key2$ROWS["".concat(range.sri)];
            }
          }
        }
      } else {
        var _rows$;

        var rows = this._sheet.data.rows._;
        renderType = rows === null || rows === void 0 ? void 0 : (_rows$ = rows["".concat(range.sri)]) === null || _rows$ === void 0 ? void 0 : _rows$.renderType;
      }

      return renderType;
    },
    getRefColType: function getRefColType(ref) {
      // let rectConfig = this.rectConfig;
      var _this$getRange2 = this.getRange(ref),
          range = _this$getRange2.range;

      var renderType = null;

      if (Object.keys(this.rectConfig).length !== 0) {// console.log(rectConfig);
      } else {
        var _cols$;

        var cols = this._sheet.data.cols._;
        renderType = cols === null || cols === void 0 ? void 0 : (_cols$ = cols["".concat(range.sci)]) === null || _cols$ === void 0 ? void 0 : _cols$.renderType;
      }

      return renderType;
    },
    getCellRange: function getCellRange(ref) {
      var _this$getRange3 = this.getRange(ref),
          range = _this$getRange3.range;

      var sri = range.sri,
          sci = range.sci,
          eri = range.eri,
          eci = range.eci;
      return new cell_range_CellRange(sri, sci, eri, eci);
    },
    infixExprToSuffixExpr: function infixExprToSuffixExpr(src, sheetName, sheetList) {
      return cell_infixExprToSuffixExpr(src, sheetName, sheetList);
    }
  }
});
// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js??ref--13-0!./node_modules/thread-loader/dist/cjs.js!./node_modules/babel-loader/lib!./node_modules/cache-loader/dist/cjs.js??ref--1-0!./node_modules/vue-loader/lib??vue-loader-options!./src/rectTable/index.vue?vue&type=script&lang=js&



var rectTablevue_type_script_lang_js_excluded = ["cell"],
    rectTablevue_type_script_lang_js_excluded2 = ["cell"];





//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
var OffsetLeft = 20;
var OffsetTop = 20;



/* harmony default export */ var rectTablevue_type_script_lang_js_ = ({
  mixins: [rectUnit],
  name: 'rectConfig',
  data: function data() {
    return {
      tableOffset: {},
      rectStyle: {},
      dpr: window.devicePixelRatio || 1,
      rectRowType: {},
      rectColType: {}
    };
  },
  computed: {
    //form容器计算
    contentStyle: function contentStyle() {
      var top = this.tableOffset.top;
      var v = {};
      var _this$_sheet$data$set = this._sheet.data.settings,
          minContent = _this$_sheet$data$set.minContent,
          showToolbar = _this$_sheet$data$set.showToolbar;

      if (minContent) {
        v = {
          left: '50%',
          transform: 'translate(-50%, 0)'
        };
      }

      return _objectSpread2(_objectSpread2({}, this.getStyle(_objectSpread2(_objectSpread2({}, this.tableOffset), {}, {
        top: showToolbar ? top + 81 : top
      }), {
        left: -OffsetLeft,
        top: -OffsetTop
      })), v);
    },
    //form容器计算
    contentRectStyle: function contentRectStyle() {
      var top = this.tableOffset.top;
      var v = {};
      var _this$_sheet$data$set2 = this._sheet.data.settings,
          minContent = _this$_sheet$data$set2.minContent,
          showToolbar = _this$_sheet$data$set2.showToolbar;

      if (minContent) {
        v = {
          left: '50%',
          transform: 'translate(-50%, 0)'
        };
      }

      return _objectSpread2(_objectSpread2({}, this.getStyle(_objectSpread2(_objectSpread2({}, this.tableOffset), {}, {
        top: showToolbar ? top + 81 : top
      }))), v);
    },
    showrectConfig: function showrectConfig() {
      if (this.isEdit) {
        return this.rectConfig;
      } else {
        return {};
      }
    },
    isRect: function isRect() {
      return Object.keys(this.rectConfig).length !== 0;
    }
  },
  watch: {
    rectConfig: {
      deep: true,
      handler: function handler() {
        this.renderItem(true);
      }
    },
    isRect: {
      deep: true,
      handler: function handler() {
        this.renderItem(true);
      }
    }
  },
  props: {
    rectConfig: Object,
    getSpreadsheet: [Function],
    activeSheetName: String,
    isEdit: {
      type: Boolean,
      default: true
    },
    showRectType: {
      type: Boolean,
      default: true
    }
  },
  created: function created() {
    this._ = this.getSpreadsheet();
    this._sheet = this.getSpreadsheet().sheet;
    this.resizeContent();
    this.renderItem(true);
  },
  mounted: function mounted() {
    this.onChangeScrollResize();
    this._rectStyle = {};
  },
  methods: {
    resizeContent: function resizeContent() {
      this.tableOffset = this._sheet.getTableOffset();
    },
    //滚动条响应
    onChangeScrollResize: function onChangeScrollResize() {
      this._verticalScrollbar = this._sheet.verticalScrollbar.el.el;
      this._horizontalScrollbar = this._sheet.horizontalScrollbar.el.el;
      addListener(this._verticalScrollbar.firstChild, this.renderItem);
      addListener(this._horizontalScrollbar.firstChild, this.renderItem);

      this._verticalScrollbar.addEventListener('scroll', lodash_es_debounce(this.renderItem, 10), true);

      this._horizontalScrollbar.addEventListener('scroll', lodash_es_debounce(this.renderItem, 10), true);

      window.addEventListener('resize', this.resizeContent);
    },
    renderItem: function renderItem() {
      if (this.isRect && this.isEdit) {
        var o = {};

        for (var key in this.rectConfig) {
          if (Object.hasOwnProperty.call(this.rectConfig, key)) {
            var _this$_rectStyle, _this$rectConfig$key;

            this.$set(this.rectStyle, key, _objectSpread2(_objectSpread2({}, this.getItemStyle(key)), (_this$_rectStyle = this._rectStyle) === null || _this$_rectStyle === void 0 ? void 0 : _this$_rectStyle[key]));
            var ROWS = (_this$rectConfig$key = this.rectConfig[key]) === null || _this$rectConfig$key === void 0 ? void 0 : _this$rectConfig$key.ROWS;

            for (var row in ROWS) {
              if (Object.hasOwnProperty.call(ROWS, row)) {
                var _this$getRange = this.getRange(key),
                    range = _this$getRange.range;

                var sci = range.sci;

                var ref = this._sheet.data.xy2expr(sci, parseInt(row));

                o[ref] = {
                  style: this.getRowStyle(ref),
                  type: ROWS[row]
                };
              }
            }
          }
        }

        this.rectRowType = o;
      }

      if (this.showRectType) {
        this.renderSheetRowType();
      }
    },
    //form Item偏移量计算
    getRowStyle: function getRowStyle(key) {
      var _this$getRange2 = this.getRange(key),
          range = _this$getRange2.range;

      var style = this._sheet.data.getRect(range);

      var top = style.top,
          left = style.left,
          height = style.height;
      top = top < 0 ? top - OffsetTop : top;

      if (!this.isRect) {
        left = 0;
      }

      return this.getStyle({
        top: top,
        left: left,
        height: height,
        width: OffsetLeft
      }, {
        height: this.dpr > 1 ? -1 : 0,
        top: OffsetTop
      });
    },
    //form Item偏移量计算
    getColStyle: function getColStyle(key) {
      var _this$getRange3 = this.getRange(key),
          range = _this$getRange3.range;

      var style = this._sheet.data.getRect(range);

      var top = style.top,
          left = style.left,
          height = style.height;

      if (!this.isRect) {
        top = 0;
      }

      return this.getStyle({
        top: top,
        left: left,
        height: height,
        width: OffsetLeft
      }, {
        height: this.dpr > 1 ? -1 : 0,
        left: OffsetLeft + 10
      });
    },
    // number -> `number`px
    getStyle: function getStyle(Offset, dpr) {
      var contentStyle = {};
      var h = 34;

      for (var key in Offset) {
        if (Object.hasOwnProperty.call(Offset, key)) {
          var element = Offset[key];
          var dprOffset = (dpr === null || dpr === void 0 ? void 0 : dpr[key]) || 0;
          h = (34 + "".concat(Offset.l).concat(Offset.t)) / 360;
          contentStyle[key] = "".concat(element + dprOffset, "px");
        }
      }

      var goldenRatio = 0.618033988749895;
      var color = "hsl(".concat(Math.floor(h * 360), ", 90%, 50%)");
      h += goldenRatio;
      h %= 1;
      return _objectSpread2(_objectSpread2({}, contentStyle), {}, {
        'border-color': color
      });
    },
    //form Item偏移量计算
    getItemStyle: function getItemStyle(key) {
      var _this$getRange4 = this.getRange(key),
          range = _this$getRange4.range;

      var sri = range.sri,
          sci = range.sci;

      var dataCell = this._sheet.data.cellRect(sri, sci);

      var cell = dataCell.cell,
          style = _objectWithoutProperties(dataCell, rectTablevue_type_script_lang_js_excluded);

      cell;
      style = this._sheet.data.getRect(range);
      return this.getStyle(style, {
        height: this.dpr > 1 ? -1 : 0
      });
    },
    //rect style
    setItemStyle: function setItemStyle(key) {
      var _this$getRange5 = this.getRange(key),
          range = _this$getRange5.range;

      var sri = range.sri,
          sci = range.sci;

      var dataCell = this._sheet.data.cellRect(sri, sci);

      var cell = dataCell.cell,
          style = _objectWithoutProperties(dataCell, rectTablevue_type_script_lang_js_excluded2);

      cell;
      style = this._sheet.data.getRect(range);
      this.$set(this.rectStyle, key, this.getStyle(style, {
        height: this.dpr > 1 ? -1 : 0
      }));
    },
    addRect: function addRect(color, range) {
      var selectRange = range || this._sheet.data.selector.range;
      var config = this.setSyncConfig();
      var arr = [];

      for (var key in this.rectConfig) {
        if (Object.hasOwnProperty.call(this.rectConfig, key)) {
          var rectRange = this.getCellRange(key);

          if (!rectRange.disjoint(selectRange)) {
            arr.push(key);
          }
        }
      }

      if (!arr.length) {
        var rectConfig = JSON.parse(JSON.stringify(this.rectConfig));

        var _key = selectRange.toString();

        rectConfig[_key] = config;

        if (color) {
          this._rectStyle[_key] = {
            'border-color': color
          };
        }

        this.rectColType = {};
        this.$emit('update:rectConfig', rectConfig);
      }

      return {
        result: !arr.length,
        message: arr
      };
    },
    setRectStyle: function setRectStyle() {
      var cb = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : function () {};
      cb(this._rectStyle);
    },
    getSheetRowType: function getSheetRowType() {
      var v = {};

      this._sheet.data.rows.each(function (ri, row) {
        var renderType = row === null || row === void 0 ? void 0 : row.renderType;
        if (row !== null && row !== void 0 && row.hide) return;

        if (renderType) {
          v[ri] = renderType;
        }
      });

      return v;
    },
    getSheetColType: function getSheetColType() {
      var v = {};

      this._sheet.data.cols.each(function (ci, col) {
        var renderType = col === null || col === void 0 ? void 0 : col.renderType;
        if (col !== null && col !== void 0 && col.hide) return;

        if (renderType) {
          v[ci] = renderType;
        }
      });

      return v;
    },
    setSyncConfig: function setSyncConfig() {
      var ROWS = {};

      if (Object.keys(this.rectConfig).length == 0) {
        var rows = this.getSheetRowType();
        var selectRange = this._sheet.data.selector.range;
        selectRange.each(function (ri) {
          var type = rows === null || rows === void 0 ? void 0 : rows[ri];

          if (type) {
            ROWS[ri] = type;
          }
        });

        this._sheet.data.rows.each(function (ri, row) {
          if (row !== null && row !== void 0 && row.renderType) {
            row === null || row === void 0 ? true : delete row.renderType;
          }
        });

        this._sheet.data.cols.each(function (ci, col) {
          if (col !== null && col !== void 0 && col.renderType) {
            col === null || col === void 0 ? true : delete col.renderType;
          }
        });
      }

      return {
        ROWS: ROWS
      };
    },
    renderSheetRowType: function renderSheetRowType() {
      var _this = this;

      if (Object.keys(this.rectConfig).length == 0) {
        var o = {};

        var viewRange = this._sheet.data.viewRange();

        viewRange.eachRow(function (ri) {
          var _this$_sheet$data$row;

          var type = (_this$_sheet$data$row = _this._sheet.data.rows.get(ri)) === null || _this$_sheet$data$row === void 0 ? void 0 : _this$_sheet$data$row.renderType;

          var ref = _this._sheet.data.xy2expr(0, ri);

          var style = _this.getRowStyle(ref);

          o[ref] = {
            style: {
              top: style.top,
              height: style.height
            },
            type: type
          };
        });
        this.rectRowType = o;
        var c = {};
        var ColType = this.getSheetColType();

        for (var col in ColType) {
          var ref = this._sheet.data.xy2expr(parseInt(col), 0);

          c[ref] = {
            style: this.getColStyle(ref),
            type: ColType[col]
          };
        }

        this.rectColType = c;
      }
    },
    deleteRect: function deleteRect(ref) {
      var _this2 = this;

      var rectConfig = JSON.parse(JSON.stringify(this.rectConfig));

      if (!ref) {
        var selectRange = this._sheet.data.selector.range;
        ref = selectRange.toString();
      }

      if (Object.keys(rectConfig).length == 1) {
        var rectRange = this.getCellRange(ref);
        rectRange.each(function (ri) {
          if (rectConfig[ref].ROWS[ri]) {
            _this2._sheet.data.rows.setProperty(ri, 'renderType', rectConfig[ref].ROWS[ri]);
          }
        });
      }

      delete rectConfig[ref];
      this.$emit('update:rectConfig', rectConfig);
    },
    addRectRowType: function addRectRowType() {
      var _this3 = this;

      var type = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'header';

      if (Object.keys(this.rectConfig).length != 0) {
        var _ret = function () {
          var result = false;
          var rectConfig = JSON.parse(JSON.stringify(_this3.rectConfig));

          var _loop = function _loop(key) {
            if (Object.hasOwnProperty.call(rectConfig, key)) {
              var selectRange = _this3._sheet.data.selector.range;

              var rectRange = _this3.getCellRange(key);

              if (rectRange.contains(selectRange)) {
                var _rectConfig$key;

                rectConfig[key] = {
                  ROWS: ((_rectConfig$key = rectConfig[key]) === null || _rectConfig$key === void 0 ? void 0 : _rectConfig$key.ROWS) || {}
                };
                selectRange.each(function (ri) {
                  rectConfig[key].ROWS[ri] = type;
                });
                result = true;
              }
            }
          };

          for (var key in rectConfig) {
            _loop(key);
          }

          _this3.$emit('update:rectConfig', rectConfig);

          return {
            v: {
              result: result
            }
          };
        }();

        if (_typeof(_ret) === "object") return _ret.v;
      } else {
        var selectRange = this._sheet.data.selector.range;
        selectRange.each(function (ri) {
          _this3._sheet.data.rows.setProperty(ri, 'renderType', type);
        });
      }
    },
    addRectColType: function addRectColType() {
      var _this4 = this;

      var type = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'header';

      if (Object.keys(this.rectConfig).length != 0) {
        var result = false;
        return {
          result: result
        };
      } else {
        var selectRange = this._sheet.data.selector.range;
        selectRange.each(function (ri, ci) {
          _this4._sheet.data.cols.setProperty(ci, 'renderType', type);
        });
      }
    },
    deleteRowType: function deleteRowType() {
      var _this5 = this;

      if (Object.keys(this.rectConfig).length != 0) {
        (function () {
          var rectConfig = JSON.parse(JSON.stringify(_this5.rectConfig));

          var _loop2 = function _loop2(key) {
            if (Object.hasOwnProperty.call(rectConfig, key)) {
              var _selectRange = _this5._sheet.data.selector.range;

              var rectRange = _this5.getCellRange(key);

              if (rectRange.contains(_selectRange)) {
                _selectRange.each(function (ri) {
                  delete rectConfig[key].ROWS[ri];
                });
              }
            }
          };

          for (var key in rectConfig) {
            _loop2(key);
          }

          _this5.$emit('update:rectConfig', rectConfig);
        })();
      }

      var selectRange = this._sheet.data.selector.range;
      var rows = this._sheet.data.rows._;
      selectRange.each(function (ri) {
        var _rows$ri;

        rows === null || rows === void 0 ? true : (_rows$ri = rows[ri]) === null || _rows$ri === void 0 ? true : delete _rows$ri.renderType;
      });
    },
    deleteColType: function deleteColType() {
      var selectRange = this._sheet.data.selector.range;
      var cols = this._sheet.data.cols._;
      selectRange.each(function (ri, ci) {
        var _cols$ci;

        cols === null || cols === void 0 ? true : (_cols$ci = cols[ci]) === null || _cols$ci === void 0 ? true : delete _cols$ci.renderType;
      });
    }
  },
  beforeDestroy: function beforeDestroy() {
    esm_removeListener(this._verticalScrollbar.firstChild, this.renderItem);
    esm_removeListener(this._horizontalScrollbar.firstChild, this.renderItem);
    window.removeEventListener('resize', this.resizeContent);
  }
});
// CONCATENATED MODULE: ./src/rectTable/index.vue?vue&type=script&lang=js&
 /* harmony default export */ var src_rectTablevue_type_script_lang_js_ = (rectTablevue_type_script_lang_js_); 
// EXTERNAL MODULE: ./src/rectTable/index.vue?vue&type=style&index=0&id=d7e4c994&lang=scss&scoped=true&
var rectTablevue_type_style_index_0_id_d7e4c994_lang_scss_scoped_true_ = __webpack_require__("3be5");

// CONCATENATED MODULE: ./src/rectTable/index.vue






/* normalize component */

var rectTable_component = normalizeComponent(
  src_rectTablevue_type_script_lang_js_,
  rectTablevue_type_template_id_d7e4c994_scoped_true_render,
  rectTablevue_type_template_id_d7e4c994_scoped_true_staticRenderFns,
  false,
  null,
  "d7e4c994",
  null
  
)

/* harmony default export */ var rectTable = (rectTable_component.exports);
// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"7cdf87ba-vue-loader-template"}!./node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ref--1-0!./node_modules/vue-loader/lib??vue-loader-options!./src/backImg/index.vue?vue&type=template&id=03bc0e3c&scoped=true&
var backImgvue_type_template_id_03bc0e3c_scoped_true_render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return (_vm.isShow)?_c('div',{staticClass:"table-content",style:(_vm.contentStyle)},[_c('div',{staticClass:"table-item",style:(_vm.rectStyle)},[_c('img',{attrs:{"src":_vm.backgroundConfig.url}})])]):_vm._e()}
var backImgvue_type_template_id_03bc0e3c_scoped_true_staticRenderFns = []


// CONCATENATED MODULE: ./src/backImg/index.vue?vue&type=template&id=03bc0e3c&scoped=true&

// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js??ref--13-0!./node_modules/thread-loader/dist/cjs.js!./node_modules/babel-loader/lib!./node_modules/cache-loader/dist/cjs.js??ref--1-0!./node_modules/vue-loader/lib??vue-loader-options!./src/backImg/index.vue?vue&type=script&lang=js&


var backImgvue_type_script_lang_js_excluded = ["cell"];
//
//
//
//
//
//
//



/* harmony default export */ var backImgvue_type_script_lang_js_ = ({
  mixins: [rectUnit],
  name: 'backImg',
  data: function data() {
    return {
      tableOffset: {},
      rectStyle: {},
      dpr: window.devicePixelRatio || 1,
      backgroundConfig: {},
      isShow: false
    };
  },
  computed: {
    //form容器计算
    contentStyle: function contentStyle() {
      var top = this.tableOffset.top;
      var v = {};
      var _this$_sheet$data$set = this._sheet.data.settings,
          minContent = _this$_sheet$data$set.minContent,
          showToolbar = _this$_sheet$data$set.showToolbar;

      if (minContent) {
        v = {
          left: '50%',
          transform: 'translate(-50%, 0)'
        };
      }

      return _objectSpread2(_objectSpread2({}, this.getStyle(_objectSpread2(_objectSpread2({}, this.tableOffset), {}, {
        top: showToolbar ? top + 81 : top
      }))), v);
    }
  },
  props: {
    getSpreadsheet: [Function],
    activeSheetName: String,
    isEdit: {
      type: Boolean,
      default: true
    },
    width: {
      type: String,
      default: 'auto'
    },
    height: {
      type: String,
      default: 'auto'
    }
  },
  created: function created() {
    var _this$backgroundConfi;

    this._ = this.getSpreadsheet();
    this._sheet = this.getSpreadsheet().sheet;
    this.backgroundConfig = this._sheet.data.background;
    this.isShow = (_this$backgroundConfi = this.backgroundConfig) === null || _this$backgroundConfi === void 0 ? void 0 : _this$backgroundConfi.url;
    if (!this.isShow) return;
    this.resizeContent();
    this.renderItem(true);
  },
  mounted: function mounted() {
    if (!this.isShow) return;
    this.onChangeScrollResize();

    this._.targetEl.parentElement.insertBefore(this.$el, this._.targetEl);
  },
  methods: {
    resizeContent: function resizeContent() {
      this.tableOffset = this._sheet.getTableOffset();
    },
    //滚动条响应
    onChangeScrollResize: function onChangeScrollResize() {
      this._verticalScrollbar = this._sheet.verticalScrollbar.el.el;
      this._horizontalScrollbar = this._sheet.horizontalScrollbar.el.el;
      addListener(this._verticalScrollbar.firstChild, this.renderItem);
      addListener(this._horizontalScrollbar.firstChild, this.renderItem);

      this._verticalScrollbar.addEventListener('scroll', lodash_es_debounce(this.renderItem, 10), true);

      this._horizontalScrollbar.addEventListener('scroll', lodash_es_debounce(this.renderItem, 10), true);

      window.addEventListener('resize', this.resizeContent);
    },
    renderItem: function renderItem() {
      var _this$getItemStyle = this.getItemStyle('A1'),
          left = _this$getItemStyle.left,
          top = _this$getItemStyle.top;

      this.rectStyle = {
        left: left,
        top: top,
        width: this.backgroundConfig.width,
        height: this.backgroundConfig.height
      };
    },
    // number -> `number`px
    getStyle: function getStyle(Offset, dpr) {
      var contentStyle = {};

      for (var key in Offset) {
        if (Object.hasOwnProperty.call(Offset, key)) {
          var element = Offset[key];
          var dprOffset = (dpr === null || dpr === void 0 ? void 0 : dpr[key]) || 0;
          contentStyle[key] = "".concat(element + dprOffset, "px");
        }
      }

      return _objectSpread2({}, contentStyle);
    },
    //form Item偏移量计算
    getItemStyle: function getItemStyle(key) {
      var _this$getRange = this.getRange(key),
          range = _this$getRange.range;

      var sri = range.sri,
          sci = range.sci;

      var dataCell = this._sheet.data.cellRect(sri, sci);

      var cell = dataCell.cell,
          style = _objectWithoutProperties(dataCell, backImgvue_type_script_lang_js_excluded);

      cell;
      style = this._sheet.data.getRect(range);
      return this.getStyle(style, {
        height: this.dpr > 1 ? -1 : 0
      });
    }
  },
  beforeDestroy: function beforeDestroy() {
    if (!this.isShow) return;
    esm_removeListener(this._verticalScrollbar.firstChild, this.renderItem);
    esm_removeListener(this._horizontalScrollbar.firstChild, this.renderItem);
    window.removeEventListener('resize', this.resizeContent);
  }
});
// CONCATENATED MODULE: ./src/backImg/index.vue?vue&type=script&lang=js&
 /* harmony default export */ var src_backImgvue_type_script_lang_js_ = (backImgvue_type_script_lang_js_); 
// EXTERNAL MODULE: ./src/backImg/index.vue?vue&type=style&index=0&id=03bc0e3c&lang=scss&scoped=true&
var backImgvue_type_style_index_0_id_03bc0e3c_lang_scss_scoped_true_ = __webpack_require__("4cd2");

// CONCATENATED MODULE: ./src/backImg/index.vue






/* normalize component */

var backImg_component = normalizeComponent(
  src_backImgvue_type_script_lang_js_,
  backImgvue_type_template_id_03bc0e3c_scoped_true_render,
  backImgvue_type_template_id_03bc0e3c_scoped_true_staticRenderFns,
  false,
  null,
  "03bc0e3c",
  null
  
)

/* harmony default export */ var backImg = (backImg_component.exports);
// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"7cdf87ba-vue-loader-template"}!./node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ref--1-0!./node_modules/vue-loader/lib??vue-loader-options!./src/dialog/slash/index.vue?vue&type=template&id=3fd5e29c&scoped=true&
var slashvue_type_template_id_3fd5e29c_scoped_true_render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return (_vm.dialogVisible)?_c('div',{staticClass:"line-content",style:(_vm.contentStyle)},[_c('el-tooltip',{ref:"tooltip",attrs:{"placement":"bottom","value":true,"manual":true}},[_c('div',{attrs:{"slot":"content"},slot:"content"},[_c('el-button',{attrs:{"size":"mini","type":"primary"},on:{"click":_vm.save}},[_vm._v(" 保存 ")]),_c('el-button',{attrs:{"size":"mini"},on:{"click":_vm.close}},[_vm._v(" 取消 ")])],1),_c('div',{ref:"slash",staticClass:"line-item",style:(Object.assign({}, _vm.cellRect, this.itemStyle['rect']))},[_vm._l((_vm.lineNumber + 1),function(key){return _c('vue-draggable-resizable',{key:key,attrs:{"resizable":false,"min-width":50,"x":_vm.pos[key].x,"y":_vm.pos[key].y,"w":"auto","h":"auto"}},[(_vm.lineNumber)?_c('edit',{style:(_vm.itemStyle['font']),attrs:{"value":key}}):_vm._e()],1)}),_c('canvas',{ref:"line",style:(_vm.cellRect)})],2)])],1):_vm._e()}
var slashvue_type_template_id_3fd5e29c_scoped_true_staticRenderFns = []


// CONCATENATED MODULE: ./src/dialog/slash/index.vue?vue&type=template&id=3fd5e29c&scoped=true&

// EXTERNAL MODULE: ./node_modules/vue-draggable-resizable/dist/VueDraggableResizable.umd.min.js
var VueDraggableResizable_umd_min = __webpack_require__("fb19");
var VueDraggableResizable_umd_min_default = /*#__PURE__*/__webpack_require__.n(VueDraggableResizable_umd_min);

// EXTERNAL MODULE: ./node_modules/vue-draggable-resizable/dist/VueDraggableResizable.css
var VueDraggableResizable = __webpack_require__("278f");

// EXTERNAL MODULE: ./node_modules/html2canvas/dist/html2canvas.js
var html2canvas = __webpack_require__("c0e9");
var html2canvas_default = /*#__PURE__*/__webpack_require__.n(html2canvas);

// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"7cdf87ba-vue-loader-template"}!./node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ref--1-0!./node_modules/vue-loader/lib??vue-loader-options!./src/dialog/slash/edit.vue?vue&type=template&id=098c721a&
var editvue_type_template_id_098c721a_render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:"edit-div",attrs:{"contenteditable":_vm.canEdit},domProps:{"innerHTML":_vm._s(_vm.innerText)},on:{"focus":function($event){_vm.isLocked = true},"blur":function($event){_vm.isLocked = false},"input":_vm.changeText}})}
var editvue_type_template_id_098c721a_staticRenderFns = []


// CONCATENATED MODULE: ./src/dialog/slash/edit.vue?vue&type=template&id=098c721a&

// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js??ref--13-0!./node_modules/thread-loader/dist/cjs.js!./node_modules/babel-loader/lib!./node_modules/cache-loader/dist/cjs.js??ref--1-0!./node_modules/vue-loader/lib??vue-loader-options!./src/dialog/slash/edit.vue?vue&type=script&lang=js&

//
//
//
/* harmony default export */ var editvue_type_script_lang_js_ = ({
  name: 'editDiv',
  props: {
    value: {
      type: [String, Number],
      default: ''
    },
    canEdit: {
      type: Boolean,
      default: true
    }
  },
  data: function data() {
    return {
      innerText: this.value,
      isLocked: false
    };
  },
  watch: {
    value: function value() {
      if (!this.isLocked || !this.innerText) {
        this.innerText = this.value;
      }
    }
  },
  methods: {
    changeText: function changeText() {
      this.$emit('input', this.$el.innerHTML);
    }
  }
});
// CONCATENATED MODULE: ./src/dialog/slash/edit.vue?vue&type=script&lang=js&
 /* harmony default export */ var slash_editvue_type_script_lang_js_ = (editvue_type_script_lang_js_); 
// EXTERNAL MODULE: ./src/dialog/slash/edit.vue?vue&type=style&index=0&lang=scss&
var editvue_type_style_index_0_lang_scss_ = __webpack_require__("f47f");

// CONCATENATED MODULE: ./src/dialog/slash/edit.vue






/* normalize component */

var edit_component = normalizeComponent(
  slash_editvue_type_script_lang_js_,
  editvue_type_template_id_098c721a_render,
  editvue_type_template_id_098c721a_staticRenderFns,
  false,
  null,
  null,
  null
  
)

/* harmony default export */ var slash_edit = (edit_component.exports);
// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js??ref--13-0!./node_modules/thread-loader/dist/cjs.js!./node_modules/babel-loader/lib!./node_modules/cache-loader/dist/cjs.js??ref--1-0!./node_modules/vue-loader/lib??vue-loader-options!./src/dialog/slash/index.vue?vue&type=script&lang=js&








//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//






/* harmony default export */ var slashvue_type_script_lang_js_ = ({
  components: {
    VueDraggableResizable: VueDraggableResizable_umd_min_default.a,
    edit: slash_edit
  },
  data: function data() {
    return {
      tableOffset: {},
      itemStyle: {},
      cellRect: {},
      lineNumber: 1,
      dialogVisible: true,
      pos: {
        '1': {
          x: 0,
          y: 0
        },
        '2': {
          x: 0,
          y: 0
        },
        '3': {
          x: 0,
          y: 0
        },
        '4': {
          x: 0,
          y: 0
        }
      }
    };
  },
  computed: {
    contentStyle: function contentStyle() {
      var top = this.tableOffset.top;
      return _objectSpread2({}, this.get2Px(_objectSpread2(_objectSpread2({}, this.tableOffset), {}, {
        top: this._sheet.data.settings.showToolbar ? top + 81 : top
      })));
    }
  },
  props: {
    formConfig: Object,
    getSpreadsheet: [Function],
    activeSheetName: String,
    isEdit: {
      type: Boolean,
      default: true
    },
    slashConfig: Object
  },
  created: function created() {
    this._ = this.getSpreadsheet();
    this._sheet = this.getSpreadsheet().sheet;
    this.tableOffset = this._sheet.getTableOffset();
  },
  mounted: function mounted() {
    var _this = this;

    this.lineNumber = parseInt(this.slashConfig.mode);

    this._resf = function (type, flag) {
      if (type === 'slash') {
        var mode = flag.mode;

        _this.line(0.5, _this.itemStyle['font']['color'], parseInt(mode));
      }

      _this.renderItem();
    };

    this._.on('tool-selected', this._resf);

    this.renderItem();
    this._debounceRenderItem = lodash_es_debounce(this.renderItem, 10);
    this.onChangeScrollResize();
  },
  beforeDestroy: function beforeDestroy() {
    esm_removeListener(this._verticalScrollbar.firstChild, this.renderItem);
    esm_removeListener(this._horizontalScrollbar.firstChild, this.renderItem);

    this._verticalScrollbar.removeEventListener('scroll', this._debounceRenderItem, true);

    this._horizontalScrollbar.removeEventListener('scroll', this._debounceRenderItem, true);

    this._sheet.off('tool-selected', this._resf);
  },
  methods: {
    onChangeScrollResize: function onChangeScrollResize() {
      this._verticalScrollbar = this._sheet.verticalScrollbar.el.el;
      this._horizontalScrollbar = this._sheet.horizontalScrollbar.el.el;
      addListener(this._verticalScrollbar.firstChild, this.renderItem);
      addListener(this._horizontalScrollbar.firstChild, this.renderItem);

      this._verticalScrollbar.addEventListener('scroll', this._debounceRenderItem, true);

      this._horizontalScrollbar.addEventListener('scroll', this._debounceRenderItem, true);
    },
    line: function line(lineWidth, lineColor, lineNumber) {
      var _this2 = this;

      this.$nextTick(function () {
        var xpos = parseInt(_this2.cellRect.width, 10);
        var ypos = parseInt(_this2.cellRect.height, 10);
        var canvas = _this2.$refs.line;
        canvas.width = xpos;
        canvas.height = ypos;
        var fontW = parseInt(_this2.itemStyle['font']['font-size'], 10) + 3;

        if (canvas.getContext) {
          var ctx = canvas.getContext('2d');
          ctx.clearRect(0, 0, xpos, ypos); //清空画布，多个表格时使用

          ctx.fill();
          ctx.lineWidth = lineWidth;
          ctx.strokeStyle = lineColor;
          ctx.beginPath();

          switch (lineNumber) {
            case 1:
              ctx.moveTo(0, 0);
              ctx.lineTo(xpos, ypos);
              _this2.pos = {
                '1': {
                  x: xpos - fontW,
                  y: 0
                },
                '2': {
                  x: fontW,
                  y: ypos - fontW
                }
              };
              break;

            case 2:
              ctx.moveTo(0, 0);
              ctx.lineTo(xpos / 2, ypos);
              ctx.moveTo(0, 0);
              ctx.lineTo(xpos, ypos / 2);
              _this2.pos = {
                '1': {
                  x: xpos - fontW,
                  y: 0
                },
                '2': {
                  x: xpos / 2 + fontW,
                  y: ypos - fontW
                },
                '3': {
                  x: fontW,
                  y: ypos - fontW
                }
              };
              break;

            case 3:
              ctx.moveTo(0, 0);
              ctx.lineTo(xpos, ypos);
              ctx.moveTo(0, 0);
              ctx.lineTo(xpos / 2, ypos);
              ctx.moveTo(0, 0);
              ctx.lineTo(xpos, ypos / 2);
              _this2.pos = {
                '1': {
                  x: xpos - fontW,
                  y: 0
                },
                '2': {
                  x: xpos / 2 + fontW,
                  y: ypos - fontW
                },
                '3': {
                  x: fontW,
                  y: ypos - fontW
                },
                '4': {
                  x: xpos - fontW,
                  y: ypos / 2 + fontW
                }
              };
              break;

            default:
              return 0;
          }

          _this2.lineNumber = lineNumber;
          ctx.stroke();
          ctx.closePath();
        }
      });
    },
    get2Px: function get2Px(Offset) {
      var contentStyle = {};

      for (var key in Offset) {
        if (Object.hasOwnProperty.call(Offset, key)) {
          var element = Offset[key];
          contentStyle[key] = "".concat(element, "px");
        }
      }

      return contentStyle;
    },
    renderItem: function renderItem() {
      var selector = this._sheet.data.selector;
      var _selector$range = selector.range,
          sri = _selector$range.sri,
          sci = _selector$range.sci;
      this.itemStyle = this.getStyle(sci, sri);
      this.getRect(selector.range);
      this._range = {
        sri: sri,
        sci: sci
      };
      this.$nextTick(this.$refs.tooltip.updatePopper);
    },
    getRect: function getRect(range) {
      var _this3 = this;

      var style = this._sheet.data.getRect(range);

      this.$nextTick(function () {
        _this3.line(0.5, _this3.itemStyle['font']['color'], _this3.lineNumber);
      });
      this.cellRect = _objectSpread2({}, this.get2Px(style));
    },
    getCropping: function getCropping() {
      var _this4 = this;

      return _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee() {
        var canvas;
        return regeneratorRuntime.wrap(function _callee$(_context) {
          while (1) {
            switch (_context.prev = _context.next) {
              case 0:
                _context.next = 2;
                return html2canvas_default()(_this4.$refs.slash, {
                  backgroundColor: 'transparent'
                });

              case 2:
                canvas = _context.sent;
                return _context.abrupt("return", canvas.toDataURL());

              case 4:
              case "end":
                return _context.stop();
            }
          }
        }, _callee);
      }))();
    },
    save: function save() {
      var _this5 = this;

      if (this.lineNumber) {
        this.itemStyle['rect'].backgroundColor = 'transparent';
        setTimeout( /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2() {
          var dataUrl;
          return regeneratorRuntime.wrap(function _callee2$(_context2) {
            while (1) {
              switch (_context2.prev = _context2.next) {
                case 0:
                  _context2.next = 2;
                  return _this5.getCropping();

                case 2:
                  dataUrl = _context2.sent;

                  _this5._sheet.data.setSelectedCellAttr('slash', {
                    mode: _this5.lineNumber
                  });

                  _this5.saveAfter(dataUrl);

                case 5:
                case "end":
                  return _context2.stop();
              }
            }
          }, _callee2);
        })));
      } else {
        var _cellRect$cell;

        var cellRect = this._sheet.data.cellRect(this._range.sri, this._range.sci);

        (_cellRect$cell = cellRect.cell) === null || _cellRect$cell === void 0 ? true : delete _cellRect$cell.slash;
        this.saveAfter();
      }
    },
    saveAfter: function saveAfter() {
      var dataUrl = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';

      this._sheet.data.setCellText(this._range.sri, this._range.sci, dataUrl);

      this._sheet.table.render(); // console.log(this._sheet.data.getData());


      this.close();
    },
    close: function close() {
      this.$emit('cancelDialog');
    },
    getStyle: function getStyle(x, y) {
      var o = {
        font: {},
        rect: {}
      };

      var style = this._sheet.data.getCellStyleOrDefault(y, x);

      for (var key in style) {
        if (Object.hasOwnProperty.call(style, key)) {
          var element = style[key];

          switch (key) {
            case 'bgcolor':
              o['rect']['backgroundColor'] = element;
              break;

            case 'color':
              o['font']['color'] = element;
              break;

            case 'underline':
            case 'strike':
              o['font']['text-decoration'] = '';

              if (style !== null && style !== void 0 && style.underline) {
                o['font']['text-decoration'] = o['font']['text-decoration'] + ' underline';
              }

              if (style !== null && style !== void 0 && style.strike) {
                o['font']['text-decoration'] = o['font']['text-decoration'] + ' line-through';
              }

              break;

            case 'font':
              if (element !== null && element !== void 0 && element.bold) {
                o['font']['font-weight'] = 'bold';
              }

              if (element !== null && element !== void 0 && element.italic) {
                o['font']['font-style'] = 'italic';
              }

              if (element !== null && element !== void 0 && element.name) {
                o['font']['font-family'] = element.name;
              }

              if (element !== null && element !== void 0 && element.size) {
                o['font']['font-size'] = element.size + 'px';
              }

              break;

            default:
              break;
          }
        }
      }

      return o;
    }
  }
});
// CONCATENATED MODULE: ./src/dialog/slash/index.vue?vue&type=script&lang=js&
 /* harmony default export */ var dialog_slashvue_type_script_lang_js_ = (slashvue_type_script_lang_js_); 
// EXTERNAL MODULE: ./src/dialog/slash/index.vue?vue&type=style&index=0&id=3fd5e29c&lang=scss&scoped=true&
var slashvue_type_style_index_0_id_3fd5e29c_lang_scss_scoped_true_ = __webpack_require__("8d33");

// CONCATENATED MODULE: ./src/dialog/slash/index.vue






/* normalize component */

var slash_component = normalizeComponent(
  dialog_slashvue_type_script_lang_js_,
  slashvue_type_template_id_3fd5e29c_scoped_true_render,
  slashvue_type_template_id_3fd5e29c_scoped_true_staticRenderFns,
  false,
  null,
  "3fd5e29c",
  null
  
)

/* harmony default export */ var slash = (slash_component.exports);
// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"7cdf87ba-vue-loader-template"}!./node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ref--1-0!./node_modules/vue-loader/lib??vue-loader-options!./src/foldMap/index.vue?vue&type=template&id=448a11a0&scoped=true&
var foldMapvue_type_template_id_448a11a0_scoped_true_render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:"contentStyle",style:(_vm.contentStyle)},[_c('div',{ref:"tree",staticClass:"tree-map",style:(_vm.rectStyle)},_vm._l((_vm.foldData),function(item,index){return _c('ul',{key:index},[_c('fold-item',{staticClass:"item",attrs:{"getHeight":_vm.getHeight,"item":item},on:{"make-folder":_vm.makeFolder,"add-item":_vm.addItem,"toggle":_vm.toggle}})],1)}),0)])}
var foldMapvue_type_template_id_448a11a0_scoped_true_staticRenderFns = []


// CONCATENATED MODULE: ./src/foldMap/index.vue?vue&type=template&id=448a11a0&scoped=true&

// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"7cdf87ba-vue-loader-template"}!./node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ref--1-0!./node_modules/vue-loader/lib??vue-loader-options!./src/foldMap/fold-item.vue?vue&type=template&id=5f81b7d2&
var fold_itemvue_type_template_id_5f81b7d2_render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('li',[_c('div',{staticClass:"item-span",class:{ bold: _vm.isFolder },style:(_vm.getStyle(_vm.item.ri)),on:{"click":_vm.toggle}},[(_vm.isFolder)?_c('span',{staticClass:"icon spread-sheet",class:_vm.item['isOpen'] ? ' icon-close-tree' : '   icon-open-tree'}):_vm._e()]),(_vm.isFolder)?_c('ul',{directives:[{name:"show",rawName:"v-show",value:(_vm.item['isOpen']),expression:"item['isOpen']"}]},_vm._l((_vm.item.children),function(child,index){return _c('fold-item',{key:index,staticClass:"item",attrs:{"getHeight":_vm.getHeight,"item":child},on:{"toggle":function (a, b) { return _vm.$emit('toggle', a, b); }}})}),1):_vm._e()])}
var fold_itemvue_type_template_id_5f81b7d2_staticRenderFns = []


// CONCATENATED MODULE: ./src/foldMap/fold-item.vue?vue&type=template&id=5f81b7d2&

// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js??ref--13-0!./node_modules/thread-loader/dist/cjs.js!./node_modules/babel-loader/lib!./node_modules/cache-loader/dist/cjs.js??ref--1-0!./node_modules/vue-loader/lib??vue-loader-options!./src/foldMap/fold-item.vue?vue&type=script&lang=js&

//
//
//
//
//
//
//
//
//
//
//
//
/* harmony default export */ var fold_itemvue_type_script_lang_js_ = ({
  name: 'fold-item',
  props: {
    item: Object,
    num: Number,
    getHeight: Function
  },
  data: function data() {
    return {
      isOpen: true
    };
  },
  computed: {
    isFolder: function isFolder() {
      return this.item.children && this.item.children.length;
    }
  },
  created: function created() {
    this.$set(this.item, 'isOpen', true);
  },
  methods: {
    toggle: function toggle() {
      if (this.isFolder) {
        this.item.isOpen = !this.item.isOpen;
      }

      this.$emit('toggle', this.item, this.item.isOpen);
    },
    makeFolder: function makeFolder() {
      if (!this.isFolder) {
        this.$emit('make-folder', this.item);
        this.item.isOpen = true;
      }
    },
    getStyle: function getStyle(ri) {
      var height = this.getHeight(ri);
      height = height == 0 ? 'auto' : height;
      return {
        height: "".concat(height, "px"),
        'line-height': "".concat(height, "px")
      };
    }
  }
});
// CONCATENATED MODULE: ./src/foldMap/fold-item.vue?vue&type=script&lang=js&
 /* harmony default export */ var foldMap_fold_itemvue_type_script_lang_js_ = (fold_itemvue_type_script_lang_js_); 
// CONCATENATED MODULE: ./src/foldMap/fold-item.vue





/* normalize component */

var fold_item_component = normalizeComponent(
  foldMap_fold_itemvue_type_script_lang_js_,
  fold_itemvue_type_template_id_5f81b7d2_render,
  fold_itemvue_type_template_id_5f81b7d2_staticRenderFns,
  false,
  null,
  null,
  null
  
)

/* harmony default export */ var fold_item = (fold_item_component.exports);
// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js??ref--13-0!./node_modules/thread-loader/dist/cjs.js!./node_modules/babel-loader/lib!./node_modules/cache-loader/dist/cjs.js??ref--1-0!./node_modules/vue-loader/lib??vue-loader-options!./src/foldMap/index.vue?vue&type=script&lang=js&


var foldMapvue_type_script_lang_js_excluded = ["cell"];


//
//
//
//
//
//
//
//
//




/* harmony default export */ var foldMapvue_type_script_lang_js_ = ({
  mixins: [rectUnit],
  name: 'foldMap',
  components: {
    foldItem: fold_item
  },
  data: function data() {
    return {
      num: 1,
      tableOffset: {},
      rectStyle: {},
      dpr: window.devicePixelRatio || 1,
      backgroundConfig: {},
      maxLevel: 1
    };
  },
  computed: {
    //form容器计算
    contentStyle: function contentStyle() {
      var top = this.tableOffset.top;
      var v = {};
      var _this$_sheet$data$set = this._sheet.data.settings,
          minContent = _this$_sheet$data$set.minContent,
          showToolbar = _this$_sheet$data$set.showToolbar;

      if (minContent) {
        v = {
          left: '50%',
          transform: "translate(calc(-50% - 0px), 0)"
        };
      }

      return _objectSpread2(_objectSpread2({}, this.getStyle(_objectSpread2(_objectSpread2({}, this.tableOffset), {}, {
        top: showToolbar ? top + 81 : top,
        left: 0
      }))), v);
    }
  },
  props: {
    getSpreadsheet: [Function],
    activeSheetName: String,
    isEdit: {
      type: Boolean,
      default: true
    },
    foldData: Array
  },
  created: function created() {
    this._ = this.getSpreadsheet();
    this._sheet = this.getSpreadsheet().sheet;
    this.resizeContent();
  },
  mounted: function mounted() {
    this.onChangeScrollResize(); // console.log(this._);
    // this._sheet.el.el.insertBefore(this.$el, this._sheet.tableEl.el);
    // this._.targetEl.parentElement.insertBefore(this.$el, this._.targetEl);

    this.renderItem();
    this.maxLevel = this.getMaxLevel(this.foldData);
    this.$emit('setMaxWidth', this.maxLevel * 18);
  },
  methods: {
    resizeContent: function resizeContent() {
      this.tableOffset = this._sheet.getTableOffset();
    },
    makeFolder: function makeFolder(item) {
      this.$set(item, 'children', []);
      this.addItem(item);
    },
    addItem: function addItem(item) {
      item.children.push({
        name: 'new stuff'
      });
    },
    //滚动条响应
    onChangeScrollResize: function onChangeScrollResize() {
      this._verticalScrollbar = this._sheet.verticalScrollbar.el.el;
      this._horizontalScrollbar = this._sheet.horizontalScrollbar.el.el;
      addListener(this._verticalScrollbar.firstChild, this.renderItem);
      addListener(this._horizontalScrollbar.firstChild, this.renderItem);

      this._verticalScrollbar.addEventListener('scroll', lodash_es_debounce(this.renderItem, 10), true);

      this._horizontalScrollbar.addEventListener('scroll', lodash_es_debounce(this.renderItem, 10), true);

      window.addEventListener('resize', this.resizeContent);
    },
    renderItem: function renderItem() {
      var _this$getItemStyle = this.getItemStyle("A".concat(parseInt(this.foldData[0].ri) + 1)),
          top = _this$getItemStyle.top;

      this.rectStyle = {
        left: 0,
        top: top
      };
    },
    toggle: function toggle(data, isOpen) {
      if (Array.isArray(data)) {
        this.mapTree(data, !isOpen);
      } else {
        this.mapTree(data.children, !isOpen);
      }

      this.resizeScroll();

      this._.reRender();
    },
    resizeScroll: function resizeScroll() {
      var _this$_$sheet = this._.sheet,
          data = _this$_$sheet.data,
          verticalScrollbar = _this$_$sheet.verticalScrollbar;
      var height = this.tableOffset.height;
      var erth = data.exceptRowTotalHeight(0, -1);
      var scrollHeight = data.rows.totalHeight() - erth;

      if (height > scrollHeight) {
        this._.sheet.verticalScrollbarSet(0, this._.sheet.data.scroll.x);
      } else {
        verticalScrollbar.set(height, scrollHeight, data.scroll, true);
      }
    },
    mapTree: function mapTree(data, isHide) {
      var _this = this;

      data.forEach(function (items) {
        if (items !== null && items !== void 0 && items.ri) {
          _this._sheet.data.rows.setHide(items.ri, isHide);
        }

        if (items.children && items.isOpen) {
          _this.mapTree(items.children, isHide);
        }
      });
    },
    // number -> `number`px
    getStyle: function getStyle(Offset, dpr) {
      var contentStyle = {};

      for (var key in Offset) {
        if (Object.hasOwnProperty.call(Offset, key)) {
          var element = Offset[key];
          var dprOffset = (dpr === null || dpr === void 0 ? void 0 : dpr[key]) || 0;
          contentStyle[key] = "".concat(element + dprOffset, "px");
        }
      }

      return _objectSpread2({}, contentStyle);
    },
    //form Item偏移量计算
    getItemStyle: function getItemStyle(key) {
      var _this$getRange = this.getRange(key),
          range = _this$getRange.range;

      var sri = range.sri,
          sci = range.sci;

      var dataCell = this._sheet.data.cellRect(sri, sci);

      var cell = dataCell.cell,
          style = _objectWithoutProperties(dataCell, foldMapvue_type_script_lang_js_excluded);

      cell;
      style = this._sheet.data.getRect(range);
      return this.getStyle(style, {
        height: this.dpr > 1 ? -1 : 0
      });
    },
    getMaxLevel: function getMaxLevel(foldData) {
      var level = 0;
      var maxLevel = 0;

      function loop(data, level) {
        data.forEach(function (item) {
          item.level = level;

          if (level > maxLevel) {
            maxLevel = level;
          }

          if ('children' in item) {
            if (item.children.length > 0) {
              loop(item.children, level + 1);
            }
          }
        });
      }

      loop(foldData, level);
      return maxLevel;
    },
    getHeight: function getHeight(ri) {
      var rows = this._sheet.data.rows;
      return rows.getHeight(ri);
    }
  },
  beforeDestroy: function beforeDestroy() {
    esm_removeListener(this._verticalScrollbar.firstChild, this.renderItem);
    esm_removeListener(this._horizontalScrollbar.firstChild, this.renderItem);
    window.removeEventListener('resize', this.resizeContent);
  }
});
// CONCATENATED MODULE: ./src/foldMap/index.vue?vue&type=script&lang=js&
 /* harmony default export */ var src_foldMapvue_type_script_lang_js_ = (foldMapvue_type_script_lang_js_); 
// EXTERNAL MODULE: ./src/foldMap/index.vue?vue&type=style&index=0&id=448a11a0&lang=scss&scoped=true&
var foldMapvue_type_style_index_0_id_448a11a0_lang_scss_scoped_true_ = __webpack_require__("2884");

// CONCATENATED MODULE: ./src/foldMap/index.vue






/* normalize component */

var foldMap_component = normalizeComponent(
  src_foldMapvue_type_script_lang_js_,
  foldMapvue_type_template_id_448a11a0_scoped_true_render,
  foldMapvue_type_template_id_448a11a0_scoped_true_staticRenderFns,
  false,
  null,
  "448a11a0",
  null
  
)

/* harmony default export */ var foldMap = (foldMap_component.exports);
// CONCATENATED MODULE: ./src/mixins/validator.js




/* harmony default export */ var mixins_validator = ({
  created: function created() {
    this._defaultStyle = {};
  },
  methods: {
    validator: function validator(sri, sci, key, text, validations) {
      if (validations && text) {
        this.validateStyle(validations, key, sri, sci, text);
      }
    },
    createValidate: function createValidate(_ref, text) {
      var type = _ref.type,
          required = _ref.required,
          value = _ref.value,
          operator = _ref.operator,
          tips = _ref.tips;
      var validator = new validator_Validator(type, required, value, operator, tips);
      return validator.validate(text, this._sheet.data.getIdentifierParseValue.bind(this._sheet.data));
    },
    validateStyle: function validateStyle(validations, key, sri, sci, text) {
      var _iterator = _createForOfIteratorHelper(validations),
          _step;

      try {
        for (_iterator.s(); !(_step = _iterator.n()).done;) {
          var validation = _step.value;

          if (validation) {
            var _this$createValidate = this.createValidate(validation, text),
                _this$createValidate2 = _slicedToArray(_this$createValidate, 1),
                flag = _this$createValidate2[0];

            if ((validation === null || validation === void 0 ? void 0 : validation.area) === 'row') {
              for (var index = 0; index < this._sheet.data.cols.len; index++) {
                key = this._sheet.data.xy2expr(index, sri);
                this.setValidateStyle(flag, key, sri, index, validation);
              }
            } else if ((validation === null || validation === void 0 ? void 0 : validation.area) === 'col') {
              for (var _index = 0; _index < this._sheet.data.rows.len; _index++) {
                key = this._sheet.data.xy2expr(sci, _index);
                this.setValidateStyle(flag, key, _index, sci, validation);
              }
            } else {
              this.setValidateStyle(flag, key, sri, sci, validation);
            }

            if (flag) {
              break;
            }
          }
        }
      } catch (err) {
        _iterator.e(err);
      } finally {
        _iterator.f();
      }
    },
    setValidateStyle: function setValidateStyle(flag, key, sri, sci, validation) {
      var _this$_defaultStyle;

      var _defaultStyle = (_this$_defaultStyle = this._defaultStyle) === null || _this$_defaultStyle === void 0 ? void 0 : _this$_defaultStyle[key];

      if (!_defaultStyle) {
        this._defaultStyle[key] = this.formatCellStyle(this._sheet.data.getCellStyleOrDefault(sri, sci) || {});
        _defaultStyle = this._defaultStyle[key];
      }

      var mergeStyle = _objectSpread2(_objectSpread2({}, _defaultStyle), validation.style);

      for (var stylekey in mergeStyle) {
        if (Object.hasOwnProperty.call(mergeStyle, stylekey)) {
          if (flag) {
            if (mergeStyle[stylekey]) {
              this._sheet.data.setCellStyle(stylekey, mergeStyle[stylekey], sri, sci);
            }
          } else {
            this._sheet.data.setCellStyle(stylekey, _defaultStyle[stylekey], sri, sci);
          }
        }
      }
    },
    formatCellStyle: function formatCellStyle(style) {
      var defaultStyle = {};

      for (var key in style) {
        if (Object.hasOwnProperty.call(style, key)) {
          var element = style[key];

          if (key === 'font') {
            for (var _key in element) {
              if (Object.hasOwnProperty.call(element, _key)) {
                var value = element[_key];
                defaultStyle['font-' + _key] = value;
              }
            }
          } else {
            defaultStyle[key] = element;
          }
        }
      }

      return defaultStyle;
    }
  }
});
// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js??ref--13-0!./node_modules/thread-loader/dist/cjs.js!./node_modules/babel-loader/lib!./node_modules/cache-loader/dist/cjs.js??ref--1-0!./node_modules/vue-loader/lib??vue-loader-options!./src/index.vue?vue&type=script&lang=js&





//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//









/* harmony default export */ var lib_vue_loader_options_srcvue_type_script_lang_js_ = ({
  mixins: [rectUnit, mixins_validator],
  components: {
    sheet: src_sheet_1,
    sheetDialog: dialog,
    inform: inform,
    slash: slash,
    rectTable: rectTable,
    backImg: backImg,
    foldMap: foldMap
  },
  props: {
    isEdit: {
      type: Boolean,
      default: true
    },
    isHasForm: {
      type: Boolean,
      default: true
    },
    showFieldName: {
      type: Boolean,
      default: false
    },
    isValidator: {
      type: Boolean,
      default: true
    },
    isHasRect: {
      type: Boolean,
      default: false
    },
    showRectType: {
      type: Boolean,
      default: false
    },
    showFold: {
      type: Boolean,
      default: false
    }
  },
  watch: {
    rectConfig: {
      deep: true,
      handler: function handler(c) {
        this.spreadsheet.sheet.data.setLayerConfig('rectConfig', c);
      }
    },
    showFold: {
      deep: true,
      handler: function handler() {
        this.syncConfigFold();
      }
    }
  },
  data: function data() {
    return {
      showInform: false,
      showRect: false,
      showBackImg: false,
      activeSheetName: '',
      formConfig: {},
      showSlash: false,
      slashConfig: {},
      rectConfig: {},
      renderKey: 0,
      foldConfig: [],
      maxTreeWidth: 0,
      isFold: false,
      renderTime: 0
    };
  },
  computed: {
    mergeConfig: function mergeConfig() {
      return _objectSpread2(_objectSpread2({}, this._config), this.config);
    }
  },
  mounted: function mounted() {
    var _this = this;

    this._config = {
      showToolbar: true,
      showGrid: true,
      showBottombar: true,
      bottomBarOperate: true,
      view: {
        height: function height() {
          return _this.$el.clientHeight;
        },
        width: function width() {
          return _this.$el.clientWidth;
        }
      }
    };
  },
  methods: {
    init: function init(config, sheetData) {
      var _sheetData = [{
        name: 'sheet1',
        rows: {}
      }, {
        name: 'sheet2',
        rows: {}
      }, {
        name: 'sheet3',
        rows: {}
      }];

      var _configTemp = _objectSpread2(_objectSpread2({}, this._config), config);

      this.spreadsheet = this.$refs.sheet.init(_configTemp, sheetData || _sheetData);
      this._sheet = this.getSpreadsheet().sheet;
      this.initSheetForm();
    },
    getSpreadsheet: function getSpreadsheet() {
      return this.spreadsheet;
    },
    toolSelected: function toolSelected() {
      if ((arguments.length <= 1 ? undefined : arguments[1]) === 'slash') {
        this.spreadsheet.sheet.data.isHoldSelector = true;
        this.slashConfig = arguments.length <= 2 ? undefined : arguments[2];
        this.showSlash = true;
      } else {
        var _this$$refs$sheetDial;

        (_this$$refs$sheetDial = this.$refs.sheetDialog).selectType.apply(_this$$refs$sheetDial, arguments);
      }
    },
    sortFilter: function sortFilter() {
      var _this$$refs$sheetDial2;

      (_this$$refs$sheetDial2 = this.$refs.sheetDialog).selectType.apply(_this$$refs$sheetDial2, arguments);
    },
    openFunctions: function openFunctions() {
      var _this$$refs$sheetDial3;

      (_this$$refs$sheetDial3 = this.$refs.sheetDialog).selectType.apply(_this$$refs$sheetDial3, arguments);
    },
    validation: function validation() {
      var _this$$refs$sheetDial4;

      (_this$$refs$sheetDial4 = this.$refs.sheetDialog).selectType.apply(_this$$refs$sheetDial4, arguments);
    },
    editFormat: function editFormat() {
      var _this$$refs$sheetDial5;

      (_this$$refs$sheetDial5 = this.$refs.sheetDialog).selectType.apply(_this$$refs$sheetDial5, arguments);
    },
    setCellSize: function setCellSize() {
      var _this$$refs$sheetDial6;

      (_this$$refs$sheetDial6 = this.$refs.sheetDialog).selectType.apply(_this$$refs$sheetDial6, arguments);
    },
    selectCellItem: function selectCellItem(spreadsheet, cell, ri, ci) {
      this.$emit('selectCellItem', this.activeSheetName, this._sheet.data.xy2expr(ci, ri));
    },
    getFormData: function getFormData() {
      var _this$$refs;

      var getFormData = (_this$$refs = this.$refs) === null || _this$$refs === void 0 ? void 0 : _this$$refs.inform.getFormData;

      if (getFormData) {
        return getFormData();
      }
    },
    close: function close() {
      this.showSlash = false;
      this.spreadsheet.sheet.data.isHoldSelector = false;
    },
    renderCom: function renderCom() {
      this.renderKey = new Date().getTime();
    },
    initSheetForm: function initSheetForm() {
      var _this2 = this;

      var syncConfig = function syncConfig(data) {
        var _data$background;

        var layerConfig = data.getLayerConfig();
        _this2.activeSheetName = data.name;

        if (_this2.isHasForm) {
          _this2.syncViewRange();

          _this2.showInform = _this2.isHasForm;
        }

        if (_this2.isHasRect) {
          _this2.rectConfig = layerConfig.rectConfig;
          _this2.showRect = _this2.isHasRect;
        }

        if ((_data$background = data.background) !== null && _data$background !== void 0 && _data$background.url || _this2.isEdit) {
          _this2.showBackImg = true;
        }
      };

      syncConfig(this.spreadsheet.data);
      this.spreadsheet.on('reset-data', function (data) {
        syncConfig(data);

        _this2.close();
      });
    },
    syncConfigFold: function syncConfigFold() {
      if (this.showFold) {
        var layerConfig = this.spreadsheet.data.getLayerConfig();
        this.foldConfig = layerConfig.foldConfig;
        this.isFold = true;
      }
    },
    syncViewRange: function syncViewRange() {
      var formConfig = {};
      var data = null;
      var i = 0;

      if (this.activeSheetName) {
        var _iterator = _createForOfIteratorHelper(this.spreadsheet.datas),
            _step;

        try {
          for (_iterator.s(); !(_step = _iterator.n()).done;) {
            var _iterator2 = _step.value;

            if (_iterator2.name === this.activeSheetName) {
              data = _iterator2;
              this._activeData = data;
            }
          }
        } catch (err) {
          _iterator.e(err);
        } finally {
          _iterator.f();
        }

        var _data$freeze = _slicedToArray(data.freeze, 2),
            fri = _data$freeze[0],
            fci = _data$freeze[1];

        var viewRange = data.viewRange();
        var ranges = [viewRange];

        if (fri > 0 || fci > 0) {
          // 2
          if (fri > 0) {
            var vr1 = viewRange.clone();
            vr1.sri = 0;
            vr1.eri = fri - 1;
            ranges.push(vr1);
          } // 3


          if (fci > 0) {
            var vr2 = viewRange.clone();
            vr2.sci = 0;
            vr2.eci = fci - 1;
            ranges.push(vr2);
          } // 4


          var freezeViewRange = data.freezeViewRange();
          ranges.push(freezeViewRange);
        }

        for (var _i = 0, _ranges = ranges; _i < _ranges.length; _i++) {
          var iterator = _ranges[_i];
          iterator.each(function (ri, ci) {
            var key = data.xy2expr(ci, ri);
            var item = data.formConfig[key];

            if (item) {
              var _aggregate, _horizontalAggregate;

              var sourceConfigType = item.sourceConfigType,
                  levelSourceConfig = item.levelSourceConfig,
                  isLevel = item.isLevel,
                  levelConfig = item.levelConfig,
                  _item$sourceConfig = item.sourceConfig,
                  fieldName = _item$sourceConfig.fieldName,
                  horizontalAggregate = _item$sourceConfig.horizontalAggregate,
                  levelName = _item$sourceConfig.levelName,
                  aggregate = _item$sourceConfig.aggregate,
                  type = item.type,
                  direction = item.direction;

              if (!item.isLevel) {
                levelConfig = null;
                levelSourceConfig = null;
              }

              i++;
              aggregate = (_aggregate = aggregate) !== null && _aggregate !== void 0 && _aggregate.enable ? aggregate : null;
              horizontalAggregate = (_horizontalAggregate = horizontalAggregate) !== null && _horizontalAggregate !== void 0 && _horizontalAggregate.enable ? horizontalAggregate : null;
              formConfig[key] = {
                sourceConfigType: sourceConfigType,
                levelSourceConfig: levelSourceConfig,
                isLevel: isLevel,
                levelConfig: levelConfig,
                sourceConfig: {
                  fieldName: fieldName,
                  horizontalAggregate: horizontalAggregate,
                  levelName: levelName,
                  aggregate: aggregate
                },
                type: type,
                direction: direction
              };
            }
          });
        }
      }

      this.renderTime = i * 0.2;
      this.formConfig = JSON.parse(JSON.stringify(formConfig));
    },
    validatorCells: function validatorCells() {
      if (this.isValidator) {
        var formConfig = this.spreadsheet.sheet.data.formConfig;

        for (var key in formConfig) {
          if (Object.hasOwnProperty.call(formConfig, key)) {
            var _formConfig$key;

            var validations = (_formConfig$key = formConfig[key]) === null || _formConfig$key === void 0 ? void 0 : _formConfig$key.validations;

            if (validations) {
              var _cell$text;

              var _this$getRange = this.getRange(key),
                  range = _this$getRange.range;

              var sri = range.sri,
                  sci = range.sci;
              var cell = this.spreadsheet.sheet.data.getCell(sri, sci);
              var text = (_cell$text = cell === null || cell === void 0 ? void 0 : cell.text) !== null && _cell$text !== void 0 ? _cell$text : '';
              this.validator(sri, sci, key, text, validations);
            }
          }
        }
      }
    },
    getActiveData: function getActiveData() {
      return this._activeData;
    },
    setLayerConfig: function setLayerConfig(c) {
      this.spreadsheet.sheet.data.setLayerConfig('formConfig', c);
      this.syncViewRange();
    },
    setMaxWidth: function setMaxWidth(maxWidth) {
      this.maxTreeWidth = maxWidth;
    }
  }
});
// CONCATENATED MODULE: ./src/index.vue?vue&type=script&lang=js&
 /* harmony default export */ var srcvue_type_script_lang_js_ = (lib_vue_loader_options_srcvue_type_script_lang_js_); 
// EXTERNAL MODULE: ./src/index.vue?vue&type=style&index=0&id=4fb99c2a&lang=scss&scoped=true&
var srcvue_type_style_index_0_id_4fb99c2a_lang_scss_scoped_true_ = __webpack_require__("8bc7");

// CONCATENATED MODULE: ./src/index.vue






/* normalize component */

var src_component = normalizeComponent(
  srcvue_type_script_lang_js_,
  lib_vue_loader_options_srcvue_type_template_id_4fb99c2a_scoped_true_render,
  staticRenderFns,
  false,
  null,
  "4fb99c2a",
  null
  
)

/* harmony default export */ var src_0 = (src_component.exports);
// CONCATENATED MODULE: ./src/sheet/transfrom/spreadSheetToLuckysheetTransfrom.js








var pushBorderToBorderInfo = function pushBorderToBorderInfo(rowIndex, colIndex, style, borderInfo) {
  var borderStyle = style.border;
  var type = {
    thin: 1,
    dotted: 3,
    dashed: 4,
    medium: 8,
    thick: 13,
    double: 7
  };

  if (borderStyle) {
    var borderTemp = {
      rangeType: 'cell',
      value: {
        row_index: rowIndex,
        col_index: colIndex
      }
    };

    if (borderStyle.left) {
      borderTemp.value.l = {
        style: type[borderStyle.left[0]],
        color: borderStyle.left[1]
      };
    }

    if (borderStyle.right) {
      borderTemp.value.r = {
        style: type[borderStyle.right[0]],
        color: borderStyle.right[1]
      };
    }

    if (borderStyle.top) {
      borderTemp.value.t = {
        style: type[borderStyle.top[0]],
        color: borderStyle.top[1]
      };
    }

    if (borderStyle.bottom) {
      borderTemp.value.b = {
        style: type[borderStyle.bottom[0]],
        color: borderStyle.bottom[1]
      };
    }

    borderInfo.push(borderTemp);
  }
};

var getStyles = function getStyles(style) {
  var _style$font, _style$font2, _style$font3, _style$font4;

  var transfromCellStyle = {};

  if (style.bgcolor) {
    transfromCellStyle.bg = style.bgcolor;
  }

  if (style.color) {
    transfromCellStyle.fc = style.color;
  }

  if ((_style$font = style.font) !== null && _style$font !== void 0 && _style$font.name) {
    transfromCellStyle.ff = style.font.name;
  }

  if ((_style$font2 = style.font) !== null && _style$font2 !== void 0 && _style$font2.size) {
    transfromCellStyle.fs = style.font.size;
  }

  if ((_style$font3 = style.font) !== null && _style$font3 !== void 0 && _style$font3.italic) {
    transfromCellStyle.it = style.font.italic;
  }

  if ((_style$font4 = style.font) !== null && _style$font4 !== void 0 && _style$font4.bold) {
    transfromCellStyle.bl = style.font.bold;
  }

  if (style.strike) {
    transfromCellStyle.cl = style.strike;
  }

  if (style.underline) {
    transfromCellStyle.un = style.underline;
  }

  if (typeof style.textwrap !== 'undefined') {
    transfromCellStyle.tb = style.textwrap === true ? 2 : 0;
  }

  if (style.format) {
    transfromCellStyle.fa = style.format;

    if (typeof style.isSeparator !== 'undefined') {
      transfromCellStyle.isSeparator = style.isSeparator;
    }

    if (typeof style.precision !== 'undefined') {
      transfromCellStyle.precision = style.precision;
    }
  }

  var alignArr = {
    center: 0,
    left: 1,
    right: 2
  };

  if (style.align) {
    transfromCellStyle.ht = alignArr[style.align];
  } else {
    transfromCellStyle.ht = 1;
  }

  var valignArr = {
    middle: 0,
    top: 1,
    bottom: 2
  };

  if (style.valign) {
    transfromCellStyle.vt = valignArr[style.valign];
  } else {
    transfromCellStyle.vt = 2;
  }

  return transfromCellStyle;
};

var spreadSheetToLuckysheetTransfrom_parseSheet = function parseSheet(sheet) {
  var name = sheet.name;
  var showGridLines = sheet.showGrid === true ? '1' : '0';
  var freeze = sheet.freeze;
  var celldata = [];
  var merge = {};
  var borderInfo = [];
  var rowlen = {};
  var columnlen = {};
  var defaultRowHeight = sheet.row.height;
  var defaultColWidth = sheet.col.width; // const images = [] 暂时没有图片

  for (var rowKey in sheet.rows) {
    var cells = sheet.rows[rowKey].cells;

    for (var colKey in cells) {
      if (cells[colKey].merge) {
        var mc = {
          r: parseInt(rowKey),
          c: parseInt(colKey),
          rs: cells[colKey].merge[0] + 1,
          cs: cells[colKey].merge[1] + 1
        };
        var endR = mc.rs + mc.r - 1;
        var endC = mc.cs + mc.c - 1;

        for (var i = mc.r; i <= endR; i++) {
          for (var j = mc.c; j <= endC; j++) {
            if (!sheet.rows[i]) {
              sheet.rows[i] = {
                cells: {}
              };
            }

            if (!sheet.rows[i].cells[j]) {
              sheet.rows[i].cells[j] = {};
            }

            sheet.rows[i].cells[j].style = sheet.rows[mc.r].cells[mc.c].style;
          }
        }
      }
    }
  }

  for (var _rowKey in sheet.rows) {
    if (_rowKey !== 'len') {
      if (sheet.rows[_rowKey].hide) {
        rowlen[_rowKey] = 0;
      } else {
        rowlen[_rowKey] = sheet.rows[_rowKey].height || -1;
      }

      var _cells = sheet.rows[_rowKey].cells;

      for (var _colKey in _cells) {
        var cellTemp = {};
        cellTemp.r = parseInt(_rowKey);
        cellTemp.c = parseInt(_colKey);
        var cellTempStyles = {};
        var style = void 0;

        if (typeof _cells[_colKey].style !== 'undefined') {
          style = sheet.styles[_cells[_colKey].style];
          cellTempStyles = _objectSpread2(_objectSpread2({}, cellTempStyles), getStyles(style));
          pushBorderToBorderInfo(_rowKey, _colKey, style, borderInfo);
        }

        cellTemp.v = _objectSpread2({}, cellTempStyles);

        if (typeof _cells[_colKey].text !== 'undefined') {
          cellTemp.v.v = _cells[_colKey].text;
        }

        if (_cells[_colKey].merge) {
          cellTemp.v.mc = {
            r: parseInt(_rowKey),
            c: parseInt(_colKey),
            rs: _cells[_colKey].merge[0] + 1,
            cs: _cells[_colKey].merge[1] + 1
          };
          merge["".concat(_rowKey, "_").concat(_colKey)] = _objectSpread2({}, cellTemp.v.mc);
        }

        celldata.push(cellTemp);
      }
    }
  }

  for (var _colKey2 in sheet.cols) {
    if (sheet.cols[_colKey2].hide) {
      columnlen[_colKey2] = 0;
    } else {
      columnlen[_colKey2] = sheet.cols[_colKey2].width;
    }
  }

  return {
    freeze: freeze,
    name: name,
    showGridLines: showGridLines,
    defaultRowHeight: defaultRowHeight,
    defaultColWidth: defaultColWidth,
    celldata: celldata,
    comments: sheet.comments,
    config: {
      merge: merge,
      borderInfo: borderInfo,
      rowlen: rowlen,
      columnlen: columnlen
    }
  };
};

var spreadSheetToLuckysheetTransfrom_parse = function parse(spreadData) {
  var luckySheetData = spreadData.map(function (sheet) {
    return spreadSheetToLuckysheetTransfrom_parseSheet(sheet);
  }); // console.log(luckySheetData);

  return luckySheetData;
};
/* harmony default export */ var spreadSheetToLuckysheetTransfrom = ({
  parse: spreadSheetToLuckysheetTransfrom_parse
});
// CONCATENATED MODULE: ./src/sheet/canvas/print.js



/* harmony default export */ var canvas_print = ({
  h: element_h,
  Draw: draw_Draw,
  renderCell: renderCell
});
// CONCATENATED MODULE: ./src/index.js













var version = "3.17.3";
var src_name = "@platform/spread-sheet";
var src_hash = 1695864949938;
console.log("".concat(src_name, ":").concat(version, " <").concat(src_hash, ">"));

function install(Vue) {
  var opts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
  Vue.component(opts.comopnent || 'SpreadSheet', src_0);
}

var transform = {
  luckySheetToSpreadSheet: luckysheetTransfromToSpreadSheet.parse,
  spreadSheetToLuckySheet: spreadSheetToLuckysheetTransfrom.parse
};
var Formula = {
  calcFormulaVal: calcFormulaVal,
  clearFormulaValCache: clearFormulaValCache
};
/* harmony default export */ var src_1 = ({
  install: install,
  SpreadSheet: src_0,
  transform: transform,
  LuckyExcel: luckyexcel_cjs_default.a,
  DataProxy: data_proxy_DataProxy,
  CellRange: cell_range,
  Print: canvas_print,
  format: core_format,
  nameEncode: nameEncode,
  version: version,
  ERRORTYPES: functions_error["a" /* ERRORTYPES */],
  BigNumber: bignumber_default.a,
  Formula: Formula
});

// CONCATENATED MODULE: ./node_modules/@vue/cli-service/lib/commands/build/entry-lib.js


/* harmony default export */ var entry_lib = __webpack_exports__["default"] = (src_1);



/***/ }),

/***/ "fb19":
/***/ (function(module, exports, __webpack_require__) {

(function(t,e){ true?module.exports=e():undefined})("undefined"!==typeof self?self:this,(function(){return function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(i,r,function(e){return t[e]}.bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s="fb15")}({"0029":function(t,e){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},"0185":function(t,e,n){var i=n("e5fa");t.exports=function(t){return Object(i(t))}},"01f9":function(t,e,n){"use strict";var i=n("2d00"),r=n("5ca1"),o=n("2aba"),a=n("32e9"),c=n("84f2"),u=n("41a0"),s=n("7f20"),f=n("38fd"),h=n("2b4c")("iterator"),l=!([].keys&&"next"in[].keys()),d="@@iterator",p="keys",m="values",g=function(){return this};t.exports=function(t,e,n,v,b,y,x){u(n,e,v);var w,S,_,O=function(t){if(!l&&t in L)return L[t];switch(t){case p:return function(){return new n(this,t)};case m:return function(){return new n(this,t)}}return function(){return new n(this,t)}},E=e+" Iterator",T=b==m,P=!1,L=t.prototype,M=L[h]||L[d]||b&&L[b],R=M||O(b),j=b?T?O("entries"):R:void 0,A="Array"==e&&L.entries||M;if(A&&(_=f(A.call(new t)),_!==Object.prototype&&_.next&&(s(_,E,!0),i||"function"==typeof _[h]||a(_,h,g))),T&&M&&M.name!==m&&(P=!0,R=function(){return M.call(this)}),i&&!x||!l&&!P&&L[h]||a(L,h,R),c[e]=R,c[E]=g,b)if(w={values:T?R:O(m),keys:y?R:O(p),entries:j},x)for(S in w)S in L||o(L,S,w[S]);else r(r.P+r.F*(l||P),e,w);return w}},"02f4":function(t,e,n){var i=n("4588"),r=n("be13");t.exports=function(t){return function(e,n){var o,a,c=String(r(e)),u=i(n),s=c.length;return u<0||u>=s?t?"":void 0:(o=c.charCodeAt(u),o<55296||o>56319||u+1===s||(a=c.charCodeAt(u+1))<56320||a>57343?t?c.charAt(u):o:t?c.slice(u,u+2):a-56320+(o-55296<<10)+65536)}}},"0a49":function(t,e,n){var i=n("9b43"),r=n("626a"),o=n("4bf8"),a=n("9def"),c=n("cd1c");t.exports=function(t,e){var n=1==t,u=2==t,s=3==t,f=4==t,h=6==t,l=5==t||h,d=e||c;return function(e,c,p){for(var m,g,v=o(e),b=r(v),y=i(c,p,3),x=a(b.length),w=0,S=n?d(e,x):u?d(e,0):void 0;x>w;w++)if((l||w in b)&&(m=b[w],g=y(m,w,v),t))if(n)S[w]=g;else if(g)switch(t){case 3:return!0;case 5:return m;case 6:return w;case 2:S.push(m)}else if(f)return!1;return h?-1:s||f?f:S}}},"0a91":function(t,e,n){n("b42c"),n("93c4"),t.exports=n("b77f")},"0bfb":function(t,e,n){"use strict";var i=n("cb7c");t.exports=function(){var t=i(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}},"0d58":function(t,e,n){var i=n("ce10"),r=n("e11e");t.exports=Object.keys||function(t){return i(t,r)}},"0f89":function(t,e,n){var i=n("6f8a");t.exports=function(t){if(!i(t))throw TypeError(t+" is not an object!");return t}},"103a":function(t,e,n){var i=n("da3c").document;t.exports=i&&i.documentElement},1169:function(t,e,n){var i=n("2d95");t.exports=Array.isArray||function(t){return"Array"==i(t)}},"11e9":function(t,e,n){var i=n("52a7"),r=n("4630"),o=n("6821"),a=n("6a99"),c=n("69a8"),u=n("c69a"),s=Object.getOwnPropertyDescriptor;e.f=n("9e1e")?s:function(t,e){if(t=o(t),e=a(e,!0),u)try{return s(t,e)}catch(n){}if(c(t,e))return r(!i.f.call(t,e),t[e])}},"12fd":function(t,e,n){var i=n("6f8a"),r=n("da3c").document,o=i(r)&&i(r.createElement);t.exports=function(t){return o?r.createElement(t):{}}},1495:function(t,e,n){var i=n("86cc"),r=n("cb7c"),o=n("0d58");t.exports=n("9e1e")?Object.defineProperties:function(t,e){r(t);var n,a=o(e),c=a.length,u=0;while(c>u)i.f(t,n=a[u++],e[n]);return t}},1938:function(t,e,n){var i=n("d13f");i(i.S,"Array",{isArray:n("b5aa")})},"1b55":function(t,e,n){var i=n("7772")("wks"),r=n("7b00"),o=n("da3c").Symbol,a="function"==typeof o,c=t.exports=function(t){return i[t]||(i[t]=a&&o[t]||(a?o:r)("Symbol."+t))};c.store=i},"1b8f":function(t,e,n){var i=n("a812"),r=Math.max,o=Math.min;t.exports=function(t,e){return t=i(t),t<0?r(t+e,0):o(t,e)}},"1c01":function(t,e,n){var i=n("5ca1");i(i.S+i.F*!n("9e1e"),"Object",{defineProperty:n("86cc").f})},"1fa8":function(t,e,n){var i=n("cb7c");t.exports=function(t,e,n,r){try{return r?e(i(n)[0],n[1]):e(n)}catch(a){var o=t["return"];throw void 0!==o&&i(o.call(t)),a}}},"230e":function(t,e,n){var i=n("d3f4"),r=n("7726").document,o=i(r)&&i(r.createElement);t.exports=function(t){return o?r.createElement(t):{}}},2312:function(t,e,n){t.exports=n("8ce0")},"23c6":function(t,e,n){var i=n("2d95"),r=n("2b4c")("toStringTag"),o="Arguments"==i(function(){return arguments}()),a=function(t,e){try{return t[e]}catch(n){}};t.exports=function(t){var e,n,c;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=a(e=Object(t),r))?n:o?i(e):"Object"==(c=i(e))&&"function"==typeof e.callee?"Arguments":c}},2418:function(t,e,n){var i=n("6a9b"),r=n("a5ab"),o=n("1b8f");t.exports=function(t){return function(e,n,a){var c,u=i(e),s=r(u.length),f=o(a,s);if(t&&n!=n){while(s>f)if(c=u[f++],c!=c)return!0}else for(;s>f;f++)if((t||f in u)&&u[f]===n)return t||f||0;return!t&&-1}}},"245b":function(t,e){t.exports=function(t,e){return{value:e,done:!!t}}},2621:function(t,e){e.f=Object.getOwnPropertySymbols},2695:function(t,e,n){var i=n("43c8"),r=n("6a9b"),o=n("2418")(!1),a=n("5d8f")("IE_PROTO");t.exports=function(t,e){var n,c=r(t),u=0,s=[];for(n in c)n!=a&&i(c,n)&&s.push(n);while(e.length>u)i(c,n=e[u++])&&(~o(s,n)||s.push(n));return s}},"27ee":function(t,e,n){var i=n("23c6"),r=n("2b4c")("iterator"),o=n("84f2");t.exports=n("8378").getIteratorMethod=function(t){if(void 0!=t)return t[r]||t["@@iterator"]||o[i(t)]}},"2a4e":function(t,e,n){var i=n("a812"),r=n("e5fa");t.exports=function(t){return function(e,n){var o,a,c=String(r(e)),u=i(n),s=c.length;return u<0||u>=s?t?"":void 0:(o=c.charCodeAt(u),o<55296||o>56319||u+1===s||(a=c.charCodeAt(u+1))<56320||a>57343?t?c.charAt(u):o:t?c.slice(u,u+2):a-56320+(o-55296<<10)+65536)}}},"2aba":function(t,e,n){var i=n("7726"),r=n("32e9"),o=n("69a8"),a=n("ca5a")("src"),c="toString",u=Function[c],s=(""+u).split(c);n("8378").inspectSource=function(t){return u.call(t)},(t.exports=function(t,e,n,c){var u="function"==typeof n;u&&(o(n,"name")||r(n,"name",e)),t[e]!==n&&(u&&(o(n,a)||r(n,a,t[e]?""+t[e]:s.join(String(e)))),t===i?t[e]=n:c?t[e]?t[e]=n:r(t,e,n):(delete t[e],r(t,e,n)))})(Function.prototype,c,(function(){return"function"==typeof this&&this[a]||u.call(this)}))},"2aeb":function(t,e,n){var i=n("cb7c"),r=n("1495"),o=n("e11e"),a=n("613b")("IE_PROTO"),c=function(){},u="prototype",s=function(){var t,e=n("230e")("iframe"),i=o.length,r="<",a=">";e.style.display="none",n("fab2").appendChild(e),e.src="javascript:",t=e.contentWindow.document,t.open(),t.write(r+"script"+a+"document.F=Object"+r+"/script"+a),t.close(),s=t.F;while(i--)delete s[u][o[i]];return s()};t.exports=Object.create||function(t,e){var n;return null!==t?(c[u]=i(t),n=new c,c[u]=null,n[a]=t):n=s(),void 0===e?n:r(n,e)}},"2b4c":function(t,e,n){var i=n("5537")("wks"),r=n("ca5a"),o=n("7726").Symbol,a="function"==typeof o,c=t.exports=function(t){return i[t]||(i[t]=a&&o[t]||(a?o:r)("Symbol."+t))};c.store=i},"2d00":function(t,e){t.exports=!1},"2d95":function(t,e){var n={}.toString;t.exports=function(t){return n.call(t).slice(8,-1)}},"2ea1":function(t,e,n){var i=n("6f8a");t.exports=function(t,e){if(!i(t))return t;var n,r;if(e&&"function"==typeof(n=t.toString)&&!i(r=n.call(t)))return r;if("function"==typeof(n=t.valueOf)&&!i(r=n.call(t)))return r;if(!e&&"function"==typeof(n=t.toString)&&!i(r=n.call(t)))return r;throw TypeError("Can't convert object to primitive value")}},"2f21":function(t,e,n){"use strict";var i=n("79e5");t.exports=function(t,e){return!!t&&i((function(){e?t.call(null,(function(){}),1):t.call(null)}))}},"2fdb":function(t,e,n){"use strict";var i=n("5ca1"),r=n("d2c8"),o="includes";i(i.P+i.F*n("5147")(o),"String",{includes:function(t){return!!~r(this,t,o).indexOf(t,arguments.length>1?arguments[1]:void 0)}})},"32e9":function(t,e,n){var i=n("86cc"),r=n("4630");t.exports=n("9e1e")?function(t,e,n){return i.f(t,e,r(1,n))}:function(t,e,n){return t[e]=n,t}},"33a4":function(t,e,n){var i=n("84f2"),r=n("2b4c")("iterator"),o=Array.prototype;t.exports=function(t){return void 0!==t&&(i.Array===t||o[r]===t)}},3425:function(t,e,n){"use strict";var i=function(){var t,e=this,n=e.$createElement,i=e._self._c||n;return i("div",{class:[(t={},t[e.classNameActive]=e.enabled,t[e.classNameDragging]=e.dragging,t[e.classNameResizing]=e.resizing,t[e.classNameDraggable]=e.draggable,t[e.classNameResizable]=e.resizable,t),e.className],style:e.style,on:{mousedown:e.elementMouseDown,touchstart:e.elementTouchDown}},[e._l(e.actualHandles,(function(t){return i("div",{key:t,class:[e.classNameHandle,e.classNameHandle+"-"+t],style:{display:e.enabled?"block":"none"},on:{mousedown:function(n){n.stopPropagation(),n.preventDefault(),e.handleDown(t,n)},touchstart:function(n){n.stopPropagation(),n.preventDefault(),e.handleTouchDown(t,n)}}},[e._t(t)],2)})),e._v(" "),e._t("default")],2)},r=[],o=(n("1c01"),n("58b2"),n("8e6e"),n("f3e2"),n("456d"),n("85f2")),a=n.n(o);function c(t,e,n){return e in t?a()(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}n("3b2b");var u=n("a745"),s=n.n(u);function f(t){if(s()(t))return t}var h=n("5d73"),l=n.n(h),d=n("c8bb"),p=n.n(d);function m(t,e){if(p()(Object(t))||"[object Arguments]"===Object.prototype.toString.call(t)){var n=[],i=!0,r=!1,o=void 0;try{for(var a,c=l()(t);!(i=(a=c.next()).done);i=!0)if(n.push(a.value),e&&n.length===e)break}catch(u){r=!0,o=u}finally{try{i||null==c["return"]||c["return"]()}finally{if(r)throw o}}return n}}function g(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function v(t,e){return f(t)||m(t,e)||g()}n("6762"),n("2fdb"),n("d25f"),n("ac6a"),n("cadf"),n("5df3"),n("4f7f"),n("c5f6"),n("7514"),n("6b54"),n("87b3");function b(t){return"function"===typeof t||"[object Function]"===Object.prototype.toString.call(t)}function y(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r="number"===typeof i?[i,i]:i,o=v(r,2),a=o[0],c=o[1],u=Math.round(e/a/t[0])*t[0],s=Math.round(n/c/t[1])*t[1];return[u,s]}function x(t,e,n){return t-e-n}function w(t,e,n){return t-e-n}function S(t,e,n){return null!==e&&t<e?e:null!==n&&n<t?n:t}function _(t,e,n){var i=t,r=["matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"].find((function(t){return b(i[t])}));if(!b(i[r]))return!1;do{if(i[r](e))return!0;if(i===n)return!1;i=i.parentNode}while(i);return!1}function O(t){var e=window.getComputedStyle(t);return[parseFloat(e.getPropertyValue("width"),10),parseFloat(e.getPropertyValue("height"),10)]}function E(t,e,n){t&&(t.attachEvent?t.attachEvent("on"+e,n):t.addEventListener?t.addEventListener(e,n,!0):t["on"+e]=n)}function T(t,e,n){t&&(t.detachEvent?t.detachEvent("on"+e,n):t.removeEventListener?t.removeEventListener(e,n,!0):t["on"+e]=null)}function P(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function L(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?P(n,!0).forEach((function(e){c(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):P(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var M={mouse:{start:"mousedown",move:"mousemove",stop:"mouseup"},touch:{start:"touchstart",move:"touchmove",stop:"touchend"}},R={userSelect:"none",MozUserSelect:"none",WebkitUserSelect:"none",MsUserSelect:"none"},j={userSelect:"auto",MozUserSelect:"auto",WebkitUserSelect:"auto",MsUserSelect:"auto"},A=M.mouse,k={replace:!0,name:"vue-draggable-resizable",props:{className:{type:String,default:"vdr"},classNameDraggable:{type:String,default:"draggable"},classNameResizable:{type:String,default:"resizable"},classNameDragging:{type:String,default:"dragging"},classNameResizing:{type:String,default:"resizing"},classNameActive:{type:String,default:"active"},classNameHandle:{type:String,default:"handle"},disableUserSelect:{type:Boolean,default:!0},enableNativeDrag:{type:Boolean,default:!1},preventDeactivation:{type:Boolean,default:!1},active:{type:Boolean,default:!1},draggable:{type:Boolean,default:!0},resizable:{type:Boolean,default:!0},lockAspectRatio:{type:Boolean,default:!1},w:{type:[Number,String],default:200,validator:function(t){return"number"===typeof t?t>0:"auto"===t}},h:{type:[Number,String],default:200,validator:function(t){return"number"===typeof t?t>0:"auto"===t}},minWidth:{type:Number,default:0,validator:function(t){return t>=0}},minHeight:{type:Number,default:0,validator:function(t){return t>=0}},maxWidth:{type:Number,default:null,validator:function(t){return t>=0}},maxHeight:{type:Number,default:null,validator:function(t){return t>=0}},x:{type:Number,default:0},y:{type:Number,default:0},z:{type:[String,Number],default:"auto",validator:function(t){return"string"===typeof t?"auto"===t:t>=0}},handles:{type:Array,default:function(){return["tl","tm","tr","mr","br","bm","bl","ml"]},validator:function(t){var e=new Set(["tl","tm","tr","mr","br","bm","bl","ml"]);return new Set(t.filter((function(t){return e.has(t)}))).size===t.length}},dragHandle:{type:String,default:null},dragCancel:{type:String,default:null},axis:{type:String,default:"both",validator:function(t){return["x","y","both"].includes(t)}},grid:{type:Array,default:function(){return[1,1]}},parent:{type:Boolean,default:!1},scale:{type:[Number,Array],default:1,validator:function(t){return"number"===typeof t?t>0:2===t.length&&t[0]>0&&t[1]>0}},onDragStart:{type:Function,default:function(){return!0}},onDrag:{type:Function,default:function(){return!0}},onResizeStart:{type:Function,default:function(){return!0}},onResize:{type:Function,default:function(){return!0}}},data:function(){return{left:this.x,top:this.y,right:null,bottom:null,width:null,height:null,widthTouched:!1,heightTouched:!1,aspectFactor:null,parentWidth:null,parentHeight:null,minW:this.minWidth,minH:this.minHeight,maxW:this.maxWidth,maxH:this.maxHeight,handle:null,enabled:this.active,resizing:!1,dragging:!1,dragEnable:!1,resizeEnable:!1,zIndex:this.z}},created:function(){this.maxWidth&&this.minWidth>this.maxWidth&&console.warn("[Vdr warn]: Invalid prop: minWidth cannot be greater than maxWidth"),this.maxWidth&&this.minHeight>this.maxHeight&&console.warn("[Vdr warn]: Invalid prop: minHeight cannot be greater than maxHeight"),this.resetBoundsAndMouseState()},mounted:function(){this.enableNativeDrag||(this.$el.ondragstart=function(){return!1});var t=this.getParentSize(),e=v(t,2),n=e[0],i=e[1];this.parentWidth=n,this.parentHeight=i;var r=O(this.$el),o=v(r,2),a=o[0],c=o[1];this.aspectFactor=("auto"!==this.w?this.w:a)/("auto"!==this.h?this.h:c),this.width="auto"!==this.w?this.w:a,this.height="auto"!==this.h?this.h:c,this.right=this.parentWidth-this.width-this.left,this.bottom=this.parentHeight-this.height-this.top,this.active&&this.$emit("activated"),E(document.documentElement,"mousedown",this.deselect),E(document.documentElement,"touchend touchcancel",this.deselect),E(window,"resize",this.checkParentSize)},beforeDestroy:function(){T(document.documentElement,"mousedown",this.deselect),T(document.documentElement,"touchstart",this.handleUp),T(document.documentElement,"mousemove",this.move),T(document.documentElement,"touchmove",this.move),T(document.documentElement,"mouseup",this.handleUp),T(document.documentElement,"touchend touchcancel",this.deselect),T(window,"resize",this.checkParentSize)},methods:{resetBoundsAndMouseState:function(){this.mouseClickPosition={mouseX:0,mouseY:0,x:0,y:0,w:0,h:0},this.bounds={minLeft:null,maxLeft:null,minRight:null,maxRight:null,minTop:null,maxTop:null,minBottom:null,maxBottom:null}},checkParentSize:function(){if(this.parent){var t=this.getParentSize(),e=v(t,2),n=e[0],i=e[1];this.parentWidth=n,this.parentHeight=i,this.right=this.parentWidth-this.width-this.left,this.bottom=this.parentHeight-this.height-this.top}},getParentSize:function(){if(this.parent){var t=window.getComputedStyle(this.$el.parentNode,null);return[parseInt(t.getPropertyValue("width"),10),parseInt(t.getPropertyValue("height"),10)]}return[null,null]},elementTouchDown:function(t){A=M.touch,this.elementDown(t)},elementMouseDown:function(t){A=M.mouse,this.elementDown(t)},elementDown:function(t){if(!(t instanceof MouseEvent&&1!==t.which)){var e=t.target||t.srcElement;if(this.$el.contains(e)){if(!1===this.onDragStart(t))return;if(this.dragHandle&&!_(e,this.dragHandle,this.$el)||this.dragCancel&&_(e,this.dragCancel,this.$el))return void(this.dragging=!1);this.enabled||(this.enabled=!0,this.$emit("activated"),this.$emit("update:active",!0)),this.draggable&&(this.dragEnable=!0),this.mouseClickPosition.mouseX=t.touches?t.touches[0].pageX:t.pageX,this.mouseClickPosition.mouseY=t.touches?t.touches[0].pageY:t.pageY,this.mouseClickPosition.left=this.left,this.mouseClickPosition.right=this.right,this.mouseClickPosition.top=this.top,this.mouseClickPosition.bottom=this.bottom,this.parent&&(this.bounds=this.calcDragLimits()),E(document.documentElement,A.move,this.move),E(document.documentElement,A.stop,this.handleUp)}}},calcDragLimits:function(){return{minLeft:this.left%this.grid[0],maxLeft:Math.floor((this.parentWidth-this.width-this.left)/this.grid[0])*this.grid[0]+this.left,minRight:this.right%this.grid[0],maxRight:Math.floor((this.parentWidth-this.width-this.right)/this.grid[0])*this.grid[0]+this.right,minTop:this.top%this.grid[1],maxTop:Math.floor((this.parentHeight-this.height-this.top)/this.grid[1])*this.grid[1]+this.top,minBottom:this.bottom%this.grid[1],maxBottom:Math.floor((this.parentHeight-this.height-this.bottom)/this.grid[1])*this.grid[1]+this.bottom}},deselect:function(t){var e=t.target||t.srcElement,n=new RegExp(this.className+"-([trmbl]{2})","");this.$el.contains(e)||n.test(e.className)||(this.enabled&&!this.preventDeactivation&&(this.enabled=!1,this.$emit("deactivated"),this.$emit("update:active",!1)),T(document.documentElement,A.move,this.handleResize)),this.resetBoundsAndMouseState()},handleTouchDown:function(t,e){A=M.touch,this.handleDown(t,e)},handleDown:function(t,e){e instanceof MouseEvent&&1!==e.which||!1!==this.onResizeStart(t,e)&&(e.stopPropagation&&e.stopPropagation(),this.lockAspectRatio&&!t.includes("m")?this.handle="m"+t.substring(1):this.handle=t,this.resizeEnable=!0,this.mouseClickPosition.mouseX=e.touches?e.touches[0].pageX:e.pageX,this.mouseClickPosition.mouseY=e.touches?e.touches[0].pageY:e.pageY,this.mouseClickPosition.left=this.left,this.mouseClickPosition.right=this.right,this.mouseClickPosition.top=this.top,this.mouseClickPosition.bottom=this.bottom,this.bounds=this.calcResizeLimits(),E(document.documentElement,A.move,this.handleResize),E(document.documentElement,A.stop,this.handleUp))},calcResizeLimits:function(){var t=this.minW,e=this.minH,n=this.maxW,i=this.maxH,r=this.aspectFactor,o=v(this.grid,2),a=o[0],c=o[1],u=this.width,s=this.height,f=this.left,h=this.top,l=this.right,d=this.bottom;this.lockAspectRatio&&(t/e>r?e=t/r:t=r*e,n&&i?(n=Math.min(n,r*i),i=Math.min(i,n/r)):n?i=n/r:i&&(n=r*i)),n-=n%a,i-=i%c;var p={minLeft:null,maxLeft:null,minTop:null,maxTop:null,minRight:null,maxRight:null,minBottom:null,maxBottom:null};return this.parent?(p.minLeft=f%a,p.maxLeft=f+Math.floor((u-t)/a)*a,p.minTop=h%c,p.maxTop=h+Math.floor((s-e)/c)*c,p.minRight=l%a,p.maxRight=l+Math.floor((u-t)/a)*a,p.minBottom=d%c,p.maxBottom=d+Math.floor((s-e)/c)*c,n&&(p.minLeft=Math.max(p.minLeft,this.parentWidth-l-n),p.minRight=Math.max(p.minRight,this.parentWidth-f-n)),i&&(p.minTop=Math.max(p.minTop,this.parentHeight-d-i),p.minBottom=Math.max(p.minBottom,this.parentHeight-h-i)),this.lockAspectRatio&&(p.minLeft=Math.max(p.minLeft,f-h*r),p.minTop=Math.max(p.minTop,h-f/r),p.minRight=Math.max(p.minRight,l-d*r),p.minBottom=Math.max(p.minBottom,d-l/r))):(p.minLeft=null,p.maxLeft=f+Math.floor((u-t)/a)*a,p.minTop=null,p.maxTop=h+Math.floor((s-e)/c)*c,p.minRight=null,p.maxRight=l+Math.floor((u-t)/a)*a,p.minBottom=null,p.maxBottom=d+Math.floor((s-e)/c)*c,n&&(p.minLeft=-(l+n),p.minRight=-(f+n)),i&&(p.minTop=-(d+i),p.minBottom=-(h+i)),this.lockAspectRatio&&n&&i&&(p.minLeft=Math.min(p.minLeft,-(l+n)),p.minTop=Math.min(p.minTop,-(i+d)),p.minRight=Math.min(p.minRight,-f-n),p.minBottom=Math.min(p.minBottom,-h-i))),p},move:function(t){this.resizing?this.handleResize(t):this.dragEnable&&this.handleDrag(t)},handleDrag:function(t){var e=this.axis,n=this.grid,i=this.bounds,r=this.mouseClickPosition,o=e&&"y"!==e?r.mouseX-(t.touches?t.touches[0].pageX:t.pageX):0,a=e&&"x"!==e?r.mouseY-(t.touches?t.touches[0].pageY:t.pageY):0,c=y(n,o,a,this.scale),u=v(c,2),s=u[0],f=u[1],h=S(r.left-s,i.minLeft,i.maxLeft),l=S(r.top-f,i.minTop,i.maxTop);if(!1!==this.onDrag(h,l)){var d=S(r.right+s,i.minRight,i.maxRight),p=S(r.bottom+f,i.minBottom,i.maxBottom);this.left=h,this.top=l,this.right=d,this.bottom=p,this.$emit("dragging",this.left,this.top),this.dragging=!0}},moveHorizontally:function(t){var e=y(this.grid,t,this.top,1),n=v(e,2),i=n[0],r=(n[1],S(i,this.bounds.minLeft,this.bounds.maxLeft));this.left=r,this.right=this.parentWidth-this.width-r},moveVertically:function(t){var e=y(this.grid,this.left,t,1),n=v(e,2),i=(n[0],n[1]),r=S(i,this.bounds.minTop,this.bounds.maxTop);this.top=r,this.bottom=this.parentHeight-this.height-r},handleResize:function(t){var e=this.left,n=this.top,i=this.right,r=this.bottom,o=this.mouseClickPosition,a=(this.lockAspectRatio,this.aspectFactor),c=o.mouseX-(t.touches?t.touches[0].pageX:t.pageX),u=o.mouseY-(t.touches?t.touches[0].pageY:t.pageY);!this.widthTouched&&c&&(this.widthTouched=!0),!this.heightTouched&&u&&(this.heightTouched=!0);var s=y(this.grid,c,u,this.scale),f=v(s,2),h=f[0],l=f[1];this.handle.includes("b")?(r=S(o.bottom+l,this.bounds.minBottom,this.bounds.maxBottom),this.lockAspectRatio&&this.resizingOnY&&(i=this.right-(this.bottom-r)*a)):this.handle.includes("t")&&(n=S(o.top-l,this.bounds.minTop,this.bounds.maxTop),this.lockAspectRatio&&this.resizingOnY&&(e=this.left-(this.top-n)*a)),this.handle.includes("r")?(i=S(o.right+h,this.bounds.minRight,this.bounds.maxRight),this.lockAspectRatio&&this.resizingOnX&&(r=this.bottom-(this.right-i)/a)):this.handle.includes("l")&&(e=S(o.left-h,this.bounds.minLeft,this.bounds.maxLeft),this.lockAspectRatio&&this.resizingOnX&&(n=this.top-(this.left-e)/a));var d=x(this.parentWidth,e,i),p=w(this.parentHeight,n,r);!1!==this.onResize(this.handle,e,n,d,p)&&(this.left=e,this.top=n,this.right=i,this.bottom=r,this.width=d,this.height=p,this.$emit("resizing",this.left,this.top,this.width,this.height),this.resizing=!0)},changeWidth:function(t){var e=y(this.grid,t,0,1),n=v(e,2),i=n[0],r=(n[1],S(this.parentWidth-i-this.left,this.bounds.minRight,this.bounds.maxRight)),o=this.bottom;this.lockAspectRatio&&(o=this.bottom-(this.right-r)/this.aspectFactor);var a=x(this.parentWidth,this.left,r),c=w(this.parentHeight,this.top,o);this.right=r,this.bottom=o,this.width=a,this.height=c},changeHeight:function(t){var e=y(this.grid,0,t,1),n=v(e,2),i=(n[0],n[1]),r=S(this.parentHeight-i-this.top,this.bounds.minBottom,this.bounds.maxBottom),o=this.right;this.lockAspectRatio&&(o=this.right-(this.bottom-r)*this.aspectFactor);var a=x(this.parentWidth,this.left,o),c=w(this.parentHeight,this.top,r);this.right=o,this.bottom=r,this.width=a,this.height=c},handleUp:function(t){this.handle=null,this.resetBoundsAndMouseState(),this.dragEnable=!1,this.resizeEnable=!1,this.resizing&&(this.resizing=!1,this.$emit("resizestop",this.left,this.top,this.width,this.height)),this.dragging&&(this.dragging=!1,this.$emit("dragstop",this.left,this.top)),T(document.documentElement,A.move,this.handleResize)}},computed:{style:function(){return L({transform:"translate(".concat(this.left,"px, ").concat(this.top,"px)"),width:this.computedWidth,height:this.computedHeight,zIndex:this.zIndex},this.dragging&&this.disableUserSelect?R:j)},actualHandles:function(){return this.resizable?this.handles:[]},computedWidth:function(){return"auto"!==this.w||this.widthTouched?this.width+"px":"auto"},computedHeight:function(){return"auto"!==this.h||this.heightTouched?this.height+"px":"auto"},resizingOnX:function(){return Boolean(this.handle)&&(this.handle.includes("l")||this.handle.includes("r"))},resizingOnY:function(){return Boolean(this.handle)&&(this.handle.includes("t")||this.handle.includes("b"))},isCornerHandle:function(){return Boolean(this.handle)&&["tl","tr","br","bl"].includes(this.handle)}},watch:{active:function(t){this.enabled=t,t?this.$emit("activated"):this.$emit("deactivated")},z:function(t){(t>=0||"auto"===t)&&(this.zIndex=t)},x:function(t){this.resizing||this.dragging||(this.parent&&(this.bounds=this.calcDragLimits()),this.moveHorizontally(t))},y:function(t){this.resizing||this.dragging||(this.parent&&(this.bounds=this.calcDragLimits()),this.moveVertically(t))},lockAspectRatio:function(t){this.aspectFactor=t?this.width/this.height:void 0},minWidth:function(t){t>0&&t<=this.width&&(this.minW=t)},minHeight:function(t){t>0&&t<=this.height&&(this.minH=t)},maxWidth:function(t){this.maxW=t},maxHeight:function(t){this.maxH=t},w:function(t){this.resizing||this.dragging||(this.parent&&(this.bounds=this.calcResizeLimits()),this.changeWidth(t))},h:function(t){this.resizing||this.dragging||(this.parent&&(this.bounds=this.calcResizeLimits()),this.changeHeight(t))}}},z=k;function N(t,e,n,i,r,o,a,c){var u,s="function"===typeof t?t.options:t;if(e&&(s.render=e,s.staticRenderFns=n,s._compiled=!0),i&&(s.functional=!0),o&&(s._scopeId="data-v-"+o),a?(u=function(t){t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,t||"undefined"===typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),r&&r.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(a)},s._ssrRegister=u):r&&(u=c?function(){r.call(this,this.$root.$options.shadowRoot)}:r),u)if(s.functional){s._injectStyles=u;var f=s.render;s.render=function(t,e){return u.call(e),f(t,e)}}else{var h=s.beforeCreate;s.beforeCreate=h?[].concat(h,u):[u]}return{exports:t,options:s}}var D=N(z,i,r,!1,null,null,null);e["a"]=D.exports},3846:function(t,e,n){n("9e1e")&&"g"!=/./g.flags&&n("86cc").f(RegExp.prototype,"flags",{configurable:!0,get:n("0bfb")})},"38fd":function(t,e,n){var i=n("69a8"),r=n("4bf8"),o=n("613b")("IE_PROTO"),a=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=r(t),i(t,o)?t[o]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?a:null}},"3adc":function(t,e,n){var i=n("0f89"),r=n("a47f"),o=n("2ea1"),a=Object.defineProperty;e.f=n("7d95")?Object.defineProperty:function(t,e,n){if(i(t),e=o(e,!0),i(n),r)try{return a(t,e,n)}catch(c){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},"3b2b":function(t,e,n){var i=n("7726"),r=n("5dbc"),o=n("86cc").f,a=n("9093").f,c=n("aae3"),u=n("0bfb"),s=i.RegExp,f=s,h=s.prototype,l=/a/g,d=/a/g,p=new s(l)!==l;if(n("9e1e")&&(!p||n("79e5")((function(){return d[n("2b4c")("match")]=!1,s(l)!=l||s(d)==d||"/a/i"!=s(l,"i")})))){s=function(t,e){var n=this instanceof s,i=c(t),o=void 0===e;return!n&&i&&t.constructor===s&&o?t:r(p?new f(i&&!o?t.source:t,e):f((i=t instanceof s)?t.source:t,i&&o?u.call(t):e),n?this:h,s)};for(var m=function(t){t in s||o(s,t,{configurable:!0,get:function(){return f[t]},set:function(e){f[t]=e}})},g=a(f),v=0;g.length>v;)m(g[v++]);h.constructor=s,s.prototype=h,n("2aba")(i,"RegExp",s)}n("7a56")("RegExp")},"41a0":function(t,e,n){"use strict";var i=n("2aeb"),r=n("4630"),o=n("7f20"),a={};n("32e9")(a,n("2b4c")("iterator"),(function(){return this})),t.exports=function(t,e,n){t.prototype=i(a,{next:r(1,n)}),o(t,e+" Iterator")}},"43c8":function(t,e){var n={}.hasOwnProperty;t.exports=function(t,e){return n.call(t,e)}},"456d":function(t,e,n){var i=n("4bf8"),r=n("0d58");n("5eda")("keys",(function(){return function(t){return r(i(t))}}))},4588:function(t,e){var n=Math.ceil,i=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?i:n)(t)}},4630:function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},"4a59":function(t,e,n){var i=n("9b43"),r=n("1fa8"),o=n("33a4"),a=n("cb7c"),c=n("9def"),u=n("27ee"),s={},f={};e=t.exports=function(t,e,n,h,l){var d,p,m,g,v=l?function(){return t}:u(t),b=i(n,h,e?2:1),y=0;if("function"!=typeof v)throw TypeError(t+" is not iterable!");if(o(v)){for(d=c(t.length);d>y;y++)if(g=e?b(a(p=t[y])[0],p[1]):b(t[y]),g===s||g===f)return g}else for(m=v.call(t);!(p=m.next()).done;)if(g=r(m,b,p.value,e),g===s||g===f)return g};e.BREAK=s,e.RETURN=f},"4bf8":function(t,e,n){var i=n("be13");t.exports=function(t){return Object(i(t))}},"4f7f":function(t,e,n){"use strict";var i=n("c26b"),r=n("b39a"),o="Set";t.exports=n("e0b8")(o,(function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}}),{add:function(t){return i.def(r(this,o),t=0===t?0:t,t)}},i)},5147:function(t,e,n){var i=n("2b4c")("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(n){try{return e[i]=!1,!"/./"[t](e)}catch(r){}}return!0}},"52a7":function(t,e){e.f={}.propertyIsEnumerable},5537:function(t,e,n){var i=n("8378"),r=n("7726"),o="__core-js_shared__",a=r[o]||(r[o]={});(t.exports=function(t,e){return a[t]||(a[t]=void 0!==e?e:{})})("versions",[]).push({version:i.version,mode:n("2d00")?"pure":"global",copyright:"© 2018 Denis Pushkarev (zloirock.ru)"})},"58b2":function(t,e,n){var i=n("5ca1");i(i.S+i.F*!n("9e1e"),"Object",{defineProperties:n("1495")})},"5ca1":function(t,e,n){var i=n("7726"),r=n("8378"),o=n("32e9"),a=n("2aba"),c=n("9b43"),u="prototype",s=function(t,e,n){var f,h,l,d,p=t&s.F,m=t&s.G,g=t&s.S,v=t&s.P,b=t&s.B,y=m?i:g?i[e]||(i[e]={}):(i[e]||{})[u],x=m?r:r[e]||(r[e]={}),w=x[u]||(x[u]={});for(f in m&&(n=e),n)h=!p&&y&&void 0!==y[f],l=(h?y:n)[f],d=b&&h?c(l,i):v&&"function"==typeof l?c(Function.call,l):l,y&&a(y,f,l,t&s.U),x[f]!=l&&o(x,f,d),v&&w[f]!=l&&(w[f]=l)};i.core=r,s.F=1,s.G=2,s.S=4,s.P=8,s.B=16,s.W=32,s.U=64,s.R=128,t.exports=s},"5cc5":function(t,e,n){var i=n("2b4c")("iterator"),r=!1;try{var o=[7][i]();o["return"]=function(){r=!0},Array.from(o,(function(){throw 2}))}catch(a){}t.exports=function(t,e){if(!e&&!r)return!1;var n=!1;try{var o=[7],c=o[i]();c.next=function(){return{done:n=!0}},o[i]=function(){return c},t(o)}catch(a){}return n}},"5ce7":function(t,e,n){"use strict";var i=n("7108"),r=n("f845"),o=n("c0d8"),a={};n("8ce0")(a,n("1b55")("iterator"),(function(){return this})),t.exports=function(t,e,n){t.prototype=i(a,{next:r(1,n)}),o(t,e+" Iterator")}},"5d73":function(t,e,n){t.exports=n("0a91")},"5d8f":function(t,e,n){var i=n("7772")("keys"),r=n("7b00");t.exports=function(t){return i[t]||(i[t]=r(t))}},"5dbc":function(t,e,n){var i=n("d3f4"),r=n("8b97").set;t.exports=function(t,e,n){var o,a=e.constructor;return a!==n&&"function"==typeof a&&(o=a.prototype)!==n.prototype&&i(o)&&r&&r(t,o),t}},"5df3":function(t,e,n){"use strict";var i=n("02f4")(!0);n("01f9")(String,"String",(function(t){this._t=String(t),this._i=0}),(function(){var t,e=this._t,n=this._i;return n>=e.length?{value:void 0,done:!0}:(t=i(e,n),this._i+=t.length,{value:t,done:!1})}))},"5eda":function(t,e,n){var i=n("5ca1"),r=n("8378"),o=n("79e5");t.exports=function(t,e){var n=(r.Object||{})[t]||Object[t],a={};a[t]=e(n),i(i.S+i.F*o((function(){n(1)})),"Object",a)}},"613b":function(t,e,n){var i=n("5537")("keys"),r=n("ca5a");t.exports=function(t){return i[t]||(i[t]=r(t))}},"626a":function(t,e,n){var i=n("2d95");t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==i(t)?t.split(""):Object(t)}},6762:function(t,e,n){"use strict";var i=n("5ca1"),r=n("c366")(!0);i(i.P,"Array",{includes:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}}),n("9c6c")("includes")},"67ab":function(t,e,n){var i=n("ca5a")("meta"),r=n("d3f4"),o=n("69a8"),a=n("86cc").f,c=0,u=Object.isExtensible||function(){return!0},s=!n("79e5")((function(){return u(Object.preventExtensions({}))})),f=function(t){a(t,i,{value:{i:"O"+ ++c,w:{}}})},h=function(t,e){if(!r(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!o(t,i)){if(!u(t))return"F";if(!e)return"E";f(t)}return t[i].i},l=function(t,e){if(!o(t,i)){if(!u(t))return!0;if(!e)return!1;f(t)}return t[i].w},d=function(t){return s&&p.NEED&&u(t)&&!o(t,i)&&f(t),t},p=t.exports={KEY:i,NEED:!1,fastKey:h,getWeak:l,onFreeze:d}},6821:function(t,e,n){var i=n("626a"),r=n("be13");t.exports=function(t){return i(r(t))}},"69a8":function(t,e){var n={}.hasOwnProperty;t.exports=function(t,e){return n.call(t,e)}},"6a99":function(t,e,n){var i=n("d3f4");t.exports=function(t,e){if(!i(t))return t;var n,r;if(e&&"function"==typeof(n=t.toString)&&!i(r=n.call(t)))return r;if("function"==typeof(n=t.valueOf)&&!i(r=n.call(t)))return r;if(!e&&"function"==typeof(n=t.toString)&&!i(r=n.call(t)))return r;throw TypeError("Can't convert object to primitive value")}},"6a9b":function(t,e,n){var i=n("8bab"),r=n("e5fa");t.exports=function(t){return i(r(t))}},"6b54":function(t,e,n){"use strict";n("3846");var i=n("cb7c"),r=n("0bfb"),o=n("9e1e"),a="toString",c=/./[a],u=function(t){n("2aba")(RegExp.prototype,a,t,!0)};n("79e5")((function(){return"/a/b"!=c.call({source:"a",flags:"b"})}))?u((function(){var t=i(this);return"/".concat(t.source,"/","flags"in t?t.flags:!o&&t instanceof RegExp?r.call(t):void 0)})):c.name!=a&&u((function(){return c.call(this)}))},"6e1f":function(t,e){var n={}.toString;t.exports=function(t){return n.call(t).slice(8,-1)}},"6f42":function(t,e,n){},"6f8a":function(t,e){t.exports=function(t){return"object"===typeof t?null!==t:"function"===typeof t}},7108:function(t,e,n){var i=n("0f89"),r=n("f568"),o=n("0029"),a=n("5d8f")("IE_PROTO"),c=function(){},u="prototype",s=function(){var t,e=n("12fd")("iframe"),i=o.length,r="<",a=">";e.style.display="none",n("103a").appendChild(e),e.src="javascript:",t=e.contentWindow.document,t.open(),t.write(r+"script"+a+"document.F=Object"+r+"/script"+a),t.close(),s=t.F;while(i--)delete s[u][o[i]];return s()};t.exports=Object.create||function(t,e){var n;return null!==t?(c[u]=i(t),n=new c,c[u]=null,n[a]=t):n=s(),void 0===e?n:r(n,e)}},7514:function(t,e,n){"use strict";var i=n("5ca1"),r=n("0a49")(5),o="find",a=!0;o in[]&&Array(1)[o]((function(){a=!1})),i(i.P+i.F*a,"Array",{find:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}}),n("9c6c")(o)},7633:function(t,e,n){var i=n("2695"),r=n("0029");t.exports=Object.keys||function(t){return i(t,r)}},7726:function(t,e){var n=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},7772:function(t,e,n){var i=n("a7d3"),r=n("da3c"),o="__core-js_shared__",a=r[o]||(r[o]={});(t.exports=function(t,e){return a[t]||(a[t]=void 0!==e?e:{})})("versions",[]).push({version:i.version,mode:n("b457")?"pure":"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})},"77f1":function(t,e,n){var i=n("4588"),r=Math.max,o=Math.min;t.exports=function(t,e){return t=i(t),t<0?r(t+e,0):o(t,e)}},"79e5":function(t,e){t.exports=function(t){try{return!!t()}catch(e){return!0}}},"7a56":function(t,e,n){"use strict";var i=n("7726"),r=n("86cc"),o=n("9e1e"),a=n("2b4c")("species");t.exports=function(t){var e=i[t];o&&e&&!e[a]&&r.f(e,a,{configurable:!0,get:function(){return this}})}},"7b00":function(t,e){var n=0,i=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++n+i).toString(36))}},"7d8a":function(t,e,n){var i=n("6e1f"),r=n("1b55")("toStringTag"),o="Arguments"==i(function(){return arguments}()),a=function(t,e){try{return t[e]}catch(n){}};t.exports=function(t){var e,n,c;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=a(e=Object(t),r))?n:o?i(e):"Object"==(c=i(e))&&"function"==typeof e.callee?"Arguments":c}},"7d95":function(t,e,n){t.exports=!n("d782")((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},"7f20":function(t,e,n){var i=n("86cc").f,r=n("69a8"),o=n("2b4c")("toStringTag");t.exports=function(t,e,n){t&&!r(t=n?t:t.prototype,o)&&i(t,o,{configurable:!0,value:e})}},8378:function(t,e){var n=t.exports={version:"2.6.1"};"number"==typeof __e&&(__e=n)},"84f2":function(t,e){t.exports={}},"85f2":function(t,e,n){t.exports=n("ec5b")},"86cc":function(t,e,n){var i=n("cb7c"),r=n("c69a"),o=n("6a99"),a=Object.defineProperty;e.f=n("9e1e")?Object.defineProperty:function(t,e,n){if(i(t),e=o(e,!0),i(n),r)try{return a(t,e,n)}catch(c){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},"87b3":function(t,e,n){var i=Date.prototype,r="Invalid Date",o="toString",a=i[o],c=i.getTime;new Date(NaN)+""!=r&&n("2aba")(i,o,(function(){var t=c.call(this);return t===t?a.call(this):r}))},8875:function(t,e,n){var i,r,o;(function(n,a){r=[],i=a,o="function"===typeof i?i.apply(e,r):i,void 0===o||(t.exports=o)})("undefined"!==typeof self&&self,(function(){function t(){if(document.currentScript)return document.currentScript;try{throw new Error}catch(h){var t,e,n,i=/.*at [^(]*\((.*):(.+):(.+)\)$/gi,r=/@([^@]*):(\d+):(\d+)\s*$/gi,o=i.exec(h.stack)||r.exec(h.stack),a=o&&o[1]||!1,c=o&&o[2]||!1,u=document.location.href.replace(document.location.hash,""),s=document.getElementsByTagName("script");a===u&&(t=document.documentElement.outerHTML,e=new RegExp("(?:[^\\n]+?\\n){0,"+(c-2)+"}[^<]*<script>([\\d\\D]*?)<\\/script>[\\d\\D]*","i"),n=t.replace(e,"$1").trim());for(var f=0;f<s.length;f++){if("interactive"===s[f].readyState)return s[f];if(s[f].src===a)return s[f];if(a===u&&s[f].innerHTML&&s[f].innerHTML.trim()===n)return s[f]}return null}}return t}))},"89ca":function(t,e,n){n("b42c"),n("93c4"),t.exports=n("d38f")},"8b97":function(t,e,n){var i=n("d3f4"),r=n("cb7c"),o=function(t,e){if(r(t),!i(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,i){try{i=n("9b43")(Function.call,n("11e9").f(Object.prototype,"__proto__").set,2),i(t,[]),e=!(t instanceof Array)}catch(r){e=!0}return function(t,n){return o(t,n),e?t.__proto__=n:i(t,n),t}}({},!1):void 0),check:o}},"8bab":function(t,e,n){var i=n("6e1f");t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==i(t)?t.split(""):Object(t)}},"8ce0":function(t,e,n){var i=n("3adc"),r=n("f845");t.exports=n("7d95")?function(t,e,n){return i.f(t,e,r(1,n))}:function(t,e,n){return t[e]=n,t}},"8e6e":function(t,e,n){var i=n("5ca1"),r=n("990b"),o=n("6821"),a=n("11e9"),c=n("f1ae");i(i.S,"Object",{getOwnPropertyDescriptors:function(t){var e,n,i=o(t),u=a.f,s=r(i),f={},h=0;while(s.length>h)n=u(i,e=s[h++]),void 0!==n&&c(f,e,n);return f}})},9093:function(t,e,n){var i=n("ce10"),r=n("e11e").concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return i(t,r)}},"93c4":function(t,e,n){"use strict";var i=n("2a4e")(!0);n("e4a9")(String,"String",(function(t){this._t=String(t),this._i=0}),(function(){var t,e=this._t,n=this._i;return n>=e.length?{value:void 0,done:!0}:(t=i(e,n),this._i+=t.length,{value:t,done:!1})}))},"990b":function(t,e,n){var i=n("9093"),r=n("2621"),o=n("cb7c"),a=n("7726").Reflect;t.exports=a&&a.ownKeys||function(t){var e=i.f(o(t)),n=r.f;return n?e.concat(n(t)):e}},"9b43":function(t,e,n){var i=n("d8e8");t.exports=function(t,e,n){if(i(t),void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,i){return t.call(e,n,i)};case 3:return function(n,i,r){return t.call(e,n,i,r)}}return function(){return t.apply(e,arguments)}}},"9c6c":function(t,e,n){var i=n("2b4c")("unscopables"),r=Array.prototype;void 0==r[i]&&n("32e9")(r,i,{}),t.exports=function(t){r[i][t]=!0}},"9def":function(t,e,n){var i=n("4588"),r=Math.min;t.exports=function(t){return t>0?r(i(t),9007199254740991):0}},"9e1e":function(t,e,n){t.exports=!n("79e5")((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},a47f:function(t,e,n){t.exports=!n("7d95")&&!n("d782")((function(){return 7!=Object.defineProperty(n("12fd")("div"),"a",{get:function(){return 7}}).a}))},a5ab:function(t,e,n){var i=n("a812"),r=Math.min;t.exports=function(t){return t>0?r(i(t),9007199254740991):0}},a745:function(t,e,n){t.exports=n("d604")},a7d3:function(t,e){var n=t.exports={version:"2.6.9"};"number"==typeof __e&&(__e=n)},a812:function(t,e){var n=Math.ceil,i=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?i:n)(t)}},aa77:function(t,e,n){var i=n("5ca1"),r=n("be13"),o=n("79e5"),a=n("fdef"),c="["+a+"]",u="​",s=RegExp("^"+c+c+"*"),f=RegExp(c+c+"*$"),h=function(t,e,n){var r={},c=o((function(){return!!a[t]()||u[t]()!=u})),s=r[t]=c?e(l):a[t];n&&(r[n]=s),i(i.P+i.F*c,"String",r)},l=h.trim=function(t,e){return t=String(r(t)),1&e&&(t=t.replace(s,"")),2&e&&(t=t.replace(f,"")),t};t.exports=h},aae3:function(t,e,n){var i=n("d3f4"),r=n("2d95"),o=n("2b4c")("match");t.exports=function(t){var e;return i(t)&&(void 0!==(e=t[o])?!!e:"RegExp"==r(t))}},ac6a:function(t,e,n){for(var i=n("cadf"),r=n("0d58"),o=n("2aba"),a=n("7726"),c=n("32e9"),u=n("84f2"),s=n("2b4c"),f=s("iterator"),h=s("toStringTag"),l=u.Array,d={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},p=r(d),m=0;m<p.length;m++){var g,v=p[m],b=d[v],y=a[v],x=y&&y.prototype;if(x&&(x[f]||c(x,f,l),x[h]||c(x,h,v),u[v]=l,b))for(g in i)x[g]||o(x,g,i[g],!0)}},b22a:function(t,e){t.exports={}},b39a:function(t,e,n){var i=n("d3f4");t.exports=function(t,e){if(!i(t)||t._t!==e)throw TypeError("Incompatible receiver, "+e+" required!");return t}},b3e7:function(t,e){t.exports=function(){}},b42c:function(t,e,n){n("fa54");for(var i=n("da3c"),r=n("8ce0"),o=n("b22a"),a=n("1b55")("toStringTag"),c="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),u=0;u<c.length;u++){var s=c[u],f=i[s],h=f&&f.prototype;h&&!h[a]&&r(h,a,s),o[s]=o.Array}},b457:function(t,e){t.exports=!0},b5aa:function(t,e,n){var i=n("6e1f");t.exports=Array.isArray||function(t){return"Array"==i(t)}},b635:function(t,e,n){"use strict";(function(t){n.d(e,"b",(function(){return r}));n("6f42");var i=n("3425");function r(t){r.installed||(r.installed=!0,t.component("VueDraggableResizable",i["a"]))}var o={install:r},a=null;"undefined"!==typeof window?a=window.Vue:"undefined"!==typeof t&&(a=t.Vue),a&&a.use(o),e["a"]=i["a"]}).call(this,n("c8ba"))},b77f:function(t,e,n){var i=n("0f89"),r=n("f159");t.exports=n("a7d3").getIterator=function(t){var e=r(t);if("function"!=typeof e)throw TypeError(t+" is not iterable!");return i(e.call(t))}},bc25:function(t,e,n){var i=n("f2fe");t.exports=function(t,e,n){if(i(t),void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,i){return t.call(e,n,i)};case 3:return function(n,i,r){return t.call(e,n,i,r)}}return function(){return t.apply(e,arguments)}}},be13:function(t,e){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},c0d8:function(t,e,n){var i=n("3adc").f,r=n("43c8"),o=n("1b55")("toStringTag");t.exports=function(t,e,n){t&&!r(t=n?t:t.prototype,o)&&i(t,o,{configurable:!0,value:e})}},c26b:function(t,e,n){"use strict";var i=n("86cc").f,r=n("2aeb"),o=n("dcbc"),a=n("9b43"),c=n("f605"),u=n("4a59"),s=n("01f9"),f=n("d53b"),h=n("7a56"),l=n("9e1e"),d=n("67ab").fastKey,p=n("b39a"),m=l?"_s":"size",g=function(t,e){var n,i=d(e);if("F"!==i)return t._i[i];for(n=t._f;n;n=n.n)if(n.k==e)return n};t.exports={getConstructor:function(t,e,n,s){var f=t((function(t,i){c(t,f,e,"_i"),t._t=e,t._i=r(null),t._f=void 0,t._l=void 0,t[m]=0,void 0!=i&&u(i,n,t[s],t)}));return o(f.prototype,{clear:function(){for(var t=p(this,e),n=t._i,i=t._f;i;i=i.n)i.r=!0,i.p&&(i.p=i.p.n=void 0),delete n[i.i];t._f=t._l=void 0,t[m]=0},delete:function(t){var n=p(this,e),i=g(n,t);if(i){var r=i.n,o=i.p;delete n._i[i.i],i.r=!0,o&&(o.n=r),r&&(r.p=o),n._f==i&&(n._f=r),n._l==i&&(n._l=o),n[m]--}return!!i},forEach:function(t){p(this,e);var n,i=a(t,arguments.length>1?arguments[1]:void 0,3);while(n=n?n.n:this._f){i(n.v,n.k,this);while(n&&n.r)n=n.p}},has:function(t){return!!g(p(this,e),t)}}),l&&i(f.prototype,"size",{get:function(){return p(this,e)[m]}}),f},def:function(t,e,n){var i,r,o=g(t,e);return o?o.v=n:(t._l=o={i:r=d(e,!0),k:e,v:n,p:i=t._l,n:void 0,r:!1},t._f||(t._f=o),i&&(i.n=o),t[m]++,"F"!==r&&(t._i[r]=o)),t},getEntry:g,setStrong:function(t,e,n){s(t,e,(function(t,n){this._t=p(t,e),this._k=n,this._l=void 0}),(function(){var t=this,e=t._k,n=t._l;while(n&&n.r)n=n.p;return t._t&&(t._l=n=n?n.n:t._t._f)?f(0,"keys"==e?n.k:"values"==e?n.v:[n.k,n.v]):(t._t=void 0,f(1))}),n?"entries":"values",!n,!0),h(e)}}},c366:function(t,e,n){var i=n("6821"),r=n("9def"),o=n("77f1");t.exports=function(t){return function(e,n,a){var c,u=i(e),s=r(u.length),f=o(a,s);if(t&&n!=n){while(s>f)if(c=u[f++],c!=c)return!0}else for(;s>f;f++)if((t||f in u)&&u[f]===n)return t||f||0;return!t&&-1}}},c5f6:function(t,e,n){"use strict";var i=n("7726"),r=n("69a8"),o=n("2d95"),a=n("5dbc"),c=n("6a99"),u=n("79e5"),s=n("9093").f,f=n("11e9").f,h=n("86cc").f,l=n("aa77").trim,d="Number",p=i[d],m=p,g=p.prototype,v=o(n("2aeb")(g))==d,b="trim"in String.prototype,y=function(t){var e=c(t,!1);if("string"==typeof e&&e.length>2){e=b?e.trim():l(e,3);var n,i,r,o=e.charCodeAt(0);if(43===o||45===o){if(n=e.charCodeAt(2),88===n||120===n)return NaN}else if(48===o){switch(e.charCodeAt(1)){case 66:case 98:i=2,r=49;break;case 79:case 111:i=8,r=55;break;default:return+e}for(var a,u=e.slice(2),s=0,f=u.length;s<f;s++)if(a=u.charCodeAt(s),a<48||a>r)return NaN;return parseInt(u,i)}}return+e};if(!p(" 0o1")||!p("0b1")||p("+0x1")){p=function(t){var e=arguments.length<1?0:t,n=this;return n instanceof p&&(v?u((function(){g.valueOf.call(n)})):o(n)!=d)?a(new m(y(e)),n,p):y(e)};for(var x,w=n("9e1e")?s(m):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),S=0;w.length>S;S++)r(m,x=w[S])&&!r(p,x)&&h(p,x,f(m,x));p.prototype=g,g.constructor=p,n("2aba")(i,d,p)}},c69a:function(t,e,n){t.exports=!n("9e1e")&&!n("79e5")((function(){return 7!=Object.defineProperty(n("230e")("div"),"a",{get:function(){return 7}}).a}))},c8ba:function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(i){"object"===typeof window&&(n=window)}t.exports=n},c8bb:function(t,e,n){t.exports=n("89ca")},ca5a:function(t,e){var n=0,i=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++n+i).toString(36))}},cadf:function(t,e,n){"use strict";var i=n("9c6c"),r=n("d53b"),o=n("84f2"),a=n("6821");t.exports=n("01f9")(Array,"Array",(function(t,e){this._t=a(t),this._i=0,this._k=e}),(function(){var t=this._t,e=this._k,n=this._i++;return!t||n>=t.length?(this._t=void 0,r(1)):r(0,"keys"==e?n:"values"==e?t[n]:[n,t[n]])}),"values"),o.Arguments=o.Array,i("keys"),i("values"),i("entries")},cb7c:function(t,e,n){var i=n("d3f4");t.exports=function(t){if(!i(t))throw TypeError(t+" is not an object!");return t}},cd1c:function(t,e,n){var i=n("e853");t.exports=function(t,e){return new(i(t))(e)}},ce10:function(t,e,n){var i=n("69a8"),r=n("6821"),o=n("c366")(!1),a=n("613b")("IE_PROTO");t.exports=function(t,e){var n,c=r(t),u=0,s=[];for(n in c)n!=a&&i(c,n)&&s.push(n);while(e.length>u)i(c,n=e[u++])&&(~o(s,n)||s.push(n));return s}},d13f:function(t,e,n){var i=n("da3c"),r=n("a7d3"),o=n("bc25"),a=n("8ce0"),c=n("43c8"),u="prototype",s=function(t,e,n){var f,h,l,d=t&s.F,p=t&s.G,m=t&s.S,g=t&s.P,v=t&s.B,b=t&s.W,y=p?r:r[e]||(r[e]={}),x=y[u],w=p?i:m?i[e]:(i[e]||{})[u];for(f in p&&(n=e),n)h=!d&&w&&void 0!==w[f],h&&c(y,f)||(l=h?w[f]:n[f],y[f]=p&&"function"!=typeof w[f]?n[f]:v&&h?o(l,i):b&&w[f]==l?function(t){var e=function(e,n,i){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(e);case 2:return new t(e,n)}return new t(e,n,i)}return t.apply(this,arguments)};return e[u]=t[u],e}(l):g&&"function"==typeof l?o(Function.call,l):l,g&&((y.virtual||(y.virtual={}))[f]=l,t&s.R&&x&&!x[f]&&a(x,f,l)))};s.F=1,s.G=2,s.S=4,s.P=8,s.B=16,s.W=32,s.U=64,s.R=128,t.exports=s},d25f:function(t,e,n){"use strict";var i=n("5ca1"),r=n("0a49")(2);i(i.P+i.F*!n("2f21")([].filter,!0),"Array",{filter:function(t){return r(this,t,arguments[1])}})},d2c8:function(t,e,n){var i=n("aae3"),r=n("be13");t.exports=function(t,e,n){if(i(e))throw TypeError("String#"+n+" doesn't accept regex!");return String(r(t))}},d38f:function(t,e,n){var i=n("7d8a"),r=n("1b55")("iterator"),o=n("b22a");t.exports=n("a7d3").isIterable=function(t){var e=Object(t);return void 0!==e[r]||"@@iterator"in e||o.hasOwnProperty(i(e))}},d3f4:function(t,e){t.exports=function(t){return"object"===typeof t?null!==t:"function"===typeof t}},d53b:function(t,e){t.exports=function(t,e){return{value:e,done:!!t}}},d604:function(t,e,n){n("1938"),t.exports=n("a7d3").Array.isArray},d782:function(t,e){t.exports=function(t){try{return!!t()}catch(e){return!0}}},d8e8:function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},da3c:function(t,e){var n=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},dcbc:function(t,e,n){var i=n("2aba");t.exports=function(t,e,n){for(var r in e)i(t,r,e[r],n);return t}},e0b8:function(t,e,n){"use strict";var i=n("7726"),r=n("5ca1"),o=n("2aba"),a=n("dcbc"),c=n("67ab"),u=n("4a59"),s=n("f605"),f=n("d3f4"),h=n("79e5"),l=n("5cc5"),d=n("7f20"),p=n("5dbc");t.exports=function(t,e,n,m,g,v){var b=i[t],y=b,x=g?"set":"add",w=y&&y.prototype,S={},_=function(t){var e=w[t];o(w,t,"delete"==t||"has"==t?function(t){return!(v&&!f(t))&&e.call(this,0===t?0:t)}:"get"==t?function(t){return v&&!f(t)?void 0:e.call(this,0===t?0:t)}:"add"==t?function(t){return e.call(this,0===t?0:t),this}:function(t,n){return e.call(this,0===t?0:t,n),this})};if("function"==typeof y&&(v||w.forEach&&!h((function(){(new y).entries().next()})))){var O=new y,E=O[x](v?{}:-0,1)!=O,T=h((function(){O.has(1)})),P=l((function(t){new y(t)})),L=!v&&h((function(){var t=new y,e=5;while(e--)t[x](e,e);return!t.has(-0)}));P||(y=e((function(e,n){s(e,y,t);var i=p(new b,e,y);return void 0!=n&&u(n,g,i[x],i),i})),y.prototype=w,w.constructor=y),(T||L)&&(_("delete"),_("has"),g&&_("get")),(L||E)&&_(x),v&&w.clear&&delete w.clear}else y=m.getConstructor(e,t,g,x),a(y.prototype,n),c.NEED=!0;return d(y,t),S[t]=y,r(r.G+r.W+r.F*(y!=b),S),v||m.setStrong(y,t,g),y}},e11e:function(t,e){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},e341:function(t,e,n){var i=n("d13f");i(i.S+i.F*!n("7d95"),"Object",{defineProperty:n("3adc").f})},e4a9:function(t,e,n){"use strict";var i=n("b457"),r=n("d13f"),o=n("2312"),a=n("8ce0"),c=n("b22a"),u=n("5ce7"),s=n("c0d8"),f=n("ff0c"),h=n("1b55")("iterator"),l=!([].keys&&"next"in[].keys()),d="@@iterator",p="keys",m="values",g=function(){return this};t.exports=function(t,e,n,v,b,y,x){u(n,e,v);var w,S,_,O=function(t){if(!l&&t in L)return L[t];switch(t){case p:return function(){return new n(this,t)};case m:return function(){return new n(this,t)}}return function(){return new n(this,t)}},E=e+" Iterator",T=b==m,P=!1,L=t.prototype,M=L[h]||L[d]||b&&L[b],R=M||O(b),j=b?T?O("entries"):R:void 0,A="Array"==e&&L.entries||M;if(A&&(_=f(A.call(new t)),_!==Object.prototype&&_.next&&(s(_,E,!0),i||"function"==typeof _[h]||a(_,h,g))),T&&M&&M.name!==m&&(P=!0,R=function(){return M.call(this)}),i&&!x||!l&&!P&&L[h]||a(L,h,R),c[e]=R,c[E]=g,b)if(w={values:T?R:O(m),keys:y?R:O(p),entries:j},x)for(S in w)S in L||o(L,S,w[S]);else r(r.P+r.F*(l||P),e,w);return w}},e5fa:function(t,e){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},e853:function(t,e,n){var i=n("d3f4"),r=n("1169"),o=n("2b4c")("species");t.exports=function(t){var e;return r(t)&&(e=t.constructor,"function"!=typeof e||e!==Array&&!r(e.prototype)||(e=void 0),i(e)&&(e=e[o],null===e&&(e=void 0))),void 0===e?Array:e}},ec5b:function(t,e,n){n("e341");var i=n("a7d3").Object;t.exports=function(t,e,n){return i.defineProperty(t,e,n)}},f159:function(t,e,n){var i=n("7d8a"),r=n("1b55")("iterator"),o=n("b22a");t.exports=n("a7d3").getIteratorMethod=function(t){if(void 0!=t)return t[r]||t["@@iterator"]||o[i(t)]}},f1ae:function(t,e,n){"use strict";var i=n("86cc"),r=n("4630");t.exports=function(t,e,n){e in t?i.f(t,e,r(0,n)):t[e]=n}},f2fe:function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},f3e2:function(t,e,n){"use strict";var i=n("5ca1"),r=n("0a49")(0),o=n("2f21")([].forEach,!0);i(i.P+i.F*!o,"Array",{forEach:function(t){return r(this,t,arguments[1])}})},f568:function(t,e,n){var i=n("3adc"),r=n("0f89"),o=n("7633");t.exports=n("7d95")?Object.defineProperties:function(t,e){r(t);var n,a=o(e),c=a.length,u=0;while(c>u)i.f(t,n=a[u++],e[n]);return t}},f605:function(t,e){t.exports=function(t,e,n,i){if(!(t instanceof e)||void 0!==i&&i in t)throw TypeError(n+": incorrect invocation!");return t}},f845:function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},fa54:function(t,e,n){"use strict";var i=n("b3e7"),r=n("245b"),o=n("b22a"),a=n("6a9b");t.exports=n("e4a9")(Array,"Array",(function(t,e){this._t=a(t),this._i=0,this._k=e}),(function(){var t=this._t,e=this._k,n=this._i++;return!t||n>=t.length?(this._t=void 0,r(1)):r(0,"keys"==e?n:"values"==e?t[n]:[n,t[n]])}),"values"),o.Arguments=o.Array,i("keys"),i("values"),i("entries")},fab2:function(t,e,n){var i=n("7726").document;t.exports=i&&i.documentElement},fb15:function(t,e,n){"use strict";if(n.r(e),n.d(e,"install",(function(){return a["b"]})),"undefined"!==typeof window){var i=window.document.currentScript,r=n("8875");i=r(),"currentScript"in document||Object.defineProperty(document,"currentScript",{get:r});var o=i&&i.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);o&&(n.p=o[1])}var a=n("b635");e["default"]=a["a"]},fdef:function(t,e){t.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},ff0c:function(t,e,n){var i=n("43c8"),r=n("0185"),o=n("5d8f")("IE_PROTO"),a=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=r(t),i(t,o)?t[o]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?a:null}}})["default"]}));
//# sourceMappingURL=VueDraggableResizable.umd.min.js.map

/***/ }),

/***/ "fb2c":
/***/ (function(module, exports, __webpack_require__) {

var createTypedArrayConstructor = __webpack_require__("74e8");

// `Uint32Array` constructor
// https://tc39.es/ecma262/#sec-typedarray-objects
createTypedArrayConstructor('Uint32', function (init) {
  return function Uint32Array(data, byteOffset, length) {
    return init(this, data, byteOffset, length);
  };
});


/***/ }),

/***/ "fb6a":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var $ = __webpack_require__("23e7");
var global = __webpack_require__("da84");
var isArray = __webpack_require__("e8b5");
var isConstructor = __webpack_require__("68ee");
var isObject = __webpack_require__("861d");
var toAbsoluteIndex = __webpack_require__("23cb");
var lengthOfArrayLike = __webpack_require__("07fa");
var toIndexedObject = __webpack_require__("fc6a");
var createProperty = __webpack_require__("8418");
var wellKnownSymbol = __webpack_require__("b622");
var arrayMethodHasSpeciesSupport = __webpack_require__("1dde");
var un$Slice = __webpack_require__("f36a");

var HAS_SPECIES_SUPPORT = arrayMethodHasSpeciesSupport('slice');

var SPECIES = wellKnownSymbol('species');
var Array = global.Array;
var max = Math.max;

// `Array.prototype.slice` method
// https://tc39.es/ecma262/#sec-array.prototype.slice
// fallback for not array-like ES3 strings and DOM objects
$({ target: 'Array', proto: true, forced: !HAS_SPECIES_SUPPORT }, {
  slice: function slice(start, end) {
    var O = toIndexedObject(this);
    var length = lengthOfArrayLike(O);
    var k = toAbsoluteIndex(start, length);
    var fin = toAbsoluteIndex(end === undefined ? length : end, length);
    // inline `ArraySpeciesCreate` for usage native `Array#slice` where it's possible
    var Constructor, result, n;
    if (isArray(O)) {
      Constructor = O.constructor;
      // cross-realm fallback
      if (isConstructor(Constructor) && (Constructor === Array || isArray(Constructor.prototype))) {
        Constructor = undefined;
      } else if (isObject(Constructor)) {
        Constructor = Constructor[SPECIES];
        if (Constructor === null) Constructor = undefined;
      }
      if (Constructor === Array || Constructor === undefined) {
        return un$Slice(O, k, fin);
      }
    }
    result = new (Constructor === undefined ? Array : Constructor)(max(fin - k, 0));
    for (n = 0; k < fin; k++, n++) if (k in O) createProperty(result, n, O[k]);
    result.length = n;
    return result;
  }
});


/***/ }),

/***/ "fc6a":
/***/ (function(module, exports, __webpack_require__) {

// toObject with fallback for non-array-like ES3 strings
var IndexedObject = __webpack_require__("44ad");
var requireObjectCoercible = __webpack_require__("1d80");

module.exports = function (it) {
  return IndexedObject(requireObjectCoercible(it));
};


/***/ }),

/***/ "fce3":
/***/ (function(module, exports, __webpack_require__) {

var fails = __webpack_require__("d039");
var global = __webpack_require__("da84");

// babel-minify and Closure Compiler transpiles RegExp('.', 's') -> /./s and it causes SyntaxError
var $RegExp = global.RegExp;

module.exports = fails(function () {
  var re = $RegExp('.', 's');
  return !(re.dotAll && re.exec('\n') && re.flags === 's');
});


/***/ }),

/***/ "fdbc":
/***/ (function(module, exports) {

// iterable DOM collections
// flag - `iterable` interface - 'entries', 'keys', 'values', 'forEach' methods
module.exports = {
  CSSRuleList: 0,
  CSSStyleDeclaration: 0,
  CSSValueList: 0,
  ClientRectList: 0,
  DOMRectList: 0,
  DOMStringList: 0,
  DOMTokenList: 1,
  DataTransferItemList: 0,
  FileList: 0,
  HTMLAllCollection: 0,
  HTMLCollection: 0,
  HTMLFormElement: 0,
  HTMLSelectElement: 0,
  MediaList: 0,
  MimeTypeArray: 0,
  NamedNodeMap: 0,
  NodeList: 1,
  PaintRequestList: 0,
  Plugin: 0,
  PluginArray: 0,
  SVGLengthList: 0,
  SVGNumberList: 0,
  SVGPathSegList: 0,
  SVGPointList: 0,
  SVGStringList: 0,
  SVGTransformList: 0,
  SourceBufferList: 0,
  StyleSheetList: 0,
  TextTrackCueList: 0,
  TextTrackList: 0,
  TouchList: 0
};


/***/ }),

/***/ "fdbf":
/***/ (function(module, exports, __webpack_require__) {

/* eslint-disable es/no-symbol -- required for testing */
var NATIVE_SYMBOL = __webpack_require__("4930");

module.exports = NATIVE_SYMBOL
  && !Symbol.sham
  && typeof Symbol.iterator == 'symbol';


/***/ }),

/***/ "fea9":
/***/ (function(module, exports, __webpack_require__) {

var global = __webpack_require__("da84");

module.exports = global.Promise;


/***/ })

/******/ });
});