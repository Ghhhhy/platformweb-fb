#### 1.1 spread-sheet 整体参数说明

```
[
    {
        "name": "sheetName",
        "color": "",
        "freeze": "A1",
        "styles": [
            {
                "border": {
                    "bottom": [
                        "thick",
                        "#000"
                    ]
                },
                "color": "#ddd",
                "bgColor": "#eee",
                "font": {
                    "italic": true,
                    "size": 16,
                    "name": "YaHei",
                    "bold": true
                },
                "underline": true,
                "valign": "middle",
                "align": "center"
            }
        ],
        "merges": [],
        "rows": {
            "1": {
                "cells": {
                    "2": {
                        "text": "3",
                        "printable": false,
                        "editable": true,
                        "style": 0
                    }
                },
                "height": 43,
                "renderType": "header",
                "hidden": true
            },
            "len": 100
        },
        "cols": {
            "len": 26
        },
        "validations": [],
        "autofilter": {},
        "row": {
            "len": 100,
            "height": 18,
            "indexHeight": 18
        },
        "col": {
            "len": 26,
            "width": 100,
            "indexWidth": 60,
            "minWidth": 60
        },
        "showGrid": true,
        "comments": {},
        "formConfig": {},
        "rectConfig": {}
    }
]
```

| 字段名1级         | 字段名2级   | 注释                                   | 数据类型 | 客户端使用 | 必传 | 默认值    | 取值范围                               | 说明                 |
| ----------------- | ----------- | -------------------------------------- | -------- | ---------- | ---- | --------- | -------------------------------------- | -------------------- |
| mode              |             | 只读/编辑 模式切换                     | string   | N          | Y    | edit      | read/edit                              |                      |
| isAddHistory      |             | 是否记录操作历史记录                   | boolean  | N          | N    | ture      | true/false                             |                      |
| showToolbar       |             | 工具栏的显示状态                       | boolean  | N          | N    | ture      | true/false                             |                      |
| showBottomBar     |             | 底部工具栏                             | boolean  | N          | N    | ture      | true/false                             |                      |
| showContextmenu   |             | 右键菜单                               | boolean  | N          | N    | ture      | true/false                             |                      |
| showIdentifier    |             | 是否显示行列标识                       | boolean  | N          | N    | ture      | true/false                             |                      |
| minContent        |             | 是否内容最小化现实并居中               | boolean  | N          | N    | ture      | true/false                             | 用于单表             |
| showRowRenderType |             | 显示渲染行标识                         | string   | N          | N    | none      | operate //操作 icon//图标 none//不显示 | 用于填报、设计器     |
| name              |             | sheet名称                              | string   | Y          | Y    | sheetName |                                        |                      |
| freeze            |             | 冻结单元格                             | string   | Y          | Y    | A1        |                                        |                      |
| showGrid          |             | 内容区域网格显示状态                   | boolean  | Y          | Y    | ture      | true/false                             |                      |
| row               |             | 默认行的高度/默认展示数量/标识符默认高 | object   | Y          | Y    |           |                                        |                      |
|                   | len         | 默认展示数量                           | number   | N          | Y    | 100       |                                        |                      |
|                   | height      | 默认行的高度                           | number   | Y          | Y    | 18        |                                        |                      |
|                   | indexHeight | 标识符默认高                           | number   | Y          | Y    | 18        |                                        |                      |
| col               |             | 默认列的宽度/默认展示数量/标识符默认宽 | object   | Y          | Y    |           |                                        |                      |
|                   | len         | 调整默认显示的列数                     | number   | N          | Y    | 26        |                                        |                      |
|                   | width       | 默认每个列的宽度                       | number   | Y          | Y    | 100       |                                        |                      |
|                   | indexWidth  | 序列栏默认宽度                         | number   | Y          | Y    | 100       |                                        |                      |
|                   | minWidth    | 每个列默认最小宽度                     | number   | Y          | Y    | 60        |                                        |                      |
| styles            |             | 单元格样式配置                         | array    | Y          | Y    |           |                                        | 详细见Styles表格     |
| merges            |             | 合并单元格选区标识                     | array    | N          | Y    |           |                                        | 如["C3:D7"]          |
| rows              |             | 单元格数据结构、行数、合并             | object   | Y          | Y    |           |                                        | 详细见rows表格       |
| cols              |             | 单元列宽度、列数                       | object   | Y          | Y    |           |                                        | 详细见cols表格       |
| formconfig        |             | 单元格字段配置                         | object   | Y          | Y    |           |                                        | 详细见formconfig表格 |
| rectConfig        |             | 多表联合                               | object   | Y          | Y    |           |                                        | 详细见rectConfig表格 |
| validations       |             |                                        |          |            | Y    |           |                                        | 开发中               |
| autofilter        |             |                                        |          |            | Y    |           |                                        | 开发中               |
| comments          |             |                                        |          |            | Y    |           |                                        | 开发中               |

#### 1.2 styles 单元格样式说明

```
[
    {
        "border": {
            "bottom": [
                "thick",
                "#000"
            ],
            "top": [
                "thick",
                "#000"
            ],
            "right": [
                "thick",
                "#000"
            ],
            "left": [
                "thick",
                "#000"
            ]
        },
        "color": "#ddd",
        "bgColor": "#eee",
        "font": {
            "italic": true,
            "size": 16,
            "name": "YaHei",
            "bold": true
        },
        "underline": true,
        "valign": "middle",
        "align": "center"
    }
]
```

| 字段名1级 | 字段名2级 | 注释         | 数据类型           | 客户端使用 | 必传 | 默认值  | 取值范围                                                     | 说明                                                         |
| --------- | --------- | ------------ | ------------------ | ---------- | ---- | ------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
|           |           |              | string             | Y          | N    |         |                                                              |                                                              |
| color     |           | 字体颜色     | string             | Y          | N    | #0a0a0a | #hex                                                         |                                                              |
| font      |           | 字体         | string             | Y          | N    | 宋体    | 宋体、 黑体、 仿宋、 楷体、 隶书、 华文中宋、 华文行楷、 Microsoft YaHei、 Arial、 Helvetica、 Hiragino、 Source Sans Pro、 Comic Sans MS、 Courier New、 Verdana、 Lato |                                                              |
| underline |           | 是否有下划线 | boolean            | Y          | N    |         | true/false                                                   |                                                              |
| strike    |           | 是否中划线   | boolean            | Y          | N    |         | true/false                                                   |                                                              |
| valign    |           | 垂直对齐方式 | string             | Y          | N    | middle  | bottom//下对齐 middle //居中 top //上对齐                    |                                                              |
| align     |           | 水平对齐方式 | string             | Y          | N    | left    | center//居中left//左对齐right//右对齐                        |                                                              |
| textwrap  |           | 是否换行     | boolean            | Y          | N    |         | true/false                                                   |                                                              |
| size      |           | 字体大小     | number             | Y          | N    | 10      |                                                              |                                                              |
| format    |           | 单元格式     | string/json string | Y          | N    | normal  | normal//常规 text//文本 number//数值 percent//百分比 rmb//人民币 usd//美元 eur//欧元 time//时间 date//短日期 datelong//长日期 datetime//日期+时间 duration//持续时间 transparent//隐藏' | 1. 单元格格式支持亿元  f: 'normal', //format p: 2, //precision is: false, //isSeparator u: '', //unit iu: false, //isUnit div: 10000 //'1'元\|'10000'万\|'100000000'亿元                2.数值为零隐藏格子 f: 'transparent', //format val: 0, // 预留 始终为0 en: false // 是否开启为零时显示为空 |
| border    |           | 单元格边框   | object             | Y          | N    |         |                                                              |                                                              |
|           | bottom    | 下边框       | array              | Y          | N    |         | ['thick '#hex'] //solid 3px #hex ['thin'#hex'] //solid 1px #hex ['medium '#hex'] //solid 2px #hex ['dashed '#hex'] //dashed 1px #hex ['dotted '#hex'] //dotted 1px #hex ['double '#hex'] //double 1px #hex |                                                              |
|           | top       | 上边框       | array              | Y          | N    |         | 同上                                                         |                                                              |
|           | right     | 右边框       | array              | Y          | N    |         | 同上                                                         |                                                              |
|           | left      | 左边框       | array              | Y          | N    |         | 同上                                                         |                                                              |

#### 1.2 rows 单元所有数据主体说明

```
{
    "rows": {
        "1": {
            "cells": {
                "2": {
                    "text": "3",
                    "printable": false,
                    "editable": true,
                    "style": 0,
                    "merge":[1,1]
                }
            },
             "height": 43,
             renderType:"header",
             hidden:true
             
        },
        "len": 100
    }
}
```



| 字段名1级  | 字段名2级 | 字段名3级 | 字段名4级 | 注释                      | 数据类型 | 客户端使用 | 必传 | 默认值 | 取值范围                                         | 说明                 |
| ---------- | --------- | --------- | --------- | ------------------------- | -------- | ---------- | ---- | ------ | ------------------------------------------------ | -------------------- |
| 行号0...   |           |           |           | 行号如 0,1,2,3,5          | string   | Y          | N    | edit   | read/edit                                        |                      |
|            | cells     |           |           | 该行所有列                | boolean  | Y          | N    | ture   | true/false                                       |                      |
|            |           | 列号0...  |           | 列号如 0，1,2,3,5         | boolean  | Y          | N    | ture   | true/false                                       |                      |
|            |           |           | text      | 单元格内容                | string   | Y          | N    | ture   | true/false                                       |                      |
|            |           |           | editable  | 单元格是否可编辑          | boolean  | Y          | N    | ture   | true/false                                       |                      |
|            |           |           | style     | 单元格样式对应 styles索引 | number   | Y          | N    |        |                                                  |                      |
|            |           |           | printable | 单元格是否可打印          | boolean  | Y          | N    | ture   | true/false                                       |                      |
|            |           |           | merge     | 单元格合并                | array    | Y          | N    |        |                                                  | 如[1,1]合并一行 一列 |
| len        |           |           |           | 该sheet行数               | number   | Y          | N    | 100    |                                                  |                      |
| hidden     |           |           |           | 该行是否隐藏              | boolean  | Y          | N    |        |                                                  |                      |
| renderType |           |           |           | 行类型                    | string   | Y          | N    |        | dataRegion//数据区 header//报表头 footer//报表尾 |                      |
| height     |           |           |           | 当前行高度                | number   | Y          | N    |        |                                                  |                      |

#### 1.3 cols 单元格列宽度

```
{
    "cols": {
        "2": {
            "width": 198
        },
        "len": 26,
        hidden:true
    }
}
```

| 字段名1级 | 字段名2级 | 注释             | 数据类型 | 客户端使用 | 必传 | 默认值 | 取值范围 | 说明 |
| --------- | --------- | ---------------- | -------- | ---------- | ---- | ------ | -------- | ---- |
| 列号0...  |           | 列号如 0,1,2,3,5 | string   | Y          | N    |        |          |      |
|           | width     | 该列宽度         | number   | Y          | N    |        |          |      |
| len       |           | 该sheet列数      | number   | Y          | N    | 26     |          |      |
| hidden    |           | 该行是否隐藏     | boolean  | Y          | N    |        |          |      |

#### 1.4 rectConfig 多表联合配置

```
{
    "rectConfig": {
        "A3:B7": {
            "ROWS": {
                "2": "header",
                "5": "dataRegion",
                "6": "dataRegion"
            }
        },
        "C3:D7": {
            "ROWS": {
                "2": "header",
                "5": "dataRegion",
                "6": "dataRegion"
            }
        },
        "A8:D11": {
            "ROWS": {}
        },
        "A1:D2": {
            "ROWS": {}
        }
    }
}
```

| 字段名1级 | 字段名2级 | 字段名2级 | 注释                  | 数据类型 | 客户端使用 | 必传 | 默认值 | 取值范围                                         | 说明 |
| --------- | --------- | --------- | --------------------- | -------- | ---------- | ---- | ------ | ------------------------------------------------ | ---- |
| 区域标识  |           |           | 划分区域标识如：A3:B7 | array    | Y          | N    |        |                                                  |      |
|           | ROWS      |           | 行                    | 所有行   | Y          | N    |        |                                                  |      |
|           |           | 行标识0.. | 该行号如 0,1,2,3,5    | number   | Y          | N    |        | dataRegion//数据区 header//报表头 footer//报表尾 |      |

##  公式审核接口&数据定义

1. 基本数据结构

```json
[
  {
    "name": "sheet1",
    "color": "",
    "freeze": "A1",
    "styles": [],
    "merges": [],
    "rows": { "len": 100 },
    "cols": { "len": 26 },
    "examines": [
      { "ref": "AL001", "mode": "error", "ruler": "A1=A2", "message": "A1=A2" },
      { "ref": "AL002", "mode": "warn", "ruler": "IF(A3=3,A4=3)", "message": "当报表类型＝“3”（行政单位汇总录入表），则单位基本性质＝“10”（行政单位）" }
        
    ],
    "autofilter": {},
    "row": { "len": 100, "height": 18, "indexHeight": 18 },
    "col": { "len": 26, "width": 100, "indexWidth": 60, "minWidth": 60 },
    "showGrid": true,
    "comments": {},
    "permissionConfigs": [],
    "queryConfigs": [],
    "formConfig": {},
    "rectConfig": {}
  }
]
```
### examines
2.API

| 接口名称          | 注入参                                                       | 出参                                                         | 说明                    |
| ----------------- | ------------------------------------------------------------ | ------------------------------------------------------------ | ----------------------- |
| setData(examines) | [ { "ref": "AL001", "mode": "error", "ruler": "A1=A2", "message": "A1=A2" } ] |                                                              | 初始化当前sheet审核列表 |
| getData()         |                                                              | [ { "ref": "AL001", "mode": "error", "ruler": "A1=A2", "message": "A1=A2" } ] | 获取当前sheet审核列表   |
| clear()           |                                                              |                                                              | 清空审核列表            |
| remove(ref)       | 删除对应REF                                                  |                                                              |                         |
| add               | (mode, ref, { type, ruler, message, tips })                  | true 新增成功 false 失败                                     | 新增校验规则            |
| get(ref)          | 获取ref                                                      | { "ref": "AL002", "mode": "warn",   "examiner": {  "ruler": "IF(A3=3,A4=3)",        "message": "当报表类型＝“3”（行政单位汇总录入表），则单位基本性质＝“10”（行政单位）"   } | 获取审核配置            |
| getRulerRef(ref)  | 获取ruler                                                    | IF(A3=3,A4=3)                                                | 获取规则                |
| validate()        |                                                              |                                                              | 审核                    |
| getError()        |                                                              |                                                              | 获取错误信息            |
| getRefError(ref)  |                                                              |                                                              | 获取当前错误信息        |

3.参数规则 examines

| 参数    | 说明                  |
| ------- | --------------------- |
| ref     | 标识ID                |
| mode    | error错误、 warn 告警 |
| ruler   | 规则                  |
| message | 说明                  |


##  角标

### subscript 

spreadsheet.datas[1].subscript.add(1,1,{local:'rb',color:'blue'})

1.API 

| 接口名称       | 注入参                                | 出参                      | 说明         |
| -------------- | ------------------------------------- | ------------------------- | ------------ |
| add(subscript) | （ri，ci，{color:“red”，local:'rb'}） | true 新增成功 false 失败  | 新增角标     |
| get(ri,ci)     |                                       | {color:“red”，local:'rb'} | 获取当前角标 |
| clear()        |                                       |                           | 清空         |
| remove(ri,ci)     |                                       | true 删除成功 false 失败  | 清空当前角标 |

2.参数规则  

| 参数  | 说明                                     |
| ----- | ---------------------------------------- |
| local | //lt/rt/rb/lb 左上、  右上、 右下、 左下 |


##  公式计算外部注入

| 接口名称       | 注入参                                | 出参                      | 说明         |
| -------------- | ------------------------------------- | ------------------------- | ------------ |
| getFormulaVal(formula,{}) | (formula, cells,isClearCache) |  数值 |  .sheet.data.getFormula('=(A1+B1)*100', { A1: 1, B1: '=SUM(C1,C2)', C1: 5, C2: '=SUM(C3:C4)', C3: 5, C4: 0.5 },true)  //公式、单元格数据、是否清空缓存 | 
