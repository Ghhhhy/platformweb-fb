#### getExcelData 获取数据

#### setExcelData 设置数据

```js
<template>
  <div class="home">
    <div class="banner">
      <el-button type="primary" @click="submit">获取</el-button>
    </div>
    <div class="report">
      <ReportView ref="report_view" @sheet-loaded="sheetLoaded" :codes="code"></ReportView>
    </div>
  </div>
</template>
<script>
export default {
  name: 'datav-excelReport',
  data() {
    return {
      code: 'dc2088b0130411ed8e652f5f23241a94', // 设计端对应的报表code
    };
  },
  methods: {
    getExcelData() {
      let sheets = this.$refs.report_view.getExcelData();
      console.log(sheets);
    },
    //获取选区单元格
    getSelectionExcelData() {
        let sheet = this.$refs.report_view.getSelectionExcelData();
        console.log(sheet);
      },
    setExcelData(sheets) {
      this.$refs.report_view.setExcelData(sheets);
    },
    //获取Excel sheetNames
    sheetLoaded(){
      this.$refs.report_view.getSheetNames()
      this.$refs.report_view.getSpreadsheet().on('cells-selected', ( cell, range) => {//监听获取当前区域
        console.log(cell, range);//cell多个格子为null ，range选区
      });
    },
    //隐藏sheet
    hideSheet(){
      this.$refs.report_view.hideSheet(['Sheet1'])
    },
    //定位excel坐标，sheetName不传为当前sheet
    gotoxy(){
      this.$refs.report_view.gotoxy('sheet1','A3')
    },
    // 获取sheet配置列表
    getExcelSheetList() {
      this.$refs.report_view.getExcelSheetList()
    },
    //设置单元格不可编辑
    setCellEditable(){
       this.$refs.report_view.getSpreadsheet().setCellEditable('Sheet2',0,0,false)//sheet名称，ri，ci，false不可编辑 true编辑
       this.$refs.report_view.getSpreadsheet().reRender()
    }
  }
};
</script>

```

#### 1.1 sheets 整体参数说明

```json
[
  {
    "name": "sheetName",
    "sheetConfig": {},
    "rows": {
      "1": {
        "cells": {
          "0": {
            "text": "",
            "value": null,
            "expr": "A2",
            "identifier": {
              "dataBase": "dataBase",
              "tableName": "tableName",
              "identifierValue": "1",
              "fieldName": "NAME",
              "identifierKey": "ID"
            },
            "roundingBalance": false,
            "roundingBalanceTarget": "", // 舍位目标例如：A1
            "parseFunctionExpr": null,
            "customConfig": {
              "noSummary": true // true表示非汇总项，false或无此字段表示汇总项
            },
            "sheetCustomConfig": {
              "columnName": "", // 栏目名称
              "itemName": "", // 项目名称
              "itemValue": "" //项目编码
            }
          }
        }
      }
    }
  }
]
```

| 字段名 1 级 | 注释           | 数据类型 | 说明             |
| ----------- | -------------- | -------- | ---------------- |
| name        | sheet 名称     | string   |                  |
| rows        | 单元格数据结构 | object   | 详细见 rows 表格 |
| sheetConfig | sheet 页配置   | object   |                  |

#### 1.2 rows 单元所有数据主体说明

```json
{
  "rows": {
    "1": {
      "cells": {
        "0": {
          "text": "",
          "value": null,
          "expr": "A2",
          "identifier": {
            "dataBase": "dataBase",
            "tableName": "tableName",
            "identifierValue": "1",
            "fieldName": "NAME",
            "identifierKey": "ID"
          },
          "roundingBalance": false,
          "parseFunctionExpr": null,
          "customConfig": {
            "noSummary": true
          },
          "sheetCustomConfig": {
            "columnName": "", // 栏目名称
            "itemName": "", // 项目名称
            "itemValue": "" //项目编码
          }
        }
      }
    },
    "6": {
      "cells": {
        "2": {
          "text": "=SUM(D7)",
          "value": "2659787.01",
          "roundingBalance": true,
          "expr": "C7",
          "parseFunctionExpr": ["D7"],
          "customConfig": {},
          "sheetCustomConfig": {}
        }
      }
    }
  }
}
```

| 字段名 1 级 | 字段名 2 级 | 字段名 3 级 | 字段名 4 级           | 注释                       | 数据类型 | 说明                             |
| ----------- | ----------- | ----------- | --------------------- | -------------------------- | -------- | -------------------------------- |
| 行号 0...   |             |             |                       | 行号如 0,1,2,3,5           | string   |                                  |
|             | cells       |             |                       | 该行所有列                 | object   |                                  |
|             |             | 列号 0...   |                       | 列号如 0,1,2,3,5           | string   |                                  |
|             |             |             | text                  | 单元格内容                 | string   | 原则上应用端只修改该项           |
|             |             |             | value                 | 公式计算后的值             | string   | 不为公式时为：null               |
|             |             |             | expr                  | 当前格子坐标               | string   |                                  |
|             |             |             | identifier            | 对应库表信息               | object   |                                  |
|             |             |             | roundingBalance       | 是否开启设为平衡           | boolean  | 舍位平衡版本新增                 |
|             |             |             | roundingBalanceTarget | 平衡目标值设置             | string   | 单位转换时，二开人员进行数据修复 |
|             |             |             | parseFunctionExpr     | 舍位平衡关联单元格         | array    | 舍位平衡版本新增                 |
|             |             |             | customConfig          | 业务参数配置               | object   | 单元格业务参数                   |
|             |             |             | sheetCustomConfig     | 业务参数配置(sheet 页相关) | object   | 业务参数                         |

#### 1.3 identifier 说明

| 字段名 1 级     | 注释       | 数据类型 | 说明 |
| --------------- | ---------- | -------- | ---- |
| dataBase        | 数据源     | string   |      |
| tableName       | 表名       | string   |      |
| fieldName       | 字段名     | string   |      |
| identifierKey   | 标识字段   | string   |      |
| identifierValue | 标识字段值 | string   |      |
