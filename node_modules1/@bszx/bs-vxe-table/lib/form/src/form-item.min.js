"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _ctor=_interopRequireDefault(require("xe-utils/ctor")),_vXETable=_interopRequireDefault(require("../../v-x-e-table")),_tools=require("../../tools"),_conf=_interopRequireDefault(require("../../conf"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function renderPrefixIcon(e,t){return e("span",{class:"vxe-form--item-title-prefix"},[e("i",{class:t.icon||_conf.default.icon.FORM_PREFIX})])}function renderSuffixIcon(e,t){return e("span",{class:"vxe-form--item-title-suffix"},[e("i",{class:t.icon||_conf.default.icon.FORM_SUFFIX})])}function renderTitle(e,t){var i=t.title,l=t.titlePrefix,n=t.titleSuffix,o=[];return l&&o.push(l.content||l.message?e("vxe-tooltip",{props:{content:_tools.UtilTools.getFuncText(l.content||l.message),enterable:l.enterable,theme:l.theme}},[renderPrefixIcon(e,l)]):renderPrefixIcon(e,l)),o.push(e("span",{class:"vxe-form--item-title-label"},_tools.UtilTools.getFuncText(i))),n&&o.push(n.content||n.message?e("vxe-tooltip",{props:{content:_tools.UtilTools.getFuncText(n.content||n.message),enterable:n.enterable,theme:n.theme}},[renderSuffixIcon(e,n)]):renderSuffixIcon(e,n)),o}var _default={name:"VxeFormItem",props:{title:String,field:String,size:String,span:[String,Number],align:String,titleAlign:String,titleWidth:[String,Number],className:[String,Function],titleOverflow:{type:[Boolean,String],default:null},titlePrefix:Object,titleSuffix:Object,resetValue:{default:null},visible:{type:Boolean,default:null},visibleMethod:Function,folding:Boolean,collapseNode:Boolean,itemRender:Object,showTooltip:{type:Boolean,default:null}},inject:{$vxeform:{default:null}},data:function(){return{showError:!1,showRule:null}},computed:{vSize:function(){return this.size||this.$parent.size||this.$parent.vSize},isRequired:function(){var e=this.$vxeform,t=this.field;if(e&&e.rules){var i=e.rules[t];if(i)return i.some(function(e){return e.required})}return!1},errRule:function(){var e=this.$vxeform,i=this.field;return e?_ctor.default.find(e.invalids,function(e){var t=e.property;return i===t}):null}},watch:{errRule:function(e){var t=this;clearTimeout(this.showErrTimeout),this.showError=!1,e?(this.showRule=e.rule,setTimeout(function(){t.showError=!0},30)):this.showErrTimeout=setTimeout(function(){t.showRule=null},350)}},render:function(e){var t=this._e,i=this.$scopedSlots,l=this.$vxeform,n=this.title,o=this.folding,r=this.visible,s=this.visibleMethod,a=this.field,u=this.className,c=this.collapseNode,f=this.itemRender,d=this.isRequired,h=this.showError,m=this.showRule,v=this.titleOverflow,p=f?_vXETable.default.renderer.get(f.name):null,g=this.span||l.span,x=this.align||l.align,_=this.titleAlign||l.titleAlign,T=this.titleWidth||l.titleWidth,w=l.collapseAll,b=s,R=_ctor.default.isUndefined(v)||_ctor.default.isNull(v)?l.titleOverflow:v,S="title"===R,F=!0===R||"tooltip"===R,I=S||F||"ellipsis"===R,E={showTooltip:this.showTooltip,data:l.data,property:a,item:this,$form:l};if(!1===r)return t();!b&&p&&p.itemVisibleMethod&&(b=p.itemVisibleMethod);var O=[];p&&p.renderItemContent?O=p.renderItemContent.call(this,e,f,E):p&&p.renderItem?(_tools.UtilTools.warn("vxe.error.delFunc",["renderItem","renderItemContent"]),O=p.renderItem.call(this,e,f,E)):i&&i.default?O=i.default.call(this,E,e):a&&(O=["".concat(_ctor.default.get(l.data,a))]);var q=F&&l?{mouseenter:function(e){l.triggerHeaderHelpEvent(e,E)},mouseleave:l.handleTargetLeaveEvent}:{},N=F&&l?{mouseenter:function(e){l.triggerHeaderHelpEvent(e,E,!0)},mouseleave:l.handleTargetLeaveEvent}:{};return e("div",{class:["vxe-form--item",g?"vxe-col--".concat(g," is--span"):null,u,{"is--title":n,"is--required":d,"is--hidden":o&&w,"is--active":!b||b(E),"is--error":h}]},[e("div",{class:"vxe-form--item-inner"},[n?e("div",{class:["vxe-form--item-title",_?"align--".concat(_):null,{"is--ellipsis":I}],style:T?{width:isNaN(T)?T:"".concat(T,"px")}:null,attrs:{title:S?_tools.UtilTools.getFuncText(n):null},on:q},renderTitle(e,this)):null,e("div",{class:["vxe-form--item-content",x?"align--".concat(x):null],on:N},O.concat([c?e("div",{class:"vxe-form--item-trigger-node",on:{click:this.toggleCollapseEvent}},[e("span",{class:"vxe-form--item-trigger-text"},w?_conf.default.i18n("vxe.form.unfolding"):_conf.default.i18n("vxe.form.folding")),e("i",{class:["vxe-form--item-trigger-icon",w?_conf.default.icon.FORM_FOLDING:_conf.default.icon.FORM_UNFOLDING]})]):null,m&&l.validOpts.showMessage?e("div",{class:"vxe-form--item-valid",style:m.maxWidth?{width:"".concat(m.maxWidth,"px")}:null},m.message):null]))])])},methods:{toggleCollapseEvent:function(e){var t=this.$vxeform;t.toggleCollapse(),t.$emit("toggle-collapse",{collapse:!t.collapseAll,data:t.data,$form:t,$event:e},e)}}};exports.default=_default;